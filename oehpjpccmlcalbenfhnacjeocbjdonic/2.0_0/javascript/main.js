var h=void 0,i=!0,j=null,k=!1,l,n=this,ba=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&
!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==b&&"undefined"==typeof a.call)return"object";return b},ca=function(a){return"string"==typeof a},da=function(a){return"function"==ba(a)},ga=function(a){return a[ea]||(a[ea]=++fa)},ea="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),fa=0,ha=function(a,b,c){return a.call.apply(a.bind,arguments)},ia=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,
2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}},q=function(a,b,c){q=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ha:ia;return q.apply(j,arguments)},ja=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}},r=function(a,b){function c(){}
c.prototype=b.prototype;a.fa=b.prototype;a.prototype=new c};Function.prototype.bind=Function.prototype.bind||function(a,b){if(1<arguments.length){var c=Array.prototype.slice.call(arguments,1);c.unshift(this,a);return q.apply(j,c)}return q(this,a)};var ka=chrome.i18n.getMessage("untitled");chrome.i18n.getMessage("@@bidi_dir");
var la=chrome.i18n.getMessage("locale"),ma=-1!=window.navigator.platform.indexOf("Mac")?"Mac":-1!=window.navigator.platform.indexOf("Win")||-1!=window.navigator.userAgent.indexOf("CrOS")?"Windows":"Pc",na=[[[255,255,255],[230,230,230],[204,204,204],[179,179,179],[153,153,153],[128,128,128],[102,102,102],[77,77,77],[51,51,51],[0,0,0],[188,191,241],[149,154,238],[81,88,227],[42,49,191],[12,18,139],[167,187,244],[116,146,232],[46,90,217],[24,59,162],[10,34,102],[175,209,242],[115,174,230],[44,134,217],
[19,93,163],[5,56,104],[167,229,242],[115,211,231],[53,185,213],[23,137,161],[1,82,100]],[[178,240,177],[120,203,118],[81,163,79],[52,127,50],[24,87,22],[228,241,208],[179,217,133],[135,180,78],[78,104,30],[48,63,19],[234,238,176],[217,225,107],[207,219,34],[138,147,14],[76,81,6],[248,239,141],[217,206,89],[205,191,42],[161,150,27],[94,87,10],[247,220,139],[238,200,83],[211,164,22],[143,113,21],[85,65,5],[247,221,183],[233,189,125],[224,159,67],[166,106,20],[117,72,7]],[[244,209,163],[232,184,121],
[217,142,45],[170,111,35],[118,73,15],[243,178,138],[226,143,92],[214,109,46],[181,85,27],[124,54,11],[251,173,160],[230,126,109],[222,75,50],[188,47,24],[126,27,11],[245,168,168],[229,119,119],[230,60,60],[201,20,21],[113,7,7],[240,196,232],[255,169,240],[230,116,210],[196,61,172],[114,5,95],[199,171,238],[169,124,231],[124,55,219],[89,33,164],[60,19,117]]];var s=function(a){this.context=(this.canvas=a)?this.canvas.getContext("2d"):j;this.color=this.p=""},t=document.createElement("canvas"),v=/MacIntel/.test(window.navigator.platform)?"Mac":"Pc",oa="Pc"==v?3:0,pa="Mac"==ma?"Mac":"Pc_ltr";s.prototype.D=function(){};s.prototype.ma=function(){return this.color};
var qa=function(a,b,c,d){b.getContext("2d").drawImage(a.canvas,c,d,a.canvas.width,a.canvas.height)},ra=function(a,b,c){var d;d=document.createElement("canvas");d.setAttribute("width",b);d.setAttribute("height",c);d=d.getContext("2d");d.drawImage(a.W,a.I.x,a.I.y);a.ya=d.getImageData(0,0,b,c).data},sa=function(a,b,c){t.width=t.height=b;var d=t.getContext("2d");d.clearRect(0,0,b,b);d.fillStyle=a;d.fillRect(0,0,b,b);c&&d.drawImage(c,0,0);return t.toDataURL("image/png")},w=function(a,b,c){a&&(b&&c?(t.width=
b,t.height=c):"Pc"==v?(t.width=746,t.height=463):(t.width=740,t.height=460));return t};var ya=function(a){s.call(this,a);this.color=this.p="#ffffff";this.g=new Image;this.Ha="";this.oa=k;this.q=window.screen.width;this.t=window.screen.height;this.aa=this.$="left top";this.K=this.M="";this.ba=this.ca=this.ob=this.pb=this.Ea=this.Fa=this.A=this.u=0;this.i="custom";this.Ga=this.qb=j;this.C={};this.P=this.Q=this.v=this.j=0;this.a=document.createElement("canvas");this.Pa=this.Qa=0;this.Ra=k;this.wc=function(){return this.oa&&("repeat"==this.i||"fill"==this.i||"custom"==this.i&&this.u>=this.q&&
this.A>=this.t||"fit-screen"==this.i&&this.Fa==this.q&&this.Ea==this.t)?i:k};this.g.onload=function(){this.u=this.g.width;this.A=this.g.height;if("image/png"!=this.Ha){if(!this.Ra){if(this.A>this.t&&this.u>this.q)ta(this);else{var a=document.createElement("canvas");a.width=this.u;a.height=this.A;var c=a.getContext("2d");c.fillStyle=this.p;c.fillRect(0,0,a.width,a.height);c.drawImage(this.g,0,0);this.g.src=a.toDataURL("image/jpeg")}this.Ra=i;return}}else this.Ra=i;this.C={};this.ca=740*this.u/this.q;
this.ba=401*this.A/this.t;if(this.A>this.t){if(this.u>this.q){ta(this);return}ua(this);va(this)}else this.u>this.q?(wa(this),xa(this)):this.u/this.q>this.A/this.t?(wa(this),xa(this)):(ua(this),va(this));var a=Math.floor(401/this.t*this.A),c=Math.floor(740/this.q*this.u),d=Math.ceil(740/c);0==(d&1)&&(d+=1);this.a.width=d*c;d=Math.ceil(401/a);0==(d&1)&&(d+=1);this.a.height=d*a;var d=this.a.getContext("2d"),e=document.createElement("canvas");e.width=c;e.height=a;e.getContext("2d").drawImage(this.g,0,
0,e.width,e.height);a=d.createPattern(e,"repeat");d.fillStyle=a;d.fillRect(0,0,this.a.width,this.a.height);this.qb&&this.qb(this.g.src,this.Ha);this.A==this.t&&this.u==this.q?(this.C["fit-screen"]=this.C.fill=this.C.repeat=this.C.custom=0,this.i="custom"):this.A==this.t?(this.C.repeat=this.u<this.q?-1:0,this.C.custom=-1):this.u==this.q&&(this.C.repeat=this.A<this.t?1:0,this.C.custom=1);this.C.hasOwnProperty("custom")&&(this.$||(this.$="left top"),this.aa||(this.aa="left top"));this.Ga&&this.Ga(this.C);
x(this,this.i)}.bind(this);this.fillColor()};r(ya,s);
var ua=function(a){a.C["fit-screen"]=-1;a.M||(a.M="top-center-fit-h");a.Ea=a.t;a.Fa=a.t/a.A*a.u;a.ob=401;a.pb=740*a.Fa/a.q},wa=function(a){a.C["fit-screen"]=1;a.M||(a.M="left-center-fit-v");a.Fa=a.q;a.Ea=a.q/a.u*a.A;a.pb=740;a.ob=401*a.Ea/a.t},va=function(a){a.C.fill=1;a.K||(a.K="top-fill-v");a.Qa=a.q;a.Pa=a.A*a.q/a.u;a.Ub=740;a.Tb=401*a.Pa/a.t},xa=function(a){a.C.fill=-1;a.K||(a.K="top-center-fill-h");a.Pa=a.t;a.Qa=a.u*a.t/a.A;a.Tb=401;a.Ub=740*a.Qa/a.q},ta=function(a){var b=a.q/a.u,c=a.t/a.A,d=
document.createElement("canvas");b>c?(d.width=a.q,d.height=Math.ceil(a.A*b)):(d.height=a.t,d.width=Math.ceil(a.u*c));b=d.getContext("2d");b.fillStyle=a.p;b.fillRect(0,0,d.width,d.height);b.drawImage(a.g,0,0,d.width,d.height);a.g.src=d.toDataURL("image/jpeg")};ya.prototype.fillColor=function(){var a=this.context;a.beginPath();a.fillStyle=this.color;a.fillRect(0,0,740,401)};ya.prototype.drawImage=function(a){this.context.drawImage(a,this.j,this.v,this.Q,this.P)};var y=function(a,b,c){a.Q=b;a.P=c};
ya.prototype.D=function(){this.context.clearRect(0,0,740,401);this.fillColor();if(this.g&&this.g.src)switch("custom"==this.i?this.$:this.aa){case "left top":this.v=this.j=0;switch(this.i){case "repeat":y(this,this.a.width,this.a.height);this.drawImage(this.a);break;case "custom":y(this,this.ca,this.ba),this.drawImage(this.g)}break;case "top":this.v=0;switch(this.i){case "repeat":y(this,this.a.width,this.a.height);this.j=(740-this.a.width)/2;this.drawImage(this.a);break;case "custom":y(this,this.ca,
this.ba),this.j=(740-this.Q)/2,this.drawImage(this.g)}break;case "right top":this.v=0;switch(this.i){case "repeat":y(this,this.a.width,this.a.height);this.j=740-this.a.width;this.drawImage(this.a);break;case "custom":y(this,this.ca,this.ba),this.j=740-this.Q,this.drawImage(this.g)}break;case "left":this.j=0;switch(this.i){case "repeat":y(this,this.a.width,this.a.height);this.v=(401-this.a.height)/2;this.drawImage(this.a);break;case "custom":y(this,this.ca,this.ba),this.v=(401-this.P)/2,this.drawImage(this.g)}break;
case "right":this.j=0;switch(this.i){case "repeat":y(this,this.a.width,this.a.height);this.j=740-this.a.width;this.v=(401-this.a.height)/2;this.drawImage(this.a);break;case "custom":y(this,this.ca,this.ba),this.j=740-this.Q,this.v=(401-this.P)/2,this.drawImage(this.g)}break;case "left bottom":this.j=0;switch(this.i){case "repeat":y(this,this.a.width,this.a.height);this.v=401-this.a.height;this.drawImage(this.a);break;case "custom":y(this,this.ca,this.ba),this.v=401-this.P,this.drawImage(this.g)}break;
case "bottom":this.j=0;switch(this.i){case "repeat":y(this,this.a.width,this.a.height);this.j=(740-this.a.width)/2;this.v=401-this.a.height;this.drawImage(this.a);break;case "custom":y(this,this.ca,this.ba),this.v=401-this.P,this.j=(740-this.Q)/2,this.drawImage(this.g)}break;case "right bottom":switch(this.j=0,this.i){case "repeat":y(this,this.a.width,this.a.height);this.j=740-this.a.width;this.v=401-this.a.height;this.drawImage(this.a);break;case "custom":y(this,this.ca,this.ba),this.v=401-this.P,
this.j=740-this.Q,this.drawImage(this.g)}}};
var za=function(a,b,c){var d=A;d.oa=k;d.qb=c;d.g.src=a;d.Ha=b},x=function(a,b,c){a.i=b;a.oa=i;if("fill"==b||"fit-screen"==b){switch(b){case "fit-screen":c||(c=a.M);a.Q=a.pb;a.P=a.ob;a.M=c;break;case "fill":c||(c=a.K),a.Q=a.Ub,a.P=a.Tb,a.K=c}switch(c){case "left-fit-h":case "left-fill-h":case "top-fit-v":case "top-fill-v":a.j=0;a.v=0;break;case "top-center-fit-h":case "top-center-fill-h":a.j=(740-a.Q)/2;a.v=0;break;case "right-fit-h":case "right-fill-h":a.j=740-a.Q;a.v=0;break;case "left-center-fit-v":case "left-center-fill-v":a.j=
0;a.v=(401-a.P)/2;break;case "bottom-fit-v":case "bottom-fill-v":a.j=0,a.v=401-a.P}a.context.clearRect(0,0,740,401);a.fillColor();a.drawImage(a.g)}else a.D()};ya.prototype.H=function(a){this.color=a||this.p;this.fillColor();this.oa&&x(this,this.i)};var Aa=function(){var a=A,b,c;"fit-screen"==a.i?(b=a.Fa,c=a.Ea):(b=a.u,c=a.A);var d=w(i,b,c),e=d.getContext("2d");e.beginPath();e.fillStyle=a.color;e.fillRect(0,0,b,c);e.drawImage(a.g,0,0,b,c);return d.toDataURL("image/jpeg")};
ya.prototype.reset=function(){this.color=this.p;this.g.src="";this.aa=this.$="left top";this.K=this.M="";this.i="custom";this.Ra=this.oa=k;this.fillColor()};var Da=function(a){s.call(this,a);this.context.strokeStyle="#333";this.context.lineWidth=2;Ba=750;Ca=466;this.ja="Mac"==v?182:127},Ba,Ca;r(Da,s);var B=function(a){Error.captureStackTrace?Error.captureStackTrace(this,B):this.stack=Error().stack||"";a&&(this.message=String(a))};r(B,Error);B.prototype.name="CustomError";var Ea=function(a,b){for(var c=1;c<arguments.length;c++){var d=String(arguments[c]).replace(/\$/g,"$$$$");a=a.replace(/\%s/,d)}return a};var Fa=function(a,b){b.unshift(a);B.call(this,Ea.apply(j,b));b.shift()};r(Fa,B);Fa.prototype.name="AssertionError";var Ga=function(a,b,c){if(!a){var d=Array.prototype.slice.call(arguments,2),e="Assertion failed";if(b)var e=e+(": "+b),f=d;throw new Fa(""+e,f||[]);}};var Ha=Array.prototype,Ia=Ha.indexOf?function(a,b,c){Ga(a.length!=j);return Ha.indexOf.call(a,b,c)}:function(a,b,c){c=c==j?0:0>c?Math.max(0,a.length+c):c;if(ca(a))return!ca(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Ja=Ha.some?function(a,b,c){Ga(a.length!=j);return Ha.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ca(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return i;return k};var Ka=function(a){a=a.replace(/\r\n/g,"\n");for(var b=[],c=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);128>e?b[c++]=e:(2048>e?b[c++]=e>>6|192:(b[c++]=e>>12|224,b[c++]=e>>6&63|128),b[c++]=e&63|128)}return b};var La="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Ma=function(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<La.length;f++)c=La[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var Na="",Oa=/WebKit\/(\S+)/.exec(n.navigator?n.navigator.userAgent:j),Pa=Na=Oa?Oa[1]:"",Qa={},Ra=function(){if(!Qa["528"]){for(var a=0,b=String(Pa).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),c="528".replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=Math.max(b.length,c.length),e=0;0==a&&e<d;e++){var f=b[e]||"",g=c[e]||"",m=RegExp("(\\d*)(\\D*)","g"),p=RegExp("(\\d*)(\\D*)","g");do{var u=m.exec(f)||["","",""],z=p.exec(g)||["","",""];if(0==u[0].length&&0==z[0].length)break;a=((0==u[1].length?0:
parseInt(u[1],10))<(0==z[1].length?0:parseInt(z[1],10))?-1:(0==u[1].length?0:parseInt(u[1],10))>(0==z[1].length?0:parseInt(z[1],10))?1:0)||((0==u[2].length)<(0==z[2].length)?-1:(0==u[2].length)>(0==z[2].length)?1:0)||(u[2]<z[2]?-1:u[2]>z[2]?1:0)}while(0==a)}Qa["528"]=0<=a}};var C=function(a,b){if(a instanceof Array){var c,d=b.length;for(c=0;c<d;++c)a.push(b[c])}else Ma(a,b)},D=function(a,b,c){var d=[],e=0,f=a,g=0>a;g&&(e=255,f=-1*a-1);do a=f&255,g&&(a^=255),d.push(a),f>>>=8;while(f);for(;d.length<~~b;)d.push(e);b&&d.slice(0,b);c&&(d=d.reverse());return d},Sa=function(a){return a.toByteArray().map(function(a){return a&255})},Ta=function(a){var b,c,d;c=d=b=0;if(/^#[0-9a-f]{3}(?:[0-9a-f]{3})?$/i.test(a))b=a.substring(1),3==b.length?(c=17*parseInt(b.charAt(0),16),d=17*parseInt(b.charAt(1),
16),b=17*parseInt(b.charAt(2),16)):(b=parseInt(b,16),c=(b&16711680)>>16,d=(b&65280)>>8,b&=255);else if(0==a.indexOf("rgb")&&(a=a.match(/\((\d+), ?(\d+), ?(\d+)(, ?([\d\.]+))?\)/)))a.shift(),c=parseInt(a.shift(),10),d=parseInt(a.shift(),10),b=parseInt(a.shift(),10);return[c,d,b]},Ua=function(a){a:{var b=9==a.nodeType?a:a.ownerDocument||a.document;if(b.defaultView&&b.defaultView.getComputedStyle&&(a=b.defaultView.getComputedStyle(a,j))){a=a.width||a.getPropertyValue("width")||"";break a}a=""}return parseInt(a,
10)};var E=chrome.i18n.getMessage;var Wa=function(a){s.call(this,a);this.Aa=this.za=this.p="#000";this.Cb=new Image;this.I={x:"Mac"==v?75:25,y:23};this.Cb.onload=function(){Va(this)}.bind(this);this.Cb.src=chrome.extension.getURL("../../images/canvas/buttonsandbar_"+pa+".png")};r(Wa,s);
var Va=function(a){a.context.clearRect(0,0,740,460);a.context.font='12px "Arial"';a.context.fillStyle=a.za;a.context.fillText(E("new_tab_text"),a.I.x,a.I.y);a.context.fillStyle=a.Aa;a.context.fillText(E("rear_tab_text"),a.I.x+130,a.I.y);a.context.drawImage(a.Cb,0,0)};Wa.prototype.ma=function(a){return"rearTab"==a?this.Aa:"activeTab"==a?this.za:[this.za,this.Aa]};
Wa.prototype.H=function(a,b){var c=a||this.p;switch(b){case "activeTab":this.za=c;break;case "rearTab":this.Aa=c;break;default:this.za=this.Aa=c}Va(this)};Wa.prototype.reset=function(){this.za=this.Aa=this.p;Va(this)};var Za=function(a){s.call(this,a);var b;"Pc"==v?(a=746,b=463):(a=740,b=460);Xa=a;Ya=b;this.color=this.p="Mac"==v?"#afafaf":"#e6e6e6";this.hb=new Image;this.gb=new Image;"Pc"==v?(this.gb.onload=function(){this.hb.src=chrome.extension.getURL("../../images/canvas/frame_t_"+v+".png")}.bind(this),this.gb.src=chrome.extension.getURL("../../images/canvas/edge_"+pa+".png")):this.hb.src=chrome.extension.getURL("../../images/canvas/frame_t_"+v+".png");this.hb.onload=function(){this.D()}.bind(this)},Xa,Ya;
r(Za,s);Za.prototype.D=function(){var a=this.context;a.fillStyle=this.color;a.fillRect(0,0,Xa,30);"Pc"==v&&(a.fillRect(0,0,oa,Ya),a.fillRect(Xa-oa,0,oa,Ya),a.fillRect(0,Ya-oa,Xa,oa));0!=this.gb.src.length&&this.context.drawImage(this.gb,2,5);this.context.drawImage(this.hb,0,0)};Za.prototype.H=function(a){this.color=a?a:this.p;this.D()};var $a=function(a){s.call(this,a);this.Mb=new Image;this.Hb=new Image;this.Kb=new Image;this.Gb=new Image;this.Jb=new Image;this.Ib=new Image;this.Mb.onload=function(){this.Hb.src=chrome.extension.getURL("../images/icons/gmail_offline.png")}.bind(this);this.Hb.onload=function(){this.Kb.src=chrome.extension.getURL("../images/icons/20things.png")}.bind(this);this.Kb.onload=function(){this.Gb.src=chrome.extension.getURL("../images/icons/calendar.png")}.bind(this);this.Gb.onload=function(){this.Jb.src=
chrome.extension.getURL("../images/icons/reader_hires.png")}.bind(this);this.Jb.onload=function(){this.Ib.src=chrome.extension.getURL("../images/icons/google_books.png")}.bind(this);this.Ib.onload=function(){this.D()}.bind(this);this.Mb.src=chrome.extension.getURL("../images/icons/webstore.png")};r($a,s);
$a.prototype.D=function(){this.context.drawImage(this.Mb,150,120);this.context.drawImage(this.Hb,230,120);this.context.drawImage(this.Kb,310,120);this.context.drawImage(this.Gb,390,120);this.context.drawImage(this.Jb,470,120);this.context.drawImage(this.Ib,550,120)};var bb=function(a){s.call(this,a);this.color=this.p="#d0d0d0";this.I={x:"Pc"==v?130:185,y:6};this.Ya=new Image;this.Ya.onload=function(){ab(this)}.bind(this);this.ya=j;this.W=new Image;this.W.onload=function(){ra(this,740,460);for(var a=this.context.getImageData(0,0,740,460),c=3;c<=this.ya.length;c+=4)255!=this.ya[c]&&(a.data[c]=0);this.context.putImageData(a,0,0);this.Ya.src||(this.Ya.src=chrome.extension.getURL("../../images/canvas/sec_tab_t.png"))}.bind(this);this.D()};r(bb,s);
bb.prototype.D=function(){this.context.fillStyle=this.color;this.context.fillRect(this.I.x,this.I.y,151,24);this.W.src||(this.W.src=chrome.extension.getURL("../../images/canvas/sec_tab_mask.png"))};var ab=function(a){a.context.drawImage(a.Ya,a.I.x,a.I.y)};bb.prototype.H=function(a){this.color=a?a:this.p;this.D();this.W.onload();ab(this)};var fb=function(a){s.call(this,a);var b;"Pc"==v?(a=746,b=463):(a=740,b=460);cb=a;db=b;this.color=this.p="Mac"==v?"#ccc":"#e4e4e4";this.I={x:oa,y:6};this.ub=new Image;this.ub.onload=function(){eb(this)}.bind(this);this.ya=j;this.W=new Image;this.W.onload=function(){ra(this,cb,db);for(var a=this.context.getImageData(0,0,cb,db),b=3;b<=this.ya.length;b+=4)255!=this.ya[b]&&(a.data[b]=0);this.context.putImageData(a,0,0)}.bind(this);this.D()},cb,db;r(fb,s);
var eb=function(a){a.context.drawImage(a.ub,a.I.x,a.I.y)};fb.prototype.D=function(){var a=this.context;a.beginPath();a.fillStyle=this.color;a.fillRect(0,6,cb,53);this.W.src||(this.W.src=chrome.extension.getURL("../../images/canvas/omnibar_mask_"+pa+".png"));this.ub.src=chrome.extension.getURL("../../images/canvas/omnibar_t_"+pa+".png")};fb.prototype.H=function(a){this.color=a?a:this.p;this.D();this.W.onload();eb(this)};var F=function(a,b,c){a=a instanceof HTMLElement?[a]:Array.prototype.slice.call(a);var d=b.split(",");a.forEach(function(a){d.forEach(function(b){a.addEventListener(b,c,k)})})},gb=function(a){setTimeout(function(){var b=document.createElement("script");b.setAttribute("async","async");b.src=a;var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)},40)},G=function(a,b){a?!document.nb&&b&&(document.nb=function(a){27==a.keyCode&&b()},document.addEventListener("keyup",document.nb,
k)):(document.removeEventListener("keyup",document.nb,k),document.nb=j)},ib=function(a){var b=hb(h);function c(){G(k);d.removeClass("show");$(".title",d).text("");$(".message",d).text("");$(".more",d).text("");$(".close",d).unbind("click");b&&b()}var d=$("#error-container");$(".title",d).text(a.title);$(".message",d).text(a.message);$(".more",d).text(a.moreInfo);d.addClass("show");G(i,c);$(".close",d).click(c)};var jb=function(a,b){this.d=a;this.cb=0;this.Lc=b;$("#left-arr",this.d)[0].addEventListener("click",q(function(){this.prev()},this));$("#right-arr",this.d)[0].addEventListener("click",q(function(){this.next()},this));this.Y=0};
jb.prototype.add=function(a,b){for(var c=$("#"+this.Lc+" td")[0],d=document.createElement("table"),e=0;e<a.length;){var f=5,g=document.createElement("tr");do{var m=c.cloneNode(i),p="rgb("+a[e++].toString()+")";m.dataset.color=p;$(".grid-color",m)[0].style.backgroundColor=p;g.appendChild(m)}while(--f);d.appendChild(g)}d.setAttribute("border","1");this.cb++;c=document.createElement("div");c.id="color-grid-"+this.cb;c.dataset.grid=this.cb;c.classList.add("color-grid");c.appendChild(d);d.addEventListener("webkitTransitionEnd",
function(a){a.stopPropagation()},k);F($("td",d),"click",q(b,j,this.cb));c.addEventListener("webkitTransitionEnd",q(function(a){a.target.classList.remove("animate");a.target.classList.contains("selected")&&(this.d.dataset.state="",0<this.Y?(this.Y--,this.next()):0>this.Y&&(this.Y++,this.prev()))},this),k);$(".grids",this.d)[0].appendChild(c)};
var kb=function(a){var b=$(".color-grid.right",a.d)[0],c=$(".color-grid.left",a.d)[0],d=$("#left-arr",a.d)[0];a=$("#right-arr",a.d)[0];c?d.classList.remove("hidden"):d.classList.add("hidden");b?a.classList.remove("hidden"):a.classList.add("hidden")};
jb.prototype.next=function(){var a=$(".color-grid.right",this.d)[0];if(a)if("animating"==this.d.dataset.state)this.Y++;else{var b=$(".color-grid.selected",this.d)[0],c=$(".color-grid.left",this.d)[0];a.classList.add("animate");b.classList.add("animate");this.d.dataset.state="animating";c&&c.classList.remove("left");a.classList.add("selected");a.classList.remove("right");b.classList.add("left");b.classList.remove("selected");a.nextElementSibling&&a.nextElementSibling.classList.add("right");kb(this)}else 0<
this.Y&&(this.Y=0)};
jb.prototype.prev=function(){var a=$(".color-grid.left",this.d)[0];if(a)if("animating"==this.d.dataset.state)this.Y--;else{var b=$(".color-grid.selected",this.d)[0],c=$(".color-grid.right",this.d)[0];a.classList.add("animate");b.classList.add("animate");this.d.dataset.state="animating";a.classList.add("selected");a.classList.remove("left");b.classList.add("right");b.classList.remove("selected");c&&c.classList.remove("right");a.previousElementSibling&&a.previousElementSibling.classList.add("left");kb(this)}else 0>
this.Y&&(this.Y=0)};
jb.prototype.select=function(a){$(".color-grid.animate",this.d).each(function(a,b){b.classList.remove("animate")});this.d.dataset.state="";var b=$(".color-grid.selected",this.d)[0];b&&b.classList.remove("selected");(b=$(".color-grid.left",this.d)[0])&&b.classList.remove("left");(b=$(".color-grid.right",this.d)[0])&&b.classList.remove("right");if(a=$("#color-grid-"+a,this.d)[0])a.classList.add("selected"),a.nextElementSibling&&a.nextElementSibling.classList.add("right"),a.previousElementSibling&&a.previousElementSibling.classList.add("left");
kb(this)};var lb=function(a,b,c){this.G=a;this.zb=b;this.va=c||{width:this.G.width,height:this.G.height}};l=lb.prototype;l.width=function(){return this.va.width};l.height=function(){return this.va.height};l.type=function(){return this.zb};l.getImageData=function(){var a=this.G,b=this.va||{width:a.width,height:a.height},c=document.createElement("canvas");c.width=b.width;c.height=b.height;c.getContext("2d").drawImage(a,0,0,b.width,b.height);return c.getContext("2d").getImageData(0,0,this.width(),this.height())};
l.resize=function(a){if(a){var b=this.va.width/this.va.height,c=this.G.width,d=this.G.height;c>a.width&&(c=a.width,d=c/b);d>a.height&&(d=a.height,c=d*b);this.va={width:c,height:d}}else this.va={width:this.G.width,height:this.G.height};return this};var mb=function(a){this.name=a};mb.prototype.Ca=function(a){return a};var nb=function(a){return Math.min(255,Math.max(Math.round(a),0))};var ob=function(a,b){this.name=a;this.U=b};r(ob,mb);ob.prototype.Ca=function(a){for(var b=this.U[0],c=this.U[1],d=this.U[2],e=a.data,f=e.length,g,m,p,u,z,aa=0;aa<f;aa+=4)g=e[aa],m=e[aa+1],p=e[aa+2],u=b*((299*g+587*m+114*p)/1E3),z=c*(128+(-169*g+-331*m+500*p)/1E3),g=d*(128+(500*g+-419*m+-81*p)/1E3),e[aa]=Math.abs(u+1402*(g-128)/1E3),e[aa+1]=Math.abs(u+(344*(z-128)-714*(g-128))/1E3),e[aa+2]=Math.abs(u+1772*(z-128)/1E3);return a};var pb=function(a){this.name=a};r(pb,mb);pb.prototype.Ca=function(a){for(var b=a.data,c=b.length,d=0;d<c;d+=4)b[d]^=255,b[d+1]^=255,b[d+2]^=255;return a};var qb=function(a,b){this.name=a;this.od=b};r(qb,mb);qb.prototype.Ca=function(a){for(var b=this.od,c=function(a){a=Math.round(a/b)*b;return nb(a)},d=a.data,e=d.length,f=0;f<e;f+=4)d[f]=c(d[f]),d[f+1]=c(d[f+1]),d[f+2]=c(d[f+2]);return a};var rb=function(a,b,c){this.name=a;this.U=b||[0.299,0.587,0.114];this.ad=c||16};r(rb,mb);
rb.prototype.Ca=function(a){for(var b=this.U[0],c=this.U[1],d=this.U[2],e=this.ad,f=a.data,g=f.length,m=0;m<g;m+=4){var p=b*f[m]+c*f[m+1]+d*f[m+2]+e;f[m]=nb(1.05*p);f[m+1]=nb(0.9*p);f[m+2]=nb(0.75*p)}return a};var sb=function(a,b){this.name=a;this.U=b};r(sb,mb);sb.prototype.Ca=function(a){for(var b=this.U[0],c=this.U[1],d=this.U[2],e=a.data,f=e.length,g=0;g<f;g+=4)e[g]=e[g+1]=e[g+2]=nb(b*e[g]+c*e[g+1]+d*e[g+2]);return a};var tb=function(a,b){sb.call(this,a,b?[0.216,0.712,0.072]:[0.299,0.587,0.114])};r(tb,sb);var ub=[new mb((0,chrome.i18n.getMessage)("original")),new tb((0,chrome.i18n.getMessage)("filter_black_and_white")),new rb((0,chrome.i18n.getMessage)("filter_sepia")),new ob((0,chrome.i18n.getMessage)("filter_warmer"),[1,0.85,1]),new ob((0,chrome.i18n.getMessage)("filter_cooler"),[1,1,0.95]),new ob((0,chrome.i18n.getMessage)("filter_bolder"),[1,0.75,1]),new qb((0,chrome.i18n.getMessage)("filter_posterized"),16),new pb((0,chrome.i18n.getMessage)("filter_inverted"))];var vb=function(a,b){this.Xc=a;this.G=b};vb.prototype.render=function(a){a=a||document.createElement("canvas");a.width=this.G.width();a.height=this.G.height();a.getContext("2d").putImageData(this.Xc.Ca(this.G.getImageData()),0,0);return a};var wb={width:600,height:425},xb={width:120,height:85},yb=function(a,b,c){c=new vb(b,c);var d=a.querySelector("canvas");c.render(d);if(a=a.querySelector(".name"))a.textContent=b.name},zb=function(a,b){this.yb=a;this.G=b;this.La=-1;this.d=j;this.onselect=function(){}},Ab=function(a,b){return function(){a.La=b;var c=a.d.querySelector(".selected");c&&c.classList.remove("selected");c='[data-filters_thumb_index="'+b+'"]';a.d.querySelector(c).classList.add("selected");a.d.querySelector(c).focus();a.onselect(a.yb[b],
a.G)}},Bb=function(a,b){a.G.resize(xb);var c=document.createDocumentFragment();a.yb.forEach(function(d,e){var f=b.cloneNode(i);yb(f,d,a.G);f.addEventListener("click",Ab(a,e),k);f.dataset.filters_thumb_index=""+e;c.appendChild(f)});return c};zb.prototype.render=function(a,b){this.d=a;a.appendChild(Bb(this,b))};var Cb=function(a){a.La<a.yb.length-1&&Ab(a,a.La+1)()};zb.prototype.clear=function(){this.d.innerHTML="";this.d=j};
var Db=k,Eb=j,Fb=j,Gb=j,Hb=j,Ib=function(){},Jb=function(a,b){Fb=a;b.resize(wb);var c=Hb.querySelector(".preview");yb(c,a,b)},Lb=function(){var a=Fb,b=Eb;b.resize();var c=(new vb(a,b)).render();Kb();Ib(i,c.toDataURL(b.type()),a.name)},Mb=function(){Kb();Ib(k)},Nb=function(a){a.preventDefault();a.stopPropagation();switch(a.keyCode){case 13:Lb();break;case 27:Mb();break;case 38:a=Gb;0<a.La&&Ab(a,a.La-1)();break;case 40:Cb(Gb)}},Kb=function(){document.removeEventListener("keyup",Nb,k)};Ra();Ra();var Ob=function(){};Ob.prototype.sc=k;Ob.prototype.lc=function(){this.sc||(this.sc=i,this.ha())};Ob.prototype.ha=function(){if(this.vc)for(;this.vc.length;)this.vc.shift()()};var Pb=function(a,b){this.type=a;this.currentTarget=this.target=b};l=Pb.prototype;l.ha=function(){};l.lc=function(){};l.Oa=k;l.defaultPrevented=k;l.kb=i;l.stopPropagation=function(){this.Oa=i};l.preventDefault=function(){this.defaultPrevented=i;this.kb=k};var Qb=function(a,b){a&&this.ra(a,b)};r(Qb,Pb);l=Qb.prototype;l.target=j;l.relatedTarget=j;l.offsetX=0;l.offsetY=0;l.clientX=0;l.clientY=0;l.screenX=0;l.screenY=0;l.button=0;l.keyCode=0;l.charCode=0;l.ctrlKey=k;l.altKey=k;l.shiftKey=k;l.metaKey=k;l.Da=j;
l.ra=function(a,b){var c=this.type=a.type;Pb.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;d||("mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement));this.relatedTarget=d;this.offsetX=a.offsetX;this.offsetY=a.offsetY;this.clientX=a.clientX!==h?a.clientX:a.pageX;this.clientY=a.clientY!==h?a.clientY:a.pageY;this.screenX=a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:
0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;this.Da=a;a.defaultPrevented&&this.preventDefault();delete this.Oa};l.stopPropagation=function(){Qb.fa.stopPropagation.call(this);this.Da.stopPropagation?this.Da.stopPropagation():this.Da.cancelBubble=i};l.preventDefault=function(){Qb.fa.preventDefault.call(this);var a=this.Da;a.preventDefault?a.preventDefault():a.returnValue=k};l.ha=function(){};var Rb=0;var Sb=function(){};l=Sb.prototype;l.key=0;l.removed=k;l.ab=k;l.ra=function(a,b,c,d,e,f){if(da(a))this.nc=i;else if(a&&a.handleEvent&&da(a.handleEvent))this.nc=k;else throw Error("Invalid listener argument");this.ta=a;this.proxy=b;this.src=c;this.type=d;this.capture=!!e;this.Ab=f;this.ab=k;this.key=++Rb;this.removed=k};l.handleEvent=function(a){return this.nc?this.ta.call(this.Ab||this.src,a):this.ta.handleEvent.call(this.ta,a)};var Tb={},H={},Ub={},Vb={},Wb=function(a,b,c,d,e){if("array"==ba(b))for(var f=0;f<b.length;f++)Wb(a,b[f],c,d,e);else a:{if(!b)throw Error("Invalid event type");d=!!d;var g=H;b in g||(g[b]={ea:0,X:0});g=g[b];d in g||(g[d]={ea:0,X:0},g.ea++);var g=g[d],f=ga(a),m;g.X++;if(g[f]){m=g[f];for(var p=0;p<m.length;p++)if(g=m[p],g.ta==c&&g.Ab==e){if(g.removed)break;m[p].ab=k;break a}}else m=g[f]=[],g.ea++;var u=Xb,z=function(a){return u.call(z.src,z.ta,a)},p=z,g=new Sb;g.ra(c,p,a,b,d,e);g.ab=k;p.src=a;p.ta=
g;m.push(g);Ub[f]||(Ub[f]=[]);Ub[f].push(g);a.addEventListener?(a==n||!a.fc)&&a.addEventListener(b,p,d):a.attachEvent(b in Vb?Vb[b]:Vb[b]="on"+b,p);Tb[g.key]=g}},Yb=function(a,b,c,d,e){if("array"==ba(b))for(var f=0;f<b.length;f++)Yb(a,b[f],c,d,e);else{d=!!d;a:{f=H;if(b in f&&(f=f[b],d in f&&(f=f[d],a=ga(a),f[a]))){a=f[a];break a}a=j}if(a)for(f=0;f<a.length;f++)if(a[f].ta==c&&a[f].capture==d&&a[f].Ab==e){Zb(a[f].key);break}}},Zb=function(a){if(Tb[a]){var b=Tb[a];if(!b.removed){var c=b.src,d=b.type,
e=b.proxy,f=b.capture;c.removeEventListener?(c==n||!c.fc)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in Vb?Vb[d]:Vb[d]="on"+d,e);c=ga(c);if(Ub[c]){var e=Ub[c],g=Ia(e,b);0<=g&&(Ga(e.length!=j),Ha.splice.call(e,g,1));0==e.length&&delete Ub[c]}b.removed=i;if(b=H[d][f][c])b.oc=i,$b(d,f,c,b);delete Tb[a]}}},$b=function(a,b,c,d){if(!d.lb&&d.oc){for(var e=0,f=0;e<d.length;e++)d[e].removed?d[e].proxy.src=j:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.oc=k;0==f&&(delete H[a][b][c],H[a][b].ea--,0==
H[a][b].ea&&(delete H[a][b],H[a].ea--),0==H[a].ea&&delete H[a])}},bc=function(a,b,c,d,e){var f=1;b=ga(b);if(a[b]){var g=--a.X,m=a[b];m.lb?m.lb++:m.lb=1;try{for(var p=m.length,u=0;u<p;u++){var z=m[u];z&&!z.removed&&(f&=ac(z,e)!==k)}}finally{a.X=Math.max(g,a.X),m.lb--,$b(c,d,b,m)}}return Boolean(f)},ac=function(a,b){a.ab&&Zb(a.key);return a.handleEvent(b)},Xb=function(a,b){if(a.removed||!(a.type in H))return i;var c=new Qb(b,this);return ac(a,c)};/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
var I=function(a,b){this.fb=[];this.Mc=b||j};l=I.prototype;l.bb=k;l.Ma=k;l.Fb=k;l.gc=k;l.uc=k;l.Nc=0;l.hc=function(a,b){this.Fb=k;cc(this,a,b)};var cc=function(a,b,c){a.bb=i;a.Db=c;a.Ma=!b;dc(a)},fc=function(a){if(a.bb){if(!a.uc)throw new ec;a.uc=k}};I.prototype.w=function(a){fc(this);gc(a);cc(this,i,a)};
var J=function(a,b){fc(a);gc(b);cc(a,k,b)},gc=function(a){Ga(!(a instanceof I),"An execution sequence may not be initiated with a blocking Deferred.")},L=function(a,b,c){K(a,b,j,c)},K=function(a,b,c,d){Ga(!a.gc,"Blocking Deferreds can not be re-used");a.fb.push([b,c,d]);a.bb&&dc(a)},hc=function(a){return Ja(a.fb,function(a){return da(a[1])})},dc=function(a){a.Lb&&(a.bb&&hc(a))&&(n.clearTimeout(a.Lb),delete a.Lb);a.ic&&(a.ic.Nc--,delete a.ic);for(var b=a.Db,c=k,d=k;a.fb.length&&!a.Fb;){var e=a.fb.shift(),
f=e[0],g=e[1],e=e[2];if(f=a.Ma?g:f)try{var m=f.call(e||a.Mc,b);m!==h&&(a.Ma=a.Ma&&(m==b||m instanceof Error),a.Db=b=m);b instanceof I&&(d=i,a.Fb=i)}catch(p){b=p,a.Ma=i,hc(a)||(c=i)}}a.Db=b;d&&(K(b,q(a.hc,a,i),q(a.hc,a,k)),b.gc=i);c&&(a.Lb=n.setTimeout(function(){throw b;},0))},ec=function(){B.call(this)};r(ec,B);ec.prototype.message="Deferred has already fired";ec.prototype.name="AlreadyCalledError";var M=function(a,b){B.call(this,Ea("Error %s: %s",b,ic(a)));this.code=a};r(M,B);
var ic=function(a){switch(a){case 1:return"File or directory not found";case 2:return"Insecure or disallowed operation";case 3:return"Operation aborted";case 4:return"File or directory not readable";case 5:return"Invalid encoding";case 6:return"Cannot modify file or directory";case 7:return"Invalid state";case 8:return"Invalid line-ending specifier";case 9:return"Invalid modification";case 10:return"Quota exceeded";case 11:return"Invalid filetype";case 12:return"File or directory already exists at specified path";
default:return"Unrecognized error"}};var jc=function(){};r(jc,Ob);l=jc.prototype;l.fc=i;l.Bb=j;l.addEventListener=function(a,b,c,d){Wb(this,a,b,c,d)};l.removeEventListener=function(a,b,c,d){Yb(this,a,b,c,d)};
l.dispatchEvent=function(a){var b=a.type||a,c=H;if(b in c){if(ca(a))a=new Pb(a,this);else if(a instanceof Pb)a.target=a.target||this;else{var d=a;a=new Pb(b,this);Ma(a,d)}var d=1,e,c=c[b],b=i in c,f;if(b){e=[];for(f=this;f;f=f.Bb)e.push(f);f=c[i];f.X=f.ea;for(var g=e.length-1;!a.Oa&&0<=g&&f.X;g--)a.currentTarget=e[g],d&=bc(f,e[g],a.type,i,a)&&a.kb!=k}if(k in c)if(f=c[k],f.X=f.ea,b)for(g=0;!a.Oa&&g<e.length&&f.X;g++)a.currentTarget=e[g],d&=bc(f,e[g],a.type,k,a)&&a.kb!=k;else for(e=this;!a.Oa&&e&&f.X;e=
e.Bb)a.currentTarget=e,d&=bc(f,e,a.type,k,a)&&a.kb!=k;a=Boolean(d)}else a=i;return a};l.ha=function(){jc.fa.ha.call(this);var a=0;if(this!=j){var b=ga(this);if(Ub[b])for(var b=Ub[b],c=b.length-1;0<=c;c--)Zb(b[c].key),a++}else for(c in b=function(b,c){Zb(c);a++},Tb)b.call(h,0,c);this.Bb=j};var kc=function(a,b){Pb.call(this,a.type,b);this.Da=a};r(kc,Pb);var lc=function(){this.O=new FileReader;this.O.onloadstart=q(this.L,this);this.O.onprogress=q(this.L,this);this.O.onload=q(this.L,this);this.O.onabort=q(this.L,this);this.O.onerror=q(this.L,this);this.O.onloadend=q(this.L,this)};r(lc,jc);lc.prototype.abort=function(){try{this.O.abort()}catch(a){throw new M(a.code,"aborting read");}};lc.prototype.getError=function(){return this.O.error&&new M(this.O.error.code,"reading file")};lc.prototype.L=function(a){this.dispatchEvent(new kc(a,this))};
lc.prototype.ha=function(){lc.fa.ha.call(this);delete this.O};var mc=function(a){this.Z=a;this.Z.onwritestart=q(this.L,this);this.Z.onprogress=q(this.L,this);this.Z.onwrite=q(this.L,this);this.Z.onabort=q(this.L,this);this.Z.onerror=q(this.L,this);this.Z.onwriteend=q(this.L,this)};r(mc,jc);mc.prototype.abort=function(){try{this.Z.abort()}catch(a){throw new M(a.code,"aborting save");}};mc.prototype.getError=function(){return this.Z.error&&new M(this.Z.error.code,"saving file")};mc.prototype.L=function(a){this.dispatchEvent(new kc(a,this))};
mc.prototype.ha=function(){delete this.Z;mc.fa.ha.call(this)};var nc=function(a){mc.call(this,a);this.pd=a};r(nc,mc);nc.prototype.write=function(a){try{this.pd.write(a)}catch(b){throw new M(b.code,"writing file");}};var oc=function(a,b){this.ga=a;this.F=b};oc.prototype.isFile=function(){return this.F.isFile};oc.prototype.getName=function(){return this.F.name};oc.prototype.moveTo=function(a,b){var c=new I;this.F.moveTo(a.Ka,b,q(function(a){c.w(a.isFile?new pc(this.ga,a):new qc(this.ga,a))},this),q(function(d){J(c,new M(d.code,"moving "+this.F.fullPath+" into "+a.F.fullPath+(b?", renaming to "+b:"")))},this));return c};
oc.prototype.remove=function(){var a=new I;this.F.remove(q(a.w,a,i),q(function(b){J(a,new M(b.code,"removing "+this.F.fullPath))},this));return a};var qc=function(a,b){oc.call(this,a,b);this.Ka=b};r(qc,oc);qc.prototype.getFile=function(a,b){var c=new I;this.Ka.getFile(a,rc(b),q(function(a){c.w(new pc(this.ga,a))},this),q(function(b){J(c,new M(b.code,"loading file "+a+" from "+this.F.fullPath))},this));return c};
qc.prototype.getDirectory=function(a,b){var c=new I;this.Ka.getDirectory(a,rc(b),q(function(a){c.w(new qc(this.ga,a))},this),q(function(b){J(c,new M(b.code,"loading directory "+a+" from "+this.F.fullPath))},this));return c};qc.prototype.removeRecursively=function(){var a=new I;this.Ka.removeRecursively(q(a.w,a,i),q(function(b){J(a,new M(b.code,"removing "+this.F.fullPath+" recursively"))},this));return a};
var rc=function(a){return 2==a?{create:i}:3==a?{create:i,exclusive:i}:{}},pc=function(a,b){oc.call(this,a,b);this.jc=b};r(pc,oc);pc.prototype.createWriter=function(){var a=new I;this.jc.createWriter(function(b){a.w(new nc(b))},q(function(b){J(a,new M(b.code,"creating writer for "+this.F.fullPath))},this));return a};pc.prototype.file=function(){var a=new I;this.jc.file(function(b){a.w(b)},q(function(b){J(a,new M(b.code,"getting file for "+this.F.fullPath))},this));return a};var sc=function(a){this.ga=a};sc.prototype.getName=function(){return this.ga.name};var uc=function(){var a=tc;return new qc(a,a.ga.root)};var tc=j,vc;var wc=n.requestFileSystem||n.webkitRequestFileSystem;if(da(wc)){var xc=new I;wc(1,5242880,function(a){xc.w(new sc(a))},function(a){J(xc,new M(a.code,"requesting filesystem"))});vc=xc}else{var yc=new I;J(yc,Error("File API unsupported"));vc=yc}L(vc,function(a){tc=a});var zc=function(a,b){var c=new I,d=uc().getFile("/"+a+"/"+b);L(d,function(a){L(a.file(),function(a){var b=new lc,d=new I;b.addEventListener("loadend",ja(function(a,b){var c=b.O.result,d=b.getError();c!=j&&!d?a.w(c):J(a,d);b.lc()},d,b));b.O.readAsDataURL(a);L(d,function(a){c.w(a)})})});K(d,j,function(){J(c)},h);return c};var Ac=function(a){this.b=a;this.N=new I};Ac.prototype.dd=function(){this.N.w(this.b)};Ac.prototype.pa=function(){J(this.N,this.b)};Ac.prototype.Kc=function(a){a=a.removeRecursively();L(a,this.dd,this);K(a,j,this.pa,this)};Ac.prototype.remove=function(){var a=uc().getDirectory("/"+this.b+"/");L(a,this.Kc,this);K(a,j,this.pa,this);return this.N};var Bc=function(a,b,c){this.N=new I;this.ka=a;this.vb=b;this.Oc=c;this.Sa=""};l=Bc.prototype;l.Zc=function(){this.N.w(this.Sa)};
l.Rc=function(a){a.addEventListener("writeend",this.Zc,k,this);a.addEventListener("error",this.pa,k,this);var b;switch(this.vb){case "application/x-chrome-extension":case "application/zip":b=new window.Blob([this.ka],{type:this.vb});break;case "image/jpeg":if(b=this.ka.match(/^data:([^;]+);base64,([A-Za-z0-9\+\/=]+)$/)){var c=Cc(b[2]),c=new Uint8Array(c);b=new window.Blob([c],{type:b[1]})}else b=j}b?a.write(b):this.pa()};
l.Yc=function(a){var b=a.createWriter();this.Sa=a.F.toURL(this.vb);L(b,this.Rc,this);K(b,j,this.pa,this)};l.pa=function(a){J(this.N,a)};l.write=function(){K(uc().getFile(this.Oc,2),this.Yc,this.pa,this);return this.N};var Dc=function(a,b){this.N=new I;this.b=a||"Theme-"+Date.now();this.ec=!!b;b||(b={crx:"",zip:"",preview:""});this.la=b},Ec=function(a){var b=new I,c=uc().getDirectory("/"+a+"/");L(c,function(c){var e=new I,f=new I,g=c.Ka.createReader(),m=[],p=q(function(a){J(f,new M(a.code,"listing directory "+this.F.fullPath))},c),u=q(function(a){if(a.length){for(var b=0,c;c=a[b];b++)m.push(c.isFile?new pc(this.ga,c):new qc(this.ga,c));g.readEntries(u,p)}else f.w(m)},c);g.readEntries(u,p);L(f,function(a){var b=
{},c=a.length;if(3<=c){for(var d=0;d<c;d++){var f=a[d];if(f.isFile()){var g="";switch(f.getName()){case "theme.crx":g="crx";break;case "theme.zip":g="zip";break;case "preview.jpeg":g="preview"}g&&(b[g]=f.F.toURL(h))}}b.crx&&b.zip&&b.preview?e.w(b):J(e)}else J(e)});K(f,j,function(){J(e)},h);L(e,function(c){b.w(new Dc(a,c))});K(e,j,function(){J(b)},h)});K(c,j,function(){J(b)},h);return b};Dc.prototype.R=function(){return this.b};
Dc.prototype.Wc=function(a){L(this.N,function(){a(i,this)},this);K(this.N,j,function(){a(k,this)},this)};
var Fc=function(a,b,c,d){var e="",f="/"+a.b+"/";switch(c){case "crx":e="application/x-chrome-extension";f+="theme.crx";break;case "zip":e="application/zip";f+="theme.zip";break;case "preview":e="image/jpeg",f+="preview.jpeg"}b=(new Bc(b,e,f)).write();L(b,function(a){this.la[c]=a;d.w(a);this.la.crx&&(this.la.zip&&this.la.preview)&&this.N.w(this)},a);K(b,j,function(a){J(d,a);J(this.N,a)},a)},Gc=function(a,b,c){var d=new I;if(a.ec)Fc(a,b,c,d);else{var e=uc().getDirectory("/"+a.b+"/",3);L(e,function(){this.ec=
i;Fc(this,b,c,d)},a);K(e,j,function(){Fc(this,b,c,d)},a)}};Dc.prototype.Ua=function(a,b){var c=(new Ac(this.b)).remove();b=b||j;L(c,function(c){a.call(b,i,c)});K(c,j,function(c){a.call(b,k,c)},h)};var Hc={},Ic=function(a,b){Hc[a]||(Hc[a]=[]);Hc[a].push(b)},N=function(a,b){chrome.extension.sendMessage({type:a,data:b},function(){})};chrome.extension.onMessage.addListener(function(a,b,c){var d=a.type,e=a.data;if(Hc[d]){var f=function(a,b){c({type:a,data:b})};Hc[d].forEach(function(a){a(e,b,f)})}});var Jc=j,Kc=j,Mc=function(a){var b=ba(a);if(!("array"==b||"object"==b&&"number"==typeof a.length))throw Error("encodeByteArray takes an array as a parameter");Lc();for(var b=Jc,c=[],d=0;d<a.length;d+=3){var e=a[d],f=d+1<a.length,g=f?a[d+1]:0,m=d+2<a.length,p=m?a[d+2]:0,u=e>>2,e=(e&3)<<4|g>>4,g=(g&15)<<2|p>>6,p=p&63;m||(p=64,f||(g=64));c.push(b[u],b[e],b[g],b[p])}return c.join("")},Cc=function(a){Lc();for(var b=Kc,c=[],d=0;d<a.length;){var e=b[a.charAt(d++)],f=d<a.length?b[a.charAt(d)]:0;++d;var g=
d<a.length?b[a.charAt(d)]:0;++d;var m=d<a.length?b[a.charAt(d)]:0;++d;if(e==j||f==j||g==j||m==j)throw Error();c.push(e<<2|f>>4);64!=g&&(c.push(f<<4&240|g>>2),64!=m&&c.push(g<<6&192|m))}return c},Lc=function(){if(!Jc){Jc={};Kc={};for(var a=0;65>a;a++)Jc[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a),Kc[Jc[a]]=a}};var Nc=function(){};var Oc=function(){this.o=[];this.Eb=[];this.Uc=[];this.ib=[];this.ib[0]=128;for(var a=1;64>a;++a)this.ib[a]=0;this.reset()};r(Oc,Nc);Oc.prototype.reset=function(){this.o[0]=1732584193;this.o[1]=4023233417;this.o[2]=2562383102;this.o[3]=271733878;this.o[4]=3285377520;this.Nb=this.Na=0};
var Pc=function(a,b,c){c||(c=0);var d=a.Uc;if(ca(b))for(var e=0;16>e;e++)d[e]=b.charCodeAt(c++)<<24|b.charCodeAt(c++)<<16|b.charCodeAt(c++)<<8|b.charCodeAt(c++);else for(e=0;16>e;e++)d[e]=b[c++]<<24|b[c++]<<16|b[c++]<<8|b[c++];for(e=16;80>e;e++){var f=d[e-3]^d[e-8]^d[e-14]^d[e-16];d[e]=(f<<1|f>>>31)&4294967295}b=a.o[0];c=a.o[1];for(var g=a.o[2],m=a.o[3],p=a.o[4],u,e=0;80>e;e++)40>e?20>e?(f=m^c&(g^m),u=1518500249):(f=c^g^m,u=1859775393):60>e?(f=c&g|m&(c|g),u=2400959708):(f=c^g^m,u=3395469782),f=(b<<
5|b>>>27)+f+p+u+d[e]&4294967295,p=m,m=g,g=(c<<30|c>>>2)&4294967295,c=b,b=f;a.o[0]=a.o[0]+b&4294967295;a.o[1]=a.o[1]+c&4294967295;a.o[2]=a.o[2]+g&4294967295;a.o[3]=a.o[3]+m&4294967295;a.o[4]=a.o[4]+p&4294967295};
Oc.prototype.update=function(a,b){b===h&&(b=a.length);for(var c=b-64,d=0,e=this.Eb,f=this.Na;d<b;){if(0==f)for(;d<=c;)Pc(this,a,d),d+=64;if(ca(a))for(;d<b;){if(e[f++]=a.charCodeAt(d++),64==f){Pc(this,e);f=0;break}}else for(;d<b;)if(e[f++]=a[d++],64==f){Pc(this,e);f=0;break}}this.Na=f;this.Nb+=b};
var Qc=function(a){var b=[],c=8*a.Nb;56>a.Na?a.update(a.ib,56-a.Na):a.update(a.ib,64-(a.Na-56));for(var d=63;56<=d;d--)a.Eb[d]=c&255,c/=256;Pc(a,a.Eb);for(d=c=0;5>d;d++)for(var e=24;0<=e;e-=8)b[c++]=a.o[d]>>e&255;return b};var O=function(a,b,c,d){this.J=new XMLHttpRequest;this.zb=a;this.Sa=b;this.jb=c;this.J.onreadystatechange=q(this.Tc,this);this.J.onabort=q(this.Sc,this);this.jb.onprogress&&this.J.upload.addEventListener("progress",this.jb.onprogress,k);d&&Ma(this.J,d)};O.prototype.Tc=function(){if(this.J.readyState==this.J.DONE)if(200<=this.J.status&&300>this.J.status&&this.J.response)this.jb.onload(this.J);else this.J.abort()};O.prototype.Sc=function(){this.jb.onerror(this.J)};
O.prototype.send=function(a){a=a||j;this.J.open(this.zb,this.Sa,i);this.J.send(a)};var Rc=function(a,b){O.call(this,"POST","https://www.mychrometheme.com/upload",b);this.T=a};r(Rc,O);
Rc.prototype.send=function(a){var b=a.crx.substring(a.crx.indexOf(",")+1),c,d=3*b.length/4-(b.match(/=/g)||[]).length;c=Ka(this.T.name)||[];var e=[],f=new ArrayBuffer(28),f=new Uint8Array(f);n.window.crypto.getRandomValues(f);C(e,f);var d=D(d,4),g=new Oc;g.update(f);g.update(d);g.update(c);C(e,Qc(g));c=String.fromCharCode.apply(j,e);c=n.btoa(c);a=c+b+"||"+a.preview+"||"+JSON.stringify(this.T);Rc.fa.send.call(this,a)};
var Sc=function(a,b){O.call(this,"POST","https://www.mychrometheme.com/delete",b);this.T=a};r(Sc,O);Sc.prototype.send=function(){var a=JSON.stringify({guid:this.T.guid,secret:this.T.secret});Sc.fa.send.call(this,a)};var Tc=function(a,b){O.call(this,"POST","https://www.mychrometheme.com/share",b);this.T=a};r(Tc,O);Tc.prototype.send=function(){var a=JSON.stringify({guid:this.T.guid,secret:this.T.secret});Tc.fa.send.call(this,a)};
var Uc=function(a,b){O.call(this,"POST","https://www.mychrometheme.com/unshare",b);this.T=a};r(Uc,O);Uc.prototype.send=function(){var a=JSON.stringify({guid:this.T.guid,secret:this.T.secret});Uc.fa.send.call(this,a)};var P=function(a){this.b=a||"";this.wa=this.h=j;this.Wa=k;Vc(this)},Vc=function(a){try{a.h=JSON.parse(localStorage.getItem(a.b)),a.Wa=!a.h}catch(b){a.Wa=i}};P.prototype.update=function(){Vc(this)};P.prototype.R=function(){return this.b};var Wc=function(a){return a.h.urls.share},Xc=function(){return Q.z.h.guid||""};P.prototype.Vb=function(){return this.h.isShared};var Yc=function(a){return/^https?:\/\//.test(a.h.urls.crx)},Zc=function(a){return!!a.h.urls.share};
P.prototype.Jc=function(){Yc(this)?($c(this),this.eb(i,this.b,{error:""})):ad(this)};P.prototype.Ic=function(){this.eb(k,this.b,{error:"server"})};
var bd=function(a){if(a.h.urls.share){var b={id:a.b,guid:a.h.guid,secret:a.h.secret};a={onload:q(a.Jc,a),onerror:q(a.Ic,a)};(new Sc(b,a)).send(j)}else ad(a)},$c=function(a){localStorage.removeItem(a.b);var b=JSON.parse(localStorage.getItem("themes"));a=b.indexOf(a.b);-1!=a&&(b.splice(a,1),localStorage.setItem("themes",JSON.stringify(b)))},ad=function(a){a.wa.Ua(function(a,c){$c(this);this.eb(a,c,{error:a?"":"local"})},a)};
P.prototype.Ua=function(a){this.eb=a;!Yc(this)&&!this.wa?(a=Ec(this.b),L(a,function(a){this.wa=a;bd(this)},this),K(a,j,function(){this.eb(k,this.b,{error:"fetching"})},this)):bd(this)};var cd=function(a){localStorage.setItem(a.b,JSON.stringify(a.h))};P.prototype.Bc=function(a){a=JSON.parse(a.responseText);a.ok?(this.h.secret=a.content.secret,this.h.urls.share=a.content.url,this.h.guid=a.content.guid,this.h.isShared=i,cd(this),this.V.success(i,this.b,this.h.urls.share)):this.V.success(k,this.b)};
P.prototype.Ac=function(){this.V.success(k,this.b)};P.prototype.zc=function(){this.h.isShared=i;cd(this);this.V.success(i,this.b,Wc(this))};P.prototype.yc=function(){this.V.success(k,this.b)};
var dd=function(a){if(Zc(a)){var b={id:a.b,guid:a.h.guid,secret:a.h.secret};a={onload:q(a.zc,a),onerror:q(a.yc,a)};(new Tc(b,a)).send()}else{var b=a.wa,c=new I,d={};L(zc(b.b,"theme.crx"),function(a){d.crx=a;d.preview&&c.w(d)});L(zc(b.b,"preview.jpeg"),function(a){d.preview=a;d.crx&&c.w(d)});L(c,function(a){var b={name:this.h.name,description:this.h.desc},c={onload:q(this.Bc,this),onerror:q(this.Ac,this)};this.V.onprogress&&(c.onprogress=this.V.onprogress);(new Rc(b,c)).send(a)},a)}};
P.prototype.Ec=function(){this.h.isShared=k;cd(this);this.V.success(i,this.b)};P.prototype.Dc=function(){this.V.success(k,this.b)};P.prototype.kc=function(a,b){if(b&&this.Vb()&&Zc(this)){this.V=a;var c={id:this.b,guid:this.h.guid,secret:this.h.secret},d={onload:q(this.Ec,this),onerror:q(this.Dc,this)};(new Uc(c,d)).send()}else this.V=a,!Zc(this)&&!this.wa?L(Ec(this.b),function(a){this.wa=a;dd(this)},this):dd(this)};var ed=function(a){this.ua=a;this.Ob=this.Pb=k};l=ed.prototype;l.close=function(){window.webkitURL.revokeObjectURL(this.ua.src);this.disconnect()};l.disconnect=function(){this.ua.src="";this.Pb=k};l.connect=function(){this.ua.src=this.mc;this.Pb=i};l.bd=function(a,b){this.mc=window.webkitURL.createObjectURL(b);this.Ob=i;this.connect();a&&a(i)};l.cd=function(a,b){this.Ob=i;a&&a(k,b)};
l.ra=function(a){if(this.Pb)return k;this.mc?this.connect():navigator.webkitGetUserMedia({video:i},q(this.bd,this,a),q(this.cd,this,a));return i};var R={},fd,gd=function(){var a;a=R.ia;var b=$("#captured-image")[0];a.ua.src?(b.width=a.ua.videoWidth,b.height=a.ua.videoHeight,b.getContext("2d").drawImage(a.ua,0,0,b.width,b.height),a=b):a=j;a&&(R.ia.disconnect(),$("#webcam-container")[0].dataset.view="captured")},hd=function(){R.ia.ra();$("#webcam-container")[0].dataset.view="capture"},id=function(){var a=fd;a&&a.done&&(a.done($("#captured-image")[0].toDataURL("image/png"),"image/png"),$("#webcam-container")[0].dataset.view="capture")},jd=function(){if(R.ia.Ob){var a=
fd;R.ia.disconnect();a&&a.close&&a.close()}};var kd=function(a,b,c){a/=255;b/=255;c/=255;var d=Math.max(a,b,c),e=Math.min(a,b,c),f=0,g=0,m=0.5*(d+e);d!=e&&(d==a?f=60*(b-c)/(d-e):d==b?f=60*(c-a)/(d-e)+120:d==c&&(f=60*(a-b)/(d-e)+240),g=0<m&&0.5>=m?(d-e)/(2*m):(d-e)/(2-2*m));return[Math.round(f+360)%360,g,m]},ld=function(a,b,c){0>c?c+=1:1<c&&(c-=1);return 1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+6*(b-a)*(2/3-c):a},md=function(a,b,c){var d=0,e=0,f=0;a/=360;if(0==b)d=e=f=255*c;else var g=f=0,g=0.5>c?c*(1+b):c+b-b*c,f=2*c-g,d=255*ld(f,g,a+1/3),e=255*ld(f,
g,a),f=255*ld(f,g,a-1/3);return[Math.round(d),Math.round(e),Math.round(f)]};var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-31000769-1"]);var nd=_gaq,od=["_gaq"],pd=n;!(od[0]in pd)&&pd.execScript&&pd.execScript("var "+od[0]);for(var qd;od.length&&(qd=od.shift());)!od.length&&nd!==h?pd[qd]=nd:pd=pd[qd]?pd[qd]:pd[qd]={};var rd=[1,"app user","creator"],sd=[2,"color source","feeling lucky"];var td=function(a){this.ka=a.data;this.wb={Ja:{"0":0},xb:0,na:[0,0,0],bc:0,ac:0,$a:0};this.$b=k},ud=function(a){for(var b=a.ka,c=b.length,d=0;d<c;d+=4)if(!(240>b[d+3])){var e=a,f=kd(b[d],b[d+1],b[d+2]),e=e.wb,g=Math.round(f[0])%360;e.na[0]+=f[0];e.na[1]+=f[1];e.na[2]+=f[2];e.Ja[g]=(e.Ja[g]||0)+1;e.Ja[g]>e.Ja[e.xb]&&(e.xb=g);f[1]||++e.bc;f[2]||++e.ac;++e.$a}a.$b=i;return a},vd=function(a,b,c,d,e){a=a.getContext("2d").getImageData(b||0,c||0,d||a.width,e||a.height);a=ud(new td(a));a.$b||ud(a);if(a.wb.$a){a=
a.wb;b=a.xb;c=a.na[1]/a.$a;d=a.na[2]/a.$a;if(0==b){e=a.Ja[0];var f=Math.abs(e-a.bc);Math.abs(e-a.ac)>e?d=0:f>e&&(c=0)}a=md(b,c,d)}else a=[];return a};var wd=function(){this.Ia=new RSAKey};wd.prototype.generate=function(a,b){this.Ia.generate(a,b)};var xd=new Uint8Array([48,13,6,9,42,134,72,134,247,13,1,1,1,5,0]),yd=function(a,b){b&=4294967295;128>b?a.push(b):256>b?a.push(129,b):65536>b?a.push(130,b>>8,b):16777216>b?a.push(131,b>>16,b>>8,b):a.push(132,b>>24,b>>16,b>>8,b)},zd=function(a,b,c){b=c?Sa(b):D(b,0,i);a.push(2);yd(a,b.length);C(a,b)},Ad=new Uint8Array([48,33,48,9,6,5,43,14,3,2,26,5,0,4,20]);var Bd=function(a){this.da={name:a||ka,version:"1.0",manifest_version:2,description:"",theme:{images:{},colors:{},properties:{}}};this.setProperty("ntp_background_repeat","no-repeat");this.setProperty("ntp_background_alignment","left top");this.images=[]},Cd={theme_ntp_background:"theme_ntp_background.png",theme_frame:"theme_frame.png",theme_toolbar:"theme_toolbar.png",theme_tab_background:"theme_tab_background.png",theme_ntp_attribution:"theme_ntp_attribution.png"};Bd.prototype.getName=function(){return this.da.name};
var Dd=function(a,b,c,d){Ga(b in Cd);var e=c.match(/^data:image\/(png|jpeg|gif);base64,/),f,g="png";if(e)c=c.substring(e[0].length),g=e[1];else if(d&&(f=d.match(/image\/(png|jpeg|gif)/)))g=f[1];d=Cd[b].replace(/png$/,g);a.images.push({name:d,data:c});a.da.theme.images[b]="images/"+d},Ed=function(a,b,c){c="string"==typeof c?Ta(c):c;a.da.theme.colors[b]=c};Bd.prototype.setProperty=function(a,b){this.da.theme.properties[a]=b;return this};Bd.prototype.toJSON=function(){return JSON.stringify(this.da)};var Fd=function(){this.Ba=4294967295},Gd=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,
853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,
4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,
225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,
2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,
2932959818,3654703836,1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];Fd.prototype.update=function(a){"string"===typeof a&&(a=a.split("").map(function(a){return a.charCodeAt(0)}));var b,c,d=a.length;for(c=0;c<d;++c)b=(this.Ba^a[c])&255,this.Ba=this.Ba>>>8^Gd[b];this.Ba^=4294967295;return this};var Hd=function(){this.k=[];this.Ta={};this.B=k;this.qa=j};l=Hd.prototype;l.add=function(a,b,c){c=c||{};"string"==typeof a&&(a=a.split("/"));var d=a.length,e,f;for(e=0;e<d-1;++e)f=d-1-e,this.add(a.slice(0,f),"",{cc:i,Za:c.Za});a=a.join("/");c.cc&&!/\/$/.test(a)&&(a+="/");d=new Id(a,c);d.setData(b,c.Fc);this.Ta[a]=d;this.B=k;return this};
l.generate=function(){var a=[],b=[],c=0,d=0,e;for(e in this.Ta)if(this.Ta.hasOwnProperty(e)){var f=this.Ta[e],g;g=f;g.B||Jd(g);var m=[80,75,3,4];C(m,g.S);C(m,g.rb);C(m,g.ka);g=m;m=c;f.B||Jd(f);var p=[80,75,1,2,20,0];C(p,f.S);C(p,[0,0,0,0,0,0]);C(p,f.Cc?[16,0,0,0]:[0,0,0,0]);C(p,D(m,4));C(p,f.rb);f=p;c+=g.length;d++;C(b,g);C(a,f)}c=[80,75,5,6,0,0,0,0];C(c,D(d,2));C(c,D(d,2));C(c,D(a.length,4));C(c,D(b.length,4));C(c,[0,0]);this.k=[];C(this.k,b);C(this.k,a);C(this.k,c);this.B=i;return this};
l.Qb=function(){return this.B?(this.qa||(this.qa=new Uint8Array(this.k)),this.qa):j};l.toString=function(){return!this.k.length?"":String.fromCharCode.apply(j,this.k)};l.Sb=function(){return Mc(this.k)};l.toDataURL=function(){var a=this.Sb();return!a?"":"data:application/zip;base64,"+a};
var Id=function(a,b){for(var c=this.name=a,d=[],e=0,f=0;f<c.length;f++){for(var g=c.charCodeAt(f);255<g;)d[e++]=g&255,g>>=8;d[e++]=g}this.rb=d||[];c=b.Za||new Date;d=c.getUTCHours()<<6;d=(d|c.getUTCMinutes())<<5;d|=c.getUTCSeconds()/2;e=c.getUTCFullYear()-1980<<4;e=(e|c.getUTCMonth()+1)<<5;e|=c.getUTCDate();this.dc={time:d&65535,Za:e&65535};this.Cc=!!b.cc;this.size=0;this.S=[10,0,0,0,0,0];this.B=k};
Id.prototype.setData=function(a,b){this.ka=b?Cc(a):Ka(a)||[];var c=new Fd;c.update(this.ka);this.Hc=c.Ba;this.size=this.ka.length;this.B=k;return this};var Jd=function(a){6!=a.S.length&&(a.S=[10,0,0,0,0,0],a.B=k);C(a.S,D(a.dc.time,2));C(a.S,D(a.dc.Za,2));C(a.S,D(a.Hc,4));C(a.S,D(a.size,4));C(a.S,D(a.size,4));C(a.S,D(a.rb.length,2));C(a.S,[0,0]);a.B=i};"function"===typeof BigInteger.setupEngine&&"function"===typeof BigInteger.am4&&BigInteger.setupEngine(BigInteger.am4,26);var Kd=function(a){this.Xa=a;this.k=[];this.B=k;this.qa=j;this.reset(i)};
Kd.prototype.reset=function(a){Ld(this);if(a===i){this.key=new wd;this.key.generate(1024,"10001");var b=this.key;a=[];zd(a,b.Ia.n,i);zd(a,b.Ia.e);b=[];b.push(48);yd(b,a.length);C(b,a);a=[];a.push(3);yd(a,b.length+1);a.push(0);C(a,b);b=[];b.push(48);yd(b,xd.length+a.length);C(b,xd);C(b,a);this.Zb=b;this.B=k}this.Va=new Hd;this.B=this.B=k;return this};var Ld=function(a){a.k=[67,114,50,52,2,0,0,0];a.B=k};l=Kd.prototype;
l.generate=function(){if(!this.Xa)throw Error("Set a manifest file first using CRX#setManifest");if(!this.key)throw Error("Key not set. Try CRX#resetKey");8!==this.k.length&&Ld(this);this.Va.add("manifest.json",this.Xa.toJSON());var a=this;this.Xa.images.forEach(function(b){a.Va.add(["images",b.name],b.data,{Fc:i})});var b;b=this.Va.generate().k;var c=this.key,d=[0,1],e=new Oc;e.update(b);var e=Qc(e),f=[0];C(f,Ad);C(f,e);for(var e=c.Ia.n.bitLength()/8,g=e-(d.length+f.length),m=[],p=0;p<g;p++)m[p]=
255;C(d,m);C(d,f);f=d.byteLength||d.length;m=[];for(g=0;g<f;++g)p=d[g]&255,m.push((16>p?"0":"")+p.toString(16));d=new BigInteger(m.join(""),16);c=c.Ia.doPrivate(d);d=Sa(c);d.length==e+1&&(0==c.s&&0==d[0])&&d.shift();C(this.k,D(this.Zb.length,4));C(this.k,D(d.length,4));C(this.k,this.Zb);C(this.k,d);C(this.k,b);this.B=i;return this};l.Qb=function(){this.B&&!this.qa&&(this.qa=new Uint8Array(this.k));return this.B?this.qa:j};l.size=function(){return this.k.length};
l.toString=function(){return!this.Xa||!this.key||!this.B||8>=this.k.length?"":String.fromCharCode.apply(j,this.k)};l.Sb=function(){return Mc(this.k)};l.toDataURL=function(){var a=this.Sb();return a?"data:application/x-chrome-extension;base64,"+a:""};var Md,Rd=function(a,b){if(a){S(k);T(U.tb);window.setTimeout(function(){var a=b.name,c=V("theme_str");RegExp(c,"i").test(a)&&(RegExp("(\\S"+c+")|("+c+"\\S)","i").test(a)||(c=""));a=V("woohoo_text",[a,c]);a=a.replace(/ +/g," ");$("#woohoo > .text")[0].innerText=a;$("#woohoo")[0].classList.add("show")},0);var c=[];Nd&&c.push(sd);Od&&c.push([3,"filter",Od]);N("analytics",{status:"finish",data:{type:"Theme",label:"",opt_vars:c}});N("create",{themeId:b.id})}else Pd({title:V("error"),message:V("upload_crx_error_msg"),
ok:V("retry"),cancel:V("goback")},function(a){a?Q.Wb():(Q=j,T(Qd[W]))})},ce=function(){S(i);T(U.xc);var a=new Bd,b=$("#theme-name")[0].value.substring(0,40).trim();a.da.name=b||ka;b=$("#desc-text-area")[0].value;a.da.description=b||"";A.oa&&(b=Sd(),Dd(a,"theme_ntp_background",b,"image/jpeg"),"repeat"==A.i&&a.setProperty("ntp_background_repeat","repeat"),b=A,a.setProperty("ntp_background_alignment","fit-screen"==b.i?b.M.split("-")[0]:"fill"==b.i?b.K.split("-")[0]:"repeat"==b.i?b.aa:b.$));b=Td.ma();
Ed(a,"tab_text",b[0]);Ed(a,"tab_background_text",b[1]);Ed(a,"bookmark_text",b[0]);Ed(a,"frame",Ud.ma());b=Vd.apply(j,Wd())?"#fff":"#000";Ed(a,"ntp_text",b);Ed(a,"ntp_link",b);Ed(a,"ntp_link_underline",b);b=sa(Ud.ma(),80,Xd);Dd(a,"theme_frame",b);b=sa(Yd.ma(),120,Zd);Dd(a,"theme_toolbar",b);b=Ta(Yd.ma());Ed(a,"toolbar",b.concat([0.6]));b=sa($d.ma(),65,ae);Dd(a,"theme_tab_background",b);Ed(a,"ntp_background",A.ma());var b={},c;qa(Ud,w(i),0,0);qa($d,w(),0,0);qa(Yd,w(),0,0);qa(A,w(),oa,59);qa(Td,w(),
0,0);$("#icon-canvas")[0].classList.contains("hidden")||qa(be,w(),0,0);c=w().toDataURL("image/jpeg");b.image=c;Q=new Md(a,b,Rd);Q.Wb()},ee=function(){de()||(0<$("#theme-name")[0].value.substring(0,40).trim().length?ce():Pd({title:V("informative"),message:V("no_theme_name_error_msg"),ok:V("yes"),cancel:V("no")},function(a){a?ce():T(Qd[W])}))},he=function(a,b){S(k);a?(fe(Wc(Q.z)),$("#share-progress-bar")[0].style.width="0%",N("analytics",{status:"publish",data:{type:"Theme",label:Xc()}}),N("share",
{status:"shared",data:{themeId:b}})):(ge(V("error_while_publishing"),"unshared"),N("share",{status:"error",data:{themeId:b}}))},ie=function(a,b){a&&N("analytics",{status:"upload",data:{type:"Theme",label:Xc()}});he(a,b)},je=function(a){var b=$("#share-progress-bar")[0];a=Math.round(100*a.loaded/a.total)+"%";b.style.width=a;b.innerText=a},ke=function(a,b){S(k);a?(fe(),N("analytics",{status:"unpublish",data:{type:"Theme"}}),N("unshare",{status:"unshared",data:{themeId:b}})):(ge(V("error_while_unpublishing"),
"shared"),N("unshare",{status:"error",data:{themeId:b}}))},le=function(a){var b=$("#share-box")[0],c=$("#share-box > .text")[0];switch(a){case "shared":c.innerText=V("share_box_text");break;case "unshared":c.innerText=V("publish_theme_text");break;case "sharing":case "resharing":c.innerText=V("publishing");break;case "unsharing":c.innerText=V("unpublishing")}b.dataset.state=a},ge=function(a,b){$("#share-box .error-container")[0].innerText=a;le("unshare-error");setTimeout(q(function(a){le(a)},j,b),
2E3)},me=function(){if(!this.classList.contains("disabled")){S(i);var a={success:he};Zc(Q.z)?le("resharing"):(a.success=ie,a.onprogress=je,le("sharing"));Q.z.kc(a,k);N("share",{status:"sharing",data:{themeId:Q.z.R()}})}},ne=function(){if(!this.classList.contains("disabled")&&Q.z.Vb()){S(i);le("unsharing");var a={success:ke};N("unshare",{status:"unsharing",data:{themeId:Q.z.R()}});Q.z.kc(a,i)}},Sd=function(){switch(A.i){case "fill":var a=A,b=w(i,a.q,a.t),c=b.getContext("2d"),d=a.Qa,e=a.Pa,f=0,g=0;
switch(a.K){case "left-fill-h":case "top-fill-v":g=f=0;break;case "top-center-fill-h":f=(b.width-d)/2;g=0;break;case "right-fill-h":f=b.width-d;g=0;break;case "left-center-fill-v":f=0;g=(b.height-e)/2;break;case "bottom-fill-v":f=0,g=b.height-e}c.beginPath();c.fillStyle=a.color;c.fillRect(0,0,b.width,b.height);c.drawImage(a.g,f,g,d,e);return b.toDataURL("image/jpeg");case "fit-screen":return Aa();default:return"image/png"==A.Ha?Aa():A.g.src}},oe=function(a){var b="on"==a.state?"plusone":"minusone";
a=(a=a.href.match(/\/([^\/]+)$/))?a[1]:"";N("analytics",{status:b,data:{type:"PlusOne",label:a,opt_vars:[rd]}})},pe=function(){$("#woohoo")[0].classList.remove("show")},qe=function(){if(qe.selected)re();else{var a=$("#theme-url input")[0];a.select();a.focus();$("#url-tip")[0].classList.add("show");qe.selected=i}},re=function(){$("#url-tip")[0].classList.remove("show");qe.selected=k},se=function(){Q.nd()},te=function(){if(!this.classList.contains("disabled")){var a=this.dataset.id;if(a){var b=new P(a);
b.Wa||(a=Yc(b)?Wc(b):chrome.extension.getURL("../views/preview.html")+"#"+a,chrome.tabs.create({url:a},function(){}))}}},T=function(a){$("#main-container")[0].className=a},ve=function(a,b,c){G(k);if(!de()){X&&$("#"+X)[0].classList.remove("selected");b!=j&&0<=b?W=b:a?W++:W--;if(b=c)if(b=1==W)b=!A.oa;b&&(a?W++:W--);!a&&0==W&&($("#image-alignment")[0].dataset.id="none",ue());2==W?($("#save-continue")[0].innerText=V("continue_to",V("sn_3")),$("#previous-step")[0].innerText=V("step",V("sn_1")),$("#previous-step-text")[0].innerText=
V("step1_btn_txt",""),A.wc()?($("#background .pin")[0].style.backgroundColor="",a=$("#background")[0],a.dataset.color="",a.classList.remove("enable-default"),a.classList.add("hidden"),A.H()):$("#background")[0].classList.remove("hidden")):($("#save-continue")[0].innerText=V("continue_to",V("sn_2")),2<W&&($("#previous-step")[0].innerText=V("step",V("sn_2")),$("#previous-step-text")[0].innerText=V("step2_btn_txt","")));T(Qd[W])}},de=function(){return"true"==$("#main-container")[0].getAttribute("disabled")},
S=function(a){$("#main-container")[0].setAttribute("disabled",a);$(".upload-file")[0].disabled=a;$("#theme-name")[0].disabled=a},hb=function(a){return function(b){S(k);a&&a(b)}},Pd=function(a,b){S(i);var c=hb(b),d=function(){G(k);e.removeClass("show");$(".ok, .close",e).unbind("click");c&&c(k)},e=$("#confirm-container");$(".title",e).text(a.title);$(".message",e).text(a.message);$(".ok",e).text(a.ok);$(".cancel",e).text(a.cancel);e.addClass("show");$(".ok",e).click(function(){G(k);e.removeClass("show");
$(".ok, .close",e).unbind("click");c&&c(i)});G(i,d);$(".close",e).click(d)},xe=function(){document.removeEventListener("keydown",we,k);ve(i);N("analytics",{status:"start",data:{type:"Theme",label:""}})},ze=function(){"save-continue"==this.id?0==W?Pd({title:V("warning"),message:V("no_image_uploaded_msg"),ok:V("yes"),cancel:V("no")},function(a){a&&ve(i,-1,i)}):ve(i,-1,i):(3==W&&Nd&&(Nd=k,ye()),ve(k,-1,i))},Be=function(){if(this.files.length){var a=this.files[0];if(a.type.match(/image.(jpg|jpeg|png|gif|bmp)/ig))if(5242880<
a.size){$(".upload-file").val("");var b={title:V("error"),message:V("image_size_error_msg",[5,V("size_unit_mb")])};S(i);ib(b)}else b=new FileReader,b.onload=function(b){Ae();var d=document.createElement("img");d.onload=function(){za(b.target.result,a.type,j);ve(i);$(".upload-file").val("")};d.onerror=function(){var a={title:V("error"),message:V("image_format_error_msg")};S(i);ib(a);$(".upload-file").val("")};d.src=b.target.result},b.readAsDataURL(a);else $(".upload-file").val(""),b={title:V("error"),
message:V("image_type_error_msg"),moreInfo:V("image_type_error_info")},S(i),ib(b)}},De=function(a,b){Ae();za(a,b);Ce("fit-screen");ve(i);N("analytics",{status:"webcam",data:{type:"Theme",label:""}})},Fe=function(){Ee()},Ge=function(){if(!de()&&!this.classList.contains("disabled")){T(U.$c);var a={done:De,close:Fe};R.ia?(R.ia.ra(),$("#webcam-container")[0].dataset.view="capture"):(fd=a,R.ia=new ed($("#webcam video")[0]),R.ia.ra(function(a){a?(F($("#capture"),"click",gd),F($("#webcam-retake"),"click",
hd),F($("#webcam-done"),"click",id),F($("#webcam-close")[0],"click",jd),$("#webcam-container")[0].dataset.view="capture"):(jd(),delete R.ia)}));G(i,jd)}},Le=function(){switch(this.id){case "change-align":var a=$("#image-alignment")[0];a.dataset.isset||He(a);Ie();T(U.Pc);G(i,Ee);break;case "change-img":Pd({title:V("warning"),message:V("back_to_step1_msg"),ok:V("yes"),cancel:V("no")},function(a){a&&ve(k)});break;case "open-filters":if(T(U.Qc),G(i,Ee),Db)document.addEventListener("keyup",Nb,k);else{var a=
$("#filters-main")[0],b=$("#filters-thumbs")[0],c=$("#templates .filters-thumb")[0];b.innerHTML="";var d=A.g,e=A.Ha,f=Je;Hb=a;Ib=f;d=Eb=new lb(d.cloneNode(i),e);d=Gb=new zb(ub,d);d.onselect=Jb;d.render(b,c);Hb.querySelector(".done").addEventListener("click",Lb,k);Hb.querySelector(".cancel").addEventListener("click",Mb,k);Cb(d);document.addEventListener("keyup",Nb,k);Db=i;a.querySelector(".close").addEventListener("click",Ke,k);b.scrollTop=0}}},Ie=function(){$("#disabled-alignments")[0].classList.add("hidden")},
Ce=function(a){var b=$("#image-alignment")[0],c=$("#"+a)[0].parentNode.parentNode;if(b.dataset.id==a)c.classList.remove("expand"),b.dataset.id="none",x(A,"custom");else{b.dataset.id=a;b=$(".expand",b);b[0]&&b[0].classList.remove("expand");switch(a){case "fit-screen":x(A,a,A.M);break;case "fill":x(A,a,A.K);break;case "custom":$('#position td[data-id="'+A.$+'"]')[0].classList.add("position-selected");x(A,a);break;case "repeat":$('#repeat-option td[data-id="'+A.aa+'"]')[0].classList.add("position-selected"),
x(A,a)}c.classList.add("expand")}},Me=function(){Ie();var a=this.querySelector(".alignment-checkbox-outer").id;if(this.classList.contains("disabled")){var a=this.parentNode.offsetTop,b=$("#disabled-alignments")[0];b.style.top=a-30+"px";b.classList.remove("hidden")}else Ce(a)},Ne=function(){Ie();"fit-screen"!=$("#image-alignment")[0].dataset.id||A.M==this.id||($("#"+A.M)[0].classList.remove("selected"),this.classList.add("selected"),x(A,"fit-screen",this.id))},Oe=function(){Ie();"fill"!=$("#image-alignment")[0].dataset.id||
A.K==this.id||(this.classList.add("selected"),$("#"+A.K)[0].classList.remove("selected"),x(A,"fill",this.id))},Pe=function(){$("#pos-table-container .image-align.position-selected,#rep-table-container .image-align.position-selected").removeClass("position-selected");$("#pos-table-container .alignment td")[0].classList.add("position-selected");$("#rep-table-container .alignment td")[0].classList.add("position-selected")},Re=function(a){switch(a["fit-screen"]){case 0:$("#fit-screen")[0].parentNode.classList.add("disabled"),
A.M="";case -1:$("#fit-container-h .embed-component.selected")[0]||$("#fit-container-h #top-center-fit-h")[0].classList.add("selected");$("#fitscreen")[0].dataset.type="horizontal";$("#fit-container-v")[0].classList.add("remove");$("#fit-container-h")[0].classList.remove("remove");break;case 1:$("#fit-container-v .embed-component.selected")[0]||$("#fit-container-v #left-center-fit-v")[0].classList.add("selected"),$("#fitscreen")[0].dataset.type="vertical",$("#fit-container-h")[0].classList.add("remove"),
$("#fit-container-v")[0].classList.remove("remove")}switch(a.fill){case -1:$("#fill-container-h .embed-component.selected")[0]||$("#fill-container-h #top-center-fill-h")[0].classList.add("selected");$("#fillscreen")[0].dataset.type="horizontal";$("#fill-container-v")[0].classList.add("remove");$("#fill-container-h")[0].classList.remove("remove");break;case 0:$("#fill")[0].parentNode.classList.add("disabled"),A.K="";case 1:$("#fill-container-v .embed-component.selected")[0]||$("#fill-container-v #top-fill-v")[0].classList.add("selected"),
$("#fillscreen")[0].dataset.type="vertical",$("#fill-container-h")[0].classList.add("remove"),$("#fill-container-v")[0].classList.remove("remove")}switch(a.repeat){case 0:Qe(),$("#repeat")[0].parentNode.classList.add("disabled")}switch(a.custom){case -1:a=document.querySelectorAll(".alignment");for(var b=0;2>b;b++)for(var c=a[b].querySelectorAll("td"),d=3;9>d;d++)c[d].classList.add("image-align-disabled");Pe();break;case 1:a=document.querySelectorAll(".alignment");for(b=0;2>b;b++){c=a[b].querySelectorAll("td");
for(d=0;9>d;d++)0!=d%3&&c[d].classList.add("image-align-disabled")}Pe();break;case 0:$("#custom")[0].parentNode.classList.add("disabled"),Qe()}},Se=function(a,b){var c=b?Ta(b):"",c=c?Vd.apply(j,c):"";switch(a){case "toolbar":Td.H(c?"#fff":"","activeTab");break;case "reartab":Td.H(c?"#fff":"","rearTab")}},Te=function(a,b,c){c=c?c:"";b&&($("#"+a+" .pin")[0].style.backgroundColor=c);switch(a){case "frame":Ud.H(c);break;case "background":A.H(c);break;case "text":Td.H(c);break;case "reartab":$d.H(c);Se(a,
c);break;case "toolbar":Yd.H(c),Se(a,c)}},Ve=function(a){a.stopPropagation();a=this.dataset.id;var b=$("#"+a)[0];b.classList.remove("enable-default");b.dataset.grid="";var c=$("#color-selector-container table td[data-color='"+b.dataset.color+"']")[0];c&&"background"!=a&&c.classList.remove("disabled");b.dataset.color="";Te(a,i);Ue()},Xe=function(a){X&&$("#"+X)[0].classList.remove("selected");Ue();this.classList.add("selected");a.stopPropagation();X=this.id;a=$("#color-picker")[0];a.dataset.id=X;var b=
$("#"+X)[0].dataset.color,c=$("#"+X)[0].dataset.grid;c&&We.select(c);b&&$("#color-selector-container table td[data-color = '"+b+"']")[0].classList.add("selected");a.dataset.isset||He(a);T(U.hd);G(i,Ee)},Ze=function(){var a=Ye;switch(this.id){case "frame":a.context.beginPath();"Pc"==v?(a.context.strokeRect(1,1,Ba-2,Ca-2),a.context.strokeRect(5,34,Ba-10,Ca-30-10)):a.context.strokeRect(1,1,Ba-2,32);break;case "toolbar":a=a.context;a.beginPath();"Mac"==v?(a.moveTo(1,25),a.lineTo(58,25),a.bezierCurveTo(68,
23,71,0,77,2),a.lineTo(195,2),a.bezierCurveTo(202,4,205,27,212,25),a.lineTo(748,25),a.lineTo(748,62)):(a.moveTo(1,25),a.bezierCurveTo(11,23,14,0,20,2),a.lineTo(142,2),a.bezierCurveTo(149,4,152,27,169,25),a.lineTo(748,25),a.lineTo(748,63));a.lineTo(1,62);a.lineTo(1,25);a.stroke();break;case "text":a.context.beginPath();"Pc"==v?(a.context.strokeRect(23,8,65,20),a.context.strokeRect(160,8,85,20)):(a.context.strokeRect(73,8,65,20),a.context.strokeRect(210,8,85,20));break;case "reartab":var b=a.context;
b.beginPath();b.moveTo(a.ja,33);b.bezierCurveTo(a.ja+14,23,a.ja+17,0,a.ja+25,2);b.lineTo(a.ja+143,2);b.bezierCurveTo(a.ja+150,4,a.ja+153,27,a.ja+166,33);b.lineTo(a.ja,33);b.stroke()}},$e=function(){Ye.context.clearRect(0,0,Ba,Ca)},af=function(){$("#desc-left-char-ct")[0].innerText=120-$("#desc-text-area")[0].value.length},cf=function(a){13==a.keyCode?a.preventDefault():27==a.keyCode&&(document.body.removeEventListener("click",bf,i),document.removeEventListener("keydown",cf,k),df(),a.stopPropagation())},
df=function(){var a=$("#desc-text-area")[0];if($("#describe-button")[0].classList.contains("expand"))$("#describe-button")[0].classList.remove("expand"),$("#describe-input")[0].classList.remove("closed"),a.value.length&&a.focus(),document.body.addEventListener("click",bf,i),document.addEventListener("keydown",cf,k);else{a.blur();document.body.removeEventListener("click",bf,i);document.removeEventListener("keydown",cf,k);$("#describe-button")[0].classList.add("expand");$("#describe-input")[0].classList.add("closed");
var b=a.value.replace(/^\s+|\s+$/g,"");b.length?$("#describe-text")[0].innerText=a.value=b:($("#describe-text")[0].innerText=V("theme_description_text"),a.value="");$("#desc-left-char-ct")[0].innerText=120-b.length}},bf=function(a){var b=a.target;"describe-button"==b.id&&!b.classList.contains("expand")&&a.stopPropagation();"desc-close"!=b.id&&$("#describe-input")[0].contains($("#"+a.target.id)[0])||df()},ef=function(a,b){b.stopPropagation();var c=b.currentTarget;if("background"!=X){if(c.classList.contains("disabled"))return;
var d=$("#"+X)[0].dataset.color;d&&$("#color-selector-container table td[data-color='"+d+"']")[0].classList.remove("disabled");c.classList.add("disabled")}Ue();c.classList.add("selected");d=c.querySelector("div").style.backgroundColor;Te(X,i,d.replace(/\s/g,""));d=$("#"+X)[0];d.dataset.grid=a;d.classList.add("enable-default");d.dataset.color=c.dataset.color},He=function(a){var b=$("#canvas-container")[0],c=b.offsetLeft+Ua(b)/2-Ua(a)/2,b=b.offsetTop+40+10+60;a.style.left=c+"px";a.style.top=b+"px"},
Ee=function(){G(k);T(Qd[W]);X&&$("#"+X)[0].classList.remove("selected")},ff=function(){location.href=Q.z.h.urls.crx;N("analytics",{status:"install",data:{type:"Theme",label:Xc(),opt_vars:[rd]}})},gf=function(a){if(!de()){var b=a.currentTarget;if(b.dataset.nextstate||b.dataset.state){a.stopPropagation();a=$("#icon-slider")[0];if(b.dataset.nextstate==a.dataset.state)return i;!a.dataset.state||"off"===a.dataset.state?(b="on",a.classList.add("on"),$("#icon-canvas")[0].classList.remove("hidden")):(b="off",
a.classList.remove("on"),$("#icon-canvas")[0].classList.add("hidden"));a.dataset.state=b;$("#icon-switcher")[0].dataset.state=b}}},Y=function(a,b){var c=(hf-Y.Rb)*-Y.mb;if(b||!("left"==a&&0==Z||"right"==a&&Z==c)){var d=$("#left-theme")[0],e=$("#right-theme")[0];Z+="left"==a?Y.mb:-Y.mb;d.classList.remove("disabled");e.classList.remove("disabled");0==Z&&d.classList.add("disabled");Z<=c&&e.classList.add("disabled");$("#themes-container")[0].style.left=Z+"px"}},jf=function(){this.classList.contains("disabled")||
Y("left-theme"==this.id?"left":"right")},we=function(a){37==a.keyCode&&!$("#left-theme")[0].classList.contains("disabled")?Y("left"):39==a.keyCode&&!$("#right-theme")[0].classList.contains("disabled")&&Y("right")},kf=function(a){if(a=$("#themes-container div[data-id="+a+"]")[0])a.parentNode.removeChild(a),hf--,0>=hf?$("#stored-theme-box")[0].classList.add("hidden"):(a=(0>hf-Y.Rb?0:hf-Y.Rb)*-Y.mb,Z==a?$("#right-theme")[0].classList.add("disabled"):Z<a&&($("#right-theme")[0].classList.add("disabled"),
Y("left",i)))},lf=function(a,b){a?($("#themes-container > div[data-id="+b+"] .msg")[0].innerText=V("deleted"),$("#themes-container > div[data-id="+b+"]")[0].classList.add("show-msg"),N("analytics",{status:"delete",data:{type:"Theme"}}),N("delete",{status:"deleted",data:{themeId:b}}),setTimeout(function(){$("#themes-container")[0].classList.remove("deleting");kf(b)},1E3)):($("#themes-container div[data-id="+b+"] .msg")[0].innerText=V("delete_theme_error_msg"),$("#themes-container div[data-id="+b+"]")[0].classList.add("show-msg"),
setTimeout(q(function(a){a=$("#themes-container div[data-id="+a+"]")[0];a.classList.remove("selected");a.classList.remove("show-msg");a.classList.remove("deleting");$("#themes-container")[0].classList.remove("deleting")},j,b),2E3),N("delete",{status:"error",data:{themeId:b}}))},nf=function(a,b){a?($("#crx-deletion .msg")[0].innerText=V("theme_deleted"),T(U.ed),N("analytics",{status:"delete",data:{type:"Theme"}}),N("delete",{status:"deleted",data:{themeId:b}}),setTimeout(function(){S(k);mf()},1E3)):
(T(U.fd),$("#crx-deletion .msg")[0].innerText=V("delete_theme_error_msg_step4"),setTimeout(function(){S(k);T(U.tb)},2E3),N("delete",{status:"error",data:{themeId:b}}))},of=function(a){a.stopPropagation();this.classList.contains("disabled")||(a=V("warning"),Pd({title:a,message:V("delete_theme_confirm_msg",Q.z.h.name),ok:V("yes"),cancel:V("no")},function(a){a?(S(i),$("#crx-deletion .msg")[0].innerText=V("deleting_theme"),T(U.Gc),Q.z.Ua(nf),N("delete",{status:"deleting",data:{themeId:Q.z.R()}})):T(U.tb)}))},
pf=function(a){a.stopPropagation();var b=this.parentNode;b.classList.add("selected");Pd({title:V("warning"),message:V("delete_theme_confirm_msg",$(".theme-name",b)[0].innerText),ok:V("yes"),cancel:V("no")},function(a){a?(b.classList.add("deleting"),$("#themes-container")[0].classList.add("deleting"),N("delete",{status:"deleting",data:{themeId:b.dataset.id}}),a=new P(b.dataset.id),a.Wa||a.Ua(lf)):(b.classList.remove("selected"),T(U.qc))})},Ue=function(){var a=$("#color-selector-container table .selected")[0];
a&&a.classList.remove("selected")},qf=function(a){return"rgb("+md.apply(j,a).join(",")+")"},Vd=function(a,b,c){return 300>a+b+c},Wd=function(){var a=$("#background-canvas")[0];return vd(a,170,147,500,70)},rf=function(){Nd=i;var a,b;a=$("#background-canvas")[0];b=vd(a,0,0,a.width,~~(a.height/4));a=kd.apply(j,b);var c=a.slice(),d=a.slice(),e=a[2];b=Vd.apply(j,b)?1:-1;c[2]=(0.4*b+1)*e;d[2]=(0.2*b+1)*e;a=[a,c,d,b];Te("toolbar",k,qf(a[0]));Te("frame",k,qf(a[1]));Te("reartab",k,qf(a[2]));Te("text",k,0<
a[3]?"#fff":"#000");N("analytics",{status:"feeling lucky",data:{type:"Theme",label:""}});ve(i)},mf=function(){$("#image-alignment")[0].dataset.id="none";ue();T(U.qc);W=-1},sf=function(){var a=localStorage.getItem("themes");try{var b=n.navigator.onLine;hf=Z=0;a=JSON.parse(a);if(!(0>=a.length)){$("#stored-theme-box")[0].classList.remove("hidden");$("#themes-container").empty();var c=$(".stored-theme.template")[0],d=document.createDocumentFragment();a.forEach(function(a){if(a=localStorage.getItem(a)){hf++;
a=JSON.parse(a);var e=c.cloneNode(i);e.classList.remove("template");F(e,"click",te);e.dataset.id=a.id;/^https?:\/\//.test(a.urls.crx)&&(e.dataset.isonline="true",b||e.classList.add("disabled"));$(".thumb",e)[0].src=a.urls.preview_small;$(".theme-name",e)[0].textContent=a.name;$(".theme-name",e)[0].title=a.name;$(".delete",e)[0].dataset.id=a.id;d.appendChild(e)}});5<hf&&$("#right-theme")[0].classList.remove("disabled");$("#themes-container")[0].appendChild(d);F($(".stored-theme .delete"),"click",pf);
document.addEventListener("keydown",we,k)}}catch(e){}},Ae=function(){$("#fit-screen")[0].parentNode.classList.remove("disabled");$("#fill")[0].parentNode.classList.remove("disabled");$("#repeat")[0].parentNode.classList.remove("disabled");$("#custom")[0].parentNode.classList.remove("disabled");$(".image-align.image-align-disabled").removeClass("image-align-disabled")},Qe=function(){$("#image-alignment .expand")[0]&&$("#image-alignment .expand")[0].classList.remove("expand");$("#rep-table-container .image-align.position-selected")[0]&&
$("#rep-table-container .image-align.position-selected")[0].classList.remove("position-selected");$("#rep-table-container .image-align")[0]&&$("#rep-table-container .image-align")[0].classList.add("position-selected");$("#pos-table-container .image-align.position-selected")[0]&&$("#pos-table-container .image-align.position-selected")[0].classList.remove("position-selected");$("#pos-table-container .image-align")[0]&&$("#pos-table-container .image-align")[0].classList.add("position-selected");$("#image-alignment")[0].dataset.id=
"none"},ye=function(a){$(".enable-default:not(#background)").removeClass("enable-default");var b=$("#frame")[0],c=$("#reartab")[0],d=$("#toolbar")[0];$("#frame .pin")[0].style.backgroundColor=$("#reartab .pin")[0].style.backgroundColor=$("#toolbar .pin")[0].style.backgroundColor="";b.dataset.color=c.dataset.color=d.dataset.color="";b.dataset.grid=c.dataset.grid=d.dataset.grid="";a&&($("#background .pin")[0].style.backgroundColor="",$("#background")[0].dataset.color="",$("#background")[0].classList.remove("hidden"),
$(".enable-default").removeClass("enable-default"),A.reset(),A.Ga=Re);$("#color-selector-container table .disabled").removeClass("disabled");Ue();Ud.H();$d.H();Yd.H();Td.reset()},ue=function(){Q=j;Nd=k;Od="";Db&&(Kb(),Hb=Fb=Eb=j,Gb.clear(),Gb=j,Ib=function(){},Db=k);sf();Ae();$("#image-alignment .selected").removeClass("selected");Qe();$("#describe-button")[0].classList.add("expand");$("#describe-input")[0].classList.add("closed");$("#desc-text-area")[0].value="";$("#describe-text")[0].innerText=
V("theme_description_text");$("#desc-left-char-ct")[0].innerText=120;$("#theme-name")[0].value="";ye(i);$("#icon-switcher")[0].dataset.state=$("#icon-slider")[0].dataset.state="off";$("#icon-slider")[0].classList.remove("on");$("#icon-canvas")[0].classList.add("hidden");$("#woohoo")[0].classList.remove("show");le("unshared");tf($("#install-theme, #share, #unshare-theme, #delete-theme"),k)},Je=function(a,b,c){a&&(Od=c,A.Ga=j,za(b,"image/jpeg",j));Ee()},Ke=function(){},uf=function(a){return Q&&Q.z&&
Q.z.R()==a?i:k},tf=function(a,b){a=a instanceof HTMLElement?[a]:Array.prototype.slice.call(a);a.forEach(function(a){b?a.classList.add("disabled"):a.classList.remove("disabled")})},vf=function(a){tf($("#share"),a)},wf=function(a){tf($("#unshare-theme"),a)},xf=function(a){tf($("#delete-theme"),a)},fe=function(a){a=a?a:"";($("#theme-url input")[0].value=a)?(n.window.sd&&gapi.plusone&&(a=$("#theme-url input")[0].value,gapi.plusone.render("plusone",{annotation:"none",href:a,size:"medium",width:32,callback:oe})),
le("shared")):le("unshared")},V=E,U={$c:"step1-webcam",xc:"step3-crx-loading",hd:"step2-color-picker",Pc:"step1-img-pos",rd:"step1-img-uploading",qd:"step1-img-fetching",tb:"step4",qc:"step0",gd:"step1",ld:"step1-a",jd:"step2",kd:"step3",Gc:"step4-deleting",ed:"step4-deleted",fd:"step4-error-deleting",Qc:"step1-filters"},Qd=[U.gd,U.ld,U.jd,U.kd],W=-1,X="",Ud=j,Yd=j,be=j,Td=j,A=j,Ye=j,$d=j,hf=0,Z=0,Nd=k,Od="",We=j,Xd=new Image;Xd.src=chrome.extension.getURL("../images/canvas/theme_frame.png");
var Zd=new Image;Zd.src=chrome.extension.getURL("../images/canvas/theme_toolbar.png");var ae=new Image;ae.src=chrome.extension.getURL("../images/canvas/theme_tab_background.png");var Q=j;Md=function(a,b,c){this.xa=a;this.z=j;this.Xb=b;this.Yb=c};
Md.prototype.Vc=function(a,b){if(a){var c=localStorage.getItem("themes"),c=c?JSON.parse(c):[];c.unshift(b.R());localStorage.setItem("themes",JSON.stringify(c));localStorage.setItem(b.R(),JSON.stringify({id:b.R(),name:this.xa.getName(),desc:this.xa.da.description,urls:{crx:b.la.crx,zip:b.la.zip,preview_large:b.la.preview,preview_small:b.la.preview,share:""},isShared:k,secret:"",guid:""}));c={id:b.R(),name:this.xa.getName(),description:this.xa.da.description};delete this.xa;delete this.Xb;this.z=new P(b.R());
this.Yb(i,c)}else this.Yb(k)};Md.prototype.nd=function(){var a=chrome.extension.getURL("../views/preview.html")+"#"+this.z.R();chrome.tabs.create({url:a},j)};Md.prototype.md=function(){var a=new Kd(this.xa);a.generate();var b=new Dc;b.Wc(q(this.Vc,this));var c=a.Qb(),a=a.Va.Qb();Gc(b,c,"crx");Gc(b,a,"zip");Gc(b,this.Xb.image,"preview")};Md.prototype.Wb=function(){setTimeout(q(this.md,this),40)};
var yf=function(){Ie();switch($("#image-alignment")[0].dataset.id){case "none":case "fill":case "fit-screen":return;case "repeat":if(this.dataset.id==A.aa||this.classList.contains("image-align-disabled"))return;$('#repeat-option td[data-id="'+A.aa+'"]')[0].classList.remove("position-selected");var a=A;a.aa=this.dataset.id;a.D();break;case "custom":if(this.dataset.id==A.$||this.classList.contains("image-align-disabled"))return;$('#position td[data-id="'+A.$+'"]')[0].classList.remove("position-selected");
a=A;a.$=this.dataset.id;a.D()}this.classList.add("position-selected")};Y.mb=188;Y.Rb=5;n.window.addEventListener("online",function(){var a=$("#themes-container .stored-theme.disabled");a.removeClass("disabled");a.attr("title","")},k);n.window.addEventListener("offline",function(){var a=$('#themes-container .stored-theme[data-isonline="true"]');a.addClass("disabled");a.attr("title",V("not_available_offline"))},k);
Ic("share",function(a){var b=a.data.themeId;if(b&&uf(b))switch(a.status){case "sharing":vf(i);xf(i);break;case "shared":Q.z.update(),fe(Wc(Q.z));case "error":vf(k),xf(k)}});Ic("delete",function(a){var b=a.data.themeId,c=uf(b);switch(a.status){case "deleting":c&&(xf(i),vf(i),wf(i));break;case "deleted":c?mf():kf(b);break;case "error":c&&(xf(k),vf(k),wf(k))}});
Ic("unshare",function(a){var b=a.data.themeId;if(b&&uf(b))switch(a.status){case "unsharing":wf(i);xf(i);break;case "unshared":Q.z.update(),fe();case "error":xf(k),wf(k)}});window.___gcfg={lang:la};gb("https://apis.google.com/js/plusone.js");gb("https://ssl.google-analytics.com/ga.js");
n.window.addEventListener("load",function(){document.body.classList.add(ma);$("#main-container")[0].disabled=k;$("#desc-text-area")[0].value="";$("#desc-left-char-ct")[0].innerText=120;document.title=E("ext_name");$("#step1 .txt")[0].innerText=E("step1_btn_txt",E("sn_1")+". ");$("#step2 .txt")[0].innerText=E("step2_btn_txt",E("sn_2")+". ");$("#step3 .txt")[0].innerText=E("step3_btn_txt",E("sn_3")+". ");$("#initial-view .heading")[0].innerText=E("start_screen_heading");$("#initial-view .description")[0].innerText=
E("start_screen_description");$("#initial-view #start-btn > div:first-child")[0].innerText=E("start_btn_txt").toUpperCase();$("#stored-theme-box .title")[0].innerText=E("stored_themes_title");$("#stored-theme-footer a")[0].innerText=E("stored_themes_footer");$("#status-step1 .step-indicator")[0].innerText=E("sn_1");$("#status-step1 .msg .msg-text")[0].innerText=E("step1_header_msg_text");$("#status-step1 .msg .msg-desc")[0].innerText=E("step1_header_msg_desc");$("#status-step2 .step-indicator")[0].innerText=
E("sn_2");$("#status-step2 .msg .msg-text")[0].innerText=E("step2_header_msg_text");var a=E("step2_header_msg_desc"),b,c;(b=a.match(/\[([^\]]*)\]/))?(c=a.split(b[0]),a=c[0],c=c[1],b=b[1]):b=c="";var d=$("#status-step2 .msg .msg-desc")[0];d.appendChild(document.createTextNode(a));a=document.createElement("span");a.id="feeling-lucky";a.innerText=b;d.appendChild(a);d.appendChild(document.createTextNode(c));$("#status-step3 .step-indicator")[0].innerText=E("sn_3");$("#describe-text")[0].innerText=E("theme_description_text");
$("#describe-label")[0].innerText=E("theme_description_box_title");$("#desc-text-area")[0].setAttribute("placeholder",E("theme_description_box_placeholder"));$("#theme-name")[0].setAttribute("placeholder",E("theme_name_placeholder"));$("#question div:first-child")[0].innerText=E("question_mark");$("#question .tooltip-text")[0].innerText=E("question_mark_tooltip");$("#uploading-text .big-text")[0].innerText=E("uploading");$("#uploading-text .txt")[0].innerText=E("img_upload_wait");$("#fetching-image .msg")[0].innerText=
E("img_fetching");$("#package-theme")[0].innerText=E("package_btn");$("#install-theme div")[0].innerText=E("install_btn").toUpperCase();$("#frm-cmp .img-text")[0].innerText=E("upload_btn_txt");$("#frm-webcam .img-text")[0].innerText=E("webcam_btn_txt");$("#frm-webcam .tooltip .text")[0].innerText=E("no_webcam_msg");$("#frm-webcam .tooltip .button")[0].innerText=E("try_again");$("#cf-line1")[0].innerText=E("upload_step_canvas_footer_line1");$("#cf-line2")[0].innerText=E("upload_step_canvas_footer_line2");
$("#cf-line3")[0].innerText=E("upload_step_canvas_footer_line3");$("#change-align >  div:last-child")[0].innerText=E("alignment_btn_txt");$("#change-img > .text")[0].innerText=E("change_img_btn_txt");$("#open-filters > .text")[0].innerText=E("filter_title");$("#crx-loading .msg")[0].innerText=E("generate_theme");$("#frame .tooltip > div:first-child")[0].innerText=E("frame");$("#toolbar .tooltip > div:first-child")[0].innerText=E("toolbar");$("#reartab .tooltip > div:first-child")[0].innerText=E("reartab");
$("#background .tooltip > div:first-child")[0].innerText=E("background");$("#theme-controls-container .default").text(E("default"));$("#image-alignment .header > div:first-child")[0].innerText=E("alignment_btn_txt");$("#color-picker .header > div:first-child")[0].innerText=E("picker_header");$("#footer a")[0].innerText=E("privacy_policy");$("#footer #share-site .text")[0].innerText=E("footer_share_site_txt");$("#url-tip .tip-text")[0].innerText=E("url_tooltip");$("#disabled-align-opt")[0].innerText=
E("align_tooltip");$("#install-box > .text")[0].innerText=E("install_box_text");$("#share-box > .text")[0].innerText=E("publish_theme_text");$("#open-preview > .text")[0].innerText=E("open_preview_text");$("#make-another .text")[0].innerText=E("make_new");$("#second-fit,#second-fill").text(E("center_align"));$("#fill-container > div:last-child")[0].innerText=E("fill_screen");$("#fit-container > div:last-child")[0].innerText=E("fit_screen");$("#repeat-container > div:last-child")[0].innerText=E("tile_image");
$("#custom-container > div:last-child")[0].innerText=E("custom");$("#left-fit-h")[0].innerText=$("#left-fill-h")[0].innerText=E("left_align");$("#right-fit-h")[0].innerText=$("#right-fill-h")[0].innerText=E("right_align");$("#top-fit-v")[0].innerText=$("#top-fill-v")[0].innerText=E("top_align");$("#bottom-fit-v")[0].innerText=$("#bottom-fill-v")[0].innerText=E("bottom_align");$("#top-center-fit-h")[0].innerText=$("#left-center-fit-v")[0].innerText=$("#top-center-fill-h")[0].innerText=$("#left-center-fill-v")[0].innerText=
E("center_align");$("#icon-slider-off")[0].innerText=E("design_mode");$("#icon-slider-on")[0].innerText=E("preview_mode");$("#feeling-lucky-btn")[0].innerText=E("feeling_lucky");$("#delete-theme .text")[0].innerText=E("delete_theme");$("#unshare-theme > .text")[0].innerText=E("unpublish");$("#share > .text")[0].innerText=E("publish_theme");$("#filters-main > .header > .title")[0].innerText=E("filter_title");$("#filters-main > .header > .title")[0].innerText=E("filter_title");$("#filters-main > .footer .done > .text")[0].innerText=
E("done");$("#filters-main > .footer .cancel > .text")[0].innerText=E("cancel");$("#webcam > .loading-container")[0].innerText=E("allow_access_to_webcam");$("#capture > .text")[0].innerText=E("take_picture");$("#webcam-done")[0].innerText=E("use_picture");$("#webcam-retake")[0].innerText=E("retake_picture");$("#color-picker").draggable({handle:document.querySelector("#color-picker .header div:first-child"),stop:function(){$("#color-picker")[0].dataset.isset=i},tc:"document"});$("#image-alignment").draggable({handle:document.querySelector("#image-alignment .header div:first-child"),
stop:function(){$("#image-alignment")[0].dataset.isset=i},tc:"document"});$("#error-container").draggable({handle:document.querySelector("#error-container .header .title"),tc:"document"});We=new jb($("#color-selector-container")[0],"color-grid-tpl");na.forEach(function(a){We.add(a,ef)});We.select(1);sf();a=$("#pos-table-container")[0].cloneNode(i);a.setAttribute("id","rep-table-container");$("#repeat-option")[0].appendChild(a);F($("#initial-view .button-container #start-btn"),"click",xe);F($(".shift-theme"),
"click",jf);F($("#previous, #save-continue"),"click",ze);F($(".upload-file"),"change",Be);F($("#frm-webcam"),"click",Ge);F($("#image-controls .buttons"),"click",Le);F($(".alignment-checkbox-container"),"click",Me);F($(".image-align"),"click",yf);F($("#fit-container-h > .embed-component, #fit-container-v > .embed-component"),"click",Ne);F($("#fill-container-h > .embed-component, #fill-container-v > .embed-component"),"click",Oe);F($("#theme-controls-container .tooltip .default"),"click",Ve);F($("#theme-controls-container .bubble"),
"click",Xe);F($(".bubble"),"mouseover",Ze);F($(".bubble"),"mouseout",$e);F($("#image-alignment .close, #color-picker .close, #frame-container .close, #filters-main .close"),"click",Ee);F($("#describe-button"),"click",bf);F($("#desc-text-area"),"input",af);F($("#package-theme"),"click",ee);F($("#install-theme"),"click",ff);F($("#make-another"),"click",mf);F($("#woohoo > .close"),"click",pe);F($("#theme-url input"),"click",qe);F($("#theme-url input"),"blur",re);F($("#open-preview"),"click",se);F($("#icon-slider, #icon-slider-thumb, #icon-slider-off, #icon-slider-on"),
"click",gf);F($("#feeling-lucky, #feeling-lucky-btn"),"click",rf);F($("#delete-theme"),"click",of);F($("#share"),"click",me);F($("#unshare-theme"),"click",ne);if("Pc"==ma||"Windows"==ma)$("#frame-canvas,#toolbar-canvas").attr({width:746,height:463}),$("#frame-canvas,#toolbar-canvas,#canvas-container").addClass("windows");Ud=new Za($("#frame-canvas")[0]);$d=new bb($("#rear-tab-canvas")[0]);Yd=new fb($("#toolbar-canvas")[0]);A=new ya($("#background-canvas")[0]);A.Ga=Re;Td=new Wa($("#button-canvas")[0]);
be=new $a($("#icon-canvas")[0]);Ye=new Da($("#border-canvas")[0]);document.body.removeChild($("#loading-page")[0]);$("#main-container")[0].classList.remove("loading");"#startgentheme"==n.window.location.hash&&(n.window.location.hash="")},k);
