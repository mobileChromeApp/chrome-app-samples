/*
.
 Includes modified version of javascript astar implementation.
 http://github.com/bgrins/javascript-astar
 Freely distributable under the MIT License.
 Includes Binary Heap (with modifications) from Marijn Haverbeke.
 http://eloquentjavascript.net/appendix2.html
 Copyright (c) 2010, Brian Grinstead, http://briangrinstead.com
 Permission is hereby granted, free of charge, to any person obtaining
 a copy of this software and associated documentation files (the
 "Software"), to deal in the Software without restriction, including
 without limitation the rights to use, copy, modify, merge, publish,
 distribute, sublicense, and/or sell copies of the Software, and to
 permit persons to whom the Software is furnished to do so, subject to
 the following conditions:

 The above copyright notice and this permission notice shall be
 included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/
(function(){var Ej,Lc,Fj,Mc;function Rd(){return this}function $a(a,b,c){a=65536*a+b%65536;c&&(a+=1/(1+c));return a}function Gj(a){var b={far:a.sharedMaterial.meta.far};a.rendererInfo=b;var c=a.sharedMaterial.effect;c.prepare&&c.prepare(a);return b}function Hj(){}function pd(){}function Nc(){}function Sd(){}function rc(a,b,c,d){this.mathDevice=a;this.shaderManager=b;this.graphicsDevice=c;this.camera=d;this.scratchpad={};a=this.graphicsDevice;"undefined"===typeof this.debugLineVertexBuffer&&(b=[a.VERTEXFORMAT_FLOAT3,
a.VERTEXFORMAT_FLOAT3],this.numAttributeComponents=6,this.vertexBuffer=a.createVertexBuffer({numVertices:2*this.maximumLines,attributes:b,dynamic:!0}),this.data=new Float32Array(2*this.maximumLines*this.numAttributeComponents),this.debugLinesCount=0)}function ff(){}function ua(a){this.globals=a;var b=a.graphicsDevice,c=b.createIndexBuffer({numIndices:6*this.maxSprites,format:"USHORT"}),d=c.map();if(d){for(var f,g,h,n,j=0;j<this.maxSprites;j+=1)f=4*j+0,g=4*j+1,h=4*j+2,n=4*j+3,d(f),d(g),d(h),d(h),d(n),
d(f);c.unmap(d)}this.indexBuffer=c;this.numVerticesPerParticle=4;this.numVertexBufferVertices=this.numVerticesPerParticle*this.maxSprites;this.vertexBuffer=b.createVertexBuffer({numVertices:this.numVertexBufferVertices,attributes:["FLOAT3","FLOAT2","FLOAT4"],dynamic:!0,"transient":!0});this.semantics=b.createSemantics([b.SEMANTIC_POSITION,b.SEMANTIC_TEXCOORD,b.SEMANTIC_COLOR]);this.primitive=b.PRIMITIVE_TRIANGLES;this.globalTechniqueParameters=b.createTechniqueParameters({worldViewProjection:null});
this.localTechniqueParameters=b.createTechniqueParameters({diffuse:null});a=a.mathDevice;this.spriteList=[];this.spriteCache=[];for(b=0;b<this.maxSprites;b+=1)this.spriteCache[b]={v3location:a.v3BuildZero(),sizeX:0,sizeY:0,v4color:a.v4BuildOne(),texture:null,blendStyle:this.blendStyle.NORMAL,out:a.v3BuildZero(),outValid:!1,angle:0,offsetX:0,offsetY:0,offsetAngle:0};this.scratchPad={};this.writerArray=new Float32Array(9*this.numVertexBufferVertices)}function gf(){}function hf(){}function jf(){}function i(){}
function kf(){}function ni(){}function lf(){}function mf(){}function nf(){}function of(){}function Td(){}function pf(){}function qf(){}function rf(){}function Ud(){}function la(){}function db(){}function sf(){}function tf(){}function uf(){}function vf(){}function wf(){}function Vd(){}function Wd(){}function Xd(){}function oi(a){for(var b=Array(a.length),c,d,f=0;f<a.length;f+=1){d=a[f];b[f]=c=Array(d.length);for(var g=0;g<d.length;g+=1)c[g]=new pi(f,g,d[g])}this.input=a;this.nodes=b}function pi(a,
b,c){this.data={};this.x=a;this.y=b;this.pos={x:a,y:b};this.type=c}function Ij(a){this.content=[];this.scoreFunction=a}function Yd(){}function qd(){}function O(){}function Z(){}function I(){}function ic(a,b){var c=this.globals.mathDevice;this.stationary=void 0!==b.stationary?b.stationary:!0;this.bounce=void 0!==b.bounce?b.bounce:0.5;this.terrainType=b.terrainType;this.v3Scale=c.v3BuildOne();this.setv3Location(a);void 0!==b.v3Scale&&this.setv3Scale(b.v3Scale);this.randomSeed=Math.random();this.buildTransformMatrix(this.randomSeed);
this.buildZone=b.isBuildZone?!0:!1;this.scratchpad={}}function xf(){}function aa(){}function yf(){}function zf(){}function Af(){}function Bf(){}function rd(){}function Cf(){}function fa(){}function Gb(){}function A(){}function Df(){}function Ef(){}function M(){}function Ff(){}function ab(){}function Gf(){}function Hf(){}function Hb(){}function If(){}function Jf(){}function Kf(){}function Lf(){}function Mf(){}function Nf(){}function Of(){}function Pf(){}function Zd(){}function $d(){}function Qf(){}
function Rf(){}function Sf(){}function Tf(){}function sd(){}function Va(){}function sc(){}function Uf(){}function qi(){}function td(){}function Wa(){}function Vf(){}function ae(){}function Wf(){}function ri(){}function si(){}function Xf(){}function tc(){}function Da(){}function Fa(){}function e(){}function P(){}function Yf(){}function Zf(){}function $f(){}function ud(){}function ag(){}function bg(){}function vd(){}function cg(){}function dg(){}function eg(){}function be(){}function ce(){}function de(){}
function fg(){}function ee(){}function gg(){}function fe(){}function hg(){}function ig(){}function jg(){}function ge(){}function kg(){}function lg(){}function mg(){}function he(){}function ng(){}function ie(){}function wd(){}function og(){}function pg(){}function je(){}function qg(){}function rg(){}function sg(){}function tg(){}function ug(){}function vg(){}function wg(){}function Oc(){}function xg(){}function yg(){}function zg(){}function ke(){}function le(){}function me(){}function Pc(){}function xd(){}
function Ag(){}function Bg(){}function ne(){}function yd(){}function jc(){}function oe(){}function pe(){}function qe(){}function Cg(){}function Dg(){}function Eg(){}function Fg(){}function Gg(){}function Hg(){}function re(){}function se(){}function Ig(){}function Jg(){}function te(){}function Kg(){}var H=Array;"undefined"!==typeof Float32Array&&(void 0!==Float32Array.prototype&&void 0===Float32Array.prototype.slice)&&(Float32Array.prototype.slice=function(a,b){var c=this.length;void 0===a?a=0:0>a&&
(a+=c);void 0===b?b=c:0>b&&(b+=c);c=b-a;if(0<c){var c=new Float32Array(c),d=0;do c[d]=this[a],d+=1,a+=1;while(a<b);return c}return new Float32Array(0)});var w={version:1,precision:1E-6,FLOAT_MAX:3.402823466E38,select:function(a,b,c){return a?b:c},reciprocal:function(a){if(0!==a)return 1/a;throw"Division by zero";},truncate:function(a){return a|0},v2BuildZero:function(a){void 0===a&&(a=new H(2));a[0]=0;a[1]=0;return a},v2BuildOne:function(a){void 0===a&&(a=new H(2));a[0]=1;a[1]=1;return a},v2BuildXAxis:function(a){void 0===
a&&(a=new H(2));a[0]=1;a[1]=0;return a},v2BuildYAxis:function(a){void 0===a&&(a=new H(2));a[0]=0;a[1]=1;return a},v2Build:function(a,b,c){void 0===c&&(c=new H(2));c[0]=a;c[1]=b;return c},v2Copy:function(a,b){void 0===b&&(b=new H(2));b[0]=a[0];b[1]=a[1];return b},v2Set:function(a,b){a[0]=b[0];a[1]=b[1]},v2Neg:function(a,b){void 0===b&&(b=new H(2));b[0]=-a[0];b[1]=-a[1];return b},v2Add:function(a,b,c){void 0===c&&(c=new H(2));c[0]=a[0]+b[0];c[1]=a[1]+b[1];return c},v2Add3:function(a,b,c,d){void 0===
d&&(d=new H(2));d[0]=a[0]+b[0]+c[0];d[1]=a[1]+b[1]+c[1];return d},v2Add4:function(a,b,c,d,f){void 0===f&&(f=new H(2));f[0]=a[0]+b[0]+c[0]+d[0];f[1]=a[1]+b[1]+c[1]+d[1];return f},v2Sub:function(a,b,c){void 0===c&&(c=new H(2));c[0]=a[0]-b[0];c[1]=a[1]-b[1];return c},v2Mul:function(a,b,c){void 0===c&&(c=new H(2));c[0]=a[0]*b[0];c[1]=a[1]*b[1];return c},v2MulAdd:function(a,b,c,d){void 0===d&&(d=new H(2));d[0]=a[0]*b[0]+c[0];d[1]=a[1]*b[1]+c[1];return d},v2Dot:function(a,b){return a[0]*b[0]+a[1]*b[1]},
v2PerpDot:function(a,b){return a[0]*b[1]-a[1]*b[0]},v2LengthSq:function(a){var b=a[0],a=a[1];return b*b+a*a},v2Length:function(a){var b=a[0],a=a[1];return Math.sqrt(b*b+a*a)},v2Reciprocal:function(a,b){void 0===b&&(b=new H(2));var c=w.reciprocal;b[0]=c(a[0]);b[1]=c(a[1]);return b},v2Normalize:function(a,b){void 0===b&&(b=new H(2));var c=a[0],d=a[1],f=c*c+d*d;0<f?(f=1/Math.sqrt(f),b[0]=c*f,b[1]=d*f):(b[0]=0,b[1]=0);return b},v2Abs:function(a,b){void 0===b&&(b=new H(2));var c=Math.abs;b[0]=c(a[0]);
b[1]=c(a[1]);return b},v2Max:function(a,b,c){void 0===c&&(c=new H(2));var d=Math.max;c[0]=d(a[0],b[0]);c[1]=d(a[1],b[1]);return c},v2Min:function(a,b,c){void 0===c&&(c=new H(2));var d=Math.min;c[0]=d(a[0],b[0]);c[1]=d(a[1],b[1]);return c},v2Equal:function(a,b,c){var d=Math.abs;void 0===c&&(c=this.precision);return d(a[0]-b[0])<=c&&d(a[1]-b[1])<=c},v2MaskEqual:function(a,b){var c=Math.abs,d=w.precision;return[c(a[0]-b[0])<=d,c(a[1]-b[1])<=d]},v2MaskLess:function(a,b){return[a[0]<b[0],a[1]<b[1]]},v2MaskGreater:function(a,
b){return[a[0]>b[0],a[1]>b[1]]},v2MaskGreaterEq:function(a,b){return[a[0]>=b[0],a[1]>=b[1]]},v2MaskNot:function(a){return[!a[0],!a[1]]},v2MaskOr:function(a,b){return[a[0]||b[0],a[1]||b[1]]},v2MaskAnd:function(a,b){return[a[0]&&b[0],a[1]&&b[1]]},v2Select:function(a,b,c,d){void 0===d&&(d=new H(2));d[0]=a[0]?b[0]:c[0];d[1]=a[1]?b[1]:c[1];return d},v2ScalarBuild:function(a,b){void 0===b&&(b=new H(2));b[0]=a;b[1]=a;return b},v2ScalarMax:function(a,b,c){void 0===c&&(c=new H(2));var d=Math.max;c[0]=d(a[0],
b);c[1]=d(a[1],b);return c},v2ScalarMin:function(a,b,c){void 0===c&&(c=new H(2));var d=Math.min;c[0]=d(a[0],b);c[1]=d(a[1],b);return c},v2ScalarAdd:function(a,b,c){void 0===c&&(c=new H(2));c[0]=a[0]+b;c[1]=a[1]+b;return c},v2ScalarSub:function(a,b,c){void 0===c&&(c=new H(2));c[0]=a[0]-b;c[1]=a[1]-b;return c},v2ScalarMul:function(a,b,c){void 0===c&&(c=new H(2));0===b?(c[0]=0,c[1]=0):(c[0]=a[0]*b,c[1]=a[1]*b);return c},v2AddScalarMul:function(a,b,c,d){void 0===d&&(d=new H(2));d[0]=a[0]+b[0]*c;d[1]=
a[1]+b[1]*c;return d},v2EqualScalarMask:function(a,b){var c=Math.abs,d=w.precision;return[c(a[0]-b)<=d,c(a[1]-b)<=d]},v2LessScalarMask:function(a,b){return[a[0]<b,a[1]<b]},v2GreaterScalarMask:function(a,b){return[a[0]>b,a[1]>b]},v2GreaterEqScalarMask:function(a,b){return[a[0]>=b,a[1]>=b]},v2Lerp:function(a,b,c,d){void 0===d&&(d=new H(2));d[0]=a[0]+(b[0]-a[0])*c;d[1]=a[1]+(b[1]-a[1])*c;return d},v3BuildZero:function(a){void 0===a&&(a=new H(3));a[0]=0;a[1]=0;a[2]=0;return a},v3BuildOne:function(a){void 0===
a&&(a=new H(3));a[0]=1;a[1]=1;a[2]=1;return a},v3BuildXAxis:function(a){void 0===a&&(a=new H(3));a[0]=1;a[1]=0;a[2]=0;return a},v3BuildYAxis:function(a){void 0===a&&(a=new H(3));a[0]=0;a[1]=1;a[2]=0;return a},v3BuildZAxis:function(a){void 0===a&&(a=new H(3));a[0]=0;a[1]=0;a[2]=1;return a},v3Build:function(a,b,c,d){void 0===d&&(d=new H(3));d[0]=a;d[1]=b;d[2]=c;return d},v3Copy:function(a,b){var c=b;void 0===c&&(c=new H(3));c[0]=a[0];c[1]=a[1];c[2]=a[2];return c},v3Set:function(a,b){a[0]=b[0];a[1]=
b[1];a[2]=b[2]},v3Neg:function(a,b){void 0===b&&(b=new H(3));b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b},v3Add:function(a,b,c){void 0===c&&(c=new H(3));c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];return c},v3Add3:function(a,b,c,d){void 0===d&&(d=new H(3));d[0]=a[0]+b[0]+c[0];d[1]=a[1]+b[1]+c[1];d[2]=a[2]+b[2]+c[2];return d},v3Add4:function(a,b,c,d,f){void 0===f&&(f=new H(3));f[0]=a[0]+b[0]+c[0]+d[0];f[1]=a[1]+b[1]+c[1]+d[1];f[2]=a[2]+b[2]+c[2]+d[2];return f},v3Sub:function(a,b,c){void 0===c&&(c=new H(3));
c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];return c},v3Mul:function(a,b,c){void 0===c&&(c=new H(3));c[0]=a[0]*b[0];c[1]=a[1]*b[1];c[2]=a[2]*b[2];return c},v3MulAdd:function(a,b,c,d){void 0===d&&(d=new H(3));d[0]=a[0]*b[0]+c[0];d[1]=a[1]*b[1]+c[1];d[2]=a[2]*b[2]+c[2];return d},v3Dot:function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]},v3Cross:function(a,b,c){void 0===c&&(c=new H(3));var d=a[0],f=a[1],a=a[2],g=b[0],h=b[1],b=b[2];c[0]=f*b-a*h;c[1]=a*g-d*b;c[2]=d*h-f*g;return c},v3LengthSq:function(a){var b=
a[0],c=a[1],a=a[2];return b*b+c*c+a*a},v3Length:function(a){var b=a[0],c=a[1],a=a[2];return Math.sqrt(b*b+c*c+a*a)},v3Reciprocal:function(a,b){void 0===b&&(b=new H(3));var c=w.reciprocal;b[0]=c(a[0]);b[1]=c(a[1]);b[2]=c(a[2]);return b},v3Normalize:function(a,b){var c=b;void 0===c&&(c=new H(3));var d=a[0],f=a[1],g=a[2],h=d*d+f*f+g*g;0<h?(h=1/Math.sqrt(h),c[0]=d*h,c[1]=f*h,c[2]=g*h):(c[0]=0,c[1]=0,c[2]=0);return c},v3Abs:function(a,b){var c=b;void 0===c&&(c=new H(3));var d=Math.abs;c[0]=d(a[0]);c[1]=
d(a[1]);c[2]=d(a[2]);return c},v3Max:function(a,b,c){void 0===c&&(c=new H(3));var d=Math.max;c[0]=d(a[0],b[0]);c[1]=d(a[1],b[1]);c[2]=d(a[2],b[2]);return c},v3Min:function(a,b,c){void 0===c&&(c=new H(3));var d=Math.min;c[0]=d(a[0],b[0]);c[1]=d(a[1],b[1]);c[2]=d(a[2],b[2]);return c},v3Equal:function(a,b,c){var d=Math.abs;void 0===c&&(c=this.precision);return d(a[0]-b[0])<=c&&d(a[1]-b[1])<=c&&d(a[2]-b[2])<=c},v3MaskEqual:function(a,b){var c=Math.abs,d=w.precision;return[c(a[0]-b[0])<=d,c(a[1]-b[1])<=
d,c(a[2]-b[2])<=d]},v3MaskLess:function(a,b){return[a[0]<b[0],a[1]<b[1],a[2]<b[2]]},v3MaskGreater:function(a,b){return[a[0]>b[0],a[1]>b[1],a[2]>b[2]]},v3MaskGreaterEq:function(a,b){return[a[0]>=b[0],a[1]>=b[1],a[2]>=b[2]]},v3MaskNot:function(a){return[!a[0],!a[1],!a[2]]},v3MaskOr:function(a,b){return[a[0]||b[0],a[1]||b[1],a[2]||b[2]]},v3MaskAnd:function(a,b){return[a[0]&&b[0],a[1]&&b[1],a[2]&&b[2]]},v3Select:function(a,b,c,d){void 0===d&&(d=new H(3));d[0]=a[0]?b[0]:c[0];d[1]=a[1]?b[1]:c[1];d[2]=a[2]?
b[2]:c[2];return d},v3ScalarBuild:function(a,b){void 0===b&&(b=new H(3));b[0]=a;b[1]=a;b[2]=a;return b},v3ScalarMax:function(a,b,c){void 0===c&&(c=new H(3));var d=Math.max;c[0]=d(a[0],b);c[1]=d(a[1],b);c[2]=d(a[2],b);return c},v3ScalarMin:function(a,b,c){void 0===c&&(c=new H(3));var d=Math.min;c[0]=d(a[0],b);c[1]=d(a[1],b);c[2]=d(a[2],b);return c},v3ScalarAdd:function(a,b,c){void 0===c&&(c=new H(3));c[0]=a[0]+b;c[1]=a[1]+b;c[2]=a[2]+b;return c},v3ScalarSub:function(a,b,c){void 0===c&&(c=new H(3));
c[0]=a[0]-b;c[1]=a[1]-b;c[2]=a[2]-b;return c},v3ScalarMul:function(a,b,c){void 0===c&&(c=new H(3));0===b?(c[0]=0,c[1]=0,c[2]=0):(c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b);return c},v3AddScalarMul:function(a,b,c,d){void 0===d&&(d=new H(3));d[0]=a[0]+b[0]*c;d[1]=a[1]+b[1]*c;d[2]=a[2]+b[2]*c;return d},v3EqualScalarMask:function(a,b){var c=Math.abs,d=w.precision;return[c(a[0]-b)<=d,c(a[1]-b)<=d,c(a[2]-b)<=d]},v3LessScalarMask:function(a,b){return[a[0]<b,a[1]<b,a[2]<b]},v3GreaterScalarMask:function(a,b){return[a[0]>
b,a[1]>b,a[2]>b]},v3GreaterEqScalarMask:function(a,b){return[a[0]>=b,a[1]>=b,a[2]>=b]},v3Lerp:function(a,b,c,d){void 0===d&&(d=new H(3));d[0]=a[0]+(b[0]-a[0])*c;d[1]=a[1]+(b[1]-a[1])*c;d[2]=a[2]+(b[2]-a[2])*c;return d},v4BuildZero:function(a){void 0===a&&(a=new H(4));a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a},v4BuildOne:function(a){void 0===a&&(a=new H(4));a[0]=1;a[1]=1;a[2]=1;a[3]=1;return a},v4Build:function(a,b,c,d,f){void 0===f&&(f=new H(4));f[0]=a;f[1]=b;f[2]=c;f[3]=d;return f},v4Copy:function(a,
b){var c=b;void 0===c&&(c=new H(4));c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];return c},v4Set:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3]},v4Neg:function(a,b){void 0===b&&(b=new H(4));b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b},v4Add:function(a,b,c){void 0===c&&(c=new H(4));c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];return c},v4Add3:function(a,b,c,d){void 0===d&&(d=new H(4));d[0]=a[0]+b[0]+c[0];d[1]=a[1]+b[1]+c[1];d[2]=a[2]+b[2]+c[2];d[3]=a[3]+b[3]+c[3];return d},
v4Add4:function(a,b,c,d,f){void 0===f&&(f=new H(4));f[0]=a[0]+b[0]+c[0]+d[0];f[1]=a[1]+b[1]+c[1]+d[1];f[2]=a[2]+b[2]+c[2]+d[2];f[3]=a[3]+b[3]+c[3]+d[3];return f},v4Sub:function(a,b,c){void 0===c&&(c=new H(4));c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];c[3]=a[3]-b[3];return c},v4Mul:function(a,b,c){void 0===c&&(c=new H(4));c[0]=a[0]*b[0];c[1]=a[1]*b[1];c[2]=a[2]*b[2];c[3]=a[3]*b[3];return c},v4MulAdd:function(a,b,c,d){void 0===d&&(d=new H(4));d[0]=a[0]*b[0]+c[0];d[1]=a[1]*b[1]+c[1];d[2]=a[2]*b[2]+
c[2];d[3]=a[3]*b[3]+c[3];return d},v4Dot:function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]},v4LengthSq:function(a){var b=a[0],c=a[1],d=a[2],a=a[3];return b*b+c*c+d*d+a*a},v4Length:function(a){var b=a[0],c=a[1],d=a[2],a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)},v4Reciprocal:function(a,b){void 0===b&&(b=new H(4));var c=w.reciprocal;b[0]=c(a[0]);b[1]=c(a[1]);b[2]=c(a[2]);b[3]=c(a[3]);return b},v4Normalize:function(a,b){void 0===b&&(b=new H(4));var c=a[0],d=a[1],f=a[2],g=a[3],h=c*c+d*d+f*f+g*
g;0<h?(h=1/Math.sqrt(h),b[0]=c*h,b[1]=d*h,b[2]=f*h,b[3]=g*h):(b[0]=0,b[1]=0,b[2]=0,b[3]=0);return b},v4Abs:function(a,b){void 0===b&&(b=new H(4));var c=Math.abs;b[0]=c(a[0]);b[1]=c(a[1]);b[2]=c(a[2]);b[3]=c(a[3]);return b},v4Max:function(a,b,c){void 0===c&&(c=new H(4));var d=Math.max;c[0]=d(a[0],b[0]);c[1]=d(a[1],b[1]);c[2]=d(a[2],b[2]);c[3]=d(a[3],b[3]);return c},v4Min:function(a,b,c){void 0===c&&(c=new H(4));var d=Math.min;c[0]=d(a[0],b[0]);c[1]=d(a[1],b[1]);c[2]=d(a[2],b[2]);c[3]=d(a[3],b[3]);
return c},v4Equal:function(a,b,c){var d=Math.abs;void 0===c&&(c=this.precision);return d(a[0]-b[0])<=c&&d(a[1]-b[1])<=c&&d(a[2]-b[2])<=c&&d(a[3]-b[3])<=c},v4MaskEqual:function(a,b){var c=Math.abs,d=w.precision;return[c(a[0]-b[0])<=d,c(a[1]-b[1])<=d,c(a[2]-b[2])<=d,c(a[3]-b[3])<=d]},v4MaskLess:function(a,b){return[a[0]<b[0],a[1]<b[1],a[2]<b[2],a[3]<b[3]]},v4MaskGreater:function(a,b){return[a[0]>b[0],a[1]>b[1],a[2]>b[2],a[3]>b[3]]},v4MaskGreaterEq:function(a,b){return[a[0]>=b[0],a[1]>=b[1],a[2]>=b[2],
a[3]>=b[3]]},v4MaskNot:function(a){return[!a[0],!a[1],!a[2],!a[3]]},v4MaskOr:function(a,b){return[a[0]||b[0],a[1]||b[1],a[2]||b[2],a[3]||b[3]]},v4MaskAnd:function(a,b){return[a[0]&&b[0],a[1]&&b[1],a[2]&&b[2],a[3]&&b[3]]},v4Many:function(a){return a[0]||a[1]||a[2]||a[3]},v4MaskAll:function(a){return a[0]&&a[1]&&a[2]&&a[3]},v4Select:function(a,b,c,d){void 0===d&&(d=new H(4));d[0]=a[0]?b[0]:c[0];d[1]=a[1]?b[1]:c[1];d[2]=a[2]?b[2]:c[2];d[3]=a[3]?b[3]:c[3];return d},v4ScalarBuild:function(a,b){void 0===
b&&(b=new H(4));b[0]=a;b[1]=a;b[2]=a;b[3]=a;return b},v4ScalarMax:function(a,b,c){void 0===c&&(c=new H(4));var d=Math.max;c[0]=d(a[0],b);c[1]=d(a[1],b);c[2]=d(a[2],b);c[3]=d(a[3],b);return c},v4ScalarMin:function(a,b,c){void 0===c&&(c=new H(4));var d=Math.min;c[0]=d(a[0],b);c[1]=d(a[1],b);c[2]=d(a[2],b);c[3]=d(a[3],b);return c},v4ScalarAdd:function(a,b,c){void 0===c&&(c=new H(4));c[0]=a[0]+b;c[1]=a[1]+b;c[2]=a[2]+b;c[3]=a[3]+b;return c},v4ScalarSub:function(a,b,c){void 0===c&&(c=new H(4));c[0]=a[0]-
b;c[1]=a[1]-b;c[2]=a[2]-b;c[3]=a[3]-b;return c},v4ScalarMul:function(a,b,c){if(0===b)return w.v4BuildZero(c);void 0===c&&(c=new H(4));c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;c[3]=a[3]*b;return c},v4AddScalarMul:function(a,b,c,d){void 0===d&&(d=new H(4));d[0]=a[0]+b[0]*c;d[1]=a[1]+b[1]*c;d[2]=a[2]+b[2]*c;d[3]=a[3]+b[3]*c;return d},v4ScalarEqual:function(a,b){var c=Math.abs,d=w.precision;return c(a[0]-b)<=d&&c(a[1]-b)<=d&&c(a[2]-b)<=d&&c(a[3]-b)<=d},v4EqualScalarMask:function(a,b){var c=Math.abs,d=w.precision;
return[c(a[0]-b)<=d,c(a[1]-b)<=d,c(a[2]-b)<=d,c(a[3]-b)<=d]},v4LessScalarMask:function(a,b){return[a[0]<b,a[1]<b,a[2]<b,a[3]<b]},v4GreaterScalarMask:function(a,b){return[a[0]>b,a[1]>b,a[2]>b,a[3]>b]},v4GreaterEqScalarMask:function(a,b){return[a[0]>=b,a[1]>=b,a[2]>=b,a[3]>=b]},v4Lerp:function(a,b,c,d){void 0===d&&(d=new H(4));d[0]=a[0]+(b[0]-a[0])*c;d[1]=a[1]+(b[1]-a[1])*c;d[2]=a[2]+(b[2]-a[2])*c;d[3]=a[3]+(b[3]-a[3])*c;return d},aabbBuild:function(a,b,c,d,f,g,h){void 0===h&&(h=new H(6));h[0]=a;h[1]=
b;h[2]=c;h[3]=d;h[4]=f;h[5]=g;return h},aabbBuildEmpty:function(a){var b=this.FLOAT_MAX;void 0===a&&(a=new H(6));a[0]=b;a[1]=b;a[2]=b;a[3]=-b;a[4]=-b;a[5]=-b;return a},aabbCopy:function(a,b){var c=b;void 0===c&&(c=new H(6));c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];return c},aabbSet:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5]},aabbIsEmpty:function(a){return a[0]>a[3]},aabbMin:function(a,b){if(void 0===b)return a.slice(0,3);b[0]=a[0];b[1]=a[1];b[2]=a[2];
return b},aabbMax:function(a,b){if(void 0===b)return a.slice(3,6);b[0]=a[3];b[1]=a[4];b[2]=a[5];return b},aabbGetCenterAndHalf:function(a,b,c){var d=0.5*(a[0]+a[3]),f=0.5*(a[1]+a[4]),g=0.5*(a[2]+a[5]);b[0]=d;b[1]=f;b[2]=g;c[0]=a[3]-d;c[1]=a[4]-f;c[2]=a[5]-g},aabbIsInsidePlanes:function(a,b){var c=b.length,d=0;do{var f=b[d],g=f[0],h=f[1],n=f[2];if(g*(0>g?a[0]:a[3])+h*(0>h?a[1]:a[4])+n*(0>n?a[2]:a[5])<f[3])return!1;d+=1}while(d<c);return!0},aabbIsFullyInsidePlanes:function(a,b){var c=b.length,d=0;do{var f=
b[d],g=f[0],h=f[1],n=f[2];if(g*(0<g?a[0]:a[3])+h*(0<h?a[1]:a[4])+n*(0<n?a[2]:a[5])<f[3])return!1;d+=1}while(d<c);return!0},aabbUnion:function(a,b,c){void 0===c&&(c=new H(6));c[0]=a[0]<b[0]?a[0]:b[0];c[1]=a[1]<b[1]?a[1]:b[1];c[2]=a[2]<b[2]?a[2]:b[2];c[3]=a[3]>b[3]?a[3]:b[3];c[4]=a[4]>b[4]?a[4]:b[4];c[5]=a[5]>b[5]?a[5]:b[5];return c},aabbUnionArray:function(a,b){void 0===b&&(b=new H(6));w.aabbCopy(a[0],b);for(var c=a.length,d=1;d<c;d+=1){var f=a[d];b[0]=b[0]<f[0]?b[0]:f[0];b[1]=b[1]<f[1]?b[1]:f[1];
b[2]=b[2]<f[2]?b[2]:f[2];b[3]=b[3]>f[3]?b[3]:f[3];b[4]=b[4]>f[4]?b[4]:f[4];b[5]=b[5]>f[5]?b[5]:f[5]}return b},aabbAddPoints:function(a,b){var c,d=b.length,f=a[0],g=a[1],h=a[2],n=a[3],j=a[4],r=a[5],e,m,q;for(c=0;c<d;c+=1)e=b[c],m=e[0],q=e[1],e=e[2],f=f<m?f:m,g=g<q?g:q,h=h<e?h:e,n=n>m?n:m,j=j>q?j:q,r=r>e?r:e;a[0]=f;a[1]=g;a[2]=h;a[3]=n;a[4]=j;a[5]=r},aabbTransform:function(a,b,c){void 0===c&&(c=new H(6));var d=0.5*(a[0]+a[3]),f=0.5*(a[1]+a[4]),g=0.5*(a[2]+a[5]),h=a[3]-d,n=a[4]-f,j=a[5]-g,r=b[0],e=b[1],
m=b[2],q=b[3],p=b[4],s=b[5],D=b[6],u=b[7],i=b[8],a=b[9]+(r*d+q*f+D*g),k=b[10]+(e*d+p*f+u*g),b=b[11]+(m*d+s*f+i*g),d=Math.abs,r=d(r)*h+d(q)*n+d(D)*j,e=d(e)*h+d(p)*n+d(u)*j,h=d(m)*h+d(s)*n+d(i)*j;c[0]=a-r;c[1]=k-e;c[2]=b-h;c[3]=a+r;c[4]=k+e;c[5]=b+h;return c},aabbIntercept:function(a,b,c){void 0===c&&(c=new H(6));c[0]=a[0]>b[0]?a[0]:b[0];c[1]=a[1]>b[1]?a[1]:b[1];c[2]=a[2]>b[2]?a[2]:b[2];c[3]=a[3]<b[3]?a[3]:b[3];c[4]=a[4]<b[4]?a[4]:b[4];c[5]=a[5]<b[5]?a[5]:b[5];return c},aabbOverlaps:function(a,b){return a[0]<=
b[3]&&a[1]<=b[4]&&a[2]<=b[5]&&a[3]>=b[0]&&a[4]>=b[1]&&a[5]>=b[2]},aabbSphereOverlaps:function(a,b,c){var d=b[0],f=b[1],b=b[2],g=a[0],h=a[1],n=a[2],j=a[3],r=a[4],a=a[5],e=0;d<g?(d=g-d,e+=d*d):d>j&&(d-=j,e+=d*d);f<h?(d=h-f,e+=d*d):f>r&&(d=f-r,e+=d*d);b<n?(d=n-b,e+=d*d):b>a&&(d=b-a,e+=d*d);return e<=c*c},aabbIsInside:function(a,b){return a[0]>=b[0]&&a[1]>=b[1]&&a[2]>=b[2]&&a[3]<=b[3]&&a[4]<=b[4]&&a[5]<=b[5]},aabbTestInside:function(a,b){return a[0]<=b[3]&&a[1]<=b[4]&&a[2]<=b[5]&&a[3]>=b[0]&&a[4]>=b[1]&&
a[5]>=b[2]?a[0]>=b[0]&&a[1]>=b[1]&&a[2]>=b[2]&&a[3]<=b[3]&&a[4]<=b[4]&&a[5]<=b[5]?2:1:0},m33BuildIdentity:function(a){void 0===a&&(a=new H(9));a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},m33Build:function(a,b,c,d){var f;f=arguments.length;9<=f?(9<f?(f=arguments[9],void 0===f&&(f=new H(9))):f=new H(9),f[0]=arguments[0],f[1]=arguments[1],f[2]=arguments[2],f[3]=arguments[3],f[4]=arguments[4],f[5]=arguments[5],f[6]=arguments[6],f[7]=arguments[7],f[8]=arguments[8]):(f=d,void 0===
f&&(f=new H(9)),f[0]=a[0],f[1]=a[1],f[2]=a[2],f[3]=b[0],f[4]=b[1],f[5]=b[2],f[6]=c[0],f[7]=c[1],f[8]=c[2]);return f},m33Copy:function(a,b){var c=b;void 0===c&&(c=new H(9));c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c},m33FromAxisRotation:function(a,b,c){void 0===c&&(c=new H(9));var d=Math.sin(b),b=Math.cos(b),f=1-b,g=a[0],h=a[1],a=a[2],n=f*g,j=f*h,f=f*a,r=d*g,e=d*h,d=d*a;c[0]=n*g+b;c[1]=n*h-d;c[2]=n*a+e;c[3]=j*g+d;c[4]=j*h+b;c[5]=j*a-r;c[6]=f*
g-e;c[7]=f*h+r;c[8]=f*a+b;return c},m33FromQuat:function(a,b){var c=b;void 0===c&&(c=new H(9));var d=a[0],f=a[1],g=a[2],h=a[3],n=2*d*d,j=2*f*f,r=2*g*g,e=2*d*f,m=2*g*h,q=2*d*g,p=2*f*h,f=2*f*g,d=2*d*h;c[0]=1-j-r;c[1]=e-m;c[2]=q+p;c[3]=e+m;c[4]=1-n-r;c[5]=f-d;c[6]=q-p;c[7]=f+d;c[8]=1-n-j;return c},m33Right:function(a,b){var c=b;void 0===c&&(c=new H(3));c[0]=a[0];c[1]=a[1];c[2]=a[2];return c},m33Up:function(a,b){var c=b;void 0===c&&(c=new H(3));c[0]=a[3];c[1]=a[4];c[2]=a[5];return c},m33At:function(a,
b){var c=b;void 0===c&&(c=new H(3));c[0]=a[6];c[1]=a[7];c[2]=a[8];return c},m33SetRight:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2]},m33SetUp:function(a,b){a[3]=b[0];a[4]=b[1];a[5]=b[2]},m33SetAt:function(a,b){a[6]=b[0];a[7]=b[1];a[8]=b[2]},m33Transpose:function(a,b){void 0===b&&(b=new H(9));var c=a[1],d=a[2],f=a[3],g=a[4],h=a[5],n=a[6],j=a[7],r=a[8];b[0]=a[0];b[1]=f;b[2]=n;b[3]=c;b[4]=g;b[5]=j;b[6]=d;b[7]=h;b[8]=r;return b},m33Determinant:function(a){var b=a[3],c=a[4],d=a[5],f=a[6],g=a[7],h=a[8];
return a[0]*(c*h-d*g)+a[1]*(d*f-b*h)+a[2]*(b*g-c*f)},m33Inverse:function(a,b){void 0===b&&(b=new H(9));var c=w.m33Determinant(a);if(0===c)b[0]=b[1]=b[2]=0,b[3]=b[4]=b[5]=0,b[6]=b[7]=b[8]=0;else{var d=a[0],f=a[1],g=a[2],h=a[3],n=a[4],j=a[5],r=a[6],e=a[7],m=a[8],c=1/c;b[0]=(n*m+j*-e)*c;b[1]=(e*g+m*-f)*c;b[2]=(f*j-g*n)*c;b[3]=(j*r+h*-m)*c;b[4]=(m*d+r*-g)*c;b[5]=(h*g-d*j)*c;b[6]=(h*e+n*-r)*c;b[7]=(r*f+e*-d)*c;b[8]=(d*n-h*f)*c}return b},m33InverseTranspose:function(a,b){void 0===b&&(b=new H(9));var c=
a[0],d=a[1],f=a[2],g=a[3],h=a[4],n=a[5],j=a[6],r=a[7],e=a[8],m=c*(h*e-n*r)+d*(n*j-g*e)+f*(g*r-h*j);0===m?(b[0]=b[1]=b[2]=0,b[3]=b[4]=b[5]=0,b[6]=b[7]=b[8]=0):(m=1/m,b[0]=(h*e+n*-r)*m,b[3]=(r*f+e*-d)*m,b[6]=(d*n-f*h)*m,b[1]=(n*j+g*-e)*m,b[4]=(e*c+j*-f)*m,b[7]=(g*f-c*n)*m,b[2]=(g*r+h*-j)*m,b[5]=(j*d+r*-c)*m,b[8]=(c*h-g*d)*m);return b},m33Mul:function(a,b,c){var d=a[0],f=a[1],g=a[2],h=a[3],n=a[4],j=a[5],r=a[6],e=a[7],a=a[8],m=b[0],q=b[1],p=b[2],s=b[3],D=b[4],u=b[5],i=b[6],k=b[7],b=b[8];void 0===c&&(c=
new H(9));c[0]=m*d+s*f+i*g;c[1]=q*d+D*f+k*g;c[2]=p*d+u*f+b*g;c[3]=m*h+s*n+i*j;c[4]=q*h+D*n+k*j;c[5]=p*h+u*n+b*j;c[6]=m*r+s*e+i*a;c[7]=q*r+D*e+k*a;c[8]=p*r+u*e+b*a;return c},m33Transform:function(a,b,c){void 0===c&&(c=new H(3));var d=b[0],f=b[1],b=b[2];c[0]=a[0]*d+a[3]*f+a[6]*b;c[1]=a[1]*d+a[4]*f+a[7]*b;c[2]=a[2]*d+a[5]*f+a[8]*b;return c},m33Equal:function(a,b,c){var d=Math.abs;void 0===c&&(c=this.precision);return d(a[0]-b[0])<=c&&d(a[1]-b[1])<=c&&d(a[2]-b[2])<=c&&d(a[3]-b[3])<=c&&d(a[4]-b[4])<=c&&
d(a[5]-b[5])<=c&&d(a[6]-b[6])<=c&&d(a[7]-b[7])<=c&&d(a[8]-b[8])<=c},m33MulM43:function(a,b,c){void 0===c&&(c=new H(12));var d=a[0],f=a[1],g=a[2],h=a[3],n=a[4],j=a[5],r=a[6],e=a[7],a=a[8],m=b[0],q=b[1],p=b[2],s=b[3],D=b[4],u=b[5],i=b[6],k=b[7],y=b[8];c[0]=m*d+s*f+i*g;c[1]=q*d+D*f+k*g;c[2]=p*d+u*f+y*g;c[3]=m*h+s*n+i*j;c[4]=q*h+D*n+k*j;c[5]=p*h+u*n+y*j;c[6]=m*r+s*e+i*a;c[7]=q*r+D*e+k*a;c[8]=p*r+u*e+y*a;c[9]=b[9];c[10]=b[10];c[11]=b[11];return c},m33MulM44:function(a,b,c){void 0===c&&(c=new H(16));var d=
a[0],f=a[1],g=a[2],h=a[3],n=a[4],j=a[5],r=a[6],e=a[7],a=a[8],m=b[0],q=b[1],p=b[2],s=b[3],D=b[4],u=b[5],i=b[6],k=b[7],y=b[8],v=b[9],x=b[10],J=b[11];c[0]=m*d+D*f+y*g;c[1]=q*d+u*f+v*g;c[2]=p*d+i*f+x*g;c[3]=s*d+k*f+J*g;c[4]=m*h+D*n+y*j;c[5]=q*h+u*n+v*j;c[6]=p*h+i*n+x*j;c[7]=s*h+k*n+J*j;c[8]=m*r+D*e+y*a;c[9]=q*r+u*e+v*a;c[10]=p*r+i*e+x*a;c[11]=s*r+k*e+J*a;c[12]=b[12];c[13]=b[13];c[14]=b[14];c[15]=b[15];return c},m33ScalarAdd:function(a,b,c){void 0===c&&(c=new H(9));for(var d=0;9>d;d+=1)c[d]=a[d]+b;return c},
m33ScalarSub:function(a,b,c){void 0===c&&(c=new H(9));for(var d=0;9>d;d+=1)c[d]=a[d]-b;return c},m33ScalarMul:function(a,b,c){void 0===c&&(c=new H(9));for(var d=0;9>d;d+=1)c[d]=a[d]*b;return c},m34BuildIdentity:function(a){void 0===a&&(a=new H(12));a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;return a},m34Pos:function(a,b){void 0===b&&(b=new H(3));b[0]=a[3];b[1]=a[7];b[2]=a[11];return b},m34Scale:function(a,b,c){void 0===c&&(c=new H(12));var d=b[0],f=b[1],
b=b[2];c[0]=a[0]*d;c[1]=a[1]*d;c[2]=a[2]*d;c[3]=a[3];c[4]=a[4]*f;c[5]=a[5]*f;c[6]=a[6]*f;c[7]=a[7];c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11];return c},m43BuildIdentity:function(a){void 0===a&&(a=new H(12));a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;a[9]=0;a[10]=0;a[11]=0;return a},m43Build:function(a,b,c,d,f,g,h,n,j,r,e,m,q){var p;p=arguments.length;12<=p?(12<p?(p=arguments[12],void 0===p&&(p=new H(12))):p=new H(12),p[0]=arguments[0],p[1]=arguments[1],p[2]=arguments[2],
p[3]=arguments[3],p[4]=arguments[4],p[5]=arguments[5],p[6]=arguments[6],p[7]=arguments[7],p[8]=arguments[8],p[9]=arguments[9],p[10]=arguments[10],p[11]=arguments[11]):(p=f,void 0===p&&(p=new H(12)),p[0]=a[0],p[1]=a[1],p[2]=a[2],p[3]=b[0],p[4]=b[1],p[5]=b[2],p[6]=c[0],p[7]=c[1],p[8]=c[2],p[9]=d[0],p[10]=d[1],p[11]=d[2]);return p},m43BuildTranslation:function(a,b,c,d){var f;3<=arguments.length?(f=d,void 0===f&&(f=new H(12)),f[9]=a,f[10]=b,f[11]=c):(f=b,void 0===f&&(f=new H(12)),f[9]=a[0],f[10]=a[1],
f[11]=a[2]);f[0]=1;f[1]=0;f[2]=0;f[3]=0;f[4]=1;f[5]=0;f[6]=0;f[7]=0;f[8]=1;return f},m43Copy:function(a,b){var c=b;void 0===c&&(c=new H(12));c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];return c},m43FromM33V3:function(a,b,c){void 0===c&&(c=new H(12));c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=b[0];c[10]=b[1];c[11]=b[2];return c},m43FromAxisRotation:function(a,b,c){var d=
Math.sin(b),b=Math.cos(b),f=1-b,g=a[0],h=a[1],a=a[2],n=f*g,j=f*h,f=f*a,r=d*g,e=d*h,d=d*a;void 0===c&&(c=new H(12));c[0]=n*g+b;c[1]=n*h-d;c[2]=n*a+e;c[3]=j*g+d;c[4]=j*h+b;c[5]=j*a-r;c[6]=f*g-e;c[7]=f*h+r;c[8]=f*a+b;c[9]=0;c[10]=0;c[11]=0;return c},m43FromQuatPos:function(a,b){var c=b;void 0===c&&(c=new H(12));var d=a[0],f=a[1],g=a[2],h=a[3],n=a[4],j=a[5],r=a[6],e=2*d*d,m=2*f*f,q=2*g*g,p=2*d*f,s=2*g*h,D=2*d*g,u=2*f*h,f=2*f*g,d=2*d*h;c[0]=1-m-q;c[1]=p-s;c[2]=D+u;c[3]=p+s;c[4]=1-e-q;c[5]=f-d;c[6]=D-u;
c[7]=f+d;c[8]=1-e-m;c[9]=n;c[10]=j;c[11]=r;return c},m43FromRTS:function(a,b,c,d){var f=a[0],g=a[1],h=a[2],n=a[3],a=2*f*f,j=2*g*g,r=2*h*h,e=2*f*g,m=2*h*n,q=2*f*h,p=2*g*n,g=2*g*h,f=2*f*n,h=c[0],n=c[1],c=c[2];void 0===d&&(d=new H(12));d[0]=h*(1-j-r);d[1]=h*(e-m);d[2]=h*(q+p);d[3]=n*(e+m);d[4]=n*(1-a-r);d[5]=n*(g-f);d[6]=c*(q-p);d[7]=c*(g+f);d[8]=c*(1-a-j);d[9]=b[0];d[10]=b[1];d[11]=b[2];return d},m43FromRT:function(a,b,c){var d=a[0],f=a[1],g=a[2],h=a[3],a=2*d*d,n=2*f*f,j=2*g*g,r=2*d*f,e=2*g*h,m=2*d*
g,q=2*f*h,f=2*f*g,d=2*d*h;void 0===c&&(c=new H(12));c[0]=1-n-j;c[1]=r-e;c[2]=m+q;c[3]=r+e;c[4]=1-a-j;c[5]=f-d;c[6]=m-q;c[7]=f+d;c[8]=1-a-n;c[9]=b[0];c[10]=b[1];c[11]=b[2];return c},m43Right:function(a,b){var c=b;void 0===c&&(c=new H(3));c[0]=a[0];c[1]=a[1];c[2]=a[2];return c},m43Up:function(a,b){var c=b;void 0===c&&(c=new H(3));c[0]=a[3];c[1]=a[4];c[2]=a[5];return c},m43At:function(a,b){var c=b;void 0===c&&(c=new H(3));c[0]=a[6];c[1]=a[7];c[2]=a[8];return c},m43Pos:function(a,b){var c=b;void 0===
c&&(c=new H(3));c[0]=a[9];c[1]=a[10];c[2]=a[11];return c},m43SetRight:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2]},m43SetUp:function(a,b){a[3]=b[0];a[4]=b[1];a[5]=b[2]},m43SetAt:function(a,b){a[6]=b[0];a[7]=b[1];a[8]=b[2]},m43SetPos:function(a,b){a[9]=b[0];a[10]=b[1];a[11]=b[2]},m43SetAxisRotation:function(a,b,c){var d=Math.sin(c),c=Math.cos(c),f=1-c,g=b[0],h=b[1],b=b[2],n=f*g,j=f*h,f=f*b,r=d*g,e=d*h,d=d*b;a[0]=n*g+c;a[1]=n*h-d;a[2]=n*b+e;a[3]=j*g+d;a[4]=j*h+c;a[5]=j*b-r;a[6]=f*g-e;a[7]=f*h+r;a[8]=
f*b+c},m43InverseOrthonormal:function(a,b){void 0===b&&(b=new H(12));var c=a[0],d=a[1],f=a[2],g=a[3],h=a[4],n=a[5],j=a[6],r=a[7],e=a[8],m=a[9],q=a[10],p=a[11];b[0]=c;b[1]=g;b[2]=j;b[3]=d;b[4]=h;b[5]=r;b[6]=f;b[7]=n;b[8]=e;b[9]=-(m*c+q*d+p*f);b[10]=-(m*g+q*h+p*n);b[11]=-(m*j+q*r+p*e);return b},m43Orthonormalize:function(a,b){var c=w.v3Normalize,d=w.v3Length,f=w.v3Dot,g=w.v3Cross,h=Math.abs,n=w.m43Right(a),j=w.m43Up(a),r=w.m43At(a),e=w.m43Pos(a),m=d(n),q=d(j),d=d(r);c(n,n);c(j,j);c(r,r);0<m?0<q?0<d?
(m=h(f(j,r)),q=h(f(r,n)),f=h(f(n,j)),m<q?m<f?(f=j,h=r,m=n):(f=n,h=j,m=r):q<f?(f=r,h=n,m=j):(f=n,h=j,m=r)):(f=n,h=j,m=r):(f=r,h=n,m=j):(f=j,h=r,m=n);g(f,h,m);c(m,m);g(m,f,h);c(h,h);void 0===b&&(b=new H(12));b[0]=n[0];b[1]=n[1];b[2]=n[2];b[3]=j[0];b[4]=j[1];b[5]=j[2];b[6]=r[0];b[7]=r[1];b[8]=r[2];b[9]=e[0];b[10]=e[1];b[11]=e[2];return b},m43Determinant:function(a){return a[0]*(a[4]*a[8]-a[5]*a[7])+a[1]*(a[5]*a[6]-a[3]*a[8])+a[2]*(a[3]*a[7]-a[4]*a[6])},m43Inverse:function(a,b){void 0===b&&(b=new H(12));
var c=a[0],d=a[1],f=a[2],g=a[3],h=a[4],n=a[5],j=a[6],r=a[7],e=a[8],m=a[9],q=a[10],p=a[11],s=c*(h*e-n*r)+d*(n*j-g*e)+f*(g*r-h*j);0!==s&&(void 0===b&&(b=new H(12)),s=1/s,b[0]=(h*e+n*-r)*s,b[1]=(r*f+e*-d)*s,b[2]=(d*n-f*h)*s,b[3]=(n*j+g*-e)*s,b[4]=(e*c+j*-f)*s,b[5]=(g*f-c*n)*s,b[6]=(g*r+h*-j)*s,b[7]=(j*d+r*-c)*s,b[8]=(c*h-g*d)*s,b[9]=(g*(q*e-r*p)+h*(j*p-m*e)+n*(m*r-j*q))*s,b[10]=(j*(f*q-d*p)+r*(c*p-m*f)+e*(m*d-c*q))*s,b[11]=(m*(f*h-d*n)+q*(c*n-g*f)+p*(g*d-c*h))*s);return b},m43Translate:function(a,b){a[9]+=
b[0];a[10]+=b[1];a[11]+=b[2]},m43Scale:function(a,b,c){void 0===c&&(c=new H(12));var d=b[0],f=b[1],b=b[2];c[0]=a[0]*d;c[1]=a[1]*d;c[2]=a[2]*d;c[3]=a[3]*f;c[4]=a[4]*f;c[5]=a[5]*f;c[6]=a[6]*b;c[7]=a[7]*b;c[8]=a[8]*b;c[9]=a[9];c[10]=a[10];c[11]=a[11];return c},m43TransformVector:function(a,b,c){void 0===c&&(c=new H(3));var d=b[0],f=b[1],b=b[2];c[0]=a[0]*d+a[3]*f+a[6]*b;c[1]=a[1]*d+a[4]*f+a[7]*b;c[2]=a[2]*d+a[5]*f+a[8]*b;return c},m43TransformPoint:function(a,b,c){void 0===c&&(c=new H(3));var d=b[0],
f=b[1],b=b[2];c[0]=a[0]*d+a[3]*f+a[6]*b+a[9];c[1]=a[1]*d+a[4]*f+a[7]*b+a[10];c[2]=a[2]*d+a[5]*f+a[8]*b+a[11];return c},m43Mul:function(a,b,c){var d=a[0],f=a[1],g=a[2],h=a[3],n=a[4],j=a[5],r=a[6],e=a[7],m=a[8],q=a[9],p=a[10],a=a[11],s=b[0],D=b[1],u=b[2],i=b[3],k=b[4],y=b[5],v=b[6],x=b[7],J=b[8];void 0===c&&(c=new H(12));c[0]=s*d+i*f+v*g;c[1]=D*d+k*f+x*g;c[2]=u*d+y*f+J*g;c[3]=s*h+i*n+v*j;c[4]=D*h+k*n+x*j;c[5]=u*h+y*n+J*j;c[6]=s*r+i*e+v*m;c[7]=D*r+k*e+x*m;c[8]=u*r+y*e+J*m;c[9]=s*q+i*p+v*a+b[9];c[10]=
D*q+k*p+x*a+b[10];c[11]=u*q+y*p+J*a+b[11];return c},m43MulM44:function(a,b,c){var d=a[0],f=a[1],g=a[2],h=a[3],n=a[4],j=a[5],r=a[6],e=a[7],m=a[8],q=a[9],p=a[10],a=a[11],s=b[0],D=b[1],u=b[2],i=b[3],k=b[4],y=b[5],v=b[6],x=b[7],J=b[8],C=b[9],ka=b[10],Q=b[11];void 0===c&&(c=new H(16));c[0]=s*d+k*f+J*g;c[1]=D*d+y*f+C*g;c[2]=u*d+v*f+ka*g;c[3]=i*d+x*f+Q*g;c[4]=s*h+k*n+J*j;c[5]=D*h+y*n+C*j;c[6]=u*h+v*n+ka*j;c[7]=i*h+x*n+Q*j;c[8]=s*r+k*e+J*m;c[9]=D*r+y*e+C*m;c[10]=u*r+v*e+ka*m;c[11]=i*r+x*e+Q*m;c[12]=s*q+k*
p+J*a+b[12];c[13]=D*q+y*p+C*a+b[13];c[14]=u*q+v*p+ka*a+b[14];c[15]=i*q+x*p+Q*a+b[15];return c},m43Transpose:function(a,b){var c=b;void 0===c&&(c=new H(12));var d=a[1],f=a[2],g=a[3],h=a[4],n=a[5],j=a[6],r=a[7],e=a[8],m=a[9],q=a[10],p=a[11];c[0]=a[0];c[1]=g;c[2]=j;c[3]=m;c[4]=d;c[5]=h;c[6]=r;c[7]=q;c[8]=f;c[9]=n;c[10]=e;c[11]=p;return c},m43MulTranspose:function(a,b,c){var d=a[0],f=a[1],g=a[2],h=a[3],n=a[4],j=a[5],r=a[6],e=a[7],m=a[8],q=a[9],p=a[10],a=a[11],s=b[0],D=b[1],u=b[2],i=b[3],k=b[4],y=b[5],
v=b[6],x=b[7],J=b[8],C=b[9],ka=b[10],b=b[11];void 0===c&&(c=new H(12));c[0]=s*d+i*f+v*g;c[1]=s*h+i*n+v*j;c[2]=s*r+i*e+v*m;c[3]=s*q+i*p+v*a+C;c[4]=D*d+k*f+x*g;c[5]=D*h+k*n+x*j;c[6]=D*r+k*e+x*m;c[7]=D*q+k*p+x*a+ka;c[8]=u*d+y*f+J*g;c[9]=u*h+y*n+J*j;c[10]=u*r+y*e+J*m;c[11]=u*q+y*p+J*a+b;return c},m43Offset:function(a,b,c){void 0===c&&(c=new H(12));var d=a[0],f=a[1],g=a[2],h=a[3],n=a[4],j=a[5],r=a[6],e=a[7],m=a[8],q=a[9],p=a[10],a=a[11],s=b[0],D=b[1],b=b[2];c[0]=d;c[1]=f;c[2]=g;c[3]=h;c[4]=n;c[5]=j;c[6]=
r;c[7]=e;c[8]=m;c[9]=d*s+h*D+r*b+q;c[10]=f*s+n*D+e*b+p;c[11]=g*s+j*D+m*b+a;return c},m43NegOffset:function(a,b,c){void 0===c&&(c=new H(12));var d=a[0],f=a[1],g=a[2],h=a[3],n=a[4],j=a[5],r=a[6],e=a[7],m=a[8],q=a[9],p=a[10],a=a[11],s=-b[0],D=-b[1],b=-b[2];c[0]=d;c[1]=f;c[2]=g;c[3]=h;c[4]=n;c[5]=j;c[6]=r;c[7]=e;c[8]=m;c[9]=d*s+h*D+r*b+q;c[10]=f*s+n*D+e*b+p;c[11]=g*s+j*D+m*b+a;return c},m43InverseTransposeProjection:function(a,b,c){void 0===c&&(c=new H(12));var d=0.5/b[0],f=0.5/b[1],g=0.5/b[2],b=a[0]*
d,h=a[1]*d,d=a[2]*d,n=a[3]*f,j=a[4]*f,f=a[5]*f,r=a[6]*g,e=a[7]*g,g=a[8]*g,m=a[9],q=a[10],a=a[11];c[0]=b;c[1]=h;c[2]=d;c[3]=0.5-(m*b+q*h+a*d);c[4]=n;c[5]=j;c[6]=f;c[7]=0.5-(m*n+q*j+a*f);c[8]=r;c[9]=e;c[10]=g;c[11]=0.5-(m*r+q*e+a*g);return c},m43ScalarAdd:function(a,b,c){void 0===c&&(c=new H(12));for(var d=0;12>d;d+=1)c[d]=a[d]+b;return c},m43ScalarSub:function(a,b,c){void 0===c&&(c=new H(12));for(var d=0;12>d;d+=1)c[d]=a[d]-b;return c},m43ScalarMul:function(a,b,c){void 0===c&&(c=new H(12));for(var d=
0;12>d;d+=1)c[d]=a[d]*b;return c},m44BuildIdentity:function(a){void 0===a&&(a=new H(16));a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},m44Build:function(a,b,c,d,f){var g;g=arguments.length;16<=g?(16<g?(g=arguments[16],void 0===g&&(g=new H(16))):g=new H(16),g[0]=arguments[0],g[1]=arguments[1],g[2]=arguments[2],g[3]=arguments[3],g[4]=arguments[4],g[5]=arguments[5],g[6]=arguments[6],g[7]=arguments[7],g[8]=arguments[8],
g[9]=arguments[9],g[10]=arguments[10],g[11]=arguments[11],g[12]=arguments[12],g[13]=arguments[13],g[14]=arguments[14],g[15]=arguments[15]):(g=f,void 0===g&&(g=new H(16)),g[0]=a[0],g[1]=a[1],g[2]=a[2],g[3]=a[3],g[4]=b[0],g[5]=b[1],g[6]=b[2],g[7]=b[3],g[8]=c[0],g[9]=c[1],g[10]=c[2],g[11]=c[3],g[12]=d[0],g[13]=d[1],g[14]=d[2],g[15]=d[3]);return g},m44Copy:function(a,b){void 0===b&&(b=new H(16));b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=
a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},m44Right:function(a,b){if(void 0===b)return a.slice(0,4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},m44Up:function(a,b){if(void 0===b)return a.slice(4,8);b[0]=a[4];b[1]=a[5];b[2]=a[6];b[3]=a[7];return b},m44At:function(a,b){if(void 0===b)return a.slice(8,12);b[0]=a[8];b[1]=a[9];b[2]=a[10];b[3]=a[11];return b},m44Pos:function(a,b){if(void 0===b)return a.slice(12);b[0]=a[12];b[1]=a[13];b[2]=a[14];b[3]=a[15];return b},
m44SetRight:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3]},m44SetUp:function(a,b){a[4]=b[0];a[5]=b[1];a[6]=b[2];a[7]=b[3]},m44SetAt:function(a,b){a[8]=b[0];a[9]=b[1];a[10]=b[2];a[11]=b[3]},m44SetPos:function(a,b){a[12]=b[0];a[13]=b[1];a[14]=b[2];a[15]=b[3]},m44Translate:function(a,b){a[12]+=b[0];a[13]+=b[1];a[14]+=b[2];a[15]+=b[3]},m44Scale:function(a,b,c){void 0===c&&(c=new H(16));c[0]=a[0]*b[0];c[1]=a[1]*b[0];c[2]=a[2]*b[0];c[3]=a[3];c[4]=a[4]*b[1];c[5]=a[5]*b[1];c[6]=a[6]*b[1];c[7]=a[7];
c[8]=a[8]*b[2];c[9]=a[9]*b[2];c[10]=a[10]*b[2];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c},m44Transform:function(a,b,c){var d=b[0],f=b[1],g=b[2],b=b[3];void 0===c&&(c=new H(4));1!==b?(c[0]=a[0]*d+a[4]*f+a[8]*g+a[12]*b,c[1]=a[1]*d+a[5]*f+a[9]*g+a[13]*b,c[2]=a[2]*d+a[6]*f+a[10]*g+a[14]*b,c[3]=a[3]*d+a[7]*f+a[11]*g+a[15]*b):(c[0]=a[0]*d+a[4]*f+a[8]*g+a[12],c[1]=a[1]*d+a[5]*f+a[9]*g+a[13],c[2]=a[2]*d+a[6]*f+a[10]*g+a[14],c[3]=a[3]*d+a[7]*f+a[11]*g+a[15]);return c},m44Mul:function(a,
b,c){var d=a[0],f=a[1],g=a[2],h=a[3],n=a[4],j=a[5],e=a[6],l=a[7],m=a[8],q=a[9],p=a[10],s=a[11],D=a[12],u=a[13],i=a[14],a=a[15],k=b[0],y=b[1],v=b[2],x=b[3],J=b[4],C=b[5],ka=b[6],Q=b[7],V=b[8],t=b[9],K=b[10],w=b[11],N=b[12],da=b[13],va=b[14],b=b[15];void 0===c&&(c=new H(16));c[0]=k*d+J*f+V*g+N*h;c[1]=y*d+C*f+t*g+da*h;c[2]=v*d+ka*f+K*g+va*h;c[3]=x*d+Q*f+w*g+b*h;c[4]=k*n+J*j+V*e+N*l;c[5]=y*n+C*j+t*e+da*l;c[6]=v*n+ka*j+K*e+va*l;c[7]=x*n+Q*j+w*e+b*l;c[8]=k*m+J*q+V*p+N*s;c[9]=y*m+C*q+t*p+da*s;c[10]=v*m+
ka*q+K*p+va*s;c[11]=x*m+Q*q+w*p+b*s;c[12]=k*D+J*u+V*i+N*a;c[13]=y*D+C*u+t*i+da*a;c[14]=v*D+ka*u+K*i+va*a;c[15]=x*D+Q*u+w*i+b*a;return c},m44Inverse:function(a,b){var c=a[0],d=a[1],f=a[2],g=a[3],h=a[4],n=a[5],j=a[6],e=a[7],l=a[8],m=a[9],q=a[10],p=a[11],s=a[12],D=a[13],u=a[14],i=a[15];void 0===b&&(b=new H(16));var k=c*n-d*h,y=c*j-f*h,v=c*e-g*h,x=d*j-f*n,J=d*e-g*n,C=f*e-g*j,ka=l*D-m*s,Q=l*u-q*s,V=l*i-p*s,t=m*u-q*D,K=m*i-p*D,w=q*i-p*u,N=k*w-y*K+v*t+x*V-J*Q+C*ka;0===N?(b[0]=0,b[1]=0,b[2]=0,b[3]=0,b[4]=
0,b[5]=0,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[10]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=0):(N=1/N,b[0]=(+(n*w)-j*K+e*t)*N,b[4]=(-(h*w)+j*V-e*Q)*N,b[8]=(+(h*K)-n*V+e*ka)*N,b[12]=(-(h*t)+n*Q-j*ka)*N,b[1]=(-(d*w)+f*K-g*t)*N,b[5]=(+(c*w)-f*V+g*Q)*N,b[9]=(-(c*K)+d*V-g*ka)*N,b[13]=(+(c*t)-d*Q+f*ka)*N,b[2]=(+(D*C)-u*J+i*x)*N,b[6]=(-(s*C)+u*v-i*y)*N,b[10]=(+(s*J)-D*v+i*k)*N,b[14]=(-(s*x)+D*y-u*k)*N,b[3]=(-(m*C)+q*J-p*x)*N,b[7]=(+(l*C)-q*v+p*y)*N,b[11]=(-(l*J)+m*v-p*k)*N,b[15]=(+(l*x)-m*y+q*k)*N);return b},m44Transpose:function(a,
b){void 0===b&&(b=new H(16));b[0]=a[0];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=a[1];b[5]=a[5];b[6]=a[9];b[7]=a[13];b[8]=a[2];b[9]=a[6];b[10]=a[10];b[11]=a[14];b[12]=a[3];b[13]=a[7];b[14]=a[11];b[15]=a[15];return b},m44ScalarAdd:function(a,b,c){void 0===c&&(c=new H(16));for(var d=0;16>d;d+=1)c[d]=a[d]+b;return c},m44ScalarSub:function(a,b,c){void 0===c&&(c=new H(16));for(var d=0;16>d;d+=1)c[d]=a[d]-b;return c},m44ScalarMul:function(a,b,c){void 0===c&&(c=new H(16));for(var d=0;16>d;d+=1)c[d]=a[d]*b;return c},
quatBuild:function(a,b,c,d,f){void 0===f&&(f=new H(4));f[0]=a;f[1]=b;f[2]=c;f[3]=d;return f},quatCopy:function(a,b){var c=b;void 0===c&&(c=new H(4));c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];return c},quatIsSimilar:function(a,b,c){void 0===c&&(c=this.precision);var d=a;0>a[3]*b[3]&&(d=w.v4Neg(a));return w.v4LengthSq(w.v4Sub(d,b))<c*c},quatLength:function(a){return w.v4Length(a)},quatDot:function(a,b){return w.v4Dot(a,b)},quatMul:function(a,b,c){void 0===c&&(c=new H(4));var d=a[0],f=a[1],g=a[2],a=a[3],
h=b[0],n=b[1],j=b[2],b=b[3];c[0]=d*b+h*a+(j*f-n*g);c[1]=f*b+n*a+(h*g-j*d);c[2]=g*b+j*a+(n*d-h*f);c[3]=b*a-(h*d+n*f+j*g);return c},quatMulTranslate:function(a,b,c,d,f,g){var h=a[0],n=a[1],j=a[2],a=a[3],e=c[0],l=c[1],m=c[2],c=c[3];f[0]=e*a+h*c+(j*l-n*m);f[1]=l*a+n*c+(h*m-j*e);f[2]=m*a+j*c+(n*e-h*l);f[3]=a*c-(h*e+n*l+j*m);var f=b[0],c=b[1],b=b[2],e=d[0],l=d[1],d=d[2],q=a*a-(h*h+n*n+j*j),m=e*q,p=l*q,s=d*q,q=h*e+n*l+j*d,q=q+q,a=a+a,m=m+h*q+(j*l-n*d)*a,p=p+n*q+(h*d-j*e)*a,s=s+j*q+(n*e-h*l)*a;g[0]=m+f;g[1]=
p+c;g[2]=s+b},quatNormalize:function(a,b){var c=w.quatDot(a,a);if(0===c)return w.v4BuildZero(b);c=1/Math.sqrt(c);return w.v4ScalarMul(a,c,b)},quatConjugate:function(a,b){void 0===b&&(b=new H(4));b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b},quatLerp:function(a,b,c,d){void 0===d&&(d=new H(4));var f=a[0],g=a[1],h=a[2],a=a[3],n=b[1],j=b[2],e=b[3];d[0]=(b[0]-f)*c+f;d[1]=(n-g)*c+g;d[2]=(j-h)*c+h;d[3]=(e-a)*c+a;return d},cosMinSlerpAngle:Math.cos(Math.PI/40),quatSlerp:function(a,b,c,d){void 0===
d&&(d=new H(4));var f=a[0],g=a[1],h=a[2],a=a[3],n=b[0],j=b[1],e=b[2],b=b[3],l=f*n+g*j+h*e+a*b,m=l;0>m&&(f=-f,g=-g,h=-h,a=-a,m=-m);if(m>w.cosMinSlerpAngle){if(0.999999<m)return d[0]=f,d[1]=g,d[2]=h,d[3]=a,d;var q=c;0>=l&&(q=-c);c=(n-f)*q+f;g=(j-g)*q+g;h=(e-h)*q+h;a=(b-a)*q+a;e=1/Math.sqrt(c*c+g*g+h*h+a*a);d[0]=c*e;d[1]=g*e;d[2]=h*e;d[3]=a*e;return d}var q=Math.sin,l=Math.acos(m),m=1/q(l),p=q((1-c)*l)*m,f=f*p,g=g*p,h=h*p,a=a*p,p=q(c*l)*m;d[0]=f+n*p;d[1]=g+j*p;d[2]=h+e*p;d[3]=a+b*p;return d},quatFromM43:function(a,
b){var c=a[0],d=a[1],f=a[2],g=a[3],h=a[4],n=a[5],j=a[6],e=a[7],l=a[8],m;m=c+h+l+1;m>w.precision?(l=Math.sqrt(m)/2,c=(n-e)/(4*l),h=(j-f)/(4*l),d=(d-g)/(4*l)):c>h&&c>l?(m=2*Math.sqrt(1+c-h-l),l=(n-e)/m,c=0.25*m,h=(g+d)/m,d=(j+f)/m):h>l?(m=2*Math.sqrt(1+h-c-l),l=(j-f)/m,c=(g+d)/m,h=0.25*m,d=(e+n)/m):(m=2*Math.sqrt(1+l-c-h),l=(d-g)/m,c=(j+f)/m,h=(e+n)/m,d=0.25*m);d=w.quatNormalize([c,h,d,l],b);return w.quatConjugate(d,b)},quatFromAxisRotation:function(a,b,c){var d=0.5*b,b=Math.sin(d),d=Math.cos(d);void 0===
c&&(c=new H(4));c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;c[3]=d;return w.quatNormalize(c,c)},quatToAxisRotation:function(a,b){void 0===b&&(b=new H(4));var c=a[3],d=2*Math.acos(c),c=1-c*c;c<w.precision?(b[0]=1,b[1]=0,b[2]=0):(c=1/Math.sqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c);b[3]=d;return b},quatTransformVector:function(a,b,c){var d=a[0],f=a[1],g=a[2],h=a[3],a=b[0],n=b[1],b=b[2],j=h*h-(d*d+f*f+g*g),e=a*j,l=n*j,m=b*j,j=d*a+f*n+g*b,j=j+j,h=h+h,e=e+d*j+(g*n-f*b)*h,l=l+f*j+(d*b-g*a)*h,m=m+g*j+(f*a-d*n)*
h;void 0===c&&(c=new H(3));c[0]=e;c[1]=l;c[2]=m;return c},quatEqual:function(a,b,c){void 0===c&&(c=this.precision);var d=Math.abs;return d(a[0]-b[0])<=c&&d(a[1]-b[1])<=c&&d(a[2]-b[2])<=c&&d(a[3]-b[3])<=c},quatPosBuild:function(a,b,c,d,f,g,h,n){var j;7>arguments.length?(j=c,void 0===j&&(j=new H(7)),j[0]=a[0],j[1]=a[1],j[2]=a[2],j[3]=a[3],j[4]=b[0],j[5]=b[1],j[6]=b[2]):(j=n,void 0===j&&(j=new H(7)),j[0]=a,j[1]=b,j[2]=c,j[3]=d,j[4]=f,j[5]=g,j[6]=h);return j},quatPosTransformVector:function(a,b,c){return w.quatTransformVector(a,
b,c)},quatPosTransformPoint:function(a,b){var c=a.slice(4,7),d=w.quatTransformVector(a,b);return w.v3Add(d,c)},quatPosMul:function(a,b){var c=b.slice(4,7),d=w.quatMul(a,b),c=w.quatPosTransformPoint(a,c);d[4]=c[0];d[5]=c[1];d[6]=c[2];return d},isVisibleBox:function(a,b,c){var d=Math.abs,f=a[0],g=a[1],a=a[2],h=b[0],n=b[1],j=b[2],e=c[0],l=c[1],m=c[2],q=c[3],p=c[4],s=c[5],D=c[6],u=c[7],i=c[8],k=c[9],y=c[10],v=c[11],b=e*h,x=l*h,J=m*h,h=q*h,C=p*n,ka=s*n,Q=D*n,n=u*n,V=i*j,t=k*j,K=y*j,j=v*j,e=e*f+p*g+i*a+
c[12],l=l*f+s*g+k*a+c[13],m=m*f+D*g+y*a+c[14],c=q*f+u*g+v*a+c[15];return!(e-c>d(b-h)+d(C-n)+d(V-j)||e+c<-(d(b+h)+d(C+n)+d(V+j))||l-c>d(x-h)+d(ka-n)+d(t-j)||l+c<-(d(x+h)+d(ka+n)+d(t+j))||m-c>d(J-h)+d(Q-n)+d(K-j)||m+c<-(d(J+h)+d(Q+n)+d(K+j))||c+c<-(d(h+h)+d(n+n)+d(j+j)))},isVisibleBoxOrigin:function(a,b){var c=Math.abs,d=a[0],f=a[1],g=a[2],h=b[0]*d,n=b[1]*d,j=b[2]*d,d=b[3]*d,e=b[4]*f,l=b[5]*f,m=b[6]*f,f=b[7]*f,q=b[8]*g,p=b[9]*g,s=b[10]*g,g=b[11]*g,D=b[12],u=b[13],i=b[14],k=b[15];return!(D-k>c(h-d)+
c(e-f)+c(q-g)||D+k<-(c(h+d)+c(e+f)+c(q+g))||u-k>c(n-d)+c(l-f)+c(p-g)||u+k<-(c(n+d)+c(l+f)+c(p+g))||i-k>c(j-d)+c(m-f)+c(s-g)||i+k<-(c(j+d)+c(m+f)+c(s+g))||k+k<-(c(d+d)+c(f+f)+c(g+g)))},isVisibleSphere:function(a,b,c){var d=Math.abs,f=a[0],g=a[1],h=a[2],a=c[0],n=c[1],j=c[2],e=c[3],l=c[4],m=c[5],q=c[6],p=c[7],s=c[8],D=c[9],u=c[10],i=c[11],k=a*f+l*g+s*h+c[12],y=n*f+m*g+D*h+c[13],v=j*f+q*g+u*h+c[14],c=e*f+p*g+i*h+c[15],f=-b;return!(k-c>b*(d(a-e)+d(l-p)+d(s-i))||k+c<f*(d(a+e)+d(l+p)+d(s+i))||y-c>b*(d(n-
e)+d(m-p)+d(D-i))||y+c<f*(d(n+e)+d(m+p)+d(D+i))||v-c>b*(d(j-e)+d(q-p)+d(u-i))||v+c<f*(d(j+e)+d(q+p)+d(u+i))||c+c<f*(d(e+e)+d(p+p)+d(i+i)))},isVisibleSphereOrigin:function(a,b){var c=Math.abs,d=b[0],f=b[1],g=b[2],h=b[3],n=b[4],j=b[5],e=b[6],l=b[7],m=b[8],q=b[9],p=b[10],s=b[11],D=b[12],u=b[13],i=b[14],k=b[15],y=-a;return!(D-k>a*(c(d-h)+c(n-l)+c(m-s))||D+k<y*(c(d+h)+c(n+l)+c(m+s))||u-k>a*(c(f-h)+c(j-l)+c(q-s))||u+k<y*(c(f+h)+c(j+l)+c(q+s))||i-k>a*(c(g-h)+c(e-l)+c(p-s))||i+k<y*(c(g+h)+c(e+l)+c(p+s))||
k+k<y*(c(h+h)+c(l+l)+c(s+s)))},isVisibleSphereUnit:function(a){var b=Math.abs,c=a[0],d=a[1],f=a[2],g=a[3],h=a[4],n=a[5],j=a[6],e=a[7],l=a[8],m=a[9],q=a[10],p=a[11],s=a[12],D=a[13],u=a[14],a=a[15];return!(s-a>b(c-g)+b(h-e)+b(l-p)||s+a<-(b(c+g)+b(h+e)+b(l+p))||D-a>b(d-g)+b(n-e)+b(m-p)||D+a<-(b(d+g)+b(n+e)+b(m+p))||u-a>b(f-g)+b(j-e)+b(q-p)||u+a<-(b(f+g)+b(j+e)+b(q+p))||a+a<-(b(g+g)+b(e+e)+b(p+p)))},transformBox:function(a,b,c){var d=Math.abs,f=c[0],g=c[1],h=c[2],n=c[3],j=c[4],e=c[5],l=c[6],m=c[7],q=
c[8],p=a[0],s=a[1],D=a[2],a=b[0],u=b[1],b=b[2],i=new H(3);i[0]=f*p+n*s+l*D+c[9];i[1]=g*p+j*s+m*D+c[10];i[2]=h*p+e*s+q*D+c[11];c=new H(3);c[0]=d(f)*a+d(n)*u+d(l)*b;c[1]=d(g)*a+d(j)*u+d(m)*b;c[2]=d(h)*a+d(e)*u+d(q)*b;return{center:i,halfExtents:i}},planeNormalize:function(a,b){void 0===b&&(b=new H(4));var c=a[0],d=a[1],f=a[2],g=c*c+d*d+f*f;0<g?(g=1/Math.sqrt(g),b[0]=c*g,b[1]=d*g,b[2]=f*g,b[3]=a[3]*g):(b[0]=0,b[1]=0,b[2]=0,b[3]=0);return b},extractFrustumPlanes:function(a,b){var c=w.planeNormalize,d=
a[0],f=a[1],g=a[2],h=a[3],n=a[4],j=a[5],e=a[6],l=a[7],m=a[8],q=a[9],p=a[10],s=a[11],D=a[12],u=a[13],i=a[14],k=a[15],y=b||[];y[0]=c([h+d,l+n,s+m,-(k+D)],y[0]);y[1]=c([h-d,l-n,s-m,-(k-D)],y[1]);y[2]=c([h-f,l-j,s-q,-(k-u)],y[2]);y[3]=c([h+f,l+j,s+q,-(k+u)],y[3]);y[4]=c([h+g,l+e,s+p,-(k+i)],y[4]);y[5]=c([h-g,l-e,s-p,-(k-i)],y[5]);return y},isInsidePlanesPoint:function(a,b){var c=a[0],d=a[1],f=a[2],g=b.length,h=0;do{var n=b[h];if(n[0]*c+n[1]*d+n[2]*f<n[3])return!1;h+=1}while(h<g);return!0},isInsidePlanesSphere:function(a,
b,c){var d=a[0],f=a[1],a=a[2],g=c.length,h=0;do{var n=c[h];if(n[0]*d+n[1]*f+n[2]*a<n[3]-b)return!1;h+=1}while(h<g);return!0},isInsidePlanesBox:function(a,b,c){var d=a[0],f=a[1],g=a[2],h=b[0],n=b[1],j=b[2],b=d+h,a=f+n,e=g+j,d=d-h,f=f-n,g=g-j,n=c.length,j=0;do{var h=c[j],l=h[0],m=h[1],q=h[2];if(l*(0>l?d:b)+m*(0>m?f:a)+q*(0>q?g:e)<h[3])return!1;j+=1}while(j<n);return!0},extractIntersectingPlanes:function(a,b){var c=a[0],d=a[1],f=a[2],g=a[3],h=a[4],n=a[5],j=b.length,e=[],l=0,m=0;do{var q=b[m],p=q[0],
s=q[1],D=q[2];if(p*(0<p?c:g)+s*(0<s?d:h)+D*(0<D?f:n)<q[3])e[l]=q,l+=1;m+=1}while(m<j);return e}};if("undefined"!==typeof Float32Array){var Jj=new Float32Array([1,2,3]);Jj[0]=w.FLOAT_MAX;w.FLOAT_MAX=Jj[0];H=Float32Array}w.arrayConstructor=H;TurbulenzEngine.hasOwnProperty("VMath")&&(TurbulenzEngine.VMath=w);var La={NUMBER_OF_POST_REQUESTS:0,skipAsserts:!1,assert:function(a){a||this.skipAsserts||this.breakInDebugger.doesNotExist()},beget:function(a){var b=function(){};b.prototype=a;return new b},log:function(a,
b){var c=window.console;if(c)switch(arguments.length){case 1:c.log(arguments[0]);break;case 2:c.log(arguments[0],arguments[1]);break;case 3:c.log(arguments[0],arguments[1],arguments[2]);break;case 4:c.log(arguments[0],arguments[1],arguments[2],arguments[3]);break;default:var d=[].splice.call(arguments,0);c.log(d.join(" "))}},nearestLowerPow2:function(a){a|=a>>>1;a|=a>>>2;a|=a>>>4;a|=a>>>8;a|=a>>>16;return a-(a>>>1)},nearestUpperPow2:function(a){a-=1;a|=a>>>1;a|=a>>>2;a|=a>>>4;a|=a>>>8;return(a|a>>>
16)+1},ajax:function(a){var b="",c=a.method,d=a.data||{},f=a.encrypt,g=null,h=a.url,n=a.requestHandler,j=a.callback,e=a.enableCORSCredentials;if(f){d.requestUrl=h;var l=JSON.stringify(d);"POST"===c&&(l=TurbulenzEngine.encrypt(l));b+="data="+encodeURIComponent(l)+"&";b+="gameSessionId="+encodeURIComponent(d.gameSessionId);g=TurbulenzEngine.generateSignature(l)}else if(d)for(l in d)d.hasOwnProperty(l)&&(0!==b.length&&(b+="&"),b="POST"===c?b+(l+"="+d[l]):b+(encodeURIComponent(l)+"="+encodeURIComponent(d[l])));
d=function(a,b){var c=this.xhr;this.xhr=this.xhr.onreadystatechange=null;var d;if("application/json; charset=utf-8"!==c.getResponseHeader("Content-Type"))TurbulenzEngine.setTimeout(function(){j({msg:"HttpStatus "+b+" "+La.ajaxStatusCodes[b]},b);j=null},0);else if(d=JSON.parse(a),f){var c=c.getResponseHeader("X-TZ-Signature"),g=TurbulenzEngine.verifySignature(a,c),a=null;TurbulenzEngine.setTimeout(function(){var a=d.requestUrl;g&&(!TurbulenzEngine.encryptionEnabled||a===h)?j(d,b):400===b?j(d,b,"Verification Failed"):
j({msg:"Verification failed",ok:!1},400,"Verification Failed");j=null},0)}else a=null,TurbulenzEngine.setTimeout(function(){j(d,b);j=null},0)};l=function(d,f,h){var n;if(window.XMLHttpRequest)n=new window.XMLHttpRequest,e&&"withCredentials"in n&&(n.withCredentials=!0);else if(window.ActiveXObject)n=new window.ActiveXObject("Microsoft.XMLHTTP");else{a.error&&a.error("No XMLHTTPRequest object could be created");return}h.xhr=n;var l=function(){if(4===n.readyState&&TurbulenzEngine&&!TurbulenzEngine.isUnloading()){var a=
n.responseText,b=n.status,c=0!==b&&n.statusText||"No connection or cross domain request";""===n.getAllResponseHeaders()&&""===a&&200===b&&"OK"===c?f("",0):f.call(h,a,b)}};n.open(c,b&&"POST"!==c?d+"?"+b:d,!0);j&&(n.onreadystatechange=l);g&&n.setRequestHeader("X-TZ-Signature",g);"POST"===c?(La.NUMBER_OF_POST_REQUESTS+=1,n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.send(b)):n.send()};n?n.request({src:h,requestFn:l,responseFilter:a.responseFilter,onload:d}):
l(h,d,{src:h})},ajaxStatusCodes:{"0":"No Connection, Timeout Or Cross Domain Request",100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",
406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested range not satisfiable",417:"Expectation Failed",429:"Too Many Requests",480:"Temporarily Unavailable",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version not supported"}},
Sb=function(){};Sb.prototype.add=function(){this.referenceCount+=1};Sb.prototype.remove=function(){this.referenceCount-=1;0===this.referenceCount&&(this.destroyedObserver&&this.destroyedObserver.notify(this.object),this.object.destroy(),this.object=null)};Sb.prototype.subscribeDestroyed=function(a){this.destroyedObserver||(this.destroyedObserver=ub.create());this.destroyedObserver.subscribe(a)};Sb.prototype.unsubscribeDestroyed=function(a){this.destroyedObserver.unsubscribe(a)};Sb.create=function(a){var b=
new Sb;b.object=a;b.referenceCount=0;return b};Sb.version=1;var ma={profiles:{},sortMode:{alphabetical:0,duration:1,max:2,min:3,calls:4},start:function(a){var b=this.profiles[a];b||(b={name:a,calls:0,duration:0,min:Number.MAX_VALUE,max:0,sumOfSquares:0},this.profiles[a]=b);b.start=TurbulenzEngine.time},stop:function(a){var b=TurbulenzEngine.time;if(a=this.profiles[a])b-=a.start,a.duration+=b,a.calls+=1,a.sumOfSquares+=b*b,b>a.max&&(a.max=b),b<a.min&&(a.min=b)},reset:function(){this.profiles={}},getReport:function(a,
b){var c=[],d,f=0,g;for(g in this.profiles)this.profiles.hasOwnProperty(g)&&(d=this.profiles[g],f<d.duration&&(f=d.duration),c.push(d));c.sort(a===ma.sortMode.alphabetical?function(a,b){return a.name<b.name?-1:a.name>b.name?1:0}:a===ma.sortMode.max?function(a,b){return b.max-a.max}:a===ma.sortMode.min?function(a,b){return b.min-a.min}:a===ma.sortMode.calls?function(a,b){return b.calls-a.calls}:function(a,b){return b.duration-a.duration});var h="",n=b?b.precision:8,j=b?b.percentagePrecision:1,e=b?
b.seperator:" ",l=c.length,m,q;for(q=0;q<l;q+=1)d=c[q],g=d.name,g+=e+d.calls,g+=e+d.duration.toFixed(n),g+=e+d.max.toFixed(n),g+=e+d.min.toFixed(n),m=d.duration/d.calls,g+=e+m.toFixed(n),m=Math.sqrt(d.sumOfSquares/d.calls-m*m),g+=e+m.toFixed(n),g+=e+(100*d.duration/f).toFixed(j)+"%\n",h+=g;return h}},uc=function(a,b,c){this.escapeNodeOffset=b;this.externalNode=c;this.extents=a;return this};uc.prototype.isLeaf=function(){return!!this.externalNode};uc.prototype.reset=function(a,b,c,d,f,g,h,n){this.escapeNodeOffset=
h;this.externalNode=n;h=this.extents;h[0]=a;h[1]=b;h[2]=c;h[3]=d;h[4]=f;h[5]=g};uc.prototype.clear=function(){this.escapeNodeOffset=1;this.externalNode=void 0;var a=this.extents,b=Number.MAX_VALUE;a[0]=b;a[1]=b;a[2]=b;a[3]=-b;a[4]=-b;a[5]=-b};uc.create=function(a,b,c){return new uc(a,b,c)};uc.version=1;var xa=function(a){this.numNodesLeaf=4;this.nodes=[];this.endNode=0;this.needsRebound=this.needsRebuild=!1;this.numExternalNodes=this.numUpdates=this.numAdds=0;this.startUpdate=2147483647;this.endUpdate=
-2147483647;this.highQuality=a;this.ignoreY=!1;this.nodesStack=Array(32)};xa.prototype.add=function(a,b){var c=this.endNode;a.spatialIndex=c;var d=new this.arrayConstructor(6);d[0]=b[0];d[1]=b[1];d[2]=b[2];d[3]=b[3];d[4]=b[4];d[5]=b[5];this.nodes[c]=uc.create(d,1,a);this.endNode=c+1;this.needsRebuild=!0;this.numAdds+=1;this.numExternalNodes+=1};xa.prototype.remove=function(a){var b=a.spatialIndex;if(void 0!==b){if(1<this.numExternalNodes){var c=this.nodes;c[b].clear();var d=this.endNode;if(b+1>=d){for(;!c[d-
1].externalNode;)d-=1;this.endNode=d}else this.needsRebuild=!0;this.numExternalNodes-=1}else this.clear();a.spatialIndex=void 0}};xa.prototype.findParent=function(a){var b=this.nodes,c=0,d;do a-=1,c+=1,d=b[a];while(d.escapeNodeOffset<=c);return d};xa.prototype.update=function(a,b){var c=a.spatialIndex;if(void 0!==c){var d=b[0],f=b[1],g=b[2],h=b[3],n=b[4],j=b[5],e=this.needsRebuild,l=this.needsRebound,m=this.nodes,q=m[c].extents,p=e||l||q[0]>d||q[1]>f||q[2]>g||q[3]<h||q[4]<n||q[5]<j;q[0]=d;q[1]=f;
q[2]=g;q[3]=h;q[4]=n;q[5]=j;if(p&&!e&&1<m.length)if(this.numUpdates+=1,this.startUpdate>c&&(this.startUpdate=c),this.endUpdate<c&&(this.endUpdate=c),l)this.numUpdates>3*this.numExternalNodes&&(this.needsRebuild=!0,this.numAdds=this.numUpdates);else if(2*this.numUpdates>this.numExternalNodes)this.needsRebound=!0;else if(c=this.findParent(c).extents,c[0]>d||c[1]>f||c[2]>g||c[3]<h||c[4]<n||c[5]<j)this.needsRebound=!0}else this.add(a,b)};xa.prototype.needsFinalize=function(){return this.needsRebuild||
this.needsRebound};xa.prototype.finalize=function(){this.needsRebuild?this.rebuild():this.needsRebound&&this.rebound()};xa.prototype.rebound=function(){var a=this.nodes;if(1<a.length)for(var b=this.startUpdate,c=this.endUpdate,d=this.nodesStack,f=0,g=0;;){var h=a[g],n=g,j=g+h.escapeNodeOffset,e=g+1,l;do{l=a[e];var m=e+l.escapeNodeOffset;if(e<c)!l.externalNode&&m>b&&(d[f]=g,f+=1,g=e);else break;e=m}while(e<j);if(g===n){e=g+1;l=a[e];for(var c=l.extents,n=c[0],m=c[1],q=c[2],p=c[3],s=c[4],D=c[5],e=e+
l.escapeNodeOffset;e<j;)l=a[e],c=l.extents,n>c[0]&&(n=c[0]),m>c[1]&&(m=c[1]),q>c[2]&&(q=c[2]),p<c[3]&&(p=c[3]),s<c[4]&&(s=c[4]),D<c[5]&&(D=c[5]),e+=l.escapeNodeOffset;c=h.extents;c[0]=n;c[1]=m;c[2]=q;c[3]=p;c[4]=s;c[5]=D;c=g;if(0<f)f-=1,g=d[f];else break}}this.needsRebound=this.needsRebuild=!1;this.numAdds=0;this.startUpdate=2147483647;this.endUpdate=-2147483647};xa.prototype.rebuild=function(){if(0<this.numExternalNodes){var a=this.nodes,b,c,d;if(this.numExternalNodes===a.length)b=a,c=a.length,this.nodes=
a=[];else{b=[];b.length=this.numExternalNodes;c=0;d=this.endNode;for(var f=0;f<d;f+=1){var g=a[f];g.externalNode&&(a[f]=void 0,b[c]=g,c+=1)}b.length>c&&(b.length=c)}1<c?(c>this.numNodesLeaf&&0<this.numAdds&&(this.highQuality?this._sortNodesHighQuality(b):this.ignoreY?this._sortNodesNoY(b):this._sortNodes(b)),a.length=this._predictNumNodes(0,c,0),this._recursiveBuild(b,0,c,0),d=a[0].escapeNodeOffset,a.length>d&&(a.length=d),this.endNode=d,b=a[0],a=b.extents,b=a[3]-a[0],c=a[5]-a[2],this.ignoreY=4*(a[4]-
a[1])<(b<=c?b:c)):(b=b[0],b.externalNode.spatialIndex=0,a.length=1,a[0]=b,this.endNode=1)}this.needsRebound=this.needsRebuild=!1;this.numUpdates=this.numAdds=0;this.startUpdate=2147483647;this.endUpdate=-2147483647};xa.prototype._sortNodes=function(a){function b(a){a=a.extents;return a[0]+a[3]}function c(a){a=a.extents;return a[1]+a[4]}function d(a){a=a.extents;return a[2]+a[5]}function f(a){a=a.extents;return-(a[0]+a[3])}function g(a){a=a.extents;return-(a[1]+a[4])}function h(a){a=a.extents;return-(a[2]+
a[5])}function n(a,p,s){var D=p+s>>1;0===m?l?e(a,p,D,s,f):e(a,p,D,s,b):2===m?l?e(a,p,D,s,h):e(a,p,D,s,d):l?e(a,p,D,s,g):e(a,p,D,s,c);m=0===m?2:2===m?1:0;l=!l;p+j<D&&n(a,p,D);D+j<s&&n(a,D,s)}var j=this.numNodesLeaf,e=this._nthElement,l=!1,m=0;n(a,0,a.length)};xa.prototype._sortNodesNoY=function(a){function b(a){a=a.extents;return a[0]+a[3]}function c(a){a=a.extents;return a[2]+a[5]}function d(a){a=a.extents;return-(a[0]+a[3])}function f(a){a=a.extents;return-(a[2]+a[5])}function g(a,m,q){var p=m+q>>
1;0===e?j?n(a,m,p,q,d):n(a,m,p,q,b):j?n(a,m,p,q,f):n(a,m,p,q,c);e=0===e?2:0;j=!j;m+h<p&&g(a,m,p);p+h<q&&g(a,p,q)}var h=this.numNodesLeaf,n=this._nthElement,j=!1,e=0;g(a,0,a.length)};xa.prototype._sortNodesHighQuality=function(a){function b(a){a=a.extents;return a[0]+a[3]}function c(a){a=a.extents;return a[1]+a[4]}function d(a){a=a.extents;return a[2]+a[5]}function f(a){a=a.extents;return a[0]+a[2]+a[3]+a[5]}function g(a){a=a.extents;return a[0]-a[2]+a[3]-a[5]}function h(a){a=a.extents;return-(a[0]+
a[3])}function n(a){a=a.extents;return-(a[1]+a[4])}function j(a){a=a.extents;return-(a[2]+a[5])}function e(a){a=a.extents;return-(a[0]+a[2]+a[3]+a[5])}function l(a){a=a.extents;return-(a[0]-a[2]+a[3]-a[5])}function m(a,i,k){var y=i+k>>1;p(a,i,y,k,b);var v=s(a,i,y)+s(a,y,k);p(a,i,y,k,c);var x=s(a,i,y)+s(a,y,k);p(a,i,y,k,d);var J=s(a,i,y)+s(a,y,k);p(a,i,y,k,f);var C=s(a,i,y)+s(a,y,k);p(a,i,y,k,g);var ka=s(a,i,y)+s(a,y,k);v<=x&&v<=J&&v<=C&&v<=ka?D?p(a,i,y,k,h):p(a,i,y,k,b):J<=x&&J<=C&&J<=ka?D?p(a,i,
y,k,j):p(a,i,y,k,d):x<=C&&x<=ka?D?p(a,i,y,k,n):p(a,i,y,k,c):C<=ka?D?p(a,i,y,k,e):p(a,i,y,k,f):D?p(a,i,y,k,l):p(a,i,y,k,g);D=!D;i+q<y&&m(a,i,y);y+q<k&&m(a,y,k)}var q=this.numNodesLeaf,p=this._nthElement,s=this._calculateSAH,D=!1;m(a,0,a.length)};xa.prototype._calculateSAH=function(a,b,c){var d,f,g,h,n,j,e;d=a[b];d=d.extents;f=d[0];g=d[1];h=d[2];n=d[3];j=d[4];e=d[5];for(b+=1;b<c;b+=1)d=a[b],d=d.extents,f>d[0]&&(f=d[0]),g>d[1]&&(g=d[1]),h>d[2]&&(h=d[2]),n<d[3]&&(n=d[3]),j<d[4]&&(j=d[4]),e<d[5]&&(e=d[5]);
return n-f+(j-g)+(e-h)};xa.prototype._nthElement=function(a,b,c,d,f){for(;8<d-b;){var g;a:{g=f(a[b]);var h=f(a[b+(d-b>>1)]),n=f(a[d-1]);if(g<h){if(!(h<n)){g=g<n?n:g;break a}}else{if(g<n)break a;if(h<n){g=n;break a}}g=h}for(var h=b,n=d,j;;h+=1){for(;f(a[h])<g;)h+=1;do n-=1;while(g<f(a[n]));if(h>=n){j=h;break}else{var e=a[h];a[h]=a[n];a[n]=e}}j<=c?b=j:d=j}for(c=b+1;c!==d;){j=a[c];g=f(j);h=c;for(n=c-1;h!==b&&g<f(a[n]);)a[h]=a[n],h-=1,n-=1;h!==c&&(a[h]=j);c+=1}};xa.prototype._recursiveBuild=function(a,
b,c,d){var f=this.nodes,g=d,d=d+1,h,n,j,e,l,m,q,p;if(b+this.numNodesLeaf>=c){p=a[b];q=p.extents;h=q[0];n=q[1];j=q[2];e=q[3];l=q[4];m=q[5];p.externalNode.spatialIndex=d;this._replaceNode(f,d,p);for(var s=b+1;s<c;s+=1)p=a[s],q=p.extents,h>q[0]&&(h=q[0]),n>q[1]&&(n=q[1]),j>q[2]&&(j=q[2]),e<q[3]&&(e=q[3]),l<q[4]&&(l=q[4]),m<q[5]&&(m=q[5]),d+=1,p.externalNode.spatialIndex=d,this._replaceNode(f,d,p);p=f[d]}else s=b+c>>1,b+1>=s?(p=a[b],p.externalNode.spatialIndex=d,this._replaceNode(f,d,p)):this._recursiveBuild(a,
b,s,d),p=f[d],q=p.extents,h=q[0],n=q[1],j=q[2],e=q[3],l=q[4],m=q[5],d+=p.escapeNodeOffset,s+1>=c?(p=a[s],p.externalNode.spatialIndex=d,this._replaceNode(f,d,p)):this._recursiveBuild(a,s,c,d),p=f[d],q=p.extents,h>q[0]&&(h=q[0]),n>q[1]&&(n=q[1]),j>q[2]&&(j=q[2]),e<q[3]&&(e=q[3]),l<q[4]&&(l=q[4]),m<q[5]&&(m=q[5]);a=f[g];void 0!==a?a.reset(h,n,j,e,l,m,d+p.escapeNodeOffset-g):(a=new this.arrayConstructor(6),a[0]=h,a[1]=n,a[2]=j,a[3]=e,a[4]=l,a[5]=m,f[g]=uc.create(a,d+p.escapeNodeOffset-g))};xa.prototype._replaceNode=
function(a,b,c){var d=a[b];a[b]=c;if(void 0!==d){do b+=1;while(void 0!==a[b]);a[b]=d}};xa.prototype._predictNumNodes=function(a,b,c){c+=1;if(a+this.numNodesLeaf>=b)c+=b-a;else var d=a+b>>1,c=a+1>=d?c+1:this._predictNumNodes(a,d,c),c=d+1>=b?c+1:this._predictNumNodes(d,b,c);return c};xa.prototype.getVisibleNodes=function(a,b,c){var d=0;if(0<this.numExternalNodes)for(var f=this.nodes,g=this.endNode,h=a.length,c=void 0===c?b.length:c,n,j,e,l,m,q,p,s,D,i,k,B,y,v=0;;){n=f[v];j=n.extents;e=j[0];l=j[1];m=
j[2];q=j[3];p=j[4];j=j[5];s=!0;D=0;do{i=a[D];k=i[0];B=i[1];y=i[2];if(k*(0>k?e:q)+B*(0>B?l:p)+y*(0>y?m:j)<i[3]){s=!1;break}D+=1}while(D<h);if(s)if(n.externalNode){if(b[c]=n.externalNode,c+=1,d+=1,v+=1,v>=g)break}else{s=!0;D=0;do{i=a[D];k=i[0];B=i[1];y=i[2];if(k*(0<k?e:q)+B*(0<B?l:p)+y*(0<y?m:j)<i[3]){s=!1;break}D+=1}while(D<h);if(s){e=v+n.escapeNodeOffset;v+=1;do n=f[v],n.externalNode&&(b[c]=n.externalNode,c+=1,d+=1),v+=1;while(v<e);if(v>=g)break}else v+=1}else if(v+=n.escapeNodeOffset,v>=g)break}return d};
xa.prototype.getOverlappingNodes=function(a,b,c){if(0<this.numExternalNodes){for(var d=a[0],f=a[1],g=a[2],h=a[3],n=a[4],a=a[5],j=this.nodes,e=this.endNode,l,m,q=0,p=void 0===c?b.length:c,s=0;;){c=j[s];l=c.extents;m=l[0];var D=l[1],i=l[2],k=l[3],B=l[4];l=l[5];if(d<=k&&f<=B&&g<=l&&h>=m&&n>=D&&a>=i)if(c.externalNode){if(b[p]=c.externalNode,p+=1,q+=1,s+=1,s>=e)break}else if(h>=k&&n>=B&&a>=l&&d<=m&&f<=D&&g<=i){m=s+c.escapeNodeOffset;s+=1;do c=j[s],c.externalNode&&(b[p]=c.externalNode,p+=1,q+=1),s+=1;while(s<
m);if(s>=e)break}else s+=1;else if(s+=c.escapeNodeOffset,s>=e)break}return q}return 0};xa.prototype.getSphereOverlappingNodes=function(a,b,c){if(0<this.numExternalNodes)for(var b=b*b,d=a[0],f=a[1],a=a[2],g=this.nodes,h=this.endNode,n,j,e=c.length,l=0;;){n=g[l];j=n.extents;var m=j[0],q=j[1],p=j[2],s=j[3],D=j[4];j=j[5];var i=0;d<m?(m-=d,i+=m*m):d>s&&(m=d-s,i+=m*m);f<q?(m=q-f,i+=m*m):f>D&&(m=f-D,i+=m*m);a<p?(m=p-a,i+=m*m):a>j&&(m=a-j,i+=m*m);if(i<=b){if(l+=1,n.externalNode&&(c[e]=n.externalNode,e+=1,
l>=h))break}else if(l+=n.escapeNodeOffset,l>=h)break}};xa.prototype.getOverlappingPairs=function(a,b){if(0<this.numExternalNodes){for(var c=this.nodes,d=this.endNode,f,g,h,n=0,j=void 0===b?a.length:b,e=0,l;;){for(f=c[e];!f.externalNode;)e+=1,f=c[e];e+=1;if(e<d){g=f.externalNode;h=f.extents;var m=h[0],q=h[1],p=h[2],s=h[3],D=h[4],i=h[5];for(l=e;;)if(f=c[l],h=f.extents,m<=h[3]&&q<=h[4]&&p<=h[5]&&s>=h[0]&&D>=h[1]&&i>=h[2]){if(l+=1,f.externalNode&&(a[j]=g,a[j+1]=f.externalNode,j+=2,n+=2,l>=d))break}else if(l+=
f.escapeNodeOffset,l>=d)break}else break}return n}return 0};xa.prototype.getExtents=function(){return 0<this.nodes.length?this.nodes[0].extents:null};xa.prototype.getRootNode=function(){return this.nodes[0]};xa.prototype.getNodes=function(){return this.nodes};xa.prototype.getEndNodeIndex=function(){return this.endNode};xa.prototype.clear=function(){this.nodes=[];this.endNode=0;this.needsRebound=this.needsRebuild=!1;this.numExternalNodes=this.numUpdates=this.numAdds=0;this.startUpdate=2147483647;this.endUpdate=
-2147483647;this.ignoreY=!1};xa.rayTest=function(a,b,c){function d(a,d,f){var g=a.getNodes()[d],k;a:{var z=g.extents,B=z[0],V=z[1];k=z[2];var t=z[3],K=z[4],w=z[5];if(B<=h&&h<=t&&V<=n&&n<=K&&k<=j&&j<=w)k=0;else{var N;0<=e?(B-=h,z=0===B?0:B*q,B=t-h,t=0===B?0:B*q):(z=(t-h)*q,t=(B-h)*q);0<=l?(B=V-n,N=0===B?0:B*p,B=K-n,V=0===B?0:B*p):(N=(K-n)*p,V=(V-n)*p);if(!(z>V||N>t))if(N>z&&(z=N),V<t&&(t=V),0<=m?(B=k-j,V=0===B?0:B*s,B=w-j,k=0===B?0:B*s):(V=(w-j)*s,k=(k-j)*s),!(z>k||V>t)){V>z&&(z=V);k<t&&(t=k);0>z&&
(z=t);k=0<=z&&z<f?z:void 0;break a}k=void 0}}if(void 0===k)return f;if(g.externalNode){if(a=c(a,g.externalNode,b,k,f))i=a,f=a.factor}else{g=D.length;for(z=0;z<g&&!(k>D[z].distance);z+=1);D.splice(z-1,0,{tree:a,nodeIndex:d,distance:k})}return f}var f=b.origin,g=b.direction,h=f[0],n=f[1],j=f[2],e=g[0],l=g[1],m=g[2],q=1/e,p=1/l,s=1/m,D=[],i=null,f=b.maxFactor,k;for(k=0;k<a.length;k+=1)g=a[k],0!==g.endNode&&(f=d(g,0,f));for(;0!==D.length;)if(g=D.pop(),!(g.distance>=f)){a=g.nodeIndex;g=g.tree;k=g.getNodes();
var B=a+k[a].escapeNodeOffset,a=a+1;do f=d(g,a,f),a+=k[a].escapeNodeOffset;while(a<B)}return i};xa.create=function(a){return new xa(a?!0:!1)};xa.version=1;xa.prototype.arrayConstructor=Array;if("undefined"!==typeof Float32Array){var kk=new Float32Array(4);"[object Float32Array]"===Object.prototype.toString.call(kk)&&(xa.prototype.arrayConstructor=Float32Array)}var ub,Qc=function(){};Qc.prototype.subscribe=function(a){for(var b=this.subscribers,c=b.length,d=0;d<c;d+=1)if(b[d]===a)return;b.push(a)};
Qc.prototype.unsubscribe=function(a){for(var b=this.subscribers,c=b.length,d=0;d<c;d+=1)if(b[d]===a){b.splice(d,1);break}};Qc.prototype.unsubscribeAll=function(){this.subscribers.length=0};Qc.prototype.notify=function(a,b,c,d,f,g,h,n,j,e,l,m){for(var q=this.subscribers,p=this.subscribers.length,s=0;s<p;)q[s].apply(null,arguments),q.length===p?s+=1:p=q.length};Qc.create=function(){var a=new Qc;a.subscribers=[];return a};ub=Qc;var R=function(){};R.prototype.processBytes=function(a,b){if(this.isValidHeader(a)){var c=
4,d=this.parseHeader(a,c),c=c+124;this.width=d.dwWidth;this.height=d.dwHeight;this.depth=d.dwCaps2&this.DDSF_VOLUME&&0<d.dwDepth?d.dwDepth:1;this.numLevels=d.dwFlags&this.DDSF_MIPMAPCOUNT?d.dwMipMapCount:1;if(d.dwCaps2&this.DDSF_CUBEMAP){var f;f=0+(d.dwCaps2&this.DDSF_CUBEMAP_POSITIVEX?1:0);f+=d.dwCaps2&this.DDSF_CUBEMAP_NEGATIVEX?1:0;f+=d.dwCaps2&this.DDSF_CUBEMAP_POSITIVEY?1:0;f+=d.dwCaps2&this.DDSF_CUBEMAP_NEGATIVEY?1:0;f+=d.dwCaps2&this.DDSF_CUBEMAP_POSITIVEZ?1:0;f+=d.dwCaps2&this.DDSF_CUBEMAP_NEGATIVEZ?
1:0;if(6!==f||this.width!==this.height){this.onerror(b);return}this.numFaces=f}else this.numFaces=1;var g=!1,h=0;f=this.gd;if(d.ddspf.dwFlags&this.DDSF_FOURCC)switch(d.ddspf.dwFourCC){case this.FOURCC_DXT1:this.format=f.PIXELFORMAT_DXT1;h=8;g=!0;break;case this.FOURCC_DXT2:case this.FOURCC_DXT3:this.format=f.PIXELFORMAT_DXT3;h=16;g=!0;break;case this.FOURCC_DXT4:case this.FOURCC_DXT5:case this.FOURCC_RXGB:this.format=f.PIXELFORMAT_DXT5;h=16;g=!0;break;case this.FOURCC_R8G8B8:this.bgrFormat=this.BGRPIXELFORMAT_B8G8R8;
h=3;break;case this.FOURCC_A8R8G8B8:this.bgrFormat=this.BGRPIXELFORMAT_B8G8R8A8;h=4;break;case this.FOURCC_R5G6B5:this.bgrFormat=this.BGRPIXELFORMAT_B5G6R5;h=2;break;case this.FOURCC_A8:this.format=f.PIXELFORMAT_A8;h=1;break;case this.FOURCC_A8B8G8R8:this.format=f.PIXELFORMAT_R8G8B8A8;h=4;break;case this.FOURCC_L8:this.format=f.PIXELFORMAT_L8;h=1;break;case this.FOURCC_A8L8:this.format=f.PIXELFORMAT_L8A8;h=2;break;case this.FOURCC_UNKNOWN:case this.FOURCC_ATI1:case this.FOURCC_ATI2:case this.FOURCC_X8R8G8B8:case this.FOURCC_X8B8G8R8:case this.FOURCC_A2B10G10R10:case this.FOURCC_A2R10G10B10:case this.FOURCC_A16B16G16R16:case this.FOURCC_R16F:case this.FOURCC_A16B16G16R16F:case this.FOURCC_R32F:case this.FOURCC_A32B32G32R32F:case this.FOURCC_L16:case this.FOURCC_X1R5G5B5:case this.FOURCC_A1R5G5B5:case this.FOURCC_A4R4G4B4:case this.FOURCC_R3G3B2:case this.FOURCC_A8R3G3B2:case this.FOURCC_X4R4G4B4:case this.FOURCC_A4L4:case this.FOURCC_D16_LOCKABLE:case this.FOURCC_D32:case this.FOURCC_D24X8:case this.FOURCC_D16:case this.FOURCC_D32F_LOCKABLE:case this.FOURCC_G16R16:case this.FOURCC_G16R16F:case this.FOURCC_G32R32F:break;
default:this.onerror(b);return}else if(d.ddspf.dwFlags===this.DDSF_RGBA&&32===d.ddspf.dwRGBBitCount)255===d.ddspf.dwRBitMask&&65280===d.ddspf.dwGBitMask&&16711680===d.ddspf.dwBBitMask&&4278190080===d.ddspf.dwABitMask?this.format=f.PIXELFORMAT_R8G8B8A8:this.bgrFormat=this.BGRPIXELFORMAT_B8G8R8A8,h=4;else if(d.ddspf.dwFlags===this.DDSF_RGB&&32===d.ddspf.dwRGBBitCount)255===d.ddspf.dwRBitMask&&65280===d.ddspf.dwGBitMask&&16711680===d.ddspf.dwBBitMask?this.format=f.PIXELFORMAT_R8G8B8A8:this.bgrFormat=
this.BGRPIXELFORMAT_B8G8R8A8,h=4;else if(d.ddspf.dwFlags===this.DDSF_RGB&&24===d.ddspf.dwRGBBitCount)255===d.ddspf.dwRBitMask&&65280===d.ddspf.dwGBitMask&&16711680===d.ddspf.dwBBitMask?this.format=f.PIXELFORMAT_R8G8B8:this.bgrFormat=this.BGRPIXELFORMAT_B8G8R8,h=3;else if(d.ddspf.dwFlags===this.DDSF_RGB&&16===d.ddspf.dwRGBBitCount)63488===d.ddspf.dwRBitMask&&2016===d.ddspf.dwGBitMask&&31===d.ddspf.dwBBitMask?this.format=f.PIXELFORMAT_R5G6B5:this.bgrFormat=this.BGRPIXELFORMAT_B5G6R5,h=2;else if(8===
d.ddspf.dwRGBBitCount)this.format=f.PIXELFORMAT_L8,h=1;else{this.onerror(b);return}for(var n=d=0;n<this.numFaces;n+=1)for(var j=this.width,e=this.height,l=this.depth,m=0;m<this.numLevels;m+=1)d+=(g?Math.floor((j+3)/4):j)*(g?Math.floor((e+3)/4):e)*l*h,j=1<j?j>>1:1,e=1<e?e>>1:1,l=1<l?l>>1:1;if(a.length<c+d)this.onerror(b);else{this.bytesPerPixel=h;c=a.subarray(c);g=!1;switch(this.bgrFormat){case this.BGRPIXELFORMAT_B8G8R8:this.format=f.PIXELFORMAT_R8G8B8;g=!0;break;case this.BGRPIXELFORMAT_B8G8R8A8:this.format=
f.PIXELFORMAT_R8G8B8A8;g=!0;break;case this.BGRPIXELFORMAT_B5G6R5:this.format=f.PIXELFORMAT_R5G6B5,g=!0}g&&(c=this.convertBGR2RGB(c));if(this.format===f.PIXELFORMAT_DXT1){if(!f.isSupported("TEXTURE_DXT1")){this.hasDXT1Alpha(c)?(this.format=f.PIXELFORMAT_R5G5B5A1,R.decodeInWorker(R.WorkerCommand.DXT1A,c,this)):(this.format=f.PIXELFORMAT_R5G6B5,R.decodeInWorker(R.WorkerCommand.DXT1,c,this));return}}else if(this.format===f.PIXELFORMAT_DXT3){if(!f.isSupported("TEXTURE_DXT3")){this.format=f.PIXELFORMAT_R4G4B4A4;
R.decodeInWorker(R.WorkerCommand.DXT3,c,this);return}}else if(this.format===f.PIXELFORMAT_DXT5&&!f.isSupported("TEXTURE_DXT5")){this.format=f.PIXELFORMAT_R4G4B4A4;R.decodeInWorker(R.WorkerCommand.DXT5,c,this);return}this.onload(c,this.width,this.height,this.format,this.numLevels,1<this.numFaces,this.depth,b)}}else this.onerror(b)};R.createWorker=function(a){var b=new Blob(["var convertDXT1To565 = "+this.convertDXT1To565.toString()+";\nvar convertDXT1To5551 = "+this.convertDXT1To5551.toString()+";\nvar convertDXT3To4444 = "+
this.convertDXT3To4444.toString()+";\nvar convertDXT5To4444 = "+this.convertDXT5To4444.toString()+";\nvar command, srcWidth, srcHeight, srcNumLevels, srcNumFaces, srcOffset;\nonmessage = function decoderOnMessage(event)\n{\n    var edata = event.data;\n    if (edata instanceof ArrayBuffer)\n    {\n        var data = new Uint8Array(edata, srcOffset);\n        switch (command)\n        {\n            case 0: // DXT1\n                data = convertDXT1To565(data, srcWidth, srcHeight, srcNumLevels, srcNumFaces);\n                break;\n            case 1: // DXT1A\n                data = convertDXT1To5551(data, srcWidth, srcHeight, srcNumLevels, srcNumFaces);\n                break;\n            case 2: // DXT3\n                data = convertDXT3To4444(data, srcWidth, srcHeight, srcNumLevels, srcNumFaces);\n                break;\n            case 3: // DXT4\n                data = convertDXT5To4444(data, srcWidth, srcHeight, srcNumLevels, srcNumFaces);\n                break;\n            default:\n                data = null;\n                break;\n        };\n        if (data)\n        {\n            postMessage(data.buffer, [data.buffer]);\n        }\n        else\n        {\n            postMessage(null);\n        }\n    }\n    else\n    {\n        command = edata.command;\n        srcWidth = edata.width;\n        srcHeight = edata.height;\n        srcNumLevels = edata.numLevels;\n        srcNumFaces = edata.numFaces;\n        srcOffset = edata.byteOffset;\n    }\n};"],
{type:"text/javascript"}),c="undefined"!==typeof URL?URL:window.webkitURL,b=c.createObjectURL(b),d=new Worker(b);if(d){var f=R.workerQueues[a];d.onmessage=function(a){var b=f.shift();d.load-=((b.width+3)*(b.height+3)>>4)*b.numLevels*b.numFaces;if(a=a.data)b.onload(a,b.width,b.height,b.format,b.numLevels,1<b.numFaces,b.depth,200);else b.onerror(200)};d.load=0}c.revokeObjectURL(b);return d};R.decodeInWorker=function(a,b,c){var d=this.maxNumWorkers;if(d){var f=this.workerQueues,g=this.workers,h=-1,n;
if(g){var h=0,j=g[0].load;for(n=1;n<d;n+=1){var e=g[n].load;j>e&&(j=e,h=n)}}else{this.workerQueues=f=[];this.workers=g=[];for(n=h=0;n<d;n+=1)if(f[n]=[],g[n]=this.createWorker(n),!g[n]){h=-1;break}}if(-1!==h){d=g[h];d.load+=((c.width+3)*(c.height+3)>>4)*c.numLevels*c.numFaces;f[h].push(c);f=b.byteOffset;c.externalBuffer?(h=b.buffer.slice(f,f+b.byteLength),f=0):h=b.buffer;d.postMessage({command:a,width:c.width,height:c.height,numLevels:c.numLevels,numFaces:c.numFaces,byteOffset:f});d.postMessage(h,
[h]);return}this.maxNumWorkers=0}switch(a){case R.WorkerCommand.DXT1:a=function(){b=R.convertDXT1To565(b,c.width,c.height,c.numLevels,c.numFaces);c.onload(b,c.width,c.height,c.format,c.numLevels,1<c.numFaces,c.depth,200)};break;case R.WorkerCommand.DXT1A:a=function(){b=R.convertDXT1To5551(b,c.width,c.height,c.numLevels,c.numFaces);c.onload(b,c.width,c.height,c.format,c.numLevels,1<c.numFaces,c.depth,200)};break;case R.WorkerCommand.DXT3:a=function(){b=R.convertDXT3To4444(b,c.width,c.height,c.numLevels,
c.numFaces);c.onload(b,c.width,c.height,c.format,c.numLevels,1<c.numFaces,c.depth,200)};break;case R.WorkerCommand.DXT5:a=function(){b=R.convertDXT5To4444(b,c.width,c.height,c.numLevels,c.numFaces);c.onload(b,c.width,c.height,c.format,c.numLevels,1<c.numFaces,c.depth,200)};break;default:a=null}if(a)TurbulenzEngine.setTimeout(a,0);else c.onerror(200)};R.prototype.parseHeader=function(a,b){function c(){var c=a[b]|a[b+1]<<8|a[b+2]<<16|a[b+3]<<24;b+=4;return c}return{dwSize:c(),dwFlags:c(),dwHeight:c(),
dwWidth:c(),dwPitchOrLinearSize:c(),dwDepth:c(),dwMipMapCount:c(),dwReserved1:[c(),c(),c(),c(),c(),c(),c(),c(),c(),c(),c()],ddspf:{dwSize:c(),dwFlags:c(),dwFourCC:c(),dwRGBBitCount:c(),dwRBitMask:c(),dwGBitMask:c(),dwBBitMask:c(),dwABitMask:c()},dwCaps1:c(),dwCaps2:c(),dwReserved2:[c(),c(),c()]}};R.prototype.isValidHeader=function(a){return 68===a[0]&&68===a[1]&&83===a[2]&&32===a[3]};R.prototype.convertBGR2RGB=function(a){for(var b=this.bytesPerPixel,c=this.width,d=this.height,f=this.numLevels,g=
this.numFaces,h=0,n=0;n<f;n+=1)h+=c*d,c=1<c?Math.floor(c/2):1,d=1<d?Math.floor(d/2):1;c=h*b*g;d=0;if(3===b||4===b){do g=a[d],a[d]=a[d+2],a[d+2]=g,d+=b;while(d<c)}else if(2===b){var b=new Uint16Array(h*g),h=g=0,j;do j=a[g+1]<<8|a[g],g+=2,f=(j&31)<<11,n=j&2016,j=j>>11&31,b[h]=f|n|j,h+=1;while(d<c);return b}return a};R.prototype.decode565=function(a,b){var c=a>>11&31,d=a>>5&63,f=a&31;b[0]=c<<3|c>>2;b[1]=d<<2|d>>4;b[2]=f<<3|f>>2;b[3]=255;return b};R.prototype.decodeColor=function(a,b,c,d,f){var g=f.cache,
h=R.prototype.decode565,n=a[b+1]<<8|a[b],b=b+2,j=a[b+1]<<8|a[b],b=b+2,e,l;if(n!==j)if(e=h(n,g[0]),h=h(j,g[1]),l=g[2],g=g[3],n>j){for(n=0;3>n;n+=1){var j=e[n],m=h[n];l[n]=(2*j+m)/3|0;g[n]=(j+2*m)/3|0}l[3]=255;g[3]=255}else{for(n=0;3>n;n+=1)l[n]=e[n]+h[n]>>1,g[n]=0;l[3]=255;g[3]=0}else{l=h=e=h(n,g[0]);g=g[1];for(n=0;4>n;n+=1)g[n]=0}f=f.colorArray;f[0]=e;f[1]=h;f[2]=l;f[3]=g;if(c)for(n=0;4>n;n+=1)c=a[b+n],e=d[n],e[0]=f[c&3],e[1]=f[c>>2&3],e[2]=f[c>>4&3],e[3]=f[c>>6&3];else for(n=0;4>n;n+=1)c=a[b+n],
e=d[n],h=f[c&3],e[0][0]=h[0],e[0][1]=h[1],e[0][2]=h[2],e[0][3]=h[3],h=f[c>>2&3],e[1][0]=h[0],e[1][1]=h[1],e[1][2]=h[2],e[1][3]=h[3],h=f[c>>4&3],e[2][0]=h[0],e[2][1]=h[1],e[2][2]=h[2],e[2][3]=h[3],h=f[c>>6&3],e[3][0]=h[0],e[3][1]=h[1],e[3][2]=h[2],e[3][3]=h[3]};R.prototype.decodeDXT3Alpha=function(a,b,c){for(var d=0;4>d;d+=1){var f=a[b+1]<<8|a[b],b=b+2,g=c[d];f?(g[0][3]=17*(f&15),g[1][3]=17*(f>>4&15),g[2][3]=17*(f>>8&15),g[3][3]=17*(f>>12&15)):(g[0][3]=0,g[1][3]=0,g[2][3]=0,g[3][3]=0)}};R.prototype.decodeDXT5Alpha=
function(a,b,c,d){var f=a[b],b=b+1,g=a[b],b=b+1,d=d.alphaArray;d[0]=f;d[1]=g;f>g?(d[2]=(6*f+1*g)/7|0,d[3]=(5*f+2*g)/7|0,d[4]=(4*f+3*g)/7|0,d[5]=(3*f+4*g)/7|0,d[6]=(2*f+5*g)/7|0,d[7]=(1*f+6*g)/7|0):(f<g?(d[2]=(4*f+1*g)/5|0,d[3]=(3*f+2*g)/5|0,d[4]=(2*f+3*g)/5|0,d[5]=(1*f+4*g)/5|0):(d[2]=f,d[3]=f,d[4]=f,d[5]=f),d[6]=0,d[7]=255);for(g=0;2>g;g+=1){var h=a[b]|a[b+1]<<8|a[b+2]<<16,b=b+3,f=c[2*g];f[0][3]=d[h&7];f[1][3]=d[h>>3&7];f[2][3]=d[h>>6&7];f[3][3]=d[h>>9&7];f=c[2*g+1];f[0][3]=d[h>>12&7];f[1][3]=d[h>>
15&7];f[2][3]=d[h>>18&7];f[3][3]=d[h>>21&7]}};R.prototype.convertToRGBA32=function(a,b,c){var d,f=this.width,g=this.height,h=this.numLevels,n=this.numFaces,j=0;for(d=0;d<h;d+=1)j+=f*g,f=1<f?f>>1:1,g=1<g?g>>1:1;d=new Uint8Array(4*j*n);for(var e=j=0,l=[[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)],[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)],[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)],[new Uint8Array(4),new Uint8Array(4),
new Uint8Array(4),new Uint8Array(4)]],m=0;m<n;m+=1)for(var f=this.width,g=this.height,q=0;q<h;q+=1){for(var p=4<f?4:f,s=4<g?4:g,D=g+3>>2,i=f+3>>2,k=4*f,B=4*p,y=k*(s-1),v=0;v<D;v+=1){for(var x=0;x<i;x+=1){b(a,j,l);for(var J=e,C=0;C<s;C+=1){for(var ka=l[C],Q=J,V=0;V<p;V+=1){var t=ka[V];d[Q]=t[0];d[Q+1]=t[1];d[Q+2]=t[2];d[Q+3]=t[3];Q+=4}J+=k}j+=c;e+=B}e+=y}f=1<f?f>>1:1;g=1<g?g>>1:1}return d};R.prototype.hasDXT1Alpha=function(a){var b=a.length,c,d,f;for(c=0;c<b;c+=8)if((a[c+1]<<8|a[c])<=(a[c+3]<<8|a[c+
2]))for(d=0;4>d;d+=1)if(f=a[c+4+d],0!==f&&(3===(f&3)||3===(f>>2&3)||3===(f>>4&3)||3===(f>>6&3)))return!0;return!1};R.prototype.encodeR5G6B5=function(a){return(a[2]&248)>>>3|(a[1]&252)<<3|(a[0]&248)<<8};R.prototype.encodeR5G5B5A1=function(a){return a[3]>>>7|(a[2]&248)>>>2|(a[1]&248)<<3|(a[0]&248)<<8};R.prototype.encodeR4G4B4A4=function(a){return a[3]>>>4|a[2]&240|(a[1]&240)<<4|(a[0]&240)<<8};R.convertDXT1To565=function(a,b,c,d,f){function g(a,b,c,d,f){function g(a,b){var c=a>>11&31,d=a>>5&63,f=a&31;
b[0]=c<<3|c>>2;b[1]=d<<2|d>>4;b[2]=f<<3|f>>2;b[3]=255;return b}var h=a[b+1]<<8|a[b],b=b+2,n=a[b+1]<<8|a[b],b=b+2,j,e,r;if(h!==n)if(j=g(h,d[0]),e=g(n,d[1]),r=d[2],d=d[3],h>n){for(h=0;3>h;h+=1){var n=j[h],l=e[h];r[h]=(2*n+l)/3|0;d[h]=(n+2*l)/3|0}r[3]=255;d[3]=255}else{for(h=0;3>h;h+=1)r[h]=j[h]+e[h]>>1,d[h]=0;r[3]=255;d[3]=0}else{r=e=j=g(h,d[0]);d=d[1];for(h=0;4>h;h+=1)d[h]=0}f[0]=j;f[1]=e;f[2]=r;f[3]=d;for(h=0;4>h;h+=1)j=a[b+h],e=c[h],e[0]=f[j&3],e[1]=f[j>>2&3],e[2]=f[j>>4&3],e[3]=f[j>>6&3]}var h=
[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)],n=Array(4),j,e=b,l=c,m=0;for(j=0;j<d;j+=1)m+=e*l,e=1<e?e>>1:1,l=1<l?l>>1:1;j=new Uint16Array(1*m*f);for(var q=m=0,p=[[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)],[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)],[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)],[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)]],s=0;s<f;s+=1)for(var e=
b,l=c,D=0;D<d;D+=1){for(var i=4<e?4:e,k=4<l?4:l,B=l+3>>2,y=e+3>>2,v=1*e,x=1*i,J=v*(k-1),C=0;C<B;C+=1){for(var ka=0;ka<y;ka+=1){g(a,m,p,h,n);for(var Q=q,V=0;V<k;V+=1){for(var t=p[V],K=Q,w=0;w<i;w+=1){var N=t[w];j[K]=(N[2]&248)>>>3|(N[1]&252)<<3|(N[0]&248)<<8;K+=1}Q+=v}m+=8;q+=x}q+=J}e=1<e?e>>1:1;l=1<l?l>>1:1}return j};R.convertDXT1To5551=function(a,b,c,d,f){function g(a,b,c,d,f){function g(a,b){var c=a>>11&31,d=a>>5&63,f=a&31;b[0]=c<<3|c>>2;b[1]=d<<2|d>>4;b[2]=f<<3|f>>2;b[3]=255;return b}var h=a[b+
1]<<8|a[b],b=b+2,n=a[b+1]<<8|a[b],b=b+2,j,e,r;if(h!==n)if(j=g(h,d[0]),e=g(n,d[1]),r=d[2],d=d[3],h>n){for(h=0;3>h;h+=1){var n=j[h],l=e[h];r[h]=(2*n+l)/3|0;d[h]=(n+2*l)/3|0}r[3]=255;d[3]=255}else{for(h=0;3>h;h+=1)r[h]=j[h]+e[h]>>1,d[h]=0;r[3]=255;d[3]=0}else{r=e=j=g(h,d[0]);d=d[1];for(h=0;4>h;h+=1)d[h]=0}f[0]=j;f[1]=e;f[2]=r;f[3]=d;for(h=0;4>h;h+=1)j=a[b+h],e=c[h],e[0]=f[j&3],e[1]=f[j>>2&3],e[2]=f[j>>4&3],e[3]=f[j>>6&3]}var h=[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)],
n=Array(4),j,e=b,l=c,m=0;for(j=0;j<d;j+=1)m+=e*l,e=1<e?e>>1:1,l=1<l?l>>1:1;j=new Uint16Array(1*m*f);for(var q=m=0,p=[[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)],[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)],[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)],[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)]],s=0;s<f;s+=1)for(var e=b,l=c,D=0;D<d;D+=1){for(var i=4<e?4:e,k=4<l?4:l,B=l+3>>2,y=e+3>>
2,v=1*e,x=1*i,J=v*(k-1),C=0;C<B;C+=1){for(var ka=0;ka<y;ka+=1){g(a,m,p,h,n);for(var Q=q,V=0;V<k;V+=1){for(var t=p[V],K=Q,w=0;w<i;w+=1){var N=t[w];j[K]=N[3]>>>7|(N[2]&248)>>>2|(N[1]&248)<<3|(N[0]&248)<<8;K+=1}Q+=v}m+=8;q+=x}q+=J}e=1<e?e>>1:1;l=1<l?l>>1:1}return j};R.convertDXT3To4444=function(a,b,c,d,f){function g(a,b,c,d,f){function g(a,b){var c=a>>11&31,d=a>>5&63,f=a&31;b[0]=c<<3|c>>2;b[1]=d<<2|d>>4;b[2]=f<<3|f>>2;b[3]=255;return b}var h=a[b+1]<<8|a[b],b=b+2,n=a[b+1]<<8|a[b],b=b+2,j,e,r;if(h!==n)if(j=
g(h,d[0]),e=g(n,d[1]),r=d[2],d=d[3],h>n){for(h=0;3>h;h+=1){var n=j[h],l=e[h];r[h]=(2*n+l)/3|0;d[h]=(n+2*l)/3|0}r[3]=255;d[3]=255}else{for(h=0;3>h;h+=1)r[h]=j[h]+e[h]>>1,d[h]=0;r[3]=255;d[3]=0}else{r=e=j=g(h,d[0]);d=d[1];for(h=0;4>h;h+=1)d[h]=0}f[0]=j;f[1]=e;f[2]=r;f[3]=d;for(h=0;4>h;h+=1)j=a[b+h],e=c[h],r=f[j&3],e[0][0]=r[0],e[0][1]=r[1],e[0][2]=r[2],e[0][3]=r[3],r=f[j>>2&3],e[1][0]=r[0],e[1][1]=r[1],e[1][2]=r[2],e[1][3]=r[3],r=f[j>>4&3],e[2][0]=r[0],e[2][1]=r[1],e[2][2]=r[2],e[2][3]=r[3],r=f[j>>
6&3],e[3][0]=r[0],e[3][1]=r[1],e[3][2]=r[2],e[3][3]=r[3]}var h=[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)],n=Array(4),j,e=b,l=c,m=0;for(j=0;j<d;j+=1)m+=e*l,e=1<e?e>>1:1,l=1<l?l>>1:1;j=new Uint16Array(1*m*f);for(var q=m=0,p=[[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)],[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)],[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)],[new Uint8Array(4),new Uint8Array(4),
new Uint8Array(4),new Uint8Array(4)]],s=0;s<f;s+=1)for(var e=b,l=c,D=0;D<d;D+=1){for(var i=4<e?4:e,k=4<l?4:l,B=l+3>>2,y=e+3>>2,v=1*e,x=1*i,J=v*(k-1),C=0;C<B;C+=1){for(var ka=0;ka<y;ka+=1){g(a,m+8,p,h,n);for(var Q=a,V=m,t=p,K=0;4>K;K+=1){var w=Q[V+1]<<8|Q[V],V=V+2,N=t[K];w?(N[0][3]=17*(w&15),N[1][3]=17*(w>>4&15),N[2][3]=17*(w>>8&15),N[3][3]=17*(w>>12&15)):(N[0][3]=0,N[1][3]=0,N[2][3]=0,N[3][3]=0)}Q=q;for(V=0;V<k;V+=1){t=p[V];K=Q;for(w=0;w<i;w+=1)N=t[w],j[K]=N[3]>>>4|N[2]&240|(N[1]&240)<<4|(N[0]&240)<<
8,K+=1;Q+=v}m+=16;q+=x}q+=J}e=1<e?e>>1:1;l=1<l?l>>1:1}return j};R.convertDXT5To4444=function(a,b,c,d,f){function g(a,b,c,d,f){function g(a,b){var c=a>>11&31,d=a>>5&63,f=a&31;b[0]=c<<3|c>>2;b[1]=d<<2|d>>4;b[2]=f<<3|f>>2;b[3]=255;return b}var h=a[b+1]<<8|a[b],b=b+2,n=a[b+1]<<8|a[b],b=b+2,j,e,r;if(h!==n)if(j=g(h,d[0]),e=g(n,d[1]),r=d[2],d=d[3],h>n){for(h=0;3>h;h+=1){var n=j[h],l=e[h];r[h]=(2*n+l)/3|0;d[h]=(n+2*l)/3|0}r[3]=255;d[3]=255}else{for(h=0;3>h;h+=1)r[h]=j[h]+e[h]>>1,d[h]=0;r[3]=255;d[3]=0}else{r=
e=j=g(h,d[0]);d=d[1];for(h=0;4>h;h+=1)d[h]=0}f[0]=j;f[1]=e;f[2]=r;f[3]=d;for(h=0;4>h;h+=1)j=a[b+h],e=c[h],r=f[j&3],e[0][0]=r[0],e[0][1]=r[1],e[0][2]=r[2],e[0][3]=r[3],r=f[j>>2&3],e[1][0]=r[0],e[1][1]=r[1],e[1][2]=r[2],e[1][3]=r[3],r=f[j>>4&3],e[2][0]=r[0],e[2][1]=r[1],e[2][2]=r[2],e[2][3]=r[3],r=f[j>>6&3],e[3][0]=r[0],e[3][1]=r[1],e[3][2]=r[2],e[3][3]=r[3]}var h=[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)],n=Array(4),j=new Uint8Array(8),e,l=b,m=c,q=0;for(e=0;e<d;e+=1)q+=
l*m,l=1<l?l>>1:1,m=1<m?m>>1:1;e=new Uint16Array(1*q*f);for(var p=q=0,s=[[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)],[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)],[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)],[new Uint8Array(4),new Uint8Array(4),new Uint8Array(4),new Uint8Array(4)]],i=0;i<f;i+=1)for(var l=b,m=c,u=0;u<d;u+=1){for(var k=4<l?4:l,B=4<m?4:m,y=m+3>>2,v=l+3>>2,x=1*l,J=1*k,C=x*(B-1),ka=0;ka<y;ka+=1){for(var Q=
0;Q<v;Q+=1){g(a,q+8,s,h,n);var V=a,t=q,K=s,w=j,N=V[t],t=t+1,da=V[t],t=t+1;w[0]=N;w[1]=da;N>da?(w[2]=(6*N+1*da)/7|0,w[3]=(5*N+2*da)/7|0,w[4]=(4*N+3*da)/7|0,w[5]=(3*N+4*da)/7|0,w[6]=(2*N+5*da)/7|0,w[7]=(1*N+6*da)/7|0):(N<da?(w[2]=(4*N+1*da)/5|0,w[3]=(3*N+2*da)/5|0,w[4]=(2*N+3*da)/5|0,w[5]=(1*N+4*da)/5|0):(w[2]=N,w[3]=N,w[4]=N,w[5]=N),w[6]=0,w[7]=255);N=void 0;for(da=0;2>da;da+=1){var A=V[t]|V[t+1]<<8|V[t+2]<<16,t=t+3,N=K[2*da];N[0][3]=w[A&7];N[1][3]=w[A>>3&7];N[2][3]=w[A>>6&7];N[3][3]=w[A>>9&7];N=K[2*
da+1];N[0][3]=w[A>>12&7];N[1][3]=w[A>>15&7];N[2][3]=w[A>>18&7];N[3][3]=w[A>>21&7]}V=p;for(t=0;t<B;t+=1){K=s[t];w=V;for(N=0;N<k;N+=1)da=K[N],e[w]=da[3]>>>4|da[2]&240|(da[1]&240)<<4|(da[0]&240)<<8,w+=1;V+=x}q+=16;p+=J}p+=C}l=1<l?l>>1:1;m=1<m?m>>1:1}return e};R.create=function(a){function b(a,b,c,d){return a.charCodeAt(0)+256*b.charCodeAt(0)+65536*c.charCodeAt(0)+16777216*d.charCodeAt(0)}var c=new R;c.gd=a.gd;c.onload=a.onload;c.onerror=a.onerror;c.FOURCC_ATI1=b("A","T","I","1");c.FOURCC_ATI2=b("A",
"T","I","2");c.FOURCC_RXGB=b("R","X","G","B");var d=a.src;if(d){c.src=d;var f;if(window.XMLHttpRequest)f=new window.XMLHttpRequest;else if(window.ActiveXObject)f=new window.ActiveXObject("Microsoft.XMLHTTP");else{if(a.onerror)a.onerror(0);return null}f.onreadystatechange=function(){if(4===f.readyState){if(!TurbulenzEngine||!TurbulenzEngine.isUnloading()){var a=f.status;if(0===a&&("file:"===window.location.protocol||"chrome-extension:"===window.location.protocol))a=200;if(""===f.getAllResponseHeaders()&&
("arraybuffer"===f.responseType?!f.response:f.mozResponseArrayBuffer?!f.mozResponseArrayBuffer:!f.responseText)){if(c.onerror)c.onerror(0);f=f.onreadystatechange=null;return}if(200===a||0===a){var b;if("arraybuffer"===f.responseType)b=f.response;else if(f.mozResponseArrayBuffer)b=f.mozResponseArrayBuffer;else{var d=f.responseText,j=d.length;b=[];b.length=j;for(var e=0;e<j;e+=1)b[e]=d.charCodeAt(e)&255}c.externalBuffer=!1;c.processBytes(new Uint8Array(b),a)}else if(c.onerror)c.onerror(a)}f=f.onreadystatechange=
null}};f.open("GET",a.src,!0);f.hasOwnProperty&&f.hasOwnProperty("responseType")?f.responseType="arraybuffer":f.overrideMimeType?f.overrideMimeType("text/plain; charset=x-user-defined"):f.setRequestHeader("Content-Type","text/plain; charset=x-user-defined");f.send(null)}else c.externalBuffer=!0,c.processBytes(a.data,0);return c};R.destroy=function(){var a=this.maxNumWorkers;if(a){this.workerQueues=null;var b=this.workers;if(b){this.workers=null;var c;for(c=0;c<a;c+=1)b[c].terminate()}}};R.version=
1;R.maxNumWorkers="undefined"!==typeof Worker&&"undefined"!==typeof Blob&&("undefined"!==typeof URL||"undefined"!==typeof window.webkitURL)?4:0;R.WorkerCommand={DXT1:0,DXT1A:1,DXT3:2,DXT5:3};R.workerQueues=null;R.workers=null;R.prototype.DDSF_CAPS=1;R.prototype.DDSF_HEIGHT=2;R.prototype.DDSF_WIDTH=4;R.prototype.DDSF_PITCH=8;R.prototype.DDSF_PIXELFORMAT=4096;R.prototype.DDSF_MIPMAPCOUNT=131072;R.prototype.DDSF_LINEARSIZE=524288;R.prototype.DDSF_DEPTH=8388608;R.prototype.DDSF_ALPHAPIXELS=1;R.prototype.DDSF_FOURCC=
4;R.prototype.DDSF_RGB=64;R.prototype.DDSF_RGBA=65;R.prototype.DDSF_COMPLEX=8;R.prototype.DDSF_TEXTURE=4096;R.prototype.DDSF_MIPMAP=4194304;R.prototype.DDSF_CUBEMAP=512;R.prototype.DDSF_CUBEMAP_POSITIVEX=1024;R.prototype.DDSF_CUBEMAP_NEGATIVEX=2048;R.prototype.DDSF_CUBEMAP_POSITIVEY=4096;R.prototype.DDSF_CUBEMAP_NEGATIVEY=8192;R.prototype.DDSF_CUBEMAP_POSITIVEZ=16384;R.prototype.DDSF_CUBEMAP_NEGATIVEZ=32768;R.prototype.DDSF_CUBEMAP_ALL_FACES=64512;R.prototype.DDSF_VOLUME=2097152;R.prototype.FOURCC_UNKNOWN=
0;R.prototype.FOURCC_R8G8B8=20;R.prototype.FOURCC_A8R8G8B8=21;R.prototype.FOURCC_X8R8G8B8=22;R.prototype.FOURCC_R5G6B5=23;R.prototype.FOURCC_X1R5G5B5=24;R.prototype.FOURCC_A1R5G5B5=25;R.prototype.FOURCC_A4R4G4B4=26;R.prototype.FOURCC_R3G3B2=27;R.prototype.FOURCC_A8=28;R.prototype.FOURCC_A8R3G3B2=29;R.prototype.FOURCC_X4R4G4B4=30;R.prototype.FOURCC_A2B10G10R10=31;R.prototype.FOURCC_A8B8G8R8=32;R.prototype.FOURCC_X8B8G8R8=33;R.prototype.FOURCC_G16R16=34;R.prototype.FOURCC_A2R10G10B10=35;R.prototype.FOURCC_A16B16G16R16=
36;R.prototype.FOURCC_L8=50;R.prototype.FOURCC_A8L8=51;R.prototype.FOURCC_A4L4=52;R.prototype.FOURCC_DXT1=827611204;R.prototype.FOURCC_DXT2=844388420;R.prototype.FOURCC_DXT3=861165636;R.prototype.FOURCC_DXT4=877942852;R.prototype.FOURCC_DXT5=894720068;R.prototype.FOURCC_D16_LOCKABLE=70;R.prototype.FOURCC_D32=71;R.prototype.FOURCC_D24X8=77;R.prototype.FOURCC_D16=80;R.prototype.FOURCC_D32F_LOCKABLE=82;R.prototype.FOURCC_L16=81;R.prototype.FOURCC_R16F=111;R.prototype.FOURCC_G16R16F=112;R.prototype.FOURCC_A16B16G16R16F=
113;R.prototype.FOURCC_R32F=114;R.prototype.FOURCC_G32R32F=115;R.prototype.FOURCC_A32B32G32R32F=116;R.prototype.BGRPIXELFORMAT_B5G6R5=1;R.prototype.BGRPIXELFORMAT_B8G8R8A8=2;R.prototype.BGRPIXELFORMAT_B8G8R8=3;var Cb=function(){};Cb.prototype.setData=function(a,b,c,d,f,g,h){var n=this.gd,j=this.target;n.bindTexture(j,this.glTexture);3<=arguments.length?(void 0===d&&(d=0),void 0===f&&(f=0),void 0===g&&(g=this.width-d),void 0===h&&(h=this.height-f),this.updateSubData(a,b,c,d,f,g,h)):this.updateData(a);
n.bindTexture(j,null)};Cb.prototype.createGLTexture=function(a){var b=this.gd,c=b.gl,d;if(this.cubemap)d=c.TEXTURE_CUBE_MAP;else{if(1<this.depth)return!1;d=c.TEXTURE_2D}this.target=d;var f=c.createTexture();this.glTexture=f;b.bindTexture(d,f);c.texParameteri(d,c.TEXTURE_MAG_FILTER,c.LINEAR);this.mipmaps||1<this.numDataLevels?c.texParameteri(d,c.TEXTURE_MIN_FILTER,c.LINEAR_MIPMAP_NEAREST):c.texParameteri(d,c.TEXTURE_MIN_FILTER,c.LINEAR);c.texParameteri(d,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(d,
c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);this.updateData(a);b.bindTexture(d,null);return!0};Cb.prototype.updateData=function(a){var b=this.gd,c=b.gl,d=this.mipmaps&&this.numDataLevels!==1+Math.max(Math.floor(Math.log(this.width)/Math.LN2),Math.floor(Math.log(this.height)/Math.LN2)),f=this.format,g,h,n=null,j;if(f===b.PIXELFORMAT_A8)f=c.ALPHA,g=c.UNSIGNED_BYTE,h=1,a&&!a.src&&(n=a instanceof Uint8Array?a:new Uint8Array(a));else if(f===b.PIXELFORMAT_L8)f=c.LUMINANCE,g=c.UNSIGNED_BYTE,h=1,a&&!a.src&&(n=a instanceof
Uint8Array?a:new Uint8Array(a));else if(f===b.PIXELFORMAT_L8A8)f=c.LUMINANCE_ALPHA,g=c.UNSIGNED_BYTE,h=2,a&&!a.src&&(n=a instanceof Uint8Array?a:new Uint8Array(a));else if(f===b.PIXELFORMAT_R5G5B5A1)f=c.RGBA,g=c.UNSIGNED_SHORT_5_5_5_1,h=1,a&&!a.src&&(n=a instanceof Uint16Array?a:new Uint16Array(a));else if(f===b.PIXELFORMAT_R5G6B5)f=c.RGB,g=c.UNSIGNED_SHORT_5_6_5,h=1,a&&!a.src&&(n=a instanceof Uint16Array?a:new Uint16Array(a));else if(f===b.PIXELFORMAT_R4G4B4A4)f=c.RGBA,g=c.UNSIGNED_SHORT_4_4_4_4,
h=1,a&&!a.src&&(n=a instanceof Uint16Array?a:new Uint16Array(a));else if(f===b.PIXELFORMAT_R8G8B8A8)f=c.RGBA,g=c.UNSIGNED_BYTE,h=4,a&&!a.src&&(n=a instanceof Uint8Array?"undefined"!==typeof Uint8ClampedArray&&a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a:new Uint8Array(a));else if(f===b.PIXELFORMAT_R8G8B8)f=c.RGB,g=c.UNSIGNED_BYTE,h=3,a&&!a.src&&(n=a instanceof Uint8Array?"undefined"!==typeof Uint8ClampedArray&&a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a:new Uint8Array(a));
else if(f===b.PIXELFORMAT_D24S8)f=c.DEPTH_STENCIL,g=c.UNSIGNED_INT,h=1,a&&!a.src&&(n=new Uint32Array(a));else if(f===b.PIXELFORMAT_DXT1||f===b.PIXELFORMAT_DXT3||f===b.PIXELFORMAT_DXT5)if(j=b.compressedTexturesExtension){f===b.PIXELFORMAT_DXT1?(f=j.COMPRESSED_RGBA_S3TC_DXT1_EXT,h=8):(f=f===b.PIXELFORMAT_DXT3?j.COMPRESSED_RGBA_S3TC_DXT3_EXT:j.COMPRESSED_RGBA_S3TC_DXT5_EXT,h=16);if(void 0===f)return;a&&!a.src&&(n=a instanceof Uint8Array?a:new Uint8Array(a))}else return;else return;var e=a&&0<this.numDataLevels?
this.numDataLevels:1,l=this.width,m=this.height,q=0,p,s,i,u;if(this.cubemap){if(a&&a instanceof zd)return;p=c.TEXTURE_CUBE_MAP;for(var k=0;6>k;k+=1){var B=c.TEXTURE_CUBE_MAP_POSITIVE_X+k;for(s=0;s<e;s+=1)j?(i=Math.floor((l+3)/4)*Math.floor((m+3)/4)*h,u=n?1===e?n:n.subarray(q,q+i):new Uint8Array(i),b.WEBGL_compressed_texture_s3tc?c.compressedTexImage2D(B,s,f,l,m,0,u):j.compressedTexImage2D(B,s,f,l,m,0,u)):(i=l*m*h,n?(u=1===e?n:n.subarray(q,q+i),c.texImage2D(B,s,f,l,m,0,f,g,u)):a?c.texImage2D(B,s,f,
f,g,a):(u=g===c.UNSIGNED_SHORT_5_6_5||g===c.UNSIGNED_SHORT_5_5_5_1||g===c.UNSIGNED_SHORT_4_4_4_4?new Uint16Array(i):new Uint8Array(i),c.texImage2D(B,s,f,l,m,0,f,g,u))),q+=i,l=1<l?Math.floor(l/2):1,m=1<m?Math.floor(m/2):1;l=this.width;m=this.height}}else if(a&&a instanceof zd)p=c.TEXTURE_2D,c.texImage2D(p,0,f,f,g,a.video);else{p=c.TEXTURE_2D;for(s=0;s<e;s+=1)j?(i=Math.floor((l+3)/4)*Math.floor((m+3)/4)*h,u=n?1===e?n:n.subarray(q,q+i):new Uint8Array(i),b.WEBGL_compressed_texture_s3tc?c.compressedTexImage2D(p,
s,f,l,m,0,u):j.compressedTexImage2D(p,s,f,l,m,0,u)):(i=l*m*h,n?(u=1===e?n:n.subarray(q,q+i),c.texImage2D(p,s,f,l,m,0,f,g,u)):a?c.texImage2D(p,s,f,f,g,a):(u=g===c.UNSIGNED_SHORT_5_6_5||g===c.UNSIGNED_SHORT_5_5_5_1||g===c.UNSIGNED_SHORT_4_4_4_4?new Uint16Array(i):new Uint8Array(i),c.texImage2D(p,s,f,l,m,0,f,g,u))),q+=i,l=1<l?Math.floor(l/2):1,m=1<m?Math.floor(m/2):1}d&&c.generateMipmap(p)};Cb.prototype.updateSubData=function(a,b,c,d,f,g,h){var n=this.gd,j=n.gl,e=this.format,l,m,q;if(e===n.PIXELFORMAT_A8)e=
j.ALPHA,l=j.UNSIGNED_BYTE,m=a instanceof Uint8Array?a:new Uint8Array(a);else if(e===n.PIXELFORMAT_L8)e=j.LUMINANCE,l=j.UNSIGNED_BYTE,m=a instanceof Uint8Array?a:new Uint8Array(a);else if(e===n.PIXELFORMAT_L8A8)e=j.LUMINANCE_ALPHA,l=j.UNSIGNED_BYTE,m=a instanceof Uint8Array?a:new Uint8Array(a);else if(e===n.PIXELFORMAT_R5G5B5A1)e=j.RGBA,l=j.UNSIGNED_SHORT_5_5_5_1,m=a instanceof Uint16Array?a:new Uint16Array(a);else if(e===n.PIXELFORMAT_R5G6B5)e=j.RGB,l=j.UNSIGNED_SHORT_5_6_5,m=a instanceof Uint16Array?
a:new Uint16Array(a);else if(e===n.PIXELFORMAT_R4G4B4A4)e=j.RGBA,l=j.UNSIGNED_SHORT_4_4_4_4,m=a instanceof Uint16Array?a:new Uint16Array(a);else if(e===n.PIXELFORMAT_R8G8B8A8)e=j.RGBA,l=j.UNSIGNED_BYTE,m=a instanceof Uint8Array?"undefined"!==typeof Uint8ClampedArray&&a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a:new Uint8Array(a);else if(e===n.PIXELFORMAT_R8G8B8)e=j.RGB,l=j.UNSIGNED_BYTE,m=a instanceof Uint8Array?"undefined"!==typeof Uint8ClampedArray&&a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):
a:new Uint8Array(a);else if(e===n.PIXELFORMAT_DXT1||e===n.PIXELFORMAT_DXT3||e===n.PIXELFORMAT_DXT5)if(q=n.compressedTexturesExtension)e=e===n.PIXELFORMAT_DXT1?q.COMPRESSED_RGBA_S3TC_DXT1_EXT:e===n.PIXELFORMAT_DXT3?q.COMPRESSED_RGBA_S3TC_DXT3_EXT:q.COMPRESSED_RGBA_S3TC_DXT5_EXT,m=a instanceof Uint8Array?a:new Uint8Array(a);else return;else return;if(this.cubemap){if(a instanceof zd)return;b=j.TEXTURE_CUBE_MAP_POSITIVE_X+b}else{if(a instanceof zd){b=j.TEXTURE_2D;j.texSubImage2D(b,c,d,f,e,l,a.video);
return}b=j.TEXTURE_2D}q?n.WEBGL_compressed_texture_s3tc?j.compressedTexSubImage2D(b,c,d,f,g,h,e,m):q.compressedTexSubImage2D(b,c,d,f,g,h,e,m):j.texSubImage2D(b,c,d,f,g,h,e,l,m)};Cb.prototype.updateMipmaps=function(a){if(this.mipmaps)if(1<this.depth)TurbulenzEngine.callOnError("3D texture mipmap generation unsupported");else if(!(this.cubemap&&5!==a)){var a=this.gd,b=a.gl,c=this.target;a.bindTexture(c,this.glTexture);b.generateMipmap(c);a.bindTexture(c,null)}};Cb.prototype.destroy=function(){var a=
this.gd;if(a){var b=this.glTexture;if(b){var c=a.gl;c&&(a.unbindTexture(b),c.deleteTexture(b));delete this.glTexture}delete this.sampler;delete this.gd}};Cb.prototype.typedArrayIsValid=function(a){var b=this.gd,c=this.format;if(b){if(c===b.PIXELFORMAT_A8||c===b.PIXELFORMAT_L8||c===b.PIXELFORMAT_S8)return(a instanceof Uint8Array||"undefined"!==typeof Uint8ClampedArray&&a instanceof Uint8ClampedArray)&&a.length===this.width*this.height*this.depth;if(c===b.PIXELFORMAT_L8A8)return(a instanceof Uint8Array||
"undefined"!==typeof Uint8ClampedArray&&a instanceof Uint8ClampedArray)&&a.length===2*this.width*this.height*this.depth;if(c===b.PIXELFORMAT_R8G8B8)return(a instanceof Uint8Array||"undefined"!==typeof Uint8ClampedArray&&a instanceof Uint8ClampedArray)&&a.length===3*this.width*this.height*this.depth;if(c===b.PIXELFORMAT_R8G8B8A8)return(a instanceof Uint8Array||"undefined"!==typeof Uint8ClampedArray&&a instanceof Uint8ClampedArray)&&a.length===4*this.width*this.height*this.depth;if(c===b.PIXELFORMAT_R5G5B5A1||
c===b.PIXELFORMAT_R5G6B5||c===b.PIXELFORMAT_R4G4B4A4)return a instanceof Uint16Array&&a.length===this.width*this.height*this.depth}return!1};Cb.create=function(a,b){var c=new Cb;c.gd=a;c.mipmaps=b.mipmaps;c.dynamic=b.dynamic;c.renderable=b.renderable;c.numDataLevels=0;c.id=++a.counters.textures;var d=b.src;if(d){c.name=b.name||d;var f,g=b.data;f=g?137===g[0]&&80===g[1]&&78===g[2]&&71===g[3]?".png":255===g[0]&&216===g[1]&&255===g[2]&&(224===g[3]||225===g[3])?".jpg":68===g[0]&&68===g[1]&&83===g[2]&&
32===g[3]?".dds":d.slice(-4):d.slice(-4);if(".dds"===f||".tga"===f)return".tga"===f&&"undefined"!==typeof lb?(f={gd:a,onload:function(a,d,f,g,h){c.width=d;c.height=f;c.depth=1;c.format=g;c.cubemap=!1;a=c.createGLTexture(a);if(b.onload)b.onload(a?c:null,h)},onerror:function(a){c.failed=!0;if(b.onload)b.onload(null,a)},data:void 0,src:void 0},g?f.data=g:f.src=d,lb.create(f)):".dds"===f&&"undefined"!==typeof R?(f={gd:a,onload:function(a,d,f,g,h,n,j,e){c.width=d;c.height=f;c.format=g;c.cubemap=n;c.depth=
j;c.numDataLevels=h;a=c.createGLTexture(a);if(b.onload)b.onload(a?c:null,e)},onerror:function(a){c.failed=!0;if(b.onload)b.onload(null,a)},data:void 0,src:void 0},g?f.data=g:f.src=d,R.create(f)):(TurbulenzEngine.callOnError("Missing image loader required for "+d),c=Cb.create(a,{name:b.name||d,width:2,height:2,depth:1,format:"R8G8B8A8",cubemap:!1,mipmaps:b.mipmaps,dynamic:b.dynamic,renderable:b.renderable,data:[255,20,147,255,255,0,0,255,255,255,255,255,255,20,147,255]}),b.onload&&(TurbulenzEngine?
TurbulenzEngine.setTimeout(function(){b.onload(c,200)},0):window.setTimeout(function(){b.onload(c,200)},0))),c;var h=new Image,n=function(){c.width=h.width;c.height=h.height;c.depth=1;c.format=a.PIXELFORMAT_R8G8B8A8;c.cubemap=!1;var d=c.createGLTexture(h);if(b.onload)b.onload(d?c:null,200)};h.onload=n;h.onerror=function(){c.failed=!0;if(b.onload)b.onload(null)};if(g){if("undefined"!==typeof Blob&&"undefined"!==typeof URL&&URL.createObjectURL){var j;".jpg"===f||".jpeg"===f?j=new Blob([g],{type:"image/jpeg"}):
".png"===f&&(j=new Blob([g],{type:"image/png"}));h.onload=function(){n();URL.revokeObjectURL(h.src)};d=URL.createObjectURL(j)}else".jpg"===f||".jpeg"===f?d="data:image/jpeg;base64,"+TurbulenzEngine.base64Encode(g):".png"===f&&(d="data:image/png;base64,"+TurbulenzEngine.base64Encode(g));h.src=d}else if("undefined"!==typeof URL&&URL.createObjectURL){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4===e.readyState){if(!TurbulenzEngine||!TurbulenzEngine.isUnloading()){var a=e.status;if(0===
a&&("file:"===window.location.protocol||"chrome-extension:"===window.location.protocol))a=200;if(""===e.getAllResponseHeaders()&&!e.response){if(b.onload)b.onload(null,0)}else if(200===a||0===a)h.onload=function(){n();URL.revokeObjectURL(h.src)},h.src=URL.createObjectURL(e.response);else b.onload(null,a);e=e.onreadystatechange=null}return c}};e.open("GET",d,!0);e.responseType="blob";e.send()}else h.crossOrigin="anonymous",h.src=d}else{if(""===d&&b.onload)return null;d=b.format;"string"===typeof d&&
(d=a["PIXELFORMAT_"+d]);c.width=b.width;c.height=b.height;c.depth=b.depth;c.format=d;c.cubemap=b.cubemap;c.name=b.name;c.createGLTexture(b.data)||(c=null);b.renderable&&(a.PIXELFORMAT_D16===d?c.glDepthAttachment=a.gl.DEPTH_ATTACHMENT:a.PIXELFORMAT_D24S8===d&&(c.glDepthAttachment=a.gl.DEPTH_STENCIL_ATTACHMENT));if(b.onload)b.onload(c,200)}return c};Cb.version=1;var zd,Tb=function(){};Tb.prototype.play=function(a){var b=this.video;this.playing||(this.playing=!0,this.paused=!1);void 0===a&&(a=0);if(0.01<
Math.abs(b.currentTime-a))try{b.currentTime=a}catch(c){}b.play();return!0};Tb.prototype.stop=function(){var a=this.playing;if(a){this.paused=this.playing=!1;var b=this.video;b.pause();b.currentTime=0}return a};Tb.prototype.pause=function(){return this.playing?(this.paused||(this.paused=!0,this.video.pause()),!0):!1};Tb.prototype.resume=function(a){if(this.paused){this.paused=!1;var b=this.video;if(void 0!==a&&0.01<Math.abs(b.currentTime-a))try{b.currentTime=a}catch(c){}b.play();return!0}return!1};
Tb.prototype.rewind=function(){return this.playing?(this.video.currentTime=0,!0):!1};Tb.prototype.destroy=function(){this.stop();this.video&&(this.elementAdded&&(this.elementAdded=!1,TurbulenzEngine.canvas.parentElement.removeChild(this.video)),this.video=null)};Tb.create=function(a){var b=new Tb,c=a.onload,d=a.looping,f=a.src,a=navigator.userAgent.toLowerCase(),g=document.createElement("video");g.preload="auto";g.autobuffer=!0;g.muted=!0;d?void 0!==g.loop&&!a.match(/firefox/)?g.loop=!0:g.onended=
function(){g.src=f;g.play()}:g.onended=function(){b.playing=!1};b.video=g;b.src=f;b.playing=!1;b.paused=!1;a.match(/safari/)&&!a.match(/chrome/)&&(g.setAttribute("style","visibility: hidden;"),TurbulenzEngine.canvas.parentElement.appendChild(g),b.elementAdded=!0);if(void 0!==g.webkitDecodedFrameCount){var h=-1,n=0;Object.defineProperty(b,"tell",{get:function(){h!==this.video.webkitDecodedFrameCount&&(h=this.video.webkitDecodedFrameCount,n=this.video.currentTime);return n},enumerable:!0,configurable:!1})}else Object.defineProperty(b,
"tell",{get:function(){return this.video.currentTime},enumerable:!0,configurable:!1});Object.defineProperty(b,"looping",{get:function(){return d},enumerable:!0,configurable:!1});var j=function(){c&&(c(null),c=null);g.removeEventListener("error",j);g=null;b.video=null;b.playing=!1};g.addEventListener("error",j,!1);var e=function(){b.length=g.duration;b.width=g.videoWidth;b.height=g.videoHeight;c&&(c(b,200),c=null);g.removeEventListener("progress",l);g.removeEventListener("canplaythrough",e)},l=function(){0<
g.buffered.length&&g.buffered.end(0)>=g.duration&&e()};g.addEventListener("progress",l,!1);g.addEventListener("canplaythrough",e,!1);g.crossorigin="anonymous";g.src=f;return b};Tb.version=1;zd=Tb;var ue=function(){};ue.prototype.destroy=function(){var a=this.gd;if(a){var b=this.glBuffer;b&&((a=a.gl)&&a.deleteRenderbuffer(b),delete this.glBuffer);delete this.gd}};ue.create=function(a,b){var c=new ue,d=b.width,f=b.height,g=b.format;"string"===typeof g&&(g=a["PIXELFORMAT_"+g]);if(g!==a.PIXELFORMAT_D24S8&&
g!==a.PIXELFORMAT_D16)return null;var h=a.gl,n=h.createRenderbuffer();h.bindRenderbuffer(h.RENDERBUFFER,n);var j,e;a.PIXELFORMAT_D16===g?(j=h.DEPTH_COMPONENT16,e=h.DEPTH_ATTACHMENT):(j=h.DEPTH_STENCIL,e=h.DEPTH_STENCIL_ATTACHMENT);h.renderbufferStorage(h.RENDERBUFFER,j,d,f);c.width=h.getRenderbufferParameter(h.RENDERBUFFER,h.RENDERBUFFER_WIDTH);c.height=h.getRenderbufferParameter(h.RENDERBUFFER,h.RENDERBUFFER_HEIGHT);h.bindRenderbuffer(h.RENDERBUFFER,null);if(c.width<d||c.height<f)return h.deleteRenderbuffer(n),
null;c.gd=a;c.format=g;c.glDepthAttachment=e;c.glBuffer=n;c.id=++a.counters.renderBuffers;return c};ue.version=1;var Ub=function(){};Ub.prototype.copyBox=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3]};Ub.prototype.bind=function(){var a=this.gd,b=a.gl;this.colorTexture0&&(a.unbindTexture(this.colorTexture0.glTexture),this.colorTexture1&&(a.unbindTexture(this.colorTexture1.glTexture),this.colorTexture2&&(a.unbindTexture(this.colorTexture2.glTexture),this.colorTexture3&&a.unbindTexture(this.colorTexture3.glTexture))));
this.depthTexture&&a.unbindTexture(this.depthTexture.glTexture);b.bindFramebuffer(b.FRAMEBUFFER,this.glObject);(b=a.drawBuffersExtension)&&(a.WEBGL_draw_buffers?b.drawBuffersWEBGL(this.buffers):b.drawBuffersEXT(this.buffers));b=a.state;this.copyBox(this.oldViewportBox,b.viewportBox);this.copyBox(this.oldScissorBox,b.scissorBox);a.setViewport(0,0,this.width,this.height);a.setScissor(0,0,this.width,this.height);return!0};Ub.prototype.unbind=function(){var a=this.gd,b=a.gl;b.bindFramebuffer(b.FRAMEBUFFER,
null);var c=a.drawBuffersExtension;c&&(b=[b.BACK],a.WEBGL_draw_buffers?c.drawBuffersWEBGL(b):c.drawBuffersEXT(b));a.setViewport.apply(a,this.oldViewportBox);a.setScissor.apply(a,this.oldScissorBox);this.colorTexture0&&(this.colorTexture0.updateMipmaps(this.face),this.colorTexture1&&(this.colorTexture1.updateMipmaps(this.face),this.colorTexture2&&(this.colorTexture2.updateMipmaps(this.face),this.colorTexture3&&this.colorTexture3.updateMipmaps(this.face))));this.depthTexture&&this.depthTexture.updateMipmaps(this.face)};
Ub.prototype.destroy=function(){var a=this.gd;if(a){var b=this.glObject;b&&((a=a.gl)&&a.deleteFramebuffer(b),delete this.glObject);delete this.colorTexture0;delete this.colorTexture1;delete this.colorTexture2;delete this.colorTexture3;delete this.depthBuffer;delete this.depthTexture;delete this.gd}};Ub.create=function(a,b){var c=new Ub,d=b.colorTexture0,f=d?b.colorTexture1||null:null,g=f?b.colorTexture2||null:null,h=g?b.colorTexture3||null:null,n=b.depthBuffer||null,j=b.depthTexture||null,e=b.face,
l=a.maxSupported("RENDERTARGET_COLOR_TEXTURES");if(f&&2>l||g&&3>l||h&&4>l)return null;var m=a.gl,l=m.COLOR_ATTACHMENT0,q=m.createFramebuffer();m.bindFramebuffer(m.FRAMEBUFFER,q);var p,s;if(d){p=d.width;s=d.height;var i=d.glTexture;if(void 0===i)return TurbulenzEngine.callOnError("Color texture is not a Texture"),m.bindFramebuffer(m.FRAMEBUFFER,null),m.deleteFramebuffer(q),null;d.cubemap?m.framebufferTexture2D(m.FRAMEBUFFER,l,m.TEXTURE_CUBE_MAP_POSITIVE_X+e,i,0):m.framebufferTexture2D(m.FRAMEBUFFER,
l,m.TEXTURE_2D,i,0);f&&(i=f.glTexture,f.cubemap?m.framebufferTexture2D(m.FRAMEBUFFER,l+1,m.TEXTURE_CUBE_MAP_POSITIVE_X+e,i,0):m.framebufferTexture2D(m.FRAMEBUFFER,l+1,m.TEXTURE_2D,i,0),g&&(i=g.glTexture,f.cubemap?m.framebufferTexture2D(m.FRAMEBUFFER,l+2,m.TEXTURE_CUBE_MAP_POSITIVE_X+e,i,0):m.framebufferTexture2D(m.FRAMEBUFFER,l+2,m.TEXTURE_2D,i,0),h&&(i=h.glTexture,f.cubemap?m.framebufferTexture2D(m.FRAMEBUFFER,l+3,m.TEXTURE_CUBE_MAP_POSITIVE_X+e,i,0):m.framebufferTexture2D(m.FRAMEBUFFER,l+3,m.TEXTURE_2D,
i,0))))}else if(j)p=j.width,s=j.height;else if(n)p=n.width,s=n.height;else return TurbulenzEngine.callOnError("No RenderBuffers or Textures specified for this RenderTarget"),m.bindFramebuffer(m.FRAMEBUFFER,null),m.deleteFramebuffer(q),null;j?m.framebufferTexture2D(m.FRAMEBUFFER,j.glDepthAttachment,m.TEXTURE_2D,j.glTexture,0):n&&m.framebufferRenderbuffer(m.FRAMEBUFFER,n.glDepthAttachment,m.RENDERBUFFER,n.glBuffer);i=m.checkFramebufferStatus(m.FRAMEBUFFER);m.bindFramebuffer(m.FRAMEBUFFER,null);if(i!==
m.FRAMEBUFFER_COMPLETE)return m.deleteFramebuffer(q),null;c.gd=a;c.glObject=q;c.colorTexture0=d;c.colorTexture1=f;c.colorTexture2=g;c.colorTexture3=h;c.depthBuffer=n;c.depthTexture=j;c.width=p;c.height=s;c.face=e;a.drawBuffersExtension&&(d?(d=[l],f&&(d.push(l+1),g&&(d.push(l+2),h&&d.push(l+3)))):d=[m.NONE],c.buffers=d);c.id=++a.counters.renderTargets;return c};Ub.version=1;Ub.prototype.oldViewportBox=[];Ub.prototype.oldScissorBox=[];var vc=function(){};vc.prototype.map=function(a,b){void 0===a&&(a=
0);void 0===b&&(b=this.numIndices);var c=this.gd.gl,d=this.format,f;f=d===c.UNSIGNED_BYTE?new Uint8Array(b):d===c.UNSIGNED_SHORT?new Uint16Array(b):new Uint32Array(b);var g=0,c=function(){for(var a=arguments.length,b=0;b<a;b+=1)f[g]=arguments[b],g+=1};c.write=c;c.data=f;c.offset=a;c.getNumWrittenIndices=function(){return g};return c.write=c};vc.prototype.unmap=function(a){if(a){var b=this.gd,c=b.gl,d=a.data;delete a.data;var f=a.offset;delete a.write;if(a=a.getNumWrittenIndices())a<d.length&&(d=d.subarray(0,
a)),b.setIndexBuffer(this),a<this.numIndices?c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,f,d):c.bufferData(c.ELEMENT_ARRAY_BUFFER,d,this.usage)}};vc.prototype.setData=function(a,b,c){void 0===b&&(b=0);void 0===c&&(c=this.numIndices);var d=this.gd,f=d.gl,g,h=this.format;h===f.UNSIGNED_BYTE?g=a instanceof Uint8Array?a:new Uint8Array(a):h===f.UNSIGNED_SHORT?(g=a instanceof Uint16Array?a:new Uint16Array(a),b*=2):h===f.UNSIGNED_INT&&(g=a instanceof Uint32Array?a:new Uint32Array(a),b*=4);c<g.length&&(g=g.subarray(0,
c));d.setIndexBuffer(this);c<this.numIndices?f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,b,g):f.bufferData(f.ELEMENT_ARRAY_BUFFER,g,this.usage)};vc.prototype.destroy=function(){var a=this.gd;if(a){var b=this.glBuffer;if(b){var c=a.gl;c&&(a.unsetIndexBuffer(this),c.deleteBuffer(b));delete this.glBuffer}delete this.gd}};vc.create=function(a,b){var c=a.gl,d=new vc;d.gd=a;var f=b.numIndices;d.numIndices=f;var g=b.format;"string"===typeof g&&(g=a["INDEXFORMAT_"+g]);d.format=g;g=g===c.UNSIGNED_BYTE?1:g===c.UNSIGNED_SHORT?
2:4;d.stride=g;d["transient"]=b["transient"]||!1;d.dynamic=b.dynamic||d["transient"];d.usage=d["transient"]?c.STREAM_DRAW:d.dynamic?c.DYNAMIC_DRAW:c.STATIC_DRAW;d.glBuffer=c.createBuffer();b.data?d.setData(b.data,0,f):(a.setIndexBuffer(d),c.bufferData(c.ELEMENT_ARRAY_BUFFER,f*g,d.usage));d.id=++a.counters.indexBuffers;return d};vc.version=1;var ve=function(){};ve.create=function(a,b){var c=new ve,d=b.length;c.length=d;for(var f=0;f<d;f+=1){var g=b[f];c[f]="string"===typeof g?a["SEMANTIC_"+g]:g}return c};
ve.version=1;var Db=function(){};Db.prototype.map=function(a,b){void 0===a&&(a=0);void 0===b&&(b=this.numVertices);var c=this.gd.gl,d=this.stride,f=this.attributes,g=f.length,h,n=0;if(this.hasSingleFormat){var j=b*d,e=f[0].format;e===c.FLOAT?h=new Float32Array(j):e===c.BYTE?h=new Int8Array(j):e===c.UNSIGNED_BYTE?h=new Uint8Array(j):e===c.SHORT?h=new Int16Array(j):e===c.UNSIGNED_SHORT?h=new Uint16Array(j):e===c.INT?h=new Int32Array(j):e===c.UNSIGNED_INT&&(h=new Uint32Array(j));c=function(){for(var a=
arguments.length,b=0,c=0;c<g;c+=1){var d=f[c],j=d.numComponents,e=0;do if(b<a){var r=arguments[b],b=b+1;if("number"===typeof r)d.normalized&&(r*=d.normalizationScale),h[n]=r,n+=1,e+=1;else if(0===e){var l=r.length;l>j&&(l=j);if(d.normalized)for(var m=d.normalizationScale,d=0;d<l;d+=1)h[n]=r[d]*m,n+=1,e+=1;else for(d=0;d<l;d+=1)h[n]=r[d],n+=1,e+=1;for(;e<j;)n+=1,e+=1;break}else return TurbulenzEngine.callOnError("Missing values for attribute "+c),null}else n+=1,e+=1;while(e<j)}}}else{var l=0;h=new ArrayBuffer(b*
this.strideInBytes);if("undefined"!==typeof DataView&&"setFloat32"in DataView.prototype)var m=new DataView(h),c=function(){for(var a=arguments.length,b=0,c=0;c<g;c+=1){var d=f[c],h=d.numComponents,j=d.typedSetter,e=d.componentStride,r=0;do if(b<a){var i=arguments[b],b=b+1;if("number"===typeof i)d.normalized&&(i*=d.normalizationScale),j.call(m,l,i,!0),l+=e,r+=1,n+=1;else if(0===r){var k=i.length;k>h&&(k=h);if(d.normalized)for(var J=d.normalizationScale,d=0;d<k;d+=1)j.call(m,l,i[d]*J,!0),l+=e,r+=1,
n+=1;else for(d=0;d<k;d+=1)j.call(m,l,i[d],!0),l+=e,r+=1,n+=1;for(;r<h;)n+=1,r+=1;break}else return TurbulenzEngine.callOnError("Missing values for attribute "+c),null}else n+=1,r+=1;while(r<h)}};else c=function(){for(var a=arguments.length,b=0,c,d=0;d<g;d+=1){var j=f[d],e=j.numComponents;c=new j.typedArray(h,l,e);l+=j.stride;var r=0;do if(b<a){var m=arguments[b],b=b+1;if("number"===typeof m)j.normalized&&(m*=j.normalizationScale),c[r]=m,r+=1,n+=1;else if(0===r){var i=m.length;i>e&&(i=e);if(j.normalized)for(var k=
j.normalizationScale,j=0;j<i;j+=1)c[r]=m[j]*k,r+=1,n+=1;else for(j=0;j<i;j+=1)c[r]=m[j],r+=1,n+=1;for(;r<e;)r+=1,n+=1;break}else return TurbulenzEngine.callOnError("Missing values for attribute "+d),null}else r+=1,n+=1;while(r<e)}}}c.data=h;c.offset=a;c.getNumWrittenVertices=function(){return Math.floor(n/d)};c.getNumWrittenValues=function(){return n};return c.write=c};Db.prototype.unmap=function(a){if(a){var b=a.data;delete a.data;delete a.write;var c=a.getNumWrittenVertices();if(c){var d=a.offset,
f=this.strideInBytes;this.hasSingleFormat?(a=a.getNumWrittenValues(),a<b.length&&(b=b.subarray(0,a))):(a=c*f,a<b.byteLength&&(b=b.slice(0,a)));var a=this.gd,g=a.gl;a.bindVertexBuffer(this.glBuffer);c<this.numVertices?g.bufferSubData(g.ARRAY_BUFFER,d*f,b):g.bufferData(g.ARRAY_BUFFER,b,this.usage)}}};Db.prototype.setData=function(a,b,c){void 0===b&&(b=0);void 0===c&&(c=this.numVertices);var d=this.gd,f=d.gl,g=this.strideInBytes;if(a.constructor===ArrayBuffer)d.bindVertexBuffer(this.glBuffer),c<this.numVertices?
f.bufferSubData(f.ARRAY_BUFFER,b*g,a):f.bufferData(f.ARRAY_BUFFER,a,this.usage);else{var h=this.attributes,n=this.numAttributes,j,e;if(this.hasSingleFormat)j=h[0],h=j.format,h===f.FLOAT?a instanceof Float32Array||(e=Float32Array):h===f.BYTE?a instanceof Int8Array||(e=Int8Array):h===f.UNSIGNED_BYTE?a instanceof Uint8Array||(e=Uint8Array):h===f.SHORT?a instanceof Int16Array||(e=Int16Array):h===f.UNSIGNED_SHORT?a instanceof Uint16Array||(e=Uint16Array):h===f.INT?a instanceof Int32Array||(e=Int32Array):
h===f.UNSIGNED_INT&&(a instanceof Uint32Array||(e=Uint32Array)),h=c*this.stride,e?(j.normalized&&(a=this.scaleValues(a,j.normalizationScale,h)),e=new e(a),h<e.length&&(e=e.subarray(0,h))):e=a,h<a.length&&(e=e.subarray(0,h));else{e=new ArrayBuffer(c*g);var l=0,m=0,q,p,s,i,u;if("undefined"!==typeof DataView&&"setFloat32"in DataView.prototype){var k=new DataView(e);for(q=0;q<c;q+=1)for(p=0;p<n;p+=1){j=h[p];s=j.numComponents;i=j.componentStride;var B=j.typedSetter;if(j.normalized){u=j.normalizationScale;
for(j=0;j<s;j+=1)B.call(k,m,a[l]*u,!0),m+=i,l+=1}else for(j=0;j<s;j+=1)B.call(k,m,a[l],!0),m+=i,l+=1}}else for(q=0;q<c;q+=1)for(p=0;p<n;p+=1)if(j=h[p],s=j.numComponents,i=new j.typedArray(e,m,s),m+=j.stride,j.normalized){u=j.normalizationScale;for(j=0;j<s;j+=1)i[j]=a[l]*u,l+=1}else for(j=0;j<s;j+=1)i[j]=a[l],l+=1}d.bindVertexBuffer(this.glBuffer);c<this.numVertices?f.bufferSubData(f.ARRAY_BUFFER,b*g,e):f.bufferData(f.ARRAY_BUFFER,e,this.usage)}};Db.prototype.scaleValues=function(a,b,c){void 0===c&&
(c=a.length);for(var d=new a.constructor(c),f=0;f<c;f+=1)d[f]=a[f]*b;return d};Db.prototype.bindAttributes=function(a,b,c){for(var d=this.gd.gl,f=this.attributes,g=this.strideInBytes,h=0,n=0;n<a;n+=1){var j=f[n],e=b[n],h=h|1<<e;d.vertexAttribPointer(e,j.numComponents,j.format,j.normalized,g,c);c+=j.stride}return h};Db.prototype.setAttributes=function(a){var b=this.gd,c=a.length;this.numAttributes=c;this.attributes=[];for(var d=0,f=0,g=!0,h=0;h<c;h+=1){var n=a[h];"string"===typeof n&&(n=b["VERTEXFORMAT_"+
n]);this.attributes[h]=n;d+=n.stride;f+=n.numComponents;g&&h&&n.format!==this.attributes[h-1].format&&(g=!1)}this.strideInBytes=d;this.stride=f;this.hasSingleFormat=g;return d};Db.prototype.resize=function(a){if(a!==this.strideInBytes*this.numVertices){var b=this.gd,c=b.gl;b.bindVertexBuffer(this.glBuffer);b=c.ARRAY_BUFFER;c.bufferData(b,a,this.usage);a=c.getBufferParameter(b,c.BUFFER_SIZE);this.numVertices=Math.floor(a/this.strideInBytes)}};Db.prototype.destroy=function(){var a=this.gd;if(a){var b=
this.glBuffer;if(b){var c=a.gl;c&&(a.unbindVertexBuffer(b),c.deleteBuffer(b));delete this.glBuffer}delete this.gd}};Db.create=function(a,b){var c=a.gl,d=new Db;d.gd=a;var f=b.numVertices;d.numVertices=f;var g=d.setAttributes(b.attributes);d["transient"]=b["transient"]||!1;d.dynamic=b.dynamic||d["transient"];d.usage=d["transient"]?c.STREAM_DRAW:d.dynamic?c.DYNAMIC_DRAW:c.STATIC_DRAW;d.glBuffer=c.createBuffer();g*=f;b.data?d.setData(b.data,0,f):(a.bindVertexBuffer(d.glBuffer),c.bufferData(c.ARRAY_BUFFER,
g,d.usage));d.id=++a.counters.vertexBuffers;return d};Db.version=1;var Rc=function(){};Rc.prototype.updateParametersData=function(a){var b=a.gl;this.dirty=!1;var c=this.parameters,d;for(d in c)if(c.hasOwnProperty(d)){var f=c[d];if(f.dirty){f.dirty=0;var g=f.info,h=f.location;if(g&&null!==h){var n=g.values;"float"===g.type?(f=g.columns,4===f?b.uniform4fv(h,n):3===f?b.uniform3fv(h,n):2===f?b.uniform2fv(h,n):1===g.rows?b.uniform1f(h,n[0]):b.uniform1fv(h,n)):void 0!==g.sampler?a.setTexture(f.textureUnit,
n,g.sampler):(f=g.columns,4===f?b.uniform4iv(h,n):3===f?b.uniform3iv(h,n):2===f?b.uniform2iv(h,n):1===g.rows?b.uniform1i(h,n[0]):b.uniform1iv(h,n))}}}};Rc.prototype.initializeParameters=function(a){var b=a.gl,c=this.glProgram;a.setProgram(c);var a=this.parameters,d;for(d in a)if(a.hasOwnProperty(d)){var f=a[d],g=f.info;if(g){var h=b.getUniformLocation(c,d);if(null!==h)if(f.location=h,g.sampler)b.uniform1i(h,f.textureUnit);else{var f=g.values,n;"float"===g.type?(n=g.columns,4===n?b.uniform4fv(h,f):
3===n?b.uniform3fv(h,f):2===n?b.uniform2fv(h,f):1===g.rows?b.uniform1f(h,f[0]):b.uniform1fv(h,f)):(n=g.columns,4===n?b.uniform4iv(h,f):3===n?b.uniform3iv(h,f):2===n?b.uniform2iv(h,f):1===g.rows?b.uniform1i(h,f[0]):b.uniform1iv(h,f))}}}};Rc.prototype.destroy=function(){delete this.glProgram;delete this.semanticsMask;delete this.parameters;delete this.states;delete this.statesSet};Rc.create=function(a,b,c){var d=a.gl,f=new Rc;f.name=c.name||null;var g=b.programs,h=b.parameters,n=c.parameters,j=c.programs,
e=c.semantics,c=c.states,l=j.join(":"),m=b.linkedPrograms[l],q,p;if(void 0===m){q=d.createProgram();p=j.length;for(m=0;m<p;m+=1){var s=g[j[m]];s&&d.attachShader(q,s)}g=e.length;for(p=m=0;p<g;p+=1)j=a["SEMANTIC_"+e[p]],void 0!==j&&(m|=1<<j,d.bindAttribLocation(q,j,"ATTR"+j));d.linkProgram(q);b.linkedPrograms[l]={glProgram:q,semanticsMask:m}}else q=m.glProgram,m=m.semanticsMask;f.glProgram=q;f.semanticsMask=m;b=0;d={};f.parameters=d;e=n?n.length:0;for(m=0;m<e;m+=1)if(q=n[m],l={},d[q]=l,q=h[q],l.info=
q)l.location=null,q.sampler?(l.textureUnit=b,b+=1):l.textureUnit=void 0;f.numTextureUnits=b;f.numParameters=e;a=a.stateHandlers;h=[];n={};f.states=h;f.statesSet=n;for(p in c)if(c.hasOwnProperty(p)&&(m=a[p]))if(b=m.parse(c[p]),null!==b){a:{d=m.defaultValues;e=d.length;l=void 0;for(l=0;l<e;l+=1)if(d[l]!==b[l]){d=!1;break a}d=!0}d||(h.push({name:p,set:m.set,reset:m.reset,values:b}),n[p]=!0)}else TurbulenzEngine.callOnError("Unknown value for state "+p+": "+c[p]);return f};Rc.version=1;var Ib=function(){};
Ib.prototype.getPass=function(a){var b=this.passes,c=b.length;if("string"===typeof a)for(var d=0;d<c;d+=1){var f=b[d];if(f.name===a)return f}else if(a|=0,a<c)return b[a];return null};Ib.prototype.activate=function(a){this.device=a;this.initialized||(this.shader.initialize(a),this.initialize(a))};Ib.prototype.deactivate=function(){this.device=null};Ib.prototype.checkProperties=function(a){var b={},c;for(c in this)"version"!==c&&("name"!==c&&"id"!==c&&"passes"!==c&&"numPasses"!==c&&"device"!==c&&"numParameters"!==
c)&&(b[c]=this[c]);if(b){var d=this.passes;1===d.length?a.setParametersImmediate(d[0].parameters,b):a.setParametersDeferred(a,d,b);for(c in b)b.hasOwnProperty(c)&&delete this[c]}};Ib.prototype.initialize=function(a){if(!this.initialized){var b=this.passes;if(b){var c=b.length,d;for(d=0;d<c;d+=1)b[d].initializeParameters(a)}Object.defineProperty&&this.initializeParametersSetters(a);this.initialized=!0}};Ib.prototype.initializeParametersSetters=function(a){function b(b,c){return function(d){this.device?
a.setTexture(c.textureUnit,d,c.info.sampler):(b.dirty=!0,c.dirty=1,c.info.values=d)}}function c(a,b){function c(f){if("number"!==typeof f){for(var g=d.values,h=Math.min(d.numValues,f.length),n=0;n<h;n+=1)g[n]=f[n];b.dirty=Math.max(h,b.dirty||0)}else d.values[0]=f,b.dirty=b.dirty||1;a.dirty=!0}var d=b.info,g=b.location;switch(d.columns){case 1:return 1===d.numValues?function(a){this.device?f.uniform1f(g,a):c(a)}:function(a){this.device?f.uniform1fv(g,a):c(a)};case 2:return function(a){this.device?
f.uniform2fv(g,a):c(a)};case 3:return function(a){this.device?f.uniform3fv(g,a):c(a)};case 4:return function(a){this.device?f.uniform4fv(g,a):c(a)};default:return null}}function d(a,b){function c(f){if("number"!==typeof f){for(var g=d.values,h=Math.min(d.numValues,f.length),n=0;n<h;n+=1)g[n]=f[n];b.dirty=Math.max(h,b.dirty||0)}else d.values[0]=f,b.dirty=b.dirty||1;a.dirty=!0}var d=b.info,g=b.location;switch(d.columns){case 1:return 1===d.numValues?function(a){this.device?f.uniform1i(g,a):c(a)}:function(a){this.device?
f.uniform1iv(g,a):c(a)};case 2:return function(a){this.device?f.uniform2iv(g,a):c(a)};case 3:return function(a){this.device?f.uniform3iv(g,a):c(a)};case 4:return function(a){this.device?f.uniform4iv(g,a):c(a)};default:return null}}var f=a.gl,g=this.passes,h,n,j,e;if(1===g.length){g=g[0];h=g.parameters;for(n in h)if(h.hasOwnProperty(n)&&(j=h[n],(e=j.info)&&void 0!==j.location))j=e.sampler?b(g,j):"float"===e.type?c(g,j):d(g,j),Object.defineProperty(this,n,{set:j,enumerable:!1,configurable:!1});this.checkProperties=
null}else Object.defineProperty(this,"device",{writable:!0,enumerable:!1,configurable:!1}),Object.defineProperty(this,"version",{writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(this,"name",{writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(this,"id",{writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(this,"passes",{writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(this,"numParameters",{writable:!1,enumerable:!1,configurable:!1})};Ib.prototype.destroy=
function(){var a=this.passes;if(a){var b=a.length,c;for(c=0;c<b;c+=1)a[c].destroy();a.length=0;delete this.passes}delete this.device};Ib.create=function(a,b,c,d){var f=new Ib;f.initialized=!1;f.shader=b;f.name=c;var c=d.length,g,h=0;f.passes=[];f.numPasses=c;for(g=0;g<c;g+=1){var n=d[g];n.parameters&&(h+=n.parameters.length);f.passes[g]=Rc.create(a,b,n)}f.numParameters=h;f.device=null;f.id=++a.counters.techniques;1<c&&a.drawArray!==a.drawArrayMultiPass&&(a.drawArray=a.drawArrayMultiPass);return f};
Ib.version=1;var wc=function(){};wc.prototype.getTechnique=function(a){if("string"===typeof a)return this.techniques[a];var b=this.techniques,c;for(c in b)if(b.hasOwnProperty(c)){if(0===a)return b[c];a-=1}return null};wc.prototype.getParameter=function(a){if("string"===typeof a)return this.parameters[a];var a=a|0,b=this.parameters,c;for(c in b)if(b.hasOwnProperty(c)){if(0===a)return b[c];a-=1}return null};wc.prototype.initialize=function(a){if(!this.initialized){var a=a.gl,b,c=this.programs;for(b in c)if(c.hasOwnProperty(b)){var d=
c[b];a.getShaderParameter(d,a.COMPILE_STATUS)||(d=a.getShaderInfoLog(d),TurbulenzEngine.callOnError('Program "'+b+'" failed to compile: '+d))}c=this.linkedPrograms;for(b in c)if(c.hasOwnProperty(b)&&(d=c[b].glProgram)&&!a.getProgramParameter(d,a.LINK_STATUS))d=a.getProgramInfoLog(d),TurbulenzEngine.callOnError('Program "'+b+'" failed to link: '+d);this.initialized=!0}};wc.prototype.destroy=function(){var a=this.gd;if(a){var a=a.gl,b,c=this.techniques;if(c){for(b in c)c.hasOwnProperty(b)&&c[b].destroy();
delete this.techniques}if(c=this.linkedPrograms){if(a)for(b in c)if(c.hasOwnProperty(b)){var d=c[b],f=d.glProgram;f&&(a.deleteProgram(f),delete d.glProgram)}delete this.linkedPrograms}if(c=this.programs){if(a)for(b in c)c.hasOwnProperty(b)&&a.deleteShader(c[b]);delete this.programs}delete this.samplers;delete this.parameters;delete this.gd}};wc.create=function(a,b){var c=a.gl,d=new wc;d.initialized=!1;var f=b.techniques,g=b.parameters,h=b.programs,n=b.samplers,j;d.gd=a;d.name=b.name;var e={};d.programs=
e;for(j in h)if(h.hasOwnProperty(j)){var l=h[j],m;"fragment"===l.type?m=c.FRAGMENT_SHADER:"vertex"===l.type&&(m=c.VERTEX_SHADER);var q=c.createShader(m);c.shaderSource(q,l.code);c.compileShader(q);e[j]=q}d.linkedPrograms={};h=a.DEFAULT_SAMPLER;l=a.maxAnisotropy;d.samplers={};for(j in n)n.hasOwnProperty(j)&&(e=n[j],(m=e.MaxAnisotropy)?m>l&&(m=l):m=h.maxAnisotropy,e={minFilter:e.MinFilter||h.minFilter,magFilter:e.MagFilter||h.magFilter,wrapS:e.WrapS||h.wrapS,wrapT:e.WrapT||h.wrapT,wrapR:e.WrapR||h.wrapR,
maxAnisotropy:m},10496===e.wrapS&&(e.wrapS=c.CLAMP_TO_EDGE),10496===e.wrapT&&(e.wrapT=c.CLAMP_TO_EDGE),10496===e.wrapR&&(e.wrapR=c.CLAMP_TO_EDGE),d.samplers[j]=a.createSampler(e));c=0;d.parameters={};for(j in g)g.hasOwnProperty(j)&&(n=g[j],n.columns||(n.columns=1),n.rows||(n.rows=1),n.numValues=n.columns*n.rows,e=n.type,"float"===e||"int"===e||"bool"===e?(l=n.values,n.values=l?"float"===e?new Float32Array(l):new Int32Array(l):"float"===e?new Float32Array(n.numValues):new Int32Array(n.numValues),n.sampler=
void 0):(e=d.samplers[j],e||(e=h,d.samplers[j]=h),n.sampler=e,n.values=null),n.name=j,d.parameters[j]=n,c+=1);d.numParameters=c;g={};c=0;d.techniques=g;for(j in f)f.hasOwnProperty(j)&&(g[j]=Ib.create(a,d,j,f[j]),c+=1);d.numTechniques=c;d.id=++a.counters.shaders;return d};wc.version=1;var ti=function(){};ti.create=function(a){var b=new ti;if(a)for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b};var mb=function(){this.endStreams=0;this.endTechniqueParameters=48;this.endInstances=56;this.sortKey=
this.count=this.firstIndex=0;this.indexBuffer=this.technique=null;this.primitive=-1;this.userData=null;this[0]=null;this[1]=null;this[2]=0;this[48]=null;this[49]=null;return this};mb.prototype.setTechniqueParameters=function(a,b){if(8>a){a+=48;this[a]=b;var c=this.endTechniqueParameters;if(b)c<=a&&(this.endTechniqueParameters=a+1);else{for(;48<c&&!this[c-1];)c-=1;this.endTechniqueParameters=c}}};mb.prototype.setVertexBuffer=function(a,b){if(16>a){a*=3;this[a]=b;var c=this.endStreams;if(b)c<=a&&(this.endStreams=
a+3);else{for(;0<c&&!this[c-3];)c-=3;this.endStreams=c}}};mb.prototype.setSemantics=function(a,b){16>a&&(this[3*a+1]=b)};mb.prototype.setOffset=function(a,b){16>a&&(this[3*a+2]=b)};mb.prototype.getTechniqueParameters=function(a){if(8>a)return this[a+48]};mb.prototype.getVertexBuffer=function(a){if(16>a)return this[3*a+0]};mb.prototype.getSemantics=function(a){if(16>a)return this[3*a+1]};mb.prototype.getOffset=function(a){if(16>a)return this[3*a+2]};mb.prototype.addInstance=function(a){if(a){var b=
this.endInstances;this.endInstances=b+1;this[b]=a}};mb.prototype.removeInstances=function(){this.endInstances=56};mb.prototype.getNumInstances=function(){return this.endInstances-56};mb.create=function(){return new mb};mb.version=1;var S=function(){};S.prototype.drawIndexed=function(a,b,c){var d=this.gl,f=this.activeIndexBuffer,c=c?c*f.stride:0,f=f.format,g=this.attributeMask,h=this.activeTechnique,n=h.passes,j=n.length;h.checkProperties&&h.checkProperties(this);if(1===j)h=n[0].semanticsMask&g,h!==
this.clientStateMask&&this.enableClientState(h),d.drawElements(a,b,f,c);else for(var e=0;e<j;e+=1){var l=n[e],h=l.semanticsMask&g;h!==this.clientStateMask&&this.enableClientState(h);this.setPass(l);d.drawElements(a,b,f,c)}};S.prototype.draw=function(a,b,c){var d=this.gl,f=this.attributeMask,g=this.activeTechnique,h=g.passes,n=h.length;g.checkProperties&&g.checkProperties(this);if(1===n)g=h[0].semanticsMask&f,g!==this.clientStateMask&&this.enableClientState(g),d.drawArrays(a,c,b);else for(var j=0;j<
n;j+=1){var e=h[j],g=e.semanticsMask&f;g!==this.clientStateMask&&this.enableClientState(g);this.setPass(e);d.drawArrays(a,c,b)}};S.prototype.setTechniqueParameters=function(){var a=this.activeTechnique.passes,b=arguments.length;if(1===a.length)for(var a=a[0].parameters,c=0;c<b;c+=1)this.setParametersImmediate(a,arguments[c]);else for(c=0;c<b;c+=1)this.setParametersDeferred(this,a,arguments[c])};S.prototype.setParametersImmediate=function(a,b){var c=this.gl,d;for(d in b){var f=a[d];if(void 0!==f){var g=
b[d];if(void 0!==g){var h=f.info,n;"float"===h.type?(n=h.columns,f=f.location,4===n?c.uniform4fv(f,g):3===n?c.uniform3fv(f,g):2===n?c.uniform2fv(f,g):1===h.rows?c.uniform1f(f,g):c.uniform1fv(f,g)):void 0!==h.sampler?this.setTexture(f.textureUnit,g,h.sampler):(n=h.columns,f=f.location,4===n?c.uniform4iv(f,g):3===n?c.uniform3iv(f,g):2===n?c.uniform2iv(f,g):1===h.rows?c.uniform1i(f,g):c.uniform1iv(f,g))}else delete b[d]}}};S.prototype.setParametersCaching=function(a,b){var c=this.gl,d;for(d in b){var f=
a[d];if(void 0!==f){var g=b[d];if(f.value!==g)if(void 0!==g){f.value=g;var h=f.info,n;"float"===h.type?(n=h.columns,f=f.location,4===n?c.uniform4fv(f,g):3===n?c.uniform3fv(f,g):2===n?c.uniform2fv(f,g):1===h.rows?c.uniform1f(f,g):c.uniform1fv(f,g)):void 0!==h.sampler?this.setTexture(f.textureUnit,g,h.sampler):(n=h.columns,f=f.location,4===n?c.uniform4iv(f,g):3===n?c.uniform3iv(f,g):2===n?c.uniform2iv(f,g):1===h.rows?c.uniform1i(f,g):c.uniform1iv(f,g))}else delete b[d]}}};S.prototype.setParametersCachingMultiPass=
function(a,b,c){a.setParametersCaching(b[0].parameters,c)};S.prototype.setParametersDeferred=function(a,b,c){for(var a=b.length,d=Math.min,f=Math.max,g=0;g<a;g+=1){var h=b[g],n=h.parameters;h.dirty=!0;for(var j in c)if(h=n[j]){var e=c[j];if(void 0!==e){var l=h.info;if(l.sampler)l.values=e,h.dirty=1;else if("number"!==typeof e){for(var m=l.values,l=d(l.numValues,e.length),q=0;q<l;q+=1)m[q]=e[q];h.dirty=f(l,h.dirty||0)}else l.values[0]=e,h.dirty=h.dirty||1}else delete c[j]}}};S.prototype.setTechnique=
function(a){var b=this.activeTechnique;b!==a&&(b&&b.deactivate(),this.activeTechnique=a,a.activate(this),a=a.passes,1===a.length&&this.setPass(a[0]))};S.prototype.setTechniqueCaching=function(a){var b=a.passes[0],c=this.activeTechnique;c!==a&&(c&&c.deactivate(),this.activeTechnique=a,a.activate(this),this.setPass(b));var a=b.parameters,d;for(d in a)a.hasOwnProperty(d)&&(a[d].value=null)};S.prototype.setStream=function(a,b,c){c=c?c*a.strideInBytes:0;this.bindVertexBuffer(a.glBuffer);var d=b.length;
d>a.numAttributes&&(d=a.numAttributes);this.attributeMask|=a.bindAttributes(d,b,c)};S.prototype.setIndexBuffer=function(a){if(this.activeIndexBuffer!==a){this.activeIndexBuffer=a;var b=this.gl;b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,a?a.glBuffer:null)}};S.prototype.drawArray=function(a,b,c){var d=this.gl,f=d.ELEMENT_ARRAY_BUFFER,g=b.length,h=a.length;1<h&&c&&(0<c?a.sort(this._drawArraySortPositive):a.sort(this._drawArraySortNegative));var c=this.activeIndexBuffer,n=this.attributeMask,j=null,e=-1,l=null,
m=null,q=0,m=!1,p=m=null,s=null,i=0,u=0,k=m=0;c&&(i=c.format,u=c.stride);for(var B=0;B<h;B+=1){var y=a[B],k=y.technique,q=y.endTechniqueParameters,v=y.endStreams,x=y.endInstances,J=y.indexBuffer,C=y.primitive,ka=y.count,Q=y.firstIndex;if(j!==k){j=k;this.setTechniqueCaching(k);p=k.passes[0];s=p.parameters;m=p.semanticsMask&n;m!==this.clientStateMask&&this.enableClientState(m);k.checkProperties&&k.checkProperties(this);for(k=0;k<g;k+=1)this.setParametersCaching(s,b[k])}for(k=48;k<q;k+=1)(m=y[k])&&this.setParametersCaching(s,
m);m=e===v;for(q=0;m&&q<v;q+=3)m=l[q]===y[q]&&l[q+1]===y[q+1]&&l[q+2]===y[q+2];if(!m){e=v;for(q=0;q<v;q+=3)(m=y[q])&&this.setStream(m,y[q+1],y[q+2]);n=this.attributeMask;m=p.semanticsMask&n;m!==this.clientStateMask&&this.enableClientState(m)}l=y;if(J)if(c!==J&&(c=J,d.bindBuffer(f,J.glBuffer),i=J.format,u=J.stride),Q*=u,k=56,k<x){do this.setParametersCaching(s,y[k]),d.drawElements(C,ka,i,Q),k+=1;while(k<x)}else d.drawElements(C,ka,i,Q);else if(k=56,k<x){do this.setParametersCaching(s,y[k]),d.drawArrays(C,
Q,ka),k+=1;while(k<x)}else d.drawArrays(C,Q,ka)}this.activeIndexBuffer=c};S.prototype.drawArrayMultiPass=function(a,b,c){var d=this.gl,f=d.ELEMENT_ARRAY_BUFFER,g=this.setParametersCachingMultiPass,h=this.setParametersDeferred,n=b.length,j=a.length;1<j&&c&&(0<c?a.sort(this._drawArraySortPositive):a.sort(this._drawArraySortNegative));var c=this.activeIndexBuffer,e=this.attributeMask,l=null,m=null,q=-1,p=null,s=null,s=0,i=!1,u=i=null,k=null,B=null,y=0,v=0,x=0,i=s=0;c&&(y=c.format,v=c.stride);for(var J=
0;J<j;J+=1){var C=a[J],i=C.technique,ka=C.endTechniqueParameters,k=C.endStreams,Q=C.endInstances,B=C.indexBuffer,t=C.primitive,w=C.count,K=C.firstIndex;if(m!==i){m=i;u=i.passes;x=u.length;1===x?(this.setTechniqueCaching(i),l=g,s=u[0].semanticsMask&e,s!==this.clientStateMask&&this.enableClientState(s)):(this.setTechnique(i),l=h);i.checkProperties&&i.checkProperties(this);for(i=0;i<n;i+=1)l(this,u,b[i])}for(i=48;i<ka;i+=1)(s=C[i])&&l(this,u,s);i=q===k;for(s=0;i&&s<k;s+=3)i=p[s]===C[s]&&p[s+1]===C[s+
1]&&p[s+2]===C[s+2];if(!i){q=k;for(s=0;s<k;s+=3)(i=C[s])&&this.setStream(i,C[s+1],C[s+2]);e=this.attributeMask;1===x&&(s=u[0].semanticsMask&e,s!==this.clientStateMask&&this.enableClientState(s))}p=C;if(B)if(c!==B&&(c=B,d.bindBuffer(f,B.glBuffer),y=B.format,v=B.stride),K*=v,1===x)if(i=56,i<Q){do l(this,u,C[i]),d.drawElements(t,w,y,K),i+=1;while(i<Q)}else d.drawElements(t,w,y,K);else if(i=56,i<Q){do{l(this,u,C[i]);for(k=0;k<x;k+=1)B=u[k],s=B.semanticsMask&e,s!==this.clientStateMask&&this.enableClientState(s),
this.setPass(B),d.drawElements(t,w,y,K);i+=1}while(i<Q)}else for(k=0;k<x;k+=1)B=u[k],s=B.semanticsMask&e,s!==this.clientStateMask&&this.enableClientState(s),this.setPass(B),d.drawElements(t,w,y,K);else if(1===x)if(i=56,i<Q){do l(this,u,C[i]),d.drawArrays(t,K,w),i+=1;while(i<Q)}else d.drawArrays(t,K,w);else if(i=56,i<Q){do{l(this,u,C[i]);for(k=0;k<x;k+=1)B=u[k],s=B.semanticsMask&e,s!==this.clientStateMask&&this.enableClientState(s),this.setPass(B),d.drawArrays(t,K,w);i+=1}while(i<Q)}else for(k=0;k<
x;k+=1)B=u[k],s=B.semanticsMask&e,s!==this.clientStateMask&&this.enableClientState(s),this.setPass(B),d.drawArrays(t,K,w)}this.activeIndexBuffer=c};S.prototype.beginDraw=function(a,b,c,d){this.immediatePrimitive=a;if(b){var f=this.immediateSemantics,g=d.length;f.length=g;for(a=0;a<g;a+=1){var h=d[a];"string"===typeof h&&(h=this["SEMANTIC_"+h]);f[a]=h}d=this.immediateVertexBuffer;f=d.strideInBytes;a=f*d.numVertices;c=d.setAttributes(c);c!==f&&(d.numVertices=Math.floor(a/c));c*=b;c>a&&d.resize(c);return d.map(0,
b)}return null};S.prototype.endDraw=function(a){var b=this.immediateVertexBuffer,c=a.getNumWrittenVertices();b.unmap(a);if(c){for(var a=this.gl,d=b.strideInBytes,f=0,b=b.attributes,g=this.immediateSemantics,h=g.length,n=0,j=0;j<h;j+=1){var e=b[j],l=g[j],n=n|1<<l;a.vertexAttribPointer(l,e.numComponents,e.format,e.normalized,d,f);f+=e.stride}this.attributeMask|=n;this.draw(this.immediatePrimitive,c,0)}};S.prototype.setViewport=function(a,b,c,d){var f=this.state.viewportBox;if(f[0]!==a||f[1]!==b||f[2]!==
c||f[3]!==d)f[0]=a,f[1]=b,f[2]=c,f[3]=d,this.gl.viewport(a,b,c,d)};S.prototype.setScissor=function(a,b,c,d){var f=this.state.scissorBox;if(f[0]!==a||f[1]!==b||f[2]!==c||f[3]!==d)f[0]=a,f[1]=b,f[2]=c,f[3]=d,this.gl.scissor(a,b,c,d)};S.prototype.clear=function(a,b,c){var d=this.gl,f=this.state,g=0;if(a){var g=g+d.COLOR_BUFFER_BIT,h=f.clearColor,n=a[0],j=a[1],e=a[2],l=a[3];if(h[0]!==n||h[1]!==j||h[2]!==e||h[3]!==l)h[0]=n,h[1]=j,h[2]=e,h[3]=l,d.clearColor(n,j,e,l)}"number"===typeof b&&(g+=d.DEPTH_BUFFER_BIT,
f.clearDepth!==b&&(f.clearDepth=b,d.clearDepth(b)),"number"===typeof c&&(g+=d.STENCIL_BUFFER_BIT,f.clearStencil!==c&&(f.clearStencil=c,d.clearStencil(c))));g&&(c=f.colorMask,c=c[0]||c[1]||c[2]||c[3],h=f.depthMask,f=f.program,a&&(c||d.colorMask(!0,!0,!0,!0)),"number"===typeof b&&(h||d.depthMask(!0)),f&&d.useProgram(null),d.clear(g),a&&(c||d.colorMask(!1,!1,!1,!1)),"number"===typeof b&&(h||d.depthMask(!1)),f&&d.useProgram(f))};S.prototype.beginFrame=function(){var a=this.gl;this.attributeMask=0;var b=
this.clientStateMask,c;if(b){for(c=0;16>c;c+=1)b&1<<c&&a.disableVertexAttribArray(c);this.clientStateMask=0}this.resetStates();this.setScissor(0,0,this.width,this.height);this.setViewport(0,0,this.width,this.height);return!(document.hidden||document.webkitHidden)};S.prototype.beginRenderTarget=function(a){this.activeRenderTarget=a;return a.bind()};S.prototype.endRenderTarget=function(){this.activeRenderTarget.unbind();this.activeRenderTarget=null};S.prototype.beginOcclusionQuery=function(){return!1};
S.prototype.endOcclusionQuery=function(){};S.prototype.endFrame=function(){var a=this.gl;this.activeTechnique&&(this.activeTechnique.deactivate(),this.activeTechnique=null);this.activeIndexBuffer&&this.setIndexBuffer(null);var b=this.state;b.program&&(b.program=null,a.useProgram(null));this.numFrames+=1;var b=TurbulenzEngine.getTime(),c=b-this.previousFrameTime;1E3<=c&&(this.fps=this.numFrames/(0.001*c),this.numFrames=0,this.previousFrameTime=b);c=a.canvas;b=a.drawingBufferWidth||c.width;a=a.drawingBufferHeight||
c.height;if(this.width!==b||this.height!==a)this.width=b,this.height=a,this.setViewport(0,0,b,a),this.setScissor(0,0,b,a);this.checkFullScreen()};S.prototype.createTechniqueParameters=function(a){return ti.create(a)};S.prototype.createSemantics=function(a){return ve.create(this,a)};S.prototype.createVertexBuffer=function(a){return Db.create(this,a)};S.prototype.createIndexBuffer=function(a){return vc.create(this,a)};S.prototype.createTexture=function(a){return Cb.create(this,a)};S.prototype.createVideo=
function(a){return zd.create(a)};S.prototype.createShader=function(a){return wc.create(this,a)};S.prototype.createTechniqueParameterBuffer=function(a){void 0===Float32Array.prototype.map&&(Float32Array.prototype.map=function(a,c){void 0===a&&(a=0);var d=this;void 0===c&&(c=this.length);return function(){for(var c=arguments.length,g=0;g<c;g+=1){var h=arguments[g];"number"===typeof h?(d[a]=h,a+=1):(d.setData(h,a,h.length),a+=h.length)}}},Float32Array.prototype.unmap=function(){},Float32Array.prototype.setData=
function(a,c,d){void 0===c&&(c=0);void 0===d&&(d=this.length);for(var f=0;f<d;f+=1,c+=1)this[c]=a[f]});return new Float32Array(a.numFloats)};S.prototype.createRenderBuffer=function(a){return ue.create(this,a)};S.prototype.createRenderTarget=function(a){return Ub.create(this,a)};S.prototype.createOcclusionQuery=function(){return null};S.prototype.createDrawParameters=function(){return mb.create()};S.prototype.isSupported=function(a){var b=this.gl;if("OCCLUSION_QUERIES"===a||"NPOT_MIPMAPPED_TEXTURES"===
a)return!1;if("TEXTURE_DXT1"===a||"TEXTURE_DXT3"===a||"TEXTURE_DXT5"===a){var c=this.compressedTexturesExtension;if(c&&(b=b.getParameter(b.COMPRESSED_TEXTURE_FORMATS)))for(var a="TEXTURE_DXT1"===a?c.COMPRESSED_RGBA_S3TC_DXT1_EXT:"TEXTURE_DXT3"===a?c.COMPRESSED_RGBA_S3TC_DXT3_EXT:c.COMPRESSED_RGBA_S3TC_DXT5_EXT,c=b.length,d=0;d<c;d+=1)if(b[d]===a)return!0;return!1}if("TEXTURE_ETC1"===a)return!1;if("INDEXFORMAT_UINT"===a)return b.getExtension("OES_element_index_uint")?!0:!1;if("FILEFORMAT_WEBM"===a)return"webm"in
this.supportedVideoExtensions;if("FILEFORMAT_MP4"===a)return"mp4"in this.supportedVideoExtensions;if("FILEFORMAT_JPG"===a||"FILEFORMAT_PNG"===a)return!0;if("FILEFORMAT_DDS"===a)return"undefined"!==typeof R;if("FILEFORMAT_TGA"===a)return"undefined"!==typeof lb};S.prototype.maxSupported=function(a){var b=this.gl;if("ANISOTROPY"===a)return this.maxAnisotropy;if("TEXTURE_SIZE"===a)return b.getParameter(b.MAX_TEXTURE_SIZE);if("CUBEMAP_TEXTURE_SIZE"===a)return b.getParameter(b.MAX_CUBE_MAP_TEXTURE_SIZE);
if("3D_TEXTURE_SIZE"!==a){if("RENDERTARGET_COLOR_TEXTURES"===a)return this.drawBuffersExtension?this.WEBGL_draw_buffers?b.getParameter(this.drawBuffersExtension.MAX_COLOR_ATTACHMENTS_WEBGL):b.getParameter(this.drawBuffersExtension.MAX_COLOR_ATTACHMENTS_EXT):1;if("RENDERBUFFER_SIZE"===a)return b.getParameter(b.MAX_RENDERBUFFER_SIZE);if("TEXTURE_UNITS"===a)return b.getParameter(b.MAX_TEXTURE_IMAGE_UNITS);if("VERTEX_TEXTURE_UNITS"===a)return b.getParameter(b.MAX_VERTEX_TEXTURE_IMAGE_UNITS);if("VERTEX_SHADER_PRECISION"===
a||"FRAGMENT_SHADER_PRECISION"===a){a="VERTEX_SHADER_PRECISION"===a?b.VERTEX_SHADER:b.FRAGMENT_SHADER;if(!b.getShaderPrecisionFormat)return 0;var c=b.getShaderPrecisionFormat(a,b.HIGH_FLOAT);if(!c||!c.precision)if(c=b.getShaderPrecisionFormat(a,b.MEDIUM_FLOAT),!c||!c.precision)if(c=b.getShaderPrecisionFormat(a,b.LOW_FLOAT),!c||!c.precision)return 0;return c.precision}}return 0};S.prototype.loadTexturesArchive=function(a){var b=a.src;if("undefined"!==typeof ui)return ui.create({gd:this,src:b,mipmaps:a.mipmaps,
ontextureload:function(b){a.ontextureload(b)},onload:function(b,d){if(a.onload)a.onload(b,d)},onerror:function(b){if(a.onload)a.onload(!1,b)}}),!0;TurbulenzEngine.callOnError("Missing archive loader required for "+b);return!1};S.prototype.getScreenshot=function(a,b,c,d,f){var g=this.gl,h=g.canvas;if(a)return h.toDataURL("image/jpeg");void 0===b&&(b=0);void 0===c&&(c=0);(a=this.activeRenderTarget)||(a=h);void 0===d&&(d=a.width);void 0===f&&(f=a.height);h=new Uint8Array(4*d*f);g.readPixels(b,c,d,f,
g.RGBA,g.UNSIGNED_BYTE,h);return h};S.prototype.flush=function(){this.gl.flush()};S.prototype.finish=function(){this.gl.finish()};S.prototype._drawArraySortPositive=function(a,b){return b.sortKey-a.sortKey};S.prototype._drawArraySortNegative=function(a,b){return a.sortKey-b.sortKey};S.prototype.checkFullScreen=function(){var a=this.fullscreen;this.oldFullscreen!==a&&(this.oldFullscreen=a,this.requestFullScreen(a))};S.prototype.requestFullScreen=function(a){a?(a=this.gl.canvas,a.webkitRequestFullScreenWithKeys?
a.webkitRequestFullScreenWithKeys():a.requestFullScreenWithKeys?a.requestFullScreenWithKeys():a.webkitRequestFullScreen?a.webkitRequestFullScreen(a.ALLOW_KEYBOARD_INPUT):a.mozRequestFullScreen?a.mozRequestFullScreen():a.requestFullScreen?a.requestFullScreen():a.requestFullscreen&&a.requestFullscreen()):document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.cancelFullScreen?document.cancelFullScreen():document.exitFullscreen&&document.exitFullscreen();return!0};S.prototype.createSampler=
function(a){var b=a.minFilter.toString()+":"+a.magFilter.toString()+":"+a.wrapS.toString()+":"+a.wrapT.toString()+":"+a.wrapR.toString()+":"+a.maxAnisotropy.toString(),c=this.cachedSamplers,d=c[b];return!d?c[b]=a:d};S.prototype.unsetIndexBuffer=function(a){this.activeIndexBuffer===a&&(this.activeIndexBuffer=null,a=this.gl,a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null))};S.prototype.bindVertexBuffer=function(a){if(this.bindedVertexBuffer!==a){this.bindedVertexBuffer=a;var b=this.gl;b.bindBuffer(b.ARRAY_BUFFER,
a)}};S.prototype.unbindVertexBuffer=function(a){this.bindedVertexBuffer===a&&(this.bindedVertexBuffer=null,a=this.gl,a.bindBuffer(a.ARRAY_BUFFER,null))};S.prototype.bindTextureUnit=function(a,b,c){var d=this.state,f=this.gl;d.activeTextureUnit!==a&&(d.activeTextureUnit=a,f.activeTexture(f.TEXTURE0+a));f.bindTexture(b,c)};S.prototype.bindTexture=function(a,b){var c=this.state,d=this.gl,f=c.maxTextureUnit-1;c.activeTextureUnit!==f&&(c.activeTextureUnit=f,d.activeTexture(d.TEXTURE0+f));d.bindTexture(a,
b)};S.prototype.unbindTexture=function(a){for(var b=this.state,c=b.lastMaxTextureUnit,b=b.textureUnits,d=0;d<c;d+=1){var f=b[d];f.texture===a&&(f.texture=null,this.bindTextureUnit(d,f.target,null))}};S.prototype.setSampler=function(a,b){if(a){var c=this.gl;c.texParameteri(b,c.TEXTURE_MIN_FILTER,a.minFilter);c.texParameteri(b,c.TEXTURE_MAG_FILTER,a.magFilter);c.texParameteri(b,c.TEXTURE_WRAP_S,a.wrapS);c.texParameteri(b,c.TEXTURE_WRAP_T,a.wrapT);this.TEXTURE_MAX_ANISOTROPY_EXT&&c.texParameteri(b,this.TEXTURE_MAX_ANISOTROPY_EXT,
a.maxAnisotropy)}};S.prototype.setPass=function(a){var b=this.gl,c=this.state,d=a.statesSet,f=a.states,g=f.length,h,n;for(h=0;h<g;h+=1)n=f[h],n.set.apply(n,n.values);var g=c.renderStatesToReset,j=g.length;for(h=0;h<j;h+=1)n=g[h],n.name in d||n.reset();c.renderStatesToReset=f;d=c.lastMaxTextureUnit;f=c.textureUnits;h=a.numTextureUnits;if(h<d){n=h;do g=f[n],g.texture&&(g.texture=null,this.bindTextureUnit(n,g.target,null)),n+=1;while(n<d)}c.lastMaxTextureUnit=h;d=a.glProgram;c.program!==d&&(c.program=
d,b.useProgram(d));a.dirty&&a.updateParametersData(this)};S.prototype.enableClientState=function(a){var b=this.gl,c=this.clientStateMask;this.clientStateMask=a;var d=c&~a,a=~c&a;if(d){0===(d&255)?(d>>=8,c=8):c=0;do 0!==(1&d)&&b.disableVertexAttribArray(c),c+=1,d>>=1;while(d)}if(a){0===(a&255)?(a>>=8,c=8):c=0;do 0!==(1&a)&&b.enableVertexAttribArray(c),c+=1,a>>=1;while(a)}};S.prototype.setTexture=function(a,b,c){var d=this.state,f=this.gl,g=d.textureUnits[a],h=g.target,n=g.texture;if(b){var j=b.target,
e=b.glTexture;if(n!==e||h!==j)g.target=j,g.texture=e,d.activeTextureUnit!==a&&(d.activeTextureUnit=a,f.activeTexture(f.TEXTURE0+a)),h!==j&&n&&f.bindTexture(h,null),f.bindTexture(j,e),b.sampler!==c&&(b.sampler=c,this.setSampler(c,j))}else h&&n&&(g.target=0,g.texture=null,d.activeTextureUnit!==a&&(d.activeTextureUnit=a,f.activeTexture(f.TEXTURE0+a)),f.bindTexture(h,null))};S.prototype.setProgram=function(a){var b=this.state;b.program!==a&&(b.program=a,this.gl.useProgram(a))};S.prototype.syncState=function(){var a=
this.state,b=this.gl;a.depthTestEnable?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST);b.depthFunc(a.depthFunc);b.depthMask(a.depthMask);a.blendEnable?b.enable(b.BLEND):b.disable(b.BLEND);b.blendFunc(a.blendSrc,a.blendDst);a.cullFaceEnable?b.enable(b.CULL_FACE):b.disable(b.CULL_FACE);b.cullFace(a.cullFace);b.frontFace(a.frontFace);var c=a.colorMask;b.colorMask(c[0],c[1],c[2],c[3]);a.stencilTestEnable?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST);b.stencilFunc(a.stencilFunc,a.stencilRef,a.stencilMask);
b.stencilOp(a.stencilFail,a.stencilZFail,a.stencilZPass);a.polygonOffsetFillEnable?b.enable(b.POLYGON_OFFSET_FILL):b.disable(b.POLYGON_OFFSET_FILL);b.polygonOffset(a.polygonOffsetFactor,a.polygonOffsetUnits);b.lineWidth(a.lineWidth);b.activeTexture(b.TEXTURE0+a.activeTextureUnit);c=this.state.viewportBox;b.viewport(c[0],c[1],c[2],c[3]);c=this.state.scissorBox;b.scissor(c[0],c[1],c[2],c[3]);c=a.clearColor;b.clearColor(c[0],c[1],c[2],c[3]);b.clearDepth(a.clearDepth);b.clearStencil(a.clearStencil)};
S.prototype.resetStates=function(){for(var a=this.state,b=a.lastMaxTextureUnit,a=a.textureUnits,c=0;c<b;c+=1){var d=a[c];d.texture&&(this.bindTextureUnit(c,d.target,null),d.texture=null,d.target=0)}};S.prototype.destroy=function(){delete this.activeTechnique;delete this.activeIndexBuffer;delete this.bindedVertexBuffer;this.immediateVertexBuffer&&(this.immediateVertexBuffer.destroy(),delete this.immediateVertexBuffer);delete this.gl;"undefined"!==typeof R&&R.destroy()};S.create=function(a,b){function c(a){return"boolean"!==
typeof a?[a?!0:!1]:[a]}function d(a){return"number"!==typeof a?null:[a]}function f(a){if("object"===typeof a){var b=a[0],c=a[1],a=a[2];return"number"!==typeof b||"number"!==typeof c||"number"!==typeof a?null:[b,c,a]}return null}var g;a:{var h=["webgl","experimental-webgl"];if(a.getContext){var n={alpha:!1,stencil:!0,antialias:!1},j=b.multisample;void 0!==j&&1<j&&(n.antialias=!0);b.alpha&&(n.alpha=!0);var j=h.length,e;for(e=0;e<j;e+=1)try{var l=a.getContext(h[e],n);if(l){g=l;break a}}catch(m){}}g=
null}if(!g)return null;h=g.drawingBufferWidth||a.width;n=g.drawingBufferHeight||a.height;g.enable(g.SCISSOR_TEST);g.depthRange(0,1);g.pixelStorei(g.UNPACK_ALIGNMENT,1);var q=new S;q.gl=g;q.width=h;q.height=n;l=(l=g.getSupportedExtensions())?l.join(" "):"";q.extensions=l;q.shadingLanguageVersion=g.getParameter(g.SHADING_LANGUAGE_VERSION);q.rendererVersion=g.getParameter(g.VERSION);q.renderer=g.getParameter(g.RENDERER);q.vendor=g.getParameter(g.VENDOR);-1!==l.indexOf("WEBGL_compressed_texture_s3tc")?
(q.WEBGL_compressed_texture_s3tc=!0,q.compressedTexturesExtension=-1!==l.indexOf("WEBKIT_WEBGL_compressed_texture_s3tc")?g.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"):-1!==l.indexOf("MOZ_WEBGL_compressed_texture_s3tc")?g.getExtension("MOZ_WEBGL_compressed_texture_s3tc"):g.getExtension("WEBGL_compressed_texture_s3tc")):-1!==l.indexOf("WEBKIT_WEBGL_compressed_textures")&&(q.compressedTexturesExtension=g.getExtension("WEBKIT_WEBGL_compressed_textures"));var p;-1!==l.indexOf("EXT_texture_filter_anisotropic")&&
(p=-1!==l.indexOf("MOZ_EXT_texture_filter_anisotropic")?g.getExtension("MOZ_EXT_texture_filter_anisotropic"):-1!==l.indexOf("WEBKIT_EXT_texture_filter_anisotropic")?g.getExtension("WEBKIT_EXT_texture_filter_anisotropic"):g.getExtension("EXT_texture_filter_anisotropic"));p?(q.TEXTURE_MAX_ANISOTROPY_EXT=p.TEXTURE_MAX_ANISOTROPY_EXT,q.maxAnisotropy=g.getParameter(p.MAX_TEXTURE_MAX_ANISOTROPY_EXT)):q.maxAnisotropy=1;g.getExtension("OES_element_index_uint");-1!==l.indexOf("WEBGL_draw_buffers")?(q.WEBGL_draw_buffers=
!0,q.drawBuffersExtension=g.getExtension("WEBGL_draw_buffers")):-1!==l.indexOf("EXT_draw_buffers")&&(q.drawBuffersExtension=g.getExtension("EXT_draw_buffers"));q.PRIMITIVE_POINTS=g.POINTS;q.PRIMITIVE_LINES=g.LINES;q.PRIMITIVE_LINE_LOOP=g.LINE_LOOP;q.PRIMITIVE_LINE_STRIP=g.LINE_STRIP;q.PRIMITIVE_TRIANGLES=g.TRIANGLES;q.PRIMITIVE_TRIANGLE_STRIP=g.TRIANGLE_STRIP;q.PRIMITIVE_TRIANGLE_FAN=g.TRIANGLE_FAN;q.INDEXFORMAT_UBYTE=g.UNSIGNED_BYTE;q.INDEXFORMAT_USHORT=g.UNSIGNED_SHORT;q.INDEXFORMAT_UINT=g.UNSIGNED_INT;
p=function(a,b,c,d,f){b={numComponents:b,stride:c,componentStride:c/b,format:d,name:f,normalized:void 0,normalizationScale:void 0,typedSetter:void 0,typedArray:void 0};a?(b.normalized=!0,b.normalizationScale=d===g.BYTE?127:d===g.UNSIGNED_BYTE?255:d===g.SHORT?32767:d===g.UNSIGNED_SHORT?65535:d===g.INT?2147483647:d===g.UNSIGNED_INT?4294967295:1):(b.normalized=!1,b.normalizationScale=1);"undefined"!==typeof DataView&&"setFloat32"in DataView.prototype?b.typedSetter=d===g.BYTE?DataView.prototype.setInt8:
d===g.UNSIGNED_BYTE?DataView.prototype.setUint8:d===g.SHORT?DataView.prototype.setInt16:d===g.UNSIGNED_SHORT?DataView.prototype.setUint16:d===g.INT?DataView.prototype.setInt32:d===g.UNSIGNED_INT?DataView.prototype.setUint32:DataView.prototype.setFloat32:b.typedArray=d===g.BYTE?Int8Array:d===g.UNSIGNED_BYTE?Uint8Array:d===g.SHORT?Int16Array:d===g.UNSIGNED_SHORT?Uint16Array:d===g.INT?Int32Array:d===g.UNSIGNED_INT?Uint32Array:Float32Array;return b};q.VERTEXFORMAT_BYTE4=p(0,4,4,g.BYTE,"BYTE4");q.VERTEXFORMAT_BYTE4N=
p(1,4,4,g.BYTE,"BYTE4N");q.VERTEXFORMAT_UBYTE4=p(0,4,4,g.UNSIGNED_BYTE,"UBYTE4");q.VERTEXFORMAT_UBYTE4N=p(1,4,4,g.UNSIGNED_BYTE,"UBYTE4N");q.VERTEXFORMAT_SHORT2=p(0,2,4,g.SHORT,"SHORT2");q.VERTEXFORMAT_SHORT2N=p(1,2,4,g.SHORT,"SHORT2N");q.VERTEXFORMAT_SHORT4=p(0,4,8,g.SHORT,"SHORT4");q.VERTEXFORMAT_SHORT4N=p(1,4,8,g.SHORT,"SHORT4N");q.VERTEXFORMAT_USHORT2=p(0,2,4,g.UNSIGNED_SHORT,"USHORT2");q.VERTEXFORMAT_USHORT2N=p(1,2,4,g.UNSIGNED_SHORT,"USHORT2N");q.VERTEXFORMAT_USHORT4=p(0,4,8,g.UNSIGNED_SHORT,
"USHORT4");q.VERTEXFORMAT_USHORT4N=p(1,4,8,g.UNSIGNED_SHORT,"USHORT4N");q.VERTEXFORMAT_FLOAT1=p(0,1,4,g.FLOAT,"FLOAT1");q.VERTEXFORMAT_FLOAT2=p(0,2,8,g.FLOAT,"FLOAT2");q.VERTEXFORMAT_FLOAT3=p(0,3,12,g.FLOAT,"FLOAT3");q.VERTEXFORMAT_FLOAT4=p(0,4,16,g.FLOAT,"FLOAT4");q.DEFAULT_SAMPLER={minFilter:g.LINEAR_MIPMAP_LINEAR,magFilter:g.LINEAR,wrapS:g.REPEAT,wrapT:g.REPEAT,wrapR:g.REPEAT,maxAnisotropy:1};q.cachedSamplers={};p=1;l=g.getParameter(g.MAX_TEXTURE_IMAGE_UNITS);p<l&&(p=l);l=g.getParameter(g.MAX_COMBINED_TEXTURE_IMAGE_UNITS);
p<l&&(p=l);l=[];l.length=p;for(j=0;j<p;j+=1)l[j]={texture:null,target:0};var s=g.LEQUAL,i=g.SRC_ALPHA,u=g.ONE_MINUS_SRC_ALPHA,k=g.BACK,B=g.CCW,y=g.ALWAYS,v=g.KEEP,x={depthTestEnable:!0,blendEnable:!1,cullFaceEnable:!0,stencilTestEnable:!1,polygonOffsetFillEnable:!1,depthMask:!0,depthFunc:s,blendSrc:i,blendDst:u,cullFace:k,frontFace:B,colorMask:[!0,!0,!0,!0],stencilFunc:y,stencilRef:0,stencilMask:4294967295,stencilFail:v,stencilZFail:v,stencilZPass:v,polygonOffsetFactor:0,polygonOffsetUnits:0,lineWidth:1,
renderStatesToReset:[],viewportBox:[0,0,h,n],scissorBox:[0,0,h,n],clearColor:[0,0,0,1],clearDepth:1,clearStencil:0,activeTextureUnit:0,maxTextureUnit:p,lastMaxTextureUnit:0,textureUnits:l,program:null};q.state=x;q.counters={textures:0,vertexBuffers:0,indexBuffers:0,renderTargets:0,renderBuffers:0,shaders:0,techniques:0};var J={};p=function(a,b,c,d,f){J[a]={set:b,reset:c,parse:d,defaultValues:f}};p("DepthTestEnable",function(a){x.depthTestEnable!==a&&((x.depthTestEnable=a)?g.enable(g.DEPTH_TEST):g.disable(g.DEPTH_TEST))},
function(){x.depthTestEnable||(x.depthTestEnable=!0,g.enable(g.DEPTH_TEST))},c,[!0]);p("DepthFunc",function(a){x.depthFunc!==a&&(x.depthFunc=a,g.depthFunc(a))},function(){x.depthFunc!==s&&(x.depthFunc=s,g.depthFunc(s))},d,[s]);p("DepthMask",function(a){x.depthMask!==a&&(x.depthMask=a,g.depthMask(a))},function(){x.depthMask||(x.depthMask=!0,g.depthMask(!0))},c,[!0]);p("BlendEnable",function(a){x.blendEnable!==a&&((x.blendEnable=a)?g.enable(g.BLEND):g.disable(g.BLEND))},function(){x.blendEnable&&(x.blendEnable=
!1,g.disable(g.BLEND))},c,[!1]);p("BlendFunc",function(a,b){if(x.blendSrc!==a||x.blendDst!==b)x.blendSrc=a,x.blendDst=b,g.blendFunc(a,b)},function(){if(x.blendSrc!==i||x.blendDst!==u)x.blendSrc=i,x.blendDst=u,g.blendFunc(i,u)},function(a){if("object"===typeof a){var b=a[0],a=a[1];return"number"!==typeof b||"number"!==typeof a?null:[b,a]}return null},[i,u]);p("CullFaceEnable",function(a){x.cullFaceEnable!==a&&((x.cullFaceEnable=a)?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE))},function(){x.cullFaceEnable||
(x.cullFaceEnable=!0,g.enable(g.CULL_FACE))},c,[!0]);p("CullFace",function(a){x.cullFace!==a&&(x.cullFace=a,g.cullFace(a))},function(){x.cullFace!==k&&(x.cullFace=k,g.cullFace(k))},d,[k]);p("FrontFace",function(a){x.frontFace!==a&&(x.frontFace=a,g.frontFace(a))},function(){x.frontFace!==B&&(x.frontFace=B,g.frontFace(B))},d,[B]);p("ColorMask",function(a,b,c,d){var f=x.colorMask;if(f[0]!==a||f[1]!==b||f[2]!==c||f[3]!==d)f[0]=a,f[1]=b,f[2]=c,f[3]=d,g.colorMask(a,b,c,d)},function(){var a=x.colorMask;
if(!0!==a[0]||!0!==a[1]||!0!==a[2]||!0!==a[3])a[0]=!0,a[1]=!0,a[2]=!0,a[3]=!0,g.colorMask(!0,!0,!0,!0)},function(a){if("object"===typeof a){var b=a[0],c=a[1],d=a[2],a=a[3];return"number"!==typeof b||"number"!==typeof c||"number"!==typeof d||"number"!==typeof a?null:[b,c,d,a]}return null},[!0,!0,!0,!0]);p("StencilTestEnable",function(a){x.stencilTestEnable!==a&&((x.stencilTestEnable=a)?g.enable(g.STENCIL_TEST):g.disable(g.STENCIL_TEST))},function(){x.stencilTestEnable&&(x.stencilTestEnable=!1,g.disable(g.STENCIL_TEST))},
c,[!1]);p("StencilFunc",function(a,b,c){if(x.stencilFunc!==a||x.stencilRef!==b||x.stencilMask!==c)x.stencilFunc=a,x.stencilRef=b,x.stencilMask=c,g.stencilFunc(a,b,c)},function(){if(x.stencilFunc!==y||0!==x.stencilRef||4294967295!==x.stencilMask)x.stencilFunc=y,x.stencilRef=0,x.stencilMask=4294967295,g.stencilFunc(y,0,4294967295)},f,[y,0,4294967295]);p("StencilOp",function(a,b,c){if(x.stencilFail!==a||x.stencilZFail!==b||x.stencilZPass!==c)x.stencilFail=a,x.stencilZFail=b,x.stencilZPass=c,g.stencilOp(a,
b,c)},function(){if(x.stencilFail!==v||x.stencilZFail!==v||x.stencilZPass!==v)x.stencilFail=v,x.stencilZFail=v,x.stencilZPass=v,g.stencilOp(v,v,v)},f,[v,v,v]);p("PolygonOffsetFillEnable",function(a){x.polygonOffsetFillEnable!==a&&((x.polygonOffsetFillEnable=a)?g.enable(g.POLYGON_OFFSET_FILL):g.disable(g.POLYGON_OFFSET_FILL))},function(){x.polygonOffsetFillEnable&&(x.polygonOffsetFillEnable=!1,g.disable(g.POLYGON_OFFSET_FILL))},c,[!1]);p("PolygonOffset",function(a,b){if(x.polygonOffsetFactor!==a||
x.polygonOffsetUnits!==b)x.polygonOffsetFactor=a,x.polygonOffsetUnits=b,g.polygonOffset(a,b)},function(){if(0!==x.polygonOffsetFactor||0!==x.polygonOffsetUnits)x.polygonOffsetFactor=0,x.polygonOffsetUnits=0,g.polygonOffset(0,0)},function(a){if("object"===typeof a){var b=a[0],a=a[1];return"number"!==typeof b||"number"!==typeof a?null:[b,a]}return null},[0,0]);p("LineWidth",function(a){x.lineWidth!==a&&(x.lineWidth=a,g.lineWidth(a))},function(){1!==x.lineWidth&&(x.lineWidth=1,g.lineWidth(1))},function(a){return"number"!==
typeof a?null:[a]},[1]);q.stateHandlers=J;q.syncState();q.videoRam=0;q.desktopWidth=window.screen.width;q.desktopHeight=window.screen.height;Object.defineProperty?(Object.defineProperty(q,"fullscreen",{get:function(){return document.fullscreenEnabled||document.mozFullScreen||document.webkitIsFullScreen||!1},set:function(a){q.requestFullScreen(a)},enumerable:!0,configurable:!1}),q.checkFullScreen=function(){}):(q.fullscreen=!1,q.oldFullscreen=!1);q.clientStateMask=0;q.attributeMask=0;q.activeTechnique=
null;q.activeIndexBuffer=null;q.bindedVertexBuffer=null;q.activeRenderTarget=null;q.immediateVertexBuffer=q.createVertexBuffer({numVertices:16384,attributes:["FLOAT4"],dynamic:!0,"transient":!0});q.immediatePrimitive=-1;q.immediateSemantics=ve.create(q,[]);q.fps=0;q.numFrames=0;q.previousFrameTime=TurbulenzEngine.getTime();p=document.createElement("video");h={};p&&(p.canPlayType("video/webm")&&(h.webm=!0),p.canPlayType("video/mp4")&&(h.mp4=!0));q.supportedVideoExtensions=h;p=null;return q};S.version=
1;S.prototype.SEMANTIC_POSITION=0;S.prototype.SEMANTIC_POSITION0=0;S.prototype.SEMANTIC_BLENDWEIGHT=1;S.prototype.SEMANTIC_BLENDWEIGHT0=1;S.prototype.SEMANTIC_NORMAL=2;S.prototype.SEMANTIC_NORMAL0=2;S.prototype.SEMANTIC_COLOR=3;S.prototype.SEMANTIC_COLOR0=3;S.prototype.SEMANTIC_COLOR1=4;S.prototype.SEMANTIC_SPECULAR=4;S.prototype.SEMANTIC_FOGCOORD=5;S.prototype.SEMANTIC_TESSFACTOR=5;S.prototype.SEMANTIC_PSIZE0=6;S.prototype.SEMANTIC_BLENDINDICES=7;S.prototype.SEMANTIC_BLENDINDICES0=7;S.prototype.SEMANTIC_TEXCOORD=
8;S.prototype.SEMANTIC_TEXCOORD0=8;S.prototype.SEMANTIC_TEXCOORD1=9;S.prototype.SEMANTIC_TEXCOORD2=10;S.prototype.SEMANTIC_TEXCOORD3=11;S.prototype.SEMANTIC_TEXCOORD4=12;S.prototype.SEMANTIC_TEXCOORD5=13;S.prototype.SEMANTIC_TEXCOORD6=14;S.prototype.SEMANTIC_TEXCOORD7=15;S.prototype.SEMANTIC_TANGENT=14;S.prototype.SEMANTIC_TANGENT0=14;S.prototype.SEMANTIC_BINORMAL0=15;S.prototype.SEMANTIC_BINORMAL=15;S.prototype.SEMANTIC_PSIZE=6;S.prototype.SEMANTIC_ATTR0=0;S.prototype.SEMANTIC_ATTR1=1;S.prototype.SEMANTIC_ATTR2=
2;S.prototype.SEMANTIC_ATTR3=3;S.prototype.SEMANTIC_ATTR4=4;S.prototype.SEMANTIC_ATTR5=5;S.prototype.SEMANTIC_ATTR6=6;S.prototype.SEMANTIC_ATTR7=7;S.prototype.SEMANTIC_ATTR8=8;S.prototype.SEMANTIC_ATTR9=9;S.prototype.SEMANTIC_ATTR10=10;S.prototype.SEMANTIC_ATTR11=11;S.prototype.SEMANTIC_ATTR12=12;S.prototype.SEMANTIC_ATTR13=13;S.prototype.SEMANTIC_ATTR14=14;S.prototype.SEMANTIC_ATTR15=15;S.prototype.PIXELFORMAT_A8=0;S.prototype.PIXELFORMAT_L8=1;S.prototype.PIXELFORMAT_L8A8=2;S.prototype.PIXELFORMAT_R5G5B5A1=
3;S.prototype.PIXELFORMAT_R5G6B5=4;S.prototype.PIXELFORMAT_R4G4B4A4=5;S.prototype.PIXELFORMAT_R8G8B8A8=6;S.prototype.PIXELFORMAT_R8G8B8=7;S.prototype.PIXELFORMAT_D24S8=8;S.prototype.PIXELFORMAT_D16=9;S.prototype.PIXELFORMAT_DXT1=10;S.prototype.PIXELFORMAT_DXT3=11;S.prototype.PIXELFORMAT_DXT5=12;Rd.prototype={version:1,update:function(){},addEventListener:function(a,b){var c,d,f;if(this.handlers.hasOwnProperty(a)&&(f=this.handlers[a],b)){d=f.length;for(c=0;c<d;c+=1)if(f[c]===b)return;f.push(b)}},removeEventListener:function(a,
b){var c,d,f;if(this.handlers.hasOwnProperty(a)&&(f=this.handlers[a],b)){d=f.length;for(c=0;c<d;c+=1)if(f[c]===b){f.splice(c,1);break}}},lockMouse:function(){return this.isHovering&&this.isWindowFocused?(this.isMouseLocked=!0,this.hideMouse(),this.requestBrowserLock(),this.setEventHandlersLock(),!0):!1},unlockMouse:function(){return this.isMouseLocked?(this.isMouseLocked=!1,this.showMouse(),this.requestBrowserUnlock(),this.setEventHandlersUnlock(),this.isOutsideEngine&&(this.isHovering=this.isOutsideEngine=
!1,this.setEventHandlersMouseLeave(),this.sendEventToHandlers(this.handlers.mouseleave)),this.sendEventToHandlers(this.handlers.mouselocklost),!0):!1},isLocked:function(){return this.isMouseLocked},hideMouse:function(){return this.isHovering?(this.isCursorHidden||(this.isCursorHidden=!0,this.previousCursor=document.body.style.cursor,document.body.style.cursor="none",this.webkit&&(this.ignoreNextMouseMoves=2)),!0):!1},showMouse:function(){return this.isCursorHidden&&!this.isMouseLocked?(this.isCursorHidden=
!1,document.body.style.cursor=this.previousCursor,!0):!1},isHidden:function(){return this.isCursorHidden},isFocused:function(){return this.isWindowFocused},convertToUnicode:function(a){var b=this.keyCodeToUnicode,c={},d=a.length,f,g;for(f=0;f<d;f+=1)g=a[f],c[g]=b[g]||"";return c},keyCodes:{A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,NUMBER_0:100,NUMBER_1:101,NUMBER_2:102,NUMBER_3:103,NUMBER_4:104,NUMBER_5:105,NUMBER_6:106,
NUMBER_7:107,NUMBER_8:108,NUMBER_9:109,LEFT:200,RIGHT:201,UP:202,DOWN:203,LEFT_SHIFT:300,RIGHT_SHIFT:301,LEFT_CONTROL:302,RIGHT_CONTROL:303,LEFT_ALT:304,RIGHT_ALT:305,ESCAPE:400,TAB:401,SPACE:402,BACKSPACE:403,RETURN:404,GRAVE:500,MINUS:501,EQUALS:502,LEFT_BRACKET:503,RIGHT_BRACKET:504,SEMI_COLON:505,APOSTROPHE:506,COMMA:507,PERIOD:508,SLASH:509,BACKSLASH:510,F1:600,F2:601,F3:602,F4:603,F5:604,F6:605,F7:606,F8:607,F9:608,F10:609,F11:610,F12:611,NUMPAD_0:612,NUMPAD_1:613,NUMPAD_2:614,NUMPAD_3:615,
NUMPAD_4:616,NUMPAD_5:617,NUMPAD_6:618,NUMPAD_7:619,NUMPAD_8:620,NUMPAD_9:621,NUMPAD_ENTER:622,NUMPAD_DIVIDE:623,NUMPAD_MULTIPLY:624,NUMPAD_ADD:625,NUMPAD_SUBTRACT:626,LEFT_WIN:627,RIGHT_WIN:628,LEFT_OPTION:629,RIGHT_OPTION:630,CAPS_LOCK:631,INSERT:632,DELETE:633,HOME:634,END:635,PAGE_UP:636,PAGE_DOWN:637,BACK:638},mouseCodes:{BUTTON_0:0,BUTTON_1:1,BUTTON_2:2,DELTA_X:100,DELTA_Y:101,MOUSE_WHEEL:102},padCodes:{UP:0,LEFT:1,DOWN:2,RIGHT:3,A:4,B:5,X:6,Y:7,LEFT_TRIGGER:8,RIGHT_TRIGGER:9,LEFT_SHOULDER:10,
RIGHT_SHOULDER:11,LEFT_THUMB:12,LEFT_THUMB_X:13,LEFT_THUMB_Y:14,RIGHT_THUMB:15,RIGHT_THUMB_X:16,RIGHT_THUMB_Y:17,START:18,BACK:19},sendEventToHandlers:function(a,b,c,d,f,g,h){var n,j=a.length;if(j)for(n=0;n<j;n+=1)a[n](b,c,d,f,g,h)},sendEventToHandlersASync:function(a,b,c,d,f,g,h){var n=Rd.prototype.sendEventToHandlers;TurbulenzEngine.setTimeout(function(){n(a,b,c,d,f,g,h)},0)},updateGamePad:function(){var a,b=navigator.gamepads||navigator.webkitGamepads||navigator.webkitGetGamepads&&navigator.webkitGetGamepads();
if(b){var c=this.padAxisDeadZone,d=this.maxAxisRange,f=this.sendEventToHandlersASync,g=this.handlers;a=this.padButtons;for(var h=this.padMap,n=0,j=0,e=0,l=0,m=b.length,q=0;q<m;q+=1){var p=b[q];if(p){b=p.buttons;if(this.padTimestampUpdate<p.timestamp){this.padTimestampUpdate=p.timestamp;m=b.length;for(q=0;q<m;q+=1){var s=b[q];if(a[q]!==s){a[q]=s;var i=h[q];void 0!==i&&(s?f(g.paddown,i):f(g.padup,i))}}}h=p.axes;4>=h.length&&(p=h[0],m=-h[1],a=p*p+m*m,a>c*c&&(a=Math.sqrt(a),p/=a,m/=a,a>d&&(a=d),a-=c,
a/=d-c,n=p*a,j=m*a),p=h[2],h=-h[3],a=p*p+h*h,a>c*c&&(a=Math.sqrt(a),p/=a,h/=a,a>d&&(a=d),a-=c,a/=d-c,e=p*a,l=h*a),f(g.padmove,n,j,b[6],e,l,b[7]));break}}}},getLocale:function(){return""},getCanvasPosition:function(a,b){void 0!==a.offsetX?(b.x=a.offsetX,b.y=a.offsetY):void 0!==a.layerX&&(b.x=a.layerX,b.y=a.layerY)},resetKeyStates:function(){var a,b=this.pressedKeys,c=this.handlers.keyup;for(a in b)b.hasOwnProperty(a)&&b[a]&&(a=parseInt(a,10),b[a]=!1,this.sendEventToHandlers(c,a))},onMouseOver:function(a){var b=
{},c=this.handlers.mouseover;a.stopPropagation();a.preventDefault();this.getCanvasPosition(a,b);this.lastX=a.screenX;this.lastY=a.screenY;this.sendEventToHandlers(c,b.x,b.y)},onMouseMove:function(a){var b=this.handlers.mousemove,c,d;a.stopPropagation();a.preventDefault();if(this.ignoreNextMouseMoves)this.ignoreNextMouseMoves-=1;else{if(void 0!==a.movementX)c=a.movementX,d=a.movementY;else if(void 0!==a.mozMovementX)c=a.mozMovementX,d=a.mozMovementY;else if(void 0!==a.webkitMovementX)c=a.webkitMovementX,
d=a.webkitMovementY;else if(c=a.screenX-this.lastX,d=a.screenY-this.lastY,0===c&&0===d)return;this.lastX=a.screenX;this.lastY=a.screenY;this.sendEventToHandlers(b,c,d)}},onWheel:function(a){var b=this.handlers.mousewheel;a.stopPropagation();a.preventDefault();this.sendEventToHandlers(b,a.wheelDelta?window.opera?0>a.wheelDelta?1:-1:0<a.wheelDelta?1:-1:0>a.detail?1:-1)},emptyEvent:function(a){a.stopPropagation();a.preventDefault()},onWindowFocus:function(){this.isHovering&&window.document.activeElement===
this.canvas&&this.addInternalEventListener(window,"mousedown",this.onMouseDown)},onFocus:function(){var a=this.canvas,b=this.handlers.focus;this.isWindowFocused||(this.isWindowFocused=!0,window.focus(),a.focus(),this.setEventHandlersFocus(),a.oncontextmenu=function(){return!1},this.sendEventToHandlers(b))},onBlur:function(){var a=this.canvas,b=this.handlers.blur;this.isMouseLocked&&this.unlockMouse();this.isWindowFocused&&(this.isWindowFocused=!1,this.resetKeyStates(),this.setEventHandlersBlur(),
a.oncontextmenu=null,this.sendEventToHandlers(b))},onMouseDown:function(a){var b=this.handlers;if(this.isHovering){var b=b.mousedown,c=a.button,d={};this.onFocus();a.stopPropagation();a.preventDefault();3>c&&(c=this.mouseMap[c]);this.getCanvasPosition(a,d);this.sendEventToHandlers(b,c,d.x,d.y)}else this.onBlur()},onMouseUp:function(a){var b=this.handlers.mouseup,c=a.button,d={};this.isHovering&&(a.stopPropagation(),a.preventDefault());3>c&&(c=this.mouseMap[c]);this.getCanvasPosition(a,d);this.sendEventToHandlers(b,
c,d.x,d.y)},onKeyDown:function(a){var b=this.handlers.keydown,c=this.pressedKeys,d=this.keyCodes,f=a.keyCode,f=this.keyMap[f];void 0!==f&&(a.stopPropagation(),a.preventDefault(),a=a.keyLocation||a.location,d.ESCAPE!==f&&(2===a&&(f+=1),c[f]||(c[f]=!0,this.sendEventToHandlers(b,f))))},onKeyUp:function(a){var b=this.handlers.keyup,c=this.pressedKeys,d=this.keyCodes,f=a.keyCode,f=this.keyMap[f];if(void 0!==f)if(a.stopPropagation(),a.preventDefault(),a=a.keyLocation||a.location,f===d.ESCAPE){if(this.unlockMouse(),
document.fullscreenEnabled||document.mozFullScreen||document.webkitIsFullScreen)document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.cancelFullScreen?document.cancelFullScreen():document.exitFullscreen&&document.exitFullscreen()}else 2===a&&(f+=1),c[f]&&(c[f]=!1,this.sendEventToHandlers(b,f),(627===f||628===f)&&this.macosx&&this.resetKeyStates())},onTouchStart:function(a){var b=this.handlers.touchstart;a.preventDefault();this.addTouches(a.changedTouches);a=this.convertW3TouchEventToTurbulenzTouchEvent(a);
this.sendEventToHandlers(b,a)},onTouchEnd:function(a){var b=this.handlers.touchend;a.preventDefault();a=this.convertW3TouchEventToTurbulenzTouchEvent(a);this.removeTouches(a.changedTouches);this.sendEventToHandlers(b,a)},onTouchMove:function(a){var b=this.handlers.touchmove;a.preventDefault();this.addTouches(a.changedTouches);a=this.convertW3TouchEventToTurbulenzTouchEvent(a);this.sendEventToHandlers(b,a)},onTouchEnter:function(a){var b=this.handlers.touchenter;a.preventDefault();a=this.convertW3TouchEventToTurbulenzTouchEvent(a);
this.sendEventToHandlers(b,a)},onTouchLeave:function(a){var b=this.handlers.touchleave;a.preventDefault();a=this.convertW3TouchEventToTurbulenzTouchEvent(a);this.sendEventToHandlers(b,a)},onTouchCancel:function(a){var b=this.handlers.touchcancel;a.preventDefault();a=this.convertW3TouchEventToTurbulenzTouchEvent(a);this.removeTouches(a.changedTouches);this.sendEventToHandlers(b,a)},convertW3TouchEventToTurbulenzTouchEvent:function(a){var b=this.convertW3TouchListToTurbulenzTouchList(a.changedTouches),
c=this.convertW3TouchListToTurbulenzTouchList(a.targetTouches),a=this.convertW3TouchListToTurbulenzTouchList(a.touches);return Kj.create({changedTouches:b,gameTouches:c,touches:a})},convertW3TouchListToTurbulenzTouchList:function(a){var b=a.length,c=[],d,f;c.length=b;for(f=0;f<b;f+=1)d=this.getTouchById(a[f].identifier),c[f]=d;return c},convertW3TouchToTurbulenzTouch:function(a){var b=this.canvas,c=b.getBoundingClientRect();return Lj.create({force:a.force||a.webkitForce||0,identifier:a.identifier,
isGameTouch:a.target===b,positionX:a.pageX-c.left,positionY:a.pageY-c.top,radiusX:a.radiusX||a.webkitRadiusX||1,radiusY:a.radiusY||a.webkitRadiusY||1,rotationAngle:a.rotationAngle||a.webkitRotationAngle||0})},addTouches:function(a){var b=a.length,c,d;for(c=0;c<b;c+=1)d=this.convertW3TouchToTurbulenzTouch(a[c]),this.addTouch(d)},removeTouches:function(a){var b=a.length,c,d;for(c=0;c<b;c+=1)d=a[c].identifier,this.removeTouchById(d)},addTouch:function(a){this.touches[a.identifier]=a},getTouchById:function(a){return this.touches[a]},
removeTouchById:function(a){delete this.touches[a]},canvasOnMouseOver:function(a){var b=this.handlers.mouseenter;this.isMouseLocked?this.isOutsideEngine=!1:(this.isHovering=!0,this.lastX=a.screenX,this.lastY=a.screenY,this.setEventHandlersMouseEnter(),this.sendEventToHandlers(b))},canvasOnMouseOut:function(){var a=this.handlers.mouseleave;this.isMouseLocked?this.isOutsideEngine=!0:(this.isHovering=!1,this.isCursorHidden&&this.showMouse(),this.setEventHandlersMouseLeave(),this.sendEventToHandlers(a))},
canvasOnMouseDown:function(a){var b=this.handlers.mouseenter;this.canvas.onmousedown=null;this.isHovering||(this.isHovering=!0,this.lastX=a.screenX,this.lastY=a.screenY,this.setEventHandlersMouseEnter(),this.sendEventToHandlers(b),this.onMouseDown(a));return!1},onFullscreenChanged:function(){this.isMouseLocked&&(document.fullscreenEnabled||document.mozFullScreen||document.webkitIsFullScreen?(this.ignoreNextMouseMoves=2,this.requestBrowserLock()):this.unlockMouse())},setEventHandlersMouseEnter:function(){this.isFocused()||
this.addInternalEventListener(window,"mousedown",this.onMouseDown);this.addInternalEventListener(window,"mouseup",this.onMouseUp);this.addInternalEventListener(window,"mousemove",this.onMouseOver);this.addInternalEventListener(window,"DOMMouseScroll",this.onWheel);this.addInternalEventListener(window,"mousewheel",this.onWheel);this.addInternalEventListener(window,"click",this.emptyEvent)},setEventHandlersMouseLeave:function(){this.isFocused()||this.removeInternalEventListener(window,"mousedown",this.onMouseDown);
this.removeInternalEventListener(window,"mousemove",this.onMouseOver);this.removeInternalEventListener(window,"DOMMouseScroll",this.onWheel);this.removeInternalEventListener(window,"mousewheel",this.onWheel);this.removeInternalEventListener(window,"click",this.emptyEvent)},setEventHandlersFocus:function(){this.addInternalEventListener(window,"keydown",this.onKeyDown);this.addInternalEventListener(window,"keyup",this.onKeyUp)},setEventHandlersBlur:function(){this.removeInternalEventListener(window,
"keydown",this.onKeyDown);this.removeInternalEventListener(window,"keyup",this.onKeyUp);this.removeInternalEventListener(window,"mousedown",this.onMouseDown)},setEventHandlersLock:function(){this.removeInternalEventListener(window,"mousemove",this.onMouseOver);this.addInternalEventListener(window,"mousemove",this.onMouseMove);this.addInternalEventListener(window,"fullscreenchange",this.onFullscreenChanged);this.addInternalEventListener(window,"mozfullscreenchange",this.onFullscreenChanged);this.addInternalEventListener(window,
"webkitfullscreenchange",this.onFullscreenChanged)},setEventHandlersUnlock:function(){this.removeInternalEventListener(window,"webkitfullscreenchange",this.onFullscreenChanged);this.removeInternalEventListener(window,"mozfullscreenchange",this.onFullscreenChanged);this.removeInternalEventListener(window,"fullscreenchange",this.onFullscreenChanged);this.removeInternalEventListener(window,"mousemove",this.onMouseMove);this.addInternalEventListener(window,"mousemove",this.onMouseOver)},setEventHandlersCanvas:function(){var a=
this.canvas;this.addInternalEventListener(a,"mouseover",this.canvasOnMouseOver);this.addInternalEventListener(a,"mouseout",this.canvasOnMouseOut);this.addInternalEventListener(a,"mousedown",this.canvasOnMouseDown)},setEventHandlersWindow:function(){this.addInternalEventListener(window,"blur",this.onBlur);this.addInternalEventListener(window,"focus",this.onWindowFocus)},removeEventHandlersWindow:function(){this.removeInternalEventListener(window,"blur",this.onBlur);this.removeInternalEventListener(window,
"focus",this.onWindowFocus)},setEventHandlersTouch:function(){var a=this.canvas;this.addInternalEventListener(a,"touchstart",this.onTouchStart);this.addInternalEventListener(a,"touchend",this.onTouchEnd);this.addInternalEventListener(a,"touchenter",this.onTouchEnter);this.addInternalEventListener(a,"touchleave",this.onTouchLeave);this.addInternalEventListener(a,"touchmove",this.onTouchMove);this.addInternalEventListener(a,"touchcancel",this.onTouchCancel)},addInternalEventListener:function(a,b,c){var d=
this.elementEventFlags[a];d||(this.elementEventFlags[a]=d={});d[b]||(d[b]=!0,(d=this.boundFunctions[c])||(this.boundFunctions[c]=d=c.bind(this)),a.addEventListener(b,d,!1))},removeInternalEventListener:function(a,b,c){var d=this.elementEventFlags[a];d&&d[b]&&(d[b]=!1,a.removeEventListener(b,this.boundFunctions[c],!1))},destroy:function(){this.isLocked()&&this.setEventHandlersUnlock();this.isHovering&&this.setEventHandlersMouseLeave();this.isWindowFocused&&this.setEventHandlersBlur();this.removeEventHandlersWindow();
var a=this.canvas;a.onmouseover=null;a.onmouseout=null;a.onmousedown=null},isSupported:function(a){var b=this.canvas;if(b&&"POINTER_LOCK"===a){var a=document.fullscreenEnabled||document.mozFullScreen||document.webkitIsFullScreen,a=0<=window.navigator.userAgent.indexOf("Chrome")||a,c="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,b=b.requestPointerLock||b.mozRequestPointerLock||b.webkitRequestPointerLock;if(a&&c&&b)return!0}return!1}};Rd.create=
function(a){var b=new Rd;b.lastX=0;b.lastY=0;b.touches={};b.boundFunctions={};b.elementEventFlags={};b.canvas=a;b.isMouseLocked=!1;b.isHovering=!1;b.isWindowFocused=!1;b.isCursorHidden=!1;b.isOutsideEngine=!1;b.previousCursor="";b.ignoreNextMouseMoves=0;b.pressedKeys={};b.handlers={keydown:[],keyup:[],mousedown:[],mouseup:[],mousewheel:[],mouseover:[],mousemove:[],paddown:[],padup:[],padmove:[],mouseenter:[],mouseleave:[],focus:[],blur:[],mouselocklost:[],touchstart:[],touchend:[],touchenter:[],touchleave:[],
touchmove:[],touchcancel:[]};var c={},d=b.keyCodes,f;for(f in d)d.hasOwnProperty(f)&&(c[d[f]]=f);c[d.SPACE]=" ";c[d.NUMBER_0]="0";c[d.NUMBER_1]="1";c[d.NUMBER_2]="2";c[d.NUMBER_3]="3";c[d.NUMBER_4]="4";c[d.NUMBER_5]="5";c[d.NUMBER_6]="6";c[d.NUMBER_7]="7";c[d.NUMBER_8]="8";c[d.NUMBER_9]="9";c[d.GRAVE]="`";c[d.MINUS]="-";c[d.EQUALS]="=";c[d.LEFT_BRACKET]="[";c[d.RIGHT_BRACKET]="]";c[d.SEMI_COLON]=";";c[d.APOSTROPHE]="'";c[d.COMMA]=",";c[d.PERIOD]=".";c[d.SLASH]="/";c[d.BACKSLASH]="\\";d={65:0,66:1,
67:2,68:3,69:4,70:5,71:6,72:7,73:8,74:9,75:10,76:11,77:12,78:13,79:14,80:15,81:16,82:17,83:18,84:19,85:20,86:21,87:22,88:23,89:24,90:25,48:100,49:101,50:102,51:103,52:104,53:105,54:106,55:107,56:108,57:109,37:200,39:201,38:202,40:203,16:300,17:302,18:304,"0":305,27:400,9:401,32:402,8:403,13:404,223:500,173:501,189:501,61:502,187:502,219:503,221:504,59:505,186:505,192:500,188:507,190:508,222:506};-1!==navigator.appVersion.indexOf("Mac")&&(d[0]=500);d[112]=600;d[113]=601;d[114]=602;d[115]=603;d[116]=
604;d[117]=605;d[118]=606;d[119]=607;d[120]=608;d[121]=609;d[122]=610;d[123]=611;d[96]=612;d[97]=613;d[98]=614;d[99]=615;d[100]=616;d[12]=617;d[101]=617;d[144]=617;d[102]=618;d[103]=619;d[104]=620;d[105]=621;d[111]=623;d[191]=623;d[106]=624;d[107]=625;d[109]=626;d[91]=627;d[224]=627;d[92]=628;d[93]=628;d[20]=631;d[45]=632;d[46]=633;d[36]=634;d[35]=635;d[33]=636;d[34]=637;b.keyMap=d;b.mouseMap={"0":0,1:2,2:1};d={"0":4,1:5,2:6,3:7,4:10,5:11,8:19,9:18,10:12,11:15,12:0,13:2,14:1,15:3};b.padMap=d;b.keyCodeToUnicode=
c;b.padButtons=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];b.padMap=d;b.padAxisDeadZone=0.26;b.maxAxisRange=1;b.padTimestampUpdate=0;var g=a.requestPointerLock||a.mozRequestPointerLock||a.webkitRequestPointerLock;if(g){var h=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock;b.requestBrowserLock=function(){(document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement)!==a&&g.call(a)};b.requestBrowserUnlock=function(){(document.pointerLockElement||
document.mozPointerLockElement||document.webkitPointerLockElement)===a&&h.call(document)}}else{var n=navigator.pointer||navigator.webkitPointer;n?(b.requestBrowserLock=function(){n.isLocked||n.lock(a)},b.requestBrowserUnlock=function(){n.isLocked&&n.unlock()}):(b.requestBrowserLock=function(){},b.requestBrowserUnlock=function(){})}b.setEventHandlersCanvas();b.setEventHandlersWindow();b.setEventHandlersTouch();c=TurbulenzEngine.getSystemInfo();b.macosx="Darwin"===c.osName;b.webkit=/WebKit/.test(navigator.userAgent);
return b};WebGLMathDevice=w;var Sc=function(){};Sc.prototype.createWebSocket=function(a,b){var c=this.WebSocketConstructor;return c?(c=b?new c(a,b):new c(a),"undefined"===typeof c.destroy&&(c.destroy=function(){this.onmessage=this.onclose=this.onerror=this.onopen=null;this.close()}),c):null};Sc.prototype.update=function(){};Sc.create=function(){return new Sc};Sc.version=1;Sc.prototype.WebSocketConstructor=window.WebSocket?window.WebSocket:window.MozWebSocket;var Vb=function(){};Vb.version=1;Ej=2*
0.245*0.245;Lc=1E-4;Fj=Math.PI;Mc=1E-16;var Mj=function(a,b){for(var c in b)if(b.hasOwnProperty(c)){var d=b[c];null===d||void 0===d||("object"===typeof d&&("shape"!==c&&"userData"!==c&&"world"!==c&&"object"!==c&&"arbiters"!==c&&"islandRoot"!==c&&"island"!==c&&"bodyA"!==c&&"bodyB"!==c&&"triangleArray"!==c)&&(d="slice"in d?d.slice():Mj({},d)),a[c]=d)}return a},xc=function(a,b,c){c||Object.defineProperty(a,"margin",{get:function(){return this._private.collisionRadius},set:function(a){var b=this._private;
b.halfExtents[0]+=a-b.collisionRadius;b.halfExtents[1]+=a-b.collisionRadius;b.halfExtents[2]+=a-b.collisionRadius;b.radius+=a-b.collisionRadius;b.collisionRadius=a},enumerable:!0});Object.defineProperty(a,"halfExtents",{get:function(){return w.v3Copy(this._private.halfExtents)},enumerable:!0});Object.defineProperty(a,"inertia",{get:function(){return w.v3Copy(this._private.inertia)},enumerable:!0});Object.defineProperty(a,"radius",{get:function(){return this._private.radius},enumerable:!0});Object.defineProperty(a,
"type",{value:b,enumerable:!0})},Ad=function(){};Ad.prototype.rayTest=function(a){var b=a.direction,c=a.origin,d=b[0],f=b[1],b=b[2],g=c[0],h=c[1],c=c[2],n=this.normal,j=n[0],e=n[1],n=n[2],l=d*j+f*e+b*n;if(l*l<Mc)return null;var m=(this.distance-(g*j+h*e+c*n))/l;return 0<=m&&m<=a.maxFactor?(0<l&&(j=-j,e=-e,n=-n),{factor:m,hitPoint:w.v3Build(g+d*m,h+f*m,c+b*m),hitNormal:w.v3Build(j,e,n)}):null};Ad.create=function(a){var b=new Vb,c=new Ad;b._private=c;c._public=b;c.collisionRadius=void 0!==a.margin?
a.margin:0.04;c.distance=a.distance;var a=c.normal=w.v3Copy(a.normal),d=Math.abs,f=Number.MAX_VALUE;c.radius=f;1===d(a[0])?c.halfExtents=w.v3Build(d(c.distance),f,f):1===d(a[1])?c.halfExtents=w.v3Build(f,d(c.distance),f):1===d(a[2])&&(c.halfExtents=w.v3Build(f,f,d(c.distance)));c.center=void 0;c.inertia=w.v3BuildZero();xc(b,"PLANE");return b};Ad.version=1;Ad.prototype.type="PLANE";var yc=function(){};yc.prototype.rayTestCap=function(a,b,c){var d=a.origin,f=a.direction,g=d[0],h=d[1],d=d[2],n=f[0],
j=f[1],e=f[2],f=this.capsuleRadius,l=n*n+j*j+e*e,m=h-b,q=2*(n*g+j*m+e*d),p=q*q-4*l*(g*g+m*m+d*d-f*f);if(0>p)return null;var m=1,s=1/(2*l),p=Math.sqrt(p),q=(-q-p)*s,l=h+j*q;if(0>q||0>c*(l-b))q+=2*p*s,l=h+j*q,m=-1;return 0<=c*(l-b)&&0<=q&&q<=a.maxFactor?(a=g+n*q,c=d+e*q,g=m/f,{factor:q,hitPoint:w.v3Build(a,l,c),hitNormal:w.v3Build(a*g,(l-b)*g,c*g)}):null};yc.prototype.rayTest=function(a){var b=a.origin,c=a.direction,d=b[0],f=b[1],b=b[2],g=c[0],h=c[1],n=c[2],j=a.maxFactor,c=this.capsuleRadius,e=this.halfHeight,
l=c*c,m,q=1,p=g*g+n*n;if(1E-8<=p){var s=2*(d*g+b*n),l=s*s-4*p*(d*d+b*b-l),p=1/(2*p);1E-8>l?m=-s*p:0<l&&(l=Math.sqrt(l),m=(-s-l)*p,0>m&&(m+=2*l*p,q=-1));f+=h*m;if(-e<=f&&f<=e)return 0<=m&&m<=j?(a=d+g*m,d=b+n*m,b=q/c,{factor:m,hitPoint:w.v3Build(a,f,d),hitNormal:w.v3Build(a*b,0,d*b)}):null}return this.rayTestCap(a,e,1)||this.rayTestCap(a,-e,-1)};yc.prototype.localSupportWithoutMargin=function(a,b){b[0]=0;b[1]=0<=a[1]?this.halfHeight:-this.halfHeight;b[2]=0};yc.create=function(a){var b=new Vb,c=new yc;
b._private=c;c._public=b;var d=void 0!==a.margin?a.margin:0.04,f=a.radius,a=0.5*a.height,g=f+a,h=f+d,n=g+d,j=f+d,e=2*h,l=2*n,m=2*j,e=e*e,l=l*l,m=m*m,q=1/12;c.radius=g+d;c.capsuleRadius=f;c.halfHeight=a;c.halfExtents=w.v3Build(h,n,j);c.inertia=w.v3Build(q*(l+m),q*(e+m),q*(e+l));c.collisionRadius=f+d;c.center=void 0;Object.defineProperty(b,"margin",{get:function(){return this._private.collisionRadius-this._private.capsuleRadius},set:function(a){var b=this._private;b.collisionRadius=b.capsuleRadius+
a;b.halfExtents[0]=b.capsuleRadius+a;b.halfExtents[1]=b.capsuleRadius+b.halfHeight+a;b.halfExtents[2]=b.capsuleRadius+a;b.radius=b.capsuleRadius+b.halfHeight+a},enumerable:!0});xc(b,"CAPSULE",!0);return b};yc.version=1;Vb.prototype.type="CAPSULE";var Tc=function(){};Tc.prototype.rayTest=function(a){var b=a.origin,c=a.direction,d=this.sphereRadius,f=c[0],g=c[1],c=c[2],h=b[0],n=b[1],j=b[2],e=f*f+g*g+c*c,l=2*(h*f+n*g+j*c),m=l*l-4*e*(h*h+n*n+j*j-d*d);if(0>=m)return null;b=1;e=1/(2*e);m=Math.sqrt(m);l=
(-l-m)*e;0>l&&(l+=2*m*e,b=-1);return 0<=l&&l<a.maxFactor?(a=h+f*l,g=n+g*l,c=j+c*l,d=b/d,{factor:l,hitPoint:w.v3Build(a,g,c),hitNormal:w.v3Build(a*d,g*d,c*d)}):null};Tc.prototype.localSupportWithoutMargin=function(a,b){b[0]=b[1]=b[2]=0};Tc.create=function(a){var b=new Vb,c=new Tc;b._private=c;c._public=b;var d=void 0!==a.margin?a.margin:0.04,a=a.radius,f=0.4*a*a;c.sphereRadius=a;c.radius=c.sphereRadius+d;c.collisionRadius=a+d;c.halfExtents=w.v3Build(a+d,a+d,a+d);c.inertia=w.v3Build(f,f,f);c.center=
void 0;Object.defineProperty(b,"margin",{get:function(){return this._private.collisionRadius-this._private.radius},set:function(a){var b=this._private;b.collisionRadius=b.radius+a;b.halfExtents[0]=b.collisionRadius;b.halfExtents[1]=b.collisionRadius;b.halfExtents[2]=b.collisionRadius;b.radius=b.collisionRadius},enumerable:!0});xc(b,"SPHERE",!0);return b};Tc.version=1;Tc.prototype.type="SPHERE";var Uc=function(){};Uc.prototype.rayTest=function(a){var b=a.origin,c=a.direction,d=b[0],f=b[1],b=b[2],g=
c[0],h=c[1],c=c[2],n=this.halfExtents,j=n[0],e=n[1],n=n[2],l,m,q,p,s;if(0!==g&&(0<g&&d<=-j||0>g&&d>=j))if(q=((0<g?d>=-j?j:-j:d<=j?-j:j)-d)/g,void 0===l||q<l)p=f+h*q,s=b+c*q,-e<=p&&p<=e&&(-n<=s&&s<=n)&&(l=q,m=0);if(0!==h&&(0<h&&f<=-e||0>h&&f>=e))if(q=((0<h?f>=-e?e:-e:f<=e?-e:e)-f)/h,void 0===l||q<l)p=d+g*q,s=b+c*q,-j<=p&&p<=j&&(-n<=s&&s<=n)&&(l=q,m=1);if(0!==c&&(0<c&&b<=-n||0>c&&b>=n))if(q=((0<c?b>=-n?n:-n:b<=n?-n:n)-b)/c,void 0===l||q<l)p=f+h*q,s=d+g*q,-e<=p&&p<=e&&(-j<=s&&s<=j)&&(l=q,m=2);return void 0!==
l&&l<a.maxFactor?{hitPoint:w.v3Build(d+g*l,f+h*l,b+c*l),hitNormal:w.v3Build(0===m?0<g?-1:1:0,1===m?0<h?-1:1:0,2===m?0<c?-1:1:0),factor:l}:null};Uc.prototype.localSupportWithoutMargin=function(a,b){var c=a[1],d=a[2],f=this.halfExtents,g=f[0],h=f[1],f=f[2];b[0]=0>a[0]?-g:g;b[1]=0>c?-h:h;b[2]=0>d?-f:f};Uc.create=function(a){var b=new Vb,c=new Uc;b._private=c;c._public=b;var d=void 0!==a.margin?a.margin:0.04,f=a.halfExtents,a=f[0]+d,g=f[1]+d,f=f[2]+d,h=2*a,n=2*g,j=2*f,h=h*h,n=n*n,j=j*j;c.center=void 0;
c.radius=Math.sqrt(a*a+g*g+f*f);c.halfExtents=w.v3Build(a,g,f);c.inertia=w.v3Build(1/12*(n+j),1/12*(h+j),1/12*(h+n));c.collisionRadius=d;xc(b,"BOX");return b};Uc.version=1;Uc.prototype.type="BOX";var Vc=function(){};Vc.prototype.rayTest=function(a){var b=a.origin,c=a.direction,d=b[0],f=b[1],b=b[2],g=c[0],h=c[1],c=c[2],n=a.maxFactor,j=this.cylinderRadius,e=this.halfHeight,a=j*j,l=g*g+c*c,m=2*(d*g+b*c),q=1,p;p=m*m-4*l*(d*d+b*b-a);return 0<=p&&(l=1/(2*l),p=Math.sqrt(p),m=(-m-p)*l,0>m&&(m+=2*p*l,q=-1),
p=f+h*m,-e<=p&&p<=e)?0<=m&&m<=n?(d+=g*m,f=b+c*m,j=q/j,{factor:m,hitPoint:w.v3Build(d,p,f),hitNormal:w.v3Build(d*j,0,f*j)}):null:h*h>=Mc&&(j=0>h?-1:1,p=-j*e,l=1/h,m=(p-f)*l,0>m&&(p=j*e,m=(p-f)*l),0<=m&&m<=n&&(d+=g*m,f=b+c*m,d*d+f*f<=a))?{factor:m,hitPoint:w.v3Build(d,p,f),hitNormal:w.v3Build(0,-j,0)}:null};Vc.prototype.localSupportWithoutMargin=function(a,b){var c=a[0],d=a[2],f=c*c+d*d;0===f?0<a[1]?(b[0]=this.cylinderRadius,b[1]=this.halfHeight,b[2]=0):(b[0]=0,b[1]=-this.halfHeight,b[2]=-this.cylinderRadius):
(f=this.cylinderRadius/Math.sqrt(f),b[0]=c*f,b[1]=(0<a[1]?1:-1)*this.halfHeight,b[2]=d*f)};Vc.create=function(a){var b=new Vb,c=new Vc;b._private=c;c._public=b;var d=void 0!==a.margin?a.margin:0.04,a=a.halfExtents,f=a[0]+d,g=a[1]+d,h=a[2]+d,n=f*f,j=1/12*4*g*g+0.25*n,n=0.5*n;c.center=void 0;c.radius=Math.sqrt(f*f+g*g+h*h);c.halfExtents=w.v3Build(f,g,h);c.cylinderRadius=a[0];c.halfHeight=a[1];c.inertia=w.v3Build(j,n,j);c.collisionRadius=d;xc(b,"CYLINDER");return b};Vc.version=1;Vc.prototype.type="CYLINDER";
var Wc=function(){};Wc.prototype.rayTest=function(a){var b=a.origin,c=a.direction,d=b[0],f=b[1],b=b[2],g=c[0],h=c[1],c=c[2],n=a.maxFactor,j=this.coneRadius,e=this.halfHeight,l=j/(2*e),l=l*l,m=f-e,q=g*g+c*c-l*h*h,p=2*(d*g+b*c-l*m*h),s,a=1,m=p*p-4*q*(d*d+b*b-l*m*m);if(0<=m&&(q=1/(2*q),m=Math.sqrt(m),s=(-p-m)*q,p=f+h*s,0>s||p<-e||p>e))if(s+=2*m*q,a=-1,p=f+h*s,0>s||p<-e||p>e)s=void 0;var i;if(0!==h&&(i=(-e-f)/h,q=d+g*i,m=b+c*i,0>i||q*q+m*m>j*j))i=void 0;if(void 0===i&&void 0===s)return null;if(void 0===
i||void 0!==s&&s<i){if(s>=n)return null;q=d+g*s;p=f+h*s;m=b+c*s;d=l*(p-e);f=a/Math.sqrt(q*q+d*d+m*m);return{hitPoint:w.v3Build(q,p,m),hitNormal:w.v3Build(f*q,f*d,f*m),factor:s}}return i>=n?null:{hitPoint:w.v3Build(d+g*i,f+h*i,b+c*i),hitNormal:w.v3Build(0,f<-e?-1:1,0),factor:i}};Wc.prototype.localSupportWithoutMargin=function(a,b){var c=a[0],d=a[1],f=a[2],g=Math.sqrt(c*c+f*f);0<-this.coneRadius*g+2*this.halfHeight*d?(b[0]=b[2]=0,b[1]=this.halfHeight):(0===g?(b[0]=this.coneRadius,b[2]=0):(b[0]=c*this.coneRadius/
g,b[2]=f*this.coneRadius/g),b[1]=-this.halfHeight)};Wc.create=function(a){var b=new Vb,c=new Wc;b._private=c;c._public=b;var d=void 0!==a.margin?a.margin:0.04,f=a.radius,a=0.5*a.height,g=f+d,h=a+d,n=f+d,j=2*g,e=2*h,l=2*n,j=j*j,e=e*e,l=l*l,m=1/12;c.halfHeight=a;c.coneRadius=f;c.radius=Math.sqrt(g*g+h*h+n*n);c.halfExtents=w.v3Build(g,h,n);c.inertia=w.v3Build(m*(e+l),m*(j+l),m*(j+e));c.collisionRadius=d;c.center=void 0;xc(b,"CONE");return b};Wc.version=1;Wc.prototype.type="CONE";var we=function(){};
we.create=function(a){var b=new we,c=new zc;b._private=c;c._public=b;var d=a.vertices,f=d.length/3,g=a.indices,h=g.length/3,n=a.minExtent,j=a.maxExtent,e;if(!n||!j){for(var l=d[0],m=d[1],q=d[2],p=l,s=m,i=q,u=d.length,k=3;k<u;k+=3)e=d[k],n=d[k+1],j=d[k+2],l>e?l=e:p<e&&(p=e),m>n?m=n:s<n&&(s=n),q>j?q=j:i<j&&(i=j);n=[l,m,q];j=[p,s,i]}e=new Float32Array(6);e[0]=n[0];e[1]=n[1];e[2]=n[2];e[3]=j[0];e[4]=j[1];e[5]=j[2];c.vertices=a.dontCopy?d:new Float32Array(d);c.numVertices=f;c.indices=a.dontCopy?g:65536>
f?new Uint16Array(g):new Uint32Array(g);c.numTriangles=h;c.extents=e;Object.defineProperty(b,"vertices",{value:c.vertices,enumerable:!0});Object.defineProperty(b,"indices",{value:c.indices,enumerable:!0});a=new Float32Array(zc.prototype.TRIANGLE_SIZE*h);f=null;8<=h&&(f=xa.create(!0));for(p=0;p<h;p+=1){e=3*p;s=p*zc.prototype.TRIANGLE_SIZE;j=3*g[e];n=3*g[e+1];e=3*g[e+2];var i=d[j],l=d[j+1],m=d[j+2],q=d[n],u=d[n+1],k=d[n+2],B=d[e],y=d[e+1],v=d[e+2],x=q-i,J=u-l,C=k-m;e=B-i;var n=y-l,j=v-m,ka=J*j-C*n,
Q=C*e-x*j,t=x*n-J*e,w=1/Math.sqrt(ka*ka+Q*Q+t*t),K=(ka*i+Q*l+t*m)*w,A=x*e+J*n+C*j,N=x*x+J*J+C*C,da=e*e+n*n+j*j,va=A*A-N*da;a[s]=ka*w;a[s+1]=Q*w;a[s+2]=t*w;a[s+3]=i;a[s+4]=l;a[s+5]=m;a[s+6]=x;a[s+7]=J;a[s+8]=C;a[s+9]=e;a[s+10]=n;a[s+11]=j;a[s+12]=N;a[s+13]=da;a[s+14]=A;a[s+15]=va;a[s+16]=K;f&&(e=new Float32Array(6),e[0]=Math.min(i,q,B),e[1]=Math.min(l,u,y),e[2]=Math.min(m,k,v),e[3]=Math.max(i,q,B),e[4]=Math.max(l,u,y),e[5]=Math.max(m,k,v),f.add({index:s},e))}f&&f.finalize();c.triangles=a;c.spatialMap=
f;return b};we.version=1;var zc,xe=function(){};xe.prototype.rayTest=function(a){function b(a,b,d,f,g){var a=d.direction,h=a[0],n=a[1],j=a[2],d=d.origin,e=d[0],i=d[1],k=d[2],v=b.index,b=c[v],d=c[v+1],a=c[v+2],x=h*b+n*d+j*a;if(x*x<Mc)return null;var J=c[v+3],C=c[v+4],ka=c[v+5],f=(c[v+16]-(e*b+i*d+k*a))/x;if(0>f||f>=g)return null;0<x&&(b=-b,d=-d,a=-a);g=e+h*f;n=i+n*f;j=k+j*f;h=g-J;k=n-C;J=j-ka;C=c[v+14];ka=c[v+15];i=h*c[v+6]+k*c[v+7]+J*c[v+8];k=h*c[v+9]+k*c[v+10]+J*c[v+11];h=C*k-c[v+13]*i;if(0<h||h<
ka)return null;v=C*i-c[v+12]*k;return 0<v||h+v<ka?null:{factor:f,hitPoint:w.v3Build(g,n,j),hitNormal:w.v3Build(b,d,a)}}var c=this.triangles,d=this.spatialMap;if(d)return xa.rayTest([d],a,b);var d=null,f=a.maxFactor,g={index:0},h,n=this.numTriangles*xe.prototype.TRIANGLE_SIZE;for(h=0;h<n;h+=xe.prototype.TRIANGLE_SIZE){g.index=h;var j=b(null,g,a,0,f);j&&(d=j,f=d.factor)}return d};xe.version=1;zc=xe;zc.prototype.TRIANGLE_SIZE=17;var vi={isPlanar:function(a){for(var b=Mc,c=a[0],d=a[1],f=a[2],g=a[3]-c,
h=a[4]-d,n=a[5]-f,j=a[6]-c,e=a[7]-d,l=a[8]-f,m=h*l-n*e,n=n*j-g*l,g=g*e-h*j,h=1/Math.sqrt(m*m+n*n+g*g),m=m*h,n=n*h,g=g*h,c=-(c*m+d*n+f*g),f=a.length,d=0;d<f;d+=3)if(h=a[d]*m+a[d+1]*n+a[d+2]*g+c,h*h>b)return!1;return!0},makePlanarConvexHull:function(a){var b=a[0],c=a[1],d=a[2],f=a[3]-b,g=a[4]-c,h=a[5]-d,n=a[6]-b,c=a[7]-c,b=a[8]-d,d=g*b-h*c,h=h*n-f*b,f=f*c-g*n,j;1E-6>d*d+f*f?(c=1,b=j=0):(c=-f,b=0,j=d);for(var e=h*j-f*b,l=f*c-d*j,m=d*b-h*c,d=a.length/3,h=new Float32Array(2*d),q,n=0;n<d;n+=1)f=a[3*n],
g=a[3*n+1],q=a[3*n+2],h[2*n]=f*c+g*b+q*j,h[2*n+1]=f*e+g*l+q*m;j=0;b=h[0];c=h[1];for(n=2;n<2*d;n+=2)if(f=h[n],g=h[n+1],f<b||f===b&&g<c)j=n/2,b=f,c=g;e={};e[j]=0;l=1;m=[];for(q=j;;){for(var p,s,i,u=-1,n=0;n<2*d;n+=2)if(n!==2*j){var f=h[n],g=h[n+1],k=(f-b)*(f-b)+(g-c)*(g-c);if(-1===u)u=n/2,p=f,s=g,i=k;else{var B=(p-b)*(g-c)-(s-c)*(f-b);if(0>B||0===B&&k>i)u=n/2,p=f,s=g,i=k}}if(u in e)break;e[u]=l;l+=1;j!==q&&(m.push(q),m.push(j),m.push(u));j=u;b=h[2*u];c=h[2*u+1]}return this.createArray(a,m,e,l)},makeConvexHull:function(a){var b=
0,c=a[0],d=a[1],f=a[2],g,h,n,j,e=a.length/3;for(g=3;g<3*e;g+=3)if(h=a[g],n=a[g+1],j=a[g+2],h<c||h===c&&(n<d||n===d&&j<f))b=g/3,c=h,d=n,f=j;var l=-1,f=-2,m=0;for(g=0;g<3*e;g+=3)if(g!==3*b){h=a[g];n=a[g+1];h-=c;n-=d;var q=h*h+n*n;if(0===q)-1===l&&(l=g/3);else{var p=n/Math.sqrt(q);if(p>f||p===f&&q>m)f=p,m=q,l=g/3}}m={};q=[b,l,l,b];p={};p[b]=0;p[l]=1;for(var s=2,i=[];0<q.length;)if(l=q.pop(),b=q.pop(),!(b+":"+l in m)){var k=-1,z,B,y,v,x,c=a[3*b],d=a[3*b+1],f=a[3*b+2],J=a[3*l]-c,C=a[3*l+1]-d,ka=a[3*l+
2]-f,Q=1/(J*J+C*C*ka*ka);for(g=0;g<3*e;g+=3)if(!(g===3*b||g===3*l)){h=a[g];n=a[g+1];j=a[g+2];var t=((h-c)*J+(n-d)*C+(j-f)*ka)*Q,w=h-(c+J*t),K=n-(d+C*t),A=j-(f+ka*t),N=w*w+K*K+A*A;if(!(1E-10>=N))if(-1===k)k=g/3,z=w,B=K,y=A,v=N,x=t;else{var da=K*y-A*B,va=A*z-w*y,E=w*B-K*z,F=w*(C*y-ka*B)+K*(ka*z-J*y)+A*(J*B-C*z);if(F*F<Mc)if(0<=w*z+K*B+A*y){if(N>v||N===v&&t>x)k=g/3,z=w,B=K,y=A,v=N,x=t}else{h-=c;n-=d;va=j-f;da=n*ka-va*C;va=va*J-h*ka;E=h*C-n*J;n=!0;for(h=0;h<3*e;h+=3)if(0>da*(a[h]-c)+va*(a[h+1]-d)+E*(a[h+
2]-f)){n=!1;break}n&&(k=g/3,z=w,B=K,y=A,v=N,x=t)}else if(da=da*J+va*C+E*ka,0>da||1E-10>=da&&N>v)k=g/3,z=w,B=K,y=A,v=N,x=t}}k in p||(p[k]=s,s+=1);b+":"+l in m||(l+":"+k in m||k+":"+b in m)||(i.push(b),i.push(l),i.push(k),m[b+":"+l]=!0,m[l+":"+k]=!0,m[k+":"+b]=!0,q.push(k),q.push(l),q.push(b),q.push(k))}return this.createArray(a,i,p,s)},createArray:function(a,b,c,d){var f=new Float32Array(3*d),g=b.length,d=65536>d?new Uint16Array(g):new Uint32Array(g),h=a.length/3,n;for(n=0;n<h;n+=1)if(n in c){var j=
3*c[n];f[j]=a[3*n];f[j+1]=a[3*n+1];f[j+2]=a[3*n+2]}for(n=0;n<g;n+=1)d[n]=c[b[n]];return we.create({vertices:f,indices:d,dontCopy:!0})._private}},Bd=function(){};Bd.prototype.rayTest=function(a){return this.triangleArray.rayTest(a)};Bd.create=function(a){var b=new Vb,c=new Bd;b._private=c;c._public=b;var d=void 0!==a.margin?a.margin:0.04,a=a.triangleArray._private,f=a.extents,g=f[0],h=f[1],n=f[2],j=f[3],e=f[4],l=f[5],f=0.5*(j-g)+d,m=0.5*(e-h)+d,q=0.5*(l-n)+d,g=0.5*(g+j),h=0.5*(h+e),n=0.5*(n+l);c.triangleArray=
a;c.radius=Math.sqrt(f*f+m*m+q*q);c.halfExtents=w.v3Build(f,m,q);c.center=0!==g||0!==h||0!==n?w.v3Build(g,h,n):void 0;c.inertia=w.v3Build(0,0,0);c.collisionRadius=d;xc(b,"TRIANGLE_MESH");Object.defineProperty(b,"triangleArray",{get:function(){return this._private.triangleArray},enumerable:!0});return b};Bd.version=1;Bd.prototype.type="TRIANGLE_MESH";var Xc=function(){};Xc.prototype.rayTest=function(a){var b=this.triangleArray;return void 0===b?null:b.rayTest(a)};Xc.prototype.localSupportWithoutMargin=
function(a,b){var c=a[0],d=a[1],f=a[2],g=this.supportTopology,h=this.triangleArray.vertices;void 0===this.lastSupport&&(this.lastSupport=0);for(var n=this.lastSupport,j=g[n],e=h[j]*c+h[j+1]*d+h[j+2]*f;;){var l=-1,m,q=g[n+1];for(m=0;m<q;m+=1){var p=g[n+2+m],j=g[p],j=h[j]*c+h[j+1]*d+h[j+2]*f;j>e&&(e=j,l=p)}if(-1!==l)n=l;else break}this.lastSupport=n;j=g[n];b[0]=h[j];b[1]=h[j+1];b[2]=h[j+2]};Xc.create=function(a){var b=new Vb,c=new Xc;b._private=c;c._public=b;var d=void 0!==a.margin?a.margin:0.04,a=
a.points,f=a[0],g=a[1],h=a[2],n=f,j=g,e=h,l=a.length,m,q,p,s;for(m=3;m<l;m+=3)q=a[m],p=a[m+1],s=a[m+2],f>q?f=q:n<q&&(n=q),g>p?g=p:j<p&&(j=p),h>s?h=s:e<s&&(e=s);l=0.5*(n-f)+d;m=0.5*(j-g)+d;q=0.5*(e-h)+d;p=0.5*(f+n);g=0.5*(g+j);h=0.5*(h+e);e=2*l;j=2*m;s=2*q;e*=e;j*=j;s*=s;f=1/12;c.points=new Float32Array(a);c.radius=Math.sqrt(l*l+m*m+q*q);c.halfExtents=w.v3Build(l,m,q);c.center=0!==p||0!==g||0!==h?w.v3Build(p,g,h):void 0;c.inertia=w.v3Build(f*(j+s),f*(e+s),f*(e+j));c.collisionRadius=d;if(9>a.length)throw"At present time, WebGL PhysicsDevice does not permit a convex hull to contain less than 3 vertices";
e=vi.isPlanar(a);c.triangleArray=e?vi.makePlanarConvexHull(a):vi.makeConvexHull(a);d=[];a=c.triangleArray.vertices;l=a.length;for(m=0;m<l;m+=3)d[m/3]=[];if(e)for(m=0;m<l/3;m+=1)h=(m+1)%(l/3),d[m].push(h),d[h].push(m);else{h=c.triangleArray.indices;l=h.length;for(m=0;m<l;m+=3)q=h[m],g=h[m+1],j=h[m+2],d[q].push(g),d[g].push(j),d[j].push(q)}l=a.length;if(e&&18<=l||!e&&30<=l)for(m=0;m<l;m+=3){e=Number.MAX_VALUE;q=a[m];p=a[m+1];s=a[m+2];for(var i,h=0;h<l;h+=3)g=q*a[h]+p*a[h+1]+s*a[h+2],g<e&&(e=g,i=h);
d[m/3].push(i/3)}i=[];for(m=a=0;m<l/3;m+=1)i.push(a),a+=d[m].length+2;c.supportTopology=65536<a?new Int32Array(a):new Int16Array(a);for(m=a=0;m<l/3;m+=1){c.supportTopology[a]=3*m;a+=1;e=d[m];c.supportTopology[a]=e.length;a+=1;for(h=0;h<e.length;h+=1)c.supportTopology[a]=i[e[h]],a+=1}xc(b,"CONVEX_HULL");return b};Xc.version=1;Xc.prototype.type="CONVEX_HULL";var kc,cb=function(a,b){this._public=b;this.id=cb.uniqueId;cb.uniqueId+=1;this.world=null;this.shape=a.shape._private;this.friction=void 0!==a.friction?
a.friction:0.5;this.restitution=void 0!==a.restitution?a.restitution:0;var c=a.transform;this.transform=c?w.m43Copy(c):w.m43BuildIdentity();this.arbiters=[];this.constraints=[];this.velocity=new Float32Array(12);if(c=a.linearVelocity)this.velocity[0]=c[0],this.velocity[1]=c[1],this.velocity[2]=c[2];if(c=a.angularVelocity)this.velocity[3]=c[0],this.velocity[4]=c[1],this.velocity[5]=c[2];this.linearDamping=void 0!==a.linearDamping?a.linearDamping:0;this.angularDamping=void 0!==a.angularDamping?a.angularDamping:
0;this.extents=new Float32Array(6);this.startTransform=w.m43BuildIdentity();this.endTransform=w.m43BuildIdentity();this.prevTransform=w.m43Copy(this.transform);this.newTransform=w.m43BuildIdentity();this.island=null;this.islandRoot=this;this.islandRank=0;this.delaySleep=!0;this.mask=this.group=0;this.fixedRotation=this.kinematic=!1;this.inverseMass=this.mass=0;this.inverseInertia=this.inverseInertiaLocal=null;this.active=this.sweepFrozen=this.permitSleep=this.collisionObject=!1;this.contactCallbacks=
null};cb.prototype.computeDeltaVelocity=function(a,b,c,d){var d=d||this.velocity,f=!1;d[0]=c[9]-b[9];d[1]=c[10]-b[10];d[2]=c[11]-b[11];if(0!==d[0]||0!==d[1]||0!==d[2])f=!0;d[0]/=a;d[1]/=a;d[2]/=a;var g=b[0]*c[0]+b[3]*c[3]+b[6]*c[6],h=b[0]*c[1]+b[3]*c[4]+b[6]*c[7],n=b[0]*c[2]+b[3]*c[5]+b[6]*c[8],j=b[1]*c[0]+b[4]*c[3]+b[7]*c[6],e=b[1]*c[1]+b[4]*c[4]+b[7]*c[7],l=b[1]*c[2]+b[4]*c[5]+b[7]*c[8],m=b[2]*c[0]+b[5]*c[3]+b[8]*c[6],q=b[2]*c[1]+b[5]*c[4]+b[8]*c[7],b=b[2]*c[2]+b[5]*c[5]+b[8]*c[8],c=g+e+b+1;c>w.precision?
(b=Math.sqrt(c)/2,g=(l-q)/(4*b),e=(m-n)/(4*b),h=(h-j)/(4*b)):g>e&&g>b?(c=2*Math.sqrt(1+g-e-b),b=(l-q)/c,g=0.25*c,e=(j+h)/c,h=(m+n)/c):e>b?(c=2*Math.sqrt(1+e-g-b),b=(m-n)/c,g=(j+h)/c,e=0.25*c,h=(q+l)/c):(c=2*Math.sqrt(1+b-g-e),b=(h-j)/c,g=(m+n)/c,e=(q+l)/c,h=0.25*c);n=2*Math.acos(b);j=1-b*b;j<w.precision||0===n?d[3]=d[4]=d[5]=0:(a=n/(a*Math.sqrt(j)),d[3]=g*a,d[4]=e*a,d[5]=h*a,f=!0);return f};cb.prototype.calculateSweptExtents=function(a){var b=this.shape.radius,c=this.startTransform,d=c[9],f=c[10],
c=c[11],g=this.transform,h=g[9],n=g[10],g=g[11],j;d>h&&(j=d,d=h,h=j);f>n&&(j=f,f=n,n=j);c>g&&(j=c,c=g,g=j);a[0]=d-b;a[1]=f-b;a[2]=c-b;a[3]=h+b;a[4]=n+b;a[5]=g+b};cb.prototype.calculateExtents=function(a){var b=this.shape,c=b.center,d=b.halfExtents,b=d[0],f=d[1],g=d[2],h=this.transform,n=h[0],j=h[1],e=h[2],l=h[3],m=h[4],q=h[5],p=h[6],s=h[7],i=h[8],d=h[9],k=h[10],h=h[11];if(c){var z=c[0],B=c[1],c=c[2];if(0!==z||0!==B||0!==c)d+=n*z+l*B+p*c,k+=j*z+m*B+s*c,h+=e*z+q*B+i*c}c=(0>n?-n*b:0<n?n*b:0)+(0>l?-l*
f:0<l?l*f:0)+(0>p?-p*g:0<p?p*g:0);j=(0>j?-j*b:0<j?j*b:0)+(0>m?-m*f:0<m?m*f:0)+(0>s?-s*g:0<s?s*g:0);b=(0>e?-e*b:0<e?e*b:0)+(0>q?-q*f:0<q?q*f:0)+(0>i?-i*g:0<i?i*g:0);a[0]=d-c;a[1]=k-j;a[2]=h-b;a[3]=d+c;a[4]=k+j;a[5]=h+b};cb.prototype.rayTest=function(a){var b=this.transform,a={origin:Lg.prototype.m43InverseOrthonormalTransformPoint(b,a.origin),direction:Lg.prototype.m43InverseOrthonormalTransformVector(b,a.direction),maxFactor:a.maxFactor},a=this.shape.rayTest(a);null!==a&&(a.hitPoint=w.m43TransformPoint(b,
a.hitPoint,a.hitPoint),a.hitNormal=w.m43TransformVector(b,a.hitNormal,a.hitNormal));return a};cb.prototype.integratePositionWithVelocities=function(a,b,c,d){var f=this.velocity,g=Math.sqrt;b[9]=a[9]+c*f[d];b[10]=a[10]+c*f[d+1];b[11]=a[11]+c*f[d+2];var h=f[d+3]*c,n=f[d+4]*c,j=f[d+5]*c,e=a[0],l=a[1],m=a[2],q=a[3],p=a[4],s=a[5],d=a[6],f=a[7],i=a[8],a=e-j*l+n*m,c=l+j*e-h*m,e=m-n*e+h*l,l=q-j*p+n*s,m=p+j*q-h*s,q=s-n*q+h*p,p=d-j*f+n*i,j=f+j*d-h*i,h=i-n*d+h*f,n=1/g(a*a+c*c+e*e),a=a*n,c=c*n,e=e*n,n=-(a*l+
c*m+e*q),l=l+a*n,m=m+c*n,q=q+e*n,n=1/g(l*l+m*m+q*q),l=l*n,m=m*n,q=q*n,n=-(a*p+c*j+e*h),p=p+a*n,j=j+c*n,h=h+e*n,n=-(l*p+m*j+q*h),p=p+l*n,j=j+m*n,h=h+q*n,n=1/g(p*p+j*j+h*h);b[0]=a;b[1]=c;b[2]=e;b[3]=l;b[4]=m;b[5]=q;b[6]=p*n;b[7]=j*n;b[8]=h*n};cb.prototype.applyBiasVelocities=function(a){var b=this.velocity;this.integratePositionWithVelocities(this.transform,this.startTransform,a,6);b[6]=b[7]=b[8]=0;b[9]=b[10]=b[11]=0};cb.prototype.integratePosition=function(a){this.integratePositionWithVelocities(this.startTransform,
this.transform,a,0)};cb.prototype.refreshInertiaTensor=function(){var a=this.transform,b=this.inverseInertiaLocal,c=b[0],d=b[1],b=b[2],f=a[0],g=a[1],h=a[2],n=a[3],j=a[4],e=a[5],l=a[6],m=a[7],a=a[8],q=this.inverseInertia;q[0]=f*f*c+n*n*d+l*l*b;q[1]=f*g*c+n*j*d+l*m*b;q[2]=f*h*c+n*e*d+l*a*b;q[3]=g*f*c+j*n*d+m*l*b;q[4]=g*g*c+j*j*d+m*m*b;q[5]=g*h*c+j*e*d+m*a*b;q[6]=h*f*c+e*n*d+a*l*b;q[7]=h*g*c+e*j*d+a*m*b;q[8]=h*h*c+e*e*d+a*a*b};cb.prototype.integrateVelocity=function(a,b){var c=this.velocity,d=Math.pow,
f=d(1-this.linearDamping,b);c[0]=(c[0]+b*a[0])*f;c[1]=(c[1]+b*a[1])*f;c[2]=(c[2]+b*a[2])*f;var g=d(1-this.angularDamping,b),d=c[3]*g,f=c[4]*g,g=c[5]*g,h=Fj/b,n=d*d+f*f+g*g;n>h*h&&(h/=Math.sqrt(n),d*=h,f*=h,g*=h);c[3]=d;c[4]=f;c[5]=g};cb.prototype.isActiveVelocity=function(a,b){var c=this.shape.radius,d=this.velocity,f=d[0],g=d[1],h=d[2];if(f*f+g*g+h*h>a*c*c)return!0;f=d[3];g=d[4];h=d[5];return f*f+g*g+h*h>b?!0:!1};cb.prototype.isActive=function(){return!this.permitSleep?!0:this.isActiveVelocity(0.01,
0.1)?(this.wakeTimeStamp=this.world.timeStamp,!0):this.wakeTimeStamp+60>this.world.timeStamp};cb.version=1;cb.uniqueId=0;kc=cb;var pb=function(){};pb.prototype.calculateExtents=function(a){this._private.calculateExtents(a)};pb.prototype.calculateTransform=function(a,b){var c=this._private.transform;b?w.m43NegOffset(c,b,a):(a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3],a[4]=c[4],a[5]=c[5],a[6]=c[6],a[7]=c[7],a[8]=c[8],a[9]=c[9],a[10]=c[10],a[11]=c[11])};pb.prototype.clone=function(){return pb.create(this)};
pb.create=function(a){var b=new pb,c=new kc(a,b);b._private=c;b.userData="userData"in a?a.userData:null;Object.defineProperty(b,"shape",{value:a.shape,enumerable:!0});var d=void 0!==a.kinematic?a.kinematic:!1;Object.defineProperty(b,"transform",{get:function(){return w.m43Copy(this._private.transform)},set:function(a){var b=this._private;if(b.kinematic||!b.world)w.m43Copy(a,b.transform),b.world&&b.world.wakeBody(b)},enumerable:!0});var f=void 0!==a.group?a.group:Ka.prototype.FILTER_STATIC;Object.defineProperty(b,
"group",{value:f,enumerable:!0});var g=void 0!==a.mask?a.mask:Ka.prototype.FILTER_ALL^Ka.prototype.FILTER_STATIC;Object.defineProperty(b,"mask",{value:g,enumerable:!0});Object.defineProperty(b,"friction",{get:function(){return this._private.friction},set:function(a){var b=this._private;b.friction=a;for(var a=b.arbiters,c=a.length,b=0;b<c;b+=1)a[b].invalidateParameters()},enumerable:!0});Object.defineProperty(b,"restitution",{get:function(){return this._private.restitution},set:function(a){var b=this._private;
b.restitution=a;for(var a=b.arbiters,c=a.length,b=0;b<c;b+=1)a[b].invalidateParameters()},enumerable:!0});Object.defineProperty(b,"kinematic",{value:d,enumerable:!0});c.group=f;c.mask=g;c.kinematic=d;c.fixedRotation=!d;c.mass=0;c.inverseMass=0;c.inverseInertiaLocal=pb.sharedInverseInertiaLocal;c.inverseInertia=pb.sharedInverseInertia;c.collisionObject=!0;c.permitSleep=!1;c.sweepFrozen=!0;c.active=d;c.contactCallbacks=a.onPreSolveContact||a.onAddedContacts||a.onProcessedContacts||a.onRemovedContacts?
new wi(a,g):null;return b};pb.version=1;pb.sharedInverseInertiaLocal=w.v3BuildZero();pb.sharedInverseInertia=new Float32Array([0,0,0,0,0,0,0,0,0]);var wi;wi=function(a,b){this.mask=void 0!==a.contactCallbacksMask?a.contactCallbacksMask:b;this.added=!1;this.deferred=a.onAddedContacts||a.onProcessedContacts||a.onRemovedContacts;this.onPreSolveContact=a.onPreSolveContact||null;this.onAddedContacts=a.onAddedContacts||null;this.onProcessedContacts=a.onProcessedContacts||null;this.onRemovedContacts=a.onRemovedContacts||
null;this.trigger=a.trigger||!1;return this};var Yc=function(){this.calculateExtents=pb.prototype.calculateExtents;this.calculateTransform=pb.prototype.calculateTransform};Yc.prototype.clone=function(){return Yc.create(this)};Yc.create=function(a){var b=new Yc,c=new kc(a,b);b._private=c;b.userData="userData"in a?a.userData:null;Object.defineProperty(b,"shape",{value:a.shape,enumerable:!0});Object.defineProperty(b,"linearVelocity",{get:function(){var a=this._private.velocity;return w.v3Build(a[0],
a[1],a[2])},set:function(a){var b=this._private.velocity;b[0]=a[0];b[1]=a[1];b[2]=a[2]},enumerable:!0});Object.defineProperty(b,"angularVelocity",{get:function(){var a=this._private.velocity;return w.v3Build(a[3],a[4],a[5])},set:function(a){var b=this._private.velocity;b[3]=a[0];b[4]=a[1];b[5]=a[2]},enumerable:!0});Object.defineProperty(b,"transform",{get:function(){return w.m43Copy(this._private.transform)},set:function(a){var b=this._private;w.m43Copy(a,b.transform);for(var a=b.arbiters,c=a.length,
b=0;b<c;b+=1)a[b].skipDiscreteCollisions=!1},enumerable:!0});Object.defineProperty(b,"active",{get:function(){return this._private.active},set:function(a){var b=this._private;if(a===b.active)b.world&&a&&(b.wakeTimeStamp=b.world.timeStamp);else if(b.world)if(a)b.world.wakeBody(b);else{a=b.world.activeBodies;a[a.indexOf(b)]=a[a.length-1];a.pop();b.active=!1;var a=b.arbiters,c,d=a.length;for(c=0;c<d;c+=1){var f=a[c];if(f.active){f.active=!1;var g=b.world.activeArbiters;g[g.indexOf(f)]=g[g.length-1];
g.pop()}}b.world.syncBody(b)}else b.active=a},enumerable:!0});var d=void 0!==a.group?a.group:Ka.prototype.FILTER_DYNAMIC;Object.defineProperty(b,"group",{value:d,enumerable:!0});var f=void 0!==a.mask?a.mask:Ka.prototype.FILTER_ALL;Object.defineProperty(b,"mask",{value:f,enumerable:!0});Object.defineProperty(b,"friction",{get:function(){return this._private.friction},set:function(a){var b=this._private;b.friction=a;for(var a=b.arbiters,c=a.length,b=0;b<c;b+=1)a[b].invalidateParameters()},enumerable:!0});
Object.defineProperty(b,"restitution",{get:function(){return this._private.restitution},set:function(a){var b=this._private;b.restitution=a;for(var a=b.arbiters,c=a.length,b=0;b<c;b+=1)a[b].invalidateParameters()},enumerable:!0});Object.defineProperty(b,"linearDamping",{get:function(){return this._private.linearDamping},set:function(a){this._private.linearDamping=a},enumerable:!0});Object.defineProperty(b,"angularDamping",{get:function(){return this._private.angularDamping},set:function(a){this._private.angularDamping=
a},enumerable:!0});var g=void 0!==a.kinematic?a.kinematic:!1;Object.defineProperty(b,"kinematic",{value:g,enumerable:!0});var h=void 0!==a.mass?a.mass:1;Object.defineProperty(b,"mass",{value:h,enumerable:!0});var n=a.inertia?w.v3Copy(a.inertia):w.v3ScalarMul(a.shape.inertia,h);Object.defineProperty(b,"inertia",{get:function(){return w.v3Copy(n)},enumerable:!0});c.group=d;c.mask=f;c.active=void 0!==a.active?a.active:void 0!==a.frozen?!a.frozen:!0;c.kinematic=g;c.fixedRotation=g||(void 0!==a.fixedRotation?
a.fixedRotation:!1);c.inverseInertiaLocal=c.fixedRotation?w.v3BuildZero():w.v3Build(1/n[0],1/n[1],1/n[2]);c.inverseInertia=w.m33BuildIdentity();c.mass=h;c.inverseMass=g?0:1/c.mass;c.collisionObject=!1;c.permitSleep=void 0!==a.permitSleep?a.permitSleep:!g;c.sweepFrozen=g;c.contactCallbacks=a.onPreSolveContact||a.onAddedContacts||a.onProcessedContacts||a.onRemovedContacts?new wi(a,f):null;return b};Yc.version=1;var Wb=function(){};Wb.prototype.preStep=function(){};Wb.prototype.applyCachedImpulses=function(){};
Wb.prototype.computeAndApplyImpulses=function(){};Wb.create=function(a,b){var c=new Wb;c.world=null;c.userData=null;Mj(c,b);c.type=a;return c};Wb.version=1;var ye=function(){};ye.create=function(a){var b=new ye,c=new Nj;b._private=c;b.userData=a.userData;var d=b._private;d.world=null;d.bodyA=a.bodyA._private;Object.defineProperty(b,"bodyA",{value:a.bodyA,enumerable:!0});d.bodyB=a.bodyB?a.bodyB._private:null;Object.defineProperty(b,"bodyB",{value:a.bodyB,enumerable:!0});d.active=void 0!==a.active?
a.active:!0;Object.defineProperty(b,"active",{get:function(){return this._private.active},set:function(a){var b=this._private;a===b.active?b.world&&a&&(b.wakeTimeStamp=b.world.timeStamp):b.world?a?b.world.wakeConstraint(b):(a=b.world.activeConstraints,a[a.indexOf(b)]=a[a.length-1],a.pop(),b.active=!1):b.active=a},enumerable:!0});d=c.data;d[0]=a.pivotA[0];d[1]=a.pivotA[1];d[2]=a.pivotA[2];Object.defineProperty(b,"pivotA",{get:function(){var a=this._private.data;return w.v3Build(a[0],a[1],a[2])},set:function(a){var b=
this._private.data;b[0]=a[0];b[1]=a[1];b[2]=a[2]},enumerable:!0});a.pivotB?(d[3]=a.pivotB[0],d[4]=a.pivotB[1],d[5]=a.pivotB[2]):(c=w.m43TransformPoint(c.bodyA.transform,a.pivotA),d[3]=c[0],d[4]=c[1],d[5]=c[2]);Object.defineProperty(b,"pivotB",{get:function(){var a=this._private.data;return w.v3Build(a[3],a[4],a[5])},set:function(a){var b=this._private.data;b[3]=a[0];b[4]=a[1];b[5]=a[2]},enumerable:!0});d[30]=void 0!==a.force?a.force:0.3;Object.defineProperty(b,"force",{get:function(){return this._private.data[30]},
set:function(a){this._private.data[30]=a},enumerable:!0});d[31]=void 0!==a.damping?a.damping:1;Object.defineProperty(b,"damping",{get:function(){return this._private.data[31]},set:function(a){this._private.data[31]=a},enumerable:!0});d[32]=void 0!==a.impulseClamp?a.impulseClamp:0;Object.defineProperty(b,"impulseClamp",{get:function(){return this._private.data[32]},set:function(a){this._private.data[32]=a},enumerable:!0});return b};ye.version=1;ye.prototype.type="POINT2POINT";var Nj,Mg=function(){this.bodyB=
this.bodyA=null;this.data=new Float32Array(46);return this};Mg.prototype.preStep=function(a,b){var c=this.bodyA,d=this.bodyB,f=this.data,g=f[0],h=f[1],n=f[2],e=f[3],r=f[4],l=f[5],m=c.transform,q=f[6]=m[0]*g+m[3]*h+m[6]*n,p=f[7]=m[1]*g+m[4]*h+m[7]*n,g=f[8]=m[2]*g+m[5]*h+m[8]*n,s,i,k,z;d&&(z=d.transform,s=f[9]=z[0]*e+z[3]*r+z[6]*l,i=f[10]=z[1]*e+z[4]*r+z[7]*l,k=f[11]=z[2]*e+z[5]*r+z[8]*l);h=c.inverseInertia;f[12]=-g*h[3]+p*h[6];f[13]=-g*h[4]+p*h[7];f[14]=-g*h[5]+p*h[8];f[15]=g*h[0]+-q*h[6];f[16]=g*
h[1]+-q*h[7];f[17]=g*h[2]+-q*h[8];f[18]=-p*h[0]+q*h[3];f[19]=-p*h[1]+q*h[4];f[20]=-p*h[2]+q*h[5];var h=c.inverseMass+(d?d.inverseMass:0),c=h+f[13]*-g+f[14]*p,n=h+f[15]*g+f[17]*-q,B=h+f[18]*-p+f[19]*q,y=f[12]*g+f[14]*-q,v=f[12]*-p+f[13]*q,x=f[15]*-p+f[16]*q;d&&(h=d.inverseInertia,f[21]=-k*h[3]+i*h[6],f[22]=-k*h[4]+i*h[7],f[23]=-k*h[5]+i*h[8],f[24]=k*h[0]+-s*h[6],f[25]=k*h[1]+-s*h[7],f[26]=k*h[2]+-s*h[8],f[27]=-i*h[0]+s*h[3],f[28]=-i*h[1]+s*h[4],f[29]=-i*h[2]+s*h[5],c+=f[22]*-k+f[23]*i,n+=f[24]*k+f[26]*
-s,B+=f[27]*-i+f[28]*s,y+=f[21]*k+f[23]*-s,v+=f[21]*-i+f[22]*s,x+=f[24]*-i+f[25]*s);var h=f[30],J=2/b*h*f[31]/(1-h),C=h/(J*J),J=1/(1+C);f[33]=1-C*J;var C=n*B-x*x,t=v*x-y*B,Q=y*x-v*n,J=J/(c*C+y*t+v*Q);f[34]=J*C;f[35]=J*t;f[36]=J*Q;f[37]=J*(c*B-v*v);f[38]=J*(y*v-c*x);f[39]=J*(c*n-y*y);q+=m[9];p+=m[10];m=g+m[11];d?(q-=s+z[9],p-=i+z[10],m-=k+z[11]):(q-=e,p-=r,m-=l);d=-h/b;f[43]=q*d;f[44]=p*d;f[45]=m*d;f[40]*=a;f[41]*=a;f[42]*=a};Mg.prototype.applyCachedImpulses=function(){var a=this.data,b=a[40],c=a[41],
d=a[42],f=this.bodyA,g=f.velocity,f=f.inverseMass;g[0]+=b*f;g[1]+=c*f;g[2]+=d*f;g[3]-=a[12]*b+a[15]*c+a[18]*d;g[4]-=a[13]*b+a[16]*c+a[19]*d;g[5]-=a[14]*b+a[17]*c+a[20]*d;if(f=this.bodyB)g=f.velocity,f=f.inverseMass,g[0]-=b*f,g[1]-=c*f,g[2]-=d*f,g[3]+=a[21]*b+a[24]*c+a[27]*d,g[4]+=a[22]*b+a[25]*c+a[28]*d,g[5]+=a[23]*b+a[26]*c+a[29]*d};Mg.prototype.computeAndApplyImpulses=function(){var a=this.bodyA,b=this.bodyB,c=this.data,d=c[40],f=c[41],g=c[42],h=a.velocity,n=c[43]-(h[0]+h[4]*c[8]-h[5]*c[7]),e=c[44]-
(h[1]+h[5]*c[6]-h[3]*c[8]),r=c[45]-(h[2]+h[3]*c[7]-h[4]*c[6]),l;b&&(l=b.velocity,n+=l[0]+l[4]*c[11]-l[5]*c[10],e+=l[1]+l[5]*c[9]-l[3]*c[11],r+=l[2]+l[3]*c[10]-l[4]*c[9]);var m=c[33],d=d*m+c[34]*n+c[35]*e+c[36]*r,f=f*m+c[35]*n+c[37]*e+c[38]*r,g=g*m+c[36]*n+c[38]*e+c[39]*r,n=c[32];0!==n&&(e=d*d+f*f+g*g,e>n*n&&(e=n/Math.sqrt(e),d*=e,f*=e,g*=e));n=d-c[40];e=f-c[41];r=g-c[42];c[40]=d;c[41]=f;c[42]=g;a=a.inverseMass;h[0]+=n*a;h[1]+=e*a;h[2]+=r*a;h[3]-=c[12]*n+c[15]*e+c[18]*r;h[4]-=c[13]*n+c[16]*e+c[19]*
r;h[5]-=c[14]*n+c[17]*e+c[20]*r;b&&(a=b.inverseMass,l[0]-=n*a,l[1]-=e*a,l[2]-=r*a,l[3]+=c[21]*n+c[24]*e+c[27]*r,l[4]+=c[22]*n+c[25]*e+c[28]*r,l[5]+=c[23]*n+c[26]*e+c[29]*r)};Nj=Mg;var Zc=function(){};Zc.prototype.jump=function(){var a=this._private.rigidBody._private,b=a.world;b&&(a.velocity[1]=Math.sqrt(-2*(this.maxJumpHeight-this.stepHeight)*b.gravity[1]),a.transform[10]+=this.stepHeight,b.wakeBody(a))};Zc.prototype.calculateExtents=function(a){this._private.rigidBody.calculateExtents(a)};Zc.prototype.calculateTransform=
function(a,b){this._private.rigidBody.calculateTransform(a,b)};Zc.create=function(a){var b=new Zc,c=new Oj;b._private=c;b.userData=void 0!==a.userData?a.userData:null;Object.defineProperty(b,"crouch",{get:function(){return this._private.crouch},set:function(a){var b=this._private;if(!b.dead&&a!==b.crouch){var c=b.rigidBody._private,d=c.shape;(b.crouch=a)?(d.halfHeight=0.5*this.crouchHeight-this.radius,c.transform[10]-=0.5*(this.height-this.crouchHeight)):(d.halfHeight=0.5*this.height-this.radius,
c.transform[10]+=0.5*(this.height-this.crouchHeight));c.world&&c.world.wakeBody(c)}},enumerable:!0});Object.defineProperty(b,"dead",{get:function(){return this._private.dead},set:function(a){var b=this._private;if(b.dead!==a){var c=b.rigidBody._private,d=c.shape;(b.dead=a)?(d.halfHeight=0,c.transform[10]-=0.5*(this.height-this.radius)):(d.halfHeight=0.5*this.height-this.radius,c.transform[10]+=0.5*(this.height-this.radius));c.world&&c.world.wakeBody(c)}},enumerable:!0});Object.defineProperty(b,"height",
{value:a.height,enumerable:!0});Object.defineProperty(b,"radius",{value:a.radius,enumerable:!0});Object.defineProperty(b,"stepHeight",{value:void 0!==a.stepHeight?a.stepHeight:0.35,enumerable:!0});b.maxJumpHeight=void 0!==a.maxJumpHeight?a.maxJumpHeight:1;Object.defineProperty(b,"crouchHeight",{value:void 0!==a.crouchHeight?a.crouchHeight:0.5*a.height,enumerable:!0});Object.defineProperty(b,"onGround",{get:function(){var a=this._private,b=a.rigidBody._private;if(b.world){var c=b.transform,d=a.start,
a=a.end;d[9]=c[9];d[10]=c[10];d[11]=c[11];a[9]=c[9];a[10]=c[10]-0.5*this.stepHeight;a[11]=c[11];return null!==b.world.convexSweepTest({shape:b.shape._public,from:d,to:a,group:Ka.prototype.FILTER_CHARACTER},this.onGroundConvexCallback)}return!1},enumerable:!0});Object.defineProperty(b,"position",{get:function(){return w.m43Pos(this._private.rigidBody._private.transform)},set:function(a){var b=this._private.rigidBody,c=b._private.transform;c[9]=a[0];c[10]=a[1];c[11]=a[2];b.transform=b._private.transform;
b.active=!0},enumerable:!0});Object.defineProperty(b,"velocity",{get:function(){return this._private.rigidBody.linearVelocity},set:function(a){var b=this._private.rigidBody;b.linearVelocity=a;b.active=!0},enumerable:!0});var d=void 0!==a.group?a.group:Ka.prototype.FILTER_CHARACTER;Object.defineProperty(b,"group",{value:d,enumerable:!0});var f=void 0!==a.mask?a.mask:Ka.prototype.FILTER_ALL;Object.defineProperty(b,"mask",{value:f,enumerable:!0});var g=yc.create({radius:b.radius,height:2*(0.5*b.height-
b.radius),margin:0}),a=Yc.create({shape:g,mass:a.mass,transform:a.transform,linearVelocity:a.velocity,group:d,mask:f,friction:a.friction,restitution:a.restitution,linearDamping:a.linearDamping,angularDamping:a.angularDamping,fixedRotation:!0});c.rigidBody=a;return a._private._public=b};Zc.version=1;var Oj,xi=function(){this.dead=this.crouch=!1;this.start=w.m43BuildIdentity();this.end=w.m43BuildIdentity();this.rigidBody=null;return this};xi.prototype.onGroundConvexCallback=function(a){return 0.26<=
a.hitNormal[1]};xi.version=1;Oj=xi;var Xb=function(){};Xb.prototype.removeVertex=function(a){this.numVertices-=1;var b=this.simplex,a=9*a,c=9*this.numVertices;b[a]=b[c];b[a+1]=b[c+1];b[a+2]=b[c+2];b[a+3]=b[c+3];b[a+4]=b[c+4];b[a+5]=b[c+5];b[a+6]=b[c+6];b[a+7]=b[c+7];b[a+8]=b[c+8]};Xb.prototype.reduceVertices=function(a){4<=this.numVertices&&0===a[3]&&(this.numVertices-=1);var b=this.simplex,c;3<=this.numVertices&&0===a[2]&&(this.numVertices-=1,c=9*this.numVertices,b[18]=b[c],b[19]=b[c+1],b[20]=b[c+
2],b[21]=b[c+3],b[22]=b[c+4],b[23]=b[c+5],b[24]=b[c+6],b[25]=b[c+7],b[26]=b[c+8]);2<=this.numVertices&&0===a[1]&&(this.numVertices-=1,c=9*this.numVertices,b[9]=b[c],b[10]=b[c+1],b[11]=b[c+2],b[12]=b[c+3],b[13]=b[c+4],b[14]=b[c+5],b[15]=b[c+6],b[16]=b[c+7],b[17]=b[c+8]);1<=this.numVertices&&0===a[0]&&(this.numVertices-=1,c=9*this.numVertices,b[0]=b[c],b[1]=b[c+1],b[2]=b[c+2],b[3]=b[c+3],b[4]=b[c+4],b[5]=b[c+5],b[6]=b[c+6],b[7]=b[c+7],b[8]=b[c+8])};Xb.prototype.updateClosestPoints=function(){var a=
this.numVertices;if(0===a)return!1;var b=this.simplex,c=this.closest,d;if(1===a)return c[0]=b[3],c[1]=b[4],c[2]=b[5],c[3]=b[6],c[4]=b[7],c[5]=b[8],!0;d=b[0];var f=b[1],g=b[2],h=b[9],n=b[10],e=b[11];if(2===a){a=d-h;n=f-n;e=g-e;d=d*a+f*n+g*e;if(0<d){f=a*a+n*n+e*e;if(d<f)return d/=f,f=1-d,c[0]=b[3]*f+b[12]*d,c[1]=b[4]*f+b[13]*d,c[2]=b[5]*f+b[14]*d,c[3]=b[6]*f+b[15]*d,c[4]=b[7]*f+b[16]*d,c[5]=b[8]*f+b[17]*d,!0;this.removeVertex(0)}else this.removeVertex(1);for(d=0;6>d;d+=1)c[d]=b[d+3];return!0}d=this.cachedCoords;
return 3===a?(this.closestPointTriangle(0,9,18,d),this.reduceVertices(d),f=d[0],g=d[1],e=d[2],c[0]=f*b[3]+g*b[12]+e*b[21],c[1]=f*b[4]+g*b[13]+e*b[22],c[2]=f*b[5]+g*b[14]+e*b[23],c[3]=f*b[6]+g*b[15]+e*b[24],c[4]=f*b[7]+g*b[16]+e*b[25],c[5]=f*b[8]+g*b[17]+e*b[26],!0):4===a&&this.closestPointTetrahedron(d)?(this.reduceVertices(d),f=d[0],g=d[1],e=d[2],d=d[3],c[0]=f*b[3]+g*b[12]+e*b[21]+d*b[30],c[1]=f*b[4]+g*b[13]+e*b[22]+d*b[31],c[2]=f*b[5]+g*b[14]+e*b[23]+d*b[32],c[3]=f*b[6]+g*b[15]+e*b[24]+d*b[33],
c[4]=f*b[7]+g*b[16]+e*b[25]+d*b[34],c[5]=f*b[8]+g*b[17]+e*b[26]+d*b[35],!0):!1};Xb.prototype.closestPointTetrahedron=function(a){var b=this.simplex,c=b[0],d=b[1],f=b[2],g=b[9],h=b[10],n=b[11],e=b[18],r=b[19],l=b[20],m=b[27],q=b[28],p=b[29],b=g-c,s=h-d,i=n-f,k=e-c,z=r-d,B=l-f,y=m-c,v=q-d,x=p-f,e=e-g,r=r-h,l=l-n,m=m-g,J=q-h,C=p-n,t,Q,w;t=s*B-i*z;Q=i*k-b*B;w=b*z-s*k;p=0>=-(c*t+d*Q+f*w)*(y*t+v*Q+x*w);t=z*x-B*v;Q=B*y-k*x;w=k*v-z*y;q=0>=-(c*t+d*Q+f*w)*(b*t+s*Q+i*w);t=v*i-x*s;Q=x*b-y*i;w=y*s-v*b;c=0>=-(c*
t+d*Q+f*w)*(k*t+z*Q+B*w);t=J*l-C*r;Q=C*e-m*l;w=m*r-J*e;g=0>=(g*t+h*Q+n*w)*(b*t+s*Q+i*w);a[0]=a[1]=a[2]=a[3]=0;if(!p&&!q&&!c&&!g)return!1;h=this.tempCoords;n=Number.MAX_VALUE;p&&(d=this.closestPointTriangle(0,9,18,h,!0),d<n&&(n=d,a[0]=h[0],a[1]=h[1],a[2]=h[2],a[3]=0));q&&(d=this.closestPointTriangle(0,18,27,h,!0),d<n&&(n=d,a[0]=h[0],a[1]=0,a[2]=h[1],a[3]=h[2]));c&&(d=this.closestPointTriangle(0,27,9,h,!0),d<n&&(n=d,a[0]=h[0],a[1]=h[2],a[2]=0,a[3]=h[1]));g&&(d=this.closestPointTriangle(9,27,18,h,!0),
d<n&&(a[0]=0,a[1]=h[0],a[2]=h[2],a[3]=h[1]));return!0};Xb.prototype.closestPointTriangle=function(a,b,c,d,f){var g=this.simplex,h=g[a],n=g[a+1],a=g[a+2],e=g[b],r=g[b+1],b=g[b+2],l=g[c],m=g[c+1],q=g[c+2],p=h-e,s=n-r,c=a-b,i=h-l,k=n-m,g=a-q,z=h*p+n*s+a*c,B=h*i+n*k+a*g;if(0>=z&&0>=B){if(d[0]=1,d[1]=d[2]=0,f)return h*h+n*n+a*a}else{var y=e*p+r*s+b*c,v=e*i+r*k+b*g;if(0<=y&&v<=y){if(d[1]=1,d[0]=d[2]=0,f)return e*e+r*r+b*b}else{var x=z*v-y*B;if(0>=x&&0<=z&&0>=y){if(y=z/(z-y),d[0]=1-y,d[1]=y,d[2]=0,f)return d=
h-y*p,n-=y*s,a-=y*c,d*d+n*n+a*a}else{var J=l*p+m*s+q*c,C=l*i+m*k+q*g;if(0<=C&&J<=C){if(d[0]=d[1]=0,d[2]=1,f)return l*l+m*m+q*q}else if(z=J*B-z*C,0>=z&&0<=B&&0>=C){if(y=B/(B-C),d[0]=1-y,d[1]=0,d[2]=y,f)return d=h-y*i,n-=y*k,a-=y*g,d*d+n*n+a*a}else if(B=y*C-J*v,0>=B&&0<=v-y&&0<=J-C){if(y=(v-y)/(v-y+(J-C)),d[0]=0,d[1]=1-y,d[2]=y,f)return d=e*(1-y)+l*y,n=r*(1-y)+m*y,a=b*(1-y)+q*y,d*d+n*n+a*a}else if(r=1/(B+z+x),y=z*r,r*=x,d[0]=1-y-r,d[1]=y,d[2]=r,f)return d=h-p*y-i*r,n=n-s*y-k*r,a=a-c*y-g*r,d*d+n*n+a*
a}}}};Xb.prototype.evaluate=function(a,b,c){var d=a.axis,f=a.shapeA,g=a.shapeB;this.numVertices=0;var h,n,e;h=n=e=Number.MAX_VALUE;for(var r=0,l=!1,m=Number.MAX_VALUE,q=b[0],p=b[1],s=b[2],i=b[3],k=b[4],z=b[5],B=b[6],y=b[7],v=b[8],x=b[9],J=b[10],b=b[11],C=c[0],t=c[1],Q=c[2],w=c[3],Ta=c[4],K=c[5],A=c[6],N=c[7],da=c[8],va=c[9],E=c[10],F=c[11],c=d[0],H=d[1],U=d[2],X,I=a.closestA,a=a.closestB,Bb=this.closest,L=this.simplex;;){r+=1;I[0]=-(q*c+p*H+s*U);I[1]=-(i*c+k*H+z*U);I[2]=-(B*c+y*H+v*U);a[0]=C*c+t*
H+Q*U;a[1]=w*c+Ta*H+K*U;a[2]=A*c+N*H+da*U;f.localSupportWithoutMargin(I,I);g.localSupportWithoutMargin(a,a);var G=I[0],M=I[1],O=I[2];X=I[0]=q*G+i*M+B*O+x;var P=I[1]=p*G+k*M+y*O+J,S=I[2]=s*G+z*M+v*O+b,G=a[0],M=a[1],O=a[2],W=a[0]=C*G+w*M+A*O+va,R=a[1]=t*G+Ta*M+N*O+E,Y=a[2]=Q*G+K*M+da*O+F,T=X-W,Z=P-R,ba=S-Y,aa=!1,ca=9*this.numVertices,ea;for(ea=0;ea<ca;ea+=9)G=T-L[ea],M=Z-L[ea+1],O=ba-L[ea+2],1E-4>G*G+M*M+O*O&&(aa=!0);aa||(G=T-h,M=Z-n,O=ba-e,aa=1E-4>G*G+M*M+O*O);if(aa){l=!0;break}if(m-(c*T+H*Z+U*ba)<=
1E-4*m){l=!0;break}h=L[ca]=T;n=L[ca+1]=Z;e=L[ca+2]=ba;L[ca+3]=X;L[ca+4]=P;L[ca+5]=S;L[ca+6]=W;L[ca+7]=R;L[ca+8]=Y;this.numVertices+=1;if(!this.updateClosestPoints()){l=!1;break}G=Bb[0]-Bb[3];M=Bb[1]-Bb[4];O=Bb[2]-Bb[5];X=G*G+M*M+O*O;if(X<=Lc){l=!0;break}c=G;H=M;U=O;G=m;m=X;if(G-m<=1E-4*G){l=!0;break}if(100<=r){l=!0;break}if(4===this.numVertices)break}X=c*c+H*H+U*U;if(1E-8>X)d[0]=c,d[1]=H,d[2]=U;else if(f=1/Math.sqrt(X),d[0]=c*f,d[1]=H*f,d[2]=U*f,l)return I[0]=Bb[0],I[1]=Bb[1],I[2]=Bb[2],a[0]=Bb[3],
a[1]=Bb[4],a[2]=Bb[5],Math.sqrt(m)};Xb.create=function(){var a=new Xb;a.simplex=new Float32Array(36);a.numVertices=0;a.closest=new Float32Array(6);a.cachedCoords=new Float32Array(4);a.tempCoords=new Float32Array(4);return a};Xb.version=1;var qb=function(){};qb.prototype.bind=function(a,b,c,d){a.edge[b]=d;a.adjFace[b]=c;c.edge[d]=b;c.adjFace[d]=a};qb.prototype.append=function(a,b){b.leaf0=null;if(b.leaf1=a.root)a.root.leaf0=b;a.root=b;a.count+=1};qb.prototype.remove=function(a,b){var c=b.leaf0,d=b.leaf1;
d&&(d.leaf0=c);c&&(c.leaf1=d);b===a.root&&(a.root=d);a.count-=1};qb.prototype.findBest=function(){var a=this.hull.root,b=a.distance*a.distance,c;for(c=a.leaf1;null!==c;c=c.leaf1){var d=c.distance*c.distance;d<b&&(a=c,b=d)}return a};qb.prototype.getEdgeDistance=function(a,b,c){var d=this.vertex_store,f=d[b],g=d[b+1],b=d[b+2],h=d[c],n=d[c+1],c=d[c+2],d=h-f,e=n-g,r=c-b,l=a.normal,a=l[0],m=l[1],l=l[2];if(0>=f*(e*l-r*m)+g*(r*a-d*l)+b*(d*m-e*a)){a=d*d+e*e+r*r;m=h*d+n*r+c*r;if(0<=f*d+g*e+b*r)return Math.sqrt(f*
f+g*g+b*b);if(0>=m)return Math.sqrt(h*h+n*n+c*c);d=f*h+g*n+b*c;f=(f*f+g*g+b*b)*(h*h+n*n+c*c)-d*d;return 0<=f?Math.sqrt(f/a):0}};qb.prototype.buildNewFace=function(a,b,c,d){var f=this.stock.root;if(null===f)return null;f.pass=0;f.vertex[0]=a;f.vertex[1]=b;f.vertex[2]=c;var g=this.vertex_store,h=g[a],n=g[a+1],e=g[a+2],r=g[b]-h,l=g[b+1]-n,m=g[b+2]-e,q=g[c]-h,p=g[c+1]-n,s=g[c+2]-e,g=f.normal,i=g[0]=l*s-m*p,m=g[1]=m*q-r*s,r=g[2]=r*p-l*q,l=i*i+m*m+r*r;return 1E-8<l&&(f.distance=this.getEdgeDistance(f,a,
b),void 0===f.distance&&(f.distance=this.getEdgeDistance(f,b,c)),void 0===f.distance&&(f.distance=this.getEdgeDistance(f,c,a)),a=1/Math.sqrt(l),void 0===f.distance&&(f.distance=(h*i+n*m+e*r)*a),d||-1E-6<=f.distance)?(g[0]*=a,g[1]*=a,g[2]*=a,this.remove(this.stock,f),this.append(this.hull,f),f):null};qb.prototype.expandFace=function(a,b,c,d,f){if(c.pass!==a){var g=c.normal,h=this.vertex_store,n=(d+1)%3;if(-1E-6>g[0]*h[b]+g[1]*h[b+1]+g[2]*h[b+2]-c.distance){if(a=this.buildNewFace(c.vertex[n],c.vertex[d],
b,!1))return this.bind(a,0,c,d),f.cf?this.bind(f.cf,1,a,2):f.ff=a,f.cf=a,f.numFaces+=1,!0}else if(d=(d+2)%3,c.pass=a,this.expandFace(a,b,c.adjFace[n],c.edge[n],f)&&this.expandFace(a,b,c.adjFace[d],c.edge[d],f))return this.remove(this.hull,c),this.append(this.stock,c),!0}return!1};qb.prototype.evaluate=function(a,b,c,d){for(var f=b.shapeA,g=b.shapeB,h=this.hull,n=this.stock;h.root;){var e=h.root;this.remove(h,e);this.append(n,e)}var r=a[27],l=a[28],m=a[29],q,p,s=a[0]-r,i=a[1]-l,k=a[2]-m,z=a[9]-r,B=
a[10]-l,y=a[11]-m,v=a[18]-r,x=a[19]-l,J=a[20]-m;0>s*(B*J-y*x)+i*(y*v-z*J)+k*(z*x-B*v)?(q=9,p=0):(q=0,p=9);e=this.vertex_store;for(r=0;9>r;r+=1)e[r]=a[q+r],e[9+r]=a[p+r],e[18+r]=a[18+r],e[27+r]=a[27+r];q=this.buildNewFace(0,9,18,!0);p=this.buildNewFace(9,0,27,!0);var C=this.buildNewFace(18,9,27,!0),r=this.buildNewFace(0,18,27,!0),v=36;if(4!==h.count)return w.v3Build(a[3],a[4],a[5],b.closestA),w.v3Build(a[6],a[7],a[8],b.closestB),0;a=this.findBest();J=x=0;this.bind(q,0,p,0);this.bind(q,1,C,0);this.bind(q,
2,r,0);this.bind(p,1,r,2);this.bind(p,2,C,1);this.bind(C,2,r,1);for(var t=c[0],Q=c[1],V=c[2],Ta=c[3],K=c[4],A=c[5],N=c[6],da=c[7],va=c[8],E=c[9],F=c[10],H=c[11],U=d[0],X=d[1],I=d[2],G=d[3],L=d[4],M=d[5],O=d[6],P=d[7],S=d[8],W=d[9],R=d[10],Y=d[11],d=b.closestA,c=b.closestB,T=this.horizon;100>J&&!(v>=9*this.MAX_VERTICES);J+=1){T.cf=T.ff=null;T.numFaces=0;var Z=v,v=v+9,x=x+1;a.pass=x;C=a.normal;q=C[0];p=C[1];C=C[2];d[0]=t*q+Q*p+V*C;d[1]=Ta*q+K*p+A*C;d[2]=N*q+da*p+va*C;c[0]=-(U*q+X*p+I*C);c[1]=-(G*q+
L*p+M*C);c[2]=-(O*q+P*p+S*C);f.localSupportWithoutMargin(d,d);g.localSupportWithoutMargin(c,c);r=d[0];l=d[1];m=d[2];s=t*r+Ta*l+N*m+E;i=Q*r+K*l+da*m+F;k=V*r+A*l+va*m+H;r=c[0];l=c[1];m=c[2];z=U*r+G*l+O*m+W;B=X*r+L*l+P*m+R;y=I*r+M*l+S*m+Y;e[Z+3]=s;e[Z+4]=i;e[Z+5]=k;e[Z+6]=z;e[Z+7]=B;e[Z+8]=y;e[Z]=r=s-z;e[Z+1]=l=i-B;e[Z+2]=m=k-y;if(q*r+p*l+C*m-a.distance>Lc){p=!0;for(q=0;3>q&&p;q+=1)p=p&&this.expandFace(x,Z,a.adjFace[q],a.edge[q],T);if(p&&3<=T.numFaces)this.bind(T.cf,1,T.ff,2),this.remove(h,a),this.append(n,
a),a=this.findBest();else break}else break}C=a.normal;q=C[0];p=C[1];C=C[2];f=a.distance;m=q*f;r=p*f;l=C*f;v=a.vertex[0];x=a.vertex[1];J=a.vertex[2];f=e[v]-m;g=e[v+1]-r;h=e[v+2]-l;n=e[x]-m;k=e[x+1]-r;y=e[x+2]-l;Q=e[J]-m;V=e[J+1]-r;Ta=e[J+2]-l;r=k*Ta-y*V;l=y*Q-n*Ta;m=n*V-k*Q;t=Math.sqrt(r*r+l*l+m*m);r=V*h-Ta*g;l=Ta*f-Q*h;m=Q*g-V*f;Q=Math.sqrt(r*r+l*l+m*m);r=g*y-h*k;l=h*n-f*y;m=f*k-g*n;f=Math.sqrt(r*r+l*l+m*m);g=1/(t+Q+f);t*=g;Q*=g;f*=g;d[0]=d[1]=d[2]=0;for(r=c[0]=c[1]=c[2]=0;3>r;r+=1)d[r]+=t*e[v+3+
r]+Q*e[x+3+r]+f*e[J+3+r],c[r]+=t*e[v+6+r]+Q*e[x+6+r]+f*e[J+6+r];b=b.axis;b[0]=-q;b[1]=-p;b[2]=-C;return-a.distance};qb.create=function(){var a=new qb,b;a.vertex_store=new Float32Array(9*a.MAX_VERTICES);var c=[];for(b=0;b<a.MAX_FACES;b+=1)c[b]={normal:w.v3BuildZero(),distance:0,vertex:new Int16Array(3),adjFace:[null,null,null],edge:new Int16Array(3),leaf0:null,leaf1:null,pass:0};a.hull={root:null,count:0};a.stock={root:null,count:0};a.horizon={cf:null,ff:null,numFaces:0};for(b=0;b<a.MAX_FACES;b+=1)a.append(a.stock,
c[a.MAX_FACES-b-1]);return a};qb.version=1;qb.prototype.MAX_VERTICES=64;qb.prototype.MAX_FACES=128;var Cd=function(){this._private=null;return this};Cd.create=function(){var a=new Cd;Object.defineProperty(a,"localPointOnA",{get:function(){var a=this._private;return w.v3Build(a[0],a[1],a[2])},set:function(a){var c=this._private;c[0]=a[0];c[1]=a[1];c[2]=a[2]},enumerable:!0});Object.defineProperty(a,"localPointOnB",{get:function(){var a=this._private;return w.v3Build(a[3],a[4],a[5])},set:function(a){var c=
this._private;c[3]=a[0];c[4]=a[1];c[5]=a[2]},enumerable:!0});Object.defineProperty(a,"worldNormalOnB",{get:function(){var a=this._private;return w.v3Build(a[12],a[13],a[14])},set:function(a){var c=this._private;c[12]=a[0];c[13]=a[1];c[14]=a[2]},enumerable:!0});Object.defineProperty(a,"added",{get:function(){return 0<this._private[51]},enumerable:!0});Object.defineProperty(a,"distance",{get:function(){return this._private[21]},enumerable:!0});return a};var Jb={contactPool:[],contactPoolSize:0,publicContacts:[Cd.create(),
Cd.create(),Cd.create()],callbackContacts:[],allocate:function(){var a;0===this.contactPoolSize?a=new Float32Array(52):(this.contactPoolSize-=1,a=this.contactPool[this.contactPoolSize]);a[51]=1;return a},deallocate:function(a){this.contactPool[this.contactPoolSize]=a;this.contactPoolSize+=1;a[40]=0}},Qa=function(){this.shapeB=this.shapeA=this.objectB=this.objectA=null;this.restitution=this.friction=0;this.contacts=[];this.activeContacts=[];this.active=!0;this.skipDiscreteCollisions=!1;this.contactFlags=
0;this.trigger=!1;return this};Qa.prototype.insertContact=function(a,b,c,d,f){var g=c[0],h=c[1],n=c[2],e=g*g+h*h+n*n;if(!(1E-8>e)){for(var e=1/Math.sqrt(e),g=g*e,h=h*e,n=n*e,r=this.objectA,l=this.objectB,c=r.transform,m=l.transform,q=a[0]-c[9],p=a[1]-c[10],s=a[2]-c[11],i=c[0]*q+c[1]*p+c[2]*s,k=c[3]*q+c[4]*p+c[5]*s,z=c[6]*q+c[7]*p+c[8]*s,B=0,y=0,v=Number.MAX_VALUE,a=this.contacts,x;y<a.length;){var J=a[y];!f&&0.9>g*J[12]+h*J[13]+n*J[14]?(a[y]=a[a.length-1],a.pop(),Jb.deallocate(J),this.contactFlags|=
4):(x=i-J[0],c=k-J[1],e=z-J[2],c=x*x+c*c+e*e,3E-6>c?(B=J[40],a[y]=a[a.length-1],a.pop(),Jb.deallocate(J),this.contactFlags|=4,v=c):(1.6875>c&&c<v&&(B=J[40],v=c),y+=1))}c=Jb.allocate();c[0]=i;c[1]=k;c[2]=z;c[6]=q;c[7]=p;c[8]=s;c[9]=q=b[0]-m[9];c[10]=p=b[1]-m[10];c[11]=s=b[2]-m[11];c[3]=m[0]*q+m[1]*p+m[2]*s;c[4]=m[3]*q+m[4]*p+m[5]*s;c[5]=m[6]*q+m[7]*p+m[8]*s;c[21]=d;c[12]=g;c[13]=h;c[14]=n;e=g*g+n*n;1E-8>e?(c[15]=x=1,c[16]=0,c[17]=e=0):(e=1/Math.sqrt(e),c[15]=x=-n*e,c[16]=0,c[17]=e*=g);c[18]=h*e;c[19]=
n*x-g*e;c[20]=-(h*x);c[40]=B;e=r.contactCallbacks;null!==e&&0!==(e.mask&l.group)&&(e.onPreSolveContact&&(x=Jb.publicContacts[0],x._private=c,e.onPreSolveContact(r._public,l._public,x)),!e.added&&e.deferred&&(e.added=!0,r.world.contactCallbackObjects.push(r)),e.trigger&&(this.trigger=!0,r.sweepFrozen=!1,l.sweepFrozen=!1));e=l.contactCallbacks;null!==e&&0!==(e.mask&r.group)&&(e.onPreSolveContact&&(x=Jb.publicContacts[0],x._private=c,e.onPreSolveContact(r._public,l._public,x)),!e.added&&e.deferred&&
(e.added=!0,l.world.contactCallbackObjects.push(l)),e.trigger&&(this.trigger=!0,r.sweepFrozen=!1,l.sweepFrozen=!1));this.contactFlags|=1;a.push(c);if(4===a.length){e=a[0][21];l=0;for(y=1;4>y;y+=1)c=a[y],c[21]<e&&(e=c[21],l=y);var C,r=-Number.MAX_VALUE,g=a[0];x=a[1];c=a[2];e=a[3];z=g[6]+g[9];B=g[7]+g[10];k=g[8]+g[11];n=x[6]+x[9];g=x[7]+x[10];h=x[8]+x[11];f=c[6]+c[9];b=c[7]+c[10];d=c[8]+c[11];x=e[6]+e[9];var c=e[7]+e[10],e=e[8]+e[11],m=n-z,q=g-B,p=h-k,y=f-z,s=b-B,i=d-k,z=x-z,v=c-B,J=e-k,t;1!==l&&(B=
s*J-i*v,k=i*z-y*J,t=y*v-s*z,B=B*B+k*k+t*t,B>r&&(r=B,C=1));2!==l&&(B=q*J-p*v,k=p*z-m*J,t=m*v-q*z,B=B*B+k*k+t*t,B>r&&(r=B,C=2));3!==l&&(B=q*i-p*s,k=p*y-m*i,t=m*s-q*y,B=B*B+k*k+t*t,B>r&&(r=B,C=3));0!==l&&(l=f-n,b-=g,d-=h,x-=n,c-=g,e-=h,B=b*e-d*c,k=d*x-l*e,t=l*c-b*x,B*B+k*k+t*t>r&&(C=0));c=a[C];a[C]=a[3];a.pop();Jb.deallocate(c);this.contactFlags|=4}}};Qa.prototype.refreshContacts=function(){for(var a=this.contacts,b=this.objectA.transform,c=this.objectB.transform,d=b[0],f=b[1],g=b[2],h=b[3],n=b[4],e=
b[5],r=b[6],l=b[7],m=b[8],q=b[9],p=b[10],b=b[11],s=c[0],i=c[1],k=c[2],z=c[3],B=c[4],y=c[5],v=c[6],x=c[7],J=c[8],C=c[9],t=c[10],c=c[11],Q,w=0;w<a.length;){Q=a[w];var Ta=Q[0],K=Q[1],A=Q[2],N=Q[6]=d*Ta+h*K+r*A,da=Q[7]=f*Ta+n*K+l*A,va=Q[8]=g*Ta+e*K+m*A,Ta=Q[3],K=Q[4],A=Q[5],E=Q[9]=s*Ta+z*K+v*A,F=Q[10]=i*Ta+B*K+x*A,A=Q[11]=k*Ta+y*K+J*A,Ta=N+q-(E+C),K=da+p-(F+t),A=va+b-(A+c),N=Q[12],da=Q[13],va=Q[14],E=Q[21]=N*Ta+da*K+va*A;0.05<E?(a[w]=a[a.length-1],a.pop(),Jb.deallocate(Q),this.contactFlags|=4):(Ta-=N*
E,K-=da*E,A-=va*E,Ta*Ta+K*K+A*A>Ej?(a[w]=a[a.length-1],a.pop(),Jb.deallocate(Q),this.contactFlags|=4):w+=1)}this.contactFlags|=2;return 0===a.length};Qa.prototype.preStep=function(a,b){if(this.trigger)this.activeContacts.length=0;else{var c=this.objectA,d=this.objectB,f=c.inverseMass+d.inverseMass,g=c.velocity,h=d.velocity,n=c.inverseInertia,e=n[0],r=n[1],l=n[2],m=n[3],q=n[4],p=n[5],s=n[6],i=n[7],k=n[8],n=d.inverseInertia,z=n[0],B=n[1],y=n[2],v=n[3],x=n[4],J=n[5],C=n[6],t=n[7],n=n[8],Q=this.activeContacts;
Q.length=0;var c=c.collisionObject||d.collisionObject?0.65:0.35,d=this.contacts,w,A=d.length;for(w=0;w<A;w+=1){var K=d[w];if(!(0<K[21])){Q[Q.length]=K;K[41]=K[42]=0;var bb,N,da,va,E,F,H=K[12],U=K[13],X=K[14],I=K[6],G=K[7],L=K[8],M=K[9],O=K[10],P=K[11],S,W,R,T=f;bb=G*X-L*U;N=L*H-I*X;da=I*U-G*H;K[22]=S=e*bb+m*N+s*da;K[23]=W=r*bb+q*N+i*da;K[24]=R=l*bb+p*N+k*da;T+=bb*S+N*W+da*R;va=O*X-P*U;E=P*H-M*X;F=M*U-O*H;K[25]=S=-(z*va+v*E+C*F);K[26]=W=-(B*va+x*E+t*F);K[27]=R=-(y*va+J*E+n*F);T-=va*S+E*W+F*R;K[45]=
1/T;K[43]=c*Math.min(0,K[21]+0.015)/b;K[44]=0;bb=g[0]-h[0];N=g[1]-h[1];da=g[2]-h[2];bb+=g[4]*L-g[5]*G;N+=g[5]*I-g[3]*L;da+=g[3]*G-g[4]*I;bb-=h[4]*P-h[5]*O;N-=h[5]*M-h[3]*P;da-=h[3]*O-h[4]*M;H=(bb*H+N*U+da*X)*this.restitution;0.01>H*H&&(H=0);K[50]=H;T=f;H=K[15];U=K[16];X=K[17];bb=G*X-L*U;N=L*H-I*X;da=I*U-G*H;K[28]=S=e*bb+m*N+s*da;K[29]=W=r*bb+q*N+i*da;K[30]=R=l*bb+p*N+k*da;T+=bb*S+N*W+da*R;va=O*X-P*U;E=P*H-M*X;F=M*U-O*H;K[31]=S=-(z*va+v*E+C*F);K[32]=W=-(B*va+x*E+t*F);K[33]=R=-(y*va+J*E+n*F);var T=
T-(va*S+E*W+F*R),Y=f,H=K[18],U=K[19],X=K[20];bb=G*X-L*U;N=L*H-I*X;da=I*U-G*H;K[34]=S=e*bb+m*N+s*da;K[35]=W=r*bb+q*N+i*da;K[36]=R=l*bb+p*N+k*da;Y+=bb*S+N*W+da*R;va=O*X-P*U;E=P*H-M*X;F=M*U-O*H;K[37]=S=-(z*va+v*E+C*F);K[38]=W=-(B*va+x*E+t*F);K[39]=R=-(y*va+J*E+n*F);Y-=va*S+E*W+F*R;I=0;I+=bb*K[28]+N*K[29]+da*K[30];I-=va*K[31]+E*K[32]+F*K[33];G=1/(T*Y-I*I);K[46]=Y*G;K[47]=-I*G;K[48]=T*G;K[40]*=a}}}};Qa.prototype.applyCachedImpulses=function(){if(!this.trigger){var a=this.objectA,b=this.objectB,c=a.velocity,
d=b.velocity,a=a.inverseMass,b=b.inverseMass,f=this.activeContacts,g;for(g=0;g<f.length;g+=1){var h=f[g],n=h[40],e=h[12]*n,r=h[13]*n,l=h[14]*n;c[0]+=e*a;c[1]+=r*a;c[2]+=l*a;d[0]-=e*b;d[1]-=r*b;d[2]-=l*b;c[3]+=h[22]*n;c[4]+=h[23]*n;c[5]+=h[24]*n;d[3]+=h[25]*n;d[4]+=h[26]*n;d[5]+=h[27]*n}}};Qa.prototype.computeAndApplyBiasImpulses=function(){if(!this.trigger){var a=this.objectA,b=this.objectB,c=a.velocity,d=c[6],f=c[7],g=c[8],h=c[9],n=c[10],e=c[11],c=b.velocity,r=c[6],l=c[7],m=c[8],q=c[9],p=c[10],s=
c[11],c=a.inverseMass,i=b.inverseMass,k=this.activeContacts,z=k.length,B,y;for(y=0;y<z;y+=1){B=k[y];var v=B[12],x=B[13],J=B[14],C=B[6],t=B[7],Q=B[8],w=B[9],A=B[10],K=B[11],C=B[45]*(v*(r+(p*K-s*A)-(d+(n*Q-e*t)))+x*(l+(s*w-q*K)-(f+(e*C-h*Q)))+J*(m+(q*A-p*w)-(g+(h*t-n*C)))-B[43]),t=B[44],Q=t+C;0>Q&&(Q=0);C=Q-t;B[44]=Q;v*=C;x*=C;J*=C;d+=v*c;f+=x*c;g+=J*c;r-=v*i;l-=x*i;m-=J*i;h+=B[22]*C;n+=B[23]*C;e+=B[24]*C;q+=B[25]*C;p+=B[26]*C;s+=B[27]*C}c=a.velocity;c[6]=d;c[7]=f;c[8]=g;c[9]=h;c[10]=n;c[11]=e;c=b.velocity;
c[6]=r;c[7]=l;c[8]=m;c[9]=q;c[10]=p;c[11]=s}};Qa.prototype.computeAndApplyImpulses=function(){if(!this.trigger){var a=this.objectA,b=this.objectB,c=a.velocity,d=c[0],f=c[1],g=c[2],h=c[3],n=c[4],e=c[5],c=b.velocity,r=c[0],l=c[1],m=c[2],q=c[3],p=c[4],s=c[5],c=a.inverseMass,i=b.inverseMass,k=this.friction,z=this.activeContacts,B=z.length,y,v;for(v=0;v<B;v+=1){y=z[v];var x=y[12],J=y[13],C=y[14],t=y[15],Q=y[16],w=y[17],A=y[18],K=y[19],E=y[20],N=y[6],da=y[7],va=y[8],H=y[9],F=y[10],I=y[11],U=y[45]*(x*(r+
(p*I-s*F)-(d+(n*va-e*da)))+J*(l+(s*H-q*I)-(f+(e*N-h*va)))+C*(m+(q*F-p*H)-(g+(h*da-n*N)))-y[50]),X=y[40],G=X+U;0>G&&(G=0,U=-X);y[40]=G;x*=U;J*=U;C*=U;d+=x*c;f+=J*c;g+=C*c;r-=x*i;l-=J*i;m-=C*i;h+=y[22]*U;n+=y[23]*U;e+=y[24]*U;q+=y[25]*U;p+=y[26]*U;s+=y[27]*U;x=r-d+(p*I-s*F)-(n*va-e*da);J=l-f+(s*H-q*I)-(e*N-h*va);C=m-g+(q*F-p*H)-(h*da-n*N);X=t*x+Q*J+w*C;G=A*x+K*J+E*C;U=X*y[46]+G*y[47];N=X*y[47]+G*y[48];X=y[41];x=y[42];G=X+U;J=x+N;C=k*y[40];da=G*G+J*J;da>C*C&&(da=C/Math.sqrt(da),G*=da,J*=da,U=G-X,N=J-
x);y[41]=G;y[42]=J;x=t*U+A*N;J=Q*U+K*N;C=w*U+E*N;d+=x*c;f+=J*c;g+=C*c;r-=x*i;l-=J*i;m-=C*i;h+=y[28]*U+y[34]*N;n+=y[29]*U+y[35]*N;e+=y[30]*U+y[36]*N;q+=y[31]*U+y[37]*N;p+=y[32]*U+y[38]*N;s+=y[33]*U+y[39]*N}c=a.velocity;c[0]=d;c[1]=f;c[2]=g;c[3]=h;c[4]=n;c[5]=e;c=b.velocity;c[0]=r;c[1]=l;c[2]=m;c[3]=q;c[4]=p;c[5]=s}};Qa.prototype.invalidateParameters=function(){this.restitution=this.objectA.restitution*this.objectB.restitution;this.friction=this.objectA.friction*this.objectB.friction};Qa.allocate=function(a,
b,c,d){var f;0===this.arbiterPoolSize?f=new Qa:(f=this.arbiterPool[this.arbiterPoolSize-1],this.arbiterPoolSize-=1);f.active=!0;f.shapeA=a;f.shapeB=b;f.objectA=c;f.objectB=d;f.invalidateParameters();return f};Qa.deallocate=function(a){a.shapeA=null;a.shapeB=null;a.objectA=null;a.objectB=null;a.skipDiscreteCollisions=!1;a.activeContacts.length=0;a.contactFlags=0;a.trigger=!1;this.arbiterPool[this.arbiterPoolSize]=a;this.arbiterPoolSize+=1};Qa.version=1;Qa.arbiterPool=[];Qa.arbiterPoolSize=0;var Yb=
function(){this.bodies=[];this.constraints=[];this.wakeTimeStamp=0;this.active=!1;return this};Yb.allocate=function(){var a;0===this.islandPoolSize?a=new Yb:(a=this.islandPool[this.islandPoolSize-1],this.islandPoolSize-=1);return a};Yb.deallocate=function(a){this.islandPool[this.islandPoolSize]=a;this.islandPoolSize+=1;a.wakeTimeStamp=0};Yb.version=1;Yb.islandPool=[];Yb.islandPoolSize=0;var vb=function(){this.collisionRadius=this.index=0;this.triangleArray=null;return this};vb.prototype.localSupportWithoutMargin=
function(a,b){var c=a[0],d=a[1],f=a[2],g=this.triangleArray.triangles,h=this.index,n=g[h+3],e=g[h+4],r=g[h+5],l=g[h+6],m=g[h+7],q=g[h+8],p=g[h+9],s=g[h+10],g=g[h+11],h=c*l+d*m+f*q,c=c*p+d*s+f*g;0>=h&&0>=c?(b[0]=n,b[1]=e,b[2]=r):h>=c?(b[0]=n+l,b[1]=e+m,b[2]=r+q):(b[0]=n+p,b[1]=e+s,b[2]=r+g)};vb.allocate=function(){var a;0===this.trianglePoolSize?a=new vb:(a=this.trianglePool[this.trianglePoolSize-1],this.trianglePoolSize-=1);return a};vb.deallocate=function(a){this.trianglePool[this.trianglePoolSize]=
a;this.trianglePoolSize+=1;a.triangleArray=null};vb.version=1;vb.trianglePool=[];vb.trianglePoolSize=0;vb.prototype.type="TRIANGLE_MESH_TRIANGLE";var eb=function(){this.shapeB=this.shapeA=this.objectB=this.objectA=null;this.closestA=w.v3BuildZero();this.closestB=w.v3BuildZero();this.axis=w.v3BuildZero();this.toi=this.distance=0;this.concave=this.frozenB=this.frozenA=!1;return this};eb.allocate=function(){var a;0===this.eventPoolSize?a=new eb:(a=this.eventPool[this.eventPoolSize-1],this.eventPoolSize-=
1);return a};eb.deallocate=function(a){this.eventPool[this.eventPoolSize]=a;this.eventPoolSize+=1;a.concave&&(vb.deallocate(a.shapeB),a.concave=!1);a.objectA=null;a.objectB=null;a.shapeA=null;a.shapeB=null};eb.version=1;eb.eventPool=[];eb.eventPoolSize=0;var fb=function(){};fb.prototype.update=function(){this._private.update()};fb.prototype.rayTest=function(a){return this._private.rayTest(a)};fb.prototype.convexSweepTest=function(a){return this._private.convexSweepTest(a)};fb.prototype.addCollisionObject=
function(a){return this._private.addBody(a._private)};fb.prototype.removeCollisionObject=function(a){return this._private.removeBody(a._private)};fb.prototype.addRigidBody=function(a){return this._private.addBody(a._private)};fb.prototype.removeRigidBody=function(a){return this._private.removeBody(a._private)};fb.prototype.addConstraint=function(a){return this._private.addConstraint(a._private)};fb.prototype.removeConstraint=function(a){return this._private.removeConstraint(a._private)};fb.prototype.addCharacter=
function(a){return this._private.addBody(a._private.rigidBody._private)};fb.prototype.removeCharacter=function(a){return this._private.removeBody(a._private.rigidBody._private)};fb.prototype.wakeBody=function(a){this._private.wakeBody(a)};fb.prototype.flush=function(){this._private.flush()};fb.create=function(a){var b=new fb,c=new Lg;b._private=c;c._public=b;c.gravity=void 0!==a.gravity?w.v3Copy(a.gravity):w.v3Build(0,-10,0);c.maxSubSteps=void 0!==a.maxSubSteps?a.maxSubSteps:10;c.fixedTimeStep=void 0!==
a.fixedTimeStep?a.fixedTimeStep:1/60;c.variableMinStep=void 0!==a.minimumTimeStep?a.minimumTimeStep:1/70;c.variableMaxStep=void 0!==a.maximumTimeStep?a.maximumTimeStep:0.02;c.variableStep=void 0!==a.variableTimeSteps?a.variableTimeSteps:!1;c.maxGiveUpTimeStep=void 0!==a.maxGiveUpTimeStep?a.maxGiveUpTimeStep:0.05;Object.defineProperty(b,"maxSubSteps",{value:c.maxSubSteps,enumerable:!0});Object.defineProperty(b,"maxGiveUpTimeStep",{value:c.maxGiveUpTimeStep,enumerable:!0});c.variableStep?(Object.defineProperty(b,
"minimumTimeStep",{value:c.variableMinStep,enumerable:!0}),Object.defineProperty(b,"maximumTimeStep",{value:c.variableMaxStep,enumerable:!0})):Object.defineProperty(b,"fixedTimeStep",{value:c.fixedTimeStep,enumerable:!0});Object.defineProperty(b,"gravity",{get:function(){return w.v3Copy(this._private.gravity)},enumerable:!0});c.staticSpatialMap=xa.create(!0);c.dynamicSpatialMap=xa.create();c.collisionObjects=[];c.rigidBodies=[];c.constraints=[];c.kinematicBodies=[];c.activeArbiters=[];c.activeBodies=
[];c.activeKinematics=[];c.activeConstraints=[];c.persistantObjectsList=[];c.persistantObjectsList2=[];c.persistantTrianglesList=[];c.persistantTOIEventList=[];c.timeStamp=0;c.performanceData={discrete:0,sleepComputation:0,prestepContacts:0,prestepConstraints:0,integrateVelocities:0,warmstartContacts:0,warmstartConstraints:0,physicsIterations:0,integratePositions:0,continuous:0};Object.defineProperty(b,"performanceData",{value:c.performanceData,enumerable:!0});c.syncExtents=new Float32Array(6);c.contactCallbackObjects=
[];c.contactCallbackRemovedArbiters=[];return b};fb.version=1;var Lg,Ha=function(){};Ha.prototype.m43InverseOrthonormalTransformVector=function(a,b,c){void 0===c&&(c=new Float32Array(3));var d=b[0],f=b[1],b=b[2];c[0]=a[0]*d+a[1]*f+a[2]*b;c[1]=a[3]*d+a[4]*f+a[5]*b;c[2]=a[6]*d+a[7]*f+a[8]*b;return c};Ha.prototype.m43InverseOrthonormalTransformPoint=function(a,b,c){void 0===c&&(c=new Float32Array(3));var d=b[0]-a[9],f=b[1]-a[10],b=b[2]-a[11];c[0]=a[0]*d+a[1]*f+a[2]*b;c[1]=a[3]*d+a[4]*f+a[5]*b;c[2]=a[6]*
d+a[7]*f+a[8]*b;return c};Ha.prototype.trianglePlaneDiscard=function(a,b,c,d,f){void 0===this.planeAxis&&(this.planeAxis=w.v3BuildZero(),this.planeSA=w.v3BuildZero(),this.planeSB=w.v3BuildZero());var g=this.planeAxis,h=this.planeSA,n=this.planeSB,e=c.triangles,c=e[d],r=e[d+1],l=e[d+2],d=e[d+16],e=f[0],m=f[1],q=f[2],p=f[3],s=f[4],i=f[5],k=f[6],z=f[7],B=f[8],y=f[9],v=f[10],f=f[11],x=c*e+r*p+l*k,J=c*m+r*s+l*z,C=c*q+r*i+l*B,e=b[0],m=b[1],q=b[2],p=b[3],s=b[4],i=b[5],k=b[6],z=b[7],B=b[8],y=y-b[9],v=v-b[10],
f=f-b[11],c=e*x+m*J+q*C,r=p*x+s*J+i*C,l=k*x+z*J+B*C,d=d+(x*y+J*v+C*f);g[0]=c;g[1]=r;g[2]=l;a.localSupportWithoutMargin(g,h);g[0]=-c;g[1]=-r;g[2]=-l;a.localSupportWithoutMargin(g,n);b=h[0]*c+h[1]*r+h[2]*l-d;n=n[0]*c+n[1]*r+n[2]*l-d;if(0>=b*n)return!1;g=b*b<n*n?b:n;0>g!==0>b*n&&(g=-g);return 0<g-a.collisionRadius};Ha.prototype.filtered=function(a,b){return a===b||(a.collisionObject||a.kinematic)&&(b.collisionObject||b.kinematic)||0===(a.mask&b.group)||0===(b.mask&a.group)?!0:!1};Ha.prototype.narrowPhase=
function(a,b,c,d){void 0===this.narrowTriangle&&(this.narrowTriangle=vb.allocate(),this.narrowCache={axis:w.v3Build(1,0,0),shapeA:null,shapeB:null,closestA:w.v3BuildZero(),closestB:w.v3BuildZero()},this.narrowCache2={axis:this.narrowCache.axis,shapeA:null,shapeB:null,closestA:this.narrowCache.closestA,closestB:this.narrowCache.closestB},this.narrowFakeBody={transform:w.m43BuildIdentity(),shape:null},this.narrowTransform=w.m43BuildIdentity(),this.narrowExtents=new Float32Array(6));for(var f=null,g=
c.arbiters,h=d.arbiters,g=g.length<=h.length?g:h,n=0,h=g.length,n=0;n<h;n+=1){var e=g[n];if(e.shapeA===a&&e.shapeB===b&&e.objectA===c&&e.objectB===d){f=e;break}}if(null!==f&&f.skipDiscreteCollisions)f.skipDiscreteCollisions=!1;else{(g=null===f)&&(f=Qa.allocate(a,b,c,d));n=this.narrowCache;n.shapeA=a;n.shapeB=b;0!==f.contacts.length&&(h=f.contacts[0],n.axis[0]=h[12],n.axis[1]=h[13],n.axis[2]=h[14]);var r,h=!1;if("TRIANGLE_MESH"===a.type||"TRIANGLE_MESH"===b.type){var l,m=this.narrowTriangle,q=this.narrowCache2;
"TRIANGLE_MESH"===a.type?(l=a,e=c.transform,a=b,b=d.transform,q.shapeA=m,q.shapeB=n.shapeB):(l=b,e=d.transform,b=c.transform,q.shapeA=n.shapeA,q.shapeB=m);var p=l.triangleArray;m.triangleArray=p;m.collisionRadius=l.collisionRadius;var s;if(p.spatialMap){l=this.narrowTransform;r=this.narrowFakeBody;n=this.narrowExtents;w.m43InverseOrthonormal(e,l);w.m43Mul(b,l,r.transform);r.shape=a;kc.prototype.calculateExtents.call(r,n);l=this.persistantTrianglesList;s=p.spatialMap.getOverlappingNodes(n,l,0);for(n=
0;n<s;n+=1)r=l[n].index,m.index=r,l[n]=void 0,this.trianglePlaneDiscard(a,b,p,r,e)||(r=this.contactPairTest(q,c.transform,d.transform),0>r&&(f.insertContact(q.closestA,q.closestB,q.axis,r,!0),h=!0))}else{s=p.numTriangles;for(n=0;n<s;n+=1)m.index=n*zc.prototype.TRIANGLE_SIZE,this.trianglePlaneDiscard(a,b,p,m.index,e)||(r=this.contactPairTest(q,c.transform,d.transform),0>r&&(f.insertContact(q.closestA,q.closestB,q.axis,r,!0),h=!0))}}else r=this.contactPairTest(n,c.transform,d.transform),0>r&&(f.insertContact(n.closestA,
n.closestB,n.axis,r,!1),h=!0);h?(g&&(this.activeArbiters.push(f),f.active=!0,c.arbiters.push(f),d.arbiters.push(f)),c.permitSleep&&!c.active&&this.wakeBody(c),d.permitSleep&&!d.active&&this.wakeBody(d),f.active||(f.active=!0,this.activeArbiters.push(f))):g&&Qa.deallocate(f)}};Ha.prototype.computeSleeping=function(a){function b(a,b){var d=c(a),f=c(b);d!==f&&(d.islandRank<f.islandRank?d.islandRoot=f:d.islandRank>f.islandRank?f.islandRoot=d:(f.islandRoot=d,d.islandRank+=1))}function c(a){if(a===a.islandRoot)return a;
for(var b=null,c;a!==a.islandRoot;)c=a.islandRoot,a.islandRoot=b,b=a,a=c;for(;null!==b;)c=b.islandRoot,b.islandRoot=a,b=c;return a}var d,f,g=this.activeArbiters,h=this.activeBodies,n=this.activeConstraints,e,r=g.length;for(e=0;e<r;e+=1)f=g[e],d=f.objectA,f=f.objectB,d.permitSleep&&f.permitSleep&&b(d,f);r=n.length;for(e=0;e<r;e+=1)g=n[e],d=g.bodyA,f=g.bodyB,d&&d.permitSleep&&b(d,g),f&&f.permitSleep&&b(f,g);for(d=[];0<h.length;)g=h.pop(),e=c(g),f=e.island,f||(f=e.island=Yb.allocate(),d.push(f),f.active=
!1),g.island=f,f.bodies.push(g),f.active=f.active||g.isActive(a),g.wakeTimeStamp>f.wakeTimeStamp&&(f.wakeTimeStamp=g.wakeTimeStamp);for(;0<n.length;)g=n.pop(),e=c(g),f=e.island,f||(f=e.island=Yb.allocate(),d.push(f),f.active=!0),g.island=f,f.constraints.push(g),g.wakeTimeStamp>f.wakeTimeStamp&&(f.wakeTimeStamp=g.wakeTimeStamp);for(;0<d.length;)if(f=d.pop(),f.active){for(;0<f.bodies.length;)g=f.bodies.pop(),g.wakeTimeStamp=f.wakeTimeStamp,h.push(g),g.islandRoot=g,g.islandRank=0,g.island=null;for(;0<
f.constraints.length;)g=f.constraints.pop(),g.wakeTimeStamp=f.wakeTimeStamp,n.push(g),g.islandRoot=g,g.islandRank=0,g.island=null;Yb.deallocate(f)}else{r=f.bodies.length;for(e=0;e<r;e+=1)g=f.bodies[e],g.velocity[0]=g.velocity[1]=g.velocity[2]=0,g.velocity[3]=g.velocity[4]=g.velocity[5]=0,g.active=!1,this.syncBody(g),g.islandRoot=g,g.islandRank=0;r=f.constraints.length;for(e=0;e<r;e+=1)g=f.constraints[e],g.active=!1,g.islandRoot=g,g.islandRank=0}};Ha.prototype.wakeIsland=function(a){for(;0<a.bodies.length;){var b=
a.bodies.pop();b.wakeTimeStamp=this.timeStamp+(this.midStep?0:1);this.activeBodies.push(b);var c,d=b.arbiters,f=d.length;for(c=0;c<f;c+=1){var g=d[c];g.active||(g.active=!0,this.activeArbiters.push(g))}b.active=!0;b.island=null;this.syncBody(b)}for(;0<a.constraints.length;)b=a.constraints.pop(),b.wakeTimeStamp=this.timeStamp+(this.midStep?0:1),this.activeConstraints.push(b),b.active=!0,b.island=null;Yb.deallocate(a)};Ha.prototype.wakeRelated=function(a){var b=a.constraints,c,d=b.length;for(c=0;c<
d;c+=1)this.wakeConstraint(b[c]);a=a.arbiters;d=a.length;for(c=0;c<d;c+=1)b=a[c],b.active||(b.active=!0,this.activeArbiters.push(b)),b.objectA.permitSleep&&!b.objectA.active&&this.wakeBody(b.objectA),b.objectB.permitSleep&&!b.objectB.active&&this.wakeBody(b.objectB)};Ha.prototype.wakeBody=function(a){a.collisionObject&&!a.kinematic?(this.wakeRelated(a),this.syncBody(a)):a.kinematic?(a.delaySleep=!0,a.active||(a.active=!0,this.activeKinematics.push(a),this.wakeRelated(a),this.syncBody(a))):(a.wakeTimeStamp=
this.timeStamp+(this.midStep?0:1),a.active||(a.island?this.wakeIsland(a.island):(a.active=!0,this.activeBodies.push(a),this.wakeRelated(a),this.syncBody(a)),this.syncBody(a)))};Ha.prototype.syncBody=function(a){var b=this.syncExtents;a.calculateExtents(b);a.collisionObject&&!a.kinematic?this.staticSpatialMap.update(a,b):(a.active?a.previouslyActive?this.dynamicSpatialMap.update(a,b):(this.staticSpatialMap.remove(a),this.dynamicSpatialMap.add(a,b)):a.previouslyActive?(this.dynamicSpatialMap.remove(a),
this.staticSpatialMap.add(a,b)):this.staticSpatialMap.update(a,b),a.previouslyActive=a.active)};Ha.prototype.wakeConstraint=function(a){a.wakeTimeStamp=this.timeStamp+(this.midStep?0:1);a.active||(a.island?this.wakeIsland(a.island):(a.active=!0,this.activeConstraints.push(a),a.bodyA&&this.wakeBody(a.bodyA),a.bodyB&&this.wakeBody(a.bodyB)))};Ha.prototype.dynamicSweep=function(a,b,c,d){var f=a.objectA,g=a.objectB,h=a.axis,n=f.velocity,e=-n[0],r=-n[1],l=-n[2],m=g.velocity,e=e+m[0],r=r+m[1],l=l+m[2];
if(1E-8>e*e+r*r+l*l)a.toi=void 0;else{h[0]=e;h[1]=r;h[2]=l;var e=-e,r=-r,l=-l,q=0,p,s;f.fixedRotation||(p=f.shape.radius,q+=p*Math.sqrt(n[3]*n[3]+n[4]*n[4]+n[5]*n[5]));g.fixedRotation||(s=g.shape.radius,q+=s*Math.sqrt(m[3]*m[3]+m[4]*m[4]+m[5]*m[5]));if(q<0.5/b&&(n=(p<s?p:s)*(0.75/b),e*e+r*r+l*l<n*n)){a.toi=void 0;return}for(n=0;;){f.integratePosition(c*b);g.integratePosition(c*b);m=p=this.contactPairTest(a,f.transform,g.transform);void 0!==p&&(m+=d);if(void 0===m||m<Lc){this.seperatingTOI(a)?c=void 0:
a.distance=p;break}p=(q-(h[0]*e+h[1]*r+h[2]*l))*b;if(0>=p){c=void 0;break}c+=m/p;if(1<=c){c=void 0;break}n+=1;if(100<n){c=void 0;break}}a.toi=c}};Ha.prototype.seperatingTOI=function(a){var b=a.objectA,c=a.objectB,d=a.closestA,f=a.closestB,g=b.velocity,h=c.velocity,n=g[0]-h[0],e=g[1]-h[1],r=g[2]-h[2];if(!b.fixedRotation)var l=d[0]-b.transform[9],m=d[1]-b.transform[10],b=d[2]-b.transform[11],n=n+(g[4]*b-g[5]*m),e=e+(g[5]*l-g[3]*b),r=r+(g[3]*m-g[4]*l);c.fixedRotation||(g=f[0]-c.transform[9],l=f[1]-c.transform[10],
c=f[2]-c.transform[11],n-=h[4]*c-h[5]*l,e-=h[5]*g-h[3]*c,r-=h[3]*l-h[4]*g);a=a.axis;return 0<=n*a[0]+e*a[1]+r*a[2]};Ha.prototype.staticSweep=function(a,b,c,d){var f=a.objectA,g=a.objectB,h=a.axis,n=f.velocity,e=-n[0],r=-n[1],l=-n[2];if(1E-8>e*e+r*r+l*l)a.toi=void 0;else{h[0]=e;h[1]=r;h[2]=l;var e=-e,r=-r,l=-l,m=0;f.fixedRotationtype||(m+=f.shape.radius*Math.sqrt(n[3]*n[3]+n[4]*n[4]+n[5]*n[5]));for(n=0;;){f.integratePosition(c*b);var q=this.contactPairTest(a,f.transform,g.transform),p=q;void 0!==q&&
(p+=d);if(void 0===p||p<Lc){this.seperatingTOI(a)?c=void 0:a.distance=q;break}q=(m-(h[0]*e+h[1]*r+h[2]*l))*b;if(0>=q){c=void 0;break}c+=p/q;if(1<=c){c=void 0;break}n+=1;if(100<n){c=void 0;break}}a.toi=c}};Ha.prototype.performStaticTOIBase=function(a,b,c,d,f,g){var h=this.persistantTrianglesList;void 0===this.continuousFakeBody&&(this.continuousFakeBody={shape:null,transform:w.m43BuildIdentity(),startTransform:w.m43BuildIdentity()},this.continuousInvTransform=w.m43BuildIdentity(),this.continuousExtents=
new Float32Array(6));var n=this.continuousFakeBody,e=this.continuousInvTransform,r=this.continuousExtents;if("TRIANGLE_MESH"===g.shape.type){var l=g.shape.triangleArray;if(l.spatialMap){n.shape=f.shape;w.m43InverseOrthonormal(g.transform,e);w.m43Mul(f.startTransform,e,n.startTransform);w.m43Mul(f.endTransform,e,n.transform);kc.prototype.calculateSweptExtents.call(n,r);e=l.spatialMap.getOverlappingNodes(r,h,0);for(r=0;r<e;r+=1)n=eb.allocate(),n.objectA=f,n.objectB=g,n.shapeA=f.shape,n.shapeB=vb.allocate(),
n.shapeB.index=h[r].index,h[r]=void 0,n.shapeB.triangleArray=g.shape.triangleArray,n.shapeB.collisionRadius=g.shape.collisionRadius,n.concave=!0,this.staticSweep(n,b,0,a),void 0===n.toi?eb.deallocate(n):(n.frozenA=!1,n.frozenB=!0,c[d]=n,d+=1)}else{e=l.numTriangles;for(r=0;r<e;r+=1)n=eb.allocate(),n.objectA=f,n.objectB=g,n.shapeA=f.shape,n.shapeB=vb.allocate(),n.shapeB.index=r*zc.prototype.TRIANGLE_SIZE,n.shapeB.triangleArray=g.shape.triangleArray,n.shapeB.collisionRadius=g.shape.collisionRadius,n.concave=
!0,this.staticSweep(n,b,0,a),void 0===n.toi?eb.deallocate(n):(n.frozenA=!1,n.frozenB=!0,c[d]=n,d+=1)}}else{n=eb.allocate();n.objectA=f;n.objectB=g;n.shapeA=f.shape;n.shapeB=g.shape;this.staticSweep(n,b,0,a);if(void 0===n.toi)return eb.deallocate(n),d;n.frozenA=!1;n.frozenB=!0;c[d]=n;d+=1}return d};Ha.prototype.update=function(){var a=this.dynamicSpatialMap,b=this.staticSpatialMap,c=this.activeBodies,d=this.activeKinematics,f=this.activeConstraints,g=this.activeArbiters,h=this.gravity,n=this.performanceData;
n.discrete=0;n.sleepComputation=0;n.prestepContacts=0;n.prestepConstraints=0;n.integrateVelocities=0;n.warmstartContacts=0;n.warmstartConstraints=0;n.physicsIterations=0;n.integratePositions=0;n.continuous=0;var e=this.prevTimeStamp;if(void 0===e)this.prevTimeStamp=0.001*TurbulenzEngine.getTime();else{var r=0.001*TurbulenzEngine.getTime()-e,l;if(this.variableStep){var m=this.variableMinStep,e=Math.ceil(r/this.variableMaxStep);l=r/e;l<m&&(l=m,e=Math.floor(r/l))}else l=this.fixedTimeStep,e=Math.floor(r/
l);e>this.maxSubSteps&&0!==this.maxGiveUpTimeStep&&(e=Math.ceil(r/this.maxGiveUpTimeStep),l=r/e);if(!(0>=e)){this.prevTimeStamp+=l*e;e>this.maxSubSteps&&(e=this.maxSubSteps);this.midStep=!0;var q,p,s;q=d.length;for(p=0;p<q;)s=d[p],!s.computeDeltaVelocity(l*e,s.prevTransform,s.transform)&&!s.delaySleep?(s.active=!1,q-=1,d[p]=d[q],d.pop(),this.syncBody(s)):(w.m43Copy(s.transform,s.newTransform),w.m43Copy(s.prevTransform,s.transform),p+=1),s.delaySleep=!1;for(r=0;r<e;r+=1){var i,k;this.timeStamp+=1;
void 0===this.prevTimeStep&&(this.prevTimeStep=l);var z=l/this.prevTimeStep;this.prevTimeStep=l;q=c.length;for(p=0;p<q;p+=1)s=c[p],k=s.extents,s.calculateExtents(k),a.update(s,k),s.refreshInertiaTensor();q=d.length;for(p=0;p<q;p+=1)s=d[p],k=s.extents,s.calculateExtents(k),a.update(s,k);m=0.001*TurbulenzEngine.getTime();b.finalize();a.finalize();var B=this.persistantObjectsList,y=i=a.getOverlappingPairs(B,0),v;q=c.length;for(p=0;p<q;p+=1)s=c[p],v=b.getOverlappingNodes(s.extents,B,y+1),0!==v&&(B[y]=
s,y+=1+v,B[y]=s,y+=1);q=d.length;for(p=0;p<q;p+=1)s=d[p],v=b.getOverlappingNodes(s.extents,B,y+1),0!==v&&(B[y]=s,y+=1+v,B[y]=s,y+=1);for(p=0;p<i;p+=2)q=B[p],s=B[p+1],B[p]=void 0,B[p+1]=void 0,this.filtered(q,s)||(q.id<s.id?this.narrowPhase(q.shape,s.shape,q,s):this.narrowPhase(s.shape,q.shape,s,q));for(p=i;p<y;){q=B[p];B[p]=void 0;for(p+=1;;){s=B[p];B[p]=void 0;p+=1;if(q===s)break;this.filtered(q,s)||(q.id<s.id?this.narrowPhase(q.shape,s.shape,q,s):this.narrowPhase(s.shape,q.shape,s,q))}}n.discrete+=
0.001*TurbulenzEngine.getTime()-m;m=0.001*TurbulenzEngine.getTime();this.computeSleeping(l);n.sleepComputation+=0.001*TurbulenzEngine.getTime()-m;m=0.001*TurbulenzEngine.getTime();for(p=0;p<g.length;)i=g[p],!i.objectA.active&&!i.objectB.active?(i.active=!1,g[p]=g[g.length-1],g.pop()):i.refreshContacts()?(g[p]=g[g.length-1],g.pop(),q=i.objectA,s=i.objectB,y=q.arbiters,y[y.indexOf(i)]=y[y.length-1],y.pop(),y=s.arbiters,y[y.indexOf(i)]=y[y.length-1],y.pop(),q.contactCallbacks&&q.contactCallbacks.onRemovedContacts||
s.contactCallbacks&&s.contactCallbacks.onRemovedContacts?this.contactCallbackRemovedArbiters.push(i):Qa.deallocate(i)):(i.preStep(z,l),p+=1);n.prestepContacts+=0.001*TurbulenzEngine.getTime()-m;m=0.001*TurbulenzEngine.getTime();q=f.length;for(p=0;p<q;p+=1)f[p].preStep(z,l);n.prestepConstraints+=0.001*TurbulenzEngine.getTime()-m;m=0.001*TurbulenzEngine.getTime();q=c.length;for(p=0;p<q;p+=1)s=c[p],s.integrateVelocity(h,l);n.integrateVelocities+=0.001*TurbulenzEngine.getTime()-m;m=0.001*TurbulenzEngine.getTime();
q=g.length;for(p=0;p<q;p+=1)g[p].applyCachedImpulses();n.warmstartContacts+=0.001*TurbulenzEngine.getTime()-m;m=0.001*TurbulenzEngine.getTime();q=f.length;for(p=0;p<q;p+=1)f[p].applyCachedImpulses();n.warmstartConstraints+=0.001*TurbulenzEngine.getTime()-m;m=0.001*TurbulenzEngine.getTime();z=10;for(p=0;p<z;p+=1){q=g.length;for(i=0;i<q;i+=1)g[i].computeAndApplyImpulses();q=f.length;for(i=0;i<q;i+=1)f[i].computeAndApplyImpulses()}z=3;q=g.length;for(p=0;p<z;p+=1)for(i=0;i<q;i+=1)g[i].computeAndApplyBiasImpulses();
n.physicsIterations+=0.001*TurbulenzEngine.getTime()-m;z=this.persistantObjectsList2;y=0;m=0.001*TurbulenzEngine.getTime();q=c.length;var x=l*l;for(p=0;p<q;p+=1)s=c[p],s.applyBiasVelocities(l),s.integratePosition(l),s.isActiveVelocity(0.35/l,0.25/l)?(k=s.transform,i=s.endTransform,i[0]=k[0],i[1]=k[1],i[2]=k[2],i[3]=k[3],i[4]=k[4],i[5]=k[5],i[6]=k[6],i[7]=k[7],i[8]=k[8],i[9]=k[9],i[10]=k[10],i[11]=k[11],k=0.75*s.shape.radius,i=s.velocity,v=(i[3]*i[3]+i[4]*i[4]+i[5]*i[5])*x,s.bullet=(i[0]*i[0]+i[1]*
i[1]+i[2]*i[2])*x>k*k||0.5<v,k=s.extents,s.calculateSweptExtents(k),a.update(s,k),s.sweepFrozen=!1,z[y]=s,y+=1):(s.sweepFrozen=!0,s.bullet=!1);q=d.length;for(p=0;p<q;p+=1)s=d[p],w.m43Copy(s.transform,s.startTransform),s.integratePosition(l),k=s.extents,s.calculateSweptExtents(k),a.update(s,k);n.integratePositions+=0.001*TurbulenzEngine.getTime()-m;m=0.001*TurbulenzEngine.getTime();b.finalize();a.finalize();x=this.persistantTOIEventList;k=0;var J;i=a.getOverlappingPairs(B,0);for(p=0;p<i;p+=2)q=B[p],
s=B[p+1],B[p]=void 0,B[p+1]=void 0,!q.bullet&&!q.kinematic&&!s.bullet&&!s.kinematic||(q.sweepFrozen&&s.sweepFrozen||this.filtered(q,s))||(q.kinematic||s.kinematic?k=q.kinematic?this.performStaticTOIBase(0.03,l,x,k,s,q):this.performStaticTOIBase(0.03,l,x,k,q,s):(J=eb.allocate(),J.objectA=q,J.objectB=s,J.shapeA=q.shape,J.shapeB=s.shape,this.dynamicSweep(J,l,0,0.03),J.frozenA=q.sweepFrozen,J.frozenB=s.sweepFrozen,x[k]=J,k+=1));for(p=0;p<y;p+=1){q=z[p];v=b.getOverlappingNodes(q.extents,B,0);for(i=0;i<
v;i+=1)s=B[i],B[i]=void 0,this.filtered(q,s)||(k=this.performStaticTOIBase(0.03,l,x,k,q,s))}for(B=0;1>B&&0<k;){v=null;var C;for(p=0;p<k;)if(J=x[p],q=J.objectA,s=J.objectB,q.sweepFrozen&&s.sweepFrozen)k-=1,p!==k&&(x[p]=x[k],x[k]=void 0),eb.deallocate(J);else{if(J.frozenA!==q.sweepFrozen||J.frozenB!==s.sweepFrozen)if(J.frozenA=q.sweepFrozen,J.frozenB=s.sweepFrozen,J.frozenA&&(J.objectA=s,J.objectB=q,J.shapeA=s.shape,J.shapeB=q.shape,J.frozenA=!1,J.frozenB=!0),this.staticSweep(J,l,B,0.03),void 0===J.toi){k-=
1;p!==k&&(x[p]=x[k],x[k]=void 0);eb.deallocate(J);continue}if(void 0!==J.toi&&(null===v||J.toi<v.toi))v=J,C=p;p+=1}if(null===v)break;k-=1;C!==k&&(x[C]=x[k],x[k]=void 0);B=v.toi;q=v.objectA;s=v.objectB;q.collisionObject||(q.sweepFrozen||(q.integratePosition(l*B),q.sweepFrozen=!0),q.permitSleep&&!q.active&&this.wakeBody(q));s.collisionObject||(s.sweepFrozen||(s.integratePosition(l*B),s.sweepFrozen=!0),s.permitSleep&&!s.active&&this.wakeBody(s));q.id>s.id&&(p=q,q=s,s=p,p=v.closestA,v.closestA=v.closestB,
v.closestB=p,p=v.axis,p[0]=-p[0],p[1]=-p[1],p[2]=-p[2]);J=q.shape;var t=s.shape;i=null;p=q.arbiters;var Q=s.arbiters,Q=p.length<=Q.length?p:Q,V=Q.length;for(p=0;p<V;p+=1){var A=Q[p];if(A.shapeA===J&&A.shapeB===t&&A.objectA===q&&A.objectB===s){i=A;break}}(p=null===i)&&(i=Qa.allocate(J,t,q,s));i.insertContact(v.closestA,v.closestB,v.axis,v.distance,v.concave);p&&(g.push(i),i.active=!0,q.arbiters.push(i),s.arbiters.push(i));q.kinematic&&q.active||s.kinematic&&s.active||(i.skipDiscreteCollisions=!0);
eb.deallocate(v)}for(;0<k;)k-=1,eb.deallocate(x[k]),x[k]=void 0;for(;0<y;)y-=1,q=z[y],z[y]=void 0,q.sweepFrozen||q.integratePosition(l);n.continuous+=0.001*TurbulenzEngine.getTime()-m}q=d.length;for(p=0;p<q;p+=1)s=d[p],w.m43Copy(s.newTransform,s.transform),w.m43Copy(s.newTransform,s.prevTransform);this.updateContactCallbacks();this.midStep=!1}}};Ha.prototype.rayTest=function(a){var b=a.group,c=a.mask;void 0===b&&(b=Ka.prototype.FILTER_DYNAMIC);void 0===c&&(c=Ka.prototype.FILTER_ALL);var d=a.exclude,
a={origin:a.from,direction:w.v3Sub(a.to,a.from),maxFactor:1};this.staticSpatialMap.finalize();this.dynamicSpatialMap.finalize();a=xa.rayTest([this.staticSpatialMap,this.dynamicSpatialMap],a,function(a,g,h,n,e){a=g._public;if(a===d||0===(g.mask&b)||0===(g.group&c))return null;h.maxFactor=e;h=g.rayTest(h);null!==h&&(g.collisionObject?(h.collisionObject=a,h.body=null):(h.collisionObject=null,h.body=a));return h});null!==a&&delete a.factor;return a};Ha.prototype.contactPairTest=function(a,b,c){var d=
a.axis,f=a.shapeA,g=a.shapeB,h=a.closestA,n=a.closestB;void 0===this.contactGJK&&(this.contactGJK=Xb.create(),this.contactEPA=qb.create());if("PLANE"===f.type||"PLANE"===g.type){var e,r,l;"PLANE"===f.type?(a=f,r=b,e=g,l=c):(a=g,r=c,e=f,l=b);var m=r[0],q=r[1],c=r[2],p=r[3],s=r[4],i=r[5],k=r[6],z=r[7],B=r[8],y=r[9],v=r[10],x=r[11];r=a.normal;var J=r[0],C=r[1],t=r[2],Q=a.distance;r=J*m+C*p+t*k;var g=J*q+C*s+t*z,b=J*c+C*i+t*B,m=l[0],q=l[1],c=l[2],p=l[3],s=l[4],i=l[5],k=l[6],z=l[7],B=l[8],w=l[9],A=l[10];
l=l[11];J=m*r+q*g+c*b;C=p*r+s*g+i*b;t=k*r+z*g+B*b;Q+=r*(y-w)+g*(v-A)+b*(x-l);d[0]=J;d[1]=C;d[2]=t;e.localSupportWithoutMargin(d,h);d[0]=-J;d[1]=-C;d[2]=-t;e.localSupportWithoutMargin(d,n);v=h[0]*J+h[1]*C+h[2]*t-Q;t=n[0]*J+n[1]*C+n[2]*t-Q;v*v<t*t?(J=h[0],C=h[1],x=h[2],y=v):(J=n[0],C=n[1],x=n[2],y=t);0>y!==0>v*t&&(y=-y,r=-r,g=-g,b=-b);e=e.collisionRadius;a=a.collisionRadius;m=m*J+p*C+k*x+w;q=q*J+s*C+z*x+A;c=c*J+i*C+B*x+l;s=a-y;i=m+r*s;B=q+g*s;s=c+b*s;m-=r*e;q-=g*e;c-=b*e;"PLANE"===f.type?(d[0]=-r,d[1]=
-g,d[2]=-b,h[0]=i,h[1]=B,h[2]=s,n[0]=m,n[1]=q,n[2]=c):(d[0]=r,d[1]=g,d[2]=b,h[0]=m,h[1]=q,h[2]=c,n[0]=i,n[1]=B,n[2]=s);return y-(e+a)}i=this.contactGJK;r=i.evaluate(a,b,c);void 0===r&&(r=this.contactEPA.evaluate(i.simplex,a,b,c));if(void 0!==r)return b=d[0],a=d[1],d=d[2],f=f.collisionRadius,g=g.collisionRadius,h[0]-=b*f,h[1]-=a*f,h[2]-=d*f,n[0]+=b*g,n[1]+=a*g,n[2]+=d*g,r-f-g};Ha.prototype.convexSweepTest=function(a,b){function c(a,b,c,f,g,h){var n=c[0],e=c[1],c=c[2],j=d.axis,l=d.closestA,r=d.closestB;
j[0]=-n;j[1]=-e;j[2]=-c;d.shapeA=a;d.shapeB=f;for(var f=a=0,m,p=Number.MAX_VALUE,s=!1;;){var i=q.contactPairTest(d,b,g);if(void 0===i||i<Lc){if(void 0!==m||void 0!==i)void 0===m&&(m=i),s=!0;break}if(1<=i-p)break;var p=i,k=n*(r[0]-l[0])+e*(r[1]-l[1])+c*(r[2]-l[2]);if(k<=Mc)break;k=i*i/k;a+=k;if(a>=h){m=void 0;break}m=i;b[9]+=n*k;b[10]+=e*k;b[11]+=c*k;if(m<=Lc){s=!0;break}f+=1;if(100<f)break}return void 0===m||!s?null:{hitPoint:w.v3Copy(r),hitNormal:w.v3Copy(j),distance:a}}void 0===this.sweepCache&&
(this.sweepCache={axis:w.v3BuildZero(),shapeA:null,shapeB:null,closestA:w.v3BuildZero(),closestB:w.v3BuildZero()},this.sweepTriangle=vb.allocate(),this.sweepDelta=w.v3BuildZero(),this.sweepFromExtents=new Float32Array(6),this.sweepToExtents=new Float32Array(6),this.sweepExtents=new Float32Array(6),this.sweepFakeBody={shape:null,transform:null},this.sweepTransform=w.m43BuildIdentity(),this.sweepTransform2=w.m43BuildIdentity());var d=this.sweepCache,f=this.sweepTriangle,g=this.sweepDelta,h=this.sweepFromExtents,
n=this.sweepToExtents,e=this.sweepExtents,r=this.sweepFakeBody,l=this.sweepTransform,m=this.sweepTransform2,q=this,p=a.shape._private,s=a.from,i=a.to,k=i[9]-s[9],z=i[10]-s[10],B=i[11]-s[11],y=Math.sqrt(k*k+z*z+B*B),v=1/y;g[0]=k*v;g[1]=z*v;g[2]=B*v;k=void 0===a.group?Ka.prototype.FILTER_DYNAMIC:a.group;z=void 0===a.mask?Ka.prototype.FILTER_ALL:a.mask;B=a.exclude;r.shape=p;r.transform=s;kc.prototype.calculateExtents.call(r,h);r.transform=i;kc.prototype.calculateExtents.call(r,n);e[0]=h[0]<n[0]?h[0]:
n[0];e[1]=h[1]<n[1]?h[1]:n[1];e[2]=h[2]<n[2]?h[2]:n[2];e[3]=h[3]>n[3]?h[3]:n[3];e[4]=h[4]>n[4]?h[4]:n[4];e[5]=h[5]>n[5]?h[5]:n[5];this.staticSpatialMap.finalize();this.dynamicSpatialMap.finalize();var v=this.persistantObjectsList,x=this.persistantTrianglesList,J=this.staticSpatialMap.getOverlappingNodes(e,v,0),J=J+this.dynamicSpatialMap.getOverlappingNodes(e,v,J),C=null,t,Q;for(t=0;t<J;t+=1){var V=v[t];v[t]=void 0;var A=V._public;if(!(A===B||V.shape===p||0===(V.mask&k)||0===(V.group&z))){var K;Q=
V.shape;if("TRIANGLE_MESH"===Q.type){K=Q.triangleArray;f.triangleArray=K;f.collisionRadius=Q.collisionRadius;var E;if(K.spatialMap){w.m43InverseOrthonormal(V.transform,m);w.m43Mul(s,m,l);r.transform=l;kc.prototype.calculateExtents.call(r,h);w.m43Mul(i,m,l);kc.prototype.calculateExtents.call(r,n);e[0]=h[0]<n[0]?h[0]:n[0];e[1]=h[1]<n[1]?h[1]:n[1];e[2]=h[2]<n[2]?h[2]:n[2];e[3]=h[3]>n[3]?h[3]:n[3];e[4]=h[4]>n[4]?h[4]:n[4];e[5]=h[5]>n[5]?h[5]:n[5];E=K.spatialMap.getOverlappingNodes(e,x,0);for(Q=0;Q<E;Q+=
1)if(f.index=x[Q].index,x[Q]=void 0,w.m43Copy(s,m),K=c(p,m,g,f,V.transform,y))if(K.collisionObject=A,K.body=null,!b||b(K))C=K,y=K.distance}else{E=K.numTriangles;for(Q=0;Q<E;Q+=1)if(f.index=Q*zc.prototype.TRIANGLE_SIZE,w.m43Copy(s,m),K=c(p,m,g,f,V.transform,y))if(K.collisionObject=A,K.body=null,!b||b(K))C=K,y=K.distance}}else if(w.m43Copy(s,m),K=c(p,m,g,Q,V.transform,y))if(V.collisionObject?(K.collisionObject=A,K.body=null):(K.collisionObject=null,K.body=A),!b||b(K))C=K,y=K.distance;if(1E-4>y){for(Q=
t;Q<J;Q+=1)v[Q]=void 0;break}}}C&&delete C.distance;return C};Ha.prototype.addBody=function(a){if(a.world)return!1;a.world=this;if(a.collisionObject&&!a.kinematic)return this.collisionObjects.push(a),this.syncBody(a),!0;a.kinematic?this.kinematicBodies.push(a):this.rigidBodies.push(a);var b=!a.active;a.previouslyActive=!0;a.active=!1;a.islandRoot=a;a.islandRank=0;b?this.syncBody(a):this.wakeBody(a);return!0};Ha.prototype.removeBody=function(a){if(a.world!==this)return!1;var b,c;a.collisionObject&&
!a.kinematic?b=this.collisionObjects:a.kinematic?(b=this.kinematicBodies,c=this.activeKinematics):(b=this.rigidBodies,c=this.activeBodies);a.world=null;b[b.indexOf(a)]=b[b.length-1];b.pop();c&&a.active?(c[c.indexOf(a)]=c[c.length-1],c.pop(),this.dynamicSpatialMap.remove(a)):this.staticSpatialMap.remove(a);this.removeArbitersFromObject(a);this.removeFromContactCallbacks(a);if(b=a.island)b=b.bodies,c=b.indexOf(a),-1!==c&&(b[c]=b[b.length-1],b.pop()),a.island=null;return!0};Ha.prototype.addConstraint=
function(a){if(a.world)return!1;a.world=this;this.constraints.push(a);a.bodyA&&a.bodyA.constraints.push(a);a.bodyB&&a.bodyB.constraints.push(a);var b=!a.active;a.active=!1;a.islandRoot=a;a.islandRank=0;b||this.wakeConstraint(a);return!0};Ha.prototype.removeConstraint=function(a){if(a.world!==this)return!1;a.world=null;var b=this.constraints;b[b.indexOf(a)]=b[b.length-1];b.pop();a.bodyA&&(b=a.bodyA.constraints,b[b.indexOf(a)]=b[b.length-1],b.pop());a.bodyB&&(b=a.bodyA.constraints,b[b.indexOf(a)]=b[b.length-
1],b.pop());a.active&&(b=this.activeConstraints,b[b.indexOf(a)]=b[b.length-1],b.pop());if(b=a.island){var b=b.constraints,c=b.indexOf(a);-1!==c&&(b[c]=b[b.length-1],b.pop());a.island=null}return!0};Ha.prototype.flush=function(){for(;0<this.rigidBodies.length;)this.removeBody(this.rigidBodies[0]);for(;0<this.collisionObjects.length;)this.removeBody(this.collisionObjects[0]);for(;0<this.kinematicBodies.length;)this.removeBody(this.kinematicBodies[0]);for(;0<this.constraints.length;)this.removeConstraint(this.constraints[0]);
this.timeStamp=0};Ha.prototype.removeArbitersFromObject=function(a){for(var b=a.arbiters,c=this.activeArbiters;0<b.length;){var d=b.pop(),f=d.objectA===a?d.objectB.arbiters:d.objectA.arbiters;f[f.indexOf(d)]=f[f.length-1];f.pop();d.active&&(c[c.indexOf(d)]=c[c.length-1],c.pop());for(;0<d.contacts.length;)f=d.contacts.pop(),Jb.deallocate(f);Qa.deallocate(d)}};Ha.prototype.removeFromContactCallbacks=function(a){var b=this.contactCallbackObjects,c=b.length,d;for(d=0;d<c;d+=1)if(b[d]===a){c-=1;d<c&&(b[d]=
b[c]);b.length=c;break}a.addedToContactCallbacks=!1};Ha.prototype.updateContactCallbacks=function(){for(var a=this.contactCallbackObjects,b=a.length,c=Jb.publicContacts,d=Jb.callbackContacts,f,g,h,n,e,r=0;r<b;){f=a[r];var l=f.arbiters,m=l.length;if(0===m)f.contactCallbacks.added=!1,b-=1,r<b&&(a[r]=a[b]),a.length=b;else{var q;for(q=0;q<m;q+=1)if(f=l[q],0!==f.contactFlags){for(var p=f.contacts,s=p.length;c.length<s;)c[c.length]=Cd.create();d.length=s;for(g=0;g<s;g+=1)h=c[g],h._private=p[g],d[g]=h;g=
f.objectA;h=f.objectB;n=g.contactCallbacks;e=h.contactCallbacks;if(f.contactFlags&1){if(null!==n&&n.onAddedContacts)n.onAddedContacts(g._public,h._public,d);if(null!==e&&e.onAddedContacts)e.onAddedContacts(g._public,h._public,d)}if(f.contactFlags&2){if(null!==n&&n.onProcessedContacts)n.onProcessedContacts(g._public,h._public,d);if(null!==e&&e.onProcessedContacts)e.onProcessedContacts(g._public,h._public,d)}if(f.contactFlags&4){if(null!==n&&n.onRemovedContacts)n.onRemovedContacts(g._public,h._public,
d);if(null!==e&&e.onRemovedContacts)e.onRemovedContacts(g._public,h._public,d)}for(g=f.contactFlags=0;g<s;g+=1)p[g][51]=0}r+=1}}a=this.contactCallbackRemovedArbiters;b=a.length;for(r=d.length=0;r<b;r+=1){f=a[r];g=f.objectA;h=f.objectB;n=g.contactCallbacks;e=h.contactCallbacks;if(null!==n&&n.onRemovedContacts)n.onRemovedContacts(g._public,h._public,d);if(null!==e&&e.onRemovedContacts)e.onRemovedContacts(g._public,h._public,d);Qa.deallocate(f)}a.length=0};Ha.version=1;Lg=Ha;var Ka,Ra=function(){this.vendor=
"Turbulenz";this.genObjectId=0};Ra.create=function(){return new Ra};Ra.prototype.createDynamicsWorld=function(a){return fb.create(a)};Ra.prototype.createPlaneShape=function(a){return Ad.create(a)};Ra.prototype.createBoxShape=function(a){return Uc.create(a)};Ra.prototype.createSphereShape=function(a){return Tc.create(a)};Ra.prototype.createCapsuleShape=function(a){return yc.create(a)};Ra.prototype.createCylinderShape=function(a){return Vc.create(a)};Ra.prototype.createConeShape=function(a){return Wc.create(a)};
Ra.prototype.createTriangleMeshShape=function(a){return Bd.create(a)};Ra.prototype.createConvexHullShape=function(a){return Xc.create(a)};Ra.prototype.createTriangleArray=function(a){return we.create(a)};Ra.prototype.createCollisionObject=function(a){return pb.create(a)};Ra.prototype.createRigidBody=function(a){return Yc.create(a)};Ra.prototype.createPoint2PointConstraint=function(a){return ye.create(a)};Ra.prototype.createHingeConstraint=function(a){return Wb.create("HINGE",a)};Ra.prototype.createConeTwistConstraint=
function(a){return Wb.create("CONETWIST",a)};Ra.prototype.create6DOFConstraint=function(a){return Wb.create("D6",a)};Ra.prototype.createSliderConstraint=function(a){return Wb.create("SLIDER",a)};Ra.prototype.createCharacter=function(a){return Zc.create(a)};Ra.version=1;Ka=Ra;Ka.prototype.FILTER_DYNAMIC=1;Ka.prototype.FILTER_STATIC=2;Ka.prototype.FILTER_KINEMATIC=4;Ka.prototype.FILTER_DEBRIS=8;Ka.prototype.FILTER_TRIGGER=16;Ka.prototype.FILTER_CHARACTER=32;Ka.prototype.FILTER_PROJECTILE=64;Ka.prototype.FILTER_USER_MIN=
128;Ka.prototype.FILTER_USER_MAX=32768;Ka.prototype.FILTER_ALL=65535;var ze=function(){};ze.prototype.destroy=function(){this.audioContext?(delete this.audioContext,delete this.buffer):delete this.audio};ze.create=function(a,b){var c=new ze,d=b.src;c.name=b.name||d;c.frequency=0;c.channels=0;c.bitrate=0;c.length=0;c.compressed=!b.uncompress;var f=b.onload,g,h,n,e=a.audioContext;if(e){c.audioContext=e;var r;if(d){if(!a.isResourceSupported(d))return f&&f(null),null;var l=function(a){a?(c.buffer=a,c.frequency=
a.sampleRate,c.channels=a.numberOfChannels,c.bitrate=16*c.frequency*c.channels,c.length=a.duration,f&&f(c,200)):f&&f(null)},m=function(){f&&f(null)};if(g=b.data)e.decodeAudioData?e.decodeAudioData(g,l,m):(r=e.createBuffer(g,!1),l(r));else{var q;if(window.XMLHttpRequest)q=new window.XMLHttpRequest;else if(window.ActiveXObject)q=new window.ActiveXObject("Microsoft.XMLHTTP");else return f&&f(null),null;q.onreadystatechange=function(){if(4===q.readyState){if(!TurbulenzEngine||!TurbulenzEngine.isUnloading()){var a=
q.status,b=q.response;""===q.getAllResponseHeaders()&&!b?f&&f(null,0):200===a||0===a?e.decodeAudioData?e.decodeAudioData(b,l,m):(a=e.createBuffer(b,!1),l(a)):f&&f(null,a)}q=q.onreadystatechange=null}};q.open("GET",d,!0);q.responseType="arraybuffer";q.setRequestHeader("Content-Type","text/plain");q.send(null)}return c}if(g=b.data){d=g.length;h=b.channels||1;n=b.frequency;r=Math.min(e.sampleRate,96E3);var p,s,i,k;if(r===n){r=e.createBuffer(h,d/h,n);for(p=0;p<h;p+=1){s=r.getChannelData(p);i=p;for(k=
0;i<d;i+=h,k+=1)s[k]=g[i]}}else{i=n/r;var z=d/(i*h)|0;r=e.createBuffer(h,z,r);for(p=0;p<h;p+=1){s=r.getChannelData(p);for(k=0;k<z;k+=1)s[k]=g[p+(k*i|0)*h]}}if(r)return c.buffer=r,c.frequency=n,c.channels=h,c.bitrate=16*n*h,c.length=d/(n*h),f&&f(c,200),c}}else{var B;if(d){h=d.slice(-3);if(g=b.data)g=g instanceof Uint8Array?g:new Uint8Array(g),79===g[0]&&103===g[1]&&103===g[2]&&83===g[3]?(h="ogg",d="data:audio/ogg;base64,"):82===g[0]&&73===g[1]&&70===g[2]&&70===g[3]?(h="wav",d="data:audio/wav;base64,"):
(h="mp3",d="data:audio/mpeg;base64,"),d+=TurbulenzEngine.base64Encode(g);if(!a.supportedExtensions[h])return f&&f(null),null;B=new Audio;B.preload="auto";B.autobuffer=!0;B.src=d;B.onerror=function(){f&&(f(null),f=null)};a.addLoadingSound(function(){if(3<=B.readyState){c.frequency=B.sampleRate||B.mozSampleRate;c.channels=B.channels||B.mozChannels;c.bitrate=16*c.frequency*c.channels;c.length=B.duration;if(B.buffered&&B.buffered.length&&0<B.buffered.end(0)){if(isNaN(c.length)||c.length===Number.POSITIVE_INFINITY)c.length=
B.buffered.end(0);f&&(f(c,200),f=null)}else{var a=function(){B.pause();B.removeEventListener("play",a,!1);f&&(f(c,200),f=null)};B.addEventListener("play",a,!1);B.volume=0;B.play()}return!0}return!1});c.audio=B;return c}if(g=b.data){B=new Audio;if(B.mozSetup)return d=g.length,h=b.channels||1,n=b.frequency,B.mozSetup(h,n),c.data=g,c.frequency=n,c.channels=h,c.bitrate=16*n*h,c.length=d/(n*h),c.audio=B,f&&f(c,200),c;B=null}}f&&f(null);return null};ze.version=1;var rb=function(){};rb.prototype.play=function(a,
b){var c=this.audioContext;if(c){var d=this.bufferNode;if(this.sound!==a)d&&d.stop(0);else if(d)return this.seek(b);d=this.createBufferNode(a);this.sound=a;this.playing||(this.playing=!0,this.paused=!1,this.sd.addPlayingSource(this));void 0===b&&(b=0);if(0<b){var f=a.buffer;d.loop?d.start(0,b,f.duration):d.start(0,b,f.duration-b);this.playStart=c.currentTime-b}else d.start(0),this.playStart=c.currentTime}else{if(this.sound!==a)this.stop(),a.data?(c=new Audio,c.mozSetup(a.channels,a.frequency)):c=
a.audio.cloneNode(!0),this.sound=a,this.audio=c,c.loop=this.looping,c.addEventListener("ended",this.loopAudio,!1);else{if(this.playing&&!this.paused&&this.looping)return!0;c=this.audio}this.playing||(this.playing=!0,this.paused=!1,this.sd.addPlayingSource(this));void 0===b&&(b=0);if(0.05<Math.abs(c.currentTime-b))try{c.currentTime=b}catch(g){}a.data?c.mozWriteAudio(a.data):c.play()}return!0};rb.prototype.stop=function(){var a=this.playing;if(a){this.paused=this.playing=!1;if(this.audioContext){this.sound=
null;var b=this.bufferNode;b&&(b.stop(0),b.disconnect(),this.bufferNode=null)}else if(b=this.audio)this.audio=this.sound=null,b.pause(),b.removeEventListener("ended",this.loopAudio,!1);this.sd.removePlayingSource(this)}return a};rb.prototype.pause=function(){if(this.playing){if(!this.paused){this.paused=!0;var a=this.audioContext;a?(this.playPaused=a.currentTime,this.bufferNode.stop(0),this.bufferNode.disconnect(),this.bufferNode=null):this.audio.pause();this.sd.removePlayingSource(this)}return!0}return!1};
rb.prototype.resume=function(a){if(this.paused){this.paused=!1;var b=this.audioContext;if(b){void 0===a&&(a=this.playPaused-this.playStart);var c=this.createBufferNode(this.sound);if(0<a){var d=this.sound.buffer;c.loop?c.start(0,a,d.duration):c.start(0,a,d.duration-a);this.playStart=b.currentTime-a}else c.start(0),this.playStart=b.currentTime}else{b=this.audio;if(void 0!==a&&0.05<Math.abs(b.currentTime-a))try{b.currentTime=a}catch(f){}b.play()}this.sd.addPlayingSource(this);return!0}return!1};rb.prototype.rewind=
function(){if(this.playing){var a=this.audioContext;if(a){var b=this.bufferNode;b&&b.stop(0);b=this.createBufferNode(this.sound);b.start(0);this.playStart=a.currentTime;return!0}if(a=this.audio)return a.currentTime=0,!0}return!1};rb.prototype.seek=function(a){if(this.playing){var b=this.audioContext;if(b){if(0.05<Math.abs(b.currentTime-this.playStart-a)){var c=this.bufferNode;c&&c.stop(0);c=this.createBufferNode(this.sound);if(0<a){var d=this.sound.buffer;c.loop?c.start(0,a,d.duration):c.start(0,
a,d.duration-a);this.playStart=b.currentTime-a}else c.start(0),this.playStart=b.currentTime}return!0}if(b=this.audio){if(b.currentTime>a)try{b.currentTime=a}catch(f){}return!0}}return!1};rb.prototype.clear=function(){this.stop()};rb.prototype.setAuxiliarySendFilter=function(){return!1};rb.prototype.setDirectFilter=function(){return!1};rb.prototype.destroy=function(){this.stop();if(this.audioContext){var a=this.pannerNode;a&&(a.disconnect(),delete this.pannerNode);delete this.audioContext}};rb.create=
function(a,b,c){var d=new rb;d.sd=a;d.id=b;d.sound=null;d.playing=!1;d.paused=!1;var f="number"===typeof c.gain?c.gain:1,g=c.looping||!1,h=c.pitch||1,n,e,r,l=a.audioContext;if(l){d.audioContext=l;d.bufferNode=null;d.playStart=-1;d.playPaused=-1;var m=a.gainNode,q=l.createPanner();d.pannerNode=q;q.connect(m);var p=l.createGain?l.createGain():l.createGainNode();d.gainNode=p;a.linearDistance&&("string"===typeof q.distanceModel?q.distanceModel="linear":"number"===typeof q.LINEAR_DISTANCE&&(q.distanceModel=
q.LINEAR_DISTANCE));q.panningModel="string"===typeof q.panningModel?"equalpower":q.EQUALPOWER;Object.defineProperty(d,"position",{get:function(){return n.slice()},set:function(a){n=w.v3Copy(a,n);d.relative||this.pannerNode.setPosition(a[0],a[1],a[2])},enumerable:!0,configurable:!1});Object.defineProperty(d,"direction",{get:function(){return e.slice()},set:function(a){e=w.v3Copy(a,e);this.pannerNode.setOrientation(a[0],a[1],a[2])},enumerable:!0,configurable:!1});Object.defineProperty(d,"velocity",
{get:function(){return r.slice()},set:function(a){r=w.v3Copy(a,r);this.pannerNode.setVelocity(a[0],a[1],a[2])},enumerable:!0,configurable:!1});Object.defineProperty(d,"gain",{get:function(){return f},set:function(a){f=a;this.gainNode.gain.value=a},enumerable:!0,configurable:!1});d.createBufferNode=function(a){var b=a.buffer,c=l.createBufferSource();c.buffer=b;c.loop=g;c.playbackRate&&(c.playbackRate.value=h);c.connect(p);p.disconnect();1<a.channels?p.connect(m):p.connect(q);c.start||(c.start=function(a,
b,c){1>=arguments.length?this.noteOn(a):this.noteGrainOn(a,b,c)});c.stop||(c.stop=function(a){this.noteOff(a)});return this.bufferNode=c};d.updateRelativePosition=function(a,b,c){1>=this.sound.channels&&q.setPosition(n[0]+a,n[1]+b,n[2]+c)};Object.defineProperty(d,"looping",{get:function(){return g},set:function(a){g=a;var b=this.bufferNode;b&&(b.loop=a)},enumerable:!0,configurable:!1});Object.defineProperty(d,"pitch",{get:function(){return h},set:function(a){h=a;var b=this.bufferNode;b&&b.playbackRate&&
(b.playbackRate.value=a)},enumerable:!0,configurable:!1});Object.defineProperty(d,"tell",{get:function(){return this.playing?this.paused?this.playPaused-this.playStart:l.currentTime-this.playStart:0},enumerable:!0,configurable:!1});Object.defineProperty(d,"minDistance",{get:function(){return q.refDistance},set:function(a){this.pannerNode.maxDistance===a&&(a=0.999*this.pannerNode.maxDistance);this.pannerNode.refDistance=a},enumerable:!0,configurable:!1});Object.defineProperty(d,"maxDistance",{get:function(){return q.maxDistance},
set:function(a){this.pannerNode.refDistance===a&&(a=1.001*this.pannerNode.refDistance);this.pannerNode.maxDistance=a},enumerable:!0,configurable:!1});Object.defineProperty(d,"rollOff",{get:function(){return q.rolloffFactor},set:function(a){this.pannerNode.rolloffFactor=a},enumerable:!0,configurable:!1})}else d.audio=null,d.gainFactor=1,d.pitch=h,d.updateAudioVolume=function(){var a=this.audio;if(a){var b=Math.min(this.gainFactor*f,1);a.volume=b;a.muted=0>=b?!0:!1}},Object.defineProperty(d,"position",
{get:function(){return n.slice()},set:function(a){n=w.v3Copy(a,n)},enumerable:!0,configurable:!1}),Object.defineProperty(d,"direction",{get:function(){return e.slice()},set:function(a){e=w.v3Copy(a,e)},enumerable:!0,configurable:!1}),Object.defineProperty(d,"velocity",{get:function(){return r.slice()},set:function(a){r=w.v3Copy(a,r)},enumerable:!0,configurable:!1}),Object.defineProperty(d,"gain",{get:function(){return f},set:function(a){f=a;d.gainFactor=-1},enumerable:!0,configurable:!1}),a.loopingSupported?
(Object.defineProperty(d,"looping",{get:function(){return g},set:function(a){g=a;var b=d.audio;b&&(b.loop=a)},enumerable:!0,configurable:!1}),d.loopAudio=function(){d.audio&&(d.playing=!1,d.sd.removePlayingSource(d))}):(d.looping=g,d.loopAudio=function(){var a=d.audio;a&&(d.looping?(a.currentTime=0,a.play()):(d.playing=!1,d.sd.removePlayingSource(d)))}),Object.defineProperty(d,"tell",{get:function(){var a=d.audio;return a?a.currentTime:0},enumerable:!0,configurable:!1}),d.updateRelativePosition=function(a,
b,c){var d=this.minDistance,f=this.maxDistance,g=n[0],h=n[1],e=n[2];this.relative?c=g*g+h*h+e*e:(a-=g,b-=h,c-=e,c=a*a+b*b+c*c);c<=d*d?d=1:c>=f*f?d=0:(c=Math.sqrt(c),d=this.sd.linearDistance?(f-c)/(f-d):d/(d+this.rollOff*(c-d)));d*=this.sd.listenerGain;this.gainFactor!==d&&(this.gainFactor=d,this.updateAudioVolume())};d.relative=c.relative;d.position=c.position||w.v3BuildZero();d.direction=c.direction||w.v3BuildZero();d.velocity=c.velocity||w.v3BuildZero();d.minDistance=c.minDistance||1;d.maxDistance=
c.maxDistance||3.402823466E38;d.rollOff=c.rollOff||1;return d};rb.version=1;var Xa=function(){};Xa.prototype.createSource=function(a){this.lastSourceID+=1;return rb.create(this,this.lastSourceID,a)};Xa.prototype.createSound=function(a){return ze.create(this,a)};Xa.prototype.loadSoundsArchive=function(a){var b=a.src;if("undefined"!==typeof yi)return yi.create({sd:this,src:b,uncompress:a.uncompress,onsoundload:function(b){a.onsoundload(b)},onload:function(b,d){if(a.onload)a.onload(b,d)},onerror:function(b){if(a.onload)a.onload(!1,
b)}}),!0;TurbulenzEngine.callOnError("Missing archive loader required for "+b);return!1};Xa.prototype.createEffect=function(){return null};Xa.prototype.createEffectSlot=function(){return null};Xa.prototype.createFilter=function(){return null};Xa.prototype.update=function(){var a=this.listenerTransform,b=a[9],c=a[10],a=a[11],d=this.playingSources,f;for(f in d)d.hasOwnProperty(f)&&d[f].updateRelativePosition(b,c,a)};Xa.prototype.isSupported=function(a){return"FILEFORMAT_OGG"===a?this.supportedExtensions.ogg:
"FILEFORMAT_MP3"===a?this.supportedExtensions.mp3:"FILEFORMAT_WAV"===a?this.supportedExtensions.wav:!1};Xa.prototype.addLoadingSound=function(a){var b=this.loadingSounds;b[b.length]=a;var c=this.loadingInterval,d=this;null===c&&(this.loadingInterval=c=window.setInterval(function(){var a=b.length,g=0;do(0,b[g])()?(a-=1,g<a&&(b[g]=b[a]),b.length=a):g+=1;while(g<a);0===a&&(window.clearInterval(c),d.loadingInterval=null)},100))};Xa.prototype.addPlayingSource=function(a){this.playingSources[a.id]=a};Xa.prototype.removePlayingSource=
function(a){delete this.playingSources[a.id]};Xa.prototype.isResourceSupported=function(a){a=a.slice(-3).toLowerCase();return this.supportedExtensions[a]};Xa.prototype.destroy=function(){var a=this.loadingInterval;null!==a&&(window.clearInterval(a),this.loadingInterval=null);if(a=this.loadingSounds)a.length=0,this.loadingSounds=null;var a=this.playingSources,b;if(a){for(b in a)if(a.hasOwnProperty(b)){var c=a[b];c&&c.stop()}this.playingSources=null}};Xa.create=function(a){var b=new Xa;b.extensions=
"";b.renderer="HTML5 Audio";b.alcVersion="0";b.alcExtensions="";b.alcEfxVersion="0";b.alcMaxAuxiliarySends=0;b.deviceSpecifier=a.deviceSpecifier||null;b.frequency=a.frequency||44100;b.dopplerFactor=a.dopplerFactor||1;b.dopplerVelocity=a.dopplerVelocity||1;b.speedOfSound=a.speedOfSound||343.29998779296875;b.linearDistance=void 0!==a.linearDistance?a.linearDistance:!0;b.loadingSounds=[];b.loadingInterval=null;b.playingSources={};b.lastSourceID=0;var c=window.AudioContext||window.webkitAudioContext;
if(c){var d;try{d=new c}catch(f){return TurbulenzEngine.callOnError("Failed to create AudioContext:"+f),null}if(0===d.sampleRate)return null;b.renderer="WebAudio";b.audioContext=d;b.frequency=d.sampleRate;b.gainNode=d.createGain?d.createGain():d.createGainNode();b.gainNode.connect(d.destination);var g=d.listener;g.dopplerFactor=b.dopplerFactor;g.speedOfSound=b.speedOfSound;var h,n;Object.defineProperty(b,"listenerTransform",{get:function(){return h.slice()},set:function(a){h=w.m43Copy(a,h);g.setPosition(a[9],
a[10],a[11]);g.setOrientation(-a[6],-a[7],-a[8],a[3],a[4],a[5])},enumerable:!0,configurable:!1});Object.defineProperty(b,"listenerVelocity",{get:function(){return n.slice()},set:function(a){n=w.v3Copy(a,n);g.setVelocity(a[0],a[1],a[2])},enumerable:!0,configurable:!1});b.update=function(){this.gainNode.gain.value=this.listenerGain;var a=h[9],b=h[10],c=h[11],f=this.playingSources,g=[],n;for(n in f)if(f.hasOwnProperty(n)){var e=f[n],j=d.currentTime-e.playStart;if(e.bufferNode.buffer.duration<j)if(e.looping)e.playStart=
d.currentTime-(j-e.bufferNode.buffer.duration);else{e.playing=!1;e.sound=null;e.bufferNode.disconnect();e.bufferNode=null;g[g.length]=n;continue}e.relative&&e.updateRelativePosition(a,b,c)}a=g.length;for(b=0;b<a;b+=1)delete f[g[b]]}}b.listenerTransform=a.listenerTransform||w.m43BuildIdentity();b.listenerVelocity=a.listenerVelocity||w.v3BuildZero();b.listenerGain="number"===typeof a.listenerGain?a.listenerGain:1;a=new Audio;if(b.audioContext)b.loopingSupported=!0;else{if(a.mozSetup)try{a.mozSetup(1,
22050)}catch(e){return null}b.loopingSupported="boolean"===typeof a.loop}c={ogg:!1,mp3:!1,wav:!1};a.canPlayType("application/ogg")&&(c.ogg=!0);a.canPlayType("audio/mp3")&&(c.mp3=!0);a.canPlayType("audio/wav")&&(c.wav=!0);b.supportedExtensions=c;a=null;return b};Xa.version=1;Xa.prototype.vendor="Turbulenz";"undefined"!==typeof ArrayBuffer&&(void 0!==ArrayBuffer.prototype&&void 0===ArrayBuffer.prototype.slice)&&(ArrayBuffer.prototype.slice=function(a,b){var c=this.byteLength;void 0===a?a=0:0>a&&(a+=
c);void 0===b?b=c:0>b&&(b+=c);c=b-a;return 0<c?(c=new Uint8Array(this,a,c),(new Uint8Array(c)).buffer):new ArrayBuffer(0)});var yi,Dd=function(){};Dd.prototype.processBytes=function(a){function b(b){var c=f,d=c+b,g=a[c];if(g&&0<b){var c=c+1,h=Array(b),n=0;do h[n]=g,n+=1,g=a[c],c+=1;while(g&&n<b);for(;32===h[n-1];)n-=1;h.length=n;b=String.fromCharCode.apply(null,h)}else b="";f=d;return b}function c(a){a.fileName=b(100);f+=8;f+=8;f+=8;var c;c=b(12);c=c.replace(/[^\d]/g,"");c=parseInt("0"+c,8);a.length=
c;f+=12;f+=8;a.fileType=b(1);f+=100;a.ustarSignature=b(6);f+=2;f+=32;f+=32;f+=8;f+=8;a.fileNamePrefix=b(155);f+=12}function d(a){m.soundsLoading-=1;a?r(a):l=!1}var f=0,g=a.length,h={fileName:null,length:0,fileType:null,ustarSignature:null,fileNamePrefix:null},n=this.sd,e=this.uncompress,r=this.onsoundload,l=!0;this.soundsLoading=0;for(var m=this;f+512<=g;)if(c(h),0<h.length){var q;"././@LongLink"===h.fileName?(q=b(256),f+=256,c(h)):q=h.fileNamePrefix&&"ustar"===h.ustarSignature?h.fileNamePrefix+h.fileName:
h.fileName;if(""===h.fileType||"0"===h.fileType)this.soundsLoading+=1,n.createSound({src:q,data:n.audioContext?a.buffer.slice(f,f+h.length):a.subarray(f,f+h.length),uncompress:e,onload:d});f+=512*Math.floor((h.length+511)/512)}a=null;return l};Dd.prototype.isValidHeader=function(){return!0};Dd.create=function(a){var b=new Dd;b.sd=a.sd;b.uncompress=a.uncompress;b.onsoundload=a.onsoundload;b.onload=a.onload;b.onerror=a.onerror;b.soundsLoading=0;var c=a.src;if(c){b.src=c;var d;if(window.XMLHttpRequest)d=
new window.XMLHttpRequest;else if(window.ActiveXObject)d=new window.ActiveXObject("Microsoft.XMLHTTP");else{if(a.onerror)a.onerror(0);return null}d.onreadystatechange=function(){if(4===d.readyState){if(!TurbulenzEngine||!TurbulenzEngine.isUnloading()){var a=d.status;if(0===a&&("file:"===window.location.protocol||"chrome-extension:"===window.location.protocol))a=200;if(""===d.getAllResponseHeaders()&&("arraybuffer"===d.responseType?!d.response:d.mozResponseArrayBuffer?!d.mozResponseArrayBuffer:!d.responseText)){if(b.onerror)b.onerror(0);
d=d.onreadystatechange=null;return}if(200===a||0===a){var c;if("arraybuffer"===d.responseType)c=d.response;else if(d.mozResponseArrayBuffer)c=d.mozResponseArrayBuffer;else{var h=d.responseText,n=h.length,e;c=[];c.length=n;for(e=0;e<n;e+=1)c[e]=h.charCodeAt(e)&255}var r=b.processBytes(new Uint8Array(c));if(b.onload){var l=function(){if(0<b.soundsLoading)(!TurbulenzEngine||!TurbulenzEngine.isUnloading())&&window.setTimeout(l,100);else b.onload(r,a)};l()}}else if(b.onerror)b.onerror(a)}d=d.onreadystatechange=
null}};d.open("GET",a.src,!0);d.hasOwnProperty&&d.hasOwnProperty("responseType")?d.responseType="arraybuffer":d.overrideMimeType?d.overrideMimeType("text/plain; charset=x-user-defined"):d.setRequestHeader("Content-Type","text/plain; charset=x-user-defined");d.send(null)}return b};Dd.version=1;yi=Dd;var ui,Ed=function(){};Ed.prototype.processBytes=function(a){function b(b){var c=f,d=c+b,g=a[c];if(g&&0<b){var c=c+1,h=Array(b),n=0;do h[n]=g,n+=1,g=a[c],c+=1;while(g&&n<b);for(;32===h[n-1];)n-=1;h.length=
n;b=String.fromCharCode.apply(null,h)}else b="";f=d;return b}function c(a){a.fileName=b(100);f+=8;f+=8;f+=8;var c;c=b(12);c=c.replace(/[^\d]/g,"");c=parseInt("0"+c,8);a.length=c;f+=12;f+=8;a.fileType=b(1);f+=100;a.ustarSignature=b(6);f+=2;f+=32;f+=32;f+=8;f+=8;a.fileNamePrefix=b(155);f+=12}function d(a){m.texturesLoading-=1;a?r(a):(f=g,l=!1)}var f=0,g=a.length,h={fileName:null,length:0,fileType:null,ustarSignature:null,fileNamePrefix:null},n=this.gd,e=this.mipmaps,r=this.ontextureload,l=!0;this.texturesLoading=
0;for(var m=this;f+512<=g;)if(c(h),0<h.length){var q;"././@LongLink"===h.fileName?(q=b(256),f+=256,c(h)):q=h.fileNamePrefix&&"ustar"===h.ustarSignature?h.fileNamePrefix+h.fileName:h.fileName;if(""===h.fileType||"0"===h.fileType)this.texturesLoading+=1,n.createTexture({src:q,data:a.subarray(f,f+h.length),mipmaps:e,onload:d});f+=512*Math.floor((h.length+511)/512)}a=null;return l};Ed.prototype.isValidHeader=function(){return!0};Ed.create=function(a){var b=new Ed;b.gd=a.gd;b.mipmaps=a.mipmaps;b.ontextureload=
a.ontextureload;b.onload=a.onload;b.onerror=a.onerror;b.texturesLoading=0;var c=a.src;if(c){b.src=c;var d;if(window.XMLHttpRequest)d=new window.XMLHttpRequest;else if(window.ActiveXObject)d=new window.ActiveXObject("Microsoft.XMLHTTP");else{if(a.onerror)a.onerror(0);return null}d.onreadystatechange=function(){if(4===d.readyState){if(!TurbulenzEngine||!TurbulenzEngine.isUnloading()){var a=d.status;if(0===a&&("file:"===window.location.protocol||"chrome-extension:"===window.location.protocol))a=200;
if(""===d.getAllResponseHeaders()&&("arraybuffer"===d.responseType?!d.response:d.mozResponseArrayBuffer?!d.mozResponseArrayBuffer:!d.responseText)){if(b.onerror)b.onerror(0);d=d.onreadystatechange=null;return}if(200===a||0===a){var c;if("arraybuffer"===d.responseType)c=d.response;else if(d.mozResponseArrayBuffer)c=d.mozResponseArrayBuffer;else{var h=d.responseText,n=h.length;c=[];c.length=n;for(var e=0;e<n;e+=1)c[e]=h.charCodeAt(e)&255}if(b.processBytes(new Uint8Array(c))){if(b.onload){var r=function(){if(0<
b.texturesLoading)(!TurbulenzEngine||!TurbulenzEngine.isUnloading())&&window.setTimeout(r,100);else b.onload(!0,a)};r()}}else if(b.onerror)b.onerror(a)}else if(b.onerror)b.onerror(a)}d=d.onreadystatechange=null}};d.open("GET",a.src,!0);d.hasOwnProperty&&d.hasOwnProperty("responseType")?d.responseType="arraybuffer":d.overrideMimeType?d.overrideMimeType("text/plain; charset=x-user-defined"):d.setRequestHeader("Content-Type","text/plain; charset=x-user-defined");d.send(null)}return b};Ed.version=1;ui=
Ed;var lb,wb=function(){};wb.prototype.processBytes=function(a){var b=this.parseHeader(a);if(this.isValidHeader(b)){var c=18;this.width=b.width;this.height=b.height;this.bytesPerPixel=Math.floor(b.bpp/8);this.horzRev=b.descriptor&this.DESC_HORIZONTAL;this.vertRev=!(b.descriptor&this.DESC_VERTICAL);var d=!1,f=this.gd;switch(b.imageType){case this.TYPE_MAPPED_RLE:d=!0;this.format=24<b.colorMapSize?f.PIXELFORMAT_R8G8B8A8:16<b.colorMapSize?f.PIXELFORMAT_R8G8B8:f.PIXELFORMAT_R5G5B5A1;break;case this.TYPE_MAPPED:this.format=
24<b.colorMapSize?f.PIXELFORMAT_R8G8B8A8:16<b.colorMapSize?f.PIXELFORMAT_R8G8B8:f.PIXELFORMAT_R5G5B5A1;break;case this.TYPE_GRAY_RLE:d=!0;this.format=f.PIXELFORMAT_L8;break;case this.TYPE_GRAY:this.format=f.PIXELFORMAT_L8;break;case this.TYPE_COLOR_RLE:d=!0;switch(this.bytesPerPixel){case 4:this.format=f.PIXELFORMAT_R8G8B8A8;break;case 3:this.format=f.PIXELFORMAT_R8G8B8;break;case 2:this.format=f.PIXELFORMAT_R5G5B5A1;break;default:return}break;case this.TYPE_COLOR:switch(this.bytesPerPixel){case 4:this.format=
f.PIXELFORMAT_R8G8B8A8;break;case 3:this.format=f.PIXELFORMAT_R8G8B8;break;case 2:this.format=f.PIXELFORMAT_R5G5B5A1;break;default:return}break;default:return}if(b.idLength&&(c+=b.idLength,c>a.length))return;if(this.TYPE_MAPPED_RLE===b.imageType||this.TYPE_MAPPED===b.imageType){if(1!==b.colorMapType)return}else if(0!==b.colorMapType)return;if(1===b.colorMapType){var g=b.colorMapIndex,f=b.colorMapLength;if(0===f)return;var b=Math.floor(b.colorMapSize/8),h=[];h.length=(f+g)*b;this.colorMap=h;this.colorMapBytesPerPixel=
b;var n;for(n=0;n<g*b;n+=1)h[n]=0;for(n=g*b;n<g*b;n+=1,c+=1)h[n]=a[c];c+=f*b;if(c>a.length)return;if(3<=b)for(n=g*b;n<f*b;n+=b)g=h[n],h[n]=h[n+2],h[n+2]=g}a=a.subarray(c);d&&(a=this.expandRLE(a));a.length<this.width*this.height*this.bytesPerPixel||(this.horzRev&&this.flipHorz(a),this.vertRev&&this.flipVert(a),this.colorMap?a=this.expandColorMap(a):2<this.bytesPerPixel?this.convertBGR2RGB(a):2===this.bytesPerPixel&&(a=this.convertARGB2RGBA(a)),this.data=a)}};wb.prototype.parseHeader=function(a){return{idLength:a[0],
colorMapType:a[1],imageType:a[2],colorMapIndex:a[4]<<8|a[3],colorMapLength:a[6]<<8|a[5],colorMapSize:a[7],xOrigin:a[9]<<8|a[8],yOrigin:a[11]<<8|a[10],width:a[13]<<8|a[12],height:a[15]<<8|a[14],bpp:a[16],descriptor:a[17]}};wb.prototype.isValidHeader=function(a){if(this.TYPE_MAPPED_RLE===a.imageType||this.TYPE_MAPPED===a.imageType){if(1!==a.colorMapType)return!1}else if(0!==a.colorMapType)return!1;if(1===a.colorMapType&&0===a.colorMapLength)return!1;switch(a.imageType){case this.TYPE_MAPPED_RLE:case this.TYPE_MAPPED:break;
case this.TYPE_GRAY_RLE:case this.TYPE_GRAY:break;case this.TYPE_COLOR_RLE:case this.TYPE_COLOR:switch(Math.floor(a.bpp/8)){case 4:case 3:case 2:break;default:return!1}break;default:return!1}return 16384<a.width||16384<a.height?!1:!0};wb.prototype.expandRLE=function(a){var b=this.bytesPerPixel,c=this.width*this.height*b,d=this.RLE_PACKETSIZE,f=new Uint8Array(c),g=0,h=0,n,e;do{n=a[g];var g=g+1,r=((n&~d)+1)*b;if(n&d)if(1===b){var l=a[g],g=g+1;for(n=0;n<r;n+=1)f[h+e]=l}else{for(n=0;n<b;n+=1)f[h+n]=a[g+
n];g+=b;for(e=b;e<r;e+=b)for(n=0;n<b;n+=1)f[h+e+n]=f[h+n]}else{for(n=0;n<r;n+=1)f[h+n]=a[g+n];g+=r}h+=r}while(h<c);return f};wb.prototype.expandColorMap=function(a){var b=this.bytesPerPixel,c=this.width*this.height*b,d=new Uint8Array(c),f=0,g=0,h=this.colorMap;delete this.colorMap;if(2===b||3===b||4===b){do for(var n=a[g]*b,g=g+1,e=0;e<b;e+=1)d[f]=h[n+e],f+=1;while(f<c)}2===b&&(d=this.convertARGB2RGBA(d));return d};wb.prototype.flipHorz=function(a){for(var b=this.bytesPerPixel,c=this.width,d=this.height,
f=Math.floor(c/2),g=c*b,h=0;h<d;h+=1){for(var n=0;n<f;n+=1)for(var e=0;e<b;e+=1){var r=a[n*b+e];a[n*b+e]=a[(c-n-1)*b+e];a[(c-n-1)*b+e]=r}a+=g}};wb.prototype.flipVert=function(a){for(var b=this.height,c=Math.floor(b/2),d=this.width*this.bytesPerPixel,f=0;f<c;f+=1)for(var g=f*d,h=(b-f-1)*d,n=0;n<d;n+=1){var e=a[g+n];a[g+n]=a[h+n];a[h+n]=e}};wb.prototype.convertBGR2RGB=function(a){var b=this.bytesPerPixel,c=this.width*this.height*b,d=0;do{var f=a[d];a[d]=a[d+2];a[d+2]=f;d+=b}while(d<c)};wb.prototype.convertARGB2RGBA=
function(a){var b=this.bytesPerPixel;if(2===b){var a=this.width,c=this.height,b=a*c*b,a=new Uint16Array(a*c),d=c=0,f,g,h,n;do n=c[1]<<8|c[0],c+=2,h=(n&31)<<1,g=(n&992)<<1,f=(n&31744)<<1,n>>=15,a[d]=f|g|h|n,d+=1;while(c<b)}return a};wb.create=function(a){var b=new wb;b.gd=a.gd;b.onload=a.onload;b.onerror=a.onerror;var c=a.src;if(c){b.src=c;var d;if(window.XMLHttpRequest)d=new window.XMLHttpRequest;else if(window.ActiveXObject)d=new window.ActiveXObject("Microsoft.XMLHTTP");else{if(a.onerror)a.onerror(0);
return null}d.onreadystatechange=function(){if(4===d.readyState){if(!TurbulenzEngine||!TurbulenzEngine.isUnloading()){var a=d.status;if(0===a&&("file:"===window.location.protocol||"chrome-extension:"===window.location.protocol))a=200;if(""===d.getAllResponseHeaders()&&("arraybuffer"===d.responseType?!d.response:d.mozResponseArrayBuffer?!d.mozResponseArrayBuffer:!d.responseText)){if(b.onerror)b.onerror(0);d=d.onreadystatechange=null;return}if(200===a||0===a){var c;if("arraybuffer"===d.responseType)c=
d.response;else if(d.mozResponseArrayBuffer)c=d.mozResponseArrayBuffer;else{var h=d.responseText,n=h.length;c=[];c.length=n;for(var e=0;e<n;e+=1)c[e]=h.charCodeAt(e)&255}b.processBytes(new Uint8Array(c));if(b.data){if(b.onload)b.onload(b.data,b.width,b.height,b.format,a)}else if(b.onerror)b.onerror(a)}else if(b.onerror)b.onerror(a)}d=d.onreadystatechange=null}};d.open("GET",a.src,!0);d.hasOwnProperty&&d.hasOwnProperty("responseType")?d.responseType="arraybuffer":d.overrideMimeType?d.overrideMimeType("text/plain; charset=x-user-defined"):
d.setRequestHeader("Content-Type","text/plain; charset=x-user-defined");d.send(null)}else if(b.processBytes(a.data),b.data){if(b.onload)b.onload(b.data,b.width,b.height,b.format,200)}else if(b.onerror)b.onerror(0);return b};wb.version=1;lb=wb;lb.prototype.TYPE_MAPPED=1;lb.prototype.TYPE_COLOR=2;lb.prototype.TYPE_GRAY=3;lb.prototype.TYPE_MAPPED_RLE=9;lb.prototype.TYPE_COLOR_RLE=10;lb.prototype.TYPE_GRAY_RLE=11;lb.prototype.DESC_ABITS=15;lb.prototype.DESC_HORIZONTAL=16;lb.prototype.DESC_VERTICAL=32;
lb.prototype.SIGNATURE="TRUEVISION-XFILE";lb.prototype.RLE_PACKETSIZE=128;var Lj,zi=function(){};zi.create=function(a){var b=new zi;b.force=a.force;b.identifier=a.identifier;b.isGameTouch=a.isGameTouch;b.positionX=a.positionX;b.positionY=a.positionY;b.radiusX=a.radiusX;b.radiusY=a.radiusY;b.rotationAngle=a.rotationAngle;return b};Lj=zi;var Kj,Ai=function(){};Ai.create=function(a){var b=new Ai;b.changedTouches=a.changedTouches;b.gameTouches=a.gameTouches;b.touches=a.touches;return b};Kj=Ai;var za=
function(){this.version="0.27.0.0"};za.prototype.setInterval=function(a,b){var c=this;return window.setInterval(function(){c.updateTime();a()},b)};za.prototype.clearInterval=function(a){window.clearInterval(a)};za.prototype.createGraphicsDevice=function(a){return this.graphicsDevice?(this.callOnError("GraphicsDevice already created"),null):this.graphicsDevice=a=S.create(this.canvas,a)};za.prototype.createPhysicsDevice=function(a){if(this.physicsDevice)return this.callOnError("PhysicsDevice already created"),
null;var b=this.getPluginObject();return this.physicsDevice=a=b?b.createPhysicsDevice(a):Ka.create()};za.prototype.createSoundDevice=function(a){if(this.soundDevice)return this.callOnError("SoundDevice already created"),null;var b=this.getPluginObject();return this.soundDevice=a=b?b.createSoundDevice(a):Xa.create(a)};za.prototype.createInputDevice=function(){if(this.inputDevice)return this.callOnError("InputDevice already created"),null;var a=Rd.create(this.canvas);return this.inputDevice=a};za.prototype.createNetworkDevice=
function(a){if(this.networkDevice)throw"NetworkDevice already created";return this.networkDevice=a=Sc.create(a)};za.prototype.createMathDevice=function(){try{var a=new Float32Array([1,2,3]);w.v3Build.apply(w,a);a[0]=w.FLOAT_MAX;w.FLOAT_MAX=a[0]}catch(b){}return WebGLMathDevice};za.prototype.createNativeMathDevice=function(){return WebGLMathDevice};za.prototype.getGraphicsDevice=function(){var a=this.graphicsDevice;null===a&&this.callOnError("GraphicsDevice not created yet.");return a};za.prototype.getPhysicsDevice=
function(){return this.physicsDevice};za.prototype.getSoundDevice=function(){return this.soundDevice};za.prototype.getInputDevice=function(){return this.inputDevice};za.prototype.getNetworkDevice=function(){return this.networkDevice};za.prototype.getMathDevice=function(){return WebGLMathDevice};za.prototype.getNativeMathDevice=function(){return WebGLMathDevice};za.prototype.getObjectStats=function(){return null};za.prototype.flush=function(){};za.prototype.run=function(){};za.prototype.encrypt=function(a){return a};
za.prototype.decrypt=function(a){return a};za.prototype.generateSignature=function(){return null};za.prototype.verifySignature=function(){return!0};za.prototype.onerror=function(a){console.error(a)};za.prototype.onwarning=function(a){console.warn(a)};za.prototype.onperformancewarning=function(){};za.prototype.getSystemInfo=function(){return this.systemInfo};za.prototype.request=function(a,b){var c=this,d;if(window.XMLHttpRequest)d=new window.XMLHttpRequest;else if(window.ActiveXObject)d=new window.ActiveXObject("Microsoft.XMLHTTP");
else{c.callOnError("No XMLHTTPRequest object could be created");return}var f=function(){if(4===d.readyState){if(!c.isUnloading()){var a=d.responseText,f=d.status;""===a&&(a=null);if(0===f&&a&&"file:"===window.location.protocol)f=200;else if(null===d.getResponseHeader("Content-Type")&&""===d.getAllResponseHeaders()){b(null,0);return}0!==f?(404===f&&(a=null),b(a,f)):b(a,0)}b=d=d.onreadystatechange=null}};d.open("GET",a,!0);b&&(d.onreadystatechange=f);d.send()};za.prototype.destroy=function(){this.networkDevice&&
delete this.networkDevice;this.inputDevice&&(this.inputDevice.destroy(),delete this.inputDevice);this.physicsDevice&&delete this.physicsDevice;this.soundDevice&&(this.soundDevice.destroy&&this.soundDevice.destroy(),delete this.soundDevice);this.graphicsDevice&&(this.graphicsDevice.destroy(),delete this.graphicsDevice);this.canvas&&delete this.canvas;this.resizeCanvas&&window.removeEventListener("resize",this.resizeCanvas,!1)};za.prototype.getPluginObject=function(){!this.plugin&&this.pluginId&&(this.plugin=
document.getElementById(this.pluginId));return this.plugin};za.prototype.unload=function(){if(!this.unloading){this.unloading=!0;if(this.onunload)this.onunload();this.destroy&&this.destroy()}};za.prototype.isUnloading=function(){return this.unloading};za.prototype.enableProfiling=function(){};za.prototype.startProfiling=function(){console&&(console.profile&&console.profileEnd)&&console.profile("turbulenz")};za.prototype.stopProfiling=function(){var a;console&&(console.profile&&console.profileEnd)&&
(console.profileEnd(),console.profiles&&(a=console.profiles[console.profiles.length-1]));return a};za.prototype.callOnError=function(a){var b=this.onerror;b&&b(a)};za.create=function(a){var b=new za,c=a.canvas,d=a.fillParent;window.TurbulenzEngineCanvas=b;b.pluginId=a.pluginId;b.plugin=null;var f=Date.now,g=window.performance;g&&(g.now?f=function(){return g.now()}:g.webkitNow&&(f=function(){return g.webkitNow()}));b.getTime=f;var h=f(),a=!0,n=navigator.userAgent,e=n.indexOf("Version/6.0");-1!==e&&
-1!==n.substring(e).indexOf("Safari/")&&(a=!1);a&&Object.defineProperty?(Object.defineProperty(b,"time",{get:function(){return 0.001*(f()-h)},set:function(a){"number"===typeof a?h=f()-1E3*a:b.callOnError("Must set 'time' attribute to a number")},enumerable:!1,configurable:!1}),b.updateTime=function(){}):b.updateTime=function(){this.time=0.001*(f()-h)};if(window.postMessage){var r=[],l=0;window.addEventListener("message",function(a){a.source===window&&"0-timeout-message"===a.data&&(a.stopPropagation(),
r.length&&!b.isUnloading()&&(a=r.shift().fn,a()))},!0);b.setTimeout=function(a,b){if(1>b){l+=1;var c={id:l,fn:a};r.push(c);window.postMessage("0-timeout-message","*");return c}var d=this;return window.setTimeout(function(){d.updateTime();d.isUnloading()||a()},b)};b.clearTimeout=function(a){if("object"===typeof a){for(var b=r.length,c=0;c<b;c+=1)if(r[c].id===a){r.splice(c,1);break}a=void 0}else a=window.clearTimeout(a);return a}}else b.setTimeout=function(a,b){var c=this;return window.setTimeout(function(){c.updateTime();
c.isUnloading()||a()},b)},b.clearTimeout=function(a){return window.clearTimeout(a)};var m=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame;m&&(b.setInterval=function(a,b){var c=this;if(1>=Math.abs(b-1E3/60)){var d={enabled:!0},g=f()+16.6;m(function x(){if(d.enabled){var b=f(),h=b-g;0<=h&&(g=50<h?b+16.6:g+16.6,c.updateTime(),c.isUnloading()||a());m(x,c.canvas)}},c.canvas);return d}return window.setInterval(function(){c.updateTime();
c.isUnloading()||a()},b)},b.clearInterval=function(a){"object"===typeof a?a.enabled=!1:window.clearInterval(a)});b.canvas=c;b.networkDevice=null;b.inputDevice=null;b.physicsDevice=null;b.soundDevice=null;b.graphicsDevice=null;d&&(b.resizeCanvas=function(){if(document.fullscreenElement===c||document.mozFullScreenElement===c||document.webkitFullscreenElement===c)c.width=window.innerWidth,c.height=window.innerHeight;else{var a=c.parentNode;c.width=a.clientWidth;c.height=a.clientHeight}},b.resizeCanvas(),
window.addEventListener("resize",b.resizeCanvas,!1));try{var q=window.onbeforeunload;window.onbeforeunload=function(){b.unload();q&&q.call(this)}}catch(p){}b.time=0;d={architecture:"",cpuDescription:"",cpuVendor:"",numPhysicalCores:1,numLogicalCores:1,ramInMegabytes:0,frequencyInMegaHZ:0,osVersionMajor:0,osVersionMinor:0,osVersionBuild:0,osName:navigator.platform,platformProfile:"desktop",userLocale:(navigator.language||navigator.userLanguage).replace("-","_")};a=navigator.userAgent;n=a.indexOf("Windows");
-1!==n?(d.osName="Windows","Win64"===navigator.platform?d.architecture="x86_64":"Win32"===navigator.platform&&(d.architecture="x86"),n+=7," NT "===a.slice(n,n+4)&&(n+=4,d.osVersionMajor=parseInt(a.slice(n,n+1),10),d.osVersionMinor=parseInt(a.slice(n+2,n+4),10)),900>Math.min(window.screen.height,window.screen.width)&&(d.platformProfile="tablet")):(n=a.indexOf("Mac OS X"),-1!==n?(d.osName="Darwin",-1!==navigator.platform.indexOf("Intel")&&(d.architecture="x86"),n+=9,d.osVersionMajor=parseInt(a.slice(n,
n+2),10),d.osVersionMinor=parseInt(a.slice(n+3,n+4),10),d.osVersionBuild=parseInt(a.slice(n+5,n+6),10)||0):(n=a.indexOf("Linux"),-1!==n?(d.osName="Linux",-1!==navigator.platform.indexOf("64")?d.architecture="x86_64":-1!==navigator.platform.indexOf("x86")&&(d.architecture="x86"),900>Math.min(window.screen.height,window.screen.width)&&(d.platformProfile="tablet")):(n=a.indexOf("Android"),-1!==n?(d.osName="Android",navigator.platform.indexOf("arm")?d.architecture="arm":navigator.platform.indexOf("x86")&&
(d.architecture="x86"),d.platformProfile=-1!==a.indexOf("Mobile")?"smartphone":"tablet"):-1!==a.indexOf("iPhone")||-1!==a.indexOf("iPod")?(d.osName="iOS",d.architecture="arm",d.platformProfile="smartphone"):-1!==a.indexOf("iPad")&&(d.osName="iOS",d.architecture="arm",d.platformProfile="tablet"))));b.systemInfo=d;var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split("");b.base64Encode=function(a){var b="",c=a.length,d,f,g,h,n;for(d=0;d<c;)f=a[d],d+=1,n=f>>2,d<c?(g=a[d],d+=
1,d<c?(h=a[d],d+=1,f=(f&3)<<4|g>>4,g=(g&15)<<2|h>>6,h&=63):(f=(f&3)<<4|g>>4,g=(g&15)<<2,h=64)):(f=(f&3)<<4,h=g=64),b+=i[n],b+=i[f],b+=i[g],b+=i[h];return b};return b};window.WebGLTurbulenzEngine=za;var ea={version:"1.0",saveVersion:"1.0",versionMessage:"Prepare for War",newsText:"Now available in the Shop:\n\n - The Amber Crown ($0.99)\n The Amber Crown doubles all Amber you collect, including Amber found in the Chest, The Amber Well, Mushrooms, Wildlings, Trees, Stones, Quests and Badges!\n\n - The Amber Well ($4.99)\n Gives you 100 Amber a day, forever! When combined with The Amber Crown it gives you 200 Amber a day!\n\n",
creditsText:"Team Wonderstruck:\nMichael Braithwaite\nBen Furneaux @benfurneaux\nAdam Langridge @ajlangridge\nJames Long\nChris Matthews\nClaudio Tolomei\nVolong Tran\nYota Wada\nRob Wyle\nTeam Turbulenz\nJames Austin\n\nOriginal Music By:\nPaolo Carlotto (www.milhouserecording.com)\n",renderType:"NLightRendering",newRenderer:!0,mergeStaticMeshes:!0,targetFPS:60,variableStep:!0,useLoadingBar:!0,useSplashScreens:!0,maxDebugLines:200,cheats:!1,resetKey:!1,debugText:!1,debugUpdate:!1,debugRender:!1,
debugNav:!1,debugPostRequests:!1,debugMonitorData:!1,profiling:!1,debugEnableWireframe:!1,addArchetypeSliders:!1,debugSliders:!1,drawPlayDuration:!1,enableDynamicUI:!1,disableSound:!1,autoLoad:!0,autoSave:!0,saveLeaderboards:!0,saveBadges:!0,saveGameStats:!0,saveMetrics:!0,runScripts:!0,showTutorialScreens:!1,controlOneButton:!0,controlwsad:!1,controlNavigate:!0,controlSwipe:!1,heroArchetype:["a_h_hero_01","a_h_hero_02","a_h_hero_03","a_h_hero_04","a_h_hero_05"],minutesPerDayCycle:15,dayNightEnabled:!0,
clockBasedDayTime:!0,startUpLevelPath:"levels/moveship_levelsave.json",defaultPlayerSavePath:"levels/moveship_playersave.json",enableEditor:!1,lockMouseInGame:!1,lockMouseInMenus:!1,enableCustomCursors:!1,repairableBuildings:!0,useSimulatedResourceGathering:!0,extraOfflineSeconds:0,extraTabbedOutSeconds:0,enableRecording:!1,useRenderBuffer:!1,log2RenderBufferWidth:10,log2RenderBufferHeight:10,displayGuestAlert:!0,runTasks:!0,autoTaskArrows:!1},lk={quatPosscalefromm43:function(a,b){var c=b.v3Length,
d=b.v3ScalarMul,f=b.v3Build,g=b.m43Right(a),h=b.m43Up(a),n=b.m43At(a),e=c.call(b,g),r=c.call(b,h),l=c.call(b,n),m=b.m43Determinant(a),c=f.call(b,e,r,l),q=f.call(b,1,1,1);!b.v3Equal(c,q)||0>m?(0>m&&(e*=-1,c=f.call(b,e,r,l)),b.m43SetRight(a,d.call(b,g,1/e)),b.m43SetUp(a,d.call(b,h,1/r)),b.m43SetAt(a,d.call(b,n,1/l))):c=q;d=b.quatFromM43(a);f=b.m43Pos(a);return{rotation:d,translation:f,scale:c}}},mk={copy:function(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=!0);return b},union:function(a,b){var c=
{},d;for(d in a)a.hasOwnProperty(d)&&(c[d]=!0);for(d in b)b.hasOwnProperty(d)&&(c[d]=!0);return c},add:function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=!0)}},Bi={minKeyframeDelta:1E-4,standardGetJointWorldTransform:function(a,b,c,d){var f=c.quatMulTranslate,g=c.m43FromRTS,h=c.m43FromRT,n=c.quatCopy,e=c.v3Copy,r=a.output,l=a.outputChannels.scale,m=r[b],a=a.getHierarchy().parents,b=a[b];if(l){for(var f=c.m43Mul,q,h=g.call(c,m.rotation,m.translation,m.scale);-1!==b;)m=r[b],q=g.call(c,m.rotation,
m.translation,m.scale,q),h=f.call(c,h,q,h),b=a[b];if(d)return h;c=lk.quatPosscalefromm43(h,c);return{rotation:c.rotation,translation:c.translation}}g=n.call(c,m.rotation);for(q=e.call(c,m.translation);-1!==b;)m=r[b],f.call(c,m.rotation,m.translation,g,q,g,q),b=a[b];return d?h.call(c,g,q):{rotation:g,translation:q}}},Ma=function(){};Ma.prototype.addTime=function(a){this.currentTime+=a*this.rate;this.dirtyBounds=this.dirty=!0;for(a=this.currentAnim.length;this.currentTime>a;){var b=this.hierarchy.numNodes,
c;for(c=0;c<b;c+=1)this.translationEndFrames[c]=0,this.rotationEndFrames[c]=0,this.scaleEndFrames[c]=0;if(this.onUpdateCallback)if(b=this.currentTime,this.currentTime=a,this.onUpdateCallback(this),this.currentTime===a)this.currentTime=b;else if(this.currentTime<a)return;if(this.looping){if(this.onLoopCallback&&!this.onLoopCallback(this))return;this.currentTime-=a}else{if(this.onFinishedCallback&&!this.onFinishedCallback(this))return;this.currentTime=a}}if(this.onUpdateCallback)this.onUpdateCallback(this)};
Ma.prototype.update=function(){var a=this.mathDevice,b=this.currentAnim,c=b.nodeData,d=this.hierarchy.numNodes,f=this.output,b=b.channels.scale,g;b&&(g=a.v3Build(1,1,1));var h=Ma.prototype.scratchPad,n=h.v1,e=h.v2,r=h.q1,h=h.q2,l,m;for(m=0;m<d;m+=1){var q=c[m],p=q.channels,i=(p=p?p.scale:b)||b,k=q.keyframes,u=q.baseframe,z,B,y,v=f[m];u&&(z=u.rotation,B=u.translation,y=u.scale,p=p||void 0!==y);if(k){var x=u=0;l=x=0;q=q.channels;if(q.rotation)if(x=q.rotation.stride,u=q.rotation.offset,l=u+(q.rotation.count-
1)*x,this.currentTime<=k[u])v.rotation=a.quatBuild(k[u+1],k[u+2],k[u+3],k[u+4],v.rotation);else if(this.currentTime>=k[l])v.rotation=a.quatBuild(k[l+1],k[l+2],k[l+3],k[l+4],v.rotation);else{for(u=this.rotationEndFrames[m]||u;this.currentTime>k[u];)u+=x;this.rotationEndFrames[m]=u;x=u-x;l=(this.currentTime-k[x])/(k[u]-k[x]);r[0]=k[x+1];r[1]=k[x+2];r[2]=k[x+3];r[3]=k[x+4];h[0]=k[u+1];h[1]=k[u+2];h[2]=k[u+3];h[3]=k[u+4];v.rotation=a.quatSlerp(r,h,l,v.rotation)}else v.rotation=a.quatCopy(z,v.rotation);
if(q.translation)if(x=q.translation.stride,u=q.translation.offset,l=u+(q.translation.count-1)*x,this.currentTime<=k[u])v.translation=a.v3Build(k[u+1],k[u+2],k[u+3],v.translation);else if(this.currentTime>=k[l])v.translation=a.v3Build(k[l+1],k[l+2],k[l+3],v.translation);else{for(u=this.translationEndFrames[m]||u;this.currentTime>k[u];)u+=x;this.translationEndFrames[m]=u;x=u-x;l=(this.currentTime-k[x])/(k[u]-k[x]);n[0]=k[x+1];n[1]=k[x+2];n[2]=k[x+3];e[0]=k[u+1];e[1]=k[u+2];e[2]=k[u+3];v.translation=
a.v3Lerp(n,e,l,v.translation)}else v.translation=a.v3Copy(B,v.translation);if(q.scale)if(x=q.scale.stride,u=q.scale.offset,l=u+(q.scale.count-1)*x,this.currentTime<=k[u])v.scale=a.v3Build(k[u+1],k[u+2],k[u+3],v.scale);else if(this.currentTime>=k[l])v.scale=a.v3Build(k[l+1],k[l+2],k[l+3],v.scale);else{for(u=this.scaleEndFrames[m]||u;this.currentTime>k[u];)u+=x;this.scaleEndFrames[m]=u;x=u-x;l=(this.currentTime-k[x])/(k[u]-k[x]);n[0]=k[x+1];n[1]=k[x+2];n[2]=k[x+3];e[0]=k[u+1];e[1]=k[u+2];e[2]=k[u+3];
v.scale=a.v3Lerp(n,e,l,v.scale)}else i&&(v.scale=p?a.v3Copy(y,v.scale):a.v3Copy(g,v.scale))}else v.rotation=a.quatCopy(z,v.rotation),v.translation=a.v3Copy(B,v.translation),i&&(v.scale=p?a.v3Copy(y,v.scale):a.v3Copy(g,v.scale))}this.dirty=!1;this.dirtyBounds&&this.updateBounds()};Ma.prototype.updateBounds=function(){if(this.dirtyBounds){this.dirtyBounds=!1;var a=this.currentTime,b=this.mathDevice,c=this.bounds,d=this.currentAnim.bounds,f=d.length;if(a>d[f-1].time)f=d[f-1],c.center=b.v3Copy(f.center,
c.center),c.halfExtent=b.v3Copy(f.halfExtent,c.halfExtent);else if(a<d[0].time)f=d[0],c.center=b.v3Copy(f.center,c.center),c.halfExtent=b.v3Copy(f.halfExtent,c.halfExtent);else{for(var g=1;a>d[g].time;)g+=1;f=d[g-1];d=d[g];g=f.time;a=(a-g)/(d.time-g);g=Bi.minKeyframeDelta;a<g?(c.center=b.v3Copy(f.center,c.center),c.halfExtent=b.v3Copy(f.halfExtent,c.halfExtent)):1-a<g?(c.center=b.v3Copy(d.center,c.center),c.halfExtent=b.v3Copy(d.halfExtent,c.halfExtent)):(a=b.v3Add(f.center,d.center,c.center),a=b.v3ScalarMul(a,
0.5,a),c.center=a,d=b.v3Max(f.halfExtent,d.halfExtent,c.halfExtent),f=b.v3Sub(f.center,a,this.scratchPad.v1),f=b.v3Abs(f,f),c.halfExtent=b.v3Add(d,f,d))}}};Ma.prototype._updateBoundsNoop=function(){this.dirtyBounds=!1};Ma.prototype.getJointTransform=function(a){var b=this.mathDevice,c=b.m43FromRTS,d=b.m43FromRT,f=b.quatSlerp,g=b.v3Lerp,h=this.currentAnim,n=h.channels.scale;if(this.dirty){var e=h.nodeData,h=e[a].keyframes,r=e[a].jointBase,n=(a=(a=e[a].channels)?a.scale:n)||n,l,m,q;r&&(l=r.rotation,
m=r.translation,q=r.scale);if(h){for(var p=1;this.currentTime>h[p].time;)p+=1;e=p-1;r=h[e].time;r=(this.currentTime-r)/(h[p].time-r);if(r<Bi.minKeyframeDelta)return g=h[e],n?c.call(b,g.rotation||l,g.translation||m,g.scale||q||b.v3Build(1,1,1)):d.call(b,g.rotation||l,g.translation||m);e=h[e];h=h[p];l=f.call(b,e.rotation||l,h.rotation||l,r);m=g.call(b,e.translation||m,h.translation||m,r);return n?(d=a?g.call(b,e.scale||q,h.scale||q,r):b.v3Build(1,1,1),c.call(b,l,m,d)):d.call(b,l,m)}return n?c.call(b,
l,m,q||b.v3Build(1,1,1)):d.call(b,l,m)}q=this.output[a];return n?c.call(b,q.rotation,q.translation,q.scale):d.call(b,q.rotation,q.translation)};Ma.prototype.getJointWorldTransform=function(a,b){this.dirty&&this.update();return Bi.standardGetJointWorldTransform(this,a,this.mathDevice,b)};Ma.prototype.setAnimation=function(a,b){this.currentAnim=a;this.currentTime=0;var c,d=this.hierarchy.numNodes;if(!this.translationEndFrames||this.translationEndFrames.length!==d)this.translationEndFrames=new Uint32Array(d),
this.rotationEndFrames=new Uint32Array(d),this.scaleEndFrames=new Uint32Array(d);else for(c=0;c<d;c+=1)this.translationEndFrames[c]=0,this.rotationEndFrames[c]=0,this.scaleEndFrames[c]=0;this.dirtyBounds=this.dirty=!0;this.looping=b?!0:!1;this.outputChannels=mk.copy(a.channels);var f=a.bounds,g=f.length;c=f[0].center;var d=f[0].halfExtent,h;for(h=1;h<g;h+=1){var n=f[h],e=n.center,n=n.halfExtent;if(c[0]!==e[0]||c[1]!==e[1]||c[2]!==e[2]||d[0]!==n[0]||d[1]!==n[1]||d[2]!==n[2])break}h<g?this.updateBounds=
Ma.prototype.updateBounds:(this.updateBounds=Ma.prototype._updateBoundsNoop,f=this.bounds,g=this.mathDevice,f.center=g.v3Copy(c,f.center),f.halfExtent=g.v3Copy(d,f.halfExtent))};Ma.prototype.setTime=function(a){this.currentTime=a;this.dirtyBounds=this.dirty=!0;var a=this.hierarchy.numNodes,b;for(b=0;b<a;b+=1)this.translationEndFrames[b]=0,this.rotationEndFrames[b]=0,this.scaleEndFrames[b]=0};Ma.prototype.setRate=function(a){this.rate=a};Ma.prototype.getHierarchy=function(){return this.hierarchy};
Ma.create=function(a){var b=new Ma;b.hierarchy=a;var c=TurbulenzEngine.getMathDevice();b.mathDevice=c;b.bounds={center:c.v3BuildZero(),halfExtent:c.v3BuildZero()};var d=[];b.output=d;b.outputChannels={};for(var a=a.numNodes,f=0;f<a;f+=1)d[f]={};b.rate=1;b.currentTime=0;b.looping=!1;b.dirty=!0;b.dirtyBounds=!0;Ma.prototype.scratchPad||(Ma.prototype.scratchPad={v1:c.v3BuildZero(),v2:c.v3BuildZero(),q1:c.quatBuild(0,0,0,1),q2:c.quatBuild(0,0,0,1)});return b};Ma.version=1;Ma.prototype.scratchV3=null;
var Eb=function(){};Eb.prototype.setInputController=function(a){this.inputController=a;this.dirty=!0};Eb.prototype.setSkeleton=function(a){var b=-1;this.skeleton&&(b=this.skeleton.numNodes);this.skeleton=a;this.dirty=!0;a=a.numNodes;b!==a&&(this.ltms.length=a,this.output=this.gd.createTechniqueParameterBuffer({numFloats:this.bufferSize||12*a,dynamic:!0}))};Eb.prototype.update=function(){if(this.dirty||this.inputController.dirty){this.inputController.dirty&&this.inputController.update();for(var a=
this.output,b=this.md,c=this.inputController.output,d=this.inputController.outputChannels.scale,f=this.skeleton.invBoneLTMs,g=this.skeleton.parents,h=this.ltms,n=this.outputMat,e=this.convertedquatPos,r=this.skeleton.numNodes,l=0,m,q=0;q<r;q+=1){var p=c[q],i=g[q];-1!==i?(e=d?b.m43FromRTS(p.rotation,p.translation,p.scale,e):b.m43FromRT(p.rotation,p.translation,e),h[q]=m=b.m43Mul(e,h[i],h[q])):h[q]=d?m=b.m43FromRTS(p.rotation,p.translation,p.scale,h[q]):m=b.m43FromRT(p.rotation,p.translation,h[q]);
n=b.m43MulTranspose(f[q],m,n);a.setData(n,l,12);l+=12}this.dirty=!1}};Eb.setDefaultBufferSize=function(a){Eb.prototype.defaultBufferSize=a};Eb.create=function(a,b,c){var d=new Eb;d.md=b;d.gd=a;d.dirty=!0;d.ltms=[];d.outputMat=b.m34BuildIdentity();d.convertedquatPos=b.m43BuildIdentity();d.bufferSize=c||Eb.prototype.defaultBufferSize;return d};Eb.version=1;Eb.prototype.defaultBufferSize=void 0;var Kb=function(){};Kb.prototype.loadFile=function(){};Kb.prototype.loadData=function(){};Kb.prototype.get=
function(){return null};Kb.prototype.remove=function(){};Kb.prototype.nodeHasSkeleton=function(){return null};Kb.prototype.getAll=function(){return null};Kb.prototype.setPathRemapping=function(){};Kb.create=function(a,b){a||(a=function(){});var c={},d=function(a,b){var d=a.animations,f;for(f in d)if(d.hasOwnProperty(f)){var g=b?b+f:f;if(c[g])d[f]=c[g];else{var h=d[f],e=h.numNodes,n=h.nodeData,j;for(j=0;j<e;j+=1){var i=n[j],k=i.baseframe;k&&(k.rotation&&(k.rotation=this.mathDevice.quatBuild(k.rotation[0],
k.rotation[1],k.rotation[2],k.rotation[3])),k.translation&&(k.translation=this.mathDevice.v3Build(k.translation[0],k.translation[1],k.translation[2])),k.scale&&(k.scale=this.mathDevice.v3Build(k.scale[0],k.scale[1],k.scale[2])));var v=i.keyframes;if(v&&v[0].hasOwnProperty("time")){var x=v.length,J,C,t={},w,V,A,K;i.channels=t;for(J=0;J<x;J+=1)for(V in C=v[J],C)C.hasOwnProperty(V)&&"time"!==V&&(w=t[V],w||(w={count:0,offset:0,stride:C[V].length+1},t[V]=w,w.firstKey=J),w.lastKey=J,w.count+=1);A=0;for(V in t)t.hasOwnProperty(V)&&
(w=t[V],w.count=1+w.lastKey-w.firstKey,w.firstKey&&(w.count+=1),w.lastKey!==x-1&&(w.count+=1),w.offset=A,w.writeIndex=A,A+=w.stride*w.count);var E=null;A&&(E=new Float32Array(A));for(V in t)if(t.hasOwnProperty(V)){w=t[V];if(w.firstKey){E[w.writeIndex]=v[w.firstKey-1].time;A=k[V];for(K=0;K<w.stride-1;K+=1)E[w.writeIndex+1+K]=A[K];w.writeIndex+=w.stride}if(w.lastKey!==x-1){J=w.offset+(w.count-1)*w.stride;E[J]=v[w.lastKey+1].time;A=k[V];for(K=0;K<w.stride-1;K+=1)E[J+1+K]=A[K]}}for(J=0;J<x;J+=1)for(V in C=
v[J],t)if(t.hasOwnProperty(V)&&(w=t[V],J>=w.firstKey&&J<=w.lastKey)){A=C[V]?C[V]:k[V];E[w.writeIndex]=C.time;for(K=0;K<w.stride-1;K+=1)E[w.writeIndex+1+K]=A[K];w.writeIndex+=w.stride}for(V in t)t.hasOwnProperty(V)&&delete w.writeIndex;i.keyframes=E}else v&&(i.keyframes=new Float32Array(v))}e=h.bounds;n=e.length;for(j=0;j<n;j+=1)i=e[j],i.center=this.mathDevice.v3Build(i.center[0],i.center[1],i.center[2]),i.halfExtent=this.mathDevice.v3Build(i.halfExtent[0],i.halfExtent[1],i.halfExtent[2]);c[g]=h}}},
f=function(){},g=function(a){return c[a]},h=function(a){"undefined"!==typeof c[a]&&delete c[a]},e=function(a){var b=a.renderables;if(b){var c,d=b.length,f;for(f=0;f<d;f+=1)if(b[f].geometry&&(c=b[f].geometry.skeleton))return c}if(a=a.children){b=a.length;for(c=0;c<b;c+=1)if(d=e(a[c]))return d}},j=new Kb;j.mathDevice=TurbulenzEngine.getMathDevice();b?(j.loadFile=function(a){b.innerHTML+="AnimationManager.loadFile:&nbsp;'"+a+"'"},j.loadData=function(a,c){b.innerHTML+="AnimationManager.loadData";return d(a,
c)},j.get=function(a){b.innerHTML+="AnimationManager.get:&nbsp;'"+a+"'";return c[a]},j.remove=function(a){b.innerHTML+="AnimationManager.remove:&nbsp;'"+a+"'";h(a)}):(j.loadFile=f,j.loadData=d,j.get=g,j.remove=h,j.nodeHasSkeleton=e);j.getAll=function(){return c};j.setPathRemapping=function(){};return j};Kb.version=1;var Zb=function(){};Zb.prototype.getLoadedCount=function(){return this.assetsLoadedCount};Zb.prototype.getLoadingProgress=function(){return this.loadingProgress};Zb.prototype.getNumberAssetsToLoad=
function(){return this.numberAssetsToLoad};Zb.prototype.eventOnAssetLoadedCallback=function(a){var b=this.numberAssetsToLoad;this.assetsLoadedCount+=1;b&&(this.loadingProgress=Math.max(this.loadingProgress,Math.min(this.assetsLoadedCount/b,1)));this.displayLog&&La.log(a.name+" (Asset Number "+this.assetsLoadedCount+") Progress : "+this.loadingProgress);this.callback&&this.callback()};Zb.prototype.setCallback=function(a){this.callback=a};Zb.prototype.setNumberAssetsToLoad=function(a){a&&this.numberAssetsToLoad!==
a&&(this.numberAssetsToLoad=a,this.loadingProgress=Math.max(this.loadingProgress,Math.min(this.assetsLoadedCount/a,1)));this.callback&&this.callback()};Zb.create=function(a,b){var c=new Zb;c.assetsLoadedCount=0;c.loadingProgress=0;c.numberAssetsToLoad=0;c.callback=null;c.displayLog=b;a&&(c.numberAssetsToLoad=a);c.eventOnLoadHandler=function(a){c.eventOnAssetLoadedCallback(a)};return c};Zb.version=1;var Ea=function(){this.viewOffsetY=this.viewOffsetX=0;this.recipViewWindowY=this.recipViewWindowX=1;
this.parallel=this.infinite=!1;this.aspectRatio=4/3;this.nearPlane=1;this.farPlane=1E3};Ea.prototype.lookAt=function(a,b,c){var d=this.md,f=d.v3Normalize,g=d.v3Cross,a=d.v3Sub(c,a);f.call(d,a,a);b=g.call(d,f.call(d,b,b),a);f.call(d,b,b);f=g.call(d,a,b);this.matrix=d.m43Build(b,f,a,c,this.matrix)};Ea.prototype.updateProjectionMatrix=function(){var a=this.recipViewWindowX,b=this.recipViewWindowY*this.aspectRatio,c=a*this.viewOffsetX,d=b*this.viewOffsetY,f=this.farPlane,g=this.nearPlane,h;h=f!==g?1/
(f-g):0;var e;this.parallel?(e=-2*h,g=-(f+g)*h,f=0,h=1):(e=this.infinite?-1:-(f+g)*h,g=-(2*f*g*h),f=-1,h=0);this.projectionMatrix=this.md.m44Build(a,0,0,0,0,b,0,0,-c,-d,e,f,0,0,g,h,this.projectionMatrix)};Ea.prototype.updateViewMatrix=function(){this.viewMatrix=this.md.m43InverseOrthonormal(this.matrix,this.viewMatrix)};Ea.prototype.updateViewProjectionMatrix=function(){this.viewProjectionMatrix=this.md.m43MulM44(this.viewMatrix,this.projectionMatrix,this.viewProjectionMatrix)};Ea.prototype.extractFrustumPlanes=
function(a,b){var c=this.md,d=a[0],f=a[1],g=a[2],h=a[3],e=a[4],j=a[5],r=a[6],l=a[7],m=a[8],q=a[9],p=a[10],i=a[11],k=a[12],u=a[13],z=a[14],B=a[15],y=b||[],v=c.v4Build(h+d,l+e,i+m,-(B+k));y[0]=c.planeNormalize(v,y[0]);c.v4Build(h-d,l-e,i-m,-(B-k),v);y[1]=c.planeNormalize(v,y[1]);c.v4Build(h-f,l-j,i-q,-(B-u),v);y[2]=c.planeNormalize(v,y[2]);c.v4Build(h+f,l+j,i+q,-(B+u),v);y[3]=c.planeNormalize(v,y[3]);c.v4Build(h+g,l+r,i+p,-(B+z),v);y[4]=c.planeNormalize(v,y[4]);c.v4Build(h-g,l-r,i-p,-(B-z),v);y[5]=
c.planeNormalize(v,y[5]);return y};Ea.prototype.updateFrustumPlanes=function(){this.frustumPlanes=this.extractFrustumPlanes(this.viewProjectionMatrix,this.frustumPlanes)};Ea.prototype.isVisiblePoint=function(a){return this.md.isInsidePlanesPoint(a,this.frustumPlanes)};Ea.prototype.isVisibleSphere=function(a,b){return this.md.isInsidePlanesSphere(a,b,this.frustumPlanes)};Ea.prototype.isVisibleBox=function(a,b){return this.md.isInsidePlanesBox(a,b,this.frustumPlanes)};Ea.prototype.isVisibleAABB=function(a){return this.md.aabbIsInsidePlanes(a,
this.frustumPlanes)};Ea.prototype.isFullyInsideAABB=function(a){return this.md.aabbIsFullyInsidePlanes(a,this.frustumPlanes)};Ea.prototype.getFrustumPoints=function(a){var b=this.viewOffsetX,c=this.viewOffsetY,d=1/this.recipViewWindowX,f=1/(this.recipViewWindowY*this.aspectRatio),g=this.matrix,h=a||this.farPlane,e=this.nearPlane,a=[];if(this.parallel){a[0]=[];a[4]=[];a[1]=[];a[5]=[];a[2]=[];a[6]=[];a[3]=[];a[7]=[];a[0][2]=e;a[1][2]=e;a[2][2]=e;a[3][2]=e;a[4][2]=h;a[5][2]=h;a[6][2]=h;a[7][2]=h;var j=
(1-e)*b;a[0][0]=d+j;a[1][0]=j-d;a[2][0]=j-d;a[3][0]=d+j;j=(1-h)*b;a[4][0]=d+j;a[5][0]=j-d;a[6][0]=j-d;a[7][0]=d+j;j=(1-e)*c;a[0][1]=f+j;a[1][1]=f+j;a[2][1]=j-f;a[3][1]=j-f;j=(1-h)*c;a[4][1]=f+j;a[5][1]=f+j;a[6][1]=j-f;a[7][1]=j-f;h=this.md;a[0]=h.m43TransformPoint(g,a[0]);a[1]=h.m43TransformPoint(g,a[1]);a[2]=h.m43TransformPoint(g,a[2]);a[3]=h.m43TransformPoint(g,a[3]);a[4]=h.m43TransformPoint(g,a[4]);a[5]=h.m43TransformPoint(g,a[5]);a[6]=h.m43TransformPoint(g,a[6]);a[7]=h.m43TransformPoint(g,a[7])}else{var r=
g[0]*b+g[3]*c,l=g[1]*b+g[4]*c,m=g[2]*b+g[5]*c,c=g[0]*d,b=g[1]*d,d=g[2]*d,q=g[3]*f,j=g[4]*f,f=g[5]*f,p=r-g[6],i=l-g[7],k=m-g[8],r=g[9]+r,l=g[10]+l,g=g[11]+m,m=p+c+q,u=i+b+j,z=k+d+f,B=p-c+q,y=i-b+j,v=k-d+f,x=p-c-q,J=i-b-j,C=k-d-f,c=p+c-q,b=i+b-j,d=k+d-f;a[0]=[r+m*e,l+u*e,g+z*e];a[4]=[r+m*h,l+u*h,g+z*h];a[1]=[r+B*e,l+y*e,g+v*e];a[5]=[r+B*h,l+y*h,g+v*h];a[2]=[r+x*e,l+J*e,g+C*e];a[6]=[r+x*h,l+J*h,g+C*h];a[3]=[r+c*e,l+b*e,g+d*e];a[7]=[r+c*h,l+b*h,g+d*h]}return a};Ea.prototype.getFrustumFarPoints=function(){var a=
this.viewOffsetX,b=this.viewOffsetY,c=1/this.recipViewWindowX,d=1/(this.recipViewWindowY*this.aspectRatio),f=this.matrix,g=this.farPlane;if(this.parallel)var h=(1-g)*a,e=(1-g)*b,b=this.md,g=[b.m43TransformPoint(f,[c+h,d+e,g]),b.m43TransformPoint(f,[h-c,d+e,g]),b.m43TransformPoint(f,[h-c,e-d,g]),b.m43TransformPoint(f,[c+h,e-d,g])];else var j=f[0],r=f[1],l=f[2],m=f[3],q=f[4],p=f[5],e=j*a+m*b,h=r*a+q*b,b=l*a+p*b,j=j*c,r=r*c,c=l*c,m=m*d,q=q*d,d=p*d,p=e-f[6],l=h-f[7],a=b-f[8],e=f[9]+e,h=f[10]+h,f=f[11]+
b,g=[[e+(p+j+m)*g,h+(l+r+q)*g,f+(a+c+d)*g],[e+(p-j+m)*g,h+(l-r+q)*g,f+(a-c+d)*g],[e+(p-j-m)*g,h+(l-r-q)*g,f+(a-c-d)*g],[e+(p+j-m)*g,h+(l+r-q)*g,f+(a+c-d)*g]];return g};Ea.prototype.getFrustumExtents=function(a,b){for(var c=this.getFrustumPoints(b),d=c[0],f=d[0],g=d[1],h=d[2],e=f,j=g,r=h,l=1;8>l;l+=1){var d=c[l],m=d[0],q=d[1],d=d[2];f>m?f=m:e<m&&(e=m);g>q?g=q:j<q&&(j=q);h>d?h=d:r<d&&(r=d)}a[0]=f;a[1]=g;a[2]=h;a[3]=e;a[4]=j;a[5]=r};Ea.create=function(a){var b=new Ea;b.md=a;b.matrix=a.m43BuildIdentity();
b.viewMatrix=a.m43BuildIdentity();b.updateProjectionMatrix();b.viewProjectionMatrix=b.projectionMatrix.slice();b.frustumPlanes=[];b.updateFrustumPlanes();return b};Ea.version=1;var ta=function(){};ta.prototype.updateShader=function(){};ta.prototype.sortRenderablesAndLights=function(a,b){var c=ta.passIndex.opaque,d=ta.passIndex.decal,f=ta.passIndex.transparent,g=this.passes,h=g[c],e=g[d],g=g[f],j=0,r=0,l=0,m,q,p,i,k=b.getCurrentVisibleRenderables(),u=k.length;if(0<u){var z,B,y=0;do{z=k[y];z.renderUpdate||
(m=z.sharedMaterial.effect,m.prepare&&m.prepare(z));z.renderUpdate(a);m=z.drawParameters;q=m.length;for(i=0;i<q;i+=1)p=m[i],B=p.userData.passIndex,B===c?(h[j]=p,j+=1):B===f?(p.sortKey=z.sharedMaterial.meta.far?1E38:z.distance,g[l]=p,l+=1):B===d&&(e[r]=p,r+=1);y+=1}while(y<u)}h.length=j;e.length=r;g.length=l};ta.prototype.update=function(a,b,c,d){c.updateVisibleNodes(b);this.sortRenderablesAndLights(b,c);a=b.matrix;a[9]!==this.eyePosition[0]||a[10]!==this.eyePosition[1]||a[11]!==this.eyePosition[2]?
(this.eyePositionUpdated=!0,this.eyePosition[0]=a[9],this.eyePosition[1]=a[10],this.eyePosition[2]=a[11]):this.eyePositionUpdated=!1;this.globalTechniqueParameters.time=d;this.camera=b;this.scene=c};ta.prototype.updateBuffers=function(){return!0};ta.prototype.draw=function(a,b,c,d,f){a.clear(b,1,0);if(this.wireframe)this.scene.drawWireframe(a,this.sm,this.camera,this.wireframeInfo),c&&c();else{var b=this.globalTechniqueParametersArray,g=this.passes;a.drawArray(g[ta.passIndex.opaque],b,-1);a.drawArray(g[ta.passIndex.decal],
b,-1);c&&c();a.drawArray(g[ta.passIndex.transparent],b,1)}d&&d();f&&f();this.lightPositionUpdated=!1};ta.prototype.setGlobalLightPosition=function(a){this.lightPositionUpdated=!0;this.lightPosition[0]=a[0];this.lightPosition[1]=a[1];this.lightPosition[2]=a[2]};ta.prototype.setGlobalLightColor=function(a){this.globalTechniqueParameters.lightColor=a};ta.prototype.setAmbientColor=function(a){this.globalTechniqueParameters.ambientColor=a};ta.prototype.setDefaultTexture=function(a){this.globalTechniqueParameters.diffuse=
a};ta.prototype.setWireframe=function(a,b){this.wireframeInfo=b;this.wireframe=a};ta.prototype.getDefaultSkinBufferSize=function(){return this.defaultSkinBufferSize};ta.prototype.destroy=function(){delete this.globalTechniqueParametersArray;delete this.globalTechniqueParameters;delete this.lightPosition;delete this.eyePosition;delete this.passes};ta.defaultPrepareFn=function(a){var b=TurbulenzEngine.getGraphicsDevice().createDrawParameters();b.userData={};a.drawParameters=[b];a.prepareDrawParameters(b);
var c=a.sharedMaterial,d=a.techniqueParameters;!c.techniqueParameters.uvTransform&&!d.uvTransform&&(d.uvTransform=ta.identityUVTransform);b.technique=this.technique;b.setTechniqueParameters(0,c.techniqueParameters);b.setTechniqueParameters(1,d);b.userData.passIndex=c.meta.decal?ta.passIndex.decal:c.meta.transparent?ta.passIndex.transparent:ta.passIndex.opaque;var f=a.node;if(!f.rendererInfo){var g=TurbulenzEngine.getMathDevice();f.rendererInfo={id:ta.nextRenderinfoID,frameVisible:-1,worldUpdate:-1,
worldViewProjection:g.m44BuildIdentity(),worldInverse:g.m43BuildIdentity(),eyePosition:g.v3BuildZero(),lightPosition:g.v3BuildZero()};ta.nextRenderinfoID+=1}f=f.rendererInfo;d.worldViewProjection=f.worldViewProjection;d.lightPosition=f.lightPosition;g=this.technique.name;-1===g.indexOf("flat")&&-1===g.indexOf("lambert")&&(d.eyePosition=f.eyePosition);(g=a.skinController)?(d.skinBones=g.output,void 0===g.index&&(g.index=ta.nextSkinID,ta.nextSkinID+=1),b.sortKey=-$a(this.techniqueIndex,g.index,c.meta.materialIndex)):
b.sortKey=$a(this.techniqueIndex,c.meta.materialIndex,f.id);a.renderUpdate=this.update};ta.create=function(a,b,c,d){var f=new ta;f.md=b;f.sm=c;f.lightPositionUpdated=!0;f.lightPosition=b.v3Build(1E3,1E3,0);f.eyePositionUpdated=!0;f.eyePosition=b.v3BuildZero();f.globalTechniqueParameters=a.createTechniqueParameters({lightColor:b.v3BuildOne(),ambientColor:b.v3Build(0.2,0.2,0.3),time:0});f.globalTechniqueParametersArray=[f.globalTechniqueParameters];f.passes=[[],[],[]];c.load("shaders/defaultrendering.cgfx",
function(a){a=a.getParameter("skinBones");f.defaultSkinBufferSize=a.rows*a.columns});c.load("shaders/debug.cgfx");var g=function(a,c,d){var g=f.lightPositionUpdated,h=f.eyePositionUpdated,e=a.world;c.worldUpdate!==a.worldUpdate&&(c.worldUpdate=a.worldUpdate,h=g=!0,c.worldInverse=b.m43Inverse(e,c.worldInverse));g&&(c.lightPosition=b.m43TransformPoint(c.worldInverse,f.lightPosition,c.lightPosition));h&&(c.eyePosition=b.m43TransformPoint(c.worldInverse,f.eyePosition,c.eyePosition));c.worldViewProjection=
b.m43MulM44(e,d.viewProjectionMatrix,c.worldViewProjection)},a=function(a){var b=this.node,c=b.rendererInfo;c.frameVisible!==b.frameVisible&&(c.frameVisible=b.frameVisible,g(b,c,a))},h=function(a){var b=this.node,c=b.rendererInfo;c.frameVisible!==b.frameVisible&&(c.frameVisible=b.frameVisible,g(b,c,a));(a=this.skinController)&&a.update()},e=function(a){var c=this.node.world,d=this.techniqueParameters;d.worldViewProjection=b.m43MulM44(c,a.viewProjectionMatrix,d.worldViewProjection);d.worldInverseTranspose=
b.m33InverseTranspose(c,d.worldInverseTranspose)},j=function(a){var c=this.node.world,d=this.techniqueParameters;d.worldViewProjection=b.m43MulM44(c,a.viewProjectionMatrix,d.worldViewProjection);d.worldInverseTranspose=b.m33InverseTranspose(c,d.worldInverseTranspose);(a=this.skinController)&&a.update()},r=function(a){var c=this.node,d=c.rendererInfo;d.frameVisible!==c.frameVisible&&(d.frameVisible=c.frameVisible,g(c,d,a));d.worldUpdateEnv!==c.worldUpdate&&(d.worldUpdateEnv=c.worldUpdate,d.worldInverseTranspose=
b.m33InverseTranspose(c.world,d.worldInverseTranspose));this.techniqueParameters.worldInverseTranspose=d.worldInverseTranspose},l=function(a){ta.defaultPrepareFn.call(this,a);var d=a.sharedMaterial.techniqueParameters,f=d.diffuse;void 0===f?d.materialColor||(d.materialColor=b.v4BuildOne()):4===f.length&&(d.materialColor=b.v4Build.apply(b,f),f=d.diffuse_map,d.diffuse=f);f||(d=c.get("shaders/defaultrendering.cgfx"),a.drawParameters[0].technique="skinned"===a.geometryType?d.getTechnique("flat_skinned"):
d.getTechnique("flat"))},m=function(a){ta.defaultPrepareFn.call(this,a);var a=a.sharedMaterial.techniqueParameters,c=a.diffuse;void 0===c?a.materialColor||(a.materialColor=b.v4BuildOne()):4===c.length&&(a.materialColor=b.v4Build.apply(b,c),a.diffuse=void 0)},q=function(a){var b=this;a.load(this.shaderName,function(a){b.shader=a;b.technique=a.getTechnique(b.techniqueName);b.techniqueIndex=b.technique.id})};f.defaultPrepareFn=l;f.defaultUpdateFn=a;f.defaultSkinnedUpdateFn=h;f.loadTechniquesFn=q;var p,
i;p=Y.create("constant");d.add(p);i={prepare:m,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"flat",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:m,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"flat_skinned",update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("constant_nocull");d.add(p);i={prepare:m,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"flat_nocull",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",
i);i={prepare:m,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"flat_skinned_nocull",update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("lambert");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"lambert",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"lambert_skinned",update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("blinn");
d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"blinn",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"blinn_skinned",update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("blinn_nocull");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"blinn_nocull",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:l,
shaderName:"shaders/defaultrendering.cgfx",techniqueName:"blinn_skinned_nocull",update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("phong");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"phong",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"phong_skinned",update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("debug_lines_constant");
d.add(p);i={prepare:function(a){ta.defaultPrepareFn.call(this,a);a.techniqueParameters.constantColor=a.sharedMaterial.meta.constantColor},shaderName:"shaders/debug.cgfx",techniqueName:"debug_lines_constant",update:e,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);p=Y.create("debug_normals");d.add(p);i={prepare:ta.defaultPrepareFn,shaderName:"shaders/debug.cgfx",techniqueName:"debug_normals",update:e,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:ta.defaultPrepareFn,shaderName:"shaders/debug.cgfx",
techniqueName:"debug_normals_skinned",update:j,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("debug_tangents");d.add(p);i={prepare:ta.defaultPrepareFn,shaderName:"shaders/debug.cgfx",techniqueName:"debug_tangents",update:e,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:ta.defaultPrepareFn,shaderName:"shaders/debug.cgfx",techniqueName:"debug_tangents_skinned",update:j,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("debug_binormals");d.add(p);
i={prepare:ta.defaultPrepareFn,shaderName:"shaders/debug.cgfx",techniqueName:"debug_binormals",update:e,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:ta.defaultPrepareFn,shaderName:"shaders/debug.cgfx",techniqueName:"debug_binormals_skinned",update:j,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("normalmap");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"normalmap",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",
i);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"normalmap_skinned",update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("normalmap_specularmap");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"normalmap_specularmap",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"normalmap_specularmap_skinned",update:h,loadTechniques:q};i.loadTechniques(c);
p.add("skinned",i);p=Y.create("normalmap_specularmap_alphamap");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"normalmap_specularmap_alphamap",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);p=Y.create("normalmap_alphatest");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"normalmap_alphatest",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"normalmap_alphatest_skinned",
update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("normalmap_specularmap_alphatest");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"normalmap_specularmap_alphatest",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"normalmap_specularmap_alphatest_skinned",update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("normalmap_glowmap");d.add(p);
i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"normalmap_glowmap",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"normalmap_glowmap_skinned",update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("normalmap_specularmap_glowmap");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"normalmap_specularmap_glowmap",update:a,loadTechniques:q};i.loadTechniques(c);
p.add("rigid",i);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"normalmap_specularmap_glowmap_skinned",update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("rxgb_normalmap");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"rxgb_normalmap",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"rxgb_normalmap_skinned",update:h,loadTechniques:q};
i.loadTechniques(c);p.add("skinned",i);p=Y.create("rxgb_normalmap_specularmap");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"rxgb_normalmap_specularmap",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"rxgb_normalmap_specularmap_skinned",update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("rxgb_normalmap_alphatest");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",
techniqueName:"rxgb_normalmap_alphatest",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"rxgb_normalmap_alphatest_skinned",update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("rxgb_normalmap_specularmap_alphatest");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"rxgb_normalmap_specularmap_alphatest",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",
i);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"rxgb_normalmap_specularmap_alphatest_skinned",update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("rxgb_normalmap_glowmap");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"rxgb_normalmap_glowmap",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"rxgb_normalmap_glowmap_skinned",update:h,
loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("rxgb_normalmap_specularmap_glowmap");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"rxgb_normalmap_specularmap_glowmap",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"rxgb_normalmap_specularmap_glowmap_skinned",update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("add");d.add(p);i={prepare:l,
shaderName:"shaders/defaultrendering.cgfx",techniqueName:"add",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"add_skinned",update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("add_particle");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"add_particle",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);p=Y.create("blend");d.add(p);i={prepare:l,
shaderName:"shaders/defaultrendering.cgfx",techniqueName:"blend",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"blend_skinned",update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("blend_particle");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"blend_particle",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);p=Y.create("translucent");d.add(p);
i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"translucent",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"translucent_skinned",update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("translucent_particle");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"translucent_particle",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",
i);p=Y.create("filter");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"filter",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"filter_skinned",update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("invfilter");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"invfilter",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",
i);p=Y.create("invfilter_particle");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"invfilter_particle",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);p=Y.create("glass");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"glass",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);p=Y.create("glass_env");d.add(p);i={prepare:m,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"glass_env",update:r,loadTechniques:q};
i.loadTechniques(c);p.add("rigid",i);p=Y.create("modulate2");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"modulate2",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"modulate2_skinned",update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("skybox");d.add(p);i={prepare:m,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"skybox",update:r,loadTechniques:q};
i.loadTechniques(c);p.add("rigid",i);p=Y.create("env");d.add(p);i={prepare:m,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"env",update:r,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:m,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"env_skinned",update:function(a){r.call(this,a);(a=this.skinController)&&a.update()},loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("flare");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",
techniqueName:"add",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);d.map("default","blinn");p=Y.create("glowmap");d.add(p);i={prepare:m,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"glowmap",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);i={prepare:m,shaderName:"shaders/defaultrendering.cgfx",techniqueName:"glowmap_skinned",update:h,loadTechniques:q};i.loadTechniques(c);p.add("skinned",i);p=Y.create("lightmap");d.add(p);i={prepare:l,shaderName:"shaders/defaultrendering.cgfx",
techniqueName:"lightmap",update:a,loadTechniques:q};i.loadTechniques(c);p.add("rigid",i);return f};ta.version=1;ta.numPasses=3;ta.passIndex={opaque:0,decal:1,transparent:2};ta.nextRenderinfoID=0;ta.nextSkinID=0;ta.identityUVTransform=new Float32Array([1,0,0,1,0,0]);var Fd=function(){};Fd.create=function(){var a=new Fd;a.indices=[];a.textures=[];a.numSets=0;a.vertexBufferData=new gb.floatArray(1024);a.numVertices=0;return a};var Pa=function(){};Pa.prototype.getTextureRectangle=function(a){void 0===
a&&(a=new gb.floatArray(4));var b=this.data,c=this._texture;c?(a[0]=b[12]*c.width,a[1]=b[13]*c.height,a[2]=b[14]*c.width,a[3]=b[15]*c.height):(a[0]=b[12],a[1]=b[13],a[2]=b[14],a[3]=b[15]);return a};Pa.prototype.setTextureRectangle=function(a){var b=this.data,c=this._texture;if(c){var d=1/c.width,c=1/c.height;b[12]=a[0]*d;b[13]=a[1]*c;b[14]=a[2]*d;b[15]=a[3]*c}else b[12]=a[0],b[13]=a[1],b[14]=a[2],b[15]=a[3]};Pa.prototype.getColor=function(a){void 0===a&&(a=new gb.floatArray(4));var b=this.data;a[0]=
b[8];a[1]=b[9];a[2]=b[10];a[3]=b[11];return a};Pa.prototype.setColor=function(a){var b=this.data;b[8]=a[0];b[9]=a[1];b[10]=a[2];b[11]=a[3]};Pa.prototype.getTexture=function(){return this._texture};Pa.prototype.setTexture=function(a){if(this._texture!==a){var b=(this._texture?this._texture.width:1)/(a?a.width:1),c=(this._texture?this._texture.height:1)/(a?a.height:1);this._texture=a||null;a=this.data;a[12]*=b;a[13]*=c;a[14]*=b;a[15]*=c}};Pa.prototype.getWidth=function(){return 2*this.data[17]};Pa.prototype.setWidth=
function(a){var a=0.5*a,b=this.data;b[17]!==a&&(b[17]=a,this._invalidate())};Pa.prototype.getHeight=function(){return 2*this.data[18]};Pa.prototype.setHeight=function(a){var a=0.5*a,b=this.data;b[18]!==a&&(b[18]=a,this._invalidate())};Pa.prototype.getScale=function(a){void 0===a&&(a=new gb.floatArray(2));var b=this.data;a[0]=b[19];a[1]=b[20];return a};Pa.prototype.setScale=function(a){var b=a[0],a=a[1],c=this.data;if(c[19]!==b||c[20]!==a)c[19]=b,c[20]=a,this._invalidate()};Pa.prototype.getShear=function(a){void 0===
a&&(a=new gb.floatArray(2));var b=this.data;a[0]=b[21];a[1]=b[22];return a};Pa.prototype.setShear=function(a){var b=a[0],a=a[1],c=this.data;if(c[21]!==b||c[22]!==a)c[21]=b,c[22]=a,this._invalidate()};Pa.prototype.getOrigin=function(a){void 0===a&&(a=new gb.floatArray(2));var b=this.data;a[0]=b[23];a[1]=b[24];return a};Pa.prototype.setOrigin=function(a){var b=a[0],a=a[1],c=this.data;if(c[23]!==b||c[24]!==a)c[23]=b,c[24]=a,this._invalidate()};Pa.prototype._invalidate=function(){var a=this.data,b=a[19],
c=a[19]*a[21],d=a[20]*a[22],f=a[20],g=a[17]-a[23],h=a[18]-a[24],e=a[25]=b*g+c*h,j=a[26]=d*g+f*h,g=-a[17],h=-a[18],r=a[27]=b*g+c*h,l=a[28]=d*g+f*h,g=-g,b=a[29]=b*g+c*h,d=a[30]=d*g+f*h,g=a[16]=this.rotation,f=Math.cos(g),g=Math.sin(g);a[31]=f*e-g*j;a[32]=g*e+f*j;a[33]=f*r-g*l;a[34]=g*r+f*l;a[35]=f*b-g*d;a[36]=g*b+f*d;f=2*(e*r+j*l);0>f&&(f=-f);r=r*r+l*l+f;f=2*(e*b+j*d);0>f&&(f=-f);l=b*b+d*d+f;l>r&&(r=l);a[37]=0.25/(r+(e*e+j*j))};Pa.prototype._update=function(a){var b=this.data,c,d,f;c=this.rotation;
d=c-b[16];d*d>b[37]*a&&(b[16]=c,a=Math.cos(c),f=Math.sin(c),c=b[25],d=b[26],b[31]=a*c-f*d,b[32]=f*c+a*d,c=b[27],d=b[28],b[33]=a*c-f*d,b[34]=f*c+a*d,c=b[29],d=b[30],b[35]=a*c-f*d,b[36]=f*c+a*d);a=this.x+b[31];f=this.y+b[32];c=b[33];d=b[34];b[0]=a+c;b[1]=f+d;b[6]=a-c;b[7]=f-d;c=b[35];d=b[36];b[2]=a+c;b[3]=f+d;b[4]=a-c;b[5]=f-d};Pa.create=function(a){if((void 0===a.width||void 0===a.height)&&!a.texture)return null;var b=new Pa,c=b.data=new gb.floatArray(38),d=b._texture=a.texture||null;b.x=a.x||0;b.y=
a.y||0;b.rotation=c[16]=a.rotation||0;var f=a.color;c[8]=f?f[0]:1;c[9]=f?f[1]:1;c[10]=f?f[2]:1;c[11]=f?f[3]:1;var f=a.textureRectangle,g=d?1/d.width:1,h=d?1/d.height:1;c[12]=f?f[0]*g:0;c[13]=f?f[1]*h:0;c[14]=f?f[2]*g:1;c[15]=f?f[3]*h:1;c[17]=0.5*(void 0!==a.width?a.width:d.width);c[18]=0.5*(void 0!==a.height?a.height:d.height);d=a.scale;c[19]=d?d[0]:1;c[20]=d?d[1]:1;d=a.shear;c[21]=d?d[0]:0;c[22]=d?d[1]:0;a=a.origin;c[23]=a?a[0]:c[17];c[24]=a?a[1]:c[18];b._invalidate();return b};Pa.version=1;var Ng=
{setFromRotatedRectangle:function(a,b,c,d,f,g,h){var e=c[0],j=c[1],r=c[2],l=c[3];if(g){h?(c=e+h[0],h=j+h[1]):(c=0.5*(e+r),h=0.5*(j+l));var m=e-c,q=j-h,p=Math.cos(g),g=Math.sin(g),r=r-e,l=l-j;a[0]=e=c+(p*m-g*q);a[1]=j=h+(g*m+p*q);a[2]=e+p*r;a[3]=j+g*r;a[4]=e-g*l;a[5]=j+p*l;a[6]=e+(p*r-g*l);a[7]=j+(g*r+p*l)}else a[0]=e,a[1]=j,a[2]=r,a[3]=j,a[4]=e,a[5]=l,a[6]=r,a[7]=l;f?(a[8]=f[0],a[9]=f[1],a[10]=f[2],a[11]=f[3]):a[8]=a[9]=a[10]=a[11]=1;d&&b?(f=1/b.width,b=1/b.height,a[12]=d[0]*f,a[13]=d[1]*b,a[14]=
d[2]*f,a[15]=d[3]*b):(a[12]=a[13]=0,a[14]=a[15]=1)},create:function(){return new gb.floatArray(16)}},gb,na=function(){this.clearBackBuffer=this.forceUpdate=!1;this.defaultClearColor=na.defaultClearColor;this.sort={deferred:"deferred",immediate:"immediate",texture:"texture"};this.scale={scale:"scale",none:"none"};this.blend={additive:"additive",alpha:"alpha",opaque:"opaque"};this.drawStates={uninit:0,ready:1,draw:2}};na.prototype.clear=function(a){if(this.state!==this.drawStates.ready)return!1;var b=
this.graphicsDevice;if(this.currentRenderTarget){if(!b.beginRenderTarget(this.currentRenderTarget.renderTarget))return!1;b.clear(a||this.defaultClearColor);b.endRenderTarget()}else b.clear(a||this.defaultClearColor);return!0};na.prototype.clearBatch=function(){var a=this.texLists,b;for(b in a)a.hasOwnProperty(b)&&(a[b]=void 0);this.currentTextureGroup=void 0;this.numGroups=0};na.prototype.bufferSprite=function(a,b,c){b._update(0);c<<=4;b=b.data;a[c]=b[0];a[c+1]=b[1];a[c+2]=b[2];a[c+3]=b[3];a[c+4]=
b[4];a[c+5]=b[5];a[c+6]=b[6];a[c+7]=b[7];a[c+8]=b[8];a[c+9]=b[9];a[c+10]=b[10];a[c+11]=b[11];a[c+12]=b[12];a[c+13]=b[13];a[c+14]=b[14];a[c+15]=b[15]};na.prototype.update=function(){var a=this.graphicsDevice,b=this.height,c=a.width,d=a.height;if(this.width!==c||b!==d||this.forceUpdate){var f,g;(f=this.viewportRectangle)?(a=f[0],g=f[1],b=f[2]-a,f=f[3]-g):(g=a=0,b=c,f=d);this.clearBackBuffer=b===c&&f===d?!1:!0;var h=this.currentRenderTarget;if("scale"===this.scaleMode){var e,j;c/d>b/f?(e=Math.ceil(d/
f*b),this.scissorX=j=Math.floor(0.5*(c-e)),this.scissorY=0,this.scissorWidth=e,this.scissorHeight=d,this.viewScaleX=b/e,this.viewScaleY=f/d,h||(this.clipOffsetX=2*(j/c)-1,this.clipOffsetY=1,this.clipScaleX=2*(e/c)/b,this.clipScaleY=-2/f)):(e=Math.ceil(c/b*f),j=Math.floor(0.5*(d-e)),this.scissorX=0,this.scissorY=j,this.scissorWidth=c,this.scissorHeight=e,this.viewScaleX=b/c,this.viewScaleY=f/e,h||(this.clipOffsetX=-1,this.clipOffsetY=1-2*(j/d),this.clipScaleX=2/b,this.clipScaleY=-2*(e/d)/f))}else this.viewScaleY=
this.viewScaleX=1,h||(this.clipOffsetX=-1,this.clipOffsetY=1,this.clipScaleX=2/c,this.clipScaleY=-2/d),this.scissorX=0,this.scissorY=d-f,this.scissorWidth=b,this.scissorHeight=f;this.spriteAngleFactor=Math.min(this.viewScaleX,this.viewScaleY);this.spriteAngleFactor*=this.spriteAngleFactor;this.width=c;this.height=d;c=0;d=this.renderTargetStructs;e=d.length;for(c=0;c<e;c+=1)this.validateTarget(d[c],this.scissorWidth,this.scissorHeight);h&&(this.clipOffsetY=this.clipOffsetX=-1,this.clipScaleX=2*h.actualWidth/
h.texture.width/b,this.clipScaleY=2*h.actualHeight/h.texture.height/f);this.clipOffsetX-=a*this.clipScaleX;this.clipOffsetY-=g*this.clipScaleY;b=this.techniqueParameters.clipSpace;b[0]=this.clipScaleX;b[1]=this.clipScaleY;b[2]=this.clipOffsetX;b[3]=this.clipOffsetY;this.updateRenderTargetVbo(this.scissorX,this.scissorY,this.scissorWidth,this.scissorHeight);this.forceUpdate=!1}};na.prototype.getViewport=function(a){a||(a=new na.floatArray(4));var b=this.viewportRectangle;b?(a[0]=b[0],a[1]=b[1],a[2]=
b[2],a[3]=b[3]):(a[0]=a[1]=0,a[2]=this.graphicsDevice.width,a[3]=this.graphicsDevice.height);return a};na.prototype.getScreenSpaceViewport=function(a){a||(a=new na.floatArray(4));this.update();a[0]=this.scissorX;a[1]=this.height-(this.scissorY+this.scissorHeight);a[2]=a[0]+this.scissorWidth;a[3]=a[1]+this.scissorHeight;return a};na.prototype.viewportMap=function(a,b,c){c||(c=new na.floatArray(2));this.update();var d=this.height-this.scissorHeight-this.scissorY;c[0]=(a-this.scissorX)*this.viewScaleX;
c[1]=(b-d)*this.viewScaleY;if(a=this.viewportRectangle)c[0]+=a[0],c[1]+=a[1];return c};na.prototype.viewportUnmap=function(a,b,c){c||(c=new na.floatArray(2));this.update();var d=this.viewportRectangle;d&&(a-=d[0],b-=d[1]);d=this.height-this.scissorHeight-this.scissorY;c[0]=a/this.viewScaleX+this.scissorX;c[1]=b/this.viewScaleY+d;return c};na.prototype.viewportClamp=function(a){if(a){var b=a[0],c=a[1],d,f,g,h;(h=this.viewportRectangle)?(d=h[0],f=h[1],g=h[2],h=h[3]):(f=d=0,g=this.graphicsDevice.width,
h=this.graphicsDevice.height);b<d?b=d:b>g&&(b=g);c<f?c=f:c>h&&(c=h);a[0]=b;a[1]=c}return a};na.prototype.configure=function(a){if(this.state!==this.drawStates.ready)return!1;var b="viewportRectangle"in a?a.viewportRectangle:this.viewportRectangle,a=a.scaleMode;if(void 0!==a){if(!(a in this.scale)||"scale"===a&&!b)return!1;this.scaleMode=a}this.viewportRectangle=b;this.forceUpdate=!0;this.update();return!0};na.prototype.destroy=function(){this.texLists=null;this.state=this.drawStates.uninit;this.graphicsDevice=
null;this.vertexBuffer&&this.vertexBuffer.destroy();this.indexBuffer&&this.indexBuffer.destroy();this.copyVertexBuffer.destroy();for(var a=this.renderTargetStructs;0<a.length;){var b=a.pop();b.texture.destroy();b.renderTarget.destroy();b.texture=null;b.renderTarget=null}};na.prototype.begin=function(a,b){if(b&&!(b in this.sort)||a&&!(a in this.blend))return!1;var c=!this.sortMode;this.dispatch()&&this.clearBatch();if(c){if(this.state!==this.drawStates.ready)return!1;this.update();this.currentRenderTarget||
this.graphicsDevice.setScissor(this.scissorX,this.scissorY,this.scissorWidth,this.scissorHeight)}this.state=this.drawStates.draw;b=b?b:c?"deferred":this.sortMode;a=a?a:c?"opaque":this.blendMode;c||(this.sortModeStack.push(this.sortMode),this.blendModeStack.push(this.blendMode));this.sortMode=b;this.blendMode=a;this.prepareSortMode(b);this.graphicsDevice.setTechnique(this.blendModeTechniques[a]);return!0};na.prototype._bufferSprite=function(a,b){var c=a.vertexBufferData,d=this.vertexBuffer,f=a.numVertices*
d.stride,d=f+4*d.stride;if(d>=c.length){var d=this.bufferSizeAlgorithm(d,this.cpuStride),d=new na.floatArray(d),g;for(g=0;g<f;g+=1)d[g]=c[g];a.vertexBufferData=c=d}d=b[8];g=b[9];var h=b[10],e=b[11],j=b[12],r=b[13],l=b[14],m=b[15];c[f]=b[0];c[f+1]=b[1];c[f+2]=d;c[f+3]=g;c[f+4]=h;c[f+5]=e;c[f+6]=j;c[f+7]=r;c[f+8]=b[2];c[f+9]=b[3];c[f+10]=d;c[f+11]=g;c[f+12]=h;c[f+13]=e;c[f+14]=l;c[f+15]=r;c[f+16]=b[4];c[f+17]=b[5];c[f+18]=d;c[f+19]=g;c[f+20]=h;c[f+21]=e;c[f+22]=j;c[f+23]=m;c[f+24]=b[6];c[f+25]=b[7];
c[f+26]=d;c[f+27]=g;c[f+28]=h;c[f+29]=e;c[f+30]=l;c[f+31]=m;a.numVertices+=4;a.indices[a.numSets-1]+=6};na.prototype.bufferMultiSprite=function(a,b,c,d){var f=a.vertexBufferData,g=this.vertexBuffer,h=void 0===c?Math.floor(b.length/16):c,c=16*h,d=16*(void 0!==d?d:0),e=a.numVertices*g.stride,g=e+4*h*g.stride;if(g>=f.length){for(var g=this.bufferSizeAlgorithm(g,this.cpuStride),j=new na.floatArray(g),g=0;g<e;g+=1)j[g]=f[g];a.vertexBufferData=f=j}c=d+c;for(g=d;g<c;g+=16){var d=b[g+8],j=b[g+9],r=b[g+10],
l=b[g+11],m=b[g+12],q=b[g+13],p=b[g+14],i=b[g+15];f[e]=b[g];f[e+1]=b[g+1];f[e+2]=d;f[e+3]=j;f[e+4]=r;f[e+5]=l;f[e+6]=m;f[e+7]=q;f[e+8]=b[g+2];f[e+9]=b[g+3];f[e+10]=d;f[e+11]=j;f[e+12]=r;f[e+13]=l;f[e+14]=p;f[e+15]=q;f[e+16]=b[g+4];f[e+17]=b[g+5];f[e+18]=d;f[e+19]=j;f[e+20]=r;f[e+21]=l;f[e+22]=m;f[e+23]=i;f[e+24]=b[g+6];f[e+25]=b[g+7];f[e+26]=d;f[e+27]=j;f[e+28]=r;f[e+29]=l;f[e+30]=p;f[e+31]=i;e+=32}a.numVertices+=4*h;a.indices[a.numSets-1]+=6*h};na.prototype.indexData=function(a){var b=new na.uint16Array(a),
c,d=0;for(c=0;c<a;c+=6)b[c]=d,b[c+1]=d+1,b[c+2]=d+2,b[c+3]=d+1,b[c+4]=d+2,b[c+5]=d+3,d+=4;return b};na.prototype.uploadBuffer=function(a,b,c){var d=this.vertexBuffer,f=this.vertexBufferParameters,g=this.graphicsDevice,a=a.vertexBufferData,h=this.performanceData;if(b>f.numVertices){var e=this.bufferSizeAlgorithm(b,this.gpuStride);e>this.maxVertices&&(e=this.maxVertices);f.numVertices=e;this.vertexBuffer.destroy();this.vertexBuffer=d=g.createVertexBuffer(f);h.gpuMemoryUsage=35*e;e*=1.5;f=this.indexBufferParameters;
f.data=this.indexData(e);f.numIndices=e;this.indexBuffer.destroy();this.indexBuffer=g.createIndexBuffer(f);f.data=null;g.setIndexBuffer(this.indexBuffer)}h.dataTransfers+=1;0===c?d.setData(a,0,b):(g=d.stride,d.setData(a.subarray(c*g,(c+b)*g),0,b))};na.prototype.drawRawImmediate=function(a,b,c,d){var f=this.drawGroups[0];f.textures[0]=a||this.defaultTexture;f.indices[0]=0;this.numGroups=f.numSets=1;this.bufferMultiSprite(f,b,c,d);this.dispatch()};na.prototype.drawSpriteImmediate=function(a){var b=
this.drawGroups[0];b.textures[0]=a._texture||this.defaultTexture;b.indices[0]=0;this.numGroups=b.numSets=1;a._update(this.spriteAngleFactor);this._bufferSprite(b,a.data);this.dispatch()};na.prototype.drawImmediate=function(a){var b=a.texture||this.defaultTexture,c=a.destinationRectangle,d=a.sourceRectangle,f=a.color,g=a.rotation,h=this.drawGroups[0];h.textures[0]=b;h.indices[0]=0;this.numGroups=h.numSets=1;var e=this.drawSprite;Ng.setFromRotatedRectangle(e,b,c,d,f,g,a.origin);this._bufferSprite(h,
e);this.dispatch()};na.prototype.drawRawDeferred=function(a,b,c,d){var a=a||this.defaultTexture,f=this.drawGroups[0];this.numGroups=1;var g=f.numSets;if(0===g||f.textures[g-1]!==a)f.textures[g]=a,f.indices[g]=0,f.numSets+=1;this.bufferMultiSprite(f,b,c,d)};na.prototype.drawSpriteDeferred=function(a){var b=a._texture||this.defaultTexture,c=this.drawGroups[0];this.numGroups=1;var d=c.numSets;if(0===d||c.textures[d-1]!==b)c.textures[d]=b,c.indices[d]=0,c.numSets+=1;a._update(this.spriteAngleFactor);
this._bufferSprite(c,a.data)};na.prototype.drawDeferred=function(a){var b=a.texture||this.defaultTexture,c=this.drawGroups[0];this.numGroups=1;var d=c.numSets;if(0===d||c.textures[d-1]!==b)c.textures[d]=b,c.indices[d]=0,c.numSets+=1;d=this.drawSprite;Ng.setFromRotatedRectangle(d,b,a.destinationRectangle,a.sourceRectangle,a.color,a.rotation,a.origin);this._bufferSprite(c,d)};na.prototype.drawRawTextured=function(a,b,c,d){var a=a||this.defaultTexture,f;if(void 0!==this.currentTextureGroup&&this.currentTextureGroup.textures[0]===
a)f=this.currentTextureGroup;else{var g=a.name,h=this.texLists;f=h[g];f||((f=this.drawGroups[this.numGroups])||(f=Fd.create()),this.drawGroups[this.numGroups]=h[g]=f,f.textures[0]=a,f.indices[0]=0,f.numSets=1,this.numGroups+=1);this.currentTextureGroup=f}this.bufferMultiSprite(f,b,c,d)};na.prototype.drawSpriteTextured=function(a){var b=a._texture||this.defaultTexture,c;if(void 0!==this.currentTextureGroup&&this.currentTextureGroup.textures[0]===b)c=this.currentTextureGroup;else{var d=b.name,f=this.texLists;
c=f[d];c||((c=this.drawGroups[this.numGroups])||(c=Fd.create()),this.drawGroups[this.numGroups]=f[d]=c,c.textures[0]=b,c.indices[0]=0,c.numSets=1,this.numGroups+=1);this.currentTextureGroup=c}a._update(this.spriteAngleFactor);this._bufferSprite(c,a.data)};na.prototype.drawTextured=function(a){var b=a.texture||this.defaultTexture,c;if(void 0!==this.currentTextureGroup&&this.currentTextureGroup.textures[0]===b)c=this.currentTextureGroup;else{var d=b.name,f=this.texLists;c=f[d];c||((c=this.drawGroups[this.numGroups])||
(c=Fd.create()),this.drawGroups[this.numGroups]=f[d]=c,c.textures[0]=b,c.indices[0]=0,c.numSets=1,this.numGroups+=1);this.currentTextureGroup=c}d=this.drawSprite;Ng.setFromRotatedRectangle(d,b,a.destinationRectangle,a.sourceRectangle,a.color,a.rotation,a.origin);this._bufferSprite(c,d)};na.prototype.prepareSortMode=function(a){"deferred"===a?(this.draw=this.drawDeferred,this.drawSprite=this.drawSpriteDeferred,this.drawRaw=this.drawRawDeferred):"immediate"===a?(this.draw=this.drawImmediate,this.drawSprite=
this.drawSpriteImmediate,this.drawRaw=this.drawRawImmediate):(this.draw=this.drawTextured,this.drawSprite=this.drawSpriteTextured,this.drawRaw=this.drawRawTextured)};na.prototype.end=function(){if(this.state!==this.drawStates.draw)return!1;this.dispatch()&&this.clearBatch();0!==this.blendModeStack.length?(this.blendMode=this.blendModeStack.pop(),this.sortMode=this.sortModeStack.pop(),this.prepareSortMode(this.sortMode),this.graphicsDevice.setTechnique(this.blendModeTechniques[this.blendMode])):(this.sortMode=
this.blendMode=void 0,this.state=this.drawStates.ready);return!0};na.prototype.dispatch=function(){var a=this.numGroups;if(0===a)return!1;var b=this.graphicsDevice,c=this.techniqueParameters;b.setIndexBuffer(this.indexBuffer);var d=this.drawGroups,f=!1;this.currentRenderTarget&&(f=b.beginRenderTarget(this.currentRenderTarget.renderTarget));var g=this.performanceData,h;for(h=0;h<a;h+=1){for(var e=d[h],j=e.textures,r=e.indices,l=0,m=0,q=e.numVertices;m<q;){var p=q-m;p>this.maxVertices&&(p=this.maxVertices);
this.uploadBuffer(e,p,m);b.setStream(this.vertexBuffer,this.semantics);for(var i=1.5*p,k=0;k<i;){c.texture=j[l];var u=i-k;u>=r[l]?(u=r[l],l+=1):r[l]-=u;var z=u/6;0===g.batchCount?(g.minBatchSize=z,g.maxBatchSize=z,g.avgBatchSize=z,g.batchCount=1):(z<g.minBatchSize&&(g.minBatchSize=z),z>g.maxBatchSize&&(g.maxBatchSize=z),g.avgBatchSize*=g.batchCount,g.avgBatchSize+=z,g.batchCount+=1,g.avgBatchSize/=g.batchCount);b.setTechniqueParameters(c);b.drawIndexed(b.PRIMITIVE_TRIANGLES,u,k);k+=u}m+=p}e.numSets=
0;e.numVertices=0}this.currentRenderTarget&&f&&b.endRenderTarget();return!0};na.prototype.bufferSizeAlgorithm=function(a,b){var c=Math.ceil(Math.log(a)/Math.log(1.25)),c=Math.floor(Math.pow(1.25,c));return b*Math.ceil(c/b)};na.prototype.updateRenderTargetVbo=function(a,b,c,d){var f=this.graphicsDevice,g=0.5*f.width,h=0.5*f.height,f=this.copyVertexBuffer,e=(a-g)/g,a=(a+c-g)/g,c=(b-h)/h,b=(b+d-h)/h,d=this.vertexBufferData;d[0]=e;d[1]=b;d[2]=0;d[3]=1;d[4]=e;d[5]=c;d[6]=0;d[7]=0;d[8]=a;d[9]=b;d[10]=1;
d[11]=1;d[12]=a;d[13]=c;d[14]=1;d[15]=0;f.setData(d,0,4)};na.makePow2=function(a){a=Math.log(a)/Math.log(2);return 1<<Math.ceil(a)};na.prototype.createRenderTarget=function(a){var b=this.graphicsDevice,c=this.renderTargetStructs,d=c.length,f=a&&void 0!==a.backBuffer?a.backBuffer:!0,g=void 0===a.width||void 0===a.height,h=this.renderTargetTextureParameters;h.name=a&&a.name?a.name:"RenderTarget#"+d;var e=g?b.width:a.width,a=g?b.height:a.height,j=na.makePow2;h.width=j(e);h.height=j(a);h=b.createTexture(h);
j=this.renderTargetParams;j.colorTexture0=h;b=b.createRenderTarget(j);c.push({managed:g,renderTarget:b,texture:h,backBuffer:f,actualWidth:f?e:h.width,actualHeight:f?a:h.height});return d};na.prototype.validateTarget=function(a,b,c){if(a.managed){var d=a.texture;a.backBuffer&&(a.actualWidth=b,a.actualHeight=c);var f=na.makePow2,b=f(b),c=f(c);a.backBuffer||(a.actualWidth=b,a.actualHeight=c);if(d.width!==b||d.height!==c){var f=this.renderTargetTextureParameters,g=this.renderTargetParams;f.name=d.name;
f.width=b;f.height=c;d.destroy();a.renderTarget.destroy();b=this.graphicsDevice;a.texture=b.createTexture(f);g.colorTexture0=a.texture;a.renderTarget=b.createRenderTarget(g)}}};na.prototype.setBackBuffer=function(){if(this.state!==this.drawStates.ready)return!1;this.currentRenderTarget=null;return this.forceUpdate=!0};na.prototype.getRenderTargetTexture=function(a){var b=this.renderTargetStructs;return 0>a||a>=b.length?null:b[a].texture};na.prototype.getRenderTarget=function(a){var b=this.renderTargetStructs;
return 0>a||a>=b.length?null:b[a].renderTarget};na.prototype.setRenderTarget=function(a){var b=this.renderTargetStructs;if(0>a||a>=b.length||this.state!==this.drawStates.ready)return!1;this.currentRenderTarget=b[a];return this.forceUpdate=!0};na.prototype.copyRenderTarget=function(a){if(this.state!==this.drawStates.ready)return!1;var b=this.renderTargetStructs;if(0>a||a>=b.length)return!1;this.update();this.currentRenderTarget||this.graphicsDevice.setScissor(this.scissorX,this.scissorY,this.scissorWidth,
this.scissorHeight);var c=this.graphicsDevice,d=b[a],f=d.texture,a=this.copyTechnique,b=this.copyTechniqueParameters,g=b.copyUVScale;g[0]=d.actualWidth/f.width;g[1]=d.actualHeight/f.height;b.copyFlip=!this.currentRenderTarget?-1:1;b.inputTexture0=f;d=!1;f=this.currentRenderTarget;g=this.copyVertexBuffer;f&&(d=c.beginRenderTarget(f.renderTarget));c.setTechnique(a);c.setTechniqueParameters(b);c.setStream(g,this.quadSemantics);c.draw(this.quadPrimitive,4,0);f&&d&&c.endRenderTarget();return!0};na.prototype.resetPerformanceData=
function(){var a=this.performanceData;a.minBatchSize=a.maxBatchSize=a.avgBatchSize=void 0;a.batchCount=0;a.dataTransfers=0};na.create=function(a){var b=new na,c=b.graphicsDevice=a.graphicsDevice;b.sortMode=void 0;b.blendMode=void 0;b.sortModeStack=[];b.blendModeStack=[];b.drawGroups=[Fd.create()];b.numGroups=0;b.texLists={};b.texGroup=void 0;b.drawSprite=Ng.create();b.defaultTexture=c.createTexture({name:"DefaultDraw2DTexture",width:1,height:1,depth:1,format:"L8",cubemap:!1,mipmaps:!0,renderable:!1,
dynamic:!1,data:[255]});b.draw=void 0;b.drawSprite=void 0;b.drawRaw=void 0;var d=c.createShader({version:1,name:"draw2D.cgfx",samplers:{texture:{MinFilter:9985,MagFilter:9729,WrapS:33071,WrapT:33071},inputTexture0:{MinFilter:9728,MagFilter:9729,WrapS:33071,WrapT:33071}},parameters:{clipSpace:{type:"float",columns:4},copyUVScale:{type:"float",columns:2},copyFlip:{type:"float"},texture:{type:"sampler2D"},inputTexture0:{type:"sampler2D"}},techniques:{opaque:[{parameters:["clipSpace","texture"],semantics:["POSITION",
"COLOR","TEXCOORD0"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!1},programs:["vp_draw2D","fp_draw2D"]}],alpha:[{parameters:["clipSpace","texture"],semantics:["POSITION","COLOR","TEXCOORD0"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[770,771]},programs:["vp_draw2D","fp_draw2D"]}],additive:[{parameters:["clipSpace","texture"],semantics:["POSITION","COLOR","TEXCOORD0"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,
BlendFunc:[770,1]},programs:["vp_draw2D","fp_draw2D"]}],copy:[{parameters:["copyUVScale","copyFlip","inputTexture0"],semantics:["POSITION","TEXCOORD0"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!1},programs:["vp_copy","fp_copy"]}]},programs:{fp_copy:{type:"fragment",code:"#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];\nvec4 _ret_0;uniform sampler2D inputTexture0;void main()\n{_ret_0=texture2D(inputTexture0,tz_TexCoord[0].xy);gl_FragColor=_ret_0;}"},
vp_copy:{type:"vertex",code:"#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];attribute vec4 ATTR0;attribute vec4 ATTR8;\nvec4 _OutPosition1;vec2 _OutUV1;uniform vec2 copyUVScale;uniform float copyFlip;void main()\n{_OutPosition1.x=ATTR0.x;_OutPosition1.y=ATTR0.y*copyFlip;_OutPosition1.zw=ATTR0.zw;_OutUV1=ATTR8.xy*copyUVScale;tz_TexCoord[0].xy=_OutUV1;gl_Position=_OutPosition1;}"},fp_draw2D:{type:"fragment",
code:"#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying TZ_LOWP vec4 tz_Color;varying vec4 tz_TexCoord[1];\nvec4 _ret_0;vec4 _TMP0;uniform sampler2D texture;void main()\n{_TMP0=texture2D(texture,tz_TexCoord[0].xy);_ret_0=tz_Color*_TMP0;gl_FragColor=_ret_0;}"},vp_draw2D:{type:"vertex",code:"#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying TZ_LOWP vec4 tz_Color;varying vec4 tz_TexCoord[1];attribute vec4 ATTR0;attribute vec4 ATTR3;attribute vec4 ATTR8;\nvec4 _OUTPosition1;vec4 _OUTColor1;vec2 _OUTTexCoord01;uniform vec4 clipSpace;void main()\n{vec2 _position;_position=ATTR0.xy*clipSpace.xy+clipSpace.zw;_OUTPosition1.x=_position.x;_OUTPosition1.y=_position.y;_OUTPosition1.z=0.0;_OUTPosition1.w=1.0;_OUTColor1=ATTR3;_OUTTexCoord01=ATTR8.xy;tz_TexCoord[0].xy=ATTR8.xy;tz_Color=ATTR3;gl_Position=_OUTPosition1;}"}}});
b.blendModeTechniques={additive:d.getTechnique("additive"),alpha:d.getTechnique("alpha"),opaque:d.getTechnique("opaque")};if(a.blendModes)for(var f in a.blendModes)a.blendModes.hasOwnProperty(f)&&(b.blend[f]=f,b.blendModeTechniques[f]=a.blendModes[f]);b.techniqueParameters=c.createTechniqueParameters({clipSpace:new na.floatArray(4),texture:null});b.currentRenderTarget=null;b.renderTargetStructs=[];b.state=b.drawStates.ready;b.scaleMode="none";b.blendMode="opaque";b.width=0;b.height=0;b.scissorX=0;
b.scissorY=0;b.scissorWidth=b.graphicsDevice.width;b.scissorHeight=b.graphicsDevice.height;b.clipOffsetX=-1;b.clipOffsetY=1;b.clipScaleX=2/b.graphicsDevice.width;b.clipScaleY=-2/b.graphicsDevice.height;b.viewScaleX=1;b.viewScaleY=1;f=a.initialGpuMemory?a.initialGpuMemory:0;140>f&&(f=140);2293760<f&&(f=2293760);b.performanceData={gpuMemoryUsage:f,minBatchSize:0,maxBatchSize:0,avgBatchSize:0,batchCount:0,dataTransfers:0};b.maxGpuMemory=a.maxGpuMemory?a.maxGpuMemory:2293760;b.maxGpuMemory<f&&(b.maxGpuMemory=
f);a=4*Math.floor(f/140);b.maxVertices=4*Math.floor(b.maxGpuMemory/140);65536<b.maxVertices&&(b.maxVertices=65536);b.cpuStride=64;b.gpuStride=4;b.vertexBufferParameters={numVertices:a,attributes:[c.VERTEXFORMAT_FLOAT2,c.VERTEXFORMAT_FLOAT4,c.VERTEXFORMAT_FLOAT2],"transient":!0};b.vertexBuffer=c.createVertexBuffer(b.vertexBufferParameters);b.semantics=c.createSemantics([c.SEMANTIC_POSITION,c.SEMANTIC_COLOR,c.SEMANTIC_TEXCOORD0]);b.indexBufferParameters={numIndices:1.5*a,format:c.INDEXFORMAT_USHORT,
dynamic:!1,data:b.indexData(1.5*a)};b.indexBuffer=c.createIndexBuffer(b.indexBufferParameters);b.indexBufferParameters.data=null;b.renderTargetIndex=0;b.renderTargetCount=0;b.renderTargetTextureParameters={name:"",width:0,height:0,depth:1,format:"R8G8B8A8",cubemap:!1,mipmaps:!0,renderable:!0,dynamic:!0};b.renderTargetParams={colorTexture0:null};b.copyTechnique=d.getTechnique("copy");b.copyTechniqueParameters=c.createTechniqueParameters({inputTexture0:null,copyFlip:1,copyUVScale:new na.floatArray([1,
1])});b.quadSemantics=c.createSemantics([c.SEMANTIC_POSITION,c.SEMANTIC_TEXCOORD0]);b.quadPrimitive=c.PRIMITIVE_TRIANGLE_STRIP;b.copyVertexBufferParams={numVertices:4,attributes:[c.VERTEXFORMAT_FLOAT2,c.VERTEXFORMAT_FLOAT2],"transient":!0};b.copyVertexBuffer=c.createVertexBuffer(b.copyVertexBufferParams);b.vertexBufferData=new na.floatArray([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]);return b};na.version=7;na.defaultClearColor=[0,0,0,1];gb=na;gb.uint16Array=function(a){if(0===arguments.length)return[];
var b,c;if("number"===typeof a)c=Array(a);else{c=[];for(b=0;b<a.length;b+=1)c[b]=a[b]}return c};var Og,Pg;"undefined"!==typeof Uint16Array&&(Og=new Uint16Array(4),Pg=Object.prototype.toString.call(Og),"[object Uint16Array]"===Pg&&(gb.uint16Array=Uint16Array));gb.floatArray=function(a){if(0===arguments.length)return[];var b,c;if("number"===typeof a)c=Array(a);else{c=[];for(b=0;b<a.length;b+=1)c[b]=a[b]}return c};"undefined"!==typeof Float32Array&&(Og=new Float32Array(4),Pg=Object.prototype.toString.call(Og),
"[object Float32Array]"===Pg&&(gb.floatArray=Float32Array,gb.defaultClearColor=new Float32Array(gb.defaultClearColor)));var Y,$b=function(){};$b.create=function(a){var b=new $b;b.name=a;b.geometryType={};b.numMaterials=0;b.materialsMap={};return b};$b.prototype.hashMaterial=function(a){var a=a.texturesNames,b=[],c=0,d;for(d in a)a.hasOwnProperty(d)&&(b[c]=a[d],c+=1);return 1<c?(b.sort(),b.join(",")):b[0]};$b.prototype.prepareMaterial=function(a){var b=this.hashMaterial(a),c=this.materialsMap[b];void 0===
c&&(c=this.numMaterials,this.numMaterials+=1,this.materialsMap[b]=c);a.meta.materialIndex=c;a.effect=this};$b.prototype.add=function(a,b){this.geometryType[a]=b};$b.prototype.remove=function(a){delete this.geometryType[a]};$b.prototype.get=function(a){return this.geometryType[a]};$b.prototype.prepare=function(a){var b=this.geometryType[a.geometryType];b&&b.prepare(a)};$b.version=1;Y=$b;var Ac=function(){};Ac.create=function(){var a=new Ac;a.effects={};return a};Ac.prototype.add=function(a){this.effects[a.name]=
a};Ac.prototype.remove=function(a){delete this.effects[a]};Ac.prototype.map=function(a,b){this.effects[a]=this.effects[b]};Ac.prototype.get=function(a){a=this.effects[a];return!a?this.effects["default"]:a};Ac.version=1;var $c=function(){};$c.prototype.destroy=function(){this.vertexBufferAllocation&&(this.vertexBufferManager.free(this.vertexBufferAllocation),delete this.vertexBufferManager,delete this.vertexBufferAllocation);this.indexBufferAllocation&&(this.indexBufferManager.free(this.indexBufferAllocation),
delete this.indexBufferManager,delete this.indexBufferAllocation);delete this.vertexBuffer;delete this.indexBuffer;delete this.vertexData;delete this.indexData;delete this.semantics;delete this.first;delete this.halfExtents;delete this.reference;delete this.surfaces};$c.create=function(){var a=new $c;a.reference=Sb.create(a);a.surfaces={};a.type="rigid";return a};$c.version=1;var Ja=function(){};Ja.prototype.clone=function(){var a=Ja.create(this.geometry,this.surface,this.sharedMaterial);this.disabled&&
(a.disabled=!0);return a};Ja.prototype.isSkinned=function(){return this.geometry.skeleton?!0:!1};Ja.prototype.setNode=function(a){this.node&&this.hasCustomWorldExtents()&&this.node.renderableWorldExtentsRemoved();(this.node=a)&&this.hasCustomWorldExtents()&&this.node.renderableWorldExtentsUpdated(!1);this.worldExtentsUpdate=-1};Ja.prototype.getNode=function(){return this.node};Ja.prototype.setMaterial=function(a){a.reference.add();this.sharedMaterial.reference.remove();this.sharedMaterial=a;this.rendererInfo=
this.renderUpdate=void 0};Ja.prototype.getMaterial=function(){return this.sharedMaterial};Ja.prototype.getWorldExtents=function(){var a=this.node;a.worldUpdate>this.worldExtentsUpdate&&(this.worldExtentsUpdate=a.worldUpdate,this.updateWorldExtents(a.world));return this.worldExtents};Ja.prototype.updateWorldExtents=function(a){var b=this.center,c=this.halfExtents,d=this.worldExtents,f=a[0],g=a[1],h=a[2],e=a[3],j=a[4],r=a[5],l=a[6],m=a[7],q=a[8],p=a[9],i=a[10],a=a[11];if(b)var k=b[0],u=b[1],b=b[2],
p=p+(f*k+e*u+l*b),i=i+(g*k+j*u+m*b),a=a+(h*k+r*u+q*b);b=c[0];k=c[1];c=c[2];f=(0>f?-f:f)*b+(0>e?-e:e)*k+(0>l?-l:l)*c;g=(0>g?-g:g)*b+(0>j?-j:j)*k+(0>m?-m:m)*c;h=(0>h?-h:h)*b+(0>r?-r:r)*k+(0>q?-q:q)*c;d[0]=p-f;d[1]=i-g;d[2]=a-h;d[3]=p+f;d[4]=i+g;d[5]=a+h};Ja.prototype.addCustomWorldExtents=function(a){var b=this.worldExtentsUpdate===Ja.maxUpdateValue,c=this.worldExtents;if(!b||a[0]!==c[0]||a[1]!==c[1]||a[2]!==c[2]||a[3]!==c[3]||a[4]!==c[4]||a[5]!==c[5])this.worldExtentsUpdate=Ja.maxUpdateValue,c[0]=
a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[4]=a[4],c[5]=a[5],this.node.renderableWorldExtentsUpdated(b)};Ja.prototype.removeCustomWorldExtents=function(){this.worldExtentsUpdate=-1;this.node.renderableWorldExtentsRemoved()};Ja.prototype.getCustomWorldExtents=function(){if(this.worldExtentsUpdate===Ja.maxUpdateValue)return this.worldExtents};Ja.prototype.hasCustomWorldExtents=function(){return this.worldExtentsUpdate===Ja.maxUpdateValue};Ja.prototype.destroy=function(){this.geometry.reference&&this.geometry.reference.remove();
this.sharedMaterial.reference&&this.sharedMaterial.reference.remove();delete this.surface;delete this.geometry;delete this.sharedMaterial;delete this.techniqueParameters;delete this.halfExtents;delete this.center;delete this.worldExtentsUpdate;delete this.drawParameters;delete this.renderUpdate;delete this.rendererInfo;delete this.sorting};Ja.prototype.prepareDrawParameters=function(a){var b=this.surface;a.setVertexBuffer(0,this.geometry.vertexBuffer);a.setSemantics(0,this.semantics);a.primitive=
b.primitive;a.firstIndex=b.first;b.indexBuffer?(a.indexBuffer=b.indexBuffer,a.count=b.numIndices):a.count=b.numVertices};Ja.create=function(a,b,c){var d=new Ja,f=TurbulenzEngine.getGraphicsDevice();d.geometry=a;d.geometry.reference.add();d.geometryType=a.type;d.surface=b;d.semantics=a.semantics;d.halfExtents=a.halfExtents;d.center=a.center;d.techniqueParameters=f?f.createTechniqueParameters():null;d.sharedMaterial=c;d.sharedMaterial&&d.sharedMaterial.reference.add();d.worldExtents=new d.arrayConstructor(6);
d.worldExtentsUpdate=-1;d.worldUpdate=-1;d.node=void 0;d.renderUpdate=void 0;d.rendererInfo=void 0;return d};Ja.version=1;Ja.maxUpdateValue=Number.MAX_VALUE;Ja.prototype.arrayConstructor=Array;if("undefined"!==typeof Float32Array){var nk=new Float32Array(4);"[object Float32Array]"===Object.prototype.toString.call(nk)&&(Ja.prototype.arrayConstructor=Float32Array)}var xb=function(){};xb.create=function(a){var b=new xb;b.reference=Sb.create(b);b.techniqueParameters=a.createTechniqueParameters();b.meta=
{};b.onTextureChanged=function(a){var d=a.texture,f=b.techniqueParameters,g=b.textureInstances,h;for(h in g)g.hasOwnProperty(h)&&g[h]===a&&(f[h]=d)};return b};xb.prototype.getName=function(){return this.name};xb.prototype.setName=function(a){this.name=a};xb.prototype.clone=function(a){a=xb.create(a);this.effect&&(a.effect=this.effect);this.effectName&&(a.effectName=this.effectName);var b=this.meta,c=a.meta,d;for(d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);b=this.techniqueParameters;c=a.techniqueParameters;
for(d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);if(b=this.texturesNames)for(d in c=a.texturesNames,c||(a.texturesNames=c={}),b)b.hasOwnProperty(d)&&(c[d]=b[d]);if(b=this.textureInstances)for(d in c=a.textureInstances,c||(a.textureInstances=c={}),b)if(b.hasOwnProperty(d)){var f=b[d];c[d]=f;f.subscribeTextureChanged(a.onTextureChanged);f.reference.add()}return a};xb.prototype.loadTextures=function(a){var b=this.texturesNames,c;for(c in b)if(b.hasOwnProperty(c)){var d=b[c];a.load(d);this.setTextureInstance(c,
a.getInstance(d))}};xb.prototype.setTextureInstance=function(a,b){this.textureInstances||(this.textureInstances={});var c=this.textureInstances[a];c!==b&&(c&&c.unsubscribeTextureChanged&&c.unsubscribeTextureChanged(this.onTextureChanged),this.textureInstances[a]=b,this.techniqueParameters[a]=b.texture,b.subscribeTextureChanged(this.onTextureChanged),b.reference.add())};xb.prototype.destroy=function(){delete this.techniqueParameters;var a,b=this.textureInstances,c;for(c in b)b.hasOwnProperty(c)&&(a=
b[c],a.unsubscribeTextureChanged(this.onTextureChanged),a.reference.remove());delete this.textureInstances;delete this.texturesNames};xb.version=1;var ia=function(){};ia.prototype.updateShader=function(a){var b=this.shadowMaps;b&&b.updateShader(a)};ia.prototype.lightFindVisibleShadowRenderables=function(a,b,c){var d,f,g,h,e,j,r,l,m,q=this.shadowMaps;d=b.node;l=b.light;j=b.getWorldExtents();r=b.frameVisible;var p=this.overlapQueryRenderables,i=0;p.length=0;var k=this.lightVisibleRenderables,u=0;f=
b.overlappingRenderables;if(d.dynamic||b.staticNodesChangeCounter!==c.staticNodesChangeCounter){i=this.mathDevice;d=d.world;d=(g=l.origin)?i.m43TransformPoint(d,g,b.lightOrigin):i.m43Pos(d,b.lightOrigin);b.lightOrigin=d;f||(f=[],b.overlappingRenderables=f);g=0;b.staticNodesChangeCounter=c.staticNodesChangeCounter;c.findStaticOverlappingRenderables(d,j,p);i=p.length;for(h=0;h<i;h+=1)m=p[h],e=m.sharedMaterial.meta,!e.noshadow&&(!e.decal&&!e.far)&&(f[g]=m,g+=1,m.getWorldExtents(),m.frameVisible===r&&
(!m.disabled&&!m.node.disabled)&&(k[u]=m,u+=1));p.length=0;f.length=g;b.numStaticOverlappingRenderables=g}else{d=b.lightOrigin;g=b.numStaticOverlappingRenderables;for(h=0;h<g;h+=1)m=f[h],m.frameVisible===r&&(!m.disabled&&!m.node.disabled)&&(k[u]=m,u+=1)}c.findDynamicOverlappingRenderables(d,j,p);i=p.length;for(h=0;h<i;h+=1)m=p[h],e=m.sharedMaterial.meta,!e.noshadow&&(!e.decal&&!e.far)&&(f[g]=m,g+=1,m.frameVisible===r&&(!m.disabled&&!m.node.disabled)&&(k[u]=m,u+=1));b.numLightVisibleRenderables=u;
if(0===u)return!1;q&&l.shadows&&q.findVisibleRenderables(b)&&(this.usingShadows=!0);c=b.techniqueParameters;c||(c=a.createTechniqueParameters(l.techniqueParameters),c.lightViewInverseTransposeFalloff=a.createTechniqueParameterBuffer({numFloats:16}),b.techniqueParameters=c,q&&!b.techniqueParameters.shadowSize_depthTweak_blurSize_fadeScale&&(b.techniqueParameters.shadowSize_depthTweak_blurSize_fadeScale=this.mathDevice.v4Build(0,0.0035,1.5,1)));return!0};ia.prototype.sortRenderables=function(a,b){var c,
d=this.passes,f=ia.numPasses;for(c=0;c<f;c+=1)d[c].length=0;this.renderTargetChangeCount+=1;var g,h,e,j;c=b.getCurrentVisibleRenderables();f=c.length;if(0<f){var r,l,m=ia.passIndex.transparent,q=0;do{r=c[q];r.renderUpdate||(g=r.sharedMaterial.effect,g.prepare&&g.prepare(r));r.renderUpdate(a,this.usingShadows,this.renderTargetChangeCount);g=this.usingShadows?r.shadowDrawParameters:r.drawParameters;h=g.length;for(j=0;j<h;j+=1)e=g[j],l=e.userData.passIndex,l===m&&(e.sortKey=r.sharedMaterial.meta.far?
1E38:r.distance),l=d[l],l[l.length]=e;q+=1}while(q<f)}};ia.prototype.update=function(a,b,c,d){c.updateVisibleNodes(b);this.updateLights(c);this.sortRenderables(b,c);a=b.matrix;a[9]!==this.eyePosition[0]||a[10]!==this.eyePosition[1]||a[11]!==this.eyePosition[2]?(this.eyePositionUpdated=!0,this.eyePosition[0]=a[9],this.eyePosition[1]=a[10],this.eyePosition[2]=a[11]):this.eyePositionUpdated=!1;this.globalCameraMatrix=b.matrix;this.globalTechniqueParameters.viewProjection=b.viewProjectionMatrix;this.globalTechniqueParameters.time=
d;this.globalTechniqueParameters.view=b.viewMatrix;this.camera=b;this.scene=c};ia.prototype.drawShadowMaps=function(a,b,c,d){if(a=c.length){var f,g,h=this.globalCameraMatrix;g=0;do b=c[g],this.renderTargetChangeCount+=1,this.lightFindVisibleShadowRenderables(this.graphicsDevice,b,this.scene),b.numLightVisibleRenderables&&(f=b.light,f.shadows&&(!f.ambient&&0<this.mathDevice.v3Length(f.color))&&(f=0<b.shadowQuality?1:1E10,d.drawShadowMap(h,f,b),0!==b.slot?(b.techniqueParameters.shadowProjection2=b.techniqueParameters.shadowProjection,
b.techniqueParameters.shadowDepth2=b.techniqueParameters.shadowDepth,b.techniqueParameters.shadowSize_depthTweak_blurSize_fadeScale2||(b.techniqueParameters.shadowSize_depthTweak_blurSize_fadeScale2=b.techniqueParameters.shadowSize_depthTweak_blurSize_fadeScale),b.techniqueParameters.shadowSize_depthTweak_blurSize_fadeScale2[0]=b.techniqueParameters.shadowSize,b.techniqueParameters.shadowMapTexture2=b.techniqueParameters.shadowMapTexture,delete b.techniqueParameters.shadowProjection,delete b.techniqueParameters.shadowDepth,
delete b.techniqueParameters.shadowSize_depthTweak_blurSize_fadeScale,delete b.techniqueParameters.shadowMapTexture):b.techniqueParameters.shadowSize_depthTweak_blurSize_fadeScale[0]=b.techniqueParameters.shadowSize)),g+=1;while(g<a)}};ia.prototype.destroyBuffers=function(){this.finalRenderTarget&&(this.finalRenderTarget.destroy(),this.finalRenderTarget=null);this.finalTexture&&(this.finalTexture.destroy(),this.finalTexture=null);this.depthBuffer&&(this.depthBuffer.destroy(),this.depthBuffer=null)};
ia.prototype.updateBuffers=function(a,b,c){if(this.bufferWidth===b&&this.bufferHeight===c)return!0;this.destroyBuffers();this.finalTexture=a.createTexture({name:"final",width:b,height:c,format:"R8G8B8A8",mipmaps:!1,renderable:!0});this.depthBuffer=a.createRenderBuffer({width:b,height:c,format:"D24S8"});if(this.finalTexture&&this.depthBuffer&&(this.finalRenderTarget=a.createRenderTarget({colorTexture0:this.finalTexture,depthBuffer:this.depthBuffer})))return this.bufferWidth=b,this.bufferHeight=c,!0;
this.bufferHeight=this.bufferWidth=0;this.destroyBuffers();return!1};ia.prototype.draw=function(a,b,c,d,f,g){var h=this.globalTechniqueParameters,e=[h];this.lightTechniqueParameters.length&&(e=e.concat(this.lightTechniqueParameters));var j=this.shadowMaps;j&&this.usingShadows&&(j.lowIndex=0,j.highIndex=0,this.drawShadowMaps(a,h,this.scene.getCurrentVisibleLights(),j));this.renderTargetChangeCount+=1;h=g?a.beginRenderTarget(this.finalRenderTarget):!1;a.clear(b,1,0);this.wireframe?(this.scene.drawWireframe(a,
this.shaderManager,this.camera,this.wireframeInfo),c&&c()):(a.drawArray(this.passes[ia.passIndex.opaque],e,-1),a.drawArray(this.passes[ia.passIndex.decal],e,-1),c&&c(),a.drawArray(this.passes[ia.passIndex.transparent],e,1));d&&d();f&&f();h&&(a.endRenderTarget(),g(a,this.finalTexture),a.setStream(this.quadVertexBuffer,this.quadSemantics),a.draw(this.quadPrimitive,4));this.lightPositionUpdated=!1};ia.prototype.lightSort=function(a,b){return b.sortKey-a.sortKey};ia.prototype.updateLights=function(a){var b,
c=0,d,f=this.mathDevice,g=this.scratchpad.v3Temp,h=this.ambientColor,e;f.v3BuildZero(h);this.usingShadows=!1;this.lightTechniqueParameters.length=0;for(var j=a.getGlobalLights().concat(a.getCurrentVisibleLights()),a=0;a<ia.NUM_LIGHTS;a+=1)this.lights[c+4]=0,this.lights[c+5]=0,this.lights[c+6]=0,c+=ia.SIZEOF_LIGHT;for(a=0;a<j.length;a+=1)b=j[a],c=b.disabled,d=b.node,e=b.slot,d&&(c&=d.disabled,b=b.light),!c&&0<f.v3LengthSq(b.color)&&(b.ambient?f.v3Add(h,b.color,h):(c=e*ia.SIZEOF_LIGHT,b.directional?
(d?(g=f.m43TransformVector(d.getWorldTransform(),b.direction,g),this.lights[c+0]=g[0],this.lights[c+1]=g[1],this.lights[c+2]=g[2]):(this.lights[c+0]=b.direction[0],this.lights[c+1]=b.direction[1],this.lights[c+2]=b.direction[2]),this.lights[c+3]=0,this.lights[c+4]=b.color[0],this.lights[c+5]=b.color[1],this.lights[c+6]=b.color[2],this.lights[c+7]=ia.LIGHT_TYPE_DIRECTION):b.point&&(d?(g=f.m43Pos(d.getWorldTransform(),g),this.lights[c+0]=g[0],this.lights[c+1]=g[1],this.lights[c+2]=g[2]):(this.lights[c+
0]=0,this.lights[c+1]=0,this.lights[c+2]=0),this.lights[c+3]=b.radius,this.lights[c+4]=b.color[0],this.lights[c+5]=b.color[1],this.lights[c+6]=b.color[2],this.lights[c+7]=ia.LIGHT_TYPE_POINT),b.shadows&&(this.usingShadows=!0),j[a].techniqueParameters&&this.lightTechniqueParameters.push(j[a].techniqueParameters)))};ia.prototype.setDefaultTexture=function(a){this.globalTechniqueParameters.diffuse=a};ia.prototype.setWireframe=function(a,b){this.wireframeInfo=b;this.wireframe=a};ia.prototype.getDefaultSkinBufferSize=
function(){return this.defaultSkinBufferSize};ia.prototype.destroy=function(){delete this.globalTechniqueParameters;delete this.lightPosition;delete this.eyePosition;delete this.passes;delete this.quadPrimitive;delete this.quadSemantics;this.quadVertexBuffer&&(this.quadVertexBuffer.destroy(),delete this.quadVertexBuffer)};ia.defaultPrepareFn=function(a){var b=TurbulenzEngine.getGraphicsDevice().createDrawParameters();b.userData={};a.drawParameters=[b];a.prepareDrawParameters(b);a.rendererInfo={};
var c=a.sharedMaterial,d=a.techniqueParameters;!c.techniqueParameters.uvTransform&&!d.uvTransform&&(d.uvTransform=ia.identityUVTransform);b.technique=this.technique;b.setTechniqueParameters(0,c.techniqueParameters);b.setTechniqueParameters(1,d);b.userData.passIndex=c.meta.decal?ia.passIndex.decal:c.meta.transparent?ia.passIndex.transparent:ia.passIndex.opaque;var f=a.node;if(!f.rendererInfo){var g=TurbulenzEngine.getMathDevice();f.rendererInfo={id:ia.nextRenderinfoID,frameVisible:-1,worldUpdate:-1,
stateChange:-1,world:g.m43BuildIdentity(),worldInverseTranspose:g.m33BuildIdentity()};ia.nextRenderinfoID+=1}f=f.rendererInfo;d.world=f.world;d.worldInverseTranspose=f.worldInverseTranspose;(f=a.skinController)?(d.skinBones=f.output,void 0===f.index&&(f.index=ia.nextSkinID,ia.nextSkinID+=1),b.sortKey=-$a(this.techniqueIndex,f.index,c.meta.materialIndex)):b.sortKey=$a(this.techniqueIndex,c.meta.materialIndex,a.geometry.vertexBuffer.id);a.renderUpdate=this.update};ia.defaultPrepareInstancedFn=function(a){ia.defaultPrepareFn(a)};
ia.create=function(a,b,c,d,f){var g=new ia;g.mathDevice=b;g.shaderManager=c;g.graphicsDevice=a;g.lightPositionUpdated=!0;g.lightPosition=b.v3Build(1E3,1E3,0);g.eyePositionUpdated=!0;g.eyePosition=b.v3BuildZero();g.lights=new Float32Array(ia.SIZEOF_LIGHT*ia.NUM_LIGHTS);g.ambientColor=b.v3Build(0.2,0.2,0.3);g.v4White=b.v4BuildOne();g.globalTechniqueParameters=a.createTechniqueParameters({ambientColor:g.ambientColor,viewProjection:b.m44BuildIdentity(),eyePosition:g.eyePosition,lights:g.lights,time:0});
g.lightTechniqueParameters=[];g.overlapQueryRenderables=[];g.lightVisibleRenderables=[];g.passes=[[],[],[]];g.renderTargetChangeCount=0;g.scratchpad={};g.scratchpad.v3Temp=b.v3BuildZero();g.quadPrimitive=a.PRIMITIVE_TRIANGLE_STRIP;g.quadSemantics=a.createSemantics(["POSITION","TEXCOORD0"]);g.quadVertexBuffer=a.createVertexBuffer({numVertices:4,attributes:["FLOAT2","FLOAT2"],dynamic:!1,data:[-1,1,0,1,1,1,1,1,-1,-1,0,0,1,-1,1,0]});c.load("shaders/nlightrendering.cgfx",function(a){a=a.getParameter("skinBones");
g.defaultSkinBufferSize=a.rows*a.columns});c.load("shaders/debug.cgfx");var h=function(a,c){if(c.worldUpdate!==a.worldUpdate){var d=a.world;c.worldUpdate=a.worldUpdate;b.m43Copy(d,c.world);b.m33InverseTranspose(d,c.worldInverseTranspose)}},e=function(a){var b=this.node,c=b.rendererInfo;c.frameVisible!==b.frameVisible&&(c.frameVisible=b.frameVisible,h(b,c,a))},j=function(a){var b=this.node,c=b.rendererInfo;c.frameVisible!==b.frameVisible&&(c.frameVisible=b.frameVisible,h(b,c,a));if(a=this.skinController)this.techniqueParameters.skinBones=
a.output,a.update()},r=function(a){var c=this.node.world,d=this.techniqueParameters;d.worldViewProjection=b.m43MulM44(c,a.viewProjectionMatrix,d.worldViewProjection);d.worldInverseTranspose=b.m33InverseTranspose(c,d.worldInverseTranspose)},l=function(a){var c=this.node.world,d=this.techniqueParameters;d.worldViewProjection=b.m43MulM44(c,a.viewProjectionMatrix,d.worldViewProjection);d.worldInverseTranspose=b.m33InverseTranspose(c,d.worldInverseTranspose);if(a=this.skinController)this.techniqueParameters.skinBones=
a.output,a.update()},m=function(d){ia.defaultPrepareFn.call(this,d);var f=d.sharedMaterial.techniqueParameters,h=d.sharedMaterial.meta,e=f.diffuse;void 0===e?f.materialColor||(f.materialColor=g.v4White):4===e.length&&(f.materialColor=b.v4Build.apply(b,e),e=f.diffuse_map,f.diffuse=e);e||(e=c.get("shaders/nlightrendering.cgfx"),d.drawParameters[0].technique="skinned"===d.geometryType?e.getTechnique("flat_skinned"):e.getTechnique("flat"));f.materialColor||(f.materialColor=g.v4White);if(g.shadowMaps){if(this.shadowMappingUpdate&&
this.shadowMappingTechnique&&!h.noshadows){e=a.createDrawParameters();e.userData={};d.prepareDrawParameters(e);d.shadowMappingDrawParameters=[e];d.rendererInfo.shadowMappingUpdate=this.shadowMappingUpdate;e.technique=this.shadowMappingTechnique;e.sortKey=$a(this.shadowMappingTechniqueIndex,d.geometry.vertexBuffer.id);var n=a.createTechniqueParameters();d.shadowTechniqueParameters=n;e.setTechniqueParameters(0,n);h.transparent&&(n.diffuse=f.diffuse,n.uvTransform=f.uvTransform)}else d.shadowDrawParameters=
d.drawParameters,h.noshadows=!0;this.shadowTechnique?(e=a.createDrawParameters(),e.userData=d.drawParameters[0].userData,d.prepareDrawParameters(e),e.technique=this.shadowTechnique,e.sortKey=$a(this.shadowTechniqueIndex,h.materialIndex,d.geometry.vertexBuffer.id),e.setTechniqueParameters(0,f),e.setTechniqueParameters(1,d.techniqueParameters),d.shadowDrawParameters=[e]):d.shadowDrawParameters=d.drawParameters}},q=function(a){ia.defaultPrepareFn.call(this,a);var c=a.sharedMaterial.techniqueParameters,
d=c.diffuse;void 0===d?c.materialColor||(c.materialColor=g.v4White):4===d.length&&(c.materialColor=b.v4Build.apply(b,d));c.materialColor||(c.materialColor=g.v4White);g.shadowMaps&&(a.shadowDrawParameters=a.drawParameters)},p=function(a){var b=this;a.load(this.shaderName,function(a){b.shader=a;b.technique=a.getTechnique(b.techniqueName);b.techniqueIndex=b.technique.id});g.shadowMaps&&(this.shadowMappingTechniqueName&&a.load(this.shadowMappingShaderName,function(a){b.shadowMappingShader=a;b.shadowMappingTechnique=
a.getTechnique(b.shadowMappingTechniqueName);b.shadowMappingTechniqueIndex=b.shadowMappingTechnique.id}),this.shadowTechniqueName&&a.load(this.shadowShaderName,function(a){b.shadowShader=a;b.shadowTechnique=a.getTechnique(b.shadowTechniqueName);b.shadowTechniqueIndex=b.shadowTechnique.id}))},i,k;f&&f.shadowRendering&&(k=Ci.create(a,b,c,d,f.shadowSizeLow,f.shadowSizeHigh),g.shadowMaps=k,i=k.update,k=k.skinnedUpdate,g.defaultShadowMappingUpdateFn=i,g.defaultShadowMappingSkinnedUpdateFn=k);g.defaultPrepareFn=
m;g.defaultUpdateFn=e;g.defaultSkinnedUpdateFn=j;g.defaultInstancedUpdateFn=function(a,c,d){var f=this.node,a=f.rendererInfo;if(a.frameVisible!==f.frameVisible&&(a.stateChange+=f.frameVisible-a.frameVisible,a.frameVisible=f.frameVisible,a.worldUpdate!==f.worldUpdate)){var g=f.world;a.worldUpdate=f.worldUpdate;b.m43Copy(g,a.world);b.m33InverseTranspose(g,a.worldInverseTranspose);a.stateChange+=1}f=a.stateChange>this.stateChange+1;this.stateChange=a.stateChange;g=this.geometry.instance;if(g.update(this,
c,d)||f)c=g.techniqueStateStride*this.instanceSlot,d=this.objectState,d.setData(a.world,c,12),d.setData(a.worldInverseTranspose,c+12,9)};g.defaultShadowMappingInstancedUpdateFn=function(){var a=this.node,b=this.geometry.instance;b.updateShadowMapping(this,g.renderTargetChangeCount);this.shadowMappingObjectState.setData(a.world,b.shadowMappingTechniqueStateStride*this.shadowMappingInstanceSlot,12)};var u,f=Y.create("constant");d.add(f);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"flat",
update:e,loadTechniques:p};u.loadTechniques(c);f.add("rigid",u);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"flat_skinned",update:j,loadTechniques:p};u.loadTechniques(c);f.add("skinned",u);f=Y.create("lambert");d.add(f);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"lambert",update:e,loadTechniques:p};u.loadTechniques(c);f.add("rigid",u);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"lambert_skinned",update:j,loadTechniques:p};
u.loadTechniques(c);f.add("skinned",u);f=Y.create("blinn");d.add(f);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"blinn",update:e,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,shadowShaderName:"shaders/nlightrendering.cgfx",shadowTechniqueName:"blinn_shadows",loadTechniques:p};u.loadTechniques(c);f.add("rigid",u);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"blinn_skinned",update:j,shadowMappingShaderName:"shaders/shadowmapping.cgfx",
shadowMappingTechniqueName:"skinned",shadowMappingUpdate:k,shadowShaderName:"shaders/nlightrendering.cgfx",shadowTechniqueName:"blinn_skinned_shadows",loadTechniques:p};u.loadTechniques(c);f.add("skinned",u);d.map("default","blinn");f=Y.create("blinn_nocull");d.add(f);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"blinn_nocull",update:e,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,shadowShaderName:"shaders/nlightrendering.cgfx",
shadowTechniqueName:"blinn_shadows_nocull",loadTechniques:p};u.loadTechniques(c);f.add("rigid",u);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"blinn_skinned_nocull",update:j,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",shadowMappingUpdate:i,shadowShaderName:"shaders/nlightrendering.cgfx",shadowTechniqueName:"blinn_skinned_shadows_nocull",loadTechniques:p};u.loadTechniques(c);f.add("skinned",u);f=Y.create("phong");d.add(f);u={prepare:m,
shaderName:"shaders/nlightrendering.cgfx",techniqueName:"phong",update:e,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,shadowShaderName:"shaders/nlightrendering.cgfx",shadowTechniqueName:"phong_shadows",loadTechniques:p};u.loadTechniques(c);f.add("rigid",u);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"phong_skinned",update:j,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",
shadowMappingUpdate:i,shadowShaderName:"shaders/nlightrendering.cgfx",shadowTechniqueName:"phong_skinned_shadows",loadTechniques:p};u.loadTechniques(c);f.add("skinned",u);f=Y.create("debug_lines_constant");d.add(f);u={prepare:function(a){ia.defaultPrepareFn.call(this,a);a.techniqueParameters.constantColor=a.sharedMaterial.meta.constantColor},shaderName:"shaders/debug.cgfx",techniqueName:"debug_lines_constant",update:r,loadTechniques:p};u.loadTechniques(c);f.add("rigid",u);f=Y.create("debug_normals");
d.add(f);u={prepare:ia.defaultPrepareFn,shaderName:"shaders/debug.cgfx",techniqueName:"debug_normals",update:r,loadTechniques:p};u.loadTechniques(c);f.add("rigid",u);u={prepare:ia.defaultPrepareFn,shaderName:"shaders/debug.cgfx",techniqueName:"debug_normals_skinned",update:l,loadTechniques:p};u.loadTechniques(c);f.add("skinned",u);f=Y.create("debug_tangents");d.add(f);u={prepare:ia.defaultPrepareFn,shaderName:"shaders/debug.cgfx",techniqueName:"debug_tangents",update:r,loadTechniques:p};u.loadTechniques(c);
f.add("rigid",u);u={prepare:ia.defaultPrepareFn,shaderName:"shaders/debug.cgfx",techniqueName:"debug_tangents_skinned",update:l,loadTechniques:p};u.loadTechniques(c);f.add("skinned",u);f=Y.create("debug_binormals");d.add(f);u={prepare:ia.defaultPrepareFn,shaderName:"shaders/debug.cgfx",techniqueName:"debug_binormals",update:r,loadTechniques:p};u.loadTechniques(c);f.add("rigid",u);u={prepare:ia.defaultPrepareFn,shaderName:"shaders/debug.cgfx",techniqueName:"debug_binormals_skinned",update:l,loadTechniques:p};
u.loadTechniques(c);f.add("skinned",u);f=Y.create("add");d.add(f);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"add",update:e,loadTechniques:p};u.loadTechniques(c);f.add("rigid",u);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"add_skinned",update:j,loadTechniques:p};u.loadTechniques(c);f.add("skinned",u);f=Y.create("add_particle");d.add(f);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"add_particle",update:e,loadTechniques:p};
u.loadTechniques(c);f.add("rigid",u);f=Y.create("blend");d.add(f);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"blend",update:e,loadTechniques:p};u.loadTechniques(c);f.add("rigid",u);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"blend_skinned",update:j,loadTechniques:p};u.loadTechniques(c);f.add("skinned",u);f=Y.create("blend_particle");d.add(f);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"blend_particle",update:e,loadTechniques:p};
u.loadTechniques(c);f.add("rigid",u);f=Y.create("translucent");d.add(f);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"translucent",update:e,loadTechniques:p};u.loadTechniques(c);f.add("rigid",u);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"translucent_skinned",update:j,loadTechniques:p};u.loadTechniques(c);f.add("skinned",u);f=Y.create("translucent_particle");d.add(f);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"translucent_particle",
update:e,loadTechniques:p};u.loadTechniques(c);f.add("rigid",u);f=Y.create("filter");d.add(f);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"filter",update:e,loadTechniques:p};u.loadTechniques(c);f.add("rigid",u);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"filter_skinned",update:j,loadTechniques:p};u.loadTechniques(c);f.add("skinned",u);f=Y.create("invfilter");d.add(f);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"invfilter",
update:e,loadTechniques:p};u.loadTechniques(c);f.add("rigid",u);f=Y.create("invfilter_particle");d.add(f);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"invfilter_particle",update:e,loadTechniques:p};u.loadTechniques(c);f.add("rigid",u);f=Y.create("modulate2");d.add(f);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"modulate2",update:e,loadTechniques:p};u.loadTechniques(c);f.add("rigid",u);u={prepare:m,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"modulate2_skinned",
update:j,loadTechniques:p};u.loadTechniques(c);f.add("skinned",u);f=Y.create("glowmap");d.add(f);u={prepare:q,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"glowmap",update:e,loadTechniques:p};u.loadTechniques(c);f.add("rigid",u);u={prepare:q,shaderName:"shaders/nlightrendering.cgfx",techniqueName:"glowmap_skinned",update:j,loadTechniques:p};u.loadTechniques(c);f.add("skinned",u);return g};ia.version=1;ia.numPasses=3;ia.passIndex={opaque:0,decal:1,transparent:2};ia.nextRenderinfoID=0;ia.nextSkinID=
0;ia.NUM_POLYMORPHIC_LIGHTS=0;ia.NUM_DIRECTION_LIGHTS=2;ia.NUM_POINT_LIGHTS=1;ia.NUM_LIGHTS=ia.NUM_POLYMORPHIC_LIGHTS+ia.NUM_DIRECTION_LIGHTS+ia.NUM_POINT_LIGHTS;ia.SIZEOF_LIGHT=8;ia.LIGHT_TYPE_DIRECTION=0;ia.LIGHT_TYPE_POINT=1;ia.SHADOW_LIGHT_INDEX=0;ia.identityUVTransform=new Float32Array([1,0,0,1,0,0]);var Bc=function(a){var b=Bc,c=b.techniquesIndexMap[a];void 0===c&&(c=b.numTechniques,b.techniquesIndexMap[a]=c,b.numTechniques+=1);return c};Bc.techniquesIndexMap={};Bc.numTechniques=0;var sb=function(){};
sb.prototype.clear=function(){this.nodesMap={};this.referencesPending={};this.numReferencesPending=0;this.animationsPending={}};sb.prototype.endLoading=function(a){this.referencesPending={};this.animationsPending={};a&&a(this.data)};sb.prototype.resolveShapes=function(a){var b=a.shapesNamePrefix,c=a.shapesNamePrefix,a=a.data.geometries,d=this.data.geometries;d||(d={},this.data.geometries=d);for(var f in a)if(a.hasOwnProperty(f)){var g=a[f],h=b?b+"-"+f:f,e=g.skeleton;if(e){var j=d,r=h,l={},m=void 0;
for(m in g)g.hasOwnProperty(m)&&(l[m]=g[m]);j[r]=l;d[h].skeleton=c?c+"-"+e:e}else d[h]=g}};sb.prototype.resolveSkeletons=function(a){var b=a.shapesNamePrefix,a=a.data.skeletons,c=this.data.skeletons;c||(c={},this.data.skeletons=c);for(var d in a)a.hasOwnProperty(d)&&(c[b?b+"-"+d:d]=a[d])};sb.prototype.resolveAnimations=function(a){var b=a.data.animations;if(b){var c=this,d=c.data.animations;d||(d={},c.data.animations=d);var f=function(b){if(b){var b=JSON.parse(b).animations,f;for(f in b)b.hasOwnProperty(f)&&
(d[f]=b[f])}c.numReferencesPending-=1;0>=c.numReferencesPending&&c.endLoading(a.onload)},g=a.request?a:TurbulenzEngine,h;for(h in b)if(b.hasOwnProperty(h)){var e=b[h].reference;e?this.animationsPending[h]||(this.animationsPending[h]=!0,this.numReferencesPending+=1,delete b[h].reference,a.requestHandler.request({src:e,requestOwner:g,onload:f})):d[h]=b[h]}}};sb.prototype.resolveNodes=function(a){var b=this.referencesPending,c=0,d=this.nodesMap,f=this,g=a.nodesNamePrefix,h=a.shapesNamePrefix,e=a.request?
a:TurbulenzEngine,j=function(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b},r=function(g,l,m){var q=j(g),l=m?m+"/"+l:l,p=q.reference;if(p){if(-1===p.indexOf("#")){var i=b[p];if(!i||0===i.length||!q.inplace){c+=1;var k=j(a);k.append=!0;q.inplace?(k.nodesNamePrefix=m,k.shapesNamePrefix=null,k.parentNode=null):(k.nodesNamePrefix=l,k.shapesNamePrefix=p,k.parentNode=q);q.skin&&(k.skin=q.skin);!i||0===i.length?(i=[k],b[p]=i,a.requestHandler.request({src:p,requestOwner:e,onload:function(a){for(var b=
i.length,a=a?JSON.parse(a):{},c,d=0;d<b;d+=1)c=i[d],c.data=a,c.isReference=!0,f.resolve(c);i.length=0}})):i.push(k)}}delete q.reference;delete q.inplace}m=q.geometryinstances;if(h&&m){q.geometryinstances={};for(var s in m)m.hasOwnProperty(s)&&(q.geometryinstances[s]=j(m[s]),p=q.geometryinstances[s],p.geometry=h+"-"+p.geometry)}if(g=g.nodes){q.nodes={};for(var u in g)g.hasOwnProperty(u)&&(s=l+"/"+u,d[s]||(q.nodes[u]=r(g[u],u,l),d[s]=q.nodes[u]))}return q},l=a.data.nodes,m=a.parentNode,q;for(q in l)if(l.hasOwnProperty(q)&&
l[q]){var p=r(l[q],q,g),i=g?g+"/"+q:q,k=d[i];if(k){if((i=k.matrix)&&p.matrix)k.matrix=w.m43Mul(p.matrix,i),i=null;if((i=k.nodes)&&p.nodes)for(var u in p.nodes)p.nodes.hasOwnProperty(u)&&(i[u]=p.nodes[u]);else p.nodes&&(k.nodes=p.nodes);for(var z in p)p.hasOwnProperty(z)&&(k[z]=p[z]);p=k}else a.isReference&&m?(m.nodes||(m.nodes={}),m.nodes[q]=p):this.data.nodes[q]=p,d[i]=p}this.numReferencesPending+=c};sb.prototype.resolvePhysicsNodes=function(a){function b(a){var b=function(){};b.prototype=a;return new b}
var c=a.data,d=a.nodesNamePrefix,a=a.shapesNamePrefix,f=c.physicsmodels,g=this.data.physicsmodels;g||(g={},this.data.physicsmodels=g);for(var h in f)if(f.hasOwnProperty(h)){var e=f[h];if(a){var j=a?a+"-"+h:h,e=b(e);g[j]=e;if(j=e.geometry)e.geometry=a?a+"-"+j:j}else g[h]=e}c=c.physicsnodes;h=this.data.physicsnodes;h||(h={},this.data.physicsnodes=h);for(var r in c)c.hasOwnProperty(r)&&(f=c[r],d||a?(g=f.target,g=d?d+"/"+g:g,j=b(f),j.target=g,j.body=a?a+"-"+f.body:f.body,h[d?d+"/"+r:r]=j):h[r]=f)};sb.prototype.resolveAreas=
function(a){var b=a.data.areas;if(b){var c=b.length;if(!(0>=c)){var d=this.data.areas;d||(d=[],this.data.areas=d);for(var a=a.nodesNamePrefix,f=0;f<c;f+=1){var g=b[f];a&&(g.target=a+"/"+g.target);d.push(g)}}}};sb.prototype.resolve=function(a){a.append||(this.data={nodes:{}});var b=a.data,c;for(c in b)if("nodes"!==c&&("skeletons"!==c&&"geometries"!==c&&"animations"!==c&&"areas"!==c&&"physicsnodes"!==c&&"physicsmodels"!==c)&&b.hasOwnProperty(c)){var d=b[c],f=this.data[c];if(f)for(var g in d)d.hasOwnProperty(g)&&
!f[g]&&(f[g]=d[g]);else this.data[c]=d}this.resolveShapes(a);this.resolveSkeletons(a);this.resolveAnimations(a);this.resolveNodes(a);this.resolvePhysicsNodes(a);this.resolveAreas(a);a.isReference&&(this.numReferencesPending-=1);0>=this.numReferencesPending&&this.endLoading(a.onload)};sb.prototype.load=function(a,b){var c=this;b.requestHandler.request({src:a,requestOwner:b.request?b:TurbulenzEngine,onload:function(a){var f={};a&&(f=JSON.parse(a));b.data=f;b.append=!1;c.resolve(b)}})};sb.create=function(){var a=
new sb;a.clear();a.skeletonNames={};return a};sb.version=1;var W=function(a,b,c){this.md=a;this.staticSpatialMap=b||xa.create(!0);this.dynamicSpatialMap=c||xa.create();this.clear();var d=this;this.onGeometryDestroyed=function(a){a.reference.unsubscribeDestroyed(d.onGeometryDestroyed);delete d.shapes[a.name]};this.onMaterialDestroyed=function(a){a.reference.unsubscribeDestroyed(d.onMaterialDestroyed);delete d.materials[a.name]}};W.prototype.findNode=function(a){var b=this.rootNodesMap[a];if(b)return b;
for(var a=a.split("/"),b=this.rootNodesMap[a[0]],c=1;b&&c<a.length;c+=1)b=b.findChild(a[c]);return b};W.prototype.addRootNode=function(a){var b=a.name;a.scene=this;a.worldExtentsUpdate=!0;this.rootNodes.push(a);this.rootNodesMap[b]=a;this.addRootNodeToUpdate(a,b)};W.prototype.removeRootNode=function(a){var b=a.name;a.removedFromScene(this);var c=this.rootNodes,d=c.indexOf(a);if(-1!==d){var f=c.length-1;d<f&&(c[d]=c[f]);c.length=f}delete this.rootNodesMap[b];if(this.dirtyRoots[b]===a){delete this.dirtyRoots[b];
b=this.nodesToUpdate;c=this.numNodesToUpdate;for(d=0;d<c;d+=1)if(b[d]===a){c-=1;d<c&&(b[d]=b[c]);b[c]=null;this.numNodesToUpdate=c;break}}delete a.scene};W.prototype.addLight=function(a){this.lights[a.name]=a;a.isGlobal()&&this.globalLights.push(a)};W.prototype.removeLight=function(a){delete this.lights[a.name];if(a.isGlobal())for(var b=this.globalLights,c=b.length,d=0;d<c;d+=1)if(a===b[d]){b.splice(d,1);break}};W.prototype.getLight=function(a){return this.lights[a]};W.prototype.getGlobalLights=function(){return this.globalLights};
W.prototype.calculateNumNodes=function(a){for(var b=a.length,c=b,d=0;d<b;d+=1){var f=a[d].children;f&&(c+=this.calculateNumNodes(f))}return c};W.prototype.buildPortalPlanes=function(a,b,c,d,f,g){var h=a.length,e=g.length,j=0,r,l,m,q,p,i=[];i.length=h;l=0;do i[l]=[],l+=1;while(l<h);r=0;do{p=g[r];var k=p[0],u=p[1],z=p[2],B=p[3];l=m=0;do q=a[l],k*q[0]+u*q[1]+z*q[2]>=B?m+=1:i[l][r]=!0,l+=1;while(l<h);if(0===m)return b.length=0,!1;m<h&&(b[j]=p,j+=1);r+=1}while(r<e);g=0===j;e=[];e.length=h;l=0;do q=a[l],
e[l]=[q[0]-c,q[1]-d,q[2]-f],l+=1;while(l<h);a=Math.sqrt;l=0;do{m=l+1;m>=h&&(m=0);q=i[l];p=i[m];k=q.length<p.length?q.length:p.length;for(r=0;r<k&&(!q[r]||!p[r]);r+=1);if(!(r<k)){q=e[l];r=q[0];p=q[1];k=q[2];q=e[m];m=q[0];u=q[1];z=q[2];q=p*z-k*u;k=k*m-r*z;r=r*u-p*m;p=q*q+k*k+r*r;if(0===p)return b.length=0,!1;p=1/a(p);q*=p;k*=p;r*=p;b[j]=[q,k,r,q*c+k*d+r*f];j+=1}l+=1}while(l<h);return g};W.prototype.findAreaIndex=function(a,b,c,d){var f=a.length,g=0,h;do if(g=a[g],h=g.plane,g=h[0]*b+h[1]*c+h[2]*d<h[3]?
g.neg:g.pos,0>=g)return-(g+1);while(g<f);return-1};W.prototype.findAreaIndicesAABB=function(a,b,c,d,f,g,h){var e=a.length,j=[],r=[],l=[0],m=1,q,i,k;do{m-=1;q=l[m];do{i=a[q];k=i.plane;q=k[0];var D=k[1],u=k[2];k=k[3];if(q*(0>q?b:f)+D*(0>D?c:g)+u*(0>u?d:h)<k)q=i.neg;else{if(q*(0<q?b:f)+D*(0<D?c:g)+u*(0<u?d:h)<=k)q=i.neg,0>=q?0>q&&(q=-(q+1),r[q]||(r[q]=!0,j.push(q))):(l[m]=q,m+=1);q=i.pos}if(0>=q){0>q&&(q=-(q+1),r[q]||(r[q]=!0,j.push(q)));break}}while(q<e)}while(0<m);return j};W.prototype.findVisiblePortals=
function(a,b,c,d){var f=this.buildPortalPlanes,g=this.visiblePortals,h=g.length,e=this.frustumPlanes,j=e.length,r=this.getQueryCounter(),l=this.areas,m,q,i,k,D,u,z,B=0;q=this.nearPlane;u=q[0];m=q[1];q=q[2];e[j]=[u,m,q,u*b+m*c+q*d];m=l[a];m=m.portals;q=m.length;for(D=0;D<q;D+=1)i=m[D],i.disabled||(i.queryCounter=r,k=i.plane,k[0]*b+k[1]*c+k[2]*d<k[3]&&(B<h?(z=g[B],u=z.planes,u.length=0):u=[],f(i.points,u,b,c,d,e),0<u.length&&(B<h?(z.portal=i,z.area=i.area):g[B]={portal:i,planes:u,area:i.area},B+=1)));
e.length=j;if(0<B){var y,v,x,J,j=0;do{z=g[j];j+=1;u=z.planes;e=u.length;i=z.portal;a=z.area;u[e]=i.plane;m=l[a];m=m.portals;q=m.length;for(D=0;D<q;D+=1)i=m[D],y=i.area,y!==a&&(i.queryCounter!==r&&!i.disabled)&&(k=i.plane,v=k[0],x=k[1],J=k[2],k=k[3],v*b+x*c+J*d<k?(B<h?(z=g[B],k=z.planes,k.length=0):k=[],v=f(i.points,k,b,c,d,u),0<k.length&&(v&&(i.queryCounter=r),B<h?(z.portal=i,z.area=y):g[B]={portal:i,planes:k,area:y},B+=1)):i.queryCounter=r);u.length=e}while(j<B)}B<h&&(g.length=B)};W.prototype.findVisibleNodes=
function(a,b){var c=b.length,d=this.frustumPlanes,f=!0,g=this.areas;if(g){var h=a.matrix,e=h[9],j=h[10],r=h[11],l=this.findAreaIndex(this.bspNodes,e,j,r);this.cameraAreaIndex=l;if(0<=l){a.getFrustumExtents(this.cameraExtents);var f=this.cameraExtents[0],h=this.cameraExtents[1],m=this.cameraExtents[2],q=this.cameraExtents[3],i=this.cameraExtents[4],k=this.cameraExtents[5];this.findVisiblePortals(l,e,j,r);for(var D,u,r=g.length,j=0;j<r;j+=1)D=g[j],e=D.nodes,u=D.numStaticNodes,e.length>u&&(e.length=
u),D.addedDynamicNodes=!1;var j=this.isInsidePlanesAABB,r=this.dynamicSpatialMap,z=this.visiblePortals,B=z.length,y=this.getQueryCounter(),v,x;D=g[l];e=D.nodes;D.addedDynamicNodes=!0;var J=D.extents;u=J[0];D=J[1];v=J[2];var C=J[3],t=J[4],J=J[5],w=this.float32ArrayConstructor?new this.float32ArrayConstructor(6):Array(6);w[0]=u<f?f:u;w[1]=D<h?h:D;w[2]=v<m?m:v;w[3]=C>q?q:C;w[4]=t>i?i:t;w[5]=J>k?k:J;r.getOverlappingNodes(w,e);u=e.length;for(D=0;D<u;D+=1)v=e[D],v.queryCounter=y,j(v.worldExtents,d)&&(b[c]=
v,c+=1);for(l=0;l<B;l+=1){e=z[l];x=e.planes;D=g[e.area];e=D.nodes;D.addedDynamicNodes||(D.addedDynamicNodes=!0,J=D.extents,u=J[0],D=J[1],v=J[2],C=J[3],t=J[4],J=J[5],w[0]=u<f?f:u,w[1]=D<h?h:D,w[2]=v<m?m:v,w[3]=C>q?q:C,w[4]=t>i?i:t,w[5]=J>k?k:J,r.getOverlappingNodes(w,e));u=e.length;for(D=0;D<u;D+=1)v=e[D],v.queryCounter!==y&&j(v.worldExtents,x)&&(v.queryCounter=y,b[c]=v,c+=1)}f=!1}}f&&(c+=this.staticSpatialMap.getVisibleNodes(d,b,c),this.dynamicSpatialMap.getVisibleNodes(d,b,c))};W.prototype.findVisibleNodesTree=
function(a,b,c){var b=c.length,d=this.frustumPlanes,f=!0,g=this.areas;if(g){var h=this.cameraAreaIndex;if(0<=h){var f=this.cameraExtents[0],e=this.cameraExtents[1],j=this.cameraExtents[2],r=this.cameraExtents[3],l=this.cameraExtents[4],m=this.cameraExtents[5],q=this.externalNodesStack,i,k,D,u,z,B,y=this.float32ArrayConstructor?new this.float32ArrayConstructor(6):Array(6),v,x,J=g.length;for(u=0;u<J;u+=1)if(v=g[u],x=v.externalNodes)x.length=0,q.push(x),v.externalNodes=null;var J=this.isInsidePlanesAABB,
C=this.findOverlappingAreas,t=this.findAreaIndex,w=this.visiblePortals,V=w.length,A=this.getQueryCounter(),K=this.bspNodes,E,N;v=g[h];x=v.externalNodes;if(!x){x=0<q.length?q.pop():[];v.externalNodes=x;i=v.extents;k=i[0];D=i[1];u=i[2];z=i[3];B=i[4];i=i[5];y[0]=k<f?f:k;y[1]=D<e?e:D;y[2]=u<j?j:u;y[3]=z>r?r:z;y[4]=B>l?l:B;y[5]=i>m?m:i;a.getOverlappingNodes(y,x);k=x.length;for(D=0;D<k;D+=1)if(u=x[D],u=u.worldExtents,z=0.5*(u[0]+u[3]),B=0.5*(u[1]+u[4]),i=0.5*(u[2]+u[5]),z=t(K,z,B,i),0<=z&&h!==z){z=C.call(this,
z,u,!0);B=z.length;for(u=0;u<B&&z[u]!==v;u+=1);if(u>=B)if(k-=1,D<k)x[D]=x[k],D-=1;else break}x.length=k}k=x.length;for(D=0;D<k;D+=1)u=x[D],u.queryCounter=A,J(u.worldExtents,d)&&(c[b]=u,b+=1);for(N=0;N<V;N+=1){h=w[N];E=h.planes;h=h.area;v=g[h];x=v.externalNodes;if(!x){x=0<q.length?q.pop():[];v.externalNodes=x;i=v.extents;k=i[0];D=i[1];u=i[2];z=i[3];B=i[4];i=i[5];y[0]=k<f?f:k;y[1]=D<e?e:D;y[2]=u<j?j:u;y[3]=z>r?r:z;y[4]=B>l?l:B;y[5]=i>m?m:i;a.getOverlappingNodes(y,x);k=x.length;for(D=0;D<k;D+=1)if(u=
x[D],u=u.worldExtents,z=0.5*(u[0]+u[3]),B=0.5*(u[1]+u[4]),i=0.5*(u[2]+u[5]),z=t(K,z,B,i),0<=z&&h!==z){z=C.call(this,z,u,!0);B=z.length;for(u=0;u<B&&z[u]!==v;u+=1);if(u>=B)if(k-=1,D<k)x[D]=x[k],D-=1;else break}x.length=k}k=x.length;for(D=0;D<k;D+=1)u=x[D],u.queryCounter!==A&&J(u.worldExtents,E)&&(u.queryCounter=A,c[b]=u,b+=1)}f=!1}}f&&a.getVisibleNodes(d,c,b)};W.prototype.buildPortalPlanesNoFrustum=function(a,b,c,d){var f=a.length,g=[],h=0,e=[],j,r;e.length=f;j=0;do r=a[j],e[j]=[r[0]-b,r[1]-c,r[2]-
d],j+=1;while(j<f);a=Math.sqrt;j=0;do{r=e[j];var l=r[0],m=r[1],q=r[2];r=e[j+1<f?j+1:0];var i=r[0],k=r[1],D=r[2];r=m*D-q*k;q=q*i-l*D;l=l*k-m*i;m=r*r+q*q+l*l;if(0===m)return!1;m=1/a(m);r*=m;q*=m;l*=m;g[h]=[r,q,l,r*b+q*c+l*d];h+=1;j+=1}while(j<f);return g};W.prototype.findOverlappingPortals=function(a,b,c,d,f,g){var h,e,j,r,l,m,q,i,k=this.buildPortalPlanesNoFrustum,D=this.getQueryCounter(),u=this.areas,z=0,B=f[0],y=f[1],v=f[2],x=f[3],J=f[4],f=f[5];h=u[a];h=h.portals;e=h.length;for(j=0;j<e;j+=1)if(r=
h[j],!r.disabled&&(r.queryCounter=D,m=r.extents,m[0]<x&&(m[1]<J&&m[2]<f&&m[3]>B&&m[4]>y&&m[5]>v)&&(l=r.plane,m=l[0],q=l[1],i=l[2],l=l[3],m*b+q*c+i*d<l&&m*(0>m?B:x)+q*(0>q?y:J)+i*(0>i?v:f)>=l)))if(m=k(r.points,b,c,d))g[z]={portal:r,planes:m,area:r.area},z+=1;if(0<z){var C,t,w=0;do{a=g[w];w+=1;C=a.planes;a=a.area;h=u[a];h=h.portals;e=h.length;for(j=0;j<e;j+=1)if(r=h[j],t=r.area,t!==a&&r.queryCounter!==D&&!r.disabled)if(m=r.extents,m[0]<x&&m[1]<J&&m[2]<f&&m[3]>B&&m[4]>y&&m[5]>v)if(l=r.plane,m=l[0],q=
l[1],i=l[2],l=l[3],m*b+q*c+i*d<l&&m*(0>m?B:x)+q*(0>q?y:J)+i*(0>i?v:f)>=l){if(m=k(r.points,b,c,d))r.queryCounter=D,g[z]={portal:r,planes:C.concat(m),area:t},z+=1}else r.queryCounter=D;else r.queryCounter=D}while(w<z)}};W.prototype.findOverlappingNodes=function(a,b,c,d){var f=!0;this.areas&&(f=!this._findOverlappingNodesAreas(a,b,c,d));f&&a.getOverlappingNodes(c,d)};W.prototype.findStaticOverlappingNodes=function(a,b,c){this.findOverlappingNodes(this.staticSpatialMap,a,b,c)};W.prototype.findDynamicOverlappingNodes=
function(a,b,c){this.findOverlappingNodes(this.dynamicSpatialMap,a,b,c)};W.prototype._findOverlappingNodesAreas=function(a,b,c,d){var f=b[0],g=b[1],h=b[2],e=this.findAreaIndex(this.bspNodes,f,g,h);if(0>e)return!1;var b=this.externalNodesStack,j=this.areas,r,l,m,q=j.length;for(r=0;r<q;r+=1)if(l=j[r],m=l.externalNodes)m.length=0,b.push(m),l.externalNodes=null;r=c[0];var q=c[1],i=c[2],k=c[3],D=c[4],u=c[5];l=j[e];var z=l.extents,B=z[0],y=z[1],v=z[2],x=z[3],J=z[4],z=z[5],C=[];this.findOverlappingPortals(e,
f,g,h,c,C);var c=this.isInsidePlanesAABB,f=this.getQueryCounter(),g=C.length,h=d.length,t;m=0<b.length?b.pop():[];l.externalNodes=m;var w=this.testExtents;w[0]=B>r?B:r;w[1]=y>q?y:q;w[2]=v>i?v:i;w[3]=x<k?x:k;w[4]=J<D?J:D;w[5]=z<u?z:u;a.getOverlappingNodes(w,m);l=m.length;for(B=0;B<l;B+=1)y=m[B],y.queryCounter=f,d[h]=y,h+=1;for(t=0;t<g;t+=1){m=C[t];e=m.planes;l=j[m.area];m=l.externalNodes;m||(m=0<b.length?b.pop():[],l.externalNodes=m,z=l.extents,B=z[0],y=z[1],v=z[2],x=z[3],J=z[4],z=z[5],w[0]=B>r?B:
r,w[1]=y>q?y:q,w[2]=v>i?v:i,w[3]=x<k?x:k,w[4]=J<D?J:D,w[5]=z<u?z:u,a.getOverlappingNodes(w,m));l=m.length;for(B=0;B<l;B+=1)y=m[B],y.queryCounter!==f&&c(y.worldExtents,e)&&(y.queryCounter=f,d[h]=y,h+=1)}return!0};W.prototype.findOverlappingRenderables=function(a,b,c,d){var f=!0;this.areas&&(f=!this._findOverlappingRenderablesAreas(a,b,c,d));f&&this._findOverlappingRenderablesNoAreas(a,c,d)};W.prototype.findStaticOverlappingRenderables=function(a,b,c){this.findOverlappingRenderables(this.staticSpatialMap,
a,b,c)};W.prototype.findDynamicOverlappingRenderables=function(a,b,c){this.findOverlappingRenderables(this.dynamicSpatialMap,a,b,c)};W.prototype._findOverlappingRenderablesAreas=function(a,b,c,d){var f=b[0],g=b[1],h=b[2],e=this.findAreaIndex(this.bspNodes,f,g,h);if(0>e)return!1;var b=d.length,j=c[0],r=c[1],l=c[2],m=c[3],q=c[4],i=c[5],k,D,u,z,B,y,v,x,J=this.externalNodesStack,C=this.areas,t,w;u=C.length;for(t=0;t<u;t+=1)if(k=C[t],w=k.externalNodes)w.length=0,J.push(w),k.externalNodes=null;k=C[e];x=
k.extents;D=x[0];B=x[1];y=x[2];z=x[3];v=x[4];x=x[5];t=[];this.findOverlappingPortals(e,f,g,h,c,t);var c=this.isInsidePlanesAABB,f=this.isFullyInsidePlanesAABB,g=this.getQueryCounter(),h=t.length,A,E,K;w=0<J.length?J.pop():[];k.externalNodes=w;e=this.testExtents;e[0]=D>j?D:j;e[1]=B>r?B:r;e[2]=y>l?y:l;e[3]=z<m?z:m;e[4]=v<q?v:q;e[5]=x<i?x:i;a.getOverlappingNodes(e,w);D=w.length;for(u=0;u<D;u+=1)if(k=w[u],k.queryCounter=g,B=k.renderables)if(y=B.length,1===y)d[b]=B[0],b+=1;else if(z=k.worldExtents,z[0]>=
j&&z[1]>=r&&z[2]>=l&&z[3]<=m&&z[4]<=q&&z[5]<=i)for(v=0;v<y;v+=1)d[b]=B[v],b+=1;else for(v=0;v<y;v+=1)z=B[v],x=z.getWorldExtents(),x[3]>=j&&(x[4]>=r&&x[5]>=l&&x[0]<=m&&x[1]<=q&&x[2]<=i)&&(d[b]=z,b+=1);for(E=0;E<h;E+=1){w=t[E];u=w.planes;k=C[w.area];w=k.externalNodes;w||(w=0<J.length?J.pop():[],k.externalNodes=w,x=k.extents,D=x[0],B=x[1],y=x[2],z=x[3],v=x[4],x=x[5],e[0]=D>j?D:j,e[1]=B>r?B:r,e[2]=y>l?y:l,e[3]=z<m?z:m,e[4]=v<q?v:q,e[5]=x<i?x:i,a.getOverlappingNodes(e,w));D=w.length;for(A=0;A<D;A+=1)if(k=
w[A],k.queryCounter!==g){K=!0;if(B=k.renderables)if(z=k.worldExtents,c(z,u))if(y=B.length,1===y)z=B[0],z.queryCounter!==g&&(z.queryCounter=g,d[b]=z,b+=1);else if(z[0]>=j&&z[1]>=r&&z[2]>=l&&z[3]<=m&&z[4]<=q&&z[5]<=i)if(f(z,u))for(v=0;v<y;v+=1)z=B[v],z.queryCounter!==g&&(z.queryCounter=g,d[b]=z,b+=1);else for(v=0;v<y;v+=1)z=B[v],z.queryCounter!==g&&(c(z.getWorldExtents(),u)?(z.queryCounter=g,d[b]=z,b+=1):K=!1);else if(f(z,u))for(v=0;v<y;v+=1)z=B[v],z.queryCounter!==g&&(x=z.getWorldExtents(),x[3]>=j&&
x[4]>=r&&x[5]>=l&&x[0]<=m&&x[1]<=q&&x[2]<=i?(z.queryCounter=g,d[b]=z,b+=1):K=!1);else for(v=0;v<y;v+=1)z=B[v],z.queryCounter!==g&&(x=z.getWorldExtents(),x[3]>=j&&x[4]>=r&&x[5]>=l&&x[0]<=m&&x[1]<=q&&x[2]<=i&&c(x,u)?(z.queryCounter=g,d[b]=z,b+=1):K=!1);else K=!1;K&&(k.queryCounter=g)}}return!0};W.prototype._findOverlappingRenderablesNoAreas=function(a,b,c){var d=c.length,f=b[0],g=b[1],h=b[2],e=b[3],j=b[4],r=b[5],l=[],m,q,i,k,D;a.getOverlappingNodes(b,l);a=l.length;for(b=0;b<a;b+=1)if(m=l[b],q=m.renderables)if(i=
q.length,1===i)c[d]=q[0],d+=1;else if(m=m.worldExtents,m[0]>=f&&m[1]>=g&&m[2]>=h&&m[3]<=e&&m[4]<=j&&m[5]<=r)for(k=0;k<i;k+=1)c[d]=q[k],d+=1;else for(k=0;k<i;k+=1)m=q[k],D=m.getWorldExtents(),D[3]>=f&&(D[4]>=g&&D[5]>=h&&D[0]<=e&&D[1]<=j&&D[2]<=r)&&(c[d]=m,d+=1)};W.prototype.cloneRootNode=function(a,b){var c=a.clone(b);this.addRootNode(c);return c};W.prototype.updateVisibleNodes=function(a){var b=!0;this.areas&&(b=!this._updateVisibleNodesAreas(a));b&&this._updateVisibleNodesNoAreas(a);this.frameIndex+=
1};W.prototype._updateVisibleNodesNoAreas=function(a){var b=this.visibleNodes,c=0,d=this.visibleRenderables,f=0,g=this.visibleLights,h=0;this.extractFrustumPlanes(a);var e=this.frustumPlanes,j=this.frameIndex,r=this.nearPlane,l=r[0],m=r[1],q=r[2],r=r[3],i=0,k,D,u=this.isFullyInsidePlanesAABB,z=this.isInsidePlanesAABB,B=this.queryVisibleNodes;B||(this.queryVisibleNodes=B=[]);var y=this.staticSpatialMap.getVisibleNodes(e,B,0),y=y+this.dynamicSpatialMap.getVisibleNodes(e,B,y);for(k=0;k<y;k+=1)if(D=B[k],
!D.disabled){var v=D.worldExtents,x,J,C,t,w;D.frameVisible=j;x=l*(0<l?v[3]:v[0])+m*(0<m?v[4]:v[1])+q*(0<q?v[5]:v[2])-r;D.distance=x;if(0<x){b[c]=D;c+=1;w=(t=D.renderables)?t.length:0;var A=(D=D.lightInstances)?D.length:0,E=1<A+w?u(v,e):!1;if(t)if(1===w&&!D)J=t[0],J.disabled||(i<x&&(i=x),J.distance=x,J.frameVisible=j,d[f]=J,f+=1);else for(C=0;C<w;C+=1)if(J=t[C],!J.disabled&&(v=J.getWorldExtents(),E||z(v,e)))x=l*(0<l?v[3]:v[0])+m*(0<m?v[4]:v[1])+q*(0<q?v[5]:v[2])-r,0<x&&(i<x&&(i=x),J.distance=x,J.frameVisible=
j,d[f]=J,f+=1);if(D)if(1===A&&!t)t=D[0],!t.disabled&&!t.light.isGlobal()&&(t.distance=x,t.frameVisible=j,g[h]=t,h+=1);else for(w=0;w<A;w+=1)if(t=D[w],!t.disabled&&!t.light.isGlobal()&&(v=t.getWorldExtents(),E||z(v,e)))x=l*(0<l?v[3]:v[0])+m*(0<m?v[4]:v[1])+q*(0<q?v[5]:v[2])-r,0<x&&(t.distance=x,t.frameVisible=j,g[h]=t,h+=1)}}this.maxDistance=i+a.nearPlane;this.maxDistance<a.farPlane?this._filterVisibleNodesForCameraBox(a,c,f,h):(d.length=f,g.length=h,b.length=c)};W.prototype._updateVisibleNodesAreas=
function(a){function b(a,b){var c=a.worldExtents,d=!0,f;a.frameVisible!==k?(a.frameVisible=k,f=D*(0<D?c[3]:c[0])+u*(0<u?c[4]:c[1])+z*(0<z?c[5]:c[2])-B,a.distance=f,0<f&&(e[j]=a,j+=1)):f=a.distance;if(0<f){var g,h,i=a.renderables,p=i?i.length:0,v=a.lightInstances,x=v?v.length:0,t=1<x+p?J(c,b):!1;if(i)if(1===p&&!v)g=i[0],!g.disabled&&g.queryCounter!==N&&(y<f&&(y=f),g.distance=f,g.frameVisible=k,g.queryCounter=N,r[l]=g,l+=1);else for(h=0;h<p;h+=1)g=i[h],!g.disabled&&g.queryCounter!==N&&(c=g.getWorldExtents(),
t||C(c,b)?(f=D*(0<D?c[3]:c[0])+u*(0<u?c[4]:c[1])+z*(0<z?c[5]:c[2])-B,0<f?(y<f&&(y=f),g.distance=f,g.frameVisible=k,g.queryCounter=N,r[l]=g,l+=1):d=!1):d=!1);if(v)if(1===x&&!i)g=v[0],!g.disabled&&(g.queryCounter!==N&&!g.light.isGlobal())&&(g.distance=f,g.frameVisible=k,g.queryCounter=N,m[q]=g,q+=1);else for(h=0;h<x;h+=1)g=v[h],!g.disabled&&(g.queryCounter!==N&&!g.light.isGlobal())&&(c=g.getWorldExtents(),t||C(c,b)?(f=D*(0<D?c[3]:c[0])+u*(0<u?c[4]:c[1])+z*(0<z?c[5]:c[2])-B,0<f?(g.distance=f,g.frameVisible=
k,g.queryCounter=N,m[q]=g,q+=1):d=!1):d=!1)}d&&(a.queryCounter=N)}var c=a.matrix,d=c[9],f=c[10],g=c[11],h=this.findAreaIndex(this.bspNodes,d,f,g);this.cameraAreaIndex=h;if(0>h)return!1;var e=this.visibleNodes,j=0,r=this.visibleRenderables,l=0,m=this.visibleLights,q=0;this.extractFrustumPlanes(a);var i=this.frustumPlanes,k=this.frameIndex,c=this.nearPlane,D=c[0],u=c[1],z=c[2],B=c[3],y=0,v=0,x,J=this.isFullyInsidePlanesAABB,C=this.isInsidePlanesAABB,t=this.cameraExtents;a.getFrustumExtents(t);var c=
t[0],w=t[1],A=t[2],E=t[3],K=t[4],t=t[5],H=this.areas,N=this.getQueryCounter();this.findVisiblePortals(h,d,f,g);for(var da,g=H.length,f=0;f<g;f+=1)v=H[f],d=v.nodes,da=v.numStaticNodes,d.length>da&&(d.length=da),v.addedDynamicNodes=!1;var f=this.dynamicSpatialMap,g=this.visiblePortals,va=g.length,F,v=H[h],d=v.nodes;v.addedDynamicNodes=!0;var I=v.extents;da=I[0];x=I[1];var G=I[2],U=I[3],X=I[4],I=I[5],h=this.float32ArrayConstructor?new this.float32ArrayConstructor(6):Array(6);h[0]=da<c?c:da;h[1]=x<w?
w:x;h[2]=G<A?A:G;h[3]=U>E?E:U;h[4]=X>K?K:X;h[5]=I>t?t:I;f.getOverlappingNodes(h,d);da=d.length;for(v=0;v<da;v+=1)x=d[v],x.queryCounter=N,!x.disabled&&C(x.worldExtents,i)&&b(x,i);for(i=0;i<va;i+=1)if(d=g[i],F=d.planes,v=H[d.area],d=v.nodes,I=v.extents,da=I[0],x=I[1],G=I[2],U=I[3],X=I[4],I=I[5],E>da&&K>x&&t>G&&U>c&&X>w&&I>A){v.addedDynamicNodes||(v.addedDynamicNodes=!0,h[0]=da<c?c:da,h[1]=x<w?w:x,h[2]=G<A?A:G,h[3]=U>E?E:U,h[4]=X>K?K:X,h[5]=I>t?t:I,f.getOverlappingNodes(h,d));da=d.length;for(v=0;v<da;v+=
1)x=d[v],x.queryCounter!==N&&(x.disabled?x.queryCounter=N:C(x.worldExtents,F)&&b(x,F))}this.maxDistance=y+a.nearPlane;this.maxDistance<a.farPlane?this._filterVisibleNodesForCameraBox(a,j,l,q):(r.length=l,m.length=q,e.length=j);return!0};W.prototype._filterVisibleNodesForCameraBox=function(a,b,c,d){var f=this.visibleNodes,g=this.visibleRenderables,h=this.visibleLights,e=c,j=d,r=this.cameraExtents;a.getFrustumExtents(r,this.maxDistance);for(var a=r[0],l=r[1],m=r[2],q=r[3],i=r[4],r=r[5],k,D,u=0;u<c;)if(k=
g[u],D=k.getWorldExtents(),D[0]>q||D[1]>i||D[2]>r||D[3]<a||D[4]<l||D[5]<m)if(k.frameVisible-=1,c-=1,u<c)g[u]=g[c];else break;else u+=1;for(u=0;u<d;)if(k=h[u],D=k.getWorldExtents(),D[0]>q||D[1]>i||D[2]>r||D[3]<a||D[4]<l||D[5]<m)if(k.frameVisible-=1,d-=1,u<d)h[u]=h[d];else break;else u+=1;if(e!==c||j!==d)for(u=0;u<b;)if(e=f[u],D=e.worldExtents,D[0]>q||D[1]>i||D[2]>r||D[3]<a||D[4]<l||D[5]<m)if(e.frameVisible-=1,b-=1,u<b)f[u]=f[b];else break;else u+=1;g.length=c;h.length=d;f.length=b};W.prototype.getCurrentVisibleNodes=
function(){return this.visibleNodes};W.prototype.getCurrentVisibleRenderables=function(){return this.visibleRenderables};W.prototype.getCurrentVisibleLights=function(){return this.visibleLights};W.prototype.addRootNodeToUpdate=function(a,b){var c=this.dirtyRoots;c[b]!==a&&(c[b]=a,c=this.numNodesToUpdate,this.nodesToUpdate[c]=a,this.numNodesToUpdate=c+1)};W.prototype.updateNodes=function(){var a=this.numNodesToUpdate;if(0<a){var b=this.nodesToUpdate,c=this.dirtyRoots,d;for(d=0;d<a;d+=1)c[b[d].name]=
null;Sa.updateNodes(this.md,this,b,a);this.numNodesToUpdate=0}};W.prototype.update=function(){this.updateNodes();this.staticSpatialMap.finalize();this.dynamicSpatialMap.finalize();this.updateExtents();this.areas&&this.staticNodesChangeCounter!==this.areaInitalizeStaticNodesChangeCounter&&this.initializeAreas()};W.prototype.updateExtents=function(){var a=this.staticSpatialMap.getExtents(),b=this.dynamicSpatialMap.getExtents(),c=this.extents;if(a)if(b){var d,f,g,h,e,j,r,l,m,q;d=a[0];f=a[1];g=a[2];h=
a[3];e=a[4];a=a[5];j=b[0];r=b[1];l=b[2];m=b[3];q=b[4];b=b[5];c[0]=d<j?d:j;c[1]=f<r?f:r;c[2]=g<l?g:l;c[3]=h>m?h:m;c[4]=e>q?e:q;c[5]=a>b?a:b}else c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[4]=a[4],c[5]=a[5];else b?(c[0]=b[0],c[1]=b[1],c[2]=b[2],c[3]=b[3],c[4]=b[4],c[5]=b[5]):(c[0]=0,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=0)};W.prototype.getExtents=function(){0<this.numNodesToUpdate&&(this.updateNodes(),this.staticSpatialMap.finalize(),this.dynamicSpatialMap.finalize(),this.updateExtents());return this.extents};
W.prototype.loadMaterial=function(a,b,c,d,f){if(!this.materials[d]){var g=f.effect||"default";if(a=this.createMaterial(d,f,g,null,null,a))return delete a.effectName,(c=c.get(g))&&c.prepareMaterial(a),a.loadTextures(b),!0}return!1};W.prototype.hasMaterial=function(a){return this.materials[a]?!0:!1};W.prototype.getMaterial=function(a){return this.materials[a]};W.prototype.drawNodesArray=function(a,b,c,d,f){var g=a.length;if(0<g){var h=b.setTechniqueParameters,e=b.setStream,j=b.setIndexBuffer,r=b.drawIndexed,
l=b.draw,m=null,q=null,i=null,k,D,u,z,B,y,v=0;b.setTechnique.call(b,d);h.call(b,c);do{c=a[v];if(c=c.renderables){d=c.length;for(y=0;y<d;y+=1){u=c[y];f.call(u);k=u.geometry;z=k.vertexBuffer;B=k.semantics;k=u.surface;D=u.sharedMaterial.techniqueParameters;u=u.techniqueParameters;m!==D?(m=D,h.call(b,D,u)):h.call(b,u);if(q!==z||i!==B)q=z,i=B,e.call(b,z,B);(z=k.indexBuffer)?(j.call(b,z),r.call(b,k.primitive,k.numIndices,k.first)):l.call(b,k.primitive,k.numVertices,k.first)}}v+=1}while(v<g)}};W.prototype.drawVisibleNodes=
function(a,b,c,d){this.drawNodesArray(this.visibleNodes,a,b,c,d)};W.prototype.clearMaterials=function(){var a=this.onMaterialDestroyed,b=this.materials;if(b)for(var c in b)b.hasOwnProperty(c)&&b[c].reference.unsubscribeDestroyed(a);this.materials={}};W.prototype.clearShapes=function(){var a=this.onGeometryDestroyed,b=this.shapes;if(b)for(var c in b)b.hasOwnProperty(c)&&b[c].reference.unsubscribeDestroyed(a);this.shapes={}};W.prototype.clearShapesVertexData=function(){var a=this.shapes,b;if(a)for(var c in a)if(a.hasOwnProperty(c)&&
(b=a[c],delete b.vertexData,delete b.indexData,b=b.surfaces))for(var d in b)if(b.hasOwnProperty(d)){var f=b[d];delete f.vertexData;delete f.indexData}};W.prototype.clearRootNodes=function(){var a=this.rootNodes;if(a)for(var b=a.length,c=0;c<b;c+=1)a[c].destroy();this.rootNodes=[];this.rootNodesMap={};this.dirtyRoots={};this.nodesToUpdate=[];this.numNodesToUpdate=0};W.prototype.clear=function(){this.effects=[];this.effectsMap={};this.semantics={};this.lights={};this.globalLights=[];this.clearRootNodes();
this.clearMaterials();this.clearShapes();this.staticSpatialMap.clear();this.dynamicSpatialMap.clear();this.frustumPlanes=[];this.animations={};this.skeletons={};this.extents=this.md.aabbBuildEmpty();this.visibleNodes=[];this.visibleRenderables=[];this.visibleLights=[];this.cameraAreaIndex=-1;this.cameraExtents=this.md.aabbBuildEmpty();this.visiblePortals=[];this.staticNodesChangeCounter=this.queryCounter=this.frameIndex=0;this.testExtents=this.md.aabbBuildEmpty();this.externalNodesStack=[]};W.prototype.endLoading=
function(a){this.initializeNodes();this.initializeAreas();a&&a(this)};W.prototype.initializeNodes=function(){this.updateNodes();this.staticSpatialMap.finalize();this.updateExtents()};W.prototype.addAreaStaticNodes=function(){for(var a=this.findAreaIndicesAABB,b=this.findAreaIndex,c=this,d=function(f,g){if(!this.dynamic){if(this.hasRenderables()||this.hasLightInstances()&&this.worldExtents){var h=this.worldExtents,e=h[0],n=h[1],j=h[2],i=h[3],k=h[4],z=h[5],B,y,v;!this.hasRenderables()&&1===this.lightInstances.length&&
this.lightInstances[0].light.spot?(v=this.world,B=v[9],y=v[10],v=v[11]):(B=0.5*(e+i),y=0.5*(n+k),v=0.5*(j+z));y=b(f,B,y,v);if(0<=y){B=g[y];B.nodes.push(this);e=c.findOverlappingAreas(y,h);n=e.length;for(h=0;h<n;h+=1)e[h].nodes.push(this)}else for(y=!1;;){var x=a(f,e,n,j,i,k,z),J=x.length;if(0<J){h=0;do B=g[x[h]],v=B.extents,v[0]<=i&&(v[1]<=k&&v[2]<=z&&v[3]>=e&&v[4]>=n&&v[5]>=j)&&(B.nodes.push(this),y=!0),h+=1;while(h<J);if(!y){h=0;do g[x[h]].nodes.push(this),h+=1;while(h<J)}break}else B=Math.max(i-
e,k-n,z-j)/20,e-=B,n-=B,j-=B,i+=B,k+=B,z+=B}}if(e=this.children){n=e.length;for(j=0;j<n;j+=1)d.call(e[j],f,g)}}},f=this.rootNodes,g=f.length,h=this.bspNodes,e=this.areas,j=0;j<g;j+=1)d.call(f[j],h,e)};W.prototype.findOverlappingAreas=function(a,b,c){var d,f,g,h,e,j,r,l,m=this.getQueryCounter(),q=this.areas,i=[],k=0,D=[],u=0,z=b[0],B=b[1],y=b[2],v=b[3],x=b[4],J=b[5];d=q[a];d.queryCounter=m;d=d.portals;f=d.length;for(g=0;g<f;g+=1)if(h=d[g],!c||!h.disabled)if(h.queryCounter=m,e=h.extents,e[0]<v&&(e[1]<
x&&e[2]<J&&e[3]>z&&e[4]>B&&e[5]>y)&&(e=h.plane,j=e[0],r=e[1],l=e[2],j*(0>j?z:v)+r*(0>r?B:x)+l*(0>l?y:J)>=e[3]))i[k]=h,k+=1;for(;0<k;){k-=1;h=i[k];b=h.area;d=q[b];d.queryCounter!==m&&(d.queryCounter=m,D[u]=d,u+=1);d=d.portals;f=d.length;for(g=0;g<f;g+=1)if(h=d[g],!c||!h.disabled)if(e=h.area,e!==b&&(e!==a&&h.queryCounter!==m)&&(h.queryCounter=m,e=h.extents,e[0]<v&&(e[1]<x&&e[2]<J&&e[3]>z&&e[4]>B&&e[5]>y)&&(e=h.plane,j=e[0],r=e[1],l=e[2],j*(0>j?z:v)+r*(0>r?B:x)+l*(0>l?y:J)>=e[3])))i[k]=h,k+=1}return D};
W.prototype.checkAreaDynamicNodes=function(){for(var a=this.findAreaIndicesAABB,b=this.dynamicSpatialMap,c=this.bspNodes,d=this.areas,f=function(){if(this.dynamic&&(this.hasRenderables()||this.hasLightInstances()&&this.worldExtents)){for(var g=this.worldExtents,h=g[0],e=g[1],n=g[2],q=g[3],i=g[4],k=g[5],D=!1,u=!1,z;;){var B=a(c,h,e,n,q,i,k),y=B.length;if(0<y){z=0;do{var v=d[B[z]].extents;if(v[0]<=q&&v[1]<=i&&v[2]<=k&&v[3]>=h&&v[4]>=e&&v[5]>=n){u=!0;break}z+=1}while(z<y)}if(u)break;D=Math.max(q-h,i-
e,k-n)/20;h-=D;e-=D;n-=D;q+=D;i+=D;k+=D;D=!0}D&&(g[0]=h,g[1]=e,g[2]=n,g[3]=q,g[4]=i,g[5]=k,b.update(this,g))}if(g=this.children){h=g.length;for(e=0;e<h;e+=1)f.call(g[e])}},g=this.rootNodes,h=g.length,e=0;e<h;e+=1)f.call(g[e])};W.prototype.initializeAreas=function(){var a=this.areas;if(a){var b=a.length,c,d,f;for(c=0;c<b;c+=1)if(d=a[c],f=d.target,d.nodes=[],f=f.calculateHierarchyWorldExtents())d=d.extents,d[0]=f[0]<d[0]?f[0]:d[0],d[1]=f[1]<d[1]?f[1]:d[1],d[2]=f[2]<d[2]?f[2]:d[2],d[3]=f[3]>d[3]?f[3]:
d[3],d[4]=f[4]>d[4]?f[4]:d[4],d[5]=f[5]>d[5]?f[5]:d[5];this.addAreaStaticNodes();this.checkAreaDynamicNodes();for(c=0;c<b;c+=1)d=a[c],d.numStaticNodes=d.nodes.length}this.areaInitalizeStaticNodesChangeCounter=this.staticNodesChangeCounter};W.prototype.createMaterial=function(a,b,c,d,f,g){var h=this.materials,g=xb.create(g),e,j,r;if(d)if(d=d[c]){r=d.parameters;for(j in r)r.hasOwnProperty(j)&&(c=r[j],"string"===typeof c?(c=f?f[c]||c:c,g.texturesNames||(g.texturesNames={}),g.texturesNames[j]=c,g.techniqueParameters[j]=
null):g.techniqueParameters[j]=c);e=d.type;r=d.meta}else e=c;else e=c;d=b.parameters;for(j in d)d.hasOwnProperty(j)&&(c=d[j],"string"===typeof c?(c=f?f[c]||c:c,g.texturesNames||(g.texturesNames={}),g.texturesNames[j]=c,g.techniqueParameters[j]=null):g.techniqueParameters[j]=c);g.effectName=e;if(b=b.meta){if(r)for(j in r)r.hasOwnProperty(j)&&!b.hasOwnProperty(j)&&(b[j]=r[j]);g.meta=b}else r&&(g.meta=r);h[a]=g;g.name=a;g.reference.subscribeDestroyed(this.onMaterialDestroyed);return g};W.prototype.loadMaterials=
function(a){var b=a.data,c=a.graphicsDevice,d=a.textureManager,f=this.createMaterial;a.append||(this.effects=[],this.effectsMap={},this.clearMaterials());if(a=b.materials){var g=b.images,b=b.effects,h=this.materials,e;for(e in a)if(a.hasOwnProperty(e)&&!h[e]){var j=a[e];f.call(this,e,j,j.effect||"default",b,g,c,d)}}};W.prototype.loadSkeletons=function(a){var b=a.data.skeletons,c=this.md,d=c.m43Build,f,g,h;for(h in b)if(b.hasOwnProperty(h)){for(var e=b[h],j=e.numNodes,r=e.invBoneLTMs,l=e.bindPoses,
m=0;m<j;m+=1)f=r[m],g=l[m],r[m]=d.apply(c,f),l[m]=d.apply(c,g);a.skeletonNamePrefix&&(h=a.skeletonNamePrefix+h);this.skeletons[h]=e}};W.prototype.loadShape=function(a,b,c){var d=this.shapes[a];if(d)throw"Geometry '"+a+"' already exists in the scene";var f=this.semantics,g=c.graphicsDevice,h=c.keepVertexData,e=c.data.geometries[b],j=e.sources,r=e.inputs,l=c.skeletonNamePrefix?c.skeletonNamePrefix+e.skeleton:e.skeleton,d=$c.create();if(l){var m=this.skeletons[l];m?(d.skeleton=m,d.type="skinned"):d.type=
"rigid"}else d.type="rigid";if(g){var q,i,k,D,u=0,z=[],B=function(a,b){return 0<=a&&255>=b&&1<b},y=c.vertexFormatMap||{},v;for(v in r)if(r.hasOwnProperty(v)&&void 0!==g["SEMANTIC_"+v]){var x=r[v];q=x.offset;q>u&&(u=q);var J=j[x.source],C=J.stride;D=y[v];k=C;D&&(D.indexOf("4")?k=4:D.indexOf("3")?k=3:D.indexOf("2")?k=2:D.indexOf("1")?k=1:D=null);if(!D&&("BLENDINDICES"===v||"BLENDINDICES0"===v)){var t;if(t=4===C)a:{var w=J.min,A=J.max,E=B,K=w.length;if(A.length!==K)t=!1;else{for(var H=0;H<K;H+=1)if(!E(w[H],
A[H])){t=!1;break a}t=!0}}t&&(D="UBYTE4")}D||(D="FLOAT"+C);z.push({semantic:v,offset:q,data:J.data,stride:C,destFormat:D,destStride:k})}var N=u+1;0<u&&z.sort(function(a,b){if(a.offset===b.offset){var c=a.semantic;"string"===typeof c&&(c=g["SEMANTIC_"+c]);var d=b.semantic;"string"===typeof d&&(d=g["SEMANTIC_"+d]);return c-d}return a.offset-b.offset});var da=z.length,va=[],F=[],I=this.float32ArrayConstructor?!0:!1,G=0,U,X;for(U=0;U<da;U+=1)X=z[U],va[U]=X.semantic,D=X.destFormat,I&&("string"===typeof D?
"F"!==D[0]&&(I=!1):D!==g.VERTEXFORMAT_FLOAT1&&(D!==g.VERTEXFORMAT_FLOAT2&&D!==g.VERTEXFORMAT_FLOAT3&&D!==g.VERTEXFORMAT_FLOAT4)&&(I=!1)),F[U]=D,G+=X.stride;var L,M=0,O=!1,P=e.surfaces;P||(O=!0,P={singleSurface:{triangles:e.triangles,lines:e.lines,numPrimitives:e.numPrimitives}});var S,W,R,T;for(T in P)if(P.hasOwnProperty(T)){S=P[T];W={};d.surfaces[T]=W;R=S.triangles;var Y,Z;if(R)Y=g.PRIMITIVE_TRIANGLES,Z=3;else if(R=S.lines)Y=g.PRIMITIVE_LINES,Z=2;W.primitive=Y;if(W.faces=R)1<N?L=S.numPrimitives*
Z:(L=z[0].data.length/z[0].stride,L>R.length&&(L=R.length)),W.numVertices=L}if(1<N){var ba=[],aa={},ca=d.surfaces;for(T in ca)if(ca.hasOwnProperty(T)){for(var ea=ca[T],fa=N,ga=ba,ia=aa,ha=ea.faces,ja=Array(ha.length/fa),la=Array(fa),ma=0,na=0,qa=fa,pa=ga.length,ra=pa/fa|0,oa=void 0;na<ha.length;){oa=0;do la[oa]=ha[na],oa+=1,na+=1;while(na<qa);var sa=la.join(","),ta=ia[sa];if(void 0===ta){ta=ra;ia[sa]=ta;ra+=1;oa=0;do ga[pa]=la[oa],pa+=1,oa+=1;while(oa<fa)}ja[ma]=ta;qa+=fa;ma+=1}ea.faces=ja}aa=null;
M=ba.length/N|0;for(U=0;U<da;U+=1){X=z[U];for(var ua=X.stride,xa=X.data,wa=Array(ua*M),ya=0,za=X.offset;ya<M;){for(var Ca=ua*ya,Da=ua*ba[za],Ba=0;Ba<ua;Ba+=1)wa[Ca+Ba]=xa[Da+Ba];ya+=1;za+=N}X.data=wa;X.offset=0}ba.length=0;ba=null;N=1}var M=z[0].data.length/z[0].stride,Ea=c.vertexBufferManager||this.vertexBufferManager;Ea||(this.vertexBufferManager=Ea=Pj.create(g));var Ga=c.indexBufferManager||this.indexBufferManager;Ga||(this.indexBufferManager=Ga=Qj.create(g));var Fa,Ha=null,Ja=Ea.allocate(M,F),
Ha=Ja.vertexBuffer;if(!Ha)return;d.vertexBuffer=Ha;d.vertexBufferManager=Ea;d.vertexBufferAllocation=Ja;Fa=Ja.baseIndex;var Ia,Aa,Ka,Ra,Pa=I?new this.float32ArrayConstructor(M*G):Array(M*G),Na=0;for(Aa=0;Aa<M;Aa+=1){U=0;do{X=z[U];var ab=X.data;i=X.stride;Ka=Aa*i;Ra=Ka+i;k=X.destStride;do Pa[Na]=ab[Ka],Na+=1,Ka+=1;while(Ka<Ra);for(;i<k;)Pa[Na]=0,Na+=1,k-=1;U+=1}while(U<da)}Ha.setData(Pa,Fa,M);var Wa=function(a,b){var c=a[0],d;for(d=1;d<b;d+=1)if(a[d]!==c+d)return!1;return!0},La=0,Ma;for(T in P)if(P.hasOwnProperty(T)&&
(W=d.surfaces[T],R=W.faces))Ma=R.length,Wa(R,Ma)||(La+=Ma);var Qa,Sa,Za,Oa,Xa;if(0<La){Xa=Fa+M-1;Ia=Ga.allocate(La,65536>Xa?"USHORT":"UINT");Qa=Ia.indexBuffer;if(!Qa)return;d.indexBufferManager=Ga;d.indexBufferAllocation=Ia;Sa=65536>Xa&&this.uint16ArrayConstructor?new this.uint16ArrayConstructor(La):this.uint32ArrayConstructor?new this.uint32ArrayConstructor(La):Array(La);Za=Ia.baseIndex;Oa=0}for(T in P)if(P.hasOwnProperty(T))if(W=d.surfaces[T],R=W.faces,delete W.faces,R){Ma=R.length;if(Wa(R,Ma))W.first=
Fa+R[0];else{W.indexBuffer=Qa;W.numIndices=Ma;W.first=Za+Oa;W.numVertices=M;if(Fa)for(Aa=0;Aa<Ma;Aa+=1)Sa[Oa]=Fa+R[Aa],Oa+=1;else for(Aa=0;Aa<Ma;Aa+=1)Sa[Oa]=R[Aa],Oa+=1;h&&(W.indexData=65536>Xa&&this.uint16ArrayConstructor?new this.uint16ArrayConstructor(R):this.uint32ArrayConstructor?new this.uint32ArrayConstructor(R):R)}R=null;h&&(W.vertexData=Pa)}else delete d.surfaces[T];Qa&&(Qa.setData(Sa,Za,La),Sa=null);var hb=va.join(),Ya=f[hb];Ya||(Ya=g.createSemantics(va),f[hb]=Ya);d.semantics=Ya;if(O){if(S=
d.surfaces.singleSurface)d.primitive=S.primitive,h&&(d.vertexData=S.vertexData),d.first=S.first,d.numVertices=S.numVertices,S.indexBuffer&&(d.indexBuffer=S.indexBuffer,d.numIndices=S.numIndices,h&&(d.indexData=S.indexData));delete d.surfaces}}if(r.POSITION){var kb=j[r.POSITION.source],$a=kb.min,cb=kb.max;if($a&&cb){var eb=$a[0],fb=$a[1],ib=$a[2],db=cb[0],gb=cb[1],jb=cb[2],Ua=this.float32ArrayConstructor?new this.float32ArrayConstructor(3):Array(3);d.halfExtents=Ua;if(eb!==-db||fb!==-gb||ib!==-jb){var Va=
this.float32ArrayConstructor?new this.float32ArrayConstructor(3):Array(3);d.center=Va;Va[0]=0.5*(eb+db);Va[1]=0.5*(fb+gb);Va[2]=0.5*(ib+jb);Ua[0]=db-Va[0];Ua[1]=gb-Va[1];Ua[2]=jb-Va[2]}else Ua[0]=0.5*(db-eb),Ua[1]=0.5*(gb-fb),Ua[2]=0.5*(jb-ib)}}this.shapes[a]=d;d.name=a;d.reference.subscribeDestroyed(this.onGeometryDestroyed);return d};W.prototype.streamShapes=function(a,b){var c=a.yieldFn,d=this,f=a.shapesNamePrefix,g=a.data.geometries,h=a.loadCustomShapeFn,e=[],j=[],r;for(r in g)if(g.hasOwnProperty(r)){if(e[r]||
j[r])throw"Multiple geometries named '"+r+"'";var l=g[r];l.meta&&l.meta.graphics&&(l.meta.custom?j.push(r):e.push(r))}var m=function(){var g=e.pop();d.loadShape(f?f+"-"+g:g,g,a);e.length?c(m):c(b)},q=function(){var g=j.pop();h.call(d,f?f+"-"+g:g,g,a);j.length?c(q):e.length?c(m):c(b)};j.length?c(q):e.length?c(m):c(b)};W.prototype.loadLights=function(a){var b=a.data,c=a.textureManager;a.append||(this.lights={},this.globalLights=[]);var b=b.lights,d=this.lights,f=this.globalLights,g=this.materials,h=
La.beget,a=a.mathDevice,e=a.v3Build,j;for(j in b)if(b.hasOwnProperty(j)&&!d[j]){var r=b[j],l=h(r),m=r.type;"directional"===m?l.directional=!0:"spot"===m?l.spot=!0:"ambient"===m?l.ambient=!0:l.point=!0;l.color=r.color&&e.apply(a,r.color);l.origin=r.origin&&e.apply(a,r.origin);l.center=r.center&&e.apply(a,r.center);l.target=r.target&&e.apply(a,r.target);l.right=r.right&&e.apply(a,r.right);l.up=r.up&&e.apply(a,r.up);l.start=r.start&&e.apply(a,r.start);l.end=r.end&&e.apply(a,r.end);l.direction=r.direction&&
e.apply(a,r.direction);l.halfExtents=r.halfextents&&e.apply(a,r.halfextents);if(r=r.material)if(r=g[r])l.material=r,r.effectName&&(delete r.effectName,r.loadTextures(c));l=ad.create(l);d[j]=l;l.isGlobal()&&f.push(l)}};W.prototype.loadNodes=function(a){var b=a.data,c=a.graphicsDevice,d=a.textureManager,f=a.effectManager,g=a.baseScene,h=a.keepCameras,e=a.keepLights,j=a.disabled;a.append||(this.clearRootNodes(),this.staticSpatialMap.clear(),this.dynamicSpatialMap.clear());var r=a.loadCustomGeometryInstanceFn,
l=this.md,m=l.m43Build,q=this.materials,i=this.lights,k=this,D;g&&(D=g.materials);var g=a.baseMatrix,u=a.nodesNamePrefix,z=a.shapesNamePrefix,B=function(g,u,v,y){var u=u?u+"/"+g:g,g=Sa.create({name:g,local:this.matrix&&m.apply(l,this.matrix),dynamic:this.dynamic||v.dynamic||a.dynamic}),x,C=this.customgeometryinstances;if(C&&r)for(var J in C)if(C.hasOwnProperty(J)){var t=r.call(k,C[J],a);t&&g.addRenderable(t)}if(J=this.geometryinstances)for(var w in J)if(J.hasOwnProperty(w)){var C=J[w],A=C.geometry;
x=z?z+"-"+A:A;(t=k.shapes[x])||(t=k.loadShape(x,A,a));if(c){x=C.material;if(y&&b.skins&&(A=b.skins[y]))(A=A[x])&&(x=A);A=q[x];if(!A){D&&(A=D[x]);if(!A)return;q[x]=A;A.name=x;A.reference.subscribeDestroyed(k.onMaterialDestroyed)}x=A.effect;x||(A.loadTextures(d),x=A.effectName,delete A.effectName,(x=f.get(x))&&x.prepareMaterial(A));x=t.surfaces;t=Ja.create(t,x?x[C.surface]:t,A);g.addRenderable(t);C.disabled&&(t.disabled=!0)}else g.addRenderable(Ja.create(t,null,null))}this.camera&&h&&(g.camera=this.camera);
if((w=this.lightinstances)&&e)for(var Q in w)if(w.hasOwnProperty(Q)&&(J=w[Q],(C=i[J.light])&&!C.global))C=bd.create(C),g.addLightInstance(C),J.disabled&&(C.disabled=!0);this.reference&&alert("Found unresolved node reference during scene loading");if(this.kinematic||v.kinematic)g.kinematic=!0;if((this.disabled||v.disabled)&&!1!==j)g.disabled=!0;if(v=this.nodes)for(var V in v)v.hasOwnProperty(V)&&!g.findChild(V)&&(Q=B.call(v[V],V,u,g,this.skin||y))&&g.addChild(Q);return g},y=b.nodes,v=a.parentNode,
x={},J;for(J in y)if(y.hasOwnProperty(J)){var C=y[J],t=J,w=k.findNode(u?u+"/"+J:J);if(C=B.call(C,t,u,w||v||x,C.skin||a.materialSkin))if(v&&!w&&v.addChild(C),g?C.local?C.setLocalTransform(l.m43Mul(C.getLocalTransform(),g)):C.setLocalTransform(g):C.local||C.setLocalTransform(l.m43BuildIdentity()),j&&C.enableHierarchy(!1),w){if((t=w.local)&&C.local)C.local=l.m43Mul(C.local,t),w.setLocalTransform(C.local),delete C.local;if(w.children&&C.children)for(;C.children.length;)t=C.children[0],w.findChild(t.name)||
w.addChild(t),C.removeChild(t);for(var A in C)C.hasOwnProperty(A)&&(w[A]=C[A]);C=null}else v||this.addRootNode(C)}};W.prototype.loadAreas=function(a){var b=a.data,c=b.areas;if(c){var d=c.length;if(!(0>=d)){a.append||delete this.areas;var f=this.areas;f||(this.areas=f=[]);for(var a=a.nodesNamePrefix,g=this.md,h=this.planeNormalize,e=f.length,j=Number.MAX_VALUE,r=0;r<d;r+=1){var l=c[r],m=l.target;a&&(m=a+"/"+m);if(m=this.findNode(m)){for(var q=m.getWorldTransform(),i=q[0],k=q[1],D=q[2],u=q[3],z=q[4],
B=q[5],y=q[6],v=q[7],x=q[8],t=q[9],C=q[10],w=q[11],A=q=j,V=j,E=-j,K=-j,H=-j,N=l.portals,da=N.length,l=[],F,I,G,L,U,X,M=0;M<da;M+=1){var O=j,P=j,S=j,R=-j,W=-j,T=-j,Y=0,Z=0,ba=0;F=N[M];I=F.points;L=I.length;G=[];for(U=0;U<L;U+=1){X=I[U];var aa=X[0],ca=X[1],ea=X[2];X=i*aa+u*ca+y*ea+t;var fa=k*aa+z*ca+v*ea+C,aa=D*aa+B*ca+x*ea+w;X<O&&(O=X);fa<P&&(P=fa);aa<S&&(S=aa);X>R&&(R=X);fa>W&&(W=fa);aa>T&&(T=aa);Y+=X;Z+=fa;ba+=aa;G.push(g.v3Build(X,fa,aa))}O<q&&(q=O);P<A&&(A=P);S<V&&(V=S);R>E&&(E=R);W>K&&(K=W);T>
H&&(H=T);I=g.v3Cross(g.v3Sub(G[1],G[0]),g.v3Sub(G[2],G[0]));U=this.float32ArrayConstructor?new this.float32ArrayConstructor(6):Array(6);U[0]=O;U[1]=P;U[2]=S;U[3]=R;U[4]=W;U[5]=T;O=this.float32ArrayConstructor?new this.float32ArrayConstructor(3):Array(3);O[0]=Y/L;O[1]=Z/L;O[2]=ba/L;F={area:e+F.area,points:G,origin:O,extents:U,plane:h(I[0],I[1],I[2],g.v3Dot(I,G[0]))};l.push(F)}i=this.float32ArrayConstructor?new this.float32ArrayConstructor(6):Array(6);i[0]=q;i[1]=A;i[2]=V;i[3]=E;i[4]=K;i[5]=H;f.push({target:m,
portals:l,extents:i,externalNodes:null})}else e-=1}c=this.float32ArrayConstructor?this.float32ArrayConstructor:Array;b=b.bspnodes;d=b.length;f=[];f.length=d;this.bspNodes=f;for(a=0;a<d;a+=1)g=b[a],h=g.plane,e=new c(4),e[0]=h[0],e[1]=h[1],e[2]=h[2],e[3]=-h[3],f[a]={plane:e,pos:g.pos,neg:g.neg}}}};W.prototype.load=function(a){var b=this;a.append||(this.clearShapes(),this.semantics={});var c=function(){a.keepLights&&b.loadLights(a);b.loadNodes(a);a.physicsManager&&a.physicsManager.loadNodes(a,b);b.loadAreas(a);
b.endLoading(a.onload)};a.graphicsDevice&&this.loadMaterials(a);b.loadSkeletons(a);var d=a.yieldFn;d?d(function(){b.streamShapes(a,c)}):c()};W.prototype.planeNormalize=function(a,b,c,d,f){f||(f=(f=W.prototype.float32ArrayConstructor)?new f(4):Array(4));var g=a*a+b*b+c*c;0<g?(g=1/Math.sqrt(g),f[0]=a*g,f[1]=b*g,f[2]=c*g,f[3]=d*g):(f[0]=0,f[1]=0,f[2]=0,f[3]=0);return f};W.prototype.isInsidePlanesAABB=function(a,b){var c=a[0],d=a[1],f=a[2],g=a[3],h=a[4],e=a[5],j=b.length,r=0;do{var l=b[r],m=l[0],q=l[1],
i=l[2];if(m*(0>m?c:g)+q*(0>q?d:h)+i*(0>i?f:e)<l[3])return!1;r+=1}while(r<j);return!0};W.prototype.isFullyInsidePlanesAABB=function(a,b){var c=a[0],d=a[1],f=a[2],g=a[3],h=a[4],e=a[5],j=b.length,r=0;do{var l=b[r],m=l[0],q=l[1],i=l[2];if(m*(0<m?c:g)+q*(0<q?d:h)+i*(0<i?f:e)<l[3])return!1;r+=1}while(r<j);return!0};W.prototype.extractFrustumPlanes=function(a){var b=this.planeNormalize,c=a.viewProjectionMatrix,a=c[0],d=c[1],f=c[2],g=c[3],h=c[4],e=c[5],j=c[6],r=c[7],l=c[8],m=c[9],q=c[10],i=c[11],k=c[12],
D=c[13],u=c[14],c=c[15],z=this.frustumPlanes;z[0]=b(g+a,r+h,i+l,-(c+k),z[0]);z[1]=b(g-a,r-h,i-l,-(c-k),z[1]);z[2]=b(g-d,r-e,i-m,-(c-D),z[2]);z[3]=b(g+d,r+e,i+m,-(c+D),z[3]);this.areas?4<z.length&&(z.length=4):z[4]=b(g-f,r-j,i-q,-(c-u),z[4]);this.nearPlane=b(g+f,r+j,i+q,-(c+u),this.nearPlane);return z};W.prototype.calculateHullScreenExtents=function(a,b){for(var c=1,d=-1,f=1,g=-1,h=a.length,e=0;e<h;e+=1){for(var j=a[e],r,l,m,q,i,k=0;2>k;k+=1)for(var D=0;3>D;D+=1){r=j.length;if(!r)break;i=[];for(l=
0;l<r;l+=1){m=1>l?j[r-1]:j[l-1];q=j[l];a:{var u=i,z=m[D],B=q[D],y=m[3],v=q[3],x=0,t=!0;if(k)if(z>y)if(B<=v)B<v&&(x=(y-z)/(B-z-(v-y)));else break a;else B>v&&(z<y&&(x=(y-z)/(B-z-(v-y))),t=!1);else if(z<-y)if(B>=-v)B>-v&&(x=(-y-z)/(B-z+(v-y)));else break a;else B<-v&&(z>-y&&(x=(-y-z)/(B-z+(v-y))),t=!1);0<x&&(z=m[0],B=m[1],m=m[2],u.push([z+x*(q[0]-z),B+x*(q[1]-B),m+x*(q[2]-m),y+x*(v-y)]));t&&u.push(q)}}j=i}r=j.length;for(l=0;l<r;l+=1)m=j[l],i=m[0],k=m[1],m=m[3],0===m?(i=0<=i?1:-1,k=0<=k?1:-1):(m=1/m,
i*=m,k*=m),c>i&&(c=i),d<i&&(d=i),f>k&&(f=k),g<k&&(g=k)}if(!(c>=d||f>=g))return-1>c&&(c=-1),1<d&&(d=1),-1>f&&(f=-1),1<g&&(g=1),b||(b=this.float32ArrayConstructor?new this.float32ArrayConstructor(4):Array(4)),b[0]=c,b[1]=f,b[2]=d,b[3]=g,b};W.prototype.calculateLightsScreenExtents=function(a){var b=this.visibleLights,c=b.length;if(0<c){var d,f,g,h,e,j,r,l,m,q,i,k,D,u,z,B=a.viewProjectionMatrix,y=this.calculateHullScreenExtents,v=this.md,x=v.m44Transform,t=v.m43MulM44,C=v.v4Build,w=C.call(v,-1,-1,1,1),
A=C.call(v,1,-1,1,1),V=C.call(v,-1,1,1,1),E=C.call(v,1,1,1,1),K=0;do{a=b[K];if(h=a.light){if(h.global)continue;d=a.node.world;h.spot?(f=v.m33MulM43(h.frustum,d,f),z=t.call(v,f,B,z),j=x.call(v,z,w,j),r=x.call(v,z,A,r),l=x.call(v,z,V,l),m=x.call(v,z,E,m),u=C.call(v,d[9],d[10],d[11],1,u),u=x.call(v,B,u,u),d=[[u,j,r],[u,r,m],[u,l,j],[u,m,l],[l,m,r,j]]):(g=h.halfExtents,h.fog||(h=h.center)&&(d=f=v.m43Offset(d,h,f)),h=g[0],e=g[1],g=g[2],z=t.call(v,d,B,z),j=x.call(v,z,C.call(v,-h,-e,-g,1,j),j),r=x.call(v,
z,C.call(v,+h,-e,-g,1,r),r),l=x.call(v,z,C.call(v,+h,-e,+g,1,l),l),m=x.call(v,z,C.call(v,-h,-e,+g,1,m),m),q=x.call(v,z,C.call(v,-h,+e,-g,1,q),q),i=x.call(v,z,C.call(v,+h,+e,-g,1,i),i),k=x.call(v,z,C.call(v,+h,+e,+g,1,k),k),D=x.call(v,z,C.call(v,-h,+e,+g,1,D),D),d=[[m,l,r,j],[q,i,k,D],[j,r,i,q],[D,k,l,m],[q,D,m,j],[r,l,k,i]]);a.screenExtents=y(d,a.screenExtents)}K+=1}while(K<c)}};W.prototype.destroy=function(){this.clear();this.vertexBufferManager&&(this.vertexBufferManager.destroy(),delete this.vertexBufferManager);
this.indexBufferManager&&(this.indexBufferManager.destroy(),delete this.indexBufferManager)};W.prototype.getQueryCounter=function(){var a=this.queryCounter;this.queryCounter=a+1;return a};W.create=function(a,b,c){return new W(a,b,c)};W.version=1;var Gd,Hd;"undefined"!==typeof Uint16Array&&(Gd=new Uint16Array(4),Hd=Object.prototype.toString.call(Gd),"[object Uint16Array]"===Hd&&(W.prototype.uint16ArrayConstructor=Uint16Array));"undefined"!==typeof Uint32Array&&(Gd=new Uint32Array(4),Hd=Object.prototype.toString.call(Gd),
"[object Uint32Array]"===Hd&&(W.prototype.uint32ArrayConstructor=Uint32Array));"undefined"!==typeof Float32Array&&(Gd=new Float32Array(4),Hd=Object.prototype.toString.call(Gd),"[object Float32Array]"===Hd&&(W.prototype.float32ArrayConstructor=Float32Array));W.prototype.getMaterialName=function(a){function b(a,b){for(var c in d)d.hasOwnProperty(c)&&a===d[c]&&b.push(c)}var c=[],d=this.materials,f=a.sharedMaterial;f&&b(f,c);var g=a.renderables;if(g)for(var h=g.length,e=0;e<h;e+=1)f=g[e].sharedMaterial,
b(f,c);if(a=a.lightInstances){g=a.length;for(h=0;h<g;h+=1)f=a[h].material,b(f,c)}if(c.length)return 1===c.length?c[0]:c};W.prototype.findLightName=function(a){var b=this.lights,c;for(c in b)if(b.hasOwnProperty(c)&&a===b[c])return c};W.prototype.writeBox=function(a,b,c,d,f){var g=b[0],h=b[1],e=b[2],j=b[3],r=b[4],b=b[5];a(g,h,e,c,d,f);a(g,h,b,c,d,f);a(g,h,e,c,d,f);a(g,r,e,c,d,f);a(g,h,e,c,d,f);a(j,h,e,c,d,f);a(j,r,b,c,d,f);a(j,r,e,c,d,f);a(j,r,b,c,d,f);a(j,h,b,c,d,f);a(j,r,b,c,d,f);a(g,r,b,c,d,f);a(g,
r,b,c,d,f);a(g,r,e,c,d,f);a(g,r,b,c,d,f);a(g,h,b,c,d,f);a(j,r,e,c,d,f);a(g,r,e,c,d,f);a(j,r,e,c,d,f);a(j,h,e,c,d,f);a(j,h,b,c,d,f);a(g,h,b,c,d,f);a(j,h,b,c,d,f);a(j,h,e,c,d,f)};W.prototype.writeRotatedBox=function(a,b,c,d,f,g){var h=b[9],e=b[10],j=b[11],r=c[0],l=c[1],m=c[2],q=b[0]*r,c=b[1]*r,r=b[2]*r,i=b[3]*l,k=b[4]*l,l=b[5]*l,D=b[6]*m,u=b[7]*m,z=b[8]*m,b=h-q-i-D,m=e-c-k-u,B=j-r-l-z,y=h+q-i-D,v=e+c-k-u,x=j+r-l-z,t=h+q-i+D,C=e+c-k+u,w=j+r-l+z,A=h-q-i+D,V=e-c-k+u,E=j-r-l+z,K=h-q+i-D,H=e-c+k-u,N=j-r+
l-z,da=h+q+i-D,F=e+c+k-u,I=j+r+l-z,G=h+q+i+D,L=e+c+k+u,U=j+r+l+z,h=h-q+i+D,e=e-c+k+u,j=j-r+l+z;a(b,m,B,d,f,g);a(y,v,x,d,f,g);a(y,v,x,d,f,g);a(t,C,w,d,f,g);a(t,C,w,d,f,g);a(A,V,E,d,f,g);a(A,V,E,d,f,g);a(b,m,B,d,f,g);a(b,m,B,d,f,g);a(K,H,N,d,f,g);a(y,v,x,d,f,g);a(da,F,I,d,f,g);a(t,C,w,d,f,g);a(G,L,U,d,f,g);a(A,V,E,d,f,g);a(h,e,j,d,f,g);a(K,H,N,d,f,g);a(da,F,I,d,f,g);a(da,F,I,d,f,g);a(G,L,U,d,f,g);a(G,L,U,d,f,g);a(h,e,j,d,f,g);a(h,e,j,d,f,g);a(K,H,N,d,f,g)};W.prototype.drawLights=function(a,b,c){var d=
this.visibleNodes,f=d.length;if(0<f){var g,h,e,j,r,l,m=0,q=0,i=0,k=0;do{g=d[k];if(h=g.lightInstances){e=h.length;for(l=0;l<e;l+=1)j=h[l],(r=j.light)&&(r.global?k+=1:r.spot?m+=1:r.fog?i+=1:q+=1)}k+=1}while(k<f);if(!(0===q&&0===m&&0===i)&&(g=b.load("shaders/debug.cgfx").getTechnique("debug_lines")))if(a.setTechnique(g),(g=this.debugLinesTechniqueParameters)?g.worldViewProjection=c.viewProjectionMatrix:this.debugLinesTechniqueParameters=g=a.createTechniqueParameters({worldViewProjection:c.viewProjectionMatrix}),
a.setTechniqueParameters(g),g=this.getDebugSemanticsPosCol(),h=a.VERTEXFORMAT_FLOAT3,m=a.beginDraw(a.PRIMITIVE_LINES,24*q+16*m+24*i,[h,h],g)){var q=this.md,D,k=0;do{g=d[k];if(h=g.lightInstances){e=h.length;for(l=0;l<e;l+=1)if(j=h[l],r=j.light)if(r.global)k+=1;else if(j=g.world,b=r.color,i=b[0],c=b[1],b=b[2],r.spot){var u=q.m33MulM43(r.frustum,j);r=q.m43TransformPoint(u,q.v3Build(-1,-1,1));D=q.m43TransformPoint(u,q.v3Build(1,-1,1));var z=q.m43TransformPoint(u,q.v3Build(-1,1,1)),u=q.m43TransformPoint(u,
q.v3Build(1,1,1));j=q.m43Pos(j);m(j,i,c,b);m(r,i,c,b);m(j,i,c,b);m(D,i,c,b);m(j,i,c,b);m(z,i,c,b);m(j,i,c,b);m(u,i,c,b);m(r,i,c,b);m(D,i,c,b);m(D,i,c,b);m(u,i,c,b);m(u,i,c,b);m(z,i,c,b);m(z,i,c,b);m(r,i,c,b)}else r.fog?D=r.halfExtents:(D=r.halfExtents,(r=r.center)&&(j=q.m43Offset(j,r))),this.writeRotatedBox(m,j,D,i,c,b)}k+=1}while(k<f);a.endDraw(m)}}};W.prototype.drawLightsExtents=function(a,b,c){var d=this.visibleLights,f=d.length;if(0<f){var g,h,e=0,j=0;do{g=d[j];if(h=g.light){if(h.global){j+=1;
continue}e+=1}j+=1}while(j<f);if(0!==e&&(j=b.load("shaders/debug.cgfx").getTechnique("debug_lines")))if(a.setTechnique(j),(j=this.debugLinesTechniqueParameters)?j.worldViewProjection=c.viewProjectionMatrix:this.debugLinesTechniqueParameters=j=a.createTechniqueParameters({worldViewProjection:c.viewProjectionMatrix}),a.setTechniqueParameters(j),j=this.getDebugSemanticsPosCol(),e=a.beginDraw(a.PRIMITIVE_LINES,24*e,[a.VERTEXFORMAT_FLOAT3,a.VERTEXFORMAT_FLOAT3],j)){var c=this.writeBox,r,j=0;do{g=d[j];
if(h=g.light){if(h.global){j+=1;continue}if(g=g.getWorldExtents())r=h.color,h=r[0],b=r[1],r=r[2],c(e,g,h,b,r)}j+=1}while(j<f);a.endDraw(e)}}};W.prototype.drawLightsScreenExtents=function(a,b){var c=this.visibleLights,d=c.length;if(0<d){var f,g,h=0,e=0;do{f=c[e];if(g=f.light){if(g.global){e+=1;continue}f.screenExtents&&(h+=1)}e+=1}while(e<d);if(0!==h&&(e=b.load("shaders/generic2D.cgfx").getTechnique("vertexColor2D")))if(a.setTechnique(e),e.clipSpace=this.md.v4Build(1,1,0,0),e=this.getDebugSemanticsPosCol(),
h=a.beginDraw(a.PRIMITIVE_LINES,8*h,[a.VERTEXFORMAT_FLOAT2,a.VERTEXFORMAT_FLOAT3],e)){var j,r,l,m,i,e=0;do{f=c[e];if(g=f.light){if(g.global){e+=1;continue}if(j=f.screenExtents)f=j[0],l=j[1],r=j[2],j=j[3],m=g.color,g=m[0],i=m[1],m=m[2],h(f,l,g,i,m),h(f,j,g,i,m),h(f,j,g,i,m),h(r,j,g,i,m),h(r,j,g,i,m),h(r,l,g,i,m),h(r,l,g,i,m),h(f,l,g,i,m)}e+=1}while(e<d);a.endDraw(h)}}};W.prototype.drawAreas=function(a,b,c){var d=this.areas;if(d){var f=b.load("shaders/debug.cgfx").getTechnique("debug_lines");if(f){var g=
this.isInsidePlanesAABB,h=this.frustumPlanes,b=[],e=0,j,r,l=this.cameraAreaIndex;if(0<=l){b[e]=l;e+=1;j=this.visiblePortals;l=j.length;for(r=0;r<l;r+=1)b[e]=j[r].area,e+=1}else{l=d.length;for(r=0;r<l;r+=1)j=d[r],g(j.extents,h)&&(b[e]=r,e+=1)}if(e&&(a.setTechnique(f),(r=this.debugLinesTechniqueParameters)?r.worldViewProjection=c.viewProjectionMatrix:this.debugLinesTechniqueParameters=r=a.createTechniqueParameters({worldViewProjection:c.viewProjectionMatrix}),a.setTechniqueParameters(r),r=this.getDebugSemanticsPosCol(),
j=a.VERTEXFORMAT_FLOAT3,c=a.beginDraw(a.PRIMITIVE_LINES,24*e,[j,j],r))){f=this.writeBox;for(r=0;r<e;r+=1)l=b[r],j=d[l],l%=3,0===l?(l=1,h=g=0):1===l?(l=0,g=1,h=0):(g=l=0,h=1),f(c,j.extents,l,g,h);a.endDraw(c)}}}};W.prototype.drawPortals=function(a,b,c){var d=this.areas;if(d){var f,g,h,e,j,r,l,m=[];l=d.length;for(h=f=0;h<l;h+=1){g=d[h];e=g.portals;j=e.length;for(r=0;r<j;r+=1)g=e[r],m.push(g),f+=2*g.points.length}if(f&&(b=b.load("shaders/debug.cgfx").getTechnique("debug_lines_constant"))){a.setTechnique(b);
d=this.md;b.worldViewProjection=c.viewProjectionMatrix;b.constantColor=d.v4Build(1,1,1,1);c=this.getDebugSemanticsPos();if(f=a.beginDraw(a.PRIMITIVE_LINES,f,[a.VERTEXFORMAT_FLOAT3],c)){var i=m.length;for(h=0;h<i;h+=1){g=m[h];g=g.points;l=g.length;for(e=0;e<l;e+=1)j=0<e?g[e-1]:g[l-1],r=g[e],f(j[0],j[1],j[2]),f(r[0],r[1],r[2])}a.endDraw(f)}m=this.visiblePortals;i=m.length;for(h=f=0;h<i;h+=1)g=m[h].portal,f+=2*g.points.length;if(f&&(b.constantColor=d.v4Build(1,1,0,1),f=a.beginDraw(a.PRIMITIVE_LINES,
f,[a.VERTEXFORMAT_FLOAT3],c))){for(h=0;h<i;h+=1){g=m[h].portal;g=g.points;l=g.length;for(e=0;e<l;e+=1)j=0<e?g[e-1]:g[l-1],r=g[e],f(j[0],j[1],j[2]),f(r[0],r[1],r[2])}a.endDraw(f)}}}};W.prototype.drawTransforms=function(a,b,c,d){var f=this.visibleNodes,g=f.length;if(g){var h;if(h=6*(g+1))if(b=b.load("shaders/debug.cgfx").getTechnique("debug_lines"))if(a.setTechnique(b),(b=this.debugLinesTechniqueParameters)?b.worldViewProjection=c.viewProjectionMatrix:this.debugLinesTechniqueParameters=b=a.createTechniqueParameters({worldViewProjection:c.viewProjectionMatrix}),
a.setTechniqueParameters(b),c=this.getDebugSemanticsPosCol(),c=a.beginDraw(a.PRIMITIVE_LINES,h,[a.VERTEXFORMAT_FLOAT3,a.VERTEXFORMAT_FLOAT3],c)){for(h=0;h<g;h+=1){var b=f[h].world,e=b[9],j=b[10],r=b[11];c(e,j,r,1,0,0);c(e+b[0]*d,j+b[1]*d,r+b[2]*d,1,0,0);c(e,j,r,0,1,0);c(e+b[3]*d,j+b[4]*d,r+b[5]*d,0,1,0);c(e,j,r,0,0,1);c(e+b[6]*d,j+b[7]*d,r+b[8]*d,0,0,1)}c(0,0,0,0,0,0);c(d,0,0,1,0,0);c(0,0,0,0,0,0);c(0,d,0,0,1,0);c(0,0,0,0,0,0);c(0,0,d,0,0,1);a.endDraw(c)}}};W.prototype.drawAnimationHierarchy=function(a,
b,c,d,f,g,h,e,j){var r=g.bounds,l=2*f,m=0,i=0,p=0,k=1,D=0,u=0;e&&(m=e[0],i=e[1],p=e[2]);j&&(k=j[0],D=j[1],u=j[2]);r&&(l+=24);if(l&&(b=b.load("shaders/debug.cgfx").getTechnique("debug_lines")))if(a.setTechnique(b),(b=this.debugLinesTechniqueParameters)?b.worldViewProjection=c.viewProjectionMatrix:this.debugLinesTechniqueParameters=b=a.createTechniqueParameters({worldViewProjection:c.viewProjectionMatrix}),a.setTechniqueParameters(b),c=this.getDebugSemanticsPosCol(),l=a.beginDraw(a.PRIMITIVE_LINES,
l,[a.VERTEXFORMAT_FLOAT3,a.VERTEXFORMAT_FLOAT3],c)){var c=this.md,b=c.m43TransformPoint,e=c.m43FromRTS,j=c.m43FromQuatPos,z=c.quatPosBuild,B=c.m43Mul,y=c.m43Pos,d=d.parents;g.update();for(var v=g.output,g=g.outputChannels.scale,x=[],t,C,w=0;w<f;w+=1){var A=d[w];t=v[w];g?t=e.call(c,t.rotation,t.translation,t.scale,x[w]):(C=z.call(c,t.rotation,t.translation,C),t=j.call(c,C,x[w]));-1!==A&&(t=B.call(c,t,x[A],x[w]));x[w]=t;-1!==A&&(t=y.call(c,x[w]),A=y.call(c,x[A]),h&&(t=b.call(c,h,t),A=b.call(c,h,A)),
l(t,m,i,p),l(A,m,i,p))}r&&(f=r.center,r=r.halfExtent,h&&(f=c.v3Add(c.m43Pos(h),f)),h=c.v3Sub(f,r),r=c.v3Add(f,r),this.writeBox(l,[h[0],h[1],h[2],r[0],r[1],r[2]],k,D,u));a.endDraw(l)}};W.prototype.drawSceneNodeHierarchy=function(a,b,c){var d=function(a){var b=1;if(a=a.children)for(var c=a.length,f=0;f<c;f+=1)b+=d(a[f]);return b},f=function(a,b,c){var d=a.children;if(d)for(var g=d.length,h=0;h<g;h+=1){var e=d[h],n=c.m43Pos(a.world),i=c.m43Pos(e.world);b(n,0,0,0);b(i,0,0,0);f(e,b,c)}};if(this.rootNodes){for(var g=
0,h=this.rootNodes.length,e=0;e<h;e+=1)g+=d(this.rootNodes[e]);if(e=2*g)if(b=b.load("shaders/debug.cgfx").getTechnique("debug_lines"))if(a.setTechnique(b),(b=this.debugLinesTechniqueParameters)?b.worldViewProjection=c.viewProjectionMatrix:this.debugLinesTechniqueParameters=b=a.createTechniqueParameters({worldViewProjection:c.viewProjectionMatrix}),a.setTechniqueParameters(b),c=this.getDebugSemanticsPosCol(),c=a.beginDraw(a.PRIMITIVE_LINES,e,[a.VERTEXFORMAT_FLOAT3,a.VERTEXFORMAT_FLOAT3],c)){b=this.md;
for(e=0;e<h;e+=1)f(this.rootNodes[e],c,b);a.endDraw(c)}}};W.prototype.createGeoSphere=function(a,b){function c(b,c,d){var g=Math.sqrt(b*b+c*c+d*d),g=a/g;f[f.length]=b*g;f[f.length]=c*g;f[f.length]=d*g;return f.length/3-1}function d(a,b){var d=a<b,g=d?a:b,d=d?b:a,g=g.toString()+d.toString()+(g+d);if(h[g])return h[g];a*=3;b*=3;d=c(0.5*(f[a]+f[b]),0.5*(f[a+1]+f[b+1]),0.5*(f[a+2]+f[b+2]));return h[g]=d}var f=[],g=[],h={},g=(1+Math.sqrt(5))/2,b=!b?3:b;c(-1,g,0);c(1,g,0);c(-1,-g,0);c(1,-g,0);c(0,-1,g);
c(0,1,g);c(0,-1,-g);c(0,1,-g);c(g,0,-1);c(g,0,1);c(-g,0,-1);c(-g,0,1);for(var g=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e=0;e<b;e+=1){for(var j=[],r=0;r<g.length;r+=3){var l=g[r],m=g[r+1],i=g[r+2],k=d(l,m),s=d(m,i),D=d(i,l);j[j.length]=l;j[j.length]=k;j[j.length]=D;j[j.length]=m;j[j.length]=s;j[j.length]=k;j[j.length]=i;j[j.length]=D;j[j.length]=s;j[j.length]=k;j[j.length]=s;j[j.length]=D}g=j}return{indices:g,
vertices:f,minExtent:[-a,-a,-a],maxExtent:[a,a,a]}};W.prototype.createCylinder=function(a,b,c,d,f){for(var g=[],h=[],c=c/2,f=!f?10:f,e=2*Math.PI*(1/f),j=0.5*e,r=-c,l=-c,m=-c,i=0;i<=f;i+=1){var r=e*i,k=Math.cos(r),s=Math.sin(r),D=Math.cos(r+j),u=Math.sin(r+j),r=a*k,l=-c,m=a*s;g[g.length]=r;g[g.length]=l;g[g.length]=m;r=b*k;l=c;m=b*s;g[g.length]=r;g[g.length]=l;g[g.length]=m;r=a*D;l=-c;m=a*u;g[g.length]=r;g[g.length]=l;g[g.length]=m;r=b*D;l=c;m=b*u;g[g.length]=r;g[g.length]=l;g[g.length]=m}f*=4;for(i=
0;i!==f;i+=2)h[h.length]=i+2,h[h.length]=i,h[h.length]=i+1,h[h.length]=i+2,h[h.length]=i+1,h[h.length]=i+3;h[h.length]=0;h[h.length]=i;h[h.length]=i+1;h[h.length]=0;h[h.length]=i+1;h[h.length]=1;if(d){d=0;if(0!==a){r=0;g[g.length]=r;g[g.length]=-c;g[g.length]=0;d=g.length/3-1;for(i=0;i!==f;i+=2)h[h.length]=d,h[h.length]=i,h[h.length]=i+2;h[h.length]=d;h[h.length]=i;h[h.length]=0}if(0!==b){g[g.length]=r;g[g.length]=c;g[g.length]=0;d=g.length/3-1;for(i=0;i!==f;i+=2)h[h.length]=i+1,h[h.length]=d,h[h.length]=
i+3;h[h.length]=i+1;h[h.length]=d;h[h.length]=1}}a=Math.max(a,b);return{indices:h,vertices:g,minExtent:[-a,-c,-a],maxExtent:[a,c,a]}};W.prototype.createRoundedPrimitive=function(a,b,c,d,f){function g(g,h,e){i=k.length/3;var n=[0.5*(g?1:-1)*a,0.5*(h?1:-1)*b,0.5*(e?1:-1)*c],j=D/2/f,h=h?0:D/2,l;g&&e&&(l=0);!g&&e&&(l=1.5*D);g&&!e&&(l=D/2);!g&&!e&&(l=D);for(g=0;g<=f;g+=1)for(var r=g*j+h,e=d*Math.sin(r),r=d*Math.cos(r),m=0;m<=f;m+=1){var u=m*j+l,v=e*Math.sin(u),u=e*Math.cos(u);k[k.length]=v+n[0];k[k.length]=
r+n[1];k[k.length]=u+n[2];g!==f&&m!==f&&(s[s.length]=i+f+2,s[s.length]=i,s[s.length]=i+f+1,s[s.length]=i+f+2,s[s.length]=i+1,s[s.length]=i);i+=1}}function h(g,h,e){var n=j.v3BuildXAxis(n),v=j.v3BuildYAxis(v),x=j.v3BuildZAxis(x),y,D=B.call(j,n,0.5*g*a),t=B.call(j,v,0.5*h*b),C=B.call(j,x,0.5*e*c),w=z.call(j,D,t,C),D=B.call(j,n,1-Math.abs(g)),t=B.call(j,v,1-Math.abs(h)),C=B.call(j,x,1-Math.abs(e)),n=z.call(j,D,t,C),v=j.v3Build(n[1],n[2],n[0]),x=j.v3Build(n[2],n[0],n[1]);i=k.length/3;0>j.v3Dot(v,w)&&
(v=j.v3Neg(v,v));0>j.v3Dot(x,w)&&(x=j.v3Neg(x,x));var J=j.v3Cross(v,n);0>j.v3Dot(J,x)&&(n=j.v3Neg(n,n));var A=(1-Math.abs(g))*a+(1-Math.abs(h))*b+(1-Math.abs(e))*c,w=j.v3Sub(w,j.v3ScalarMul(n,0.5*A)),J=1,E=Math.PI/2/f,A=A/J;0===g?J=r:0===h?J=l:0===e&&(J=m);for(g=0;g<=J;g+=1)for(h=0;h<=f;h+=1){var e=d*Math.cos(h*E),H=d*Math.sin(h*E);B.call(j,v,e,D);B.call(j,n,g*A,t);B.call(j,x,H,C);y=u.call(j,D,t,C,w,y);k[k.length]=y[0];k[k.length]=y[1];k[k.length]=y[2];g!==J&&h!==f&&(s[s.length]=i+f+2,s[s.length]=
i,s[s.length]=i+f+1,s[s.length]=i+f+2,s[s.length]=i+1,s[s.length]=i);i+=1}}function e(a,b,c,d,f,g){i=k.length/3;var h=j.v3Cross(f,j.v3BuildXAxis());1E-7>j.v3LengthSq(h)&&j.v3Cross(f,j.v3BuildYAxis(),h);j.v3Normalize(h,h);for(var n=j.v3Cross(f,h),l=B.call(j,h,c/a),r=B.call(j,n,d/b),c=j.v3Sub(B.call(j,h,-0.5*c),B.call(j,n,0.5*d)),d=0;d<=a;d+=1)for(h=0;h<=b;h+=1){var m=u.call(j,c,B.call(j,l,d),B.call(j,r,h),g,m);k[k.length]=m[0];k[k.length]=m[1];k[k.length]=m[2]}g=!1;l=j.v3Cross(l,r);0<j.v3Dot(l,f)&&
(g=!0);for(f=0;f<a;f+=1){for(l=0;l<b;l+=1)g?(s[s.length]=i,s[s.length]=i+b+1,s[s.length]=i+1,s[s.length]=i+1,s[s.length]=i+b+1,s[s.length]=i+b+1+1):(s[s.length]=i,s[s.length]=i+1,s[s.length]=i+b+1,s[s.length]=i+1,s[s.length]=i+b+1+1,s[s.length]=i+b+1),i+=1;i+=1}}var j=this.md,r=1,l=1,m=1,a=0===a?1E-4:a,b=0===b?1E-4:b,c=0===c?1E-4:c,f=!f?8:f,i=0,k=[],s=[],D=Math.PI,u=j.v3Add4,z=j.v3Add3,B=j.v3ScalarMul,y=0.5*a+d,v=0.5*b+d,x=0.5*c+d,t=j.v3Neg(j.v3BuildZAxis(),t),C=B.call(j,t,x);e(l,r,b,a,t,C);t=j.v3BuildZAxis(t);
B.call(j,t,x,C);e(l,r,b,a,t,C);j.v3Neg(j.v3BuildYAxis(t),t);B.call(j,t,v,C);e(m,r,c,a,t,C);j.v3BuildYAxis(t);B.call(j,t,v,C);e(m,r,c,a,t,C);j.v3Neg(j.v3BuildXAxis(t),t);B.call(j,t,y,C);e(m,l,c,b,t,C);j.v3BuildXAxis(t);B.call(j,t,y,C);e(m,l,c,b,t,C);g(!0,!0,!0);g(!0,!0,!1);g(!0,!1,!0);g(!0,!1,!1);g(!1,!0,!0);g(!1,!0,!1);g(!1,!1,!0);g(!1,!1,!1);h(-1,-1,0);h(-1,1,0);h(1,-1,0);h(1,1,0);h(-1,0,-1);h(-1,0,1);h(1,0,-1);h(1,0,1);h(0,-1,-1);h(0,-1,1);h(0,1,-1);h(0,1,1);return{indices:s,vertices:k,minExtent:[-y,
-v,-x],maxExtent:[y,v,x]}};W.prototype.createBox=function(a){var b=a[0],c=a[1],a=a[2];return{indices:[2,0,1,3,0,2,6,4,5,7,4,6,10,8,9,11,8,10,14,12,13,15,12,14,18,16,17,19,16,18,22,20,21,23,20,22],vertices:[-b,-c,a,b,-c,a,b,c,a,-b,c,a,-b,c,a,b,c,a,b,c,-a,-b,c,-a,-b,c,-a,b,c,-a,b,-c,-a,-b,-c,-a,-b,-c,-a,b,-c,-a,b,-c,a,-b,-c,a,b,-c,a,b,-c,-a,b,c,-a,b,c,a,-b,-c,-a,-b,-c,a,-b,c,a,-b,c,-a],minExtent:[-b,-c,-a],maxExtent:[b,c,a]}};W.prototype.createConvexHull=function(a,b,c){function d(c,d){var i=h.v3Add,
q=h.v3Add3,B=a.rayTest,y=h.v3Sub,v=h.m43InverseOrthonormal,x=h.m43TransformPoint,t=h.m43TransformVector,C=[];C[0]=h.v3BuildXAxis();C[1]=h.v3BuildYAxis();C[2]=h.v3BuildZAxis();var w=y.call(h,h.v3Mul(r,C[(c+1)%3]),h.v3Mul(l,C[(c+1)%3])),A=y.call(h,h.v3Mul(r,C[(c+2)%3]),h.v3Mul(l,C[(c+2)%3])),y=y.call(h,h.v3Mul(r,C[c]),h.v3Mul(l,C[c])),V=i.call(h,h.v3Mul(r,C[c]),h.v3Mul(l,C[c]));if(d)var E=y,y=V,V=E;for(var E=h.v3ScalarMul(h.v3ScalarMul(h.v3Mul(l,C[(c+1)%3]),2),1/m),C=h.v3ScalarMul(h.v3ScalarMul(h.v3Mul(l,
C[(c+2)%3]),2),1/m),K=0;K<m;K+=1)for(var H=0;H<m;H+=1){var N=i.call(h,w,h.v3ScalarMul(E,K)),F=i.call(h,A,h.v3ScalarMul(C,H)),I=q.call(h,N,F,V,I),G=q.call(h,N,F,y,G);if((F=B.call(a,{from:I,to:G}))&&(F.body===b||F.collisionObject===b)){var N=F.hitPoint,L=F.hitNormal,F=v.call(h,j);x.call(h,F,N,N);t.call(h,F,L,L);var F=N,N=L,M=h.v3Add4,U=h.v3ScalarMul;e=f.length/3;var X=h.v3Cross(N,h.v3BuildXAxis());1E-7>h.v3LengthSq(X)&&h.v3Cross(N,h.v3BuildYAxis(),X);h.v3Normalize(X,X);for(var O=h.v3Cross(N,X),L=h.v3ScalarMul(X,
k),P=h.v3ScalarMul(O,k),X=h.v3Sub(h.v3ScalarMul(X,-0.5*k),h.v3ScalarMul(O,0.5*k)),O=0;2>O;O+=1)for(var S=0;2>S;S+=1){var R=M.call(h,X,U.call(h,L,O),U.call(h,P,S),F,R);f[f.length]=R[0];f[f.length]=R[1];f[f.length]=R[2]}F=!1;L=h.v3Cross(L,P);0<h.v3Dot(L,N)&&(F=!0);F?(g[g.length]=e,g[g.length]=e+2,g[g.length]=e+1,g[g.length]=e+1,g[g.length]=e+2,g[g.length]=e+3):(g[g.length]=e,g[g.length]=e+1,g[g.length]=e+2,g[g.length]=e+1,g[g.length]=e+3,g[g.length]=e+2)}}}if(TurbulenzEngine.canvas)return b.shape._private.triangleArray;
var f=[],g=[],h=this.md,e=0,j=b.transform,r=h.m43Pos(j),l=b.shape.halfExtents,m=Math.ceil(Math.sqrt(c)),i=l[0],i=l[1]>i?l[1]:i,i=l[1]>i?l[2]:i,k=i/c*(c/5);d(0,!1);d(0,!0);d(1,!1);d(1,!0);d(2,!1);d(2,!0);return{indices:g,vertices:f}};W.prototype.drawPhysicsNodes=function(a,b,c,d){var f=b.load("shaders/debug.cgfx").getTechnique("debug_lines");if(f){var g=d.physicsNodes,h=this.frameIndex-1,e=this.isInsidePlanesAABB,j=this.frustumPlanes,r,l,m,i=this.float32ArrayConstructor?new this.float32ArrayConstructor(6):
Array(6),b=g.length,k=[];for(r=0;r<b;r+=1)l=g[r],m=l.target,m.frameVisible>=h?k[k.length]=l:(l.body.calculateExtents(i),e(i,j)&&(k[k.length]=l));if(b=k.length)if(a.setTechnique(f),(r=this.debugLinesTechniqueParameters)?r.worldViewProjection=c.viewProjectionMatrix:this.debugLinesTechniqueParameters=r=a.createTechniqueParameters({worldViewProjection:c.viewProjectionMatrix}),a.setTechniqueParameters(r),r=this.getDebugSemanticsPosCol(),l=a.VERTEXFORMAT_FLOAT3,c=a.beginDraw(a.PRIMITIVE_LINES,24*b,[l,l],
r)){d=d.mathsDevice.m43BuildIdentity();for(r=0;r<b;r+=1)l=k[r],m=l.target,g=m.disabled?0.2:1,l.kinematic?f=m=0:(l.dynamic?(m=0,f=g):(m=g,f=0),g=0),l=l.body,l.calculateTransform(d),this.writeRotatedBox(c,d,l.shape.halfExtents,m,f,g);a.endDraw(c)}}};W.prototype.drawPhysicsGeometry=function(a,b,c,d){if(b=b.load("shaders/debug.cgfx").getTechnique("physics_debug")){for(var f=this.md,g=a.VERTEXFORMAT_FLOAT3,h=[a.VERTEXFORMAT_FLOAT4,g,g],e=d.physicsNodes,j=this.frameIndex-1,r=this.isInsidePlanesAABB,l=this.frustumPlanes,
m,i,k,s,D=this.float32ArrayConstructor?new this.float32ArrayConstructor(6):Array(6),g=e.length,u=[],z,B=d.physicsDevice,y=d.dynamicsWorld,d=0;d<g;d+=1)if(m=e[d],k=!1,i=m.target,i.frameVisible>=j?k=!0:(m.body.calculateExtents(D),r(D,l)&&(k=!0)),k){u[u.length]=m;k=m.triangleArray;if(!k)if(i=m.body.shape,k=i.type,s=i.halfExtents,"SPHERE"===k?z=this.createGeoSphere(i.radius):"CYLINDER"===k?z=this.createCylinder(s[0],s[2],2*s[1],!0):"CONE"===k?z=this.createCylinder(s[0],0,2*s[1],!0):"CAPSULE"===k?z=this.createRoundedPrimitive(0,
2*(s[1]-s[0]),0,s[0]):"BOX"===k?z=this.createBox(s):"CONVEX_HULL"===k?z=this.createConvexHull(y,m.body,50):"TRIANGLE_MESH"===k&&(z=i.triangleArray),z&&0<z.vertices.length)k=z.triangles?z:B.createTriangleArray(z),m.triangleArray=k;else{u.pop();continue}i=m.positions;if(!i&&k){var v=k.vertices;if(TurbulenzEngine.canvas)i=v;else{var x=v.length;i=[];i.length=x;for(s=0;s<x;s+=1)i[s]=v[s]}m.positions=i;m.indices=k.indices}if(!m.wireframeBuffer&&i){k=m.indices;s=k.length;for(var v=this.float32ArrayConstructor?
new this.float32ArrayConstructor(10*s):Array(10*s),t=0,C,w,A,V,E,K,F,N,H,I=a.createVertexBuffer({numVertices:s,attributes:h}),x=0;x<s;x+=3)C=3*k[x],V=3*k[x+1],F=3*k[x+2],w=i[C],A=i[C+1],C=i[C+2],v[t]=w,v[t+1]=A,v[t+2]=C,v[t+3]=0,E=i[V],K=i[V+1],V=i[V+2],v[t+4]=E,v[t+5]=K,v[t+6]=V,N=i[F],H=i[F+1],F=i[F+2],v[t+7]=N,v[t+8]=H,v[t+9]=F,t+=10,v[t]=E,v[t+1]=K,v[t+2]=V,v[t+3]=1,v[t+4]=w,v[t+5]=A,v[t+6]=C,v[t+7]=N,v[t+8]=H,v[t+9]=F,t+=10,v[t]=N,v[t+1]=H,v[t+2]=F,v[t+3]=2,v[t+4]=w,v[t+5]=A,v[t+6]=C,v[t+7]=
E,v[t+8]=K,v[t+9]=V,t+=10;I.setData(v);m.wireframeBuffer=I}}if(g=u.length){z=f.v4Build;h=f.m43MulM44;a.setTechnique(b);b.windowScale=[a.width/2,a.height/2];b.wireColor=z.call(f,0,0.2,0.6,1);b.alphaRef=0;b.alpha=0.5;var G,L,e=f.m43BuildIdentity(),j=this.physicsWireframeSemantics;j||(this.physicsWireframeSemantics=j=a.createSemantics(["POSITION","TEXCOORD0","TEXCOORD1"]));for(d=0;d<g;d+=1)m=u[d],i=m.target,r=m.body,B=i.disabled?0.2:r.active?1:0.4,m.kinematic?D=l=0:(m.dynamic?(l=0,D=B):(l=B,D=0),B=0),
"CHARACTER"===r.type?k=i=y=0:(i=r.shape,"TRIANGLE_MESH"===i.type?(y=1,k=i=0):"CONVEX_HULL"===i.type?(i=y=0,k=1):(y=0,i=1,k=0)),y=0.5*(y+l),i=0.5*(i+D),k=0.5*(k+B),G=z.call(f,y,i,k,0,G),r.calculateTransform(e),L=h.call(f,e,c.viewProjectionMatrix,L),b.fillColor=G,b.worldViewProjection=L,m=m.wireframeBuffer,a.setStream(m,j),a.draw(a.PRIMITIVE_TRIANGLES,m.numVertices,0)}}};W.prototype.drawVisibleRenderablesExtents=function(a,b,c,d,f){var g=this.visibleRenderables,h=g.length;if(h){var e,j,r=[],l;for(e=
0;e<h;e+=1)if(j=g[e],l=j.getWorldExtents())j=j.sharedMaterial.meta,j.decal?d&&r.push(l):j.transparent?f&&r.push(l):!d&&!f&&r.push(l);if(g=r.length)if(e=b.load("shaders/debug.cgfx").getTechnique("debug_lines_constant"))if(d?(l=1,f=d=0):f?(d=l=0,f=1):(l=0,d=1,f=0),a.setTechnique(e),e=this.md,(b=this.debugLinesConstantTechniqueParameters)?(b.worldViewProjection=c.viewProjectionMatrix,b.constantColor=e.v4Build(l,d,f,1,b.constantColor)):this.debugLinesConstantTechniqueParameters=b=a.createTechniqueParameters({worldViewProjection:c.viewProjectionMatrix,
constantColor:e.v4Build(l,d,f,1)}),a.setTechniqueParameters(b),e=this.getDebugSemanticsPos(),c=a.beginDraw(a.PRIMITIVE_LINES,24*g,[a.VERTEXFORMAT_FLOAT3],e)){for(e=0;e<g;e+=1)l=r[e],d=l[0],f=l[1],b=l[2],h=l[3],j=l[4],l=l[5],c(d,f,b),c(d,f,l),c(d,f,b),c(d,j,b),c(d,f,b),c(h,f,b),c(h,j,l),c(h,j,b),c(h,j,l),c(h,f,l),c(h,j,l),c(d,j,l),c(d,j,l),c(d,j,b),c(d,j,l),c(d,f,l),c(h,j,b),c(d,j,b),c(h,j,b),c(h,f,b),c(h,f,l),c(d,f,l),c(h,f,l),c(h,f,b);a.endDraw(c)}}};W.prototype.drawOpaqueNodesExtents=function(a,
b,c){this.drawVisibleRenderablesExtents(a,b,c,!1,!1)};W.prototype.drawDecalNodesExtents=function(a,b,c){this.drawVisibleRenderablesExtents(a,b,c,!0,!1)};W.prototype.drawTransparentNodesExtents=function(a,b,c){this.drawVisibleRenderablesExtents(a,b,c,!1,!0)};W.prototype.drawStaticNodesTree=function(a,b,c,d){this.staticSpatialMap.getNodes?this.drawNodesTree(this.staticSpatialMap,a,b,c,d):this.staticSpatialMap.getCells&&this.drawCellsGrid(this.staticSpatialMap,a,b,c)};W.prototype.drawDynamicNodesTree=
function(a,b,c,d){this.dynamicSpatialMap.getNodes?this.drawNodesTree(this.dynamicSpatialMap,a,b,c,d):this.dynamicSpatialMap.getCells&&this.drawCellsGrid(this.dynamicSpatialMap,a,b,c)};W.prototype.drawNodesTree=function(a,b,c,d,f){function g(a,b,c,d){var f=b[c];if(0===d){var h=f.extents,b=h[0],d=h[1],e=h[2],i=h[3],k=h[4],h=h[5];a(b,d,e);a(b,d,h);a(b,d,e);a(b,k,e);a(b,d,e);a(i,d,e);a(i,k,h);a(i,k,e);a(i,k,h);a(i,d,h);a(i,k,h);a(b,k,h);a(b,k,h);a(b,k,e);a(b,k,h);a(b,d,h);a(i,k,e);a(b,k,e);a(i,k,e);a(i,
d,e);a(i,d,h);a(b,d,h);a(i,d,h);a(i,d,e);return c+f.escapeNodeOffset}if(f.isLeaf())return c+1;f=c+f.escapeNodeOffset;d-=1;c+=1;do c=g(a,b,c,d);while(c<f);return c}var h=a.getNodes();if(a.getEndNodeIndex()&&(a=c.load("shaders/debug.cgfx").getTechnique("debug_lines_constant")))if(b.setTechnique(a),a=this.md,c=this.debugLinesConstantTechniqueParameters,c||(this.debugLinesConstantTechniqueParameters=c=b.createTechniqueParameters({worldViewProjection:null,constantColor:null})),c.worldViewProjection=d.viewProjectionMatrix,
c.constantColor=a.v4Build(1,0,0,1),b.setTechniqueParameters(c),d=24*a.truncate(Math.pow(2,f)),a=this.getDebugSemanticsPos(),d=b.beginDraw(b.PRIMITIVE_LINES,d,[b.VERTEXFORMAT_FLOAT3],a))g(d,h,0,f),b.endDraw(d),d=null};W.prototype.drawCellsGrid=function(a,b,c,d){var f=c.load("shaders/debug.cgfx").getTechnique("debug_lines");if(f){var c=a.getCells(),g=c.length,h=0,e=0,j,r;for(j=0;j<g;j+=1)if(r=c[j])r=r.length,h<r&&(h=r),e+=1;if(e&&(b.setTechnique(f),(j=this.debugLinesTechniqueParameters)?j.worldViewProjection=
d.viewProjectionMatrix:this.debugLinesTechniqueParameters=j=b.createTechniqueParameters({worldViewProjection:d.viewProjectionMatrix}),b.setTechniqueParameters(j),j=this.getDebugSemanticsPosCol(),d=b.VERTEXFORMAT_FLOAT3,e=b.beginDraw(b.PRIMITIVE_LINES,24*e,[d,d],j))){d=a.getCellSize();r=a.getExtents();a=r[0];j=r[2];var g=r[5],f=Math.ceil((r[3]-a)/d),g=Math.ceil((g-j)/d),l=r.slice(0),m=this.writeBox,h=1/h,i,k;l[2]=j;l[5]=j+d;for(i=j=0;i<g;i+=1){l[0]=a;l[3]=a+d;for(k=0;k<f;k+=1)r=c[j],j+=1,r&&(r=r.length,
r=1===r?0:r*h,m(e,l,1,r,r)),l[0]=l[3],l[3]+=d;l[2]=l[5];l[5]+=d}b.endDraw(e)}}};W.prototype.updateNormals=function(a,b,c,d,f,g,h,e){for(var j,r,l,m,i=function(b,c){var d=a.createVertexBuffer({numVertices:b,attributes:[a.VERTEXFORMAT_FLOAT3],dynamic:!0}),f=$c.create();f.halfExtents=j;f.center=r;f.primitive=a.PRIMITIVE_LINES;f.semantics=a.createSemantics([a.SEMANTIC_POSITION]);f.vertexBuffer=d;f.numIndices=b;d=Ja.create(f,{first:0,numVertices:b,primitive:a.PRIMITIVE_LINES},c);l.addRenderable(d);return d},
k=function(a,b,c,d,f,g){var h,e,n,j,l,r,i,q=0,k=a.map();if(k){for(var p=0;p<f;p+=2)e=b[q+c+0],n=b[q+c+1],j=b[q+c+2],l=b[q+d+0],r=b[q+d+1],i=b[q+d+2],(h=l*l+r*r+i*i)?(h=1/h*g,l*=h,r*=h,i*=h):i=r=l=0,k(e,n,j),k(e+l,n+r,j+i),q+=m;a.unmap(k)}},s=this.rootNodes,D=s.length,u=0;u<D;u+=1)if(l=s[u],l.renderables)for(var z,t,y,v,x,w,C,A,Q,V,E=l.renderables.length,K=0;K<E;K+=1){var F=l.renderables[K];if(!F.isNormal){t=F.geometry;y=F.surface;j=t.halfExtents;v=t.vertexBuffer;x=0.01*(j[0]+j[1]+j[2]);if(F.normalsInfo)x=
F.normalsInfo,m=x.stride,t=x.positionOffset,y=x.vertexBufferData,z=x.normalsNumVerts,w=x.normalRenderable,A=x.tangentRenderable,V=x.binormalRenderable,v=x.normalOffset,C=x.tangentOffset,Q=x.binormalOffset,x=x.scale;else{z=y.indexBuffer?t.vertexBufferAllocation.length:y.numVertices;var N=t.semantics,H=N.length;z*=2;m=v.stride;y=y.vertexData;var I=v.attributes;r=t.center;t=Q=C=v=-1;V=A=w=null;for(var G=0,L,O,U=0;U<H;U+=1)L=N[U],O=I[U],a.SEMANTIC_POSITION===L?t=G:a.SEMANTIC_NORMAL===L?(w=i(z,d),w.normals=
!0,v=G):a.SEMANTIC_TANGENT===L?(A=i(z,g),A.tangents=!0,C=G):a.SEMANTIC_BINORMAL===L&&(V=i(z,e),V.binormal=!0,Q=G),L=this.attributeComponents(O),G+=L;F.normalsInfo={stride:m,positionOffset:t,vertexBufferData:y,normalsNumVerts:z,normalOffset:v,tangentOffset:C,binormalOffset:Q,normalRenderable:w,tangentRenderable:A,binormalRenderable:V,scale:x}}w&&(w.disabled=!c,c&&(w.setMaterial(d),k(w.geometry.vertexBuffer,y,t,v,z,b*x)));A&&(A.disabled=!f,f&&(A.setMaterial(g),k(A.geometry.vertexBuffer,y,t,C,z,b*x)));
V&&(V.disabled=!h,h&&(V.setMaterial(e),k(V.geometry.vertexBuffer,y,t,Q,z,b*x)))}}};W.prototype.attributeComponents=function(a){if(TurbulenzEngine.canvas)return a.numComponents;var b=this.vertexAttrToNumComponents;if(!b){var c=TurbulenzEngine.getGraphicsDevice(),b={};b[c.VERTEXFORMAT_BYTE4]=4;b[c.VERTEXFORMAT_BYTE4N]=4;b[c.VERTEXFORMAT_UBYTE4]=4;b[c.VERTEXFORMAT_UBYTE4N]=4;b[c.VERTEXFORMAT_SHORT4]=4;b[c.VERTEXFORMAT_SHORT4N]=4;b[c.VERTEXFORMAT_USHORT4]=4;b[c.VERTEXFORMAT_USHORT4N]=4;b[c.VERTEXFORMAT_FLOAT4]=
4;b[c.VERTEXFORMAT_SHORT2]=2;b[c.VERTEXFORMAT_SHORT2N]=2;b[c.VERTEXFORMAT_USHORT2]=2;b[c.VERTEXFORMAT_USHORT2N]=2;b[c.VERTEXFORMAT_FLOAT2]=2;b[c.VERTEXFORMAT_FLOAT1]=1;b[c.VERTEXFORMAT_FLOAT3]=3;this.vertexAttrToNumComponents=b}return b[a]};W.prototype.drawWireframe=function(a,b,c,d){var f=this.visibleNodes,g=f.length;if(g){var h=b.load("shaders/debug.cgfx"),b=h.getTechnique("wireframe"),h=h.getTechnique("wireframe_skinned");if(!b||!h)return!1;var e=this.md,j=a.setTechnique,r=a.setStream,l=a.draw,
m=e.m43MulM44,c=c.viewProjectionMatrix,i,k,s,D,u,z=a.VERTEXFORMAT_FLOAT4,t=a.VERTEXFORMAT_FLOAT3,y=a.VERTEXFORMAT_BYTE4,y=[z,t,t,y,z,y,z,y,z],z=[z,t,t],t=this.skinnedWireframeSemantics;t||(this.skinnedWireframeSemantics=t=a.createSemantics("POSITION TEXCOORD0 TEXCOORD1 BLENDINDICES BLENDWEIGHT TEXCOORD2 TEXCOORD3 TEXCOORD4 TEXCOORD5".split(" ")));var v=this.solidWireframeSemantics;v||(this.solidWireframeSemantics=v=a.createSemantics(["POSITION","TEXCOORD0","TEXCOORD1"]));for(var x=0;x<g;x+=1){var w=
f[x],C=w.renderables;if(C&&!w.disabled)for(var w=C.length,A=0;A<w;A+=1){var Q=C[A],V=Q.surface;if(!Q.disabled&&V&&V.vertexData&&(V.primitive===a.PRIMITIVE_TRIANGLES||V.primitive===a.PRIMITIVE_TRIANGLE_STRIP||V.primitive===a.PRIMITIVE_TRIANGLE_FAN)){var E=V.primitive;(s=Q.skinController)?(i!==h&&(i=h,j.call(a,h)),i.skinBones=s.output,D=y,s=t,u=34):(i!==b&&(i=b,j.call(a,b)),D=z,s=v,u=10);k=m.call(e,Q.node.world,c,k);i.worldViewProjection=k;i.windowScale=[a.width/2,a.height/2];d&&d.wireColor&&d.fillColor?
(i.wireColor=d.wireColor,i.fillColor=d.fillColor,i.alphaRef=d.alphaRef):(i.wireColor=e.v4Build(0,0,0,1),i.fillColor=e.v4Build(1,1,1,0),i.alphaRef=0.35);var K=V.wireframeBuffer;if(!K){for(var F=Q.geometry,N=F.vertexBuffer,H=F.semantics,Q=V.vertexData,K=V.indexBuffer,I=N.stride,G=0,L=0,O=0,U=!1,X=0;X<H.length;X+=1)if(H[X]!==a.SEMANTIC_POSITION)G+=W.prototype.attributeComponents(N.attributes[X]);else{U=!0;break}if(!1===U)return!1;if(i===h){U=!1;for(X=0;X<H.length;X+=1)if(H[X]!==a.SEMANTIC_BLENDINDICES)L+=
W.prototype.attributeComponents(N.attributes[X]);else{U=!0;break}if(!1===U)return!1;U=!1;for(X=0;X<H.length;X+=1)if(H[X]!==a.SEMANTIC_BLENDWEIGHT)O+=W.prototype.attributeComponents(N.attributes[X]);else{U=!0;break}if(!1===U)return!1}var M,S,H=[],U=0,P,R,T,Y,Z,aa,ba,ca;K?(M=V.indexData,F=M.length,S=3):E===a.PRIMITIVE_TRIANGLE_STRIP||E===a.PRIMITIVE_TRIANGLE_FAN?(G+=(V.first-F.vertexBufferAllocation.baseIndex)*I,X=V.numVertices-2,F=3*X,S=1):(G+=(V.first-F.vertexBufferAllocation.baseIndex)*I,F=V.numVertices,
S=3);D=a.createVertexBuffer({numVertices:F,attributes:D,dynamic:N.dynamic});H.length=F*u;for(X=0;X<F;X+=S)K?(P=M[X]*I+G,T=M[X+1]*I+G,aa=M[X+2]*I+G):(E===a.PRIMITIVE_TRIANGLE_STRIP?0===X%2?(P=X*I+G,T=(X+1)*I+G):(P=(X+1)*I+G,T=X*I+G):(P=E===a.PRIMITIVE_TRIANGLE_FAN?G:X*I+G,T=(X+1)*I+G),aa=(X+2)*I+G),N=Q[P],R=Q[P+1],P=Q[P+2],H[U]=N,H[U+1]=R,H[U+2]=P,H[U+3]=0,Y=Q[T],Z=Q[T+1],T=Q[T+2],H[U+4]=Y,H[U+5]=Z,H[U+6]=T,ba=Q[aa],ca=Q[aa+1],aa=Q[aa+2],H[U+7]=ba,H[U+8]=ca,H[U+9]=aa,U+=u,H[U]=Y,H[U+1]=Z,H[U+2]=T,
H[U+3]=1,H[U+4]=N,H[U+5]=R,H[U+6]=P,H[U+7]=ba,H[U+8]=ca,H[U+9]=aa,U+=u,H[U]=ba,H[U+1]=ca,H[U+2]=aa,H[U+3]=2,H[U+4]=N,H[U+5]=R,H[U+6]=P,H[U+7]=Y,H[U+8]=Z,H[U+9]=T,U+=u;if(i===h){T=[];ba=[];ca=[];for(X=U=0;X<F;X+=S){K?(N=M[X]*I+L,P=M[X+1]*I+L,Z=M[X+2]*I+L,R=M[X]*I+O,Y=M[X+1]*I+O,aa=M[X+2]*I+O):(E===a.PRIMITIVE_TRIANGLE_STRIP?0===X%2?(N=X*I+L,P=(X+1)*I+L,Z=(X+2)*I+L,R=X*I+O,Y=(X+1)*I+O):(N=(X+1)*I+L,P=X*I+L,Z=(X+2)*I+L,R=(X+1)*I+O,Y=X*I+O):(E===a.PRIMITIVE_TRIANGLE_FAN?(N=L,P=(X+1)*I+L,Z=(X+2)*I+L,R=
O):(N=X*I+L,P=(X+1)*I+L,Z=(X+2)*I+L,R=X*I+O),Y=(X+1)*I+O),aa=(X+2)*I+O);for(G=0;4>G;G+=1)T[G]=Q[N+G],T[G+4]=Q[R+G],ba[G]=Q[P+G],ba[G+4]=Q[Y+G],ca[G]=Q[Z+G],ca[G+4]=Q[aa+G];for(G=0;8>G;G+=1)H[U+10+G]=T[G],H[U+18+G]=ba[G],H[U+26+G]=ca[G];U+=u;for(G=0;8>G;G+=1)H[U+10+G]=ba[G],H[U+18+G]=T[G],H[U+26+G]=ca[G];U+=u;for(G=0;8>G;G+=1)H[U+10+G]=ca[G],H[U+18+G]=T[G],H[U+26+G]=ba[G];U+=u}}D.setData(H);K=V.wireframeBuffer=D}r.call(a,K,s);l.call(a,a.PRIMITIVE_TRIANGLES,K.numVertices,0)}}}}return!0};W.prototype.getMetrics=
function(){var a=0,b=0,c=0,d=0,f=this.globalLights.length,g=function(h){a+=1;var e=h.renderables,n=e?e.length:0;b+=n;var j=h.lightInstances;f+=j?j.length:0;for(var i,j=0;j<n;j+=1){var k=e[j].surface;c+=k.numVertices;i=k.indexBuffer?k.numIndices:k.numVertices;switch(k.primitive){case 0:d+=i;break;case 1:d+=i>>1;break;case 2:d+=i;break;case 3:d+=i-1;break;case 4:d+=i/3|0;break;case 5:d+=i-2;break;case 6:d+=i-2}}if(h=h.children){e=h.length;for(j=0;j<e;j+=1)g(h[j])}},h=this.rootNodes;if(h)for(var e=h.length,
j=0;j<e;j+=1)g(h[j]);return{numNodes:a,numRenderables:b,numLights:f,numVertices:c,numPrimitives:d}};W.prototype.getVisibilityMetrics=function(){var a=this.visiblePortals,b=a.length,c=0,d;for(d=0;d<b;d+=1)c+=a[d].planes.length;var a=this.visibleRenderables.length,f=0,g=0,h=this.visibleLights,e=h.length;for(d=0;d<e;d+=1){var j=h[d];j.numVisibleDrawParameters&&(a+=j.numVisibleDrawParameters);var r=j.shadowMap;r&&(j.frameVisible===r.frameVisible&&r.numRenderables)&&(f+=1,g+=r.numRenderables)}return{numPortals:b,
numPortalsPlanes:c,numLights:e,numRenderables:a,numShadowMaps:f,numOccluders:g}};W.prototype.getDebugSemanticsPosCol=function(){var a=this.debugSemanticsPosCol;a||(a=TurbulenzEngine.getGraphicsDevice(),this.debugSemanticsPosCol=a=a.createSemantics([a.SEMANTIC_POSITION,a.SEMANTIC_COLOR]));return a};W.prototype.getDebugSemanticsPos=function(){var a=this.debugSemanticsPos;a||(a=TurbulenzEngine.getGraphicsDevice(),this.debugSemanticsPos=a=a.createSemantics([a.SEMANTIC_POSITION]));return a};var lc=this.__extends||
function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype;a.prototype=new c},Aa=function(){};Aa.Translate=0;Aa.Rotate=1;Aa.Scale=2;Aa.Matrix=3;var ya=function(){this.draw=null;this.draw=this._drawShape};ya.prototype.addChild=function(a){var b=this._children;b?b.push(a):(this._children=[a],this.draw=this.draw===this._drawState?this._drawStateChildren:this._drawChildren)};ya.prototype.removeChild=function(a){var b=this._children;b&&(a=b.indexOf(a),
-1!==a&&(1===b.length?(this._children=null,this.draw=this.draw===this._drawStateChildren?this._drawState:this._drawShape):b.splice(a,1)))};ya.prototype.getNumChildren=function(){return this._children?this._children.length:0};ya.prototype.getChild=function(a){return this._children?this._children[a]:null};ya.prototype.setFillStyle=function(a){this._fill=a;this._checkState()};ya.prototype.getFillStyle=function(){return this._fill};ya.prototype.setStrokeStyle=function(a){this._stroke=a;this._checkState()};
ya.prototype.getStrokeStyle=function(){return this._stroke};ya.prototype.setLineWidth=function(a){this._lineWidth=a;this._checkState()};ya.prototype.getLineWidth=function(){return this._lineWidth};ya.prototype.translate=function(a,b){this._addTransform(Aa.Translate,[a,b])};ya.prototype.scale=function(a,b){this._addTransform(Aa.Scale,[a,b])};ya.prototype.rotate=function(a,b,c){this._addTransform(Aa.Rotate,[a,b,c])};ya.prototype.transform=function(a,b,c,d,f,g){this._addTransform(Aa.Matrix,[a,b,c,d,
f,g])};ya.prototype._addTransform=function(a,b){var c=this._transforms;if(c){var d=c.length,f=c[d-1],d=c[d-2],g=!1;d===Aa.Translate?a===Aa.Translate?(f[0]+=b[0],f[1]+=b[1]):g=!0:d===Aa.Scale?a===Aa.Scale?(f[0]*=b[0],f[1]*=b[1]):g=!0:d===Aa.Rotate?a===Aa.Rotate&&f[1]===b[1]&&f[2]===b[2]?f[0]+=b[0]:g=!0:d===Aa.Matrix&&(a===Aa.Translate?(f[4]+=f[0]*b[0]+f[2]*b[1],f[5]+=f[1]*b[0]+f[3]*b[1]):a===Aa.Scale?(f[0]*=b[0],f[1]*=b[0],f[2]*=b[1],f[3]*=b[1]):g=!0);g&&(c.push(a,b),7<c.length&&this._combineTransforms())}else this._transforms=
[a,b];this._checkState()};ya.prototype._combineTransforms=function(){for(var a=this._transforms,b=a.length,c=[1,0,0,1,0,0],d,f,g,h,e,j,r=0;r<b;r+=2)switch(f=a[r+1],a[r]){case Aa.Translate:d=f[0];f=f[1];c[4]+=c[0]*d+c[2]*f;c[5]+=c[1]*d+c[3]*f;break;case Aa.Scale:d=f[0];f=f[1];c[0]*=d;c[1]*=d;c[2]*=f;c[3]*=f;break;case Aa.Rotate:d=f[0];if(0!==d){var l=Math.sin(d),m=Math.cos(d);if(-0.005>l||0.005<l||0.995>m||1.005<m)d=f[1],f=f[2],g=c[0],h=c[1],e=c[2],j=c[3],0!==d||0!==f?(c[4]+=g*d+e*f,c[5]+=h*d+j*f,
c[0]=g*m+e*l,c[1]=h*m+j*l,c[2]=g*-l+e*m,c[3]=h*-l+j*m,c[4]-=c[0]*d+c[2]*f,c[5]-=c[1]*d+c[3]*f):(c[0]=g*m+e*l,c[1]=h*m+j*l,c[2]=g*-l+e*m,c[3]=h*-l+j*m)}break;case Aa.Matrix:g=c[0],h=c[1],e=c[2],j=c[3],c[0]=g*f[0]+e*f[1],c[1]=h*f[0]+j*f[1],c[2]=g*f[2]+e*f[3],c[3]=h*f[2]+j*f[3],c[4]+=g*f[4]+e*f[5],c[5]+=h*f[4]+j*f[5]}a.length=2;a[0]=Aa.Matrix;a[1]=c};ya.prototype.removeTransforms=function(){this._transforms=null;this._checkState()};ya.prototype._checkState=function(){!this._fill&&!this._stroke&&!this._lineWidth&&
!this._transforms?this.draw===this._drawState?this.draw=this._drawShape:this.draw===this._drawStateChildren&&(this.draw=this._drawChildren):this.draw===this._drawShape?this.draw=this._drawState:this.draw===this._drawChildren&&(this.draw=this._drawStateChildren)};ya.prototype._setState=function(a){var b=this._fill;b&&(a.fillStyle=b);if(b=this._stroke)a.strokeStyle=b;if(b=this._lineWidth)a.lineWidth=b;if(b=this._transforms)for(var c=b.length,d=0;d<c;d+=2){var f=b[d+1],g;switch(b[d]){case Aa.Translate:g=
f[0];f=f[1];(0!==g||0!==f)&&a.translate(g,f);break;case Aa.Scale:g=f[0];f=f[1];(1!==g||1!==f)&&a.scale(g,f);break;case Aa.Rotate:var h=f[0];g=f[1];f=f[2];0!==h&&(0!==g||0!==f?(a.translate(g,f),a.rotate(h),a.translate(-g,-f)):a.rotate(h));break;case Aa.Matrix:a.transform(f[0],f[1],f[2],f[3],f[4],f[5])}}};ya.prototype._drawState=function(a){a.save();this._setState(a);this._drawShape(a);a.restore()};ya.prototype._drawStateChildren=function(a){a.save();this._setState(a);this._drawShape(a);for(var b=this._children,
c=b.length,d=0;d<c;d+=1)b[d].draw(a);a.restore()};ya.prototype._drawChildren=function(a){this._drawShape(a);for(var b=this._children,c=b.length,d=0;d<c;d+=1)b[d].draw(a)};ya.prototype._drawShape=function(){};var Di,Ae=function(){ya.apply(this,arguments)};lc(Ae,ya);Ae.prototype._drawState=function(){};Ae.prototype._drawStateChildren=function(a){a.save();this._setState(a);for(var b=this._children,c=b.length,d=0;d<c;d+=1)b[d].draw(a);a.restore()};Ae.prototype._drawChildren=function(a){for(var b=this._children,
c=b.length,d=0;d<c;d+=1)b[d].draw(a)};Di=Ae;var Rj,Ei=function(a){ya.call(this);this.path=a};lc(Ei,ya);Ei.prototype._drawShape=function(a){var b=this.path;a.beginPath();a.path(b);"none"!==a.fillStyle&&a.fill();"none"!==a.strokeStyle&&a.stroke()};Rj=Ei;var Sj,Fi=function(a){ya.call(this);this.points=a};lc(Fi,ya);Fi.prototype._drawShape=function(a){var b=this.points,c=b.length;a.beginPath();a.moveTo(b[0],b[1]);for(var d=2;d<c;d+=2)a.lineTo(b[d],b[d+1]);a.closePath();"none"!==a.fillStyle&&a.fill();"none"!==
a.strokeStyle&&a.stroke()};Sj=Fi;var Tj,Gi=function(a){ya.call(this);this.points=a};lc(Gi,ya);Gi.prototype._drawShape=function(a){var b=this.points;if(b){var c=b.length;a.beginPath();a.moveTo(b[0],b[1]);for(var d=2;d<c;d+=2)a.lineTo(b[d],b[d+1]);"none"!==a.fillStyle&&a.fill();"none"!==a.strokeStyle&&a.stroke()}};Tj=Gi;var Uj,Hi=function(a,b,c,d){ya.call(this);this.x=a;this.y=b;this.width=c;this.height=d};lc(Hi,ya);Hi.prototype._drawShape=function(a){var b=this.x,c=this.y,d=this.width,f=this.height;
"none"!==a.fillStyle&&a.fillRect(b,c,d,f);"none"!==a.strokeStyle&&a.strokeRect(b,c,d,f)};Uj=Hi;var Vj,Ii=function(a,b,c){ya.call(this);this.x=a;this.y=b;this.radius=c};lc(Ii,ya);Ii.prototype._drawShape=function(a){var b=this.radius;if(0<b){var c=this.x,d=this.y;a.beginPath();a.arc(c,d,b,0,2*Math.PI);"none"!==a.fillStyle&&a.fill();"none"!==a.strokeStyle&&a.stroke()}};Vj=Ii;var Wj,Ji=function(a,b,c,d){ya.call(this);this.x=a;this.y=b;this.radiusX=c;this.radiusY=d};lc(Ji,ya);Ji.prototype._drawShape=function(a){var b=
this.radiusX,c=this.radiusY;if(0<b&&0<c){var d=this.x,f=this.y;a.beginPath();if(b!==c){var g,h;b>c?(g=b,h=1,b=c/b):(g=c,h=b/c,b=1);a.translate(d,f);a.scale(h,b);a.arc(0,0,g,0,2*Math.PI);a.scale(1/h,1/b);a.translate(-d,-f)}else a.arc(d,f,b,0,2*Math.PI);"none"!==a.fillStyle&&a.fill();"none"!==a.strokeStyle&&a.stroke()}};Wj=Ji;var Xj,Ki=function(a,b,c,d){ya.call(this);this.x1=a;this.y1=b;this.x2=c;this.y2=d};lc(Ki,ya);Ki.prototype._drawShape=function(a){var b=this.x1,c=this.y1,d=this.x2,f=this.y2;a.beginPath();
a.moveTo(b,c);a.lineTo(d,f);"none"!==a.strokeStyle&&a.stroke()};Xj=Ki;var Yj=function(a,b,c,d){ya.call(this);this.font=a;this.text=b;this.x=c;this.y=d};lc(Yj,ya);Yj.prototype._drawShape=function(a){a.font=this.font;a.fillText(this.text,this.x,this.y)};var ad,cd=function(){};cd.prototype.clone=function(){var a=new cd;a.name=this.name;a.spot=this.spot;a.ambient=this.ambient;a.point=this.point;a.fog=this.fog;a.global=this.global;a.directional=this.directional;a.color=this.color&&this.color.slice();a.direction=
this.direction&&this.direction.slice();a.origin=this.origin&&this.origin.slice();a.frustum=this.frustum&&this.frustum.slice();a.frustumNear=this.frustumNear;a.center=this.center&&this.center.slice();a.halfExtents=this.halfExtents&&this.halfExtents.slice();a.radius=this.radius;a.shadows=this.shadows;a.dynamicshadows=this.dynamicshadows;a.disabled=this.disabled;a.dynamic=this.dynamic;a.techniqueParameters=this.techniqueParameters;return a};cd.prototype.isGlobal=function(){return this.global};cd.create=
function(a){var b=new cd,c=TurbulenzEngine.getMathDevice(),d=Math.abs,f=Math.max;a.name&&(b.name=a.name);b.color=a.color&&a.color.length?a.color:c.v3BuildOne();a.directional?b.directional=!0:a.spot?b.spot=!0:a.ambient?b.ambient=!0:b.point=!0;b.origin=a.origin;var g=a.target;if(g||b.spot){g||(g=c.v3Build(0,0,-(a.radius||1)));var h=(a.falloff_angle||90)/360*Math.PI,h=Math.abs(g[2])*Math.tan(h),e=a.right||c.v3Build(h,0,0),j=a.up||c.v3Build(0,h,0),r=a.end||g;b.frustum=c.m33Build(e,j,r);var h=d(e[0])+
d(j[0]),l=d(e[1])+d(j[1]),e=d(e[2])+d(j[2]),j=r[0],m=r[1],i=r[2],k;(k=a.start)?(g=c.v3Normalize(g),b.frustumNear=c.v3Dot(g,k)/c.v3Dot(g,r),g=0.5*(j+k[0]),r=0.5*(m+k[1]),k=0.5*(i+k[2])):(b.frustumNear=0,g=0.5*j,r=0.5*m,k=0.5*i);b.center=c.v3Build(g,r,k);b.halfExtents=c.v3Build(f(d(j-h-g),d(j+h-g)),f(d(m-l-r),d(m+l-r)),f(d(i-e-k),d(i+e-k)))}else(d=a.halfExtents)?b.halfExtents=d.length&&d||c.v3BuildZero():(d=a.radius)?(b.radius=d,b.halfExtents=c.v3ScalarBuild(d)):b.ambient||(b.halfExtents=c.v3ScalarBuild(w.FLOAT_MAX));
b.direction=a.direction;!a.halfExtents&&(!a.radius&&!a.target)&&(b.global=!0);if(!b.global&&(a.shadows||a.dynamicshadows))b.shadows=!0,a.dynamicshadows&&(b.dynamicshadows=!0);a.disabled&&(b.disabled=!0);a.dynamic&&(b.dynamic=!0);if(a=a.material)if(b.techniqueParameters=a.techniqueParameters,a=a.meta)a.ambient&&(b.ambient=!0),a.fog&&(b.fog=!0);return b};cd.version=1;ad=cd;var bd,ac=function(){};ac.prototype.setMaterial=function(a){this.light.sharedMaterial=a;var b=a.meta;a.meta&&(b.ambient?this.light.ambient=
!0:this.light.ambient&&delete this.light.ambient,b.fog?this.light.fog=!0:this.light.fog&&delete this.light.fog)};ac.prototype.setNode=function(a){this.node=a;this.worldExtentsUpdate=-1};ac.prototype.getNode=function(){return this.node};ac.prototype.getWorldExtents=function(){var a=this.worldExtents,b=this.node;if(b.worldUpdate!==this.worldExtentsUpdate){this.worldExtentsUpdate=b.worldUpdate;var c=this.light,d=b.world,f=d[0],g=d[1],h=d[2],e=d[3],j=d[4],r=d[5],l=d[6],m=d[7],i=d[8],b=d[9],k=d[10],d=
d[11];if(c.spot){var s,D,u,z,t,y;s=b;D=k;u=d;z=b;t=k;y=d;var v=c.frustum,c=v[0],x=v[1],w=v[2],C=v[3],A=v[4],Q=v[5],V=v[6],E=v[7],v=v[8],b=b+(f*V+e*E+l*v),k=k+(g*V+j*E+m*v),d=d+(h*V+r*E+i*v),V=Math.abs,f=V(f*c+e*x+l*w)+V(f*C+e*A+l*Q),g=V(g*c+j*x+m*w)+V(g*C+j*A+m*Q),j=V(h*c+r*x+i*w)+V(h*C+r*A+i*Q),h=b-f,r=k-g,i=d-j;s>h&&(s=h);D>r&&(D=r);u>i&&(u=i);h=b+f;r=k+g;i=d+j;z<h&&(z=h);t<r&&(t=r);y<i&&(y=i);a[0]=s;a[1]=D;a[2]=u;a[3]=z;a[4]=t;a[5]=y}else D=c.center,s=c.halfExtents,D&&(u=D[0],z=D[1],D=D[2],b+=
f*u+e*z+l*D,k+=g*u+j*z+m*D,d+=h*u+r*z+i*D),D=s[0],u=s[1],s=s[2],f=(0>f?-f:f)*D+(0>e?-e:e)*u+(0>l?-l:l)*s,g=(0>g?-g:g)*D+(0>j?-j:j)*u+(0>m?-m:m)*s,h=(0>h?-h:h)*D+(0>r?-r:r)*u+(0>i?-i:i)*s,a[0]=b-f,a[1]=k-g,a[2]=d-h,a[3]=b+f,a[4]=k+g,a[5]=d+h}return a};ac.prototype.clone=function(){return ac.create(this.light)};ac.create=function(a){var b=new ac;b.node=void 0;b.light=a;b.worldExtents=new b.arrayConstructor(6);b.worldExtentsUpdate=-1;return b};ac.version=1;bd=ac;bd.prototype.arrayConstructor=Array;if("undefined"!==
typeof Float32Array){var ok=new Float32Array(4);"[object Float32Array]"===Object.prototype.toString.call(ok)&&(bd.prototype.arrayConstructor=Float32Array)}var Cc=function(){};Cc.prototype.setProgress=function(a){this.progress=a};Cc.prototype.setTexture=function(a){this.textureMaterial.diffuse=a;this.textureWidthHalf=0.5*a.width;this.textureHeightHalf=0.5*a.height};Cc.prototype.loadAndSetTexture=function(a,b,c,d){var f=this;if(c){var g=c.urlMapping,c=c.assetPrefix;b.request({src:g&&g[d]||c+d,requestFn:function(b,
c){return a.createTexture({src:b,mipmaps:!1,onload:c})},onload:function(a){a&&f.setTexture(a)}})}};Cc.prototype.render=function(a,b){var c=this.gd,d=c.width,f=c.height;if(!(0===d||0===f)){var g,h=c.PRIMITIVE_TRIANGLE_STRIP,e;if(0<a)if(this.backgroundColor[3]=a,1<=a)c.clear(this.backgroundColor);else{c.setTechnique(this.backgroundTechnique);var j=this.backgroundColor;e=this.backgroundMaterial;e.color=j;c.setTechniqueParameters(e);if(g=c.beginDraw(h,4,this.posVertexFormats,this.posSemantics))g(-1,-1),
g(1,-1),g(-1,1),g(1,1),c.endDraw(g)}var r=0,l=0,m=0,i=r=0,k=0,s=(j=this.assetTracker)&&j.getLoadingProgress()||this.progress,j=2/d,D=-2/f;if(null!==s&&0<a){0>s?s=0:1<s&&(s=1);e=this.backgroundMaterial;g=this.barBackgroundColor;g[3]=a;var u=this.barColor;u[3]=a;var r=this.barCenter.x*d,l=this.barCenter.y*f,z=this.barBackgroundWidth,t=0.5*this.barBackgroundHeight,y=this.barBorderSize;c.setTechnique(this.backgroundTechnique);e.color=g;c.setTechniqueParameters(e);if(g=c.beginDraw(h,4,this.posVertexFormats,
this.posSemantics))m=r-0.5*z,r=m+z,i=l-t,k=l+t,g(m*j-1,i*D+1),g(r*j-1,i*D+1),g(m*j-1,k*D+1),g(r*j-1,k*D+1),c.endDraw(g);e.color=u;c.setTechniqueParameters(e);if(g=c.beginDraw(h,4,this.posVertexFormats,this.posSemantics))m+=y,r=m+(z-2*y)*s,i+=y,k-=y,g(m*j-1,i*D+1),g(r*j-1,i*D+1),g(m*j-1,k*D+1),g(r*j-1,k*D+1),c.endDraw(g)}i=this.textureWidthHalf;e=this.textureHeightHalf;if(0<i&&0<b&&(m=this.textureMaterial,c.setTechnique(this.textureTechnique),l=this.clipSpace,l[0]=j,l[1]=D,m.clipSpace=l,m.alpha=b,
c.setTechniqueParameters(m),g=c.beginDraw(h,4,this.textureVertexFormats,this.textureSemantics)))r=0.5*d,l=0.5*f,m=r-i,r+=i,i=l-e,k=l+e,g(m,i,0,0),g(r,i,1,0),g(m,k,0,1),g(r,k,1,1),c.endDraw(g)}};Cc.create=function(a,b,c){var d=new Cc;d.gd=a;d.backgroundColor=b.v4Build(0.231,0.231,0.231,1);d.backgroundTechnique=null;d.backgroundMaterial=a.createTechniqueParameters();d.posVertexFormats=[a.VERTEXFORMAT_FLOAT2];d.posSemantics=a.createSemantics(["POSITION"]);d.clipSpace=b.v4Build(1,1,-1,1);d.textureWidthHalf=
0;d.textureHeightHalf=0;d.textureTechnique=null;d.textureMaterial=a.createTechniqueParameters();d.textureVertexFormats=[a.VERTEXFORMAT_FLOAT2,a.VERTEXFORMAT_FLOAT2];d.textureSemantics=a.createSemantics(["POSITION","TEXCOORD0"]);c&&(d.barBackgroundColor=b.v4BuildZero(),d.barColor=b.v4BuildOne(),d.barCenter={x:0.5,y:0.75},d.barBorderSize=4,d.barBackgroundWidth=544,d.barBackgroundHeight=32,d.assetTracker=null,d.progress=null,c.backgroundColor&&(d.backgroundColor=c.backgroundColor),c.barBackgroundColor&&
(d.barBackgroundColor=c.barBackgroundColor),c.barColor&&(d.barColor=c.barColor),c.barCenter&&(b=c.barCenter.x,d.barCenter.x=1<b?1:0>b?0:b,b=c.barCenter.y,d.barCenter.y=1<b?1:0>b?0:b),c.barBorderSize&&(d.barBorderSize=c.barBorderSize),c.barBackgroundWidth&&(d.barBackgroundWidth=c.barBackgroundWidth),c.barBackgroundHeight&&(d.barBackgroundHeight=c.barBackgroundHeight),c.assetTracker&&(d.assetTracker=c.assetTracker),c.progress&&(d.progress=c.progress));return(a=a.createShader({version:1,name:"loadingscreen.cgfx",
samplers:{diffuse:{MinFilter:9729,MagFilter:9729,WrapS:33071,WrapT:33071}},parameters:{color:{type:"float",columns:4},clipSpace:{type:"float",columns:4},alpha:{type:"float"},diffuse:{type:"sampler2D"}},techniques:{background:[{parameters:["color"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[770,771]},programs:["vp_background","fp_background"]}],texture:[{parameters:["clipSpace","alpha","diffuse"],semantics:["POSITION","TEXCOORD0"],states:{DepthTestEnable:!1,
DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[770,771]},programs:["vp_texture","fp_texture"]}]},programs:{fp_texture:{type:"fragment",code:"#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];\nfloat _TMP0;float _TMP1;float _TMP12;uniform float alpha;uniform sampler2D diffuse;void main()\n{vec4 _textureColor;_textureColor=texture2D(diffuse,tz_TexCoord[0].xy);_TMP1=min(1.0,alpha);_TMP12=max(0.0,_TMP1);_TMP0=_TMP12*_TMP12*(3.0-2.0*_TMP12);_textureColor.w=_textureColor.w*_TMP0;gl_FragColor=_textureColor;}"},
vp_texture:{type:"vertex",code:"#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];attribute vec4 ATTR0;attribute vec4 ATTR8;\nvec4 _OutPosition1;vec2 _OutUV1;uniform vec4 clipSpace;void main()\n{_OutPosition1.xy=ATTR0.xy*clipSpace.xy+clipSpace.zw;_OutPosition1.zw=ATTR0.zw;_OutUV1=ATTR8.xy;tz_TexCoord[0].xy=ATTR8.xy;gl_Position=_OutPosition1;}"},fp_background:{type:"fragment",code:"#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvec4 _ret_0;float _TMP0;float _TMP1;float _TMP11;uniform vec4 color;void main()\n{_TMP1=min(1.0,color.w);_TMP11=max(0.0,_TMP1);_TMP0=_TMP11*_TMP11*(3.0-2.0*_TMP11);_ret_0=vec4(color.x,color.y,color.z,_TMP0);gl_FragColor=_ret_0;}"},
vp_background:{type:"vertex",code:"#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nattribute vec4 ATTR0;\nvoid main()\n{gl_Position=ATTR0;}"}}}))?(d.backgroundTechnique=a.getTechnique("background"),d.textureTechnique=a.getTechnique("texture"),d):null};Cc.version=1;var dd=function(){};dd.prototype.updateShader=function(a){a=a.get("shaders/posteffects.cgfx");a!==this.shader&&(this.shader=a,this.bicolor.technique=a.getTechnique("bicolor"),
this.copy.technique=a.getTechnique("copy"),this.copyFiltered.technique=a.getTechnique("copyFiltered"),this.fadein.technique=a.getTechnique("fadein"),this.modulate.technique=a.getTechnique("modulate"),this.blend.technique=a.getTechnique("blend"))};dd.prototype.getEffectSetupCB=function(a){var b=this[a];if(b)return b.callback||(b.callback=function(a,d){a.setTechnique(b.technique);b.techniqueParameters[b.textureName]=d;a.setTechniqueParameters(b.techniqueParameters)}),b.callback};dd.prototype.destroy=
function(){for(var a in this)this.hasOwnProperty(a)&&delete this[a]};dd.create=function(a,b){var c=new dd;b.load("shaders/posteffects.cgfx");c.bicolor={technique:null,techniqueParameters:a.createTechniqueParameters({color0:[0,0,0],color1:[1,1,1],colorTexture:null}),callback:null,textureName:"colorTexture"};c.copy={technique:null,techniqueParameters:a.createTechniqueParameters({colorTexture:null}),callback:null,textureName:"colorTexture"};c.copyFiltered={technique:null,techniqueParameters:a.createTechniqueParameters({colorTextureFiltered:null}),
callback:null,textureName:"colorTextureFiltered"};c.fadein={technique:null,techniqueParameters:a.createTechniqueParameters({fadeColor:[0,0,0,0],colorTexture:null}),callback:null,textureName:"colorTexture"};c.modulate={technique:null,techniqueParameters:a.createTechniqueParameters({modulateColor:[1,1,1,1],colorTexture:null}),callback:null,textureName:"colorTexture"};c.blend={technique:null,techniqueParameters:a.createTechniqueParameters({alpha:0.5,colorTexture:null}),callback:null,textureName:"colorTexture"};
return c};dd.version=1;var Sa,ga=function(a){this.name=a.name;var b=this.mathDevice;b||(b=TurbulenzEngine.getMathDevice(),ga.prototype.mathDevice=b);this.dynamic=a.dynamic||!1;this.disabled=a.disabled||!1;this.dirtyLocalExtents=this.dirtyWorldExtents=!0;this.worldUpdate=0;a=this.local=(a=a.local)?b.m43Copy(a):b.m43BuildIdentity();this.world=b.m43Copy(a)};ga.makePath=function(a,b){return a+"/"+b};ga.invalidSetLocalTransform=function(){};ga.prototype.getName=function(){return this.name};ga.prototype.getPath=
function(){return this.parent?ga.makePath(this.parent.getPath(),this.name):this.name};ga.prototype.getParent=function(){return this.parent};ga.prototype.setParentHelper=function(a){this.parent=a;this.dirtyWorld=this.notifiedParent=!1;this._setDirtyWorldTransform()};ga.prototype.addChild=function(a){a.parent?a.parent.removeChild(a):a.scene&&a.scene.removeRootNode(a);this.children||(this.children=[],this.childNeedsUpdateCount=0);this.children.push(a);a.setParentHelper(this);this.dynamic&&!a.dynamic&&
a.setDynamic()};ga.prototype.removeChild=function(a){var b=this.children;if(b){a.notifiedParent&&this.childUpdated();for(var c=b.length,d=0;d<c;d+=1)if(b[d]===a){c=this.getRoot();c.scene&&a.removedFromScene(c.scene);b.splice(d,1);a.setParentHelper(null);break}}};ga.prototype.findChild=function(a){var b=this.children;if(b)for(var c=b.length,d=0;d<c;d+=1)if(b[d].name===a)return b[d]};ga.prototype.clone=function(a){var a=ga.create({name:a||this.name,local:this.local,dynamic:this.dynamic,disabled:this.disabled}),
b=this.renderables;if(b)for(var c=b.length,d=0;d<c;d+=1)a.addRenderable(b[d].clone());if(b=this.lights){c=b.length;for(d=0;d<c;d+=1)a.addLightInstance(b[d].clone())}this.clonedObserver&&this.clonedObserver.notify({oldNode:this,newNode:a});if(b=this.children){c=b.length;for(d=0;d<c;d+=1)a.addChild(b[d].clone())}return a};ga.prototype.getRoot=function(){for(var a=this;a.parent;)a=a.parent;return a};ga.prototype.isInScene=function(){return this.getRoot().scene?!0:!1};ga.prototype.removedFromScene=function(a){void 0!==
this.spatialIndex&&(this.dynamic?a.dynamicSpatialMap.remove(this):(a.staticSpatialMap.remove(this),a.staticNodesChangeCounter+=1));var b=this.children;if(b)for(var c=b.length,d=0;d<c;d+=1)b[d].removedFromScene(a)};ga.prototype.setLocalTransform=function(a){a!==this.local&&(this.local=this.mathDevice.m43Copy(a,this.local));this.dirtyWorld||this._setDirtyWorldTransform()};ga.prototype.getLocalTransform=function(){return this.local};ga.prototype._setDirtyWorldTransform=function(){var a=this.parent;a?
this.notifiedParent||(this.notifiedParent=!0,a.childNeedsUpdate()):(a=this.scene)&&a.addRootNodeToUpdate(this,this.name);a=ga._tempDirtyNodes;a[0]=this;var b=1,c,d,f;do{b-=1;c=a[b];c.dirtyWorld=!0;!c.customWorldExtents&&c.localExtents&&(c.dirtyWorldExtents=!0);var g=c.children;if(g){var h=g.length;if(c.childNeedsUpdateCount)for(d=0;d<h;d+=1)f=g[d],f.dirtyWorld||(f.notifiedParent||(f.notifiedParent=!0,c.childNeedsUpdateCount+=1),a[b]=f,b+=1);else{c.childNeedsUpdateCount=h;for(d=0;d<h;d+=1)f=g[d],f.notifiedParent=
!0,a[b]=f,b+=1}}}while(0<b)};ga.prototype.getWorldTransform=function(){this.dirtyWorld&&this.updateWorldTransform();return this.world};ga.prototype.updateWorldTransform=function(){if(this.dirtyWorld){this.dirtyWorld=!1;this.worldUpdate+=1;this.checkUpdateRequired();var a=this.parent,b=this.local;a?(a=a.getWorldTransform(),this.world=b?this.mathDevice.m43Mul(b,a,this.world):this.mathDevice.m43Copy(a,this.world)):this.world=this.mathDevice.m43Copy(b,this.world)}};ga.prototype.setDynamic=function(){if(!this.dynamic){if(void 0!==
this.spatialIndex){var a=this.getRoot().scene;a.staticSpatialMap.remove(this);a.staticNodesChangeCounter+=1;delete this.spatialIndex}delete this.setLocalTransform;(a=this.getWorldExtents())&&this.getRoot().scene.dynamicSpatialMap.update(this,a);this.dynamic=!0}if(a=this.children)for(var b=a.length,c=0;c<b;c+=1)a[c].setDynamic()};ga.prototype.setStatic=function(){if(this.dynamic){void 0!==this.spatialIndex&&(this.getRoot().scene.dynamicSpatialMap.remove(this),delete this.spatialIndex);this.setLocalTransform=
ga.invalidSetLocalTransform;var a=this.getWorldExtents();if(a){var b=this.getRoot().scene;b&&(b.staticSpatialMap.update(this,a),b.staticNodesChangeCounter+=1)}delete this.dirtyWorldExtents;delete this.worldExtentsUpdate;delete this.dirtyWorld;delete this.notifiedParent;delete this.dynamic}if(a=this.children)for(var b=a.length,c=0;c<b;c+=1)a[c].setStatic()};ga.prototype.setDisabled=function(a){this.disabled=a?!0:!1};ga.prototype.getDisabled=function(){return this.disabled};ga.prototype.enableHierarchy=
function(a){this.setDisabled(!a);var b=this.children;if(b)for(var c=b.length,d=0;d<c;d+=1)b[d].enableHierarchy(a)};ga.prototype.childUpdated=function(){this.childNeedsUpdateCount-=1;0===this.childNeedsUpdateCount&&(!1===this.dirtyWorld&&!1===this.dirtyWorldExtents)&&this.parent&&(this.parent.childUpdated(),this.notifiedParent=!1)};ga.prototype.childNeedsUpdate=function(){this.updateRequired();this.childNeedsUpdateCount+=1};ga.prototype.updateRequired=function(){var a=this.parent;a?this.notifiedParent||
(this.notifiedParent=!0,a.childNeedsUpdate()):(a=this.scene)&&a.addRootNodeToUpdate(this,this.name)};ga.prototype.checkUpdateRequired=function(){this.notifiedParent&&(!this.dirtyWorldExtents&&!this.dirtyWorld&&!this.childNeedsUpdateCount)&&(this.parent.childUpdated(),this.notifiedParent=!1)};ga.prototype.update=function(a){var b=ga._tempDirtyNodes;b[0]=this;ga.updateNodes(this.mathDevice,a||this.scene,b,1)};ga.updateNodes=function(a,b,c,d){var f,g;do{d-=1;f=c[d];if(f.dirtyWorld)if(f.dirtyWorld=!1,
f.worldUpdate+=1,g=f.parent){var h=f.local;f.world=h?a.m43Mul(h,g.world,f.world):a.m43Copy(g.world,f.world)}else f.world=a.m43Copy(f.local,f.world);f.dirtyWorldExtents&&(f.customWorldExtents?f.worldExtents=f.customWorldExtents:(f.dirtyLocalExtents&&f.updateLocalExtents(),f.numCustomRenderableWorldExtents?f.updateCustomRenderableWorldExtents():f.localExtents?f.recalculateWorldExtents():delete f.worldExtents),f.dirtyWorldExtents=!1,f.worldExtentsUpdate=!0);f.worldExtentsUpdate&&(f.worldExtentsUpdate=
!1,(g=f.worldExtents)?f.dynamic?b.dynamicSpatialMap.update(f,g):(b.staticSpatialMap.update(f,g),b.staticNodesChangeCounter+=1,f.setLocalTransform=ga.invalidSetLocalTransform,delete f.dirtyWorldExtents,delete f.worldExtentsUpdate,delete f.dirtyWorld,delete f.notifiedParent):void 0!==f.spatialIndex&&(f.dynamic?b.dynamicSpatialMap.remove(f):(b.staticSpatialMap.remove(f),b.staticNodesChangeCounter+=1)));if(f.childNeedsUpdateCount&&(f.childNeedsUpdateCount=0,h=f.children)){var e=h.length;for(g=0;g<e;g+=
1){var j=h[g];j.notifiedParent&&(c[d]=j,d+=1)}}f.notifiedParent=!1}while(0<d)};ga.prototype.updateLocalExtents=function(){var a,b,c,d=!1;if(this.customLocalExtents)this.localExtents=this.customLocalExtents,d=!0;else{var f=this.renderables;a=this.lightInstances;if(f||a){var g=Number.MAX_VALUE,h=-g,e=Math.min,j=Math.max,r,l,m,i,k=d=g,s=h,D=h;if(f)for(var u=f.length,z=0;z<u;z+=1)if(b=f[z],(c=b.halfExtents)&&!b.hasCustomWorldExtents())r=c[0],l=c[1],c=c[2],(b=b.center)?(m=b[0],i=b[1],b=b[2],d=e(d,m-r),
k=e(k,i-l),g=e(g,b-c),s=j(s,m+r),D=j(D,i+l),h=j(h,b+c)):(d=e(d,-r),k=e(k,-l),g=e(g,-c),s=j(s,+r),D=j(D,+l),h=j(h,+c));if(a){f=a.length;for(u=0;u<f;u+=1)if(b=a[u].light,c=b.halfExtents)r=c[0],l=c[1],c=c[2],(b=b.center)?(m=b[0],i=b[1],b=b[2],d=e(d,m-r),k=e(k,i-l),g=e(g,b-c),s=j(s,m+r),D=j(D,i+l),h=j(h,b+c)):(d=e(d,-r),k=e(k,-l),g=e(g,-c),s=j(s,+r),D=j(D,+l),h=j(h,+c))}a=new this.arrayConstructor(6);a[0]=d;a[1]=k;a[2]=g;a[3]=s;a[4]=D;a[5]=h;this.localExtents=a;d=!0}}d?(a=this.localExtents,b=this.localExtentsCenter||
new this.arrayConstructor(3),b[0]=0.5*(a[3]+a[0]),b[1]=0.5*(a[4]+a[1]),b[2]=0.5*(a[5]+a[2]),this.localExtentsCenter=b,c=this.localHalfExtents||new this.arrayConstructor(3),c[0]=a[3]-b[0],c[1]=a[4]-b[1],c[2]=a[5]-b[2],this.localHalfExtents=c):(delete this.localExtents,delete this.localExtentsCenter,delete this.localHalfExtents);this.dirtyLocalExtents=!1};ga.prototype.getLocalExtents=function(){this.dirtyLocalExtents&&this.updateLocalExtents();return this.localExtents};ga.prototype.updateWorldExtents=
function(){this.dirtyWorld&&this.updateWorldTransform();this.dirtyWorldExtents&&(this.customWorldExtents?this.worldExtents=this.customWorldExtents:(this.dirtyLocalExtents&&this.updateLocalExtents(),this.numCustomRenderableWorldExtents?this.updateCustomRenderableWorldExtents():this.localExtents?this.recalculateWorldExtents():delete this.worldExtents),this.dirtyWorldExtents=!1,this.worldExtentsUpdate=!0,this.checkUpdateRequired())};ga.prototype.updateCustomRenderableWorldExtents=function(){var a,b,
c,d,f,g,h,e,j=this.renderables,r=j.length,l=!0;for(a=0;a<r;a+=1)if(b=j[a],b=b.getCustomWorldExtents()){c=b[0];d=b[1];f=b[2];g=b[3];h=b[4];e=b[5];a+=1;l=!1;break}for(;a<r;a+=1)if(b=j[a],b=b.getCustomWorldExtents())c>b[0]&&(c=b[0]),d>b[1]&&(d=b[1]),f>b[2]&&(f=b[2]),g<b[3]&&(g=b[3]),h<b[4]&&(h=b[4]),e<b[5]&&(e=b[5]);l?delete this.worldExtents:(a=this.worldExtents,a||(this.worldExtents=a=new this.arrayConstructor(6)),a[0]=c,a[1]=d,a[2]=f,a[3]=g,a[4]=h,a[5]=e)};ga.prototype.recalculateWorldExtents=function(){var a=
this.localExtentsCenter,b=this.localHalfExtents,c=a[0],d=a[1],f=a[2],g=b[0],h=b[1],e=b[2],j=this.world,r=j[0],l=j[1],m=j[2],i=j[3],k=j[4],s=j[5],D=j[6],u=j[7],z=j[8],b=j[9],a=j[10],j=j[11];if(0!==c||0!==d||0!==f)b+=r*c+i*d+D*f,a+=l*c+k*d+u*f,j+=m*c+s*d+z*f;c=(0>r?-r:r)*g+(0>i?-i:i)*h+(0>D?-D:D)*e;d=(0>l?-l:l)*g+(0>k?-k:k)*h+(0>u?-u:u)*e;g=(0>m?-m:m)*g+(0>s?-s:s)*h+(0>z?-z:z)*e;h=this.worldExtents;h||(this.worldExtents=h=new this.arrayConstructor(6));h[0]=b-c;h[1]=a-d;h[2]=j-g;h[3]=b+c;h[4]=a+d;h[5]=
j+g};ga.prototype.getWorldExtents=function(){this.dirtyWorldExtents&&this.updateWorldExtents();return this.worldExtents};ga.prototype.addCustomLocalExtents=function(a){var b=this.customLocalExtents;if(b){if(b[0]!==a[0]||b[1]!==a[1]||b[2]!==a[2]||b[3]!==a[3]||b[4]!==a[4]||b[5]!==a[5])b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],this.dirtyLocalExtents=!0}else this.customLocalExtents=b=new this.arrayConstructor(6),b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],this.dirtyLocalExtents=
!0;this.dirtyLocalExtents&&(this.dirtyWorldExtents=!0,this.updateRequired())};ga.prototype.removeCustomLocalExtents=function(){delete this.customLocalExtents;this.dirtyLocalExtents=this.dirtyWorldExtents=!0;this.updateRequired()};ga.prototype.getCustomLocalExtents=function(){return this.customLocalExtents};ga.prototype.addCustomWorldExtents=function(a){var b=this.customWorldExtents;if(b){if(b[0]!==a[0]||b[1]!==a[1]||b[2]!==a[2]||b[3]!==a[3]||b[4]!==a[4]||b[5]!==a[5])b[0]=a[0],b[1]=a[1],b[2]=a[2],
b[3]=a[3],b[4]=a[4],b[5]=a[5],this.dirtyWorldExtents=!0}else this.customWorldExtents=b=new this.arrayConstructor(6),b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],this.dirtyWorldExtents=!0;this.dirtyWorldExtents&&this.updateRequired()};ga.prototype.removeCustomWorldExtents=function(){delete this.customWorldExtents;this.dirtyWorldExtents=!0;this.updateRequired()};ga.prototype.getCustomWorldExtents=function(){return this.customWorldExtents};ga.prototype.renderableWorldExtentsUpdated=function(a){this.customWorldExtents||
(this.dirtyWorldExtents=!0,this.updateRequired());a||(this.dirtyLocalExtents=!0,this.numCustomRenderableWorldExtents=this.numCustomRenderableWorldExtents?this.numCustomRenderableWorldExtents+1:1)};ga.prototype.renderableWorldExtentsRemoved=function(){this.customWorldExtents||(this.dirtyWorldExtents=!0,this.updateRequired());this.dirtyLocalExtents=!0;this.numCustomRenderableWorldExtents-=1};ga.prototype.calculateHierarchyWorldExtents=function(){var a=function(b,c){var g=!1,h=b.getWorldExtents();h&&
(c[0]=c[0]<h[0]?c[0]:h[0],c[1]=c[1]<h[1]?c[1]:h[1],c[2]=c[2]<h[2]?c[2]:h[2],c[3]=c[3]>h[3]?c[3]:h[3],c[4]=c[4]>h[4]?c[4]:h[4],c[5]=c[5]>h[5]?c[5]:h[5],g=!0);if(h=b.children)for(var e=h.length,j=0;j<e;j+=1)g=a(h[j],c)||g;return g},b=Number.MAX_VALUE,c=new this.arrayConstructor(6);c[0]=b;c[1]=b;c[2]=b;c[3]=-b;c[4]=-b;c[5]=-b;if(a(this,c))return c};ga.prototype.addRenderable=function(a){this.dirtyWorldExtents=!0;this.updateRequired();this.renderables||(this.renderables=[]);this.renderables.push(a);a.setNode(this);
this.dirtyLocalExtents=!0};ga.prototype.addRenderableArray=function(a){this.dirtyWorldExtents=!0;this.updateRequired();this.renderables||(this.renderables=[]);for(var b=this.renderables,c=a.length,d=0;d<c;d+=1)b.push(a[d]),a[d].setNode(this);this.dirtyLocalExtents=!0};ga.prototype.removeRenderable=function(a){this.dirtyWorldExtents=!0;this.updateRequired();for(var b=this.renderables,c=b.length,d=0;d<c;d+=1)if(b[d]===a){b[d].setNode(null);b.splice(d,1);this.dirtyLocalExtents=!0;break}};ga.prototype.hasRenderables=
function(){return this.renderables&&this.renderables.length?!0:!1};ga.prototype.addLightInstance=function(a){this.dirtyWorldExtents=!0;this.updateRequired();this.lightInstances||(this.lightInstances=[]);this.lightInstances.push(a);a.setNode(this);this.dirtyLocalExtents=!0};ga.prototype.addLightInstanceArray=function(a){this.dirtyWorldExtents=!0;this.updateRequired();this.lightInstances||(this.lightInstances=[]);for(var b=this.lightInstances,c=a.length,d=0;d<c;d+=1)a[d].setNode(this),b.push(a[d]);
this.dirtyLocalExtents=!0};ga.prototype.removeLightInstance=function(a){this.dirtyWorldExtents=!0;this.updateRequired();for(var b=this.lightInstances,c=b.length,d=0;d<c;d+=1)if(b[d]===a){a.setNode(null);b.splice(d,1);this.dirtyLocalExtents=!0;break}};ga.prototype.hasLightInstances=function(){return this.lightInstances&&this.lightInstances.length};ga.prototype.destroy=function(){this.destroyedObserver&&this.destroyedObserver.notify({node:this});var a=this.children;if(a)for(var b=a.length-1;0<=b;b-=
1){var c=a[b];this.removeChild(c);c.destroy()}if(a=this.renderables){for(b=a.length-1;0<=b;b-=1)c=a[b],c.destroy&&c.destroy();this.renderables=[]}this.lightInstances&&(this.lightInstances=[]);delete this.scene;a=ga._tempDirtyNodes;b=a.length;for(c=0;c<b;c+=1)a[c]=null};ga.prototype.subscribeCloned=function(a){this.clonedObserver||(this.clonedObserver=ub.create());this.clonedObserver.subscribe(a)};ga.prototype.unsubscribeCloned=function(a){this.clonedObserver.unsubscribe(a)};ga.prototype.subscribeDestroyed=
function(a){this.destroyedObserver||(this.destroyedObserver=ub.create());this.destroyedObserver.subscribe(a)};ga.prototype.unsubscribeDestroyed=function(a){this.destroyedObserver.unsubscribe(a)};ga.create=function(a){return new ga(a)};ga.version=1;ga._tempDirtyNodes=[];Sa=ga;Sa.prototype.mathDevice=null;Sa.prototype.arrayConstructor=Array;if("undefined"!==typeof Float32Array){var pk=new Float32Array(4);"[object Float32Array]"===Object.prototype.toString.call(pk)&&(Sa.prototype.arrayConstructor=Float32Array)}var Be=
function(){};Be.prototype.get=function(){return null};Be.create=function(a,b,c,d,f){d||(d=function(){});var g;c?g=c:(g=a.createShader({version:1,name:"default.cgfx",parameters:{worldViewProjection:{type:"float",rows:4,columns:4},diffuse:{type:"sampler2D"}},techniques:{textured3D:[{parameters:["worldViewProjection","diffuse"],semantics:["POSITION","TEXCOORD0"],states:{DepthTestEnable:!0,DepthFunc:515,DepthMask:!0,CullFaceEnable:!0,CullFace:1029,BlendEnable:!1},programs:["vp","fp"]}]},programs:{fp:{type:"fragment",
code:"#ifdef GL_ES\nprecision mediump float;precision mediump int;\n#endif\nvarying vec4 tz_TexCoord[1];vec4 _ret_0;uniform sampler2D diffuse;void main()\n{_ret_0=texture2D(diffuse,tz_TexCoord[0].xy);gl_FragColor=_ret_0;}"},vp:{type:"vertex",code:"#ifdef GL_ES\nprecision mediump float;precision mediump int;\n#endif\nvarying vec4 tz_TexCoord[1];attribute vec4 ATTR0;attribute vec4 ATTR8;\nvec4 _OUTpos1;vec2 _OUTuv1;uniform vec4 worldViewProjection[4];void main()\n{_OUTpos1=ATTR0.xxxx*worldViewProjection[0]+ATTR0.yyyy*worldViewProjection[1]+ATTR0.zzzz*worldViewProjection[2]+worldViewProjection[3];_OUTuv1=ATTR8.xy;tz_TexCoord[0].xy=ATTR8.xy;gl_Position=_OUTpos1;}"}}}))||
d("Default shader not created.");var h={},e={},j={},r=0,l=null,m="",i=!1,k={};h["default"]=g;var s=function(c,s){void 0===c&&d("Invalid texture path passed to ShaderManager.Load");var u=h[c];if(u)s&&TurbulenzEngine.setTimeout(function(){s(u)},0);else{if(e[c])s&&j[c].subscribe(s);else{e[c]=!0;r+=1;var z=ub.create();j[c]=z;s&&z.subscribe(s);b.request({src:l&&l[c]||m+c,onload:function(b){if(b){b=JSON.parse(b);if(i){var d=b.parameters,g=b.techniques,l=b.programs,m,s,u,v,x,D,t,B,w,A,E;for(m in d)if(d.hasOwnProperty(m)&&
(s=k[m],void 0!==s)){d[m].rows=s;u={};for(v in g)if(g.hasOwnProperty(v)){x=g[v];D=x.length;for(t=0;t<D;t+=1)if(B=x[t],-1!==B.parameters.indexOf(m)){B=B.programs;w=B.length;for(A=0;A<w;A+=1)u[B[A]]=!0}}x=RegExp("uniform\\s+(\\w+)\\s+"+m+"\\s*\\[[^\\]]+\\]","mg");s="uniform $1 "+m+"["+s+"]";for(E in u)u.hasOwnProperty(E)&&(D=l[E],D.code=D.code.replace(x,s))}}(m=a.createShader(b))?h[c]=m:delete h[c];z.notify(m);delete j[c]}else f&&(f.innerHTML+="ShaderManager.load:&nbsp;'"+c+"' failed to load<br>"),
delete h[c];delete e[c];r-=1}})}return g}return u},D=function(a,b){h[a]=h[b]},u=function(a){a=h[a];return!a?g:a},z=function(a){"undefined"!==typeof h[a]&&delete h[a]},t=function(a,b){z(a);s(a,b)},c=new Be;f?(c.load=function(a,b){f.innerHTML+="ShaderManager.load:&nbsp;'"+a+"'<br>";return s(a,b)},c.map=function(a,b){f.innerHTML+="ShaderManager.map:&nbsp;'"+b+"' -> '"+a+"'<br>";D(a,b)},c.get=function(a){f.innerHTML+="ShaderManager.get:&nbsp;'"+a+"'<br>";return u(a)},c.remove=function(a){f.innerHTML+=
"ShaderManager.remove:&nbsp;'"+a+"'<br>";z(a)},c.reload=function(a,b){f.innerHTML+="ShaderManager. reload:&nbsp;'"+a+"'<br>";t(a,b)}):(c.load=s,c.map=D,c.get=u,c.remove=z,c.reload=t);c.reloadAll=function(){for(var a in h)h.hasOwnProperty(a)&&"default"!==a&&t(a)};c.getAll=function(){return h};c.getNumPendingShaders=function(){return r};c.isShaderLoaded=function(a){return!e[a]};c.isShaderMissing=function(a){return!h[a]};c.setPathRemapping=function(a,b){l=a;m=b};c.setAutomaticParameterResize=function(a,
b){i=!0;k[a]=b};c.destroy=function(){if(h){for(var c in h)if(h.hasOwnProperty(c)){var d=h[c];d&&d.destroy()}h=null}j=e=g=null;r=0;a=b=m=l=null};return c};Be.version=1;var bc=function(){};bc.prototype.setTexture=function(a){this.texture=a;this.textureChangedObserver&&this.textureChangedObserver.notify(this)};bc.prototype.getTexture=function(){return this.texture};bc.prototype.subscribeTextureChanged=function(a){this.textureChangedObserver||(this.textureChangedObserver=ub.create());this.textureChangedObserver.subscribe(a)};
bc.prototype.unsubscribeTextureChanged=function(a){this.textureChangedObserver.unsubscribe(a)};bc.prototype.destroy=function(){"default"!==this.texture.name&&this.texture.destroy();delete this.texture;delete this.textureChangedObserver};bc.create=function(a,b){var c=new bc;c.name=a;c.texture=b;c.reference=Sb.create(c);return c};bc.version=1;var Ia=function(){};Ia.prototype.add=function(a,b,c){var d=this.textureInstances[a];d?d.setTexture(b):(this.textureInstances[a]=bc.create(a,b),this.textureInstances[a].reference.subscribeDestroyed(this.onTextureInstanceDestroyed));
c&&(this.internalTexture[a]=!0,this.textureInstances[a].reference.add())};Ia.prototype.get=function(a){a=this.textureInstances[a];return!a?this.defaultTexture:a.getTexture()};Ia.prototype.getInstance=function(a){return this.textureInstances[a]};Ia.prototype.load=function(a,b,c){var d=this;void 0===a&&this.errorCallback("Invalid texture path passed to TextureManager.Load");var f=this.textureInstances[a];if(!f||f.texture===this.defaultTexture&&"default"!==a){f||this.add(a,this.defaultTexture,!1);if(a in
this.loadingTexture)c&&this.loadedTextureObservers[a].subscribe(c);else if(0===this.numLoadingArchives){this.loadingTexture[a]=!0;this.numLoadingTextures+=1;var g=!0;b&&(g=!1);var h=ub.create();this.loadedTextureObservers[a]=h;c&&h.subscribe(c);this.requestHandler.request({src:this.pathRemapping&&this.pathRemapping[a]||this.pathPrefix+a,requestFn:function(a,b){d.graphicsDevice.createTexture({src:a,mipmaps:g,onload:b})||d.errorCallback("Texture '"+a+"' not created.")},onload:function(b,c){200===c&&
b&&d.add(a,b,!1);h.notify(b);delete d.loadedTextureObservers[a];delete d.loadingTexture[a];d.numLoadingTextures-=1}})}else this.delayedTextures[a]={nomipmaps:b,onload:c};return this.get(a)}var e=this.get(a);c&&TurbulenzEngine.setTimeout(function(){c(e)},0);return e};Ia.prototype.map=function(a,b){this.textureInstances[a]?this.textureInstances[a].setTexture(this.textureInstances[b].getTexture()):(this.textureInstances[a]=bc.create(a,this.textureInstances[b].getTexture()),this.textureInstances[a].reference.subscribeDestroyed(this.onTextureInstanceDestroyed));
this.internalTexture[a]=!0};Ia.prototype.remove=function(a){!this.internalTexture[a]&&a in this.textureInstances&&(this.textureInstances[a].reference.unsubscribeDestroyed(this.onTextureInstanceDestroyed),delete this.textureInstances[a])};Ia.prototype.loadArchive=function(a,b,c,d){var f=this,g=this.archivesLoaded[a];if(g){if(c){var b=g.textures,h=0,e=function(a){return function(){c(a);h-=1;0===h&&d&&d(g)}},j;for(j in b)b.hasOwnProperty(j)&&(h+=1,TurbulenzEngine.setTimeout(e(b[j]),0))}}else if(a in
this.loadingArchives)c&&this.loadedArchiveObservers[a].subscribe(function(){var b=f.archivesLoaded[a],g=b.textures,h;for(h in g)g.hasOwnProperty(h)&&c(g[h]);d&&d(b)});else{var r=!0;b&&(r=!1);this.loadingArchives[a]={textures:{}};this.numLoadingArchives+=1;var l=ub.create();this.loadedArchiveObservers[a]=l;d&&l.subscribe(d);f.requestHandler.request({src:f.pathRemapping&&f.pathRemapping[a]||f.pathPrefix+a,requestFn:function(b,d){f.graphicsDevice.loadTexturesArchive({src:b,mipmaps:r,ontextureload:function(b){var d=
b.name;if(!(d in f.textureInstances)||f.textureInstances[d].texture===f.defaultTexture)f.add(d,b,!1),f.loadingArchives[a].textures[d]=b;c&&c(b);delete f.delayedTextures[d];a in f.loadingTexture&&(delete f.loadingTexture[a],f.numLoadingTextures-=1)},onload:d})||f.errorCallback("Archive '"+a+"' not loaded.")},onload:function(b,c){var d;200===c&&b&&(d={textures:f.loadingArchives[a].textures},f.archivesLoaded[a]=d);l.notify(d);delete f.loadedArchiveObservers[a];delete f.loadingArchives[a];f.numLoadingArchives-=
1;if(0===f.numLoadingArchives){for(var g in f.delayedTextures)f.delayedTextures.hasOwnProperty(g)&&(d=f.delayedTextures[g],f.load(g,d.nomipmaps,d.onload));f.delayedTextures={}}}})}};Ia.prototype.isArchiveLoaded=function(a){return a in this.archivesLoaded};Ia.prototype.removeArchive=function(a){if(a in this.archivesLoaded){var b=this.archivesLoaded[a].textures,c;for(c in b)b.hasOwnProperty(c)&&this.remove(c);delete this.archivesLoaded[a]}};Ia.prototype.getAll=function(){return this.textureInstances};
Ia.prototype.getNumPendingTextures=function(){return this.numLoadingTextures+this.numLoadingArchives};Ia.prototype.isTextureLoaded=function(a){return!(a in this.loadingTexture)&&!(a in this.delayedTextures)};Ia.prototype.isTextureMissing=function(a){return!(a in this.textureInstances)};Ia.prototype.setPathRemapping=function(a,b){this.pathRemapping=a;this.pathPrefix=b};Ia.prototype.addProceduralTexture=function(a){var b=a.name;(a=this.graphicsDevice.createTexture(a))?this.add(b,a,!0):this.errorCallback("Failed to create '"+
b+"' texture.")};Ia.prototype.destroy=function(){if(this.textureInstances){for(var a in this.textureInstances)if(this.textureInstances.hasOwnProperty(a)){var b=this.textureInstances[a];b&&b.destroy()}this.textureInstances=null}this.defaultTexture&&(this.defaultTexture.destroy(),this.defaultTexture=null);this.delayedTextures=this.loadedTextureObservers=this.loadingTexture=null;this.numLoadingTextures=0;this.loadedArchiveObservers=this.loadingArchives=this.archivesLoaded=null;this.numLoadingArchives=
0;this.graphicsDevice=this.requestHandler=this.pathPrefix=this.pathRemapping=this.internalTexture=null};Ia.create=function(a,b,c,d,f){var g=new Ia;d||(d=function(){});c||(c=a.createTexture({name:"default",width:2,height:2,depth:1,format:"R8G8B8A8",cubemap:!1,mipmaps:!0,dynamic:!1,data:[255,20,147,255,255,0,0,255,255,255,255,255,255,20,147,255]}))||d("Default texture not created.");g.textureInstances={};g.loadingTexture={};g.loadedTextureObservers={};g.delayedTextures={};g.numLoadingTextures=0;g.archivesLoaded=
{};g.loadingArchives={};g.loadedArchiveObservers={};g.numLoadingArchives=0;g.internalTexture={};g.pathRemapping=null;g.pathPrefix="";g.graphicsDevice=a;g.requestHandler=b;g.defaultTexture=c;g.errorCallback=d;var h=function(a){a.reference.unsubscribeDestroyed(h);delete g.textureInstances[a.name]};g.onTextureInstanceDestroyed=h;f&&(g.add=function(a,b){f.innerHTML+="TextureManager.add:&nbsp;'"+a+"'";return Ia.prototype.add.call(g,a,b)},g.load=function(a,b){f.innerHTML+="TextureManager.load:&nbsp;'"+
a+"'";return Ia.prototype.load.call(g,a,b)},g.loadArchive=function(a,b){f.innerHTML+="TextureManager.loadArchive:&nbsp;'"+a+"'";return Ia.prototype.loadArchive.call(g,a,b)},g.isArchiveLoaded=function(a){f.innerHTML+="TextureManager.isArchiveLoaded:&nbsp;'"+a+"'";return Ia.prototype.isArchiveLoaded.call(g,a)},g.removeArchive=function(a){f.innerHTML+="TextureManager.removeArchive:&nbsp;'"+a+"'";return Ia.prototype.removeArchive.call(g,a)},g.map=function(a,b){f.innerHTML+="TextureManager.map:&nbsp;'"+
b+"' -> '"+a+"'";Ia.prototype.map.call(g,a,b)},g.get=function(a){f.innerHTML+="TextureManager.get:&nbsp;'"+a+"'";return Ia.prototype.get.call(g,a)},g.getInstance=function(a){f.innerHTML+="TextureManager.getInstance:&nbsp;'"+a+"'";return Ia.prototype.getInstance.call(g,a)},g.remove=function(a){f.innerHTML+="TextureManager.remove:&nbsp;'"+a+"'";Ia.prototype.remove.call(g,a)});g.add("default",c,!0);g.addProceduralTexture({name:"white",width:2,height:2,depth:1,format:"R8G8B8A8",cubemap:!1,mipmaps:!0,
dynamic:!1,data:[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255]});g.addProceduralTexture({name:"black",width:2,height:2,depth:1,format:"R8G8B8A8",cubemap:!1,mipmaps:!0,dynamic:!1,data:[0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,255]});g.addProceduralTexture({name:"flat",width:2,height:2,depth:1,format:"R8G8B8A8",cubemap:!1,mipmaps:!0,dynamic:!1,data:[128,128,255,255,128,128,255,255,128,128,255,255,128,128,255,255]});d=Math.abs;c=[];for(b=0;4>b;b+=1)for(a=0;32>a;a+=1){var e=0.0625*(a+0.5)-
1,e=d(e)-0.03125,e=1-2*e+e*e;0>=e?c.push(0):1<=e?c.push(255):c.push(255*e)}g.addProceduralTexture({name:"quadratic",width:32,height:4,depth:1,format:"L8",cubemap:!1,mipmaps:!0,dynamic:!1,data:c});c=null;d=[];for(b=0;4>b;b+=1){d.push(0);for(a=1;31>a;a+=1)d.push(255);d.push(0)}g.addProceduralTexture({name:"nofalloff",width:32,height:4,depth:1,format:"L8",cubemap:!1,mipmaps:!0,dynamic:!1,data:d});d=null;return g};Ia.version=1;var ed=function(){};ed.prototype.get=function(){return{}};ed.beep=function(a,
b,c,d){for(var f=Math.sin,g=2*Math.PI,c=g*c/b,b=b*d,h,e,d="undefined"!==typeof Float32Array?new Float32Array(b):Array(b),j=h=0;j<b;j+=1)e=f(h)*a,h+=c,h>=g&&(h-=g),d[j]=e;return d};ed.create=function(a,b,c,d,f){d||(d=function(){});var g;c?g=c:(c={name:"default",data:ed.beep(1,4E3,400,1),channels:1,frequency:4E3,onload:function(a){g=a}},a.createSound(c)||d("Default sound not created."));var h={},e={},j={},r=0,l=null,m="";h["default"]=g;var i=function(c,f,i){var q=h[c];if(q)i&&TurbulenzEngine.setTimeout(function(){i(q)},
0);else{if(e[c])i&&j[c].subscribe(i);else{e[c]=!0;r+=1;var k=ub.create();j[c]=k;i&&k.subscribe(i);b.request({src:l&&l[c]||m+c,requestFn:function(b,g){a.createSound({src:b,uncompress:f,onload:g})||d("Sound '"+c+"' not created.")},onload:function(a){a?(h[c]=a,k.notify(a),delete j[c]):delete h[c];delete e[c];r-=1}})}return g}return q},k=function(a,b){h[a]=h[b]},s=function(a){a=h[a];return!a?g:a},D=function(a){"undefined"!==typeof h[a]&&delete h[a]},u=function(a){D(a);i(a)},c=new ed;f?(c.load=function(a,
b){f.innerHTML+="SoundManager.load:&nbsp;'"+a+"'";return i(a,b)},c.map=function(a,b){f.innerHTML+="SoundManager.map:&nbsp;'"+b+"' -> '"+a+"'";k(a,b)},c.get=function(a){f.innerHTML+="SoundManager.get:&nbsp;'"+a+"'";return s(a)},c.remove=function(a){f.innerHTML+="SoundManager.remove:&nbsp;'"+a+"'";D(a)},c.reload=function(a){f.innerHTML+="SoundManager. reload:&nbsp;'"+a+"'";u(a)}):(c.load=i,c.map=k,c.get=s,c.remove=D,c.reload=u);c.reloadAll=function(){for(var a in h)h.hasOwnProperty(a)&&"default"!==
a&&u(a)};c.getAll=function(){return h};c.getNumPendingSounds=function(){return r};c.isSoundLoaded=function(a){return!e[a]};c.isSoundMissing=function(a){return!h[a]};c.setPathRemapping=function(a,b){l=a;m=b};c.destroy=function(){if(h){for(var c in h)if(h.hasOwnProperty(c)){var d=h[c];d&&d.destroy()}h=null}j=e=g=null;r=0;a=b=m=l=null};return c};ed.version=1;var cc=function(){this.reasonConnectionLost=0;this.reasonServiceBusy=1};cc.prototype.retryExponential=function(a,b,c){if(!this.notifiedConnectionLost&&
TurbulenzEngine.time-this.connectionLostTime>0.001*this.notifyTime){this.notifiedConnectionLost=!0;var d;d=0===c?this.reasonConnectionLost:this.reasonServiceBusy;a.reason=d;this.onRequestTimeout(d,a)}if(this.connected)this.connectionLostTime=TurbulenzEngine.time,this.connected=this.notifiedConnectionLost=!1,this.reconnectTest=a,a.status=c;else if(this.reconnectTest!==a){var f=this.reconnectedObserver,g=function(){f.unsubscribe(g);b()};f.subscribe(g);return}a.expTime?(a.expTime*=2,a.expTime>this.maxRetryTime&&
(a.expTime=this.maxRetryTime)):a.expTime=this.initialRetryTime;a.retries=a.retries?a.retries+1:1;TurbulenzEngine.setTimeout(b,a.expTime)};cc.prototype.retryAfter=function(a,b,c){a.retries?a.retries+=1:(a.firstRetry=TurbulenzEngine.time,a.retries=1);if(!a.notifiedMaxRetries&&TurbulenzEngine.time-a.firstRetry+b>this.notifyTime){a.notifiedMaxRetries=!0;var d=this.reasonServiceBusy;a.reason=d;this.onRequestTimeout(d,a)}TurbulenzEngine.setTimeout(c,1E3*b)};cc.prototype.request=function(a){var b,c=this,
d=function(d,g){if(!c.destroyed){var h=c.sendEventToHandlers,e=c.handlers;if(0===g||408===g||429===g||480===g||504===g)c.retryExponential(a,b,g);else{if(!c.connected){c.connected=!0;if(c.reconnectTest===a&&c.notifiedConnectionLost)c.onReconnected(c.reconnectTest.reason,c.reconnectTest);c.reconnectTest=null;c.reconnectedObserver.notify()}if(!a.responseFilter||a.responseFilter.call(this,a,b,d,g))if(!c.responseFilter||c.responseFilter(a,b,d,g))a.onload&&(h(e.eventOnload,{eventType:"eventOnload",name:d&&
d.name?d.name:a.src}),a.onload(d,g,a),a.onload=null),a=null}}};b=function(){c.destroyed||(a.requestFn?a.requestOwner?a.requestFn.call(a.requestOwner,a.src,d,a):a.requestFn(a.src,d,a):a.requestOwner?a.requestOwner.request(a.src,d,a):TurbulenzEngine.request(a.src,d))};b()};cc.prototype.addEventListener=function(a,b){var c,d,f;if(this.handlers.hasOwnProperty(a)&&(f=this.handlers[a],b)){d=f.length;for(c=0;c<d;c+=1)if(f[c]===b)return;f.push(b)}};cc.prototype.removeEventListener=function(a,b){var c,d,f;
if(this.handlers.hasOwnProperty(a)&&(f=this.handlers[a],b)){d=f.length;for(c=0;c<d;c+=1)if(f[c]===b){f.splice(c,1);break}}};cc.prototype.sendEventToHandlers=function(a,b){var c,d=a.length;if(d)for(c=0;c<d;c+=1)a[c](b)};cc.prototype.destroy=function(){this.destroyed=!0;this.onRequestTimeout=this.onReconnected=this.handlers=null};cc.create=function(a){var b=new cc;b.initialRetryTime=a.initialRetryTime||500;b.notifyTime=a.notifyTime||4E3;b.maxRetryTime=a.maxRetryTime||8E3;b.notifiedConnectionLost=!1;
b.connected=!0;b.reconnectedObserver=ub.create();b.reconnectTest=null;b.onReconnected=a.onReconnected||function(){};b.onRequestTimeout=a.onRequestTimeout||function(){};b.handlers={eventOnload:[]};return b};var Pj,mc=function(){this.maxVerticesPerVertexBuffer=65535;this.numBuckets=10};mc.prototype.bucket=function(a){return 64>=a?16>=a?8>=a?0:1:32>=a?2:3:512>=a?256>=a?128>=a?4:5:6:2048>=a?1024>=a?7:8:9};mc.prototype.makeBuckets=function(){for(var a=[],b=0;b<this.numBuckets;b+=1)a.push({headChunk:null});
return a};mc.prototype.allocate=function(a,b){var c=null,d=0,f={numVertices:void 0,attributes:b,dynamic:this.dynamicVertexBuffers},g,h=this.maxVerticesPerVertexBuffer,e="",j;for(g=0;g<b.length;g+=1)j=b[g],e=j.name?e+j.name:"number"===typeof j?e+j:e+j.toString(),e+=",";j=this.vertexBuffersPools.length;var r;for(g=0;g<j;g+=1)if(this.vertexBuffersPools[g].attributesHash===e){r=this.vertexBuffersPools[g];break}r||(r={attributesHash:e,vertexBufferData:[]},this.vertexBuffersPools.push(r));if(a<h){for(j=
this.bucket(a);!c&&j<this.numBuckets;j+=1)for(var l,m=0;!c&&m<r.vertexBufferData.length;m+=1){e=r.vertexBufferData[m];l=null;for(var i=e.bucket[j].headChunk;i;i=i.nextChunk){if(a<=i.length){c=e.vertexBuffer;d=i.baseIndex;if(a<i.length){i.baseIndex=d+a;i.length-=a;var k=this.bucket(i.length);k!==j&&(l?l.nextChunk=i.nextChunk:e.bucket[j].headChunk=i.nextChunk,i.nextChunk=e.bucket[k].headChunk,e.bucket[k].headChunk=i)}else l?l.nextChunk=i.nextChunk:e.bucket[j].headChunk=i.nextChunk,i.vertexBuffer=null;
break}l=i}}c||(f.numVertices=h,c=this.graphicsDevice.createVertexBuffer(f),this.debugCreatedVertexBuffers+=1,c&&(e={vertexBuffer:c,bucket:this.makeBuckets()},e.bucket[this.bucket(h-a)].headChunk={baseIndex:a,length:h-a,nextChunk:null},r.vertexBufferData.push(e)))}c||(f.numVertices=a,c=this.graphicsDevice.createVertexBuffer(f),this.debugCreatedVertexBuffers+=1,c&&r.vertexBufferData.push({vertexBuffer:c,bucket:this.makeBuckets()}));return{vertexBuffer:c,baseIndex:d,length:a,poolIndex:g}};mc.prototype.free=
function(a){for(var b=this.vertexBuffersPools[a.poolIndex],c,d=0;d<b.vertexBufferData.length;d+=1)if(a.vertexBuffer===b.vertexBufferData[d].vertexBuffer){c=b.vertexBufferData[d];break}for(var f,g,h,e,j,r=0;(!f||!h)&&r<this.numBuckets;r+=1){j=null;for(var l=c.bucket[r].headChunk;l&&(!f||!h);l=l.nextChunk)!f&&l.baseIndex+l.length===a.baseIndex&&(f=l,g=j),!h&&l.baseIndex===a.baseIndex+a.length&&(h=l,e=j),j=l}f&&h?(j=this.bucket(f.length),f.length+=a.length+h.length,e?(e.nextChunk=h.nextChunk,h===g&&
(g=e)):(c.bucket[this.bucket(h.length)].headChunk=h.nextChunk,h===g&&(g=null)),a=this.bucket(f.length),a!==j&&(g?g.nextChunk=f.nextChunk:c.bucket[j].headChunk=f.nextChunk,f.nextChunk=c.bucket[a].headChunk,c.bucket[a].headChunk=f)):f?(j=this.bucket(f.length),f.length+=a.length,a=this.bucket(f.length),a!==j&&(g?g.nextChunk=f.nextChunk:c.bucket[j].headChunk=f.nextChunk,f.nextChunk=c.bucket[a].headChunk,c.bucket[a].headChunk=f)):h?(j=this.bucket(h.length),h.baseIndex=a.baseIndex,h.length+=a.length,a=
this.bucket(h.length),a!==j&&(e?e.nextChunk=h.nextChunk:c.bucket[j].headChunk=h.nextChunk,h.nextChunk=c.bucket[a].headChunk,c.bucket[a].headChunk=h)):(f=c.bucket[this.bucket(a.length)],f.headChunk={baseIndex:a.baseIndex,length:a.length,nextChunk:f.headChunk});if((a=c.bucket[this.numBuckets-1].headChunk)&&a.length>=this.maxVerticesPerVertexBuffer)b.vertexBufferData.splice(d,1),c.vertexBuffer.destroy(),c.vertexBuffer=null,c.bucket.length=0,c.bucket=null};mc.prototype.destroy=function(){var a=this.vertexBuffersPools;
if(a){var b=a.length,c,d;for(c=0;c<b;c+=1){var f=a[c].vertexBufferData,g=f.length;for(d=0;d<g;d+=1){var h=f[d],e=h.bucket;e&&(e.length=0,h.bucket=null);if(e=h.vertexBuffer)e.destroy(),h.vertexBuffer=null}f.length=0}a.length=0;this.vertexBuffersPools=null}this.graphicsDevice=null};mc.create=function(a,b){var c=new mc;c.vertexBuffersPools=[];c.debugCreatedVertexBuffers=0;c.graphicsDevice=a;c.dynamicVertexBuffers=b?!0:!1;return c};mc.version=1;Pj=mc;var Qj,nc=function(){this.maxIndicesPerIndexBuffer=
262144;this.numBuckets=10};nc.prototype.bucket=function(a){return 64>=a?16>=a?8>=a?0:1:32>=a?2:3:512>=a?256>=a?128>=a?4:5:6:2048>=a?1024>=a?7:8:9};nc.prototype.makeBuckets=function(){for(var a=[],b=0;b<this.numBuckets;b+=1)a.push({headChunk:null});return a};nc.prototype.allocate=function(a,b){var c=null,d=0;"string"===typeof b&&(b=this.graphicsDevice["INDEXFORMAT_"+b]);var f={numIndices:void 0,format:b,dynamic:this.dynamicIndexBuffers},g,h=this.maxIndicesPerIndexBuffer,e=this.indexBuffersPools.length,
j;for(g=0;g<e;g+=1)if(this.indexBuffersPools[g].format===b){j=this.indexBuffersPools[g];break}j||(j={format:b,indexBufferData:[]},this.indexBuffersPools.push(j));if(a<h){for(var r=this.bucket(a);!c&&r<this.numBuckets;r+=1)for(var l,m=0;!c&&m<j.indexBufferData.length;m+=1){e=j.indexBufferData[m];l=null;for(var i=e.bucket[r].headChunk;i;i=i.nextChunk){if(a<=i.length){c=e.indexBuffer;d=i.baseIndex;if(a<i.length){i.baseIndex=d+a;i.length-=a;var k=this.bucket(i.length);k!==r&&(l?l.nextChunk=i.nextChunk:
e.bucket[r].headChunk=i.nextChunk,i.nextChunk=e.bucket[k].headChunk,e.bucket[k].headChunk=i)}else l?l.nextChunk=i.nextChunk:e.bucket[r].headChunk=i.nextChunk,i.indexBuffer=null;break}l=i}}c||(f.numIndices=h,c=this.graphicsDevice.createIndexBuffer(f),this.debugCreatedIndexBuffers+=1,c&&(e={indexBuffer:c,bucket:this.makeBuckets()},e.bucket[this.bucket(h-a)].headChunk={baseIndex:a,length:h-a,nextChunk:null},j.indexBufferData.push(e)))}c||(f.numIndices=a,c=this.graphicsDevice.createIndexBuffer(f),this.debugCreatedIndexBuffers+=
1,c&&j.indexBufferData.push({indexBuffer:c,bucket:this.makeBuckets()}));return{indexBuffer:c,baseIndex:d,length:a,poolIndex:g}};nc.prototype.free=function(a){for(var b=this.indexBuffersPools[a.poolIndex],c,d=0;d<b.indexBufferData.length;d+=1)if(a.indexBuffer===b.indexBufferData[d].indexBuffer){c=b.indexBufferData[d];break}for(var f,g,h,e,j,r=0;(!f||!h)&&r<this.numBuckets;r+=1){j=null;for(var l=c.bucket[r].headChunk;l&&(!f||!h);l=l.nextChunk)!f&&l.baseIndex+l.length===a.baseIndex&&(f=l,g=j),!h&&l.baseIndex===
a.baseIndex+a.length&&(h=l,e=j),j=l}f&&h?(j=this.bucket(f.length),f.length+=a.length+h.length,e?(e.nextChunk=h.nextChunk,h===g&&(g=e)):(c.bucket[this.bucket(h.length)].headChunk=h.nextChunk,h===g&&(g=null)),a=this.bucket(f.length),a!==j&&(g?g.nextChunk=f.nextChunk:c.bucket[j].headChunk=f.nextChunk,f.nextChunk=c.bucket[a].headChunk,c.bucket[a].headChunk=f)):f?(j=this.bucket(f.length),f.length+=a.length,a=this.bucket(f.length),a!==j&&(g?g.nextChunk=f.nextChunk:c.bucket[j].headChunk=f.nextChunk,f.nextChunk=
c.bucket[a].headChunk,c.bucket[a].headChunk=f)):h?(j=this.bucket(h.length),h.baseIndex=a.baseIndex,h.length+=a.length,a=this.bucket(h.length),a!==j&&(e?e.nextChunk=h.nextChunk:c.bucket[j].headChunk=h.nextChunk,h.nextChunk=c.bucket[a].headChunk,c.bucket[a].headChunk=h)):(f=c.bucket[this.bucket(a.length)],f.headChunk={baseIndex:a.baseIndex,length:a.length,nextChunk:f.headChunk});if((a=c.bucket[this.numBuckets-1].headChunk)&&a.length>=this.maxIndicesPerIndexBuffer)b.indexBufferData.splice(d,1),c.indexBuffer.destroy(),
c.indexBuffer=null,c.bucket.length=0,c.bucket=null};nc.prototype.destroy=function(){var a=this.indexBuffersPools;if(a){var b=a.length,c,d;for(c=0;c<b;c+=1){var f=a[c].indexBufferData,g=f.length;for(d=0;d<g;d+=1){var h=f[d],e=h.bucket;e&&(e.length=0,h.bucket=null);if(e=h.indexBuffer)e.destroy(),h.indexBuffer=null}f.length=0}a.length=0;this.indexBuffersPools=null}this.graphicsDevice=null};nc.create=function(a,b){var c=new nc;c.indexBuffersPools=[];c.debugCreatedIndexBuffers=0;c.graphicsDevice=a;c.dynamicIndexBuffers=
b?!0:!1;return c};nc.version=1;Qj=nc;var dc=function(){};dc.prototype.listUserBadges=function(a,b){var c=this;this.service.request({url:"/api/v1/badges/progress/read/"+this.gameSession.gameSlug,method:"GET",callback:function(d,f){200===f?a(d.data):404===f?a(null):(b||c.errorCallbackFn)("Badges.listUserBadges failed with status "+f+": "+d.msg,f,[a])},requestHandler:this.requestHandler},"badge.read")};dc.prototype.awardUserBadge=function(a,b,c){this.addUserBadge(a,null,b,c)};dc.prototype.updateUserBadgeProgress=
function(a,b,c,d){b&&"number"===typeof b?this.addUserBadge(a,b,c,d):(d||this.errorCallbackFn)("Badges.updateUserBadgeProgress expects a numeric value for current",400,[a,b,c])};dc.prototype.addUserBadge=function(a,b,c,d){var f=this,g={};g.gameSessionId=this.gameSessionId;g.badge_key=a;var h="/api/v1/badges/progress/add/"+this.gameSession.gameSlug;b&&(g.current=b);this.service.request({url:h,method:"POST",data:g,callback:function(g,h){if(200===h){var e=g.data;e.gameSlug=f.gameSession.gameSlug;oa.updateUserBadge(e);
c(e)}else(d||f.errorCallbackFn)("Badges.addUserBadge failed with status "+h+": "+g.msg,h,[a,b,c])},requestHandler:this.requestHandler,encrypt:!0},"badge.add")};dc.prototype.listBadges=function(a,b){var c=this;this.service.request({url:"/api/v1/badges/read/"+c.gameSession.gameSlug,method:"GET",callback:function(d,f){200===f?a(d.data):404===f?a(null):(b||c.errorCallbackFn)("Badges.listBadges failed with status "+f+": "+d.msg,f,[a])},requestHandler:this.requestHandler},"badge.meta")};dc.prototype.errorCallbackFn=
function(){var a=Array.prototype.slice.call(arguments);La.log("BadgeManager error: ",a)};dc.create=function(a,b){if(!wa.available())return null;var c=new dc;c.gameSession=b;c.gameSessionId=b.gameSessionId;c.service=wa.getService("badges");c.requestHandler=a;return c};dc.version=1;var Lb=function(){this.post_delay=1E3};Lb.prototype.setStatus=function(a){this.destroyed||this.status===a||(this.status=a,oa.setGameSessionStatus(this.gameSessionId,a))};Lb.prototype.destroy=function(a){var b;this.pendingUpdate&&
(TurbulenzEngine.clearTimeout(this.pendingUpdate),this.pendingUpdate=null);!this.destroyed&&this.gameSessionId?(oa.destroyedGameSession(this.gameSessionId),this.destroyed=!0,b={gameSessionId:this.gameSessionId},this.service.request({url:"/api/v1/games/destroy-session",method:"POST",data:b,callback:a,requestHandler:this.requestHandler},"gamesession.destroy")):a&&TurbulenzEngine.setTimeout(a,0)};Lb.prototype.setTeamInfo=function(a){var b=this.info.sessionData,c=b.teamList||[];a.join("#")!==c.join("#")&&
(b.teamList=a,this.update())};Lb.prototype.setPlayerInfo=function(a,b){var c=this.info.playerSessionData[a],d,f=!1;c||(c={},this.info.playerSessionData[a]=c,f=!0);for(d in b)if(b.hasOwnProperty(d)){if(!this.templatePlayerData.hasOwnProperty(d))throw"unknown session data property "+d;c[d]!==b[d]&&(c[d]=b[d],f=!0)}f&&this.update()};Lb.prototype.removePlayerInfo=function(a){delete this.info.playerSessionData[a];this.update()};Lb.prototype.clearAllPlayerInfo=function(){this.info.playerSessionData={};
this.update()};Lb.prototype.update=function(){this.pendingUpdate||(this.pendingUpdate=TurbulenzEngine.setTimeout(this.postData,this.post_delay))};Lb.create=function(a,b,c){var d=new Lb,f=window.gameSlug,g=window.top.Turbulenz,g=(g&&g.Data||{}).mode||wa.mode,h="/api/v1/games/create-session/"+f;d.info={sessionData:{},playerSessionData:{}};d.templatePlayerData={team:null,color:null,status:null,rank:null,score:null,sortkey:null};d.postData=function(){oa.setGameSessionInfo(JSON.stringify(d.info));d.pendingUpdate=
null};d.pendingUpdate=null;d.gameSlug=f;d.requestHandler=a;d.errorCallbackFn=c||wa.defaultErrorCallback;d.gameSessionId=null;d.service=wa.getService("gameSessions");d.status=null;if(!wa.available())return b&&TurbulenzEngine.setTimeout(function(){b(d)},0),d;g&&(h+="/"+g);d.service.request({url:h,method:"POST",callback:function(a,c){200===c?(d.mappingTable=a.mappingTable,d.gameSessionId=a.gameSessionId,b&&b(d),oa.createdGameSession(d.gameSessionId)):d.errorCallbackFn("TurbulenzServices.createGameSession error with HTTP status "+
c+": "+a.msg,c)},requestHandler:a,neverDiscard:!0},"gamesession.create");return d};Lb.version=1;var ec=function(){this.getTypes={top:"top",near:"near",above:"above",below:"below"};this.maxGetSize=32};ec.prototype.getOverview=function(a,b,c){var d=c||this.errorCallbackFn;if(this.meta){var f=this,c={};a.friendsOnly&&(c.friendsonly=a.friendsOnly&&1);this.service.request({url:"/api/v1/leaderboards/scores/read/"+f.gameSession.gameSlug,method:"GET",data:c,callback:function(c,h){if(200===h){for(var e=c.data,
j=e.length,r=0;r<j;r+=1){var l=e[r];l.hasOwnProperty("score")&&(f.meta[l.key].bestScore=l.score)}b(e)}else d("LeaderboardManager.getKeys failed with status "+h+": "+c.msg,h,f.getOverview,[a,b])},requestHandler:this.requestHandler},"leaderboard.read")}else d("The leaderboard manager failed to initialize properly.")};ec.prototype.getAggregates=function(a,b,c){var d=c||this.errorCallbackFn;if(this.meta){var f=this;this.service.request({url:"/api/v1/leaderboards/aggregates/read/"+f.gameSession.gameSlug,
method:"GET",data:{},callback:function(g,h){200===h?b(g.data):d("LeaderboardManager.getKeys failed with status "+h+": "+g.msg,h,f.getAggregates,[a,b,c])},requestHandler:this.requestHandler},"leaderboard.aggregates")}else d("The leaderboard manager failed to initialize properly.")};ec.prototype.getRaw=function(a,b,c,d){var f=this,g=d||this.errorCallbackFn;this.service.request({url:"/api/v1/leaderboards/scores/read/"+f.gameSession.gameSlug+"/"+a,method:"GET",data:b,callback:function(d,e){200===e?c(d.data):
g("LeaderboardManager.get failed with status "+e+": "+d.msg,e,f.get,[a,b,c])},requestHandler:this.requestHandler},"leaderboard.read");return!0};ec.prototype.get=function(a,b,c,d){var f=d||this.errorCallbackFn;if(!this.meta)return f("The leaderboard manager failed to initialize properly."),!1;if(!this.meta[a])return f("No leaderboard with the name '"+a+"' exists."),!1;var g={};b.numNear&&(g.type=this.getTypes.near,g.size=2*b.numNear+1);b.numTop&&(g.type=this.getTypes.top,g.size=b.numTop);b.size&&(g.size=
b.size);g.size||(g.size=9);if(g.size>this.maxGetSize)throw Error("Leaderboard get request size must be smaller than "+this.maxGetSize);b.friendsOnly&&(g.friendsonly=b.friendsOnly&&1);b.type&&(g.type=b.type);b.hasOwnProperty("score")&&(g.score=b.score);b.hasOwnProperty("time")&&(g.time=b.time);var h=this;return this.getRaw(a,g,function(b){b=Qg.create(h,a,g,b);c(a,b)},d)};ec.prototype.set=function(a,b,c,d){var f=d||this.errorCallbackFn;if(this.meta){var g=this.meta[a];if(g){if("number"!==typeof b||
isNaN(b))throw Error("Score must be a number.");if(0>b)throw Error("Score cannot be negative.");var d=g.sortBy,h=g.bestScore;if(h&&(1===d&&b<=h||-1===d&&b>=h))TurbulenzEngine.setTimeout(function(){c(a,b,!1,h)},0);else{var e=this;this.service.request({url:"/api/v1/leaderboards/scores/set/"+a,method:"POST",data:{score:b,gameSessionId:e.gameSessionId,key:void 0},callback:function(d,h){if(200===h){var l=d.data,i=l.bestScore||l.lastScore||null,k=l.newBest||!1;k&&(i=b,oa.updateLeaderBoard({key:a,title:g.title,
sortBy:g.sortBy,score:b,prevBest:l.prevBest,gameSlug:e.gameSession.gameSlug}));g.bestScore=i;c(a,b,k,i)}else f("LeaderboardManager.set failed with status "+h+": "+d.msg,h,e.set,[a,b,c])},requestHandler:this.requestHandler,encrypt:!0},"leaderboard.set")}}else f("No leaderboard with the name '"+a+"' exists.")}else f("The leaderboard manager failed to initialize properly.")};ec.prototype.reset=function(a,b){var c=b||this.errorCallbackFn;if(this.meta){var d=this;this.service.request({url:"/api/v1/leaderboards/scores/remove-all/"+
this.gameSession.gameSlug,method:"POST",callback:function(b,g){if(200===g){var h=d.meta,e;for(e in h)h.hasOwnProperty(e)&&delete h[e].bestScore;a&&a()}else c("LeaderboardManager.reset failed with status "+g+": "+b.msg,g,d.reset,[a])},requestHandler:this.requestHandler},"leaderboard.removeall")}else c("The leaderboard manager failed to initialize properly.")};ec.create=function(a,b,c,d){if(!wa.available())return TurbulenzEngine.setTimeout(function(){d&&d("TurbulenzServices.createLeaderboardManager could not load leaderboards meta data")},
0),null;var f=new ec;f.gameSession=b;f.gameSessionId=b.gameSessionId;f.errorCallbackFn=d||wa.defaultErrorCallback;f.service=wa.getService("leaderboards");f.requestHandler=a;f.ready=!1;f.service.request({url:"/api/v1/leaderboards/read/"+b.gameSlug,method:"GET",callback:function(a,b){if(200===b){var d=a.data;if(d){f.meta={};var e=d.length,r;for(r=0;r<e;r+=1){var l=d[r];f.meta[l.key]=l}}f.ready=!0;c&&c(f)}else f.errorCallbackFn("TurbulenzServices.createLeaderboardManager error with HTTP status "+b+": "+
a.msg,b)},requestHandler:a,neverDiscard:!0},"leaderboard.meta");return f};ec.version=1;var Qg,hb=function(){};hb.prototype.computeOverlap=function(){var a=this.results,b=0;if(a.top||a.bottom){var c=a.ranking,d=c.length,f=this.leaderboardManager.meta[this.key].sortBy,g=this.leaderboardManager.getTypes.above,h=a.spec.score,e=a.spec.time,j;for(j=0;j<d;j+=1){var r=c[j];if(r.score*f<h*f||r.score===h&&r.time>=e){b=a.spec.type===g?d-j:j+1;break}}}a.overlap=b};hb.prototype.getPageOffset=function(a,b,c,d){b=
this.results.ranking[b];if(!b)return TurbulenzEngine.setTimeout(c,0),!1;var f={type:a,score:b.score,time:b.time,size:this.requestSize,friendsonly:this.originalSpec.friendsOnly&&1||0};this.spec=f;var g=this;this.leaderboardManager.getRaw(this.key,f,function(a){g.parseResults(g.key,f,a);g.computeOverlap();c()},d);return!0};hb.prototype.viewOperationBegin=function(){return this.viewLock?!1:this.viewLock=!0};hb.prototype.viewOperationEnd=function(a){function b(){a(c.key,c)}this.viewLock=!1;var c=this;
a&&TurbulenzEngine.setTimeout(b,0)};hb.prototype.wrapViewOperationError=function(a){var b=this;return function(c,d,f,g){b.viewLock=!1;a(c,d,f,g)}};hb.prototype.refresh=function(a,b){if(!this.viewOperationBegin())return!1;var c=this;this.leaderboardManager.getRaw(this.key,this.spec,function(b){c.parseResults(c.key,c.spec,b);c.computeOverlap();c.invalidView=!0;if(c.onSlidingWindowUpdate)c.onSlidingWindowUpdate();c.viewOperationEnd(a)},this.wrapViewOperationError(b));return!0};hb.prototype.moveUp=function(a,
b,c){function d(){var a=f.results;f.viewTop=Math.max(0,a.ranking.length-f.viewSize-a.overlap);f.invalidView=!0;if(f.onSlidingWindowUpdate)f.onSlidingWindowUpdate();f.viewOperationEnd(b)}if(!this.viewOperationBegin())return!1;var f=this;if(0>this.viewTop-a)return this.results.top?(this.viewTop=0,this.viewOperationEnd(b)):this.getPageOffset(this.leaderboardManager.getTypes.above,this.viewTop+this.viewSize-a,d,this.wrapViewOperationError(c)),!0;this.viewTop-=a;this.invalidView=!0;this.viewOperationEnd(b);
return!0};hb.prototype.moveDown=function(a,b,c){function d(){var a=f.results;f.viewTop=Math.min(a.overlap,Math.max(a.ranking.length-f.viewSize,0));f.invalidView=!0;if(f.onSlidingWindowUpdate)f.onSlidingWindowUpdate();f.viewOperationEnd(b)}if(!this.viewOperationBegin())return!1;var f=this,g=this.results;if(this.viewTop+this.viewSize+a>g.ranking.length)return g.bottom?(a=this.viewTop,this.viewTop=Math.max(g.ranking.length-this.viewSize,0),this.invalidView=this.invalidView||this.viewTop!==a,this.viewOperationEnd(b)):
this.getPageOffset(this.leaderboardManager.getTypes.below,this.viewTop+a-1,d,this.wrapViewOperationError(c)),!0;this.viewTop+=a;this.invalidView=!0;this.viewOperationEnd(b);return!0};hb.prototype.pageUp=function(a,b){return this.moveUp(this.viewSize,a,b)};hb.prototype.pageDown=function(a,b){return this.moveDown(this.viewSize,a,b)};hb.prototype.scrollUp=function(a,b){return this.moveUp(1,a,b)};hb.prototype.scrollDown=function(a,b){return this.moveDown(1,a,b)};hb.prototype.getView=function(){if(this.invalidView){var a=
this.viewTop,b=this.viewSize,c=this.results,d=c.ranking,f=d.length,g=null;if(void 0!==c.playerIndex&&(g=c.playerIndex-a,0>g||g>=b))g=null;this.view={ranking:d.slice(a,Math.min(a+b,f)),top:c.top&&0===a,bottom:c.bottom&&a>=f-b,player:c.player,playerIndex:g}}return this.view};hb.prototype.getSlidingWindow=function(){return this.results};hb.prototype.parseResults=function(a,b,c){var b={spec:b,overlap:null},d=b.player=c.player,f=b.ranking=c.ranking,g=c.entities,h;d&&(this.leaderboardManager.meta[a].bestScore=
d.score,g&&(d.user=g[d.user]),h=d.user.username);a=f.length;for(d=0;d<a;d+=1){var e=f[d];g&&(e.user=g[e.user]);e.user.username===h&&(b.playerIndex=d)}b.top=c.top;b.bottom=c.bottom;return this.results=b};hb.create=function(a,b,c,d){var f=new hb;f.leaderboardManager=a;f.key=b;c.friendsOnly=0!=c.friendsonly;delete c.friendsonly;f.originalSpec=c;f.spec=c;a=f.results=f.parseResults(b,c,d);f.viewTop=0;f.viewSize=c.size;f.viewLock=!1;f.view={player:a.player,ranking:a.ranking,playerIndex:a.playerIndex,top:a.top,
bottom:a.bottom};f.invalidView=!1;f.onSlidingWindowUpdate=null;return f};Qg=hb;Qg.prototype.version=1;Qg.prototype.requestSize=64;var fc=function(){};fc.prototype.getURL=function(a,b){for(var c=this.overrides,d=c[this.currentProfile],f;d;){if(f=d.urnmapping[a])return f;d=c[d.parent]}if(f=this.urlMapping[a])return f;b&&b(a);return this.assetPrefix+a};fc.prototype.setMapping=function(a){this.urlMapping=a};fc.prototype.map=function(a,b){this.urlMapping[a]=b};fc.prototype.alias=function(a,b){var c=this.urlMapping;
c[a]=c[b]};fc.prototype.getCurrentProfile=function(){return this.currentProfile};fc.prototype.setProfile=function(a){this.currentProfile=this.overrides.hasOwnProperty(a)?a:void 0};fc.create=function(a){var b=new fc;b.mappingTableURL=a.mappingTableURL;b.tablePrefix=a.mappingTablePrefix;b.assetPrefix=a.assetPrefix;b.overrides={};b.errorCallbackFn=a.errorCallback||wa.defaultErrorCallback;b.currentProfile=TurbulenzEngine.getSystemInfo().platformProfile;var c=function(c){var f=c.urnmapping||c.urnremapping||
{},c=c.overrides||{};b.urlMapping=f;b.overrides=c;var g=b.tablePrefix;if(g){var h=function(a){for(var b in a)a.hasOwnProperty(b)&&(a[b]=g+a[b])};h(f);for(var e in c)c.hasOwnProperty(e)&&h(c[e].urnmapping)}a.onload(b)};b.mappingTableURL?a.requestHandler.request({src:b.mappingTableURL,onload:function(a,f){if(200===f){var g=JSON.parse(a);c(g)}else b.urlMapping={},a=a||{msg:"(no response)"},b.errorCallbackFn("MappingTable.create: HTTP status "+f+": "+a.msg,f)}}):a.mappingTableData?TurbulenzEngine.setTimeout(function(){c(JSON.parse(a.mappingTableData))},
0):TurbulenzEngine.setTimeout(function(){b.errorCallbackFn("!! mappingtable params contain no url or data")},0);return b};fc.version=1;var yb=function(){};yb.prototype.sendTo=function(a,b,c){a=a+":"+b+":";c&&(a+=c);(c=this.socket)?c.send(a):this.queue.push(a)};yb.prototype.sendToGroup=function(a,b,c){a=a.join(",")+":"+b+":";c&&(a+=c);(c=this.socket)?c.send(a):this.queue.push(a)};yb.prototype.sendToAll=function(a,b){var c=":"+a+":";b&&(c+=b);var d=this.socket;d?d.send(c):this.queue.push(c)};yb.prototype.makePublic=
function(a){var b=this.sessionId;this.service.request({url:"/api/v1/multiplayer/session/make-public",method:"POST",data:{session:b},callback:function(){oa.triggerMultiplayerSessionMakePublic(b);a&&a.call(arguments)},requestHandler:this.requestHandler})};yb.prototype.destroy=function(a){var b=this.sessionId;if(b){this.sessionId=null;var c=this.playerId;this.playerId=null;var d=this.gameSessionId;this.gameSessionId=null;var f=this.socket;f&&(this.socket=null,f.onopen=null,f.onmessage=null,f.onclose=
null,f.onerror=null,f.close());this.onclose=this.onmessage=this.queue=null;oa.triggerLeaveMultiplayerSession(b);La.ajax({url:"/api/v1/multiplayer/session/leave",method:"POST",data:{session:b,player:c,gameSessionId:d},callback:a,requestHandler:this.requestHandler})}else a&&TurbulenzEngine.setTimeout(a,0)};yb.prototype.connected=function(){return!!this.socket};yb.prototype.flushQueue=function(){for(var a=this.socket,b=this.queue,c=b.length,d=0;d<c;d+=1)a.send(b[d])};yb.create=function(a,b,c){var d=
new yb;d.sessionId=a.sessionid;d.playerId=a.playerid;d.gameSessionId=a.gameSessionId;d.socket=null;d.queue=[];d.onmessage=null;d.onclose=null;d.requestHandler=a.requestHandler;d.service=wa.getService("multiplayer");var f=a.numplayers,g=a.server,h,a=null,e=function(a){var b=d.onmessage;if(b){var c=a.data,f=c.indexOf(":"),g=c.indexOf(":",f+1),a=c.slice(0,f),f=c.slice(f+1,g)|0,c=c.slice(g+1);b(a,f,c)}},j=function(){var a=function(){h||(h=d.socket);d.socket=null;h&&(h.onopen=null,h.onmessage=null,h.onclose=
null,h=h.onerror=null);d.service.request({url:"/api/v1/multiplayer/session/join",method:"POST",data:{session:d.sessionId,gameSessionId:d.gameSessionId},callback:function(a,h){if(200===h){var e=a.data;f=e.numplayers;g=e.server;d.sessionId=e.sessionid;d.playerId=e.playerid;TurbulenzEngine.setTimeout(j,0)}else if(c)c("MultiPlayerSession failed: Server not available",0),b=c=null;else if(e=d.onclose)d.onclose=null,e()},requestHandler:d.requestHandler})};try{var l=TurbulenzEngine.getNetworkDevice();l||
(l=TurbulenzEngine.createNetworkDevice({}));h=l.createWebSocket(g);h.onopen=function(){d.socket=h;h.onopen=null;h.onmessage=e;h=null;d.flushQueue();oa.triggerJoinedMultiplayerSession({sessionId:d.sessionId,playerId:d.playerId,serverURL:g,numplayers:f});b&&(b(d,f),c=b=null)};h.onclose=h.onerror=a}catch(i){a()}};j();return d};yb.version=1;var Mb=function(){};Mb.prototype.createSession=function(a,b,c){var d=this.gameSession,f=d.gameSessionId,g=this.requestHandler,h=this;this.processRequest("createSession",
{url:"/api/v1/multiplayer/session/create/"+d.gameSlug,method:"POST",data:{slots:a,gameSessionId:f},requestHandler:g},function(a){a=a.data;a.requestHandler=g;a.gameSessionId=f;a=yb.create(a,b,c);h.sessionList.push(a)},c)};Mb.prototype.getJoinRequestQueue=function(){return wa.multiplayerJoinRequestQueue};Mb.prototype.joinSession=function(a,b,c){var d=this.gameSession.gameSessionId,f=this.requestHandler,g=this;this.processRequest("joinSession",{url:"/api/v1/multiplayer/session/join",method:"POST",data:{session:a,
gameSessionId:d},requestHandler:f},function(a){a=a.data;a.requestHandler=f;a.gameSessionId=d;a=yb.create(a,b,c);g.sessionList.push(a)},c)};Mb.prototype.joinAnySession=function(a,b,c){var d=this.gameSession,f=d.gameSessionId,g=this.requestHandler,h=this;this.processRequest("joinAnySession",{url:"/api/v1/multiplayer/session/join-any/"+d.gameSlug,method:"POST",data:{gameSessionId:f},requestHandler:g},function(d){d=d.data;d.sessionid?(d.requestHandler=g,d.gameSessionId=f,d=yb.create(d,a,c),h.sessionList.push(d)):
b()},c)};Mb.prototype.joinOrCreateSession=function(a,b,c){var d=this;this.joinAnySession(b,function(){d.createSession(a,b,c)},c)};Mb.prototype.getFriendsSessions=function(a,b){this.processRequest("getFriendsSessions",{url:"/api/v1/multiplayer/session/list/"+this.gameSession.gameSlug,method:"GET",requestHandler:this.requestHandler},function(b){a(b.data)},b)};Mb.prototype.destroy=function(){var a=this.sessionList,b=a.length,c;for(c=0;c<b;c+=1)a[c].destroy();delete this.sessionList};Mb.prototype.processRequest=
function(a,b,c,d){d||(d=wa.defaultErrorCallback);wa.available()?(b.callback=function(b,g){200===g?c(b):d&&d("MultiPlayerSessionManager."+a+" error with HTTP status "+g+": "+b.msg,g)},wa.getService("multiplayer").request(b)):d&&d(a+" failed: Service not available",0)};Mb.create=function(a,b){var c=new Mb;c.requestHandler=a;c.gameSession=b;c.sessionList=[];return c};var Dc=function(a){this.__nm=this.__error=this.__id=this.__errorCallback=this.__successCallback=null;this.__toCancel=!1;this.__nm=a};Dc.prototype.success=
function(a){this.__successCallback=a;var b=this.__id;b&&TurbulenzEngine.setTimeout(function(){a(b)},0);return this};Dc.prototype.error=function(a){this.__errorCallback=a;var b=this.__error;b&&TurbulenzEngine.setTimeout(function(){a(b)},0);return this};Dc.prototype.cancel=function(){this.__toCancel=!0;var a=this.__id;a&&this.__nm.cancelNotificationByID(a)};Dc.prototype.getId=function(){return this.__id};Dc.prototype.callSuccess=function(a){this.__id=a;this.__successCallback&&this.__successCallback(a);
this.__toCancel&&this.__nm.cancelNotificationByID(a)};Dc.prototype.callError=function(a){this.__error=a;this.__errorCallback&&this.__errorCallback(a)};var Ya=function(){this.keys=[]};Ya.prototype._validateKey=function(a){a=a.key;if(!a||!this.keys[a])throw Error('Unknown key "'+a+'" given.');return a};Ya.prototype._validateMsg=function(a){if(a=a.msg){if(!a.text)throw Error('msg has no "text" attribute.');}else throw Error('No "msg" given.');return a};Ya.prototype.sendInstantNotification=function(a){var b=
this._validateKey(a),c=this._validateMsg(a),d=this.tokenFactory.next(),f=new Dc(this);this.notificationPromises[d]=f;if(!a.recipient)throw Error("Notification recipient is null");a={token:d,session:this.gameSession,key:b,msg:c,recipient:a.recipient,noNotification:a.noNotification};oa.triggerSendInstantNotification(JSON.stringify(a));return f};Ya.prototype.sendDelayedNotification=function(a){var b=this._validateKey(a),c=this._validateMsg(a),d=a.delay||0;if(isNaN(d))throw Error('delay is not a number: "'+
d+'"');var f=this.tokenFactory.next(),g=new Dc(this);this.notificationPromises[f]=g;a={token:f,session:this.gameSession,key:b,msg:c,delay:d,noNotification:a.noNotification};oa.triggerSendDelayedNotification(JSON.stringify(a));return g};Ya.prototype.cancelNotificationByID=function(a){oa.triggerCancelNotificationByID(JSON.stringify({id:a,session:this.gameSession}))};Ya.prototype.cancelNotificationsByKey=function(a){if(!this.keys[a])throw Error('Unknown key "'+a+'" given.');oa.triggerCancelNotificationsByKey(JSON.stringify({key:a,
session:this.gameSession}))};Ya.prototype.cancelAllNotifications=function(){oa.triggerCancelAllNotifications(JSON.stringify({session:this.gameSession}))};Ya.prototype.addNotificationListener=function(a,b){var c;if(this.handlers.hasOwnProperty(a)){c=this.handlers[a];for(var d=c.length,f=0;f<d;f+=1)if(c[f]===b)return}else c=this.handlers[a]=[];c.push(b)};Ya.prototype.removeNotificationListener=function(a,b){if(this.handlers.hasOwnProperty(a))for(var c=this.handlers[a],d=c.length,f=0;f<d;f+=1)if(c[f]===
b){c.splice(f,1);break}};Ya.prototype.onNotificationReceived=function(a){if(this.handlers.hasOwnProperty(a.key))for(var b=this.handlers[a.key].length,c=0;c<b;c+=1)this.handlers[a.key][c](a)};Ya.prototype.onNotificationSent=function(a){var b=a.token,c=this.notificationPromises[b];c&&(a.id&&c.callSuccess(a.id),a.error&&(delete a.token,c.callError(a)),delete this.notificationPromises[b])};Ya.prototype.requestUserNotificationSettings=function(a,b){this.service.request({url:"/api/v1/game-notifications/usersettings/read/"+
this.gameSession.gameSlug,method:"GET",callback:function(c,d){200!==d||!c.ok?b({error:c.msg,status:d}):a(c.data)},requestHandler:this.requestHandler},"notifications.usersettings")};Ya.prototype.requestGameNotificationKeys=function(a,b){var c=this;this.service.request({url:"/api/v1/game-notifications/keys/read/"+this.gameSession.gameSlug,method:"GET",callback:function(d,f){var g=d.data;200!==f||!g.keys?b(g):(c.keys=g.keys,a(g))},requestHandler:this.requestHandler},"notifications.keys")};Ya.prototype.onInit=
function(){this.ready=!0;oa.triggerInitNotificationManager(JSON.stringify({session:this.gameSession}))};Ya.create=function(a,b,c,d){d||(d=function(){});if(!wa.available())return TurbulenzEngine.setTimeout(function(){d({status:null,error:"TurbulenzServices.createNotificationsManager requires Turbulenz services"})},0),null;var f=new Ya;f.gameSession=b;f.handlers={};f.tokenFactory=Ce.create();f.notificationPromises={};oa.setOnNotificationSent(function(a){f.onNotificationSent.call(f,a)});oa.setOnReceiveNotification(function(a){f.onNotificationReceived.call(f,
a)});f.service=wa.getService("notifications");f.requestHandler=a;f.ready=!1;f.requestGameNotificationKeys(function(){f.requestUserNotificationSettings(function(){f.onInit();c&&c(f)},d)},d);return f};Ya.version=1;var Ce,De=function(){this.randomMax=Math.pow(2,32)};De.prototype.next=function(){var a=this.counter+=1,b=Math.random()*this.randomMax,c=this.bytes;c[0]=b&255;c[1]=(b&65280)>>>8;c[2]=(b&16711680)>>>16;c[3]=(b&4278190080)>>>24;c[4]=a&255;c[5]=(a&65280)>>>8;return TurbulenzEngine.base64Encode(c)};
De.create=function(){var a=new De;a.counter=0;a.randomGenerator=null;a.bytes=[];return a};De.version=1;Ce=De;var ib=function(){};ib.prototype.requestUserItems=function(a,b){var c=this,d={token:this.userItemsRequestToken.next(),gameSessionId:this.gameSessionId};this.service.request({url:"/api/v1/store/user/items/read/"+this.gameSession.gameSlug,method:"GET",data:d,callback:function(d,g){if(200===g)c.userItems=d.data.userItems,a&&a(d.userItems);else{var h=b||c.errorCallbackFn;h&&h("StoreManager.requestUserItems failed with status "+
g+": "+d.msg,g,c.requestUserItems,[a,b])}},requestHandler:this.requestHandler,encrypt:!0},"store.useritems")};ib.prototype.getUserItems=function(){return this.userItems};ib.prototype.getItemsSortedDict=function(a){var b=[],c={},d,f;for(d in a)a.hasOwnProperty(d)&&(f=a[d],f.key=d,b[f.index]=f);d=b.length;for(a=0;a<d;a+=1)f=b[a],c[f.key]=f;return c};ib.prototype.getOfferings=function(){return this.getItemsSortedDict(this.offerings)};ib.prototype.getResources=function(){return this.getItemsSortedDict(this.resources)};
ib.prototype.getItems=function(){return this.getOfferings()};ib.prototype.updateBasket=function(a){var b=null;a&&(b=this.basketUpdateRequestToken.next(),this.updateBasketCallbacks[b]=a);var c=this;TurbulenzEngine.setTimeout(function(){oa.triggerBasketUpdate(JSON.stringify({basketItems:c.basket.items,token:b}))},0)};ib.prototype.addToBasket=function(a,b){var c=this.offerings[a];if(!c||!c.available||Math.floor(b)!==b||0>=b)return!1;var d=this.resources,f=this.userItems,g=this.basket.items,h=0,h=g[a]?
g[a].amount:0,e=h+b;a:{var j,r=c.output;for(j in r)if(r.hasOwnProperty(j)&&"own"!==d[j].type){d=!1;break a}d=!0}if(d&&1<e&&(e=1,1===h))return!1;if(!(h=0>=e))if(h=d)a:{var l,c=c.output;for(l in c)if(c.hasOwnProperty(l)&&(!f.hasOwnProperty(l)||0===f[l].amount)){h=!1;break a}h=!0}if(h)return!1;g[a]={amount:e};return!0};ib.prototype.removeFromBasket=function(a,b){if(!this.offerings[a]||Math.floor(b)!==b||0>=b)return!1;var c=this.basket.items[a];if(!c||0>=c.amount)return!1;c=c.amount-b;0>=c?delete this.basket.items[a]:
this.basket.items[a]={amount:c};return!0};ib.prototype.emptyBasket=function(){this.basket.items={}};ib.prototype.isBasketEmpty=function(){var a,b=this.basket.items;for(a in b)if(b.hasOwnProperty(a)&&0<b[a].amount)return!1;return!0};ib.prototype.showConfirmPurchase=function(){if(this.isBasketEmpty())return!1;this.updateBasket(function(){oa.triggerShowConfirmPurchase()});return!0};ib.prototype.consume=function(a,b,c,d){var f=this,a={token:this.consumeRequestToken.next(),gameSessionId:this.gameSessionId,
key:a,consume:b};this.service.request({url:"/api/v1/store/user/items/consume",method:"POST",data:a,callback:function(a,b){if(200===b)f.userItems=a.data.userItems,c&&c(a.data.consumed),oa.triggerUserStoreUpdate(JSON.stringify(f.userItems));else{var e=d||f.errorCallbackFn;e&&e("StoreManager.consume failed with status "+b+": "+a.msg,b,f.consume,[c,d])}},requestHandler:this.requestHandler,encrypt:!0},"store.useritems-consume")};ib.create=function(a,b,c,d){function f(){!h&&(null!==g.offerings&&null!==
g.resources&&null!==g.basket&&null!==g.userItems)&&(c&&c(g),h=g.ready=!0)}if(!wa.available())return TurbulenzEngine.setTimeout(function(){d&&d("TurbulenzServices.createStoreManager requires Turbulenz services")},0),null;var g=new ib;g.gameSession=b;g.gameSessionId=b.gameSessionId;g.errorCallbackFn=d||wa.defaultErrorCallback;g.service=wa.getService("store");g.requestHandler=a;g.userItemsRequestToken=Ce.create();g.basketUpdateRequestToken=Ce.create();g.consumeRequestToken=Ce.create();g.ready=!1;g.offerings=
null;g.resources=null;g.basket=null;g.userItems=null;var h=!1;g.requestUserItems(f);g.onBasketUpdate=null;g.updateBasketCallbacks={};oa.setOnBasketUpdate(function(a){var a=JSON.parse(a),b;a.token&&(b=a.token,delete a.token);g.basket=a;b&&g.updateBasketCallbacks.hasOwnProperty(b)&&(g.updateBasketCallbacks[b](),delete g.updateBasketCallbacks[b]);if(g.onBasketUpdate)g.onBasketUpdate(a);f()});oa.triggerBasketUpdate();oa.setOnStoreMeta(function(a){a=JSON.parse(a);g.currency=a.currency;g.offerings=a.items||
a.offerings;g.resources=a.resources;f()});oa.triggerFetchStoreMeta();g.onSitePurchaseConfirmed=null;oa.setOnPurchaseConfirmed(function(){g.requestUserItems(function(){if(g.onSitePurchaseConfirmed)g.onSitePurchaseConfirmed()})});g.onSitePurchaseRejected=null;oa.setOnPurchaseRejected(function(){if(g.onSitePurchaseRejected)g.onSitePurchaseRejected()});return g};ib.version=1;var oa,pa=function(){};pa._initInstance=function(){var a=window.top.Turbulenz;if(a&&a.Services){a=a.Services.bridge;if(!a)return;
this._bridge=a;this.emit=a.emit;this.on=a.gameListenerOn||a.addListener||a.setListener;this.addListener=a.gameListenerOn||a.addListener||a.setListener;this.setListener=a.gameListenerOn||a.setListener}"undefined"!==typeof wa&&wa.addBridgeEvents()};pa.isInitialised=function(){return void 0!==this._bridge};pa.emit=function(){return""};pa.on=function(){};pa.addListener=function(){};pa.setListener=function(){};pa.setOnReceiveConfig=function(a){this.on("config.set",a)};pa.triggerRequestConfig=function(){this.emit("config.request")};
pa.startLoading=function(){this.emit("status.loading.start")};pa.startSaving=function(){this.emit("status.saving.start")};pa.stopLoading=function(){this.emit("status.loading.stop")};pa.stopSaving=function(){this.emit("status.saving.stop")};pa.createdGameSession=function(a){this.emit("game.session.created",a)};pa.destroyedGameSession=function(a){this.emit("game.session.destroyed",a)};pa.setGameSessionStatus=function(a,b){this.emit("game.session.status",a,b)};pa.setGameSessionInfo=function(a){this.emit("game.session.info",
a)};pa.updateUserBadge=function(a){this.emit("userbadge.update",a)};pa.updateLeaderBoard=function(a){this.emit("leaderboards.update",a)};pa.setOnMultiplayerSessionToJoin=function(a){this.on("multiplayer.session.join",a)};pa.triggerJoinedMultiplayerSession=function(a){this.emit("multiplayer.session.joined",a)};pa.triggerLeaveMultiplayerSession=function(a){this.emit("multiplayer.session.leave",a)};pa.triggerMultiplayerSessionMakePublic=function(a){this.emit("multiplayer.session.makepublic",a)};pa.setOnBasketUpdate=
function(a){this.on("basket.site.update",a)};pa.triggerBasketUpdate=function(a){this.emit("basket.game.update.v2",a)};pa.triggerUserStoreUpdate=function(a){this.emit("store.user.update",a)};pa.setOnPurchaseConfirmed=function(a){this.on("purchase.confirmed",a)};pa.setOnPurchaseRejected=function(a){this.on("purchase.rejected",a)};pa.triggerShowConfirmPurchase=function(){this.emit("purchase.show.confirm")};pa.triggerFetchStoreMeta=function(){this.emit("fetch.store.meta")};pa.setOnStoreMeta=function(a){this.on("store.meta.v2",
a)};pa.triggerSendInstantNotification=function(a){this.emit("notifications.ingame.sendInstant",a)};pa.triggerSendDelayedNotification=function(a){this.emit("notifications.ingame.sendDelayed",a)};pa.setOnNotificationSent=function(a){this.on("notifications.ingame.sent",a)};pa.triggerCancelNotificationByID=function(a){this.emit("notifications.ingame.cancelByID",a)};pa.triggerCancelNotificationsByKey=function(a){this.emit("notifications.ingame.cancelByKey",a)};pa.triggerCancelAllNotifications=function(a){this.emit("notifications.ingame.cancelAll",
a)};pa.triggerInitNotificationManager=function(a){this.emit("notifications.ingame.initNotificationManager",a)};pa.setOnReceiveNotification=function(a){this.on("notifications.ingame.receive",a)};pa.changeAspectRatio=function(a){this.emit("change.viewport.ratio",a)};pa.setOnViewportHide=function(a){this.on("change.viewport.hide",a)};pa.setOnViewportShow=function(a){this.on("change.viewport.show",a)};pa.setOnFullscreenOn=function(a){this.on("change.viewport.fullscreen.on",a)};pa.setOnFullscreenOff=function(a){this.on("change.viewport.fullscreen.off",
a)};pa.setOnMenuStateChange=function(a){this.on("change.menu.state",a)};pa.setOnUserStateChange=function(a){this.on("change.user.state",a)};pa.triggerOnFullscreen=function(){this.emit("trigger.viewport.fullscreen")};pa.triggerOnViewportVisibility=function(){this.emit("trigger.viewport.visibility")};pa.triggerOnMenuStateChange=function(){this.emit("trigger.menu.state")};pa.triggerOnUserStateChange=function(){this.emit("trigger.user.state")};pa.queryFullscreen=function(a){this.emit("query.viewport.fullscreen",
a)};pa.queryViewportVisibility=function(a){this.emit("query.viewport.visibility",a)};pa.queryMenuState=function(a){this.emit("query.menu.state",a)};pa.queryUserState=function(a){this.emit("query.user.state",a)};pa._bridge=void 0;oa=pa;oa.isInitialised()||oa._initInstance();var Li=function(){};Li.create=function(){return new Li};var Id=function(){};Id.prototype.push=function(a,b){var c=Li.create();c.key=a;c.value=b;c.timeOffset=TurbulenzEngine.time;this.events.push(c)};Id.prototype.length=function(){return this.events.length};
Id.prototype.clear=function(){this.events.length=0};Id.create=function(){var a=new Id;a.events=[];return a};var Mi,Ec=function(){},Ec=function(){};Ec.prototype.request=function(a,b){var c=wa.servicesDomain;c&&(0!==a.url.indexOf("http")&&(a.url="/"===a.url[0]?c+a.url:c+"/"+a.url),window.location&&c!==Ec.locationOrigin&&(a.enableCORSCredentials=!0));if(wa.bridgeServices&&wa.callOnBridge(b?b:a.url,a,function(b){a.callback&&a.callback(b,b.status)}))return!0;var d=function(){a.callback&&a.callback({ok:!1,
msg:"Service Unavailable. Discarding request"},503)},f=this,g=this.serviceStatusObserver,h;h=function(b,c){c?a.neverDiscard||(g.unsubscribe(h),d()):b&&(g.unsubscribe(h),f.request(a))};if(!this.running){if(this.discardRequests&&!a.neverDiscard)return TurbulenzEngine.setTimeout(d,0),!1;a.waiting||(a.waiting=!0,g.subscribe(h));return!0}var e=a.responseFilter;a.responseFilter=function(b,c,l,i){return 503===i?(c=(c=JSON.parse(l).data)?c.discardRequests:!0,(f.discardRequests=c)&&!a.neverDiscard?d():g.subscribe(h),
wa.serviceUnavailable(f,b),!1):e?e.call(a.requestHandler,b,c,l,i):!0};La.ajax(a);return!0};Ec.create=function(a,b){void 0===typeof Ec.locationOrigin&&void 0!==typeof window.location&&(Ec.locationOrigin=window.location.protocol+"//"+window.location.host);var c=new Ec;b||(b={});c.running=!0;c.discardRequests=!1;c.serviceStatusObserver=ub.create();c.serviceName=a;c.onServiceUnavailable=b.onServiceUnavailable;c.onServiceAvailable=b.onServiceAvailable;return c};Mi=Ec;var wa,Ca=function(){};Ca.available=
function(){return void 0!==window.gameSlug};Ca.addBridgeEvents=function(){var a=window.top.Turbulenz,a=(a&&a.Data||{}).joinMultiplayerSessionId,b=this;a&&this.multiplayerJoinRequestQueue.push(a);oa.setOnMultiplayerSessionToJoin(function(a){b.multiplayerJoinRequestQueue.push(a)});oa.setOnReceiveConfig(function(a){a=JSON.parse(a);a.mode&&(b.mode=a.mode);a.joinMultiplayerSessionId&&b.multiplayerJoinRequestQueue.push(a.joinMultiplayerSessionId);b.bridgeServices=!!a.bridgeServices;a.servicesDomain&&(b.servicesDomain=
a.servicesDomain);a.syncing&&(b.syncing=!0);a.offline&&(b.offline=!0)});oa.triggerRequestConfig();this.responseHandlers=[null];this.responseIndex=0;oa.on("bridgeservices.response",function(a){b.routeResponse(a)});oa.on("bridgeservices.sync.start",function(){b.syncing=!0});oa.on("bridgeservices.sync.end",function(){b.syncing=!1});oa.on("bridgeservices.offline.start",function(){b.offline=!0});oa.on("bridgeservices.offline.end",function(){b.offline=!1})};Ca.callOnBridge=function(a,b,c){b={data:b,key:void 0};
c&&(this.responseIndex+=1,this.responseHandlers[this.responseIndex]=c,b.key=this.responseIndex);a=oa.emit("bridgeservices."+a,JSON.stringify(b));return JSON.parse(a).fullyProcessed};Ca.addSignature=function(a,b){var c;a.requestUrl=b;c=TurbulenzEngine.encrypt(JSON.stringify(a));a.str=c;a.signature=TurbulenzEngine.generateSignature(c);return a};Ca.routeResponse=function(a){var a=JSON.parse(a),b=a.key||0,c=this.responseHandlers[b];c&&(this.responseHandlers[b]=null,c(a.data))};Ca.onServiceUnavailable=
function(){};Ca.onServiceAvailable=function(){};Ca.createGameSession=function(a,b,c){return Lb.create(a,b,c)};Ca.createMappingTable=function(a,b,c,d,f){var g,h=b&&b.mappingTable,e;h?(b=h.mappingTableURL,e=h.mappingTablePrefix,h=h.assetPrefix):d?(b=d.mappingTableURL||(""===d.mappingTableURL?"":"mapping_table.json"),e=d.mappingTablePrefix||(""===d.mappingTablePrefix?"":"staticmax/"),h=d.assetPrefix||(""===d.assetPrefix?"":"missing/")):(b="mapping_table.json",e="staticmax/",h="missing/");return g=fc.create({mappingTableURL:b,
mappingTablePrefix:e,assetPrefix:h,requestHandler:a,onload:c,errorCallback:function(a){var b=f||Ca.defaultErrorCallback;g.setMapping(d&&(d.urnMapping||{}));b(a)}})};Ca.createLeaderboardManager=function(a,b,c,d){return ec.create(a,b,c,d)};Ca.createBadgeManager=function(a,b){return dc.create(a,b)};Ca.createStoreManager=function(a,b,c,d){return ib.create(a,b,c,d)};Ca.createNotificationsManager=function(a,b,c,d){return Ya.create(a,b,c,d)};Ca.createMultiplayerSessionManager=function(a,b){return Mb.create(a,
b)};Ca.createUserProfile=function(a,b,c){var d={};c||(c=Ca.defaultErrorCallback);Ca.available()&&this.getService("profiles").request({url:"/api/v1/profiles/user",method:"GET",callback:function(a,g){if(200===g){var h=a;if(h&&h.ok){var h=h.data,e;for(e in h)h.hasOwnProperty(e)&&(d[e]=h[e])}}else c&&c("TurbulenzServices.createUserProfile error with HTTP status "+g+": "+a.msg,g);b&&b(d)},requestHandler:a},"profile.user");return d};Ca.upgradeAnonymousUser=function(a){if(a)oa.on("user.upgrade.occurred",
function(){a()});oa.emit("user.upgrade.show")};Ca.sendCustomMetricEvent=function(a,b,c,d,f){f||(f=Ca.defaultErrorCallback);if(Ca.available())if("string"!==typeof a||0===a.length)f("TurbulenzServices.sendCustomMetricEvent failed: Event key must be a non-empty string",0);else{if("number"!==typeof b||isNaN(b)||!isFinite(b)){if("[object Array]"!==Object.prototype.toString.call(b)){f("TurbulenzServices.sendCustomMetricEvent failed: Event value must be a number or an array of numbers",0);return}var g,h=
b.length;for(g=0;g<h;g+=1)if("number"!==typeof b[g]||isNaN(b[g])||!isFinite(b[g])){f("TurbulenzServices.sendCustomMetricEvent failed: Event value array elements must be numbers",0);return}}this.getService("customMetrics").request({url:"/api/v1/custommetrics/add-event/"+d.gameSlug,method:"POST",data:{key:a,value:b,gameSessionId:d.gameSessionId},callback:function(a,b){200!==b&&f("TurbulenzServices.sendCustomMetricEvent error with HTTP status "+b+": "+a.msg,b)},requestHandler:c,encrypt:!0},"custommetrics.addevent")}else f("TurbulenzServices.sendCustomMetricEvent failed: Service not available",
0)};Ca.sendCustomMetricEventBatch=function(a,b,c,d){d||(d=Ca.defaultErrorCallback);if(Ca.available()){var f=TurbulenzEngine.time,a=a.events,g,h=a.length;for(g=0;g<h;g+=1){var e=a[g].key,j=a[g].value,r=a[g].timeOffset;if("string"!==typeof e||0===e.length){d&&d("TurbulenzServices.sendCustomMetricEventBatch failed: Event key must be a non-empty string",0);return}if("number"!==typeof j||isNaN(j)||!isFinite(j)){if("[object Array]"!==Object.prototype.toString.call(j)){d&&d("TurbulenzServices.sendCustomMetricEventBatch failed: Event value must be a number or an array of numbers",
0);return}for(var l=j.length,e=0;e<l;e+=1)if("number"!==typeof j[e]||isNaN(j[e])||!isFinite(j[e])){d&&d("TurbulenzServices.sendCustomMetricEventBatch failed: Event value array elements must be numbers",0);return}}if("number"!==typeof r||isNaN(r)||!isFinite(r)){d&&d("TurbulenzServices.sendCustomMetricEventBatch failed: Event time offset is corrupted",0);return}a[g].timeOffset=r-f}this.getService("customMetrics").request({url:"/api/v1/custommetrics/add-event-batch/"+c.gameSlug,method:"POST",data:{batch:a,
gameSessionId:c.gameSessionId},callback:function(a,b){200!==b&&d&&d("TurbulenzServices.sendCustomMetricEventBatch error with HTTP status "+b+": "+a.msg,b)},requestHandler:b,encrypt:!0},"custommetrics.addeventbatch")}else d&&d("TurbulenzServices.sendCustomMetricEventBatch failed: Service not available",0)};Ca.getService=function(a){var b=this.services;if(b.hasOwnProperty(a))return b[a];var c=Mi.create(a);return b[a]=c};Ca.serviceUnavailable=function(a,b){var c=this.waitingServices,d=a.serviceName;
if(!c.hasOwnProperty(d)){c[d]=a;a.running=!1;var f=function(a){var c=b.onServiceUnavailable;c&&c.call(a,b);if(a.onServiceUnavailable)a.onServiceUnavailable();if(Ca.onServiceUnavailable)Ca.onServiceUnavailable(a)};a.discardRequests&&f(a);if(!this.pollingServiceStatus){var g=this,h,d="/api/v1/service-status/game/read/"+window.gameSlug,e={url:d,method:"GET",callback:function(a,d){if(200===d){var e=a.data,n=e.services,j=!1,i;for(i in c)if(c.hasOwnProperty(i)){var k=c[i],u=n[i],t=u.running;k.running=t;
k.description=u.description;if(t){if(k.discardRequests){(u=b.onServiceAvailable)&&u.call(k,b);if(k.onServiceAvailable)k.onServiceAvailable();if(Ca.onServiceAvailable)Ca.onServiceAvailable(k)}delete c[i];k.discardRequests=!1;k.serviceStatusObserver.notify(t,k.discardRequests)}else u.discardRequests&&!k.discardRequests&&(k.discardRequests=!0,f(k),k.serviceStatusObserver.notify(t,k.discardRequests)),j=!0}j?TurbulenzEngine.setTimeout(h,1E3*e.pollInterval):this.pollingServiceStatus=!1}else TurbulenzEngine.setTimeout(h,
g.defaultPollInterval)}},j=Ca.servicesDomain;j&&(0!==d.indexOf("http")&&(e.url="/"===d[0]?j+d:j+"/"+d),window.location&&j!==Mi.locationOrigin&&(e.enableCORSCredentials=!0));h=function(){La.ajax(e)};h()}}};Ca.multiplayerJoinRequestQueue={argsQueue:[],handler:function(){},context:void 0,paused:!0,onEvent:function(a,b){this.handler=a;this.context=b},push:function(a){a=[a];this.paused?this.argsQueue.push(a):this.handler.apply(this.context,a)},shift:function(){var a=this.argsQueue.shift();return a?a[0]:
void 0},clear:function(){this.argsQueue=[]},pause:function(){this.paused=!0},resume:function(){for(this.paused=!1;this.argsQueue.length&&!(this.handler.apply(this.context,this.argsQueue.shift()),this.paused););}};Ca.defaultErrorCallback=function(){};Ca.services={};Ca.waitingServices={};Ca.pollingServiceStatus=!1;Ca.defaultPollInterval=4E3;wa=Ca;"undefined"!==typeof oa&&wa.addBridgeEvents();var Nb=function(){this.keyValidate=/^[A-Za-z0-9]+([\-\.][A-Za-z0-9]+)*$/};Nb.prototype.validateKey=function(a){return!a||
"string"!==typeof a?(this.errorCallbackFn("Invalid key string (Key string is empty or not a string)"),!1):!this.keyValidate.test(a)?(this.errorCallbackFn("Invalid key string (Only alphanumeric characters and .- are permitted)"),!1):a};Nb.prototype.getKeys=function(a,b){var c=this;this.service.request({url:"/api/v1/user-data/get-keys",method:"GET",data:{gameSessionId:c.gameSessionId},callback:function(d,f){200===f?a(d.keys||d.array):(b||c.errorCallbackFn)("UserDataManager.getKeys failed with status "+
f+": "+d.msg,f,c.getKeys,[a])},requestHandler:this.requestHandler,encrypt:!0},"userdata.getkeys")};Nb.prototype.exists=function(a,b,c){if(this.validateKey(a)){var d=this;this.service.request({url:"/api/v1/user-data/exists/"+a,method:"GET",data:{gameSessionId:d.gameSessionId},callback:function(f,g){200===g?b(a,f.exists):(c||d.errorCallbackFn)("UserDataManager.exists failed with status "+g+": "+f.msg,g,d.exists,[a,b])},requestHandler:this.requestHandler,encrypt:!0},"userdata.exists")}};Nb.prototype.get=
function(a,b,c){if(this.validateKey(a)){var d=this;this.service.request({url:"/api/v1/user-data/get/"+a,method:"GET",data:{gameSessionId:d.gameSessionId},callback:function(f,g){200===g?b(a,f.value):404===g?b(a,null):(c||d.errorCallbackFn)("UserDataManager.get failed with status "+g+": "+f.msg,g,d.get,[a,b])},requestHandler:this.requestHandler,encrypt:!0},"userdata.get")}};Nb.prototype.set=function(a,b,c,d){if(this.validateKey(a))if(b){var f=this;this.service.request({url:"/api/v1/user-data/set/"+
a,method:"POST",data:{gameSessionId:f.gameSessionId,value:b},callback:function(g,h){200===h?c(a):(d||f.errorCallbackFn)("UserDataManager.set failed with status "+h+": "+g.msg,h,f.set,[a,b,c])},requestHandler:this.requestHandler,encrypt:!0},"userdata.set")}else this.remove(a,c)};Nb.prototype.remove=function(a,b,c){if(this.validateKey(a)){var d=this;this.service.request({url:"/api/v1/user-data/remove/"+a,method:"POST",data:{gameSessionId:d.gameSessionId},callback:function(f,g){200===g?b(a):404===g?
b(a):(c||d.errorCallbackFn)("UserDataManager.remove failed with status "+g+": "+f.msg,g,d.remove,[a,b])},requestHandler:this.requestHandler,encrypt:!0},"userdata.remove")}};Nb.prototype.removeAll=function(a,b){var c=this;this.service.request({url:"/api/v1/user-data/remove-all",method:"POST",data:{gameSessionId:c.gameSessionId},callback:function(d,f){200===f?a():(b||c.errorCallbackFn)("UserDataManager.removeAll failed with status "+f+": "+d.msg,f,c.removeAll,[a])},requestHandler:this.requestHandler,
encrypt:!0},"userdata.removeall")};Nb.create=function(a,b,c){var d;if(!wa.available())return null;d=new Nb;d.requestHandler=a;d.errorCallbackFn=c||wa.defaultErrorCallback;d.gameSessionId=b.gameSessionId;d.service=wa.getService("userdata");return d};Nb.version=1;var oc=function(a,b){this.gd=a;this.fm=b;this.italic=this.bold=!1;this.baseline=this.pageHeight=this.pageWidth=0;this.glyphs=null;this.lineHeight=this.minGlyphIndex=this.numGlyphs=0;this.texture=this.kernings=this.pages=null};oc.prototype.calculateTextDimensions=
function(a,b,c){for(var d=this.glyphs,f=this.lineHeight*b,g=0,h=0,e=0,j=0,r=[],l=a.length,i=0,k,p=0;p<l;p+=1)if(k=a.charCodeAt(p),10===k)i&&(i-=c),r[j]=i,j+=1,g<i&&(g=i),i=0,h+=f;else if(k=d[k])(k=k.awidth)?(i+=k*b+c,e+=1):i+=c;r[j]=i;g<i&&(g=i);return{width:g,height:h+f,numGlyphs:e,linesWidth:r}};oc.prototype.generateTextVertices=function(a,b){var c=b.rect,d=b.alignment,f=b.scale||1,g=b.spacing?b.spacing*f:0,h=this.calculateTextDimensions(a,f,g),e=h.numGlyphs;if(0>=e)return null;var h=h.linesWidth,
j=this.lineHeight*f,i=this.kernings,l=this.glyphs,m=this.fm,k=m.reusableArrays,p=k[e];p?k[e]=null:p=new m.float32ArrayConstructor(16*e);var m=0,s,t,u,z,w,y,v,x,J,C;s=h[0];var k=c[0],A=c[2],c=c[1],E=k;1===d?E+=0.5*(A-s):2===d&&(E+=A-s);var V=a.length,H=0,K;for(K=0;K<V;K+=1)if(s=a.charCodeAt(K),10===s)c+=j,H+=1,s=h[H],E=k,1===d?E+=0.5*(A-s):2===d&&(E+=A-s);else if(t=l[s])if(v=t.awidth*f){u=E+t.xoffset*f;z=c+t.yoffset*f;w=u+t.width*f;y=z+t.height*f;x=t.left;J=t.top;C=t.right;t=t.bottom;p[m+0]=u;p[m+
1]=z;p[m+2]=x;p[m+3]=J;p[m+4]=w;p[m+5]=z;p[m+6]=C;p[m+7]=J;p[m+8]=w;p[m+9]=y;p[m+10]=C;p[m+11]=t;p[m+12]=u;p[m+13]=y;p[m+14]=x;p[m+15]=t;m+=16;e-=1;if(0===e)break;E+=v+g;if(i&&(s=i[s])&&K<V-1)(s=s[a.charCodeAt(K+1)])&&(E+=s*f)}else E+=g;return p};oc.prototype.drawTextRect=function(a,b){var c=this.generateTextVertices(a,b);c&&this.drawTextVertices(c,!0)};oc.prototype.drawTextVertices=function(a,b){var c=a.length>>4,d=this.gd,f=this.fm;b&&(f.reusableArrays[c]=a);var g=4*c,h=f.sharedVertexBuffer;if(!h||
g>h.numVertices)h&&h.destroy(),h=this.createVertexBuffer(c),f.sharedVertexBuffer=h;h.setData(a,0,g);d.setStream(h,f.semantics);h=f.techniqueParameters;h.texture=this.texture;d.setTechniqueParameters(h);if(4<g){g=6*c;h=f.sharedIndexBuffer;if(!h||g>h.numIndices)h&&h.destroy(),h=this.createIndexBuffer(c),f.sharedIndexBuffer=h;d.setIndexBuffer(h);d.drawIndexed(f.primitive,g,0)}else d.draw(f.primitiveFan,4,0)};oc.prototype.createIndexBuffer=function(a){var b=this.gd.createIndexBuffer({numIndices:6*a,format:"USHORT"}),
c=b.map();if(c){for(var d,f,g,h,e=0;e<a;e+=1)d=4*e,f=d+1,g=d+2,h=d+3,c(d,f,g),c(g,h,d);b.unmap(c)}return b};oc.prototype.createVertexBuffer=function(a){var b=this.gd;return b.createVertexBuffer({numVertices:4*a,attributes:[b.VERTEXFORMAT_FLOAT2,b.VERTEXFORMAT_FLOAT2],dynamic:!0,"transient":!0})};oc.version=1;var Ee=function(){};Ee.prototype.get=function(){};Ee.create=function(a,b,c,d,f){d||(d=function(){});var g={},h={},e={},j={},i=0,l=null,m="",k=c,p=function(a,b,c){var d=Math.floor,f=1/(c/16),g=
0.5/b.width,h=0.5/b.height,e=d(0.0625*b.width),b=d(b.height*f),n=[];n.length=c;for(var j=0;j<c;j+=1){var l=0.0625*d(j%16)-g,i=d(j/16)*f-h;n[j]={width:e,height:b,awidth:e,xoffset:0,yoffset:0,left:l,top:i,right:l+0.0625,bottom:i+f,page:0}}a.lineHeight=b;a.baseline=b;a.glyphs=n;a.numGlyphs=c;a.minGlyphIndex=0},s=new Ee;s.primitive=a.PRIMITIVE_TRIANGLES;s.primitiveFan=a.PRIMITIVE_TRIANGLE_FAN;s.semantics=a.createSemantics(["POSITION","TEXCOORD0"]);s.techniqueParameters=a.createTechniqueParameters({texture:null});
s.sharedIndexBuffer=null;s.sharedVertexBuffer=null;s.reusableArrays={};s.float32ArrayConstructor=Array;"undefined"!==typeof Float32Array&&(c=new Float32Array(4),"[object Float32Array]"===Object.prototype.toString.call(c)&&(s.float32ArrayConstructor=Float32Array));if(!k){var k=new oc(a,s),c=[0,0,0,0,0,0,0,0,126,129,165,129,189,153,129,126,126,255,219,255,195,231,255,126,108,254,254,254,124,56,16,0,16,56,124,254,124,56,16,0,56,124,56,254,254,124,56,124,16,16,56,124,254,124,56,124,0,0,24,60,60,24,0,
0,255,255,231,195,195,231,255,255,0,60,102,66,66,102,60,0,255,195,153,189,189,153,195,255,15,7,15,125,204,204,204,120,60,102,102,102,60,24,126,24,63,51,63,48,48,112,240,224,127,99,127,99,99,103,230,192,153,90,60,231,231,60,90,153,128,224,248,254,248,224,128,0,2,14,62,254,62,14,2,0,24,60,126,24,24,126,60,24,102,102,102,102,102,0,102,0,127,219,219,123,27,27,27,0,62,99,56,108,108,56,204,120,0,0,0,0,126,126,126,0,24,60,126,24,126,60,24,255,24,60,126,24,24,24,24,0,24,24,24,24,126,60,24,0,0,24,12,254,12,
24,0,0,0,48,96,254,96,48,0,0,0,0,192,192,192,254,0,0,0,36,102,255,102,36,0,0,0,24,60,126,255,255,0,0,0,255,255,126,60,24,0,0,0,0,0,0,0,0,0,0,48,120,120,120,48,0,48,0,108,108,108,0,0,0,0,0,108,108,254,108,254,108,108,0,48,124,192,120,12,248,48,0,0,198,204,24,48,102,198,0,56,108,56,118,220,204,118,0,96,96,192,0,0,0,0,0,24,48,96,96,96,48,24,0,96,48,24,24,24,48,96,0,0,102,60,255,60,102,0,0,0,48,48,252,48,48,0,0,0,0,0,0,0,48,48,96,0,0,0,252,0,0,0,0,0,0,0,0,0,48,48,0,6,12,24,48,96,192,128,0,124,198,206,
222,246,230,124,0,48,112,48,48,48,48,252,0,120,204,12,56,96,204,252,0,120,204,12,56,12,204,120,0,28,60,108,204,254,12,30,0,252,192,248,12,12,204,120,0,56,96,192,248,204,204,120,0,252,204,12,24,48,48,48,0,120,204,204,120,204,204,120,0,120,204,204,124,12,24,112,0,0,48,48,0,0,48,48,0,0,48,48,0,0,48,48,96,24,48,96,192,96,48,24,0,0,0,252,0,0,252,0,0,96,48,24,12,24,48,96,0,120,204,12,24,48,0,48,0,124,198,222,222,222,192,120,0,48,120,204,204,252,204,204,0,252,102,102,124,102,102,252,0,60,102,192,192,192,
102,60,0,248,108,102,102,102,108,248,0,126,96,96,120,96,96,126,0,126,96,96,120,96,96,96,0,60,102,192,192,206,102,62,0,204,204,204,252,204,204,204,0,120,48,48,48,48,48,120,0,30,12,12,12,204,204,120,0,230,102,108,120,108,102,230,0,96,96,96,96,96,96,126,0,198,238,254,254,214,198,198,0,198,230,246,222,206,198,198,0,56,108,198,198,198,108,56,0,252,102,102,124,96,96,240,0,120,204,204,204,220,120,28,0,252,102,102,124,108,102,230,0,120,204,224,112,28,204,120,0,252,48,48,48,48,48,48,0,204,204,204,204,204,
204,252,0,204,204,204,204,204,120,48,0,198,198,198,214,254,238,198,0,198,198,108,56,56,108,198,0,204,204,204,120,48,48,120,0,254,6,12,24,48,96,254,0,120,96,96,96,96,96,120,0,192,96,48,24,12,6,2,0,120,24,24,24,24,24,120,0,16,56,108,198,0,0,0,0,0,0,0,0,0,0,255,0,48,48,24,0,0,0,0,0,0,0,120,12,124,204,118,0,224,96,96,124,102,102,220,0,0,0,120,204,192,204,120,0,28,12,12,124,204,204,118,0,0,0,120,204,252,192,120,0,56,108,96,240,96,96,240,0,0,0,118,204,204,124,12,248,224,96,108,118,102,102,230,0,48,0,112,
48,48,48,120,0,12,0,12,12,12,204,204,120,224,96,102,108,120,108,230,0,112,48,48,48,48,48,120,0,0,0,204,254,254,214,198,0,0,0,248,204,204,204,204,0,0,0,120,204,204,204,120,0,0,0,220,102,102,124,96,240,0,0,118,204,204,124,12,30,0,0,220,118,102,96,240,0,0,0,124,192,120,12,248,0,16,48,124,48,48,52,24,0,0,0,204,204,204,204,118,0,0,0,204,204,204,120,48,0,0,0,198,214,254,254,108,0,0,0,198,108,56,108,198,0,0,0,204,204,204,124,12,248,0,0,252,152,48,100,252,0,28,48,48,224,48,48,28,0,24,24,24,0,24,24,24,0,224,
48,48,28,48,48,224,0,118,220,0,0,0,0,0,0,0,16,56,108,198,198,254,0],t=Array(32768),u,z,w,y,v,x;for(z=x=w=0;16>z;z+=1){y=w;for(u=0;16>u;u+=1){for(v=0;8>v;v+=1){var J=t,C=y+256*v,A=c[x];J[C+0]=255;J[C+1]=A&128?255:0;J[C+2]=255;J[C+3]=A&64?255:0;J[C+4]=255;J[C+5]=A&32?255:0;J[C+6]=255;J[C+7]=A&16?255:0;J[C+8]=255;J[C+9]=A&8?255:0;J[C+10]=255;J[C+11]=A&4?255:0;J[C+12]=255;J[C+13]=A&2?255:0;J[C+14]=255;J[C+15]=A&1?255:0;x+=1}y+=16}w+=2048}if(c=a.createTexture({name:"defaultFont",width:128,height:64,depth:1,
format:"L8A8",cubemap:!1,mipmaps:!0,dynamic:!1,data:t}))p(k,c,128),k.texture=c,k.pageWidth=128,k.pageHeight=64}g["default"]=k;var E=function(c,f){function u(){j[c]-=1;return 0===j[c]?(delete j[c],delete h[c],i-=1,!0):!1}function v(b,f){g[c]?a.createTexture({src:b,mipmaps:!0,onload:f})||(d("Failed to create texture for font '"+c+"'."),delete g[c],u()):u()}var x=g[c];if(x)f&&TurbulenzEngine.setTimeout(function(){f(x)},0);else{if(c in h)f&&e[c].subscribe(f);else{h[c]=!0;j[c]=0;i+=1;var t=ub.create();
e[c]=t;f&&t.subscribe(f);var y=c,D,z=y.lastIndexOf(".");-1!==z&&(D=y.substr(z));if(!D||".fnt"!==D&&".fontdat"!==D)y+=".fontdat";b.request({src:l&&l[y]||m+y,onload:function(f,y){if(200===y&&f){x=new oc(a,s);var D=JSON.parse(f).bitmapfontlayouts,z;for(z in D)if(D.hasOwnProperty(z)){D=D[z];x.bold=D.bold||!1;x.italic=D.italic||!1;x.pageWidth=D.pagewidth||0;x.pageHeight=D.pageheight||0;x.baseline=D.baseline||0;x.glyphs=D.glyphs||null;x.numGlyphs=D.numglyphs||0;x.minGlyphIndex=D.minglyphindex||0;x.lineHeight=
D.lineheight||0;x.pages=D.pages||null;x.kernings=D.kernings||null;break}g[c]=x;var w,C=x.pages;if(C){D=C.length;j[c]+=D;z=function(a,b,f){b=g[c];f=f.index;if(b){if(a){C[f]=a;0===f&&(b.texture=a);u()&&(t.notify(b),delete e[c]);return}d("Failed to load font page: '"+C[f]+"'.");delete g[c]}u()};for(var B=0;B<D;B+=1)w=C[B],b.request({src:l&&l[w]||m+w,onload:z,requestFn:v,index:B})}else w=c+".dds",b.request({src:l&&l[w]||m+w,onload:function(a){if(a){var b=x;b.texture=a;b.pageWidth=a.width;b.pageHeight=
a.height;b.glyphs||p(b,a,256);t.notify(x);delete e[c]}else d("Failed to load font page: '"+w+"'."),delete g[c];delete j[c];delete h[c];i-=1},requestFn:function(b,e){a.createTexture({src:b,mipmaps:!1,onload:e})||(f?d("Failed to create texture for font '"+c+"'."):d("Failed to load font '"+c+"'."),delete g[c],delete j[c],delete h[c],i-=1)}})}else d("Failed to load font file: '"+c+"'."),t.notify(null),delete j[c],delete h[c],i-=1,404===y&&(g[c]=k)}})}x=k}return x},V=function(a,b){g[a]=g[b]},H=function(a){a in
g&&delete g[a]};f?(s.load=function(a,b){f.innerHTML+="FontManager.load:&nbsp;'"+a+"'";return E(a,b)},s.map=function(a,b){f.innerHTML+="FontManager.map:&nbsp;'"+b+"' -> '"+a+"'";V(a,b)},s.remove=function(a){f.innerHTML+="FontManager.remove:&nbsp;'"+a+"'";H(a)}):(s.load=E,s.map=V,s.remove=H);s.get=function(a){a=g[a];return!a?k:a};s.getAll=function(){return g};s.getNumPendingFonts=function(){return i};s.isFontLoaded=function(a){return!h[a]};s.isFontMissing=function(a){return!g[a]};s.setPathRemapping=
function(a,b){l=a;m=b};s.calculateTextDimensions=function(a,b,c,d){return(a=g[a])?a.calculateTextDimensions(b,c,d):{width:0,height:0,numGlyphs:0}};s.reuseVertices=function(a){this.reusableArrays[a.length>>4]=a};s.destroy=function(){if(g){for(var c in g)if(g.hasOwnProperty(c)){var d=g[c];if(d){var f=d.texture;f&&(f.destroy(),d.texture=null)}}g=null}this.sharedVertexBuffer&&(this.sharedVertexBuffer.destroy(),this.sharedVertexBuffer=null);this.sharedIndexBuffer&&(this.sharedIndexBuffer.destroy(),this.sharedIndexBuffer=
null);j=e=j=h=this.semantics=this.techniqueParameters=null;i=0;a=b=m=l=null};return s};Ee.version=1;var Ga=function(){this.passIndex={fillZ:0,glow:1,ambient:2,shadow:3,diffuse:4,decal:5,transparent:6}};Ga.prototype.updateShader=function(a){var b=a.get("shaders/zonly.cgfx");b!==this.zonlyShader&&(this.zonlyShader=b,this.zonlyRigidTechnique=b.getTechnique("rigid"),this.zonlySkinnedTechnique=b.getTechnique("skinned"),this.zonlyRigidAlphaTechnique=b.getTechnique("rigid_alphatest"),this.zonlySkinnedAlphaTechnique=
b.getTechnique("skinned_alphatest"),this.zonlyRigidNoCullTechnique=b.getTechnique("rigid_nocull"),this.zonlySkinnedNoCullTechnique=b.getTechnique("skinned_nocull"),this.zonlyRigidAlphaNoCullTechnique=b.getTechnique("rigid_alphatest_nocull"),this.zonlySkinnedAlphaNoCullTechnique=b.getTechnique("skinned_alphatest_nocull"),this.stencilSetTechnique=b.getTechnique("stencil_set"),this.stencilClearTechnique=b.getTechnique("stencil_clear"),this.stencilSetSpotLightTechnique=b.getTechnique("stencil_set_spotlight"),
this.stencilClearSpotLightTechnique=b.getTechnique("stencil_clear_spotlight"));b=a.get("shaders/forwardrendering.cgfx");b!==this.forwardShader&&(this.forwardShader=b,this.skyboxTechnique=b.getTechnique("skybox"),this.ambientRigidTechnique=b.getTechnique("ambient"),this.ambientSkinnedTechnique=b.getTechnique("ambient_skinned"),this.ambientRigidAlphaTechnique=b.getTechnique("ambient_alphatest"),this.ambientSkinnedAlphaTechnique=b.getTechnique("ambient_alphatest_skinned"),this.ambientFlatRigidTechnique=
b.getTechnique("ambient_flat"),this.ambientFlatRigidNoCullTechnique=b.getTechnique("ambient_flat_nocull"),this.ambientFlatSkinnedTechnique=b.getTechnique("ambient_flat_skinned"),this.ambientGlowmapRigidTechnique=b.getTechnique("ambient_glowmap"),this.ambientGlowmapSkinnedTechnique=b.getTechnique("ambient_glowmap_skinned"),this.ambientLightmapRigidTechnique=b.getTechnique("ambient_lightmap"),this.glowmapRigidTechnique=b.getTechnique("glowmap"),this.glowmapSkinnedTechnique=b.getTechnique("glowmap_skinned"),
this.lightmapRigidTechnique=b.getTechnique("lightmap"));(b=this.shadowMaps)&&b.updateShader(a)};Ga.createNodeRendererInfo=function(a,b){a.rendererInfo={id:Ga.nextNodeID,worldView:b.m43BuildIdentity(),worldViewInverseTranspose:b.m33BuildIdentity()};Ga.nextNodeID+=1};Ga.prototype.createRendererInfo=function(a){var b=Gj(a);a.rendererInfo=b;var c=a.sharedMaterial.techniqueParameters;if((!c.env_map||c.normal_map)&&!c.materialColor&&!a.techniqueParameters.materialColor)a.techniqueParameters.materialColor=
this.v4One;!c.uvTransform&&!a.techniqueParameters.uvTransform&&(a.techniqueParameters.uvTransform=this.identityUVTransform);c=a.node;c.rendererInfo||Ga.createNodeRendererInfo(c,this.md);b.id=1/(1+a.geometry.vertexBuffer.id);return b};Ga.prototype.prepareRenderables=function(a,b){var c,d=this.passes,f=this.numPasses;for(c=0;c<f;c+=1)d[c].length=0;this.visibleRenderables=f=b.getCurrentVisibleRenderables();var g=f.length;if(0<g){var h,e,j,i,l,m,k,p=this.passIndex.transparent,s=this.passIndex.ambient;
h=b.maxDistance;var t=0<h?1/h:0;h=0;do{e=f[h];(c=e.rendererInfo)||(c=this.createRendererInfo(e));c.far&&(e.distance=1E38);e.renderUpdate(a);j=e.drawParameters;i=j.length;k=e.distance;0<k?(k*=t,0.999<k&&(k=0.999)):k=0;for(l=0;l<i;l+=1)m=j[l],c=m.userData.passIndex,c<=s?m.sortKey=(m.sortKey|0)+k:c===p&&(m.sortKey=k),c=d[c],c[c.length]=m;if(j=e.diffuseDrawParameters){i=j.length;for(l=0;l<i;l+=1)m=j[l],m.removeInstances();if(j=e.diffuseShadowDrawParameters){i=j.length;for(l=0;l<i;l+=1)m=j[l],m.removeInstances()}}h+=
1}while(h<g)}};Ga.prototype.prepareLights=function(a,b){var c=this.pointLights,d=this.spotLights,f=this.localDirectionalLights,g=this.globalDirectionalLights,h=0,e=0,j=0,i=0,l=b.getCurrentVisibleLights(),m=l.length,k,p,s;if(m){s=0;do{k=l[s];if((p=k.light)&&!p.global)if(k.shadows=!1,this.lightFindVisibleRenderables(a,k,b))p.spot?(d[e]=k,e+=1):p.point?(c[h]=k,h+=1):p.directional&&(f[j]=k,j+=1);else if(m-=1,s<m){l[s]=l[m];continue}else break;s+=1}while(s<m);m<l.length&&(l.length=m)}l=b.getGlobalLights();
if(m=l.length){s=0;do{if((p=l[s])&&!p.disabled&&p.directional)g[i]=p,i+=1;s+=1}while(s<m)}g.length=i;f.length=j;c.length=h;d.length=e};Ga.prototype.addToDiffuseQueue=function(a,b,c){b.addInstance(c);1===b.getNumInstances()&&(a=this.diffuseQueue,c=this.numDiffuseQueue,this.numDiffuseQueue=c+1,a[c]=b)};Ga.prototype.lightFindVisibleRenderables=function(a,b,c){var d,f,g,h,e,j,i,l,m,k=this.shadowMaps;l=b.node;m=b.light;j=b.getWorldExtents();i=b.frameVisible;var p=this.overlapQueryRenderables,s=0;p.length=
0;var t=this.lightVisibleRenderables,u=0;f=b.overlappingRenderables;if(l.dynamic||b.staticNodesChangeCounter!==c.staticNodesChangeCounter){h=this.md;l=l.world;d=(s=m.origin)?h.m43TransformPoint(l,s,b.lightOrigin):h.m43Pos(l,b.lightOrigin);b.lightOrigin=d;f||(f=[],b.overlappingRenderables=f);g=0;b.staticNodesChangeCounter=c.staticNodesChangeCounter;c.findStaticOverlappingRenderables(d,j,p);s=p.length;for(h=0;h<s;h+=1)l=p[h],e=l.sharedMaterial.meta,!e.transparent&&(!e.decal&&!e.far)&&(f[g]=l,g+=1,l.getWorldExtents(),
l.frameVisible===i&&(!l.disabled&&!l.node.disabled)&&(t[u]=l,u+=1));p.length=0;f.length=g;b.numStaticOverlappingRenderables=g}else{d=b.lightOrigin;g=b.numStaticOverlappingRenderables;for(h=0;h<g;h+=1)l=f[h],l.frameVisible===i&&(!l.disabled&&!l.node.disabled)&&(t[u]=l,u+=1)}c.findDynamicOverlappingRenderables(d,j,p);s=p.length;for(h=0;h<s;h+=1)l=p[h],e=l.sharedMaterial.meta,!e.transparent&&(!e.decal&&!e.far)&&(f[g]=l,g+=1,l.frameVisible===i&&(!l.disabled&&!l.node.disabled)&&(t[u]=l,u+=1));if(0===u)return b.numVisibleDrawParameters=
0,!1;c=0;f=!1;k&&m.shadows&&(f=k.findVisibleRenderables(b));k=b.techniqueParameters;k||(k=a.createTechniqueParameters(m.techniqueParameters),k.lightViewInverseTransposeFalloff=a.createTechniqueParameterBuffer({numFloats:16}),b.techniqueParameters=k);for(h=0;h<u;h+=1){l=t[h];m=l.rendererInfo.id||0;l=f?l.diffuseShadowDrawParameters:l.diffuseDrawParameters;i=l.length;for(j=0;j<i;j+=1)p=l[j],p.sortKey=(p.sortKey|0)+m,this.addToDiffuseQueue(a,p,k),c+=1}b.numVisibleDrawParameters=c;return 0<c};Ga.prototype.directionalLightsUpdateVisibleRenderables=
function(a){var b=this.globalDirectionalLights,c=b.length,d=this.visibleRenderables,f=d.length,g,h,e,j,i,l,m,k=0,p=0;do{g=b[p];h=g.techniqueParameters;for(j=e=0;j<f;j+=1)if(i=d[j],!i.disabled&&!i.node.disabled&&(m=i.diffuseDrawParameters)){l=m.length;for(i=0;i<l;i+=1)this.addToDiffuseQueue(a,m[i],h),e+=1}g.numVisibleDrawParameters=e;k+=e;p+=1}while(p<c);return 0<k};Ga.prototype.update=function(a,b,c,d){this.camera=b;this.globalCameraMatrix=b.matrix;this.numDiffuseQueue=0;0<d?c.updateVisibleNodes(b):
this.forceRenderInfoUpdate(c);this.sceneExtents=c.extents;this.prepareRenderables(b,c);this.prepareLights(a,c);var f=this.md,g=b.viewMatrix,h=this.globalTechniqueParameters;h.projection=b.projectionMatrix;h.viewProjection=b.viewProjectionMatrix;h.eyePosition=f.m43Pos(b.matrix,h.eyePosition);h.time=d;var b=c.globalLights,e=b.length,j=h=d=0,i,l;for(l=0;l<e;l+=1)i=b[l],!i.disabled&&i.ambient&&(i=i.color,d+=i[0],h+=i[1],j+=i[2]);b=this.lightingScale;d||h||j?this.ambientColor=f.v3Build(b*d,b*h,b*j,this.ambientColor):
delete this.ambientColor;for(var m,k,d=this.lightViewInverseTranspose,h=this.lightFalloff,j=this.worldView,p=this.pointLights,s=p.length,e=0;e<s;e+=1)i=p[e],m=i.node,l=i.light,m=m.world,i=i.techniqueParameters,k=l.origin,j=f.m43Mul(m,g,j),i.lightOrigin=k?f.m43TransformPoint(j,k,i.lightOrigin):f.m43Pos(j,i.lightOrigin),k=l.color,i.lightColor=f.v3Build(b*k[0],b*k[1],b*k[2],i.lightColor),d=f.m43InverseTransposeProjection(j,l.halfExtents,d),h[0]=d[8],h[1]=d[9],h[2]=d[10],h[3]=d[11],d[8]=0,d[9]=0,d[10]=
0,d[11]=1,m=i.lightViewInverseTransposeFalloff,m.setData(d,0,12),m.setData(h,12,4);for(var p=this.localDirectionalLights,s=p.length,t,e=0;e<s;e+=1)i=p[e],m=i.node,l=i.light,m=m.world,i=i.techniqueParameters,j=f.m43Mul(m,g,j),t=f.m43TransformVector(j,l.direction,t),i.lightOrigin=f.v3ScalarMul(t,-1E5,i.lightOrigin),k=l.color,i.lightColor=f.v3Build(b*k[0],b*k[1],b*k[2],i.lightColor),d=f.m43InverseTransposeProjection(j,l.halfExtents,d),h[0]=d[8],h[1]=d[9],h[2]=d[10],h[3]=d[11],d[8]=0,d[9]=0,d[10]=0,d[11]=
1,m=i.lightViewInverseTransposeFalloff,m.setData(d,0,12),m.setData(h,12,4);t=this.globalDirectionalLights;if(p=t.length)if(this.directionalLightsUpdateVisibleRenderables(a)){c=c.extents;a=-1E5*(c[3]-c[0]+(c[4]-c[1])+(c[5]-c[2]));c=f.v3Build(c[3]-c[0],c[4]-c[1],c[5]-c[2]);d=f.m43InverseTransposeProjection(g,c,d);h[0]=d[8];h[1]=d[9];h[2]=d[10];h[3]=d[11];d[8]=0;d[9]=0;d[10]=0;d[11]=1;m=this.lightViewInverseTransposeFalloff;m.setData(d,0,12);m.setData(h,12,4);c=f.v3BuildZero();e=0;do l=t[e],i=l.techniqueParameters,
i.lightViewInverseTransposeFalloff=m,f.v3Normalize(l.direction,c),k=f.v3ScalarMul(c,a),i.lightOrigin=f.m43TransformPoint(g,k,i.lightOrigin),k=l.color,i.lightColor=f.v3Build(b*k[0],b*k[1],b*k[2],i.lightColor),e+=1;while(e<p)}else t.length=0;a=this.spotLights;if(c=a.length){var u,z;t=this.lightProjection;p=this.lightViewInverseProjection;e=0;do i=a[e],m=i.node,l=i.light,m=m.world,i=i.techniqueParameters,k=l.origin,j=f.m43Mul(m,g,j),i.lightOrigin=k?f.m43TransformPoint(j,k,i.lightOrigin):f.m43Pos(j,i.lightOrigin),
k=l.color,i.lightColor=f.v3Build(b*k[0],b*k[1],b*k[2],i.lightColor),m=l.frustumNear,k=1/(1-m),u=f.m33MulM43(l.frustum,j,u),z=f.m43Inverse(u,z),t[8]=k,t[11]=-(m*k),p=f.m43Mul(z,t,p),d=f.m43Transpose(p,d),h[0]=d[8],h[1]=d[9],h[2]=d[10],h[3]=d[11],m=i.lightViewInverseTransposeFalloff,m.setData(d,0,12),m.setData(h,12,4),e+=1;while(e<c)}};Ga.prototype.forceRenderInfoUpdate=function(a){var a=a.visibleNodes,b=a.length,c;for(c=0;c<b;c+=1){var d=a[c].rendererInfo;d&&(d.frameVisible=-1)}};Ga.prototype.destroyBuffers=
function(){this.finalRenderTarget&&(this.finalRenderTarget.destroy(),this.finalRenderTarget=null);this.finalTexture&&(this.finalTexture.destroy(),this.finalTexture=null);this.depthBuffer&&(this.depthBuffer.destroy(),this.depthBuffer=null)};Ga.prototype.updateBuffers=function(a,b,c){if(this.bufferWidth===b&&this.bufferHeight===c)return!0;this.destroyBuffers();this.finalTexture=a.createTexture({name:"final",width:b,height:c,format:"R8G8B8A8",mipmaps:!1,renderable:!0});this.depthBuffer=a.createRenderBuffer({width:b,
height:c,format:"D24S8"});if(this.finalTexture&&this.depthBuffer&&(this.finalRenderTarget=a.createRenderTarget({colorTexture0:this.finalTexture,depthBuffer:this.depthBuffer})))return this.bufferWidth=b,this.bufferHeight=c,!0;this.bufferHeight=this.bufferWidth=0;this.destroyBuffers();return!1};Ga.prototype.drawAmbientPass=function(a,b){this.ambientTechniqueParameters.ambientColor=b;a.drawArray(this.passes[this.passIndex.ambient],[this.globalTechniqueParameters,this.ambientTechniqueParameters],-1)};
Ga.prototype.drawShadowMaps=function(a,b,c,d,f){if(a=c.length){var g,h,e=this.globalCameraMatrix;h=0;do b=c[h],b.numVisibleDrawParameters&&(g=b.light,g.shadows&&!g.ambient&&d.drawShadowMap(e,f,b)),h+=1;while(h<a)}};Ga.prototype.draw=function(a,b,c,d,f,g){var h=this.globalTechniqueParameters,e=this.ambientColor,j=this.shadowMaps;if(j){var i=this.sceneExtents,i=Math.max(i[3]-i[0],i[4]-i[1],i[5]-i[2])/6;j.lowIndex=0;j.highIndex=0;this.drawShadowMaps(a,h,this.pointLights,j,i);this.drawShadowMaps(a,h,
this.spotLights,j,i);this.drawShadowMaps(a,h,this.localDirectionalLights,j,i);j.blurShadowMaps()}j=g?a.beginRenderTarget(this.finalRenderTarget):!1;b?a.clear(b,1,0):e?a.clear(null,1,0):a.clear(this.v4Zero,1,0);h=[h];b&&(b[0]||b[1]||b[2]||1!==b[3])?(e||(e=this.v3Zero),this.drawAmbientPass(a,e)):e?this.drawAmbientPass(a,e):(a.drawArray(this.passes[this.passIndex.fillZ],h,-1),a.drawArray(this.passes[this.passIndex.glow],h,-1));b=this.numDiffuseQueue;0<b&&(e=this.diffuseQueue,b<e.length&&(e.length=b),
a.drawArray(e,h,-1));b=this.passes[this.passIndex.decal];0<b.length&&a.drawArray(b,h,-1);c&&c();b=this.passes[this.passIndex.transparent];0<b.length&&a.drawArray(b,h,1);d&&d();f&&f();j&&(a.endRenderTarget(),g(a,this.finalTexture),a.setStream(this.quadVertexBuffer,this.quadSemantics),a.draw(this.quadPrimitive,4))};Ga.prototype.setLightingScale=function(a){this.lightingScale=a};Ga.prototype.getDefaultSkinBufferSize=function(){return this.defaultSkinBufferSize};Ga.prototype.destroy=function(){delete this.globalTechniqueParameters;
delete this.ambientTechniqueParameters;delete this.passes;delete this.passIndex;delete this.sceneExtents;delete this.visibleRenderables;delete this.globalCameraMatrix;delete this.diffuseQueue;delete this.spotLights;delete this.pointLights;delete this.localDirectionalLights;delete this.globalDirectionalLights;delete this.fogLights;delete this.lightViewInverseTransposeFalloff;delete this.lightViewInverseTranspose;delete this.lightFalloff;delete this.v3Zero;delete this.v4Zero;delete this.v4One;delete this.lightProjection;
delete this.quadPrimitive;delete this.quadSemantics;this.quadVertexBuffer&&(this.quadVertexBuffer.destroy(),delete this.quadVertexBuffer);delete this.camera;delete this.ambientColor;this.zonlyShader&&(delete this.zonlyShader,delete this.zonlyRigidTechnique,delete this.zonlySkinnedTechnique,delete this.zonlyRigidAlphaTechnique,delete this.zonlySkinnedAlphaTechnique,delete this.zonlyRigidNoCullTechnique,delete this.zonlySkinnedNoCullTechnique,delete this.zonlyRigidAlphaNoCullTechnique,delete this.zonlySkinnedAlphaNoCullTechnique,
delete this.stencilSetTechnique,delete this.stencilClearTechnique,delete this.stencilSetSpotLightTechnique,delete this.stencilClearSpotLightTechnique);this.forwardShader&&(delete this.forwardShader,delete this.skyboxTechnique,delete this.ambientRigidTechnique,delete this.ambientSkinnedTechnique,delete this.ambientRigidAlphaTechnique,delete this.ambientSkinnedAlphaTechnique,delete this.ambientFlatRigidTechnique,delete this.ambientFlatRigidNoCullTechnique,delete this.ambientFlatSkinnedTechnique,delete this.ambientGlowmapRigidTechnique,
delete this.ambientGlowmapSkinnedTechnique,delete this.ambientLightmapRigidTechnique,delete this.glowmapRigidTechnique,delete this.glowmapSkinnedTechnique,delete this.lightmapRigidTechnique);var a=this.shadowMaps;a&&(a.destroy(),delete this.shadowMaps);this.destroyBuffers();delete this.md};Ga.create=function(a,b,c,d,f){var g=new Ga;g.md=b;g.globalTechniqueParameters=a.createTechniqueParameters({time:0});g.ambientTechniqueParameters=a.createTechniqueParameters({ambientColor:b.v3BuildZero()});g.numPasses=
g.passIndex.transparent+1;var h=g.passes=[],e=g.numPasses,j;for(j=0;j<e;j+=1)h[j]=[];g.lightingScale=2;g.diffuseQueue=[];g.numDiffuseQueue=0;g.overlapQueryRenderables=[];g.lightVisibleRenderables=[];g.spotLights=[];g.pointLights=[];g.localDirectionalLights=[];g.globalDirectionalLights=[];g.fogLights=[];g.worldView=b.m43BuildIdentity();g.lightViewInverseProjection=b.m43BuildIdentity();g.lightViewInverseTransposeFalloff=a.createTechniqueParameterBuffer({numFloats:16});g.lightViewInverseTranspose=b.m43BuildIdentity();
g.lightFalloff=b.v4BuildZero();g.v3Zero=b.v3BuildZero();g.v4Zero=b.v4BuildZero();g.v4One=b.v4BuildOne();g.identityUVTransform=new Float32Array([1,0,0,1,0,0]);g.quadPrimitive=a.PRIMITIVE_TRIANGLE_STRIP;g.quadSemantics=a.createSemantics(["POSITION","TEXCOORD0"]);g.quadVertexBuffer=a.createVertexBuffer({numVertices:4,attributes:["FLOAT2","FLOAT2"],dynamic:!1,data:[-1,1,0,1,1,1,1,1,-1,-1,0,0,1,-1,1,0]});c.load("shaders/zonly.cgfx");c.load("shaders/forwardrendering.cgfx",function(a){a=a.getParameter("skinBones");
g.defaultSkinBufferSize=a.rows*a.columns});var i,l;f&&f.shadowRendering&&(c.load("shaders/forwardrenderingshadows.cgfx"),l=Ci.create(a,b,c,d,f.shadowSizeLow,f.shadowSizeHigh),g.shadowMaps=l,i=l.update,l=l.skinnedUpdate,g.defaultShadowMappingUpdateFn=i,g.defaultShadowMappingSkinnedUpdateFn=l);var m,k,p,s,f=b.v3Build(0.5,0,0),h=b.v3Build(0,0.5,0),e=b.v3Build(0.5,0.5,1);j=b.v3Build(0,0,0);g.lightProjection=b.m43Build(f,h,e,j);var t=function(a,c,d){a=b.m43Mul(a.world,d.viewMatrix,c.worldView);b.m33InverseTranspose(a,
c.worldViewInverseTranspose)},f=function(a){var b=this.node,c=b.rendererInfo;c.frameVisible!==b.frameVisible&&(c.frameVisible=b.frameVisible,t(b,c,a));a=this.techniqueParameters;a.worldView=c.worldView;a.worldViewInverseTranspose=c.worldViewInverseTranspose},h=function(a){var b=this.node,c=b.rendererInfo;c.frameVisible!==b.frameVisible&&(c.frameVisible=b.frameVisible,t(b,c,a));a=this.techniqueParameters;a.worldView=c.worldView;a.worldViewInverseTranspose=c.worldViewInverseTranspose;if(c=this.skinController)a.skinBones=
c.output,c.update()},u=function(c){var d,f,h=c.rendererInfo;d=c.sharedMaterial;var e=d.meta,n=d.techniqueParameters,j=c.techniqueParameters,l=j.materialColor||n.materialColor||g.v4One;c.drawParameters=[];var i,m=this.technique.name,r=0,k=c.node;k.rendererInfo||Ga.createNodeRendererInfo(k,b);if(n.glow_map||n.light_map)d=d=a.createDrawParameters(),d.userData={},c.prepareDrawParameters(d),d.userData.passIndex=g.passIndex.glow,c.drawParameters.push(d),d.technique=n.light_map?g.lightmapRigidTechnique:
c.skinController?g.glowmapSkinnedTechnique:g.glowmapRigidTechnique,d.sortKey=$a(d.technique.id,e.materialIndex),d.setTechniqueParameters(0,n),d.setTechniqueParameters(1,j);else if(!e.transparent&&!e.decal){d=a.createDrawParameters();d.userData={};c.prepareDrawParameters(d);d.userData.passIndex=g.passIndex.fillZ;c.drawParameters.push(d);i=0;var q=!1,p=-1!==m.indexOf("_nocull");n.alpha_map?(r=16384,q=!0,f=a.createTechniqueParameters(),f.alpha_map=n.alpha_map,f.alphaFactor=l[3],n.uvTransform&&(f.uvTransform=
n.uvTransform),d.setTechniqueParameters(i,f),i+=1):-1!==m.indexOf("_alpha")?(q=!0,r=16384,f=a.createTechniqueParameters(),f.alpha_map=n.diffuse,f.alphaFactor=l[3],n.uvTransform&&(f.uvTransform=n.uvTransform),d.setTechniqueParameters(i,f),i+=1):-1!==m.indexOf("_nocull")&&(p=!0);d.technique=c.skinController?q?p?g.zonlySkinnedAlphaNoCullTechnique:g.zonlySkinnedAlphaTechnique:p?g.zonlySkinnedNoCullTechnique:g.zonlySkinnedTechnique:q?p?g.zonlyRigidAlphaNoCullTechnique:g.zonlyRigidAlphaTechnique:p?g.zonlyRigidNoCullTechnique:
g.zonlyRigidTechnique;f=d.technique.id;d.sortKey=q?$a(r|f,e.materialIndex):$a(r|f,k.rendererInfo.id);d.setTechniqueParameters(i,j)}!e.transparent&&!e.decal&&(d=a.createDrawParameters(),d.userData={},c.prepareDrawParameters(d),d.userData.passIndex=g.passIndex.ambient,c.drawParameters.push(d),d.technique=c.skinController?n.glow_map?n.diffuse?g.ambientGlowmapSkinnedTechnique:g.glowmapSkinnedTechnique:0===m.indexOf("flat")?g.ambientFlatSkinnedTechnique:g.ambientSkinnedTechnique:n.light_map?g.ambientLightmapRigidTechnique:
n.glow_map?n.diffuse?g.ambientGlowmapRigidTechnique:g.glowmapRigidTechnique:0===m.indexOf("flat")?-1!==m.indexOf("_nocull")?g.ambientFlatRigidNoCullTechnique:g.ambientFlatRigidTechnique:-1!==m.indexOf("_alpha")?g.ambientRigidAlphaTechnique:g.ambientRigidTechnique,d.sortKey=$a(r|d.technique.id,e.materialIndex),d.setTechniqueParameters(0,n),d.setTechniqueParameters(1,j));d=a.createDrawParameters();d.userData={};c.prepareDrawParameters(d);d.technique=this.technique;d.sortKey=$a(r|this.techniqueIndex,
e.materialIndex);c.renderUpdate=this.update;d.setTechniqueParameters(0,n);d.setTechniqueParameters(1,j);e.decal?(d.userData.passIndex=g.passIndex.decal,c.drawParameters.push(d)):e.transparent?(d.userData.passIndex=g.passIndex.transparent,c.drawParameters.push(d)):(0===m.indexOf("glowmap")||0===m.indexOf("lightmap")?c.diffuseDrawParameters=[]:(d.userData.passIndex=g.passIndex.diffuse,c.diffuseDrawParameters=[d]),g.shadowMaps&&this.shadowTechnique?(d=a.createDrawParameters(),d.userData={},c.prepareDrawParameters(d),
d.technique=this.shadowTechnique,d.sortKey=$a(r|this.shadowTechniqueIndex,e.materialIndex),d.setTechniqueParameters(0,n),d.setTechniqueParameters(1,j),c.diffuseShadowDrawParameters=[d]):c.diffuseShadowDrawParameters=c.diffuseDrawParameters);g.shadowMaps&&(this.shadowMappingUpdate&&!e.noshadows?(d=a.createDrawParameters(),d.userData={},c.prepareDrawParameters(d),c.shadowMappingDrawParameters=[d],d.userData.passIndex=g.passIndex.shadow,h.shadowMappingUpdate=this.shadowMappingUpdate,d.technique=this.shadowMappingTechnique,
d.sortKey=$a(this.shadowMappingTechniqueIndex,k.rendererInfo.id),h=a.createTechniqueParameters(),c.shadowTechniqueParameters=h,d.setTechniqueParameters(0,h)):e.noshadows=!0)};g.defaultUpdateFn=f;g.defaultSkinnedUpdateFn=h;g.defaultPrepareFn=u;e=function(a){var b=this.node,c=b.rendererInfo;c.frameVisible!==b.frameVisible&&(c.frameVisible=b.frameVisible,t(b,c,a));this.techniqueParameters.worldView=c.worldView};j=function(){this.techniqueParameters.world=this.node.world};var z=function(){var a=this.techniqueParameters;
a.world=this.node.world;var b=this.skinController;b&&(a.skinBones=b.output,b.update())},B=function(){var a=this.techniqueParameters,c=this.node,d=c.worldUpdate;this.techniqueParametersUpdated!==d&&(this.techniqueParametersUpdated=d,c=c.world,a.world=c,a.worldInverseTranspose=b.m33InverseTranspose(c,a.worldInverseTranspose))},y=function(a){var b=this;a.load(this.shaderName,function(a){b.shader=a;b.technique=a.getTechnique(b.techniqueName);b.techniqueIndex=b.technique.id});g.shadowMaps&&(this.shadowMappingTechniqueName&&
a.load(this.shadowMappingShaderName,function(a){b.shadowMappingShader=a;b.shadowMappingTechnique=a.getTechnique(b.shadowMappingTechniqueName);b.shadowMappingTechniqueIndex=b.shadowMappingTechnique.id}),this.shadowTechniqueName&&a.load(this.shadowShaderName,function(a){b.shadowShader=a;b.shadowTechnique=a.getTechnique(b.shadowTechniqueName);b.shadowTechniqueIndex=b.shadowTechnique.id}))};g.loadTechniquesFn=y;var v,x;v=Y.create("rxgb_normalmap");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",
techniqueName:"rxgb_normalmap",update:f,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"rxgb_normalmap_shadows",loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"rxgb_normalmap_skinned",update:h,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",shadowMappingUpdate:l,
shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"rxgb_normalmap_skinned_shadows",loadTechniques:y};x.loadTechniques(c);v.add("skinned",x);v=Y.create("rxgb_normalmap_specularmap");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"rxgb_normalmap_specularmap",update:f,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"rxgb_normalmap_specularmap_shadows",
loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"rxgb_normalmap_specularmap_skinned",update:h,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",shadowMappingUpdate:l,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"rxgb_normalmap_specularmap_skinned_shadows",loadTechniques:y};x.loadTechniques(c);v.add("skinned",x);v=Y.create("rxgb_normalmap_alphatest");d.add(v);
x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"rxgb_normalmap_alphatest",update:f,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"rxgb_normalmap_alphatest_shadows",loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"rxgb_normalmap_alphatest_skinned",update:h,shadowMappingShaderName:"shaders/shadowmapping.cgfx",
shadowMappingTechniqueName:"skinned",shadowMappingUpdate:l,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"rxgb_normalmap_alphatest_skinned_shadows",loadTechniques:y};x.loadTechniques(c);v.add("skinned",x);v=Y.create("rxgb_normalmap_specularmap_alphatest");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"rxgb_normalmap_specularmap_alphatest",update:f,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",
shadowMappingUpdate:i,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"rxgb_normalmap_specularmap_alphatest_shadows",loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"rxgb_normalmap_specularmap_alphatest_skinned",update:h,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",shadowMappingUpdate:l,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"rxgb_normalmap_specularmap_alphatest_skinned_shadows",
loadTechniques:y};x.loadTechniques(c);v.add("skinned",x);v=Y.create("rxgb_normalmap_glowmap");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"rxgb_normalmap_glowmap",update:f,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"rxgb_normalmap_glowmap_shadows",loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",
techniqueName:"rxgb_normalmap_glowmap_skinned",update:h,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",shadowMappingUpdate:l,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"rxgb_normalmap_glowmap_skinned_shadows",loadTechniques:y};x.loadTechniques(c);v.add("skinned",x);v=Y.create("rxgb_normalmap_specularmap_glowmap");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"rxgb_normalmap_specularmap_glowmap",
update:f,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"rxgb_normalmap_specularmap_glowmap_shadows",loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"rxgb_normalmap_specularmap_glowmap_skinned",update:h,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",
shadowMappingUpdate:l,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"rxgb_normalmap_specularmap_glowmap_skinned_shadows",loadTechniques:y};x.loadTechniques(c);v.add("skinned",x);v=Y.create("add");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"add",update:j,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",
techniqueName:"add_skinned",update:z,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",shadowMappingUpdate:l,loadTechniques:y};x.loadTechniques(c);v.add("skinned",x);v=Y.create("add_particle");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"add_particle",update:j,loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);v=Y.create("blend");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"blend",update:j,
shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"blend_skinned",update:z,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",shadowMappingUpdate:l,loadTechniques:y};x.loadTechniques(c);v.add("skinned",x);v=Y.create("blend_particle");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",
techniqueName:"blend_particle",update:j,loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);v=Y.create("translucent");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"translucent",shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,update:j,loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"translucent_skinned",update:z,shadowMappingShaderName:"shaders/shadowmapping.cgfx",
shadowMappingTechniqueName:"skinned",shadowMappingUpdate:l,loadTechniques:y};x.loadTechniques(c);v.add("skinned",x);v=Y.create("translucent_particle");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"translucent_particle",update:j,loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);v=Y.create("filter");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"filter",update:j,loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,
shaderName:"shaders/forwardrendering.cgfx",techniqueName:"filter_skinned",update:z,loadTechniques:y};x.loadTechniques(c);v.add("skinned",x);v=Y.create("invfilter");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"invfilter",update:j,loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);v=Y.create("invfilter_particle");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"invfilter_particle",update:j,loadTechniques:y};x.loadTechniques(c);v.add("rigid",
x);v=Y.create("glass");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"glass",update:j,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);v=Y.create("glass_env");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"glass_env",update:B,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,
loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);v=Y.create("modulate2");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"modulate2",update:j,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"modulate2_skinned",update:z,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",
shadowMappingUpdate:l,loadTechniques:y};x.loadTechniques(c);v.add("skinned",x);v=Y.create("skybox");d.add(v);x={prepare:function(b){var c;c=b.sharedMaterial;var d=c.meta,f=c.techniqueParameters,h=b.techniqueParameters;b.drawParameters=[];c=a.createDrawParameters();c.userData={};b.prepareDrawParameters(c);c.userData.passIndex=g.passIndex.glow;c.technique=g.skyboxTechnique;c.setTechniqueParameters(0,f);c.setTechniqueParameters(1,h);c.sortKey=$a(c.technique.id,d.materialIndex);b.drawParameters.push(c);
c=a.createDrawParameters();c.userData={};b.prepareDrawParameters(c);c.userData.passIndex=g.passIndex.ambient;c.technique=g.skyboxTechnique;c.setTechniqueParameters(0,f);c.setTechniqueParameters(1,h);c.sortKey=$a(0|c.technique.id,d.materialIndex);b.drawParameters.push(c);b.diffuseDrawParameters=[];b.diffuseShadowDrawParameters=[];b.renderUpdate=this.update},shaderName:"shaders/forwardrendering.cgfx",techniqueName:"skybox",update:function(){this.techniqueParameters.world=this.node.world},loadTechniques:y};
x.loadTechniques(c);v.add("rigid",x);v=Y.create("env");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"env",update:B,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"env_skinned",update:function(){var a=this.techniqueParameters,c=this.node,d=c.worldUpdate;this.techniqueParametersUpdated!==
d&&(this.techniqueParametersUpdated=d,c=c.world,a.world=c,a.worldInverseTranspose=b.m33InverseTranspose(c,a.worldInverseTranspose));if(c=this.skinController)a.skinBones=c.output,c.update()},shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",shadowMappingUpdate:l,loadTechniques:y};x.loadTechniques(c);v.add("skinned",x);v=Y.create("flare");d.add(v);x={prepare:function(c){if(!c.customGeometry){c.customGeometry=!0;m||(m=a.createIndexBuffer({numIndices:8,format:"USHORT",
dynamic:!1,data:[1,0,2,5,4,3,2,1]}),k=a.createSemantics(["POSITION","TEXCOORD"]),p=new H(30),s=b.m43BuildIdentity());var d=c.geometry,f=d.semantics,g=d.vertexBuffer,h=c.surface,e=h.vertexData,n=h.indexData,h=a.createVertexBuffer({numVertices:6,attributes:["FLOAT3","FLOAT2"],dynamic:!0}),h={halfExtents:d.halfExtents,primitive:a.PRIMITIVE_TRIANGLE_STRIP,semantics:k,vertexBuffer:h,numIndices:8,first:0,indexBuffer:m,lastTimeVisible:!0,center:void 0,sourceVertices:void 0},j=d.center;j&&(h.center=j);c.geometry=
h;c.surface=h;c.semantics=k;var l=a.SEMANTIC_NORMAL,i=a.SEMANTIC_TEXCOORD,g=g.stride,j=0;f[0]===l?(j+=3,f[1]===i&&(j+=2)):f[0]===i&&(j+=2,f[1]===l&&(j+=3));var f=0!==n[3]&&0!==n[4]&&0!==n[5]?[0,2,1,3]:1!==n[3]&&1!==n[4]&&1!==n[5]?[1,0,2,3]:[3,0,1,2],n=f[0]*g+j,i=f[1]*g+j,r=f[2]*g+j,v=f[3]*g+j,f=e[n+0],g=e[n+1],j=e[n+2],n=e[i+0],l=e[i+1],x=e[i+2],i=e[r+0],t=e[r+1],r=e[r+2],y=e[v+0],D=e[v+1],z=e[v+2],v=b.v3Build(0.5*(f+n),0.5*(g+l),0.5*(j+x)),B=b.v3Build(0.5*(f+i),0.5*(g+t),0.5*(j+r)),e=b.v3Build(0.5*
(n+y),0.5*(l+D),0.5*(x+z)),D=b.v3Build(0.5*(i+y),0.5*(t+D),0.5*(r+z));w.v3LengthSq(w.v3Sub(v,D))>w.v3LengthSq(w.v3Sub(B,e))?(y=v,e=D):y=B;n=w.v3Normalize(b.v3Build(n-f,l-g,x-j));f=w.v3Normalize(b.v3Build(i-f,t-g,r-j));f=w.v3Cross(n,f);h.sourceVertices=[y,e,f];d.reference.remove();u.call(this,c)}},shaderName:"shaders/forwardrendering.cgfx",techniqueName:"add",update:function(a){var c=this.geometry,d=this.node,f,g,h,e,n,j,l,i,m,r,k,q,u,v,x;e=d.worldUpdate;if(this.techniqueParametersUpdated!==e){this.techniqueParametersUpdated=
e;e=d.world;this.techniqueParameters.world=s;n=c.sourceVertices;f=b.m43TransformPoint(e,n[0],c.top);g=b.m43TransformPoint(e,n[1],c.bottom);h=b.m43TransformVector(e,n[2],c.normal);e=f[0];n=f[1];j=f[2];l=g[0];i=g[1];m=g[2];u=h[0];v=h[1];x=h[2];r=e-l;k=n-i;q=j-m;var t=r*r+k*k+q*q,t=0<t?1/Math.sqrt(t):0;r*=t;k*=t;q*=t;d.dynamic?(c.top=f,c.bottom=g,c.normal=h):(c.top=[e,n,j],c.bottom=[l,i,m],c.normal=[u,v,x]);c.tb=[r,k,q]}else f=c.top,g=c.bottom,d=c.tb,h=c.normal,e=f[0],n=f[1],j=f[2],l=g[0],i=g[1],m=g[2],
r=d[0],k=d[1],q=d[2],u=h[0],v=h[1],x=h[2];d=c.vertexBuffer;f=a.matrix;g=l-f[9];a=i-f[10];f=m-f[11];if(0>u*g+v*a+x*f)c.lastTimeVisible=!0,u=this.sharedMaterial.meta.flareScale,c=g*g+a*a+f*f,c=0<c?1/Math.sqrt(c):0,g*=c,a*=c,f*=c,c=a*q-f*k,q=f*r-g*q,r=g*k-a*r,k=q*f-r*a,v=r*g-c*f,x=c*a-q*g,c*=u,q*=u,r*=u,k*=u,v*=u,x*=u,u*=-2.5,g*=u,a*=u,f*=u,u=p,u[0]=e-c+k+g,u[1]=n-q+v+a,u[2]=j-r+x+f,u[3]=1,u[4]=0,u[5]=e+c+k+g,u[6]=n+q+v+a,u[7]=j+r+x+f,u[8]=1,u[9]=1,u[10]=e,u[11]=n,u[12]=j,u[13]=0.5,u[14]=0,u[15]=l+c-
k+g,u[16]=i+q-v+a,u[17]=m+r-x+f,u[18]=1,u[19]=0,u[20]=l,u[21]=i,u[22]=m,u[23]=0.5,u[24]=1,u[25]=l-c-k+g,u[26]=i-q-v+a,u[27]=m-r-x+f,u[28]=1,u[29]=1,d.setData(u,0,6);else if(c.lastTimeVisible){c.lastTimeVisible=!1;for(e=0;30>e;e+=1)p[e]=0;d.setData(p,0,6)}},loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);v=Y.create("blinn");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"blinn",update:f,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",
shadowMappingUpdate:i,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"blinn_shadows",loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"blinn_skinned",update:h,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",shadowMappingUpdate:l,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"blinn_skinned_shadows",loadTechniques:y};x.loadTechniques(c);
v.add("skinned",x);v=Y.create("blinn_nocull");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"blinn_nocull",update:f,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"blinn_shadows_nocull",loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"blinn_skinned_nocull",
update:h,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",shadowMappingUpdate:l,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"blinn_skinned_shadows_nocull",loadTechniques:y};x.loadTechniques(c);v.add("skinned",x);v=Y.create("normalmap");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"normalmap",update:f,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,
shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"normalmap_shadows",loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"normalmap_skinned",update:h,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",shadowMappingUpdate:l,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"normalmap_skinned_shadows",loadTechniques:y};x.loadTechniques(c);
v.add("skinned",x);v=Y.create("normalmap_specularmap");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"normalmap_specularmap",update:f,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"normalmap_specularmap_shadows",loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"normalmap_specularmap_skinned",
update:h,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",shadowMappingUpdate:l,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"normalmap_specularmap_skinned_shadows",loadTechniques:y};x.loadTechniques(c);v.add("skinned",x);v=Y.create("normalmap_specularmap_alphamap");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"normalmap_specularmap_alphamap",update:f,shadowMappingShaderName:"shaders/shadowmapping.cgfx",
shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"normalmap_specularmap_alphamap_shadows",loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"normalmap_specularmap_alphamap_skinned",update:h,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",shadowMappingUpdate:l,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",
shadowTechniqueName:"normalmap_specularmap_alphamap_skinned_shadows",loadTechniques:y};x.loadTechniques(c);v.add("skinned",x);v=Y.create("normalmap_alphatest");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"normalmap_alphatest",update:f,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"normalmap_alphatest_shadows",loadTechniques:y};
x.loadTechniques(c);v.add("rigid",x);v=Y.create("normalmap_specularmap_alphatest");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"normalmap_specularmap_alphatest",update:f,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"normalmap_specularmap_alphatest_shadows",loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,
shaderName:"shaders/forwardrendering.cgfx",techniqueName:"normalmap_specularmap_alphatest_skinned",update:h,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",shadowMappingUpdate:l,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"normalmap_specularmap_alphatest_skinned_shadows",loadTechniques:y};x.loadTechniques(c);v.add("skinned",x);v=Y.create("normalmap_glowmap");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"normalmap_glowmap",
update:f,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"normalmap_glowmap_shadows",loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"normalmap_glowmap_skinned",update:h,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",shadowMappingUpdate:l,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",
shadowTechniqueName:"normalmap_glowmap_skinned_shadows",loadTechniques:y};x.loadTechniques(c);v.add("skinned",x);v=Y.create("normalmap_specularmap_glowmap");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"normalmap_specularmap_glowmap",update:f,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"normalmap_specularmap_glowmap_shadows",
loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"normalmap_specularmap_glowmap_skinned",update:h,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",shadowMappingUpdate:l,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"normalmap_specularmap_glowmap_skinned_shadows",loadTechniques:y};x.loadTechniques(c);v.add("skinned",x);d.map("default","blinn");d.map("lambert",
"blinn");d.map("phong","blinn");v=Y.create("glowmap");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"glowmap",update:e,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"glowmap_skinned",update:function(a){var b=this.node,c=b.rendererInfo;c.frameVisible!==b.frameVisible&&(c.frameVisible=
b.frameVisible,t(b,c,a));a=this.techniqueParameters;a.worldView=c.worldView;if(c=this.skinController)a.skinBones=c.output,c.update()},shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",shadowMappingUpdate:l,loadTechniques:y};x.loadTechniques(c);v.add("skinned",x);v=Y.create("constant");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"flat",update:f,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",
shadowMappingUpdate:i,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"flat_shadows",loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"flat_skinned",update:h,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",shadowMappingUpdate:l,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"flat_skinned_shadows",loadTechniques:y};x.loadTechniques(c);
v.add("skinned",x);v=Y.create("constant_nocull");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"flat_nocull",update:f,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"flat_shadows_nocull",loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"flat_skinned_nocull",
update:h,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",shadowMappingUpdate:l,shadowShaderName:"shaders/forwardrenderingshadows.cgfx",shadowTechniqueName:"flat_skinned_shadows_nocull",loadTechniques:y};x.loadTechniques(c);v.add("skinned",x);v=Y.create("lightmap");d.add(v);x={prepare:u,shaderName:"shaders/forwardrendering.cgfx",techniqueName:"lightmap",update:e,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:i,
loadTechniques:y};x.loadTechniques(c);v.add("rigid",x);return g};Ga.version=1;Ga.nextNodeID=0;var Ci,jb=function(){this.defaultSizeLow=512;this.defaultSizeHigh=1024;this.blurEnabled=!0};jb.prototype.updateShader=function(a){a=a.get("shaders/shadowmapping.cgfx");a!==this.shadowMappingShader&&(this.shader=a,this.rigidTechnique=a.getTechnique("rigid"),this.skinnedTechnique=a.getTechnique("skinned"),this.blurTechnique=a.getTechnique("blur"))};jb.prototype.update=function(){this.shadowTechniqueParameters.world=
this.node.world};jb.prototype.skinnedUpdate=function(){var a=this.shadowTechniqueParameters;a.world=this.node.world;var b=this.skinController;b&&(a.skinBones=b.output,b.update())};jb.prototype.destroyBuffers=function(){var a,b,c,d,f;if(a=this.shadowMapsLow){b=a.length;for(c=0;c<b;c+=1){d=a[c];if(f=d.renderTarget)f.destroy(),d.renderTarget=null;if(f=d.texture)f.destroy(),d.texture=null}a.length=0}if(a=this.shadowMapsHigh){b=a.length;for(c=0;c<b;c+=1){d=a[c];if(f=d.renderTarget)f.destroy(),d.renderTarget=
null;if(f=d.texture)f.destroy(),d.texture=null}a.length=0}this.blurRenderTargetLow&&(this.blurRenderTargetLow.destroy(),this.blurRenderTargetLow=null);this.blurRenderTargetHigh&&(this.blurRenderTargetHigh.destroy(),this.blurRenderTargetHigh=null);this.blurTextureLow&&(this.blurTextureLow.destroy(),this.blurTextureLow=null);this.blurTextureHigh&&(this.blurTextureHigh.destroy(),this.blurTextureHigh=null);this.depthBufferLow&&(this.depthBufferLow.destroy(),this.depthBufferLow=null);this.depthBufferHigh&&
(this.depthBufferHigh.destroy(),this.depthBufferHigh=null)};jb.prototype.updateBuffers=function(a,b){if(this.sizeLow===a&&this.sizeHigh===b)return!0;!a&&!b&&(a=this.sizeLow,b=this.sizeHigh);var c=this.gd;this.shadowMapsHigh=[];this.shadowMapsLow=[];this.destroyBuffers();this.depthBufferLow=c.createRenderBuffer({width:a,height:a,format:"D16"});this.depthBufferHigh=c.createRenderBuffer({width:b,height:b,format:"D16"});this.blurTextureLow=c.createTexture({width:a,height:a,format:"R5G6B5",mipmaps:!1,
renderable:!0});this.blurTextureHigh=c.createTexture({width:b,height:b,format:"R5G6B5",mipmaps:!1,renderable:!0});if(this.depthBufferLow&&(this.depthBufferHigh&&this.blurTextureLow&&this.blurTextureHigh)&&(this.blurRenderTargetLow=c.createRenderTarget({colorTexture0:this.blurTextureLow}),this.blurRenderTargetHigh=c.createRenderTarget({colorTexture0:this.blurTextureHigh}),this.blurRenderTargetLow&&this.blurRenderTargetHigh))return this.sizeLow=a,this.sizeHigh=b,!0;this.sizeHigh=this.sizeLow=0;this.destroyBuffers();
return!1};jb.prototype.findVisibleRenderables=function(a){var b=this.md,c=a.light,d=a.node,f=d.world,g=a.occludersDrawArray,h=a.lightOrigin,e,j,i,l=c.halfExtents,m=a.shadowMapInfo;m||(m={camera:Ea.create(b),target:b.v3BuildZero()},a.shadowMapInfo=m);e=m.target;var k=m.camera;if(c.spot)i=b.m33MulM43(c.frustum,f,m.frustumWorld),b.v3Add(h,b.m43At(i,e),e),j=b.m43Up(i,this.tempV3Up),m.frustumWorld=i,k.parallel=!1;else{var p=b.m43Up(f,this.tempV3Up);i=b.m43At(f,this.tempV3At);var s=b.m43Pos(f,this.tempV3Pos),
t=Math.abs;if(c.point)b.v3AddScalarMul(s,p,-l[1],e),j=b.v3Sub(e,h,s),k.parallel=!1;else{j=c.direction;var h=j[0],u=j[1],z=j[2];j=l[0];var w=l[1],l=l[2],y=-j,v=-w,x=-l,A=h*(0<h?j:y)+u*(0<u?w:v)+z*(0<z?l:x),h=h*(0<h?y:j)+u*(0<u?v:w)+z*(0<z?x:l);j=b.m43TransformVector(f,c.direction);b.v3AddScalarMul(s,j,A,e);h=b.v3AddScalarMul(s,j,h);k.parallel=!0}j=t(b.v3Dot(j,i))<t(b.v3Dot(j,p))?i:p}this.lookAt(k,e,j,h);k.updateViewMatrix();k=k.viewMatrix;if(!a.lightDepth||c.dynamic){l=c.halfExtents;j=l[0];w=l[1];
l=l[2];if(c.spot){f=Math.tan;p=Math.acos;i=m.frustumWorld;j=b.m43TransformPoint(i,b.v3Build(-1,-1,1));w=b.m43TransformPoint(i,b.v3Build(1,-1,1));l=b.m43TransformPoint(i,b.v3Build(-1,1,1));e=b.m43TransformPoint(i,b.v3Build(1,1,1));i=b.v3Sub(b.v3ScalarMul(b.v3Add4(j,w,l,e),0.25),h);e=b.v3Length(i);if(0>=e)return a.shadows=!1;i=b.v3ScalarMul(i,1/e);c=b.v3Normalize(b.v3Sub(b.v3ScalarMul(b.v3Add(j,l),0.5),h));h=b.v3Normalize(b.v3Sub(b.v3ScalarMul(b.v3Add(j,w),0.5),h));c=f(p(b.v3Dot(i,c)));j=f(p(b.v3Dot(i,
h)))}else if(c.point){(c=c.origin)?(e=e.slice(),e[0]-=c[0],e[2]-=c[2],e=b.v3Length(b.v3Sub(e,h)),c=j/e,j=l/e):(e=w,c=j/w,j=l/w);if(0>=e)return a.shadows=!1;c*=3;j*=3}else c=k[0],f=k[1],s=k[3],p=k[4],t=k[6],i=k[7],c=(0>c?-c:c)*j+(0>s?-s:s)*w+(0>t?-t:t)*l,j=(0>f?-f:f)*j+(0>p?-p:p)*w+(0>i?-i:i)*l,e=b.v3Length(b.v3Sub(e,h));a.lightViewWindowX=c;a.lightViewWindowY=j;a.lightDepth=e}g||(g=Array(C),a.occludersDrawArray=g,a.minLightDistance=0,a.maxLightDistance=0,a.minLightDistanceX=0,a.maxLightDistanceX=
0,a.minLightDistanceY=0,a.maxLightDistanceY=0,a.shadowMap=null,a.shadows=!1);e=a.numStaticOverlappingRenderables;var h=a.overlappingRenderables,C=h.length,b=a.staticNodesChangeCounter;if(d.dynamic||e!==C||m.staticNodesChangeCounter!==b)d=this.occludersExtents,C=this._filterOccluders(h,e,g,d),C=this._updateOccludersLimits(a,k,g,d,C),g.length=C,m.staticNodesChangeCounter=b;return 0<g.length};jb.prototype.drawShadowMap=function(a,b,c){var d=this.md,f=this.gd,g=c.node,h=c.light,e=c.shadowMapInfo.camera,
j=e.viewMatrix,i=c.lightOrigin,l=h.halfExtents,m=l[0],k=l[1],p=l[2];c.shadows=!1;var l=c.occludersDrawArray,s;if(l&&(s=l.length)){var t=c.numStaticOverlappingRenderables,u=c.overlappingRenderables.length,z,w;if(Math.max(m,k,p)>=b){w=this.sizeHigh;var y=this.highIndex;if(y<this.shadowMapsHigh.length)b=this.shadowMapsHigh[y],z=b.texture,k=b.renderTarget;else if(z=f.createTexture({width:w,height:w,format:"R5G6B5",mipmaps:!1,renderable:!0}))if(k=f.createRenderTarget({colorTexture0:z,depthBuffer:this.depthBufferHigh}))b=
{texture:z,renderTarget:k,lightInstance:c},this.shadowMapsHigh[y]=b;else return;else return;this.highIndex=y+1}else{w=this.sizeLow;y=this.lowIndex;if(y<this.shadowMapsLow.length)b=this.shadowMapsLow[y],z=b.texture,k=b.renderTarget;else if(z=f.createTexture({width:w,height:w,format:"R5G6B5",mipmaps:!1,renderable:!0}))if(k=f.createRenderTarget({colorTexture0:z,depthBuffer:this.depthBufferLow}))b={texture:z,renderTarget:k,lightInstance:c},this.shadowMapsLow[y]=b;else return;else return;this.lowIndex=
y+1}c.shadowMap=b;c.shadows=!0;var v=1/65536,y=c.minLightDistance-v,x=c.maxLightDistance+v,A=c.lightViewWindowX,C=c.lightViewWindowY,E=c.lightDepth,H=0,G=0;if(0<y){var I=3/w,K=c.minLightDistanceX,F=c.maxLightDistanceX,N=c.minLightDistanceY,L=c.maxLightDistanceY;if(h.directional)K<-A&&(K=-A),F>A&&(F=A),N<-C&&(N=-C),L>C&&(L=C),i=Math.max(Math.abs(F),Math.abs(K)),i+=2*I*i,m=Math.max(Math.abs(L),Math.abs(N)),m+=2*I*m,A>i&&(A=i),C>m&&(C=m);else{var O=E<x?E:x;(h=h.origin)?(m+=Math.abs(i[0]),i=p+Math.abs(i[2]),
K<-m&&(K=-m),F>m&&(F=m),N<-i&&(N=-i),L>i&&(L=i)):(K<-m&&(K=-m),F>m&&(F=m),N<-p&&(N=-p),L>p&&(L=p));K/=0>=K?y:O;N/=0>=N?y:O;i=0.5*(F/(0<=F?y:O)-K)+I;m=0.5*(L/(0<=L?y:O)-N)+I;A>i&&(A=i,H=i+K-I);C>m&&(C=m,G=m+N-I)}}e.aspectRatio=1;e.nearPlane=E*v;e.farPlane=E+v;e.recipViewWindowX=1/A;e.recipViewWindowY=1/C;e.viewOffsetX=H;e.viewOffsetY=G;y>e.nearPlane&&(e.nearPlane=y);e.farPlane>x&&(e.farPlane=x);e.updateProjectionMatrix();e.updateViewProjectionMatrix();i=1/(x-y);m=c.techniqueParameters;m.shadowProjection=
d.m43MulM44(a,e.viewProjectionMatrix,m.shadowProjection);a=d.m43Mul(a,j,this.tempMatrix43);m.shadowDepth=d.v4Build(-a[2]*i,-a[5]*i,-a[8]*i,(-a[11]-y)*i,m.shadowDepth);m.shadowSize=w;m.shadowMapTexture=z;c=c.frameVisible;if(t===u&&!g.dynamic){if(b.numRenderables===s&&b.lightNode===g&&b.frameUpdated+1===c){b.frameUpdated=c;b.needsBlur=!1;return}b.numRenderables=s;b.lightNode=g;b.frameUpdated=c}else b.numRenderables=s;b.frameVisible=c;b.needsBlur=this.blurEnabled;f.beginRenderTarget(k)&&(f.clear(this.clearColor,
1,0),g=this.techniqueParameters,g.viewTranspose=d.m43Transpose(j,g.viewTranspose),g.shadowProjectionTranspose=d.m44Transpose(e.projectionMatrix,g.shadowProjectionTranspose),g.shadowDepth=d.v4Build(0,0,-i,-y*i,g.shadowDepth),f.drawArray(l,[g],1),f.endRenderTarget())}};jb.prototype._filterOccluders=function(a,b,c,d){var f=a.length,g=0,h,e,j,i,l;for(h=0;h<f;h+=1)if(e=a[h],!e.disabled&&(!e.node.disabled&&!e.sharedMaterial.meta.noshadows)&&((j=e.rendererInfo)||(j=Gj(e)),j.shadowMappingUpdate&&e.shadowMappingDrawParameters)){j.shadowMappingUpdate.call(e);
j=h>=b?e.getWorldExtents():e.worldExtents;e=e.shadowMappingDrawParameters;i=e.length;for(l=0;l<i;l+=1)c[g]=e[l],d[g]=j,g+=1}return g};jb.prototype._updateOccludersLimits=function(a,b,c,d,f){var g=-b[0],h=-b[3],e=-b[6],j=b[9],i=-b[1],l=-b[4],m=-b[7],k=b[10],p=-b[2],s=-b[5],t=-b[8],b=b[11],u=Number.MAX_VALUE,z=-u,w=u,y=-u,v=u,x=-u,A,C,E,H,F,I,K,G;for(A=0;A<f;)if(C=d[A],E=C[0],H=C[1],F=C[2],I=C[3],K=C[4],C=C[5],G=p*(0<p?I:E)+s*(0<s?K:H)+t*(0<t?C:F),G>b){G-=b;z<G&&(z=G);if(0<u){G=p*(0<p?E:I)+s*(0<s?H:
K)+t*(0<t?F:C)-b;if(G<u&&(u=G,0>=u))continue;G=g*(0<g?E:I)+h*(0<h?H:K)+e*(0<e?F:C)-j;G<w&&(w=G);G=g*(0<g?I:E)+h*(0<h?K:H)+e*(0<e?C:F)-j;y<G&&(y=G);G=i*(0<i?E:I)+l*(0<l?H:K)+m*(0<m?F:C)-k;G<v&&(v=G);G=i*(0<i?I:E)+l*(0<l?K:H)+m*(0<m?C:F)-k;x<G&&(x=G)}A+=1}else if(f-=1,A<f)c[A]=c[f],d[A]=d[f];else break;0>u&&(u=0);z>a.lightDepth&&(z=a.lightDepth);a.minLightDistance=u;a.maxLightDistance=z;a.minLightDistanceX=w;a.maxLightDistanceX=y;a.minLightDistanceY=v;a.maxLightDistanceY=x;return f};jb.prototype.blurShadowMaps=
function(){var a=this.gd,b,c,d,f,g,h;a.setStream(this.quadVertexBuffer,this.quadSemantics);var e=this.blurTechnique;a.setTechnique(e);var j=this.quadPrimitive,i=this.pixelOffsetH,l=this.pixelOffsetV;if(b=this.highIndex){d=this.shadowMapsHigh;g=this.blurTextureHigh;h=this.blurRenderTargetHigh;l[1]=i[0]=1/this.sizeHigh;for(c=0;c<b;c+=1)if(f=d[c],f.needsBlur){if(!a.beginRenderTarget(h))break;e.shadowMap=f.texture;e.pixelOffset=i;a.draw(j,4);a.endRenderTarget();if(!a.beginRenderTarget(f.renderTarget))break;
e.shadowMap=g;e.pixelOffset=l;a.draw(j,4);a.endRenderTarget()}}if(b=this.lowIndex){d=this.shadowMapsLow;g=this.blurTextureLow;h=this.blurRenderTargetLow;l[1]=i[0]=1/this.sizeLow;for(c=0;c<b;c+=1)if(f=d[c],f.needsBlur){if(!a.beginRenderTarget(h))break;e.shadowMap=f.texture;e.pixelOffset=i;a.draw(j,4);a.endRenderTarget();if(!a.beginRenderTarget(f.renderTarget))break;e.shadowMap=g;e.pixelOffset=l;a.draw(j,4);a.endRenderTarget()}}};jb.prototype.lookAt=function(a,b,c,d){var f=this.md,b=f.v3Sub(d,b,this.tempV3AxisZ);
f.v3Normalize(b,b);c=f.v3Cross(f.v3Normalize(c,c),b,this.tempV3AxisX);f.v3Normalize(c,c);var g=f.v3Cross(b,c,this.tempV3AxisY);a.matrix=f.m43Build(c,g,b,d,a.matrix)};jb.prototype.destroy=function(){delete this.shader;delete this.rigidTechnique;delete this.skinnedTechnique;delete this.blurTechnique;this.destroyBuffers();delete this.tempV3AxisZ;delete this.tempV3AxisY;delete this.tempV3AxisX;delete this.tempV3Pos;delete this.tempV3At;delete this.tempV3Up;delete this.tempMatrix43;delete this.clearColor;
delete this.quadPrimitive;delete this.quadSemantics;this.quadVertexBuffer&&(this.quadVertexBuffer.destroy(),delete this.quadVertexBuffer);delete this.shadowMapsLow;delete this.shadowMapsHigh;delete this.techniqueParameters;delete this.occludersExtents;delete this.md;delete this.gd};jb.create=function(a,b,c,d,f,g){d=new jb;c.load("shaders/shadowmapping.cgfx");d.gd=a;d.md=b;d.clearColor=b.v4Build(1,1,1,1);d.tempMatrix43=b.m43BuildIdentity();d.tempV3Up=b.v3BuildZero();d.tempV3At=b.v3BuildZero();d.tempV3Pos=
b.v3BuildZero();d.tempV3AxisX=b.v3BuildZero();d.tempV3AxisY=b.v3BuildZero();d.tempV3AxisZ=b.v3BuildZero();d.quadPrimitive=a.PRIMITIVE_TRIANGLE_STRIP;d.quadSemantics=a.createSemantics(["POSITION","TEXCOORD0"]);d.quadVertexBuffer=a.createVertexBuffer({numVertices:4,attributes:["FLOAT2","FLOAT2"],dynamic:!1,data:[-1,1,0,1,1,1,1,1,-1,-1,0,0,1,-1,1,0]});d.pixelOffsetH=[0,0];d.pixelOffsetV=[0,0];d.bufferWidth=0;d.bufferHeight=0;d.techniqueParameters=a.createTechniqueParameters();d.shader=null;d.shadowMapsLow=
[];d.shadowMapsHigh=[];f=f||d.defaultSizeLow;g=g||d.defaultSizeHigh;d.updateBuffers(f,g);d.occludersExtents=[];if((a=a.maxSupported("FRAGMENT_SHADER_PRECISION"))&&16>a)d.blurEnabled=!1;return d};jb.version=1;Ci=jb;var qk={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",
chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",
deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",
lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",
mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",
pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",
white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},Ni=function(a,b){var c=parseInt,d,a=a.replace(/ /g,"").toLowerCase(),a=qk[a]||a;if("#"===a[0]){var a=a.substr(1,6),f=a.length;if(6===f){if(d=/^(\w{2})(\w{2})(\w{2})$/.exec(a))return b[0]=c(d[1],16)/255,b[1]=c(d[2],16)/255,b[2]=c(d[3],16)/255,b[3]=1,b}else if(3===f&&(d=/^(\w{1})(\w{1})(\w{1})$/.exec(a)))return b[0]=c(d[1],16)/15,b[1]=c(d[2],16)/15,b[2]=c(d[3],16)/15,b[3]=1,b}else if(f=a.substr(0,4),"rgba"===f){if(d=/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d*\.?\d+)\)$/.exec(a))return b[0]=
c(d[1],10)/255,b[1]=c(d[2],10)/255,b[2]=c(d[3],10)/255,b[3]=parseFloat(d[4]),b}else if("rgb("===f){if(d=/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/.exec(a))return b[0]=c(d[1],10)/255,b[1]=c(d[2],10)/255,b[2]=c(d[3],10)/255,b[3]=1,b}else if("hsla"===f?(d=/^hsla\((\d{1,3}),\s*(\d{1,3})\%,\s*(\d{1,3})\%,\s*(\d*\.?\d+)\)$/.exec(a))&&(b[3]=parseFloat(d[4])):"hsl("===f&&(d=/^hsl\((\d{1,3}),\s*(\d{1,3})\%,\s*(\d{1,3})\%\)$/.exec(a))&&(b[3]=1),d){var f=c(d[1],10)/360,g=c(d[2],10)/100;d=c(d[3],10)/100;
0===g?(b[0]=d,b[1]=d,b[2]=d):(c=0.5>d?d*(g+1):d+g-d*g,d=2*d-c,g=function(a,b,c){0>c?c+=1:1<c&&(c-=1);return 1>6*c?a+(b-a)*6*c:1>2*c?b:2>3*c?a+6*(b-a)*(2/3-c):a},b[0]=g(d,c,f+1/3),b[1]=g(d,c,f),b[2]=g(d,c,f-1/3));return b}},Jd=function(){};Jd.prototype.addColorStop=function(a,b){function c(a,b){return a[0]-b[0]}if(0>a||1<a)throw"INDEX_SIZE_ERR";var d=this.stops,f=d.length,g=Ni(b,Array(4));1>g[3]&&(this.opaque=!1);g[0]*=255;g[1]*=255;g[2]*=255;g[3]*=255;d[f]=[a,g];1<f+1&&d.sort(c)};Jd.prototype.updateTexture=
function(a){var b=this.texture,c=this.stops,d=c.length;if(this.numTextureStops!==d){this.numTextureStops=d;var f=this.width,g=this.height;b||(this.texture=b=a.createTexture({name:"linear:"+f+"x"+g,width:f,height:g,depth:1,format:a.PIXELFORMAT_R8G8B8A8,cubemap:!1,mipmaps:!1}));for(var a=this.opaque,h=this.x1-this.x0,e=this.y1-this.y0,j=h*h+e*e,j=0===j?1:1/Math.sqrt(j),h=h*j,e=e*j,j=h/(1<f?f-1:1),i=e/(1<g?g-1:1),l=Array(4*f*g),m=0,k=0,p=0;p<g;p+=1,k+=i)for(var s=k*e,t=0,u=0;u<f;u+=1,m+=4,t+=j){var z=
t*h+s,w=c[0],y=w[0],w=w[1],v=y,x=w;if(z>y)for(var A=1;A<d;A+=1){w=c[A];y=w[0];w=w[1];if(z<=y)break;v=y;x=w}A=y-v;0>=A||z===y?(l[m]=w[0],l[m+1]=w[1],l[m+2]=w[2],l[m+3]=a?255:w[3]):(z=(z-v)/A,0.996>z?(y=1-z,l[m]=w[0]*z+x[0]*y,l[m+1]=w[1]*z+x[1]*y,l[m+2]=w[2]*z+x[2]*y,l[m+3]=a?255:w[3]*z+x[3]*y):(l[m]=w[0],l[m+1]=w[1],l[m+2]=w[2],l[m+3]=a?255:w[3]))}b.setData(l)}return b};Jd.create=function(a,b,c,d){var f=c-a,g=d-b,h=Math.abs(f),e=Math.abs(g);if(0===h&&0===e)return null;for(;16>h&&16>e;)h*=16,e*=16;
var h=1>h?1:Math.floor(h),e=1>e?1:Math.floor(e),j=new Jd;j.x0=a;j.y0=b;j.x1=c;j.y1=d;j.width=h;j.height=e;j.stops=[];c=1/f;g=1/g;j.matrix=[c,0,-a*c,0,g,-b*g];j.numTextureStops=0;j.texture=null;j.opaque=!0;return j};Jd.version=1;var Kd=function(){};Kd.prototype.addColorStop=function(a,b){function c(a,b){return a[0]-b[0]}if(0>a||1<a)throw"INDEX_SIZE_ERR";var d=this.stops,f=d.length,g=Ni(b,Array(4));1>g[3]&&(this.opaque=!1);g[0]*=255;g[1]*=255;g[2]*=255;g[3]*=255;d[f]=[a,g];1<f+1&&d.sort(c)};Kd.prototype.updateTexture=
function(a){var b=this.texture,c=this.stops,d=c.length;if(this.numTextureStops!==d){this.numTextureStops=d;var f=this.width;f<d&&(this.width=f=d);var g=this.height;g<d&&(this.height=g=d);if(!b||b.width!==f||b.height!==g)this.texture=b=a.createTexture({name:"radial:"+f+"x"+g,width:f,height:g,depth:1,format:a.PIXELFORMAT_R8G8B8A8,cubemap:!1,mipmaps:!1});for(var h=this.x0-this.minX,e=this.x1-this.minX-h,j=this.y0-this.minY,i=this.y1-this.minY-j,l=this.r0,m=this.r1-l,g=4*f*g,a=Array(g),k=Math.cos,p=Math.sin,
s=Math.abs,t=2*Math.PI,s=1/Math.max(s(e|0),s(i|0),s(m|0)),u,z,w,y,v=0;1>=v;v+=s){var x=c[0];u=x[0];x=x[1];z=u;y=x;if(v>u)for(w=1;w<d;w+=1){x=c[w];u=x[0];x=x[1];if(v<=u)break;z=u;y=x}w=u-z;if(0>=w||v===u)u=x[0],z=x[1],w=x[2],y=x[3];else{var A=(v-z)/w,C=1-A;u=x[0]*A+y[0]*C;z=x[1]*A+y[1]*C;w=x[2]*A+y[2]*C;y=x[3]*A+y[3]*C}for(var x=h+v*e,A=j+v*i,C=l+v*m,E,H,G,F,I=1;I<C;I+=1){H=1/I;for(E=0;E<t;E+=H)G=x+I*k(E)|0,F=A+I*p(E)|0,G=G+F*f<<2,void 0===a[G+3]&&(a[G]=u,a[G+1]=z,a[G+2]=w,a[G+3]=y)}H=1/C;for(E=0;E<
t;E+=H)G=x+C*k(E)|0,F=A+C*p(E)|0,G=G+F*f<<2,void 0===a[G+3]&&(a[G]=u,a[G+1]=z,a[G+2]=w,a[G+3]=y)}h=c[d-1][1];c=h[0];d=h[1];f=h[2];h=h[3];for(e=0;e<g;e+=4)void 0===a[e+3]&&(a[e]=c,a[e+1]=d,a[e+2]=f,a[e+3]=h);b.setData(a)}return b};Kd.create=function(a,b,c,d,f,g){if(0>c||0>g)throw"INDEX_SIZE_ERR";var h=new Kd;h.x0=a;h.y0=b;h.r0=c;h.x1=d;h.y1=f;h.r1=g;var e=Math.min(a-c,d-g)-1,d=Math.max(a+c,d+g)+1,a=Math.min(b-c,f-g)-1,b=Math.max(b+c,f+g)+1;h.minX=e;h.minY=a;h.stops=[];c=Math.ceil(d-e);b=Math.ceil(b-
a);if(!c||!b)return null;h.width=c;h.height=b;c=1/c;b=1/b;h.matrix=[c,0,-e*c,0,b,-a*b];h.numTextureStops=0;h.texture=null;h.opaque=!0;return h};Kd.version=1;var T=function(a,b,c,d){this.compositeOperations={"source-atop":1,"source-in":1,"source-out":1,"source-over":1,"destination-atop":1,"destination-in":1,"destination-out":1,"destination-over":1,lighter:1,copy:1,xor:1};this.capStyles={butt:1,round:1,square:1};this.joinStyles={bevel:1,round:1,miter:1};this.shaderDefinition={version:1,name:"canvas.cgfx",
samplers:{texture:{MinFilter:9985,MagFilter:9729,WrapS:33071,WrapT:33071},pattern:{MinFilter:9728,MagFilter:9729,WrapS:10497,WrapT:10497},gradient:{MinFilter:9728,MagFilter:9729,WrapS:33071,WrapT:33071},image:{MinFilter:9728,MagFilter:9729,WrapS:33071,WrapT:33071}},parameters:{screen:{type:"float",columns:4},uvtransform:{type:"float",rows:2,columns:3},color:{type:"float",columns:4},alpha:{type:"float"},texture:{type:"sampler2D"},pattern:{type:"sampler2D"},gradient:{type:"sampler2D"},image:{type:"sampler2D"}},
techniques:{flat_source_atop:[{parameters:["screen","color"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[772,771]},programs:["vp_flat","fp_flat"]}],flat_source_in:[{parameters:["screen","color"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[772,0]},programs:["vp_flat","fp_flat"]}],flat_source_out:[{parameters:["screen","color"],semantics:["POSITION"],states:{DepthTestEnable:!1,
DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[773,0]},programs:["vp_flat","fp_flat"]}],flat_source_over:[{parameters:["screen","color"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[1,771]},programs:["vp_flat","fp_flat"]}],flat_destination_atop:[{parameters:["screen","color"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[773,770]},programs:["vp_flat","fp_flat"]}],flat_destination_in:[{parameters:["screen",
"color"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[0,770]},programs:["vp_flat","fp_flat"]}],flat_destination_out:[{parameters:["screen","color"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[0,771]},programs:["vp_flat","fp_flat"]}],flat_destination_over:[{parameters:["screen","color"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,
BlendFunc:[773,1]},programs:["vp_flat","fp_flat"]}],flat_lighter:[{parameters:["screen","color"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[1,1]},programs:["vp_flat","fp_flat"]}],flat_copy:[{parameters:["screen","color"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!1},programs:["vp_flat","fp_flat"]}],flat_xor:[{parameters:["screen","color"],semantics:["POSITION"],states:{DepthTestEnable:!1,
DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[773,771]},programs:["vp_flat","fp_flat"]}],texture_source_atop:[{parameters:["screen","color","texture"],semantics:["POSITION","TEXCOORD0"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[772,771]},programs:["vp_texture","fp_texture"]}],texture_source_in:[{parameters:["screen","color","texture"],semantics:["POSITION","TEXCOORD0"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[772,
0]},programs:["vp_texture","fp_texture"]}],texture_source_out:[{parameters:["screen","color","texture"],semantics:["POSITION","TEXCOORD0"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[773,0]},programs:["vp_texture","fp_texture"]}],texture_source_over:[{parameters:["screen","color","texture"],semantics:["POSITION","TEXCOORD0"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[1,771]},programs:["vp_texture","fp_texture"]}],texture_destination_atop:[{parameters:["screen",
"color","texture"],semantics:["POSITION","TEXCOORD0"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[773,770]},programs:["vp_texture","fp_texture"]}],texture_destination_in:[{parameters:["screen","color","texture"],semantics:["POSITION","TEXCOORD0"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[0,770]},programs:["vp_texture","fp_texture"]}],texture_destination_out:[{parameters:["screen","color","texture"],semantics:["POSITION",
"TEXCOORD0"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[0,771]},programs:["vp_texture","fp_texture"]}],texture_destination_over:[{parameters:["screen","color","texture"],semantics:["POSITION","TEXCOORD0"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[773,1]},programs:["vp_texture","fp_texture"]}],texture_lighter:[{parameters:["screen","color","texture"],semantics:["POSITION","TEXCOORD0"],states:{DepthTestEnable:!1,DepthMask:!1,
CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[1,1]},programs:["vp_texture","fp_texture"]}],texture_copy:[{parameters:["screen","color","texture"],semantics:["POSITION","TEXCOORD0"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!1},programs:["vp_texture","fp_texture"]}],texture_xor:[{parameters:["screen","color","texture"],semantics:["POSITION","TEXCOORD0"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[773,771]},programs:["vp_texture","fp_texture"]}],
pattern_source_atop:[{parameters:["screen","uvtransform","alpha","pattern"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[772,771]},programs:["vp_texture_uvtransform","fp_pattern"]}],pattern_source_in:[{parameters:["screen","uvtransform","alpha","pattern"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[772,0]},programs:["vp_texture_uvtransform","fp_pattern"]}],pattern_source_out:[{parameters:["screen",
"uvtransform","alpha","pattern"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[773,0]},programs:["vp_texture_uvtransform","fp_pattern"]}],pattern_source_over:[{parameters:["screen","uvtransform","alpha","pattern"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[1,771]},programs:["vp_texture_uvtransform","fp_pattern"]}],pattern_destination_atop:[{parameters:["screen","uvtransform",
"alpha","pattern"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[773,770]},programs:["vp_texture_uvtransform","fp_pattern"]}],pattern_destination_in:[{parameters:["screen","uvtransform","alpha","pattern"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[0,770]},programs:["vp_texture_uvtransform","fp_pattern"]}],pattern_destination_out:[{parameters:["screen","uvtransform","alpha",
"pattern"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[0,771]},programs:["vp_texture_uvtransform","fp_pattern"]}],pattern_destination_over:[{parameters:["screen","uvtransform","alpha","pattern"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[773,1]},programs:["vp_texture_uvtransform","fp_pattern"]}],pattern_lighter:[{parameters:["screen","uvtransform","alpha","pattern"],semantics:["POSITION"],
states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[1,1]},programs:["vp_texture_uvtransform","fp_pattern"]}],pattern_copy:[{parameters:["screen","uvtransform","alpha","pattern"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!1},programs:["vp_texture_uvtransform","fp_pattern"]}],pattern_xor:[{parameters:["screen","uvtransform","alpha","pattern"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,
BlendEnable:!0,BlendFunc:[773,771]},programs:["vp_texture_uvtransform","fp_pattern"]}],gradient_source_atop:[{parameters:["screen","uvtransform","alpha","gradient"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[772,771]},programs:["vp_texture_uvtransform","fp_gradient"]}],gradient_source_in:[{parameters:["screen","uvtransform","alpha","gradient"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,
BlendFunc:[772,0]},programs:["vp_texture_uvtransform","fp_gradient"]}],gradient_source_out:[{parameters:["screen","uvtransform","alpha","gradient"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[773,0]},programs:["vp_texture_uvtransform","fp_gradient"]}],gradient_source_over:[{parameters:["screen","uvtransform","alpha","gradient"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[1,
771]},programs:["vp_texture_uvtransform","fp_gradient"]}],gradient_destination_atop:[{parameters:["screen","uvtransform","alpha","gradient"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[773,770]},programs:["vp_texture_uvtransform","fp_gradient"]}],gradient_destination_in:[{parameters:["screen","uvtransform","alpha","gradient"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[0,770]},
programs:["vp_texture_uvtransform","fp_gradient"]}],gradient_destination_out:[{parameters:["screen","uvtransform","alpha","gradient"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[0,771]},programs:["vp_texture_uvtransform","fp_gradient"]}],gradient_destination_over:[{parameters:["screen","uvtransform","alpha","gradient"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[773,1]},programs:["vp_texture_uvtransform",
"fp_gradient"]}],gradient_lighter:[{parameters:["screen","uvtransform","alpha","gradient"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[1,1]},programs:["vp_texture_uvtransform","fp_gradient"]}],gradient_copy:[{parameters:["screen","uvtransform","alpha","gradient"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!1},programs:["vp_texture_uvtransform","fp_gradient"]}],gradient_xor:[{parameters:["screen",
"uvtransform","alpha","gradient"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[773,771]},programs:["vp_texture_uvtransform","fp_gradient"]}],texture_shadow:[{parameters:["screen","color","texture"],semantics:["POSITION","TEXCOORD0"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[1,771]},programs:["vp_texture","fp_texture_shadow"]}],pattern_shadow:[{parameters:["screen","uvtransform","color","pattern"],
semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[1,771]},programs:["vp_texture_uvtransform","fp_pattern_shadow"]}],gradient_shadow:[{parameters:["screen","uvtransform","color","gradient"],semantics:["POSITION"],states:{DepthTestEnable:!1,DepthMask:!1,CullFaceEnable:!1,BlendEnable:!0,BlendFunc:[1,771]},programs:["vp_texture_uvtransform","fp_gradient_shadow"]}],image:[{parameters:["image"],semantics:["POSITION","TEXCOORD0"],states:{DepthTestEnable:!1,
DepthMask:!1,CullFaceEnable:!1,BlendEnable:!1},programs:["vp_image","fp_image"]}]},programs:{fp_image:{type:"fragment",code:"#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];\nuniform sampler2D image;void main()\n{gl_FragColor=texture2D(image,tz_TexCoord[0].xy);}"},vp_image:{type:"vertex",code:"#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];attribute vec4 ATTR0;attribute vec4 ATTR8;\nvoid main()\n{vec4 tmpvar_1;tmpvar_1.zw=vec2(0.0,1.0);tmpvar_1.x=ATTR0.x;tmpvar_1.y=ATTR0.y;tz_TexCoord[0].xy=ATTR8.xy;gl_Position=tmpvar_1;}"},
fp_gradient_shadow:{type:"fragment",code:"#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];\nuniform sampler2D gradient;uniform vec4 color;void main()\n{gl_FragColor=(color*texture2D(gradient,tz_TexCoord[0].xy).w);}"},vp_texture_uvtransform:{type:"vertex",code:"#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];attribute vec4 ATTR0;\nuniform vec3 uvtransform[2];uniform vec4 screen;void main()\n{vec2 tmpvar_1;vec2 tmpvar_2;tmpvar_2=((ATTR0.xy*screen.xy)+screen.zw);vec4 tmpvar_3;tmpvar_3.zw=vec2(0.0,1.0);tmpvar_3.x=tmpvar_2.x;tmpvar_3.y=tmpvar_2.y;vec3 tmpvar_4;tmpvar_4.z=1.0;tmpvar_4.x=ATTR0.x;tmpvar_4.y=ATTR0.y;tmpvar_1.x=dot(tmpvar_4,uvtransform[0]);tmpvar_1.y=dot(tmpvar_4,uvtransform[1]);tz_TexCoord[0].xy=tmpvar_1;gl_Position=tmpvar_3;}"},
fp_pattern_shadow:{type:"fragment",code:"#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];\nuniform sampler2D pattern;uniform vec4 color;void main()\n{gl_FragColor=(color*texture2D(pattern,tz_TexCoord[0].xy).w);}"},fp_texture_shadow:{type:"fragment",code:"#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];\nuniform sampler2D texture;uniform vec4 color;void main()\n{gl_FragColor=(color*texture2D(texture,tz_TexCoord[0].xy).w);}"},
vp_texture:{type:"vertex",code:"#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];attribute vec4 ATTR0;attribute vec4 ATTR8;\nuniform vec4 screen;void main()\n{vec2 tmpvar_1;tmpvar_1=((ATTR0.xy*screen.xy)+screen.zw);vec4 tmpvar_2;tmpvar_2.zw=vec2(0.0,1.0);tmpvar_2.x=tmpvar_1.x;tmpvar_2.y=tmpvar_1.y;tz_TexCoord[0].xy=ATTR8.xy;gl_Position=tmpvar_2;}"},fp_gradient:{type:"fragment",code:"#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];\nuniform sampler2D gradient;uniform float alpha;void main()\n{vec4 _fg;vec4 tmpvar_1;tmpvar_1=texture2D(gradient,tz_TexCoord[0].xy);_fg=tmpvar_1;_fg.w=(tmpvar_1.w*alpha);_fg.xyz=(tmpvar_1.xyz*_fg.w);gl_FragColor=_fg;}"},
fp_pattern:{type:"fragment",code:"#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];\nuniform sampler2D pattern;uniform float alpha;void main()\n{vec4 _fg;vec4 tmpvar_1;tmpvar_1=texture2D(pattern,tz_TexCoord[0].xy);_fg=tmpvar_1;_fg.w=(tmpvar_1.w*alpha);_fg.xyz=(tmpvar_1.xyz*_fg.w);gl_FragColor=_fg;}"},fp_texture:{type:"fragment",code:"#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];\nuniform sampler2D texture;uniform vec4 color;void main()\n{vec4 _fg;vec4 tmpvar_1;tmpvar_1=(texture2D(texture,tz_TexCoord[0].xy)*color);_fg=tmpvar_1;_fg.xyz=(tmpvar_1.xyz*tmpvar_1.w);gl_FragColor=_fg;}"},
fp_flat:{type:"fragment",code:"#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nuniform vec4 color;void main()\n{gl_FragColor=color;}"},vp_flat:{type:"vertex",code:"#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nattribute vec4 ATTR0;\nuniform vec4 screen;void main()\n{vec2 tmpvar_1;tmpvar_1=((ATTR0.xy*screen.xy)+screen.zw);vec4 tmpvar_2;tmpvar_2.zw=vec2(0.0,1.0);tmpvar_2.x=tmpvar_1.x;tmpvar_2.y=tmpvar_1.y;gl_Position=tmpvar_2;}"}}};
this.canvas=a;this.globalAlpha=1;this.globalCompositeOperation="source-over";this.fillStyle=this.strokeStyle="#000000";this.lineWidth=1;this.lineCap="butt";this.lineJoin="miter";this.miterLimit=10;this.shadowBlur=this.shadowOffsetY=this.shadowOffsetX=0;this.shadowColor="rgba(0,0,0,0)";this.font="10px sans-serif";this.textAlign="start";this.textBaseline="alphabetic";this.imageColor="#fff";this.gd=b;this.target=this.fm=null;this.viewport=[0,0,c,d];this.pixelRatio=1;this.width=c;this.height=d;a=this.floatArrayConstructor;
this.screen=new a(4);this.screen[0]=2/c;this.screen[1]=-2/d;this.screen[2]=-1;this.screen[3]=1;this.subPaths=[];this.needToSimplifyPath=[];this.currentSubPath=[];this.activeTechnique=this.activeVertexBuffer=null;this.activeScreen=new a(4);this.activeColor=new a(4);var f=b.createShader(this.shaderDefinition);this.shader=f;this.triangleStripPrimitive=b.PRIMITIVE_TRIANGLE_STRIP;this.triangleFanPrimitive=b.PRIMITIVE_TRIANGLE_FAN;this.trianglePrimitive=b.PRIMITIVE_TRIANGLES;this.lineStripPrimitive=b.PRIMITIVE_LINE_STRIP;
this.linePrimitive=b.PRIMITIVE_LINES;this.textureVertexFormats=[b.VERTEXFORMAT_FLOAT2,b.VERTEXFORMAT_FLOAT2];this.textureSemantics=b.createSemantics(["POSITION","TEXCOORD0"]);this.textureVertexBuffer=b.createVertexBuffer({numVertices:4,attributes:this.textureVertexFormats,dynamic:!0,"transient":!0});this.flatVertexFormats=[b.VERTEXFORMAT_FLOAT2];this.flatSemantics=b.createSemantics(["POSITION"]);this.flatVertexBuffer=b.createVertexBuffer({numVertices:256,attributes:this.flatVertexFormats,dynamic:!0,
"transient":!0});this.flatOffset=0;this.bufferData=new a(512);this.subBufferDataCache={};this.tempRect=new a(8);this.tempPoint=new a(2);this.tempVertices=[];this.tempStack=[];this.v4Zero=new a(4);this.v4Zero[0]=0;this.v4Zero[1]=0;this.v4Zero[2]=0;this.v4Zero[3]=0;this.v4One=new a(4);this.v4One[0]=1;this.v4One[1]=1;this.v4One[2]=1;this.v4One[3]=1;this.cachedColors={};this.numCachedColors=0;this.uvtransform=new a(6);this.uvtransform[0]=1;this.uvtransform[1]=0;this.uvtransform[2]=0;this.uvtransform[3]=
0;this.uvtransform[4]=1;this.uvtransform[5]=0;this.tempColor=new a(4);this.tempScreen=new a(4);this.tempImage=null;this.imageTechnique=f.getTechnique("image");var b=this.compositeOperations,g={},h={},e={},j={};this.flatTechniques=g;this.textureTechniques=h;this.patternTechniques=e;this.gradientTechniques=j;for(var i in b)if(b.hasOwnProperty(i)){var l=i.replace("-","_");g[i]=f.getTechnique("flat_"+l);h[i]=f.getTechnique("texture_"+l);e[i]=f.getTechnique("pattern_"+l);j[i]=f.getTechnique("gradient_"+
l)}this.textureShadowTechnique=f.getTechnique("texture_shadow");this.patternShadowTechnique=f.getTechnique("pattern_shadow");this.gradientShadowTechnique=f.getTechnique("gradient_shadow");this.matrix=new a(6);this.matrix[0]=1;this.matrix[1]=0;this.matrix[2]=0;this.matrix[3]=0;this.matrix[4]=1;this.matrix[5]=0;this.scale=this.scaleIdentity;this.translate=this.translateIdentity;this.setTransform=this.transform=this.setTransformIdentity;this.transformPoint=this.transformPointIdentity;this.transformRect=
this.transformRectIdentity;this.clipExtents=new a(4);this.clipExtents[0]=0;this.clipExtents[1]=0;this.clipExtents[2]=c;this.clipExtents[3]=d;this.statesStack=[this.createStatesObject()];this.numStatesInStack=0;this.defaultStates=this.createStatesObject();this.cachedTriangulation={};this.tempAngles=[];this.cachedPaths={};this.numCachedPaths=0};T.prototype.save=function(){var a=this.statesStack,b=this.numStatesInStack,c=a[b];c?this.setStates(c,this):a[b]=this.createStatesObject();this.numStatesInStack=
b+1};T.prototype.restore=function(){var a=this.numStatesInStack;0<a&&(this.numStatesInStack=a-=1,this.setStates(this,this.statesStack[a]))};T.prototype.scale=function(a,b){var c=this.matrix;c[0]*=a;c[1]*=b;c[3]*=a;c[4]*=b};T.prototype.rotate=function(a){if(a){var b=Math.sin(a),a=Math.cos(a);(-0.005>b||0.005<b||0.995>a||1.005<a)&&this.transform(a,b,-b,a,0,0)}};T.prototype.translate=function(a,b){var c=this.matrix;c[2]+=c[0]*a+c[1]*b;c[5]+=c[3]*a+c[4]*b};T.prototype.transform=function(a,b,c,d,f,g){var h=
this.matrix,e=h[0],j=h[1],i=h[2],l=h[3],m=h[4],k=h[5];h[0]=e*a+j*b;h[3]=l*a+m*b;h[1]=e*c+j*d;h[4]=l*c+m*d;h[2]=e*f+j*g+i;h[5]=l*f+m*g+k};T.prototype.setTransform=function(a,b,c,d,f,g){var h=this.matrix;h[0]=a;h[1]=c;h[2]=f;h[3]=b;h[4]=d;h[5]=g};T.prototype.createLinearGradient=function(a,b,c,d){return Jd.create(a,b,c,d)};T.prototype.createRadialGradient=function(a,b,c,d,f,g){return Kd.create(a,b,c,d,f,g)};T.prototype.createPattern=function(a){if(!a)throw"INVALID_STATE_ERR";return 0===a.width||0===
a.height?null:a};T.prototype.clearRect=function(a,b,c,d){if(0<c&&0<d){var f=this.gd,g=this.clipExtents,h=g[0],e=g[1],j=g[2],g=g[3],a=this.transformRect(a,b,c,d,this.tempRect);a[0]<=h&&a[1]>=g&&a[2]>=j&&a[3]>=g&&a[4]<=h&&a[5]<=e&&a[6]>=j&&a[7]<=e?f.clear(this.v4Zero):(this.fillFlatBuffer(a,4),this.setTechniqueWithColor(this.flatTechniques.copy,this.screen,this.v4Zero),f.draw(this.triangleStripPrimitive,4,this.flatOffset),this.flatOffset+=4)}};T.prototype.fillRect=function(a,b,c,d){0<c&&0<d&&(a=this.transformRect(a,
b,c,d,this.tempRect),this.fillFlatBuffer(a,4),a=this.triangleStripPrimitive,b=this.fillStyle,c=this.gd,this.setShadowStyle(b)&&c.draw(a,4,this.flatOffset),this.setStyle(b),c.draw(a,4,this.flatOffset),this.flatOffset+=4)};T.prototype.strokeRect=function(a,b,c,d){if(0<c||0<d){var c=this.transformRect(a,b,c,d,this.tempRect),a=this.strokeStyle,d=this.lineWidth,f;if(2>this.pixelRatio*d){if(b=this.lineStripPrimitive,d=5,f=this.getFlatBuffer(5))f[0]=c[4],f[1]=c[5],f[2]=c[6],f[3]=c[7],f[4]=c[2],f[5]=c[3],
f[6]=c[0],f[7]=c[1],f[8]=c[4],f[9]=c[5],this.fillFlatBuffer(f,5)}else b=[c[4],c[5]],c=[b,[c[6],c[7]],[c[2],c[3]],[c[0],c[1]],b],b=this.triangleStripPrimitive,d=this.fillFatStrip(c,5,d);c=this.gd;this.setShadowStyle(a)&&c.draw(b,d,this.flatOffset);this.setStyle(a);c.draw(b,d,this.flatOffset);this.flatOffset+=d}};T.prototype.beginPath=function(){this.subPaths.length=0;this.currentSubPath.length=0;this.needToSimplifyPath[0]=!0};T.prototype.closePath=function(){var a=this.currentSubPath,b=a.length;if(1<
b){var c=a[0];if(2<b){var d=a[b-1],f=Math.abs;if(1<=f(c[0]-d[0])||1<=f(c[1]-d[1]))a[b]=c;this.simplifyShape(a)}d=this.subPaths;b=d.length;d[b]=a;this.currentSubPath=[c];a=this.needToSimplifyPath;a[b]=!1;a[b+1]=!0}};T.prototype.moveTo=function(a,b){var c=this.currentSubPath,d=c.length;if(1<d){var f=this.subPaths,g=f.length;f[g]=c;this.currentSubPath=[this.transformPoint(a,b)];c=this.needToSimplifyPath;c[g]=2<d;c[g+1]=!0}else c[0]=this.transformPoint(a,b)};T.prototype.lineTo=function(a,b){var c=this.currentSubPath;
c[c.length]=this.transformPoint(a,b)};T.prototype.quadraticCurveTo=function(a,b,c,d){var f=this.currentSubPath,g=f.length;if(0===g)throw"Needs starting point!";var h=f[g-1],e=h[0],h=h[1],b=this.transformPoint(a,b),a=b[0],b=b[1],c=this.transformPoint(c,d),d=c[0],j=c[1],i=Math.abs,i=Math.ceil(this.pixelRatio*Math.sqrt(i(a-e)+i(b-h)+i(d-a)+i(j-b)));if(1<i){f.length+=i;for(var l=1/i,m=l;1<i;m+=l,i-=1){var k=1-m,p=k*k,s=m*m,k=2*m*k;f[g]=[p*e+k*a+s*d,p*h+k*b+s*j];g+=1}}f[g]=c};T.prototype.bezierCurveTo=
function(a,b,c,d,f,g){var h=this.currentSubPath,e=h.length;if(0===e)throw"Needs starting point!";var j=h[e-1],i=j[0],j=j[1],l,m;this.transformPoint===this.transformPointIdentity?(l=f,m=g,f=[f,g]):this.transformPoint===this.transformPointTranslate?(m=this.matrix,l=m[2],m=m[5],a+=l,b+=m,c+=l,d+=m,l=f+l,m=g+m,f=[l,m]):(b=this.transformPoint(a,b),a=b[0],b=b[1],d=this.transformPoint(c,d),c=d[0],d=d[1],f=this.transformPoint(f,g),l=f[0],m=f[1]);g=Math.abs;g=Math.ceil(this.pixelRatio*Math.sqrt(g(a-i)+g(b-
j)+g(c-a)+g(d-b)+g(l-c)+g(m-d)));if(1<g){h.length+=g;for(var k=1/g,p=k;1<g;p+=k,g-=1){var s=1-p,t=s*s,u=t*s,z=p*p,w=z*p,t=3*p*t,s=3*z*s;h[e]=[u*i+t*a+s*c+w*l,u*j+t*b+s*d+w*m];e+=1}}h[e]=f};T.prototype.arcTo=function(a,b,c,d,f){if(0>f)throw"INDEX_SIZE_ERR";var g,h,e=this.currentSubPath;g=e.length;0===g?(e[0]=this.transformPoint(a,b),g=a,h=b):(h=this.untransformPoint(e[g-1],this.tempPoint),g=h[0],h=h[1]);g-=a;h-=b;var j=g*g+h*h,c=c-a,i=d-b,l=c*c+i*i;if(2>f||2>j||2>l)e.push(this.transformPoint(a,b));
else{var m=Math.sqrt,d=Math.acos,e=Math.PI,j=1/m(j);g*=j;h*=j;var l=1/m(l),c=c*l,i=i*l,l=g+c,j=h+i,m=1/m(l*l+j*j),l=l*m,j=j*m,m=l*c+j*i,k=f/m,b=this.transformPoint(a+k*l,b+k*j),a=b[0],b=b[1];g=0<g*i-c*h;h=d(-l);0>j&&(h=-h);h=0.5*e-h;d=d(m);c=e+d+h;e=2*e-d+h;g?this.interpolateArc(a,b,f,e,c,!0):this.interpolateArc(a,b,f,c,e)}};T.prototype.arc=function(a,b,c,d,f,g){if(0>c)throw"INDEX_SIZE_ERR";a=this.transformPoint(a,b);2>c?this.currentSubPath.push(a):this.interpolateArc(a[0],a[1],c,d,f,g)};T.prototype.ellipse=
function(a,b,c,d,f,g,h,e){if(0>c||0>d)throw"INDEX_SIZE_ERR";if(2>c&&2>d)a=this.transformPoint(a,b),this.currentSubPath.push(a);else{var j,i;c===d?(j=c,c=i=1):c>d?(j=c,i=1,c=d/c):(j=d,i=c/d,c=1);0!==f||1!==i||1!==c?(this.translate(a,b),0!==f&&this.rotate(f),(1!==i||1!==c)&&this.scale(i,c),this.arc(0,0,j,g,h,e),(1!==i||1!==c)&&this.scale(1/i,1/c),0!==f&&this.rotate(-f),this.translate(-a,-b)):this.arc(a,b,j,g,h,e)}};T.prototype.rect=function(a,b,c,d){var f=this.subPaths,g=f.length,h=this.currentSubPath,
e=h.length,j=this.needToSimplifyPath;1<e&&(f[g]=h,j[g]=2<e,g+=1);a=this.transformRect(a,b,c,d,this.tempRect);b=[a[0],a[1]];h=[a[4],a[5]];f[g]=[h,[a[6],a[7]],[a[2],a[3]],b,h];this.currentSubPath=[b];j[g]=1>c||1>d;j[g+1]=!0};T.prototype._parsePath=function(a){for(var b=[],c=a.length,d=-1,f=-1,g=0,h=function(){for(var b=a.charCodeAt(g);32>=b||44===b;){g+=1;if(g>=c)return-1;b=a.charCodeAt(g)}return b},e=function(){for(var b=a.charCodeAt(g);32>=b||44===b;){g+=1;if(g>=c)throw"Reached end of string without required coordinate.";
b=a.charCodeAt(g)}var d=g;if(45===b||43===b){g+=1;if(g>=c)return 0;b=a.charCodeAt(g)}for(;48<=b&&57>=b;){g+=1;if(g>=c)break;b=a.charCodeAt(g)}if(46===b||101===b||101===b){if(46===b){do{g+=1;if(g>=c)break;b=a.charCodeAt(g)}while(48<=b&&57>=b)}if(101===b||101===b)if(g+=1,g<c){b=a.charCodeAt(g);if(45===b||43===b)g+=1,g<c&&(b=a.charCodeAt(g));for(;48<=b&&57>=b;){g+=1;if(g>=c)break;b=a.charCodeAt(g)}}return parseFloat(a.slice(d,g))}return parseInt(a.slice(d,g),10)},j=function(){var b=h();if(-1>b)throw"Reached end of string without required flag.";
if(48===b)return g+=1,!1;if(49===b)return g+=1,!0;throw"Unknown flag: "+a.slice(g);},i=-1,l=function(a,b,c){var d=a.length;0<i?(d=a[i],a[i]=0>d?d-1:-2,a.push(b,c)):(i=d,a.push(76,b,c))},m=function(a,b){var c=a[0],d=a[1],f=b[0],g=b[1];return(c*f+d*g)/Math.sqrt((c*c+d*d)*(f*f+g*g))},k=function(a,b){return(a[0]*b[1]<a[1]*b[0]?-1:1)*Math.acos(m(a,b))},p=Math.sqrt,s=Math.abs,t=Math.PI,u=0,z=0,w=0,y=0,v,x,A,C,E,H,G,F,I,L,N;g<c;){v=h();if(0>v)break;if(43===v||45===v||46===v||48<=v&&57>=v){if(0>d)throw"Coordinates without a command: "+
a.slice(g);77===d?d=76:109===d&&(d=108)}else f=d,d=v,g+=1;switch(d){case 77:case 109:v=e();x=e();109===d&&(v+=u,x+=z);w=v;y=x;b.push(77,v,x);i=-1;break;case 76:case 108:v=e();x=e();108===d&&(v+=u,x+=z);l(b,v,x);break;case 72:case 104:v=e();104===d&&(v+=u);x=z;l(b,v,x);break;case 86:case 118:v=u;x=e();118===d&&(x+=z);l(b,v,x);break;case 67:case 99:A=e();C=e();E=e();H=e();v=e();x=e();99===d&&(A+=u,C+=z,E+=u,H+=z,v+=u,x+=z);b.push(67,A,C,E,H,v,x);i=-1;break;case 83:case 115:67===f||99===f||83===f||115===
f?(A=2*u-E,C=2*z-H):(A=u,C=z);E=e();H=e();v=e();x=e();115===d&&(E+=u,H+=z,v+=u,x+=z);b.push(67,A,C,E,H,v,x);i=-1;break;case 81:case 113:A=e();C=e();v=e();x=e();113===d&&(A+=u,C+=z,v+=u,x+=z);b.push(81,A,C,v,x);i=-1;break;case 84:case 116:81===f||113===f||84===f||116===f?(A=2*u-A,C=2*z-C):(A=u,C=z);v=e();x=e();116===d&&(v+=u,x+=z);b.push(81,A,C,v,x);i=-1;break;case 65:case 97:A=u;C=z;G=e();F=e();I=e();I*=t/180;L=j();N=j();v=e();x=e();97===d&&(v+=u,x+=z);var O=Math.cos(I),M=Math.sin(I),u=0.5*(A-v),
z=0.5*(C-x),P=O*u+M*z,R=P*P,S=-M*u+O*z,U=S*S,u=R/(G*G)+U/(F*F);1<u&&(u=p(u),G*=u,F*=u);var T=G*G,u=1/G,W=F*F,z=1/F;L=(L===N?-1:1)*p((T*W-T*U-W*R)/(T*U+W*R));isNaN(L)&&(L=0);R=L*G*S*z;U=L*-F*P*u;L=0.5*(A+v)+O*R-M*U;O=0.5*(C+x)+M*R+O*U;M=[(P-R)*u,(S-U)*z];S=[(-P-R)*u,(-S-U)*z];P=k([1,0],M);R=m(M,S);M=-1>=R?t:1<=R?0:k(M,S);N?0>M&&(M+=2*t):0<M&&(M-=2*t);G===F?(S=G,F=G=1):G>F?(S=G,G=1,F*=u):(S=F,G*=z,F=1);b.push(65,I,G,F,L,O,S,P,P+M,!N);i=-1;break;case 90:case 122:3<=i&&77===b[i-3]&&(v=b[i-1],1>s(b[i-
2]-u)&&1>s(v-z)&&(b[i]+=1,b.length=0===b[i]?i:b.length-2));v=w;x=y;b.push(90);i=-1;break;default:throw"Unknown command: "+a.slice(g);}u=v;z=x}return b};T.prototype.addPoints=function(a,b,c){var d=this.currentSubPath,f=d.length,c=f+c;d.length=c;if(this.transformPoint===this.transformPointIdentity){do d[f]=[a[b],a[b+1]],b+=2,f+=1;while(f<c)}else if(this.transformPoint===this.transformPointTranslate){var g=this.matrix,h=g[2],g=g[5];do d[f]=[a[b]+h,a[b+1]+g],b+=2,f+=1;while(f<c)}else{do d[f]=this.transformPoint(a[b],
a[b+1]),b+=2,f+=1;while(f<c)}return b};T.prototype.path=function(a){var b=this.cachedPaths[a];void 0===b&&(1024<=this.numCachedPaths&&(this.cachedPaths={},this.numCachedPaths=0),b=this._parsePath(a),this.cachedPaths[a]=b,this.numCachedPaths+=1);for(var a=b.length,c=-1,d=0,f,g,h,e,j;d<a;)if(c=b[d],d+=1,0>c)d=this.addPoints(b,d,-c);else switch(c){case 77:c=b[d];d+=1;f=b[d];d+=1;this.moveTo(c,f);break;case 76:c=b[d];d+=1;f=b[d];d+=1;this.currentSubPath.push(this.transformPoint(c,f));break;case 67:g=
b[d];d+=1;h=b[d];d+=1;e=b[d];d+=1;j=b[d];d+=1;c=b[d];d+=1;f=b[d];d+=1;this.bezierCurveTo(g,h,e,j,c,f);break;case 81:g=b[d];d+=1;h=b[d];d+=1;c=b[d];d+=1;f=b[d];d+=1;this.quadraticCurveTo(g,h,c,f);break;case 65:c=b[d];d+=1;f=b[d];d+=1;g=b[d];d+=1;h=b[d];d+=1;e=b[d];d+=1;j=b[d];var d=d+1,i=b[d],d=d+1,l=b[d],d=d+1,m=b[d],d=d+1;0!==c||1!==f||1!==g?(this.translate(h,e),0!==c&&this.rotate(c),(1!==f||1!==g)&&this.scale(f,g),this.arc(0,0,j,i,l,m),(1!==f||1!==g)&&this.scale(1/f,1/g),0!==c&&this.rotate(-c),
this.translate(-h,-e)):this.arc(h,e,j,i,l,m);break;case 90:this.closePath()}};T.prototype.fill=function(){var a=this.subPaths,b=a.length,c=this.currentSubPath,d=this.needToSimplifyPath;if(0<b||2<c.length){var f=this.autoClose,g=this.canTriangulateAsFan,h=this.triangulateAsFan,e,j,i=this.fillStyle,l,m,k=0;if(1<b||1===b&&2<c.length){l=this.trianglePrimitive;m=this.tempVertices;for(var p=0;p<b;p+=1)e=a[p],j=e.length,2<j&&(j=f(e,j),j-=1,d[p]&&(d[p]=!1,j=this.simplifyShape(e)),1<j&&(k=g(e,j)?h(e,j,m,k):
this.triangulateConcaveCached(e,j,m,k)));e=c;j=e.length;2<j&&(j=f(e,j),j-=1,d[b]&&(d[b]=!1,j=this.simplifyShape(e)),1<j&&(k=g(e,j)?h(e,j,m,k):this.triangulateConcaveCached(e,j,m,k)))}else e=0<b?a[0]:c,j=e.length,2<j&&(j=f(e,j),j-=1,d[0]&&(d[0]=!1,j=this.simplifyShape(e)),1<j&&(g(e,j)?(l=this.triangleFanPrimitive,m=e,k=j):(l=this.trianglePrimitive,m=this.tempVertices,k=this.triangulateConcaveCached(e,j,m,0))));0<k&&(a=this.getFlatBuffer(k),this.fillFlatVertices(a,m,k),this.fillFlatBuffer(a,k),m=this.gd,
this.setShadowStyle(i)&&m.draw(l,k,this.flatOffset),this.setStyle(i),m.draw(l,k,this.flatOffset),this.flatOffset+=k)}};T.prototype.stroke=function(){var a=this.subPaths,b=a.length,c=this.currentSubPath,d=this.needToSimplifyPath;if(0<b||0<c.length){var f=this.gd,g=this.strokeStyle,e=this.lineWidth,n=2>this.pixelRatio*e,j,i,l,m;l=n?this.lineStripPrimitive:this.triangleStripPrimitive;for(var k=0;k<b;k+=1){j=a[k];i=j.length;d[k]&&(d[k]=!1,i=1+this.simplifyShape(j));if(n)m=this.getFlatBuffer(i),this.fillFlatVertices(m,
j,i),this.fillFlatBuffer(m,i);else if(1<i)i=this.fillFatStrip(j,i,e);else continue;this.setShadowStyle(g)&&f.draw(l,i,this.flatOffset);this.setStyle(g);f.draw(l,i,this.flatOffset);this.flatOffset+=i}j=c;i=j.length;if(0<i){d[b]&&(d[b]=!1,2<i&&(i=1+this.simplifyShape(j)));if(n)m=this.getFlatBuffer(i),this.fillFlatVertices(m,j,i),this.fillFlatBuffer(m,i);else if(1<i)i=this.fillFatStrip(j,i,e);else return;this.setShadowStyle(g)&&f.draw(l,i,this.flatOffset);this.setStyle(g);f.draw(l,i,this.flatOffset);
this.flatOffset+=i}}};T.prototype.drawSystemFocusRing=function(){};T.prototype.drawCustomFocusRing=function(){return!1};T.prototype.scrollPathIntoView=function(){};T.prototype.clip=function(){var a,b,c,d,f,g,e=0,n=[];b=this.subPaths;d=b.length;if(0<d){n.length=d;c=0;do a=b[c],2<a.length&&(n[e]=a.slice(),e+=1),c+=1;while(c<d)}a=this.currentSubPath;2<a.length&&(n[e]=a.slice(0),e+=1);if(0!==e){var j=this.autoClose,i,l,m,k;c=0;do{a=n[c];b=j(a,a.length);d=0;void 0===i&&(f=a[0],i=m=f[0],l=k=f[1],d=1);do f=
a[d],g=f[0],f=f[1],i>g?i=g:m<g&&(m=g),l>f?l=f:k<f&&(k=f),d+=1;while(d<b);c+=1}while(c<e);e=this.clipExtents;n=e[0];a=e[1];c=e[2];b=e[3];e[0]=n>i?n:i;e[1]=a>l?a:l;e[2]=c<m?c:m;e[3]=b<k?b:k;this.updateScissor()}};T.prototype.isPointInPath=function(a,b){var c=this.subPaths,d=c.length;if(0<d)for(var f=0;f<d;f+=1)if(this.isPointInSubPath(a,b,c[f]))return!0;return this.isPointInSubPath(a,b,this.currentSubPath)?!0:!1};T.prototype.fillText=function(a,b,c,d){if(!(void 0!==d&&0>=d)){var f=this.fm;if(f){var g=
this.buildFontName();if(g&&(f=f.load(g))){d||(d=this.width);var g=this.fillStyle,g="string"===typeof g?this.parseColor(g):this.v4One,e=this.globalAlpha;if(1>e){var n=this.tempColor;n[0]=g[0];n[1]=g[1];n[2]=g[2];n[3]=g[3]*e;g=n}e=this.textureTechniques[this.globalCompositeOperation];if(!e)throw"Unknown composite operation: "+this.globalCompositeOperation;this.setTechniqueWithColor(e,this.screen,g);g=this.calculateFontScale(f);if("alphabetic"===this.textBaseline)c-=f.baseline*g;else if("middle"===this.textBaseline)c-=
0.5*f.baseline*g;else if("bottom"===this.textBaseline||"ideographic"===this.textBaseline)c-=f.lineHeight*g;e="left"===this.textAlign||"start"===this.textAlign?0:"right"===this.textAlign||"end"===this.textAlign?2:1;if(this.transformRect===T.prototype.transformRect){if(b={rect:[b,c,d,d],scale:g,spacing:0,alignment:e},a=f.generateTextVertices(a,b)){b=a.length;for(c=0;c<b;c+=4)d=this.transformPoint(a[c],a[c+1]),a[c]=d[0],a[c+1]=d[1];f.drawTextVertices(a,!0)}}else d=this.transformRect(b,c,d,d,this.tempRect),
b=d[4],c=d[5],b={rect:[b,c,d[2]-b,d[3]-c],scale:g,spacing:0,alignment:e},f.drawTextRect(a,b);this.activeVertexBuffer=null}}}};T.prototype.strokeText=function(){};T.prototype.measureText=function(a){var b=this.fm;if(b){var c=this.buildFontName();if(c&&(b=b.load(c)))return c=this.calculateFontScale(b),{width:b.calculateTextDimensions(a,c,0).width}}return{width:0}};T.prototype.drawImage=function(a,b,c,d,f){var g,e,n,j,i,l,m,k;if(7<=arguments.length){m=arguments[1];k=arguments[2];var p=arguments[3],s=
arguments[4];g=arguments[5];e=arguments[6];9<=arguments.length?(n=arguments[7],j=arguments[8]):(n=p,j=s);var t=1/a.width,u=1/a.height;i=m*t;l=k*u;m=(m+p)*t;k=(k+s)*u}else g=arguments[1],e=arguments[2],5<=arguments.length?(n=arguments[3],j=arguments[4]):(n=a.width,j=a.height),l=i=0,k=m=1;if(0<n&&0<j&&(s=this.getTextureBuffer(4))){g=this.transformRect(g,e,n,j,this.tempRect);s[0]=g[0];s[1]=g[1];s[2]=i;s[3]=k;s[4]=g[2];s[5]=g[3];s[6]=m;s[7]=k;s[8]=g[4];s[9]=g[5];s[10]=i;s[11]=l;s[12]=g[6];s[13]=g[7];
s[14]=m;s[15]=l;this.fillTextureBuffer(s,4);i=this.triangleStripPrimitive;l=this.gd;this.setShadowStyle(a,!0)&&l.draw(i,4);g=this.textureTechniques[this.globalCompositeOperation];if(!g)throw"Unknown composite operation: "+this.globalCompositeOperation;e=this.parseColor(this.imageColor);n=this.globalAlpha;1>n&&(j=this.tempColor,j[0]=e[0],j[1]=e[1],j[2]=e[2],j[3]=e[3]*n,e=j);this.setTechniqueWithColor(g,this.screen,e);g.texture=a;l.draw(i,4)}};T.prototype.createImageData=function(){var a,b;if(2===arguments.length)a=
arguments[0],b=arguments[1];else if(1===arguments.length)b=arguments[0],a=b.width,b=b.height;else throw"Wrong arguments";for(var c=4*a*b,d=Array(c),f=0;f<c;f+=1)d[f]=0;return{width:a,height:b,data:d}};T.prototype.getImageData=function(a,b,c,d){var f=this.gd,b=this.height-(b+d),a=f.getScreenshot(!1,a,b,c,d);return{width:c,height:d,data:a}};T.prototype.putImageData=function(a,b,c){if(!a||!a.data)throw"TYPE_MISMATCH_ERR";var d=a.width,f=a.height,g,e,n,j;7<=arguments.length?(g=arguments[3],e=arguments[4],
n=arguments[5],j=arguments[6]):(e=g=0,n=d,j=f);if(n&&j){var i=this.gd,l=this.tempImage;if(null===l||l.width!==n||l.height!==j)this.tempImage=l=i.createTexture({name:"imageData:"+n+"x"+j,width:n,height:j,depth:1,format:i.PIXELFORMAT_R8G8B8A8,cubemap:!1,mipmaps:!1});l.setData(a.data);var m=this.viewport;i.setScissor(m[0],m[1],m[2],m[3]);if(m=this.getTextureBuffer(4)){var k=2/this.width,p=2/this.height,s=b*k-1,t=1-c*p,k=(b+n)*k-1,p=1-(c+j)*p,u=1/d,z=1/f,f=g*u,d=e*z;g=(g+n)*u;e=(e+j)*z;m[0]=s;m[1]=p;
m[2]=f;m[3]=e;m[4]=k;m[5]=p;m[6]=g;m[7]=e;m[8]=s;m[9]=t;m[10]=f;m[11]=d;m[12]=k;m[13]=t;m[14]=g;m[15]=d;this.fillTextureBuffer(m,4);e=this.imageTechnique;i.setTechnique(e);this.activeTechnique=null;e.image=l;i.draw(this.triangleStripPrimitive,4)}this.updateScissor()}};T.prototype.beginFrame=function(a,b){if(this.target)throw'"endFrame" was never called!';var c=this.gd;a||(a=c);this.target=a;c.setViewport(0,0,a.width,a.height);c=this.viewport;b?(c[0]=b[0],c[1]=b[1],c[2]=b[2],c[3]=b[3]):(c[0]=0,c[1]=
0,c[2]=a.width,c[3]=a.height);var d=this.canvas,f=d.width,d=d.height;this.updateScreenScale();this.updateScissor();this.pixelRatio=Math.max(c[2]/f,c[3]/d);this.activeTechnique=this.activeVertexBuffer=null;this.flatOffset=0;if(f!==this.width||d!==this.height)this.width=f,this.height=d,this.resetState(),this.clearRect(0,0,f,d);return!0};T.prototype.endFrame=function(){var a=this.target;if(!a)throw'"beginFrame" was never called!';this.target=null;this.gd.setScissor(0,0,a.width,a.height)};T.prototype.setWidth=
function(a){this.width=a;this.resetState();this.target&&(this.updateScreenScale(),this.clearRect(0,0,a,this.height))};T.prototype.setHeight=function(a){this.height=a;this.resetState();this.target&&(this.updateScreenScale(),this.clearRect(0,0,this.width,a))};T.prototype.createStatesObject=function(){var a={globalAlpha:this.globalAlpha,globalCompositeOperation:this.globalCompositeOperation,strokeStyle:this.strokeStyle,fillStyle:this.fillStyle,lineWidth:this.lineWidth,lineCap:this.lineCap,lineJoin:this.lineJoin,
miterLimit:this.miterLimit,shadowOffsetX:this.shadowOffsetX,shadowOffsetY:this.shadowOffsetY,shadowBlur:this.shadowBlur,shadowColor:this.shadowColor,font:this.font,textAlign:this.textAlign,textBaseline:this.textBaseline,imageColor:this.imageColor,matrix:new this.floatArrayConstructor(6),scale:this.scale,translate:this.translate,transform:this.transform,setTransform:this.setTransform,transformPoint:this.transformPoint,transformRect:this.transformRect,clipExtents:new this.floatArrayConstructor(4)},
b=a.matrix,c=this.matrix;b[0]=c[0];b[1]=c[1];b[2]=c[2];b[3]=c[3];b[4]=c[4];b[5]=c[5];b=a.clipExtents;c=this.clipExtents;b[0]=c[0];b[1]=c[1];b[2]=c[2];b[3]=c[3];return a};T.prototype.setStates=function(a,b){a.globalAlpha=b.globalAlpha;a.globalCompositeOperation=b.globalCompositeOperation;a.strokeStyle=b.strokeStyle;a.fillStyle=b.fillStyle;a.lineWidth=b.lineWidth;a.lineCap=b.lineCap;a.lineJoin=b.lineJoin;a.miterLimit=b.miterLimit;a.shadowOffsetX=b.shadowOffsetX;a.shadowOffsetY=b.shadowOffsetY;a.shadowBlur=
b.shadowBlur;a.shadowColor=b.shadowColor;a.font=b.font;a.textAlign=b.textAlign;a.textBaseline=b.textBaseline;a.imageColor=b.imageColor;var c=a.matrix,d=b.matrix;c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];c[4]=d[4];c[5]=d[5];a.scale=b.scale;a.translate=b.translate;a.transform=b.transform;a.setTransform=b.setTransform;a.transformPoint=b.transformPoint;a.transformRect=b.transformRect;c=a.clipExtents;d=b.clipExtents;c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];return a};T.prototype.resetState=function(){this.numStatesInStack=
0;this.beginPath();this.setStates(this,this.defaultStates);var a=this.clipExtents;a[0]=0;a[1]=0;a[2]=this.width;a[3]=this.height;this.target&&this.updateScissor()};T.prototype.updateScreenScale=function(){var a=this.screen,b=this.target,c=this.viewport,d=b.width,b=b.height;a[0]=2*c[2]/(this.width*d);a[1]=-2*c[3]/(this.height*b);a[2]=-1+2*c[0]/d;a[3]=1-2*(c[1]+c[3]-b)/b};T.prototype.updateScissor=function(){var a=this.viewport,b=a[3],c=a[2]/this.width,d=b/this.height,f=this.clipExtents,g=f[0]*c,e=
f[3]*d,n=a[0]+g,a=a[1]+(b-e),c=f[2]*c-g,d=e-f[1]*d;0>n&&(n=0);0>a&&(a=0);f=this.target;n+c>f.width&&(c=f.width-n);a+d>f.height&&(d=f.height-a);this.gd.setScissor(n,a,c,d)};T.prototype.setFontManager=function(a){this.fm=a};T.prototype.buildFontName=function(){var a,b=this.font,c=b.lastIndexOf(" ");-1!==c&&(a="fonts/"+b.substr(c+1)+".fnt");return a};T.prototype.calculateFontScale=function(a){var b=parseInt(this.font,10);return isNaN(b)?1:b/a.lineHeight};T.prototype.resetTransformMethods=function(){var a=
T.prototype;this.scale=a.scale;this.translate=a.translate;this.transform=a.transform;this.setTransform=a.setTransform;this.transformPoint=a.transformPoint;this.transformRect=a.transformRect};T.prototype.transformPoint=function(a,b){var c=this.matrix;return[a*c[0]+b*c[1]+c[2],a*c[3]+b*c[4]+c[5]]};T.prototype.transformRect=function(a,b,c,d,f){var g=this.matrix,e=g[0],n=g[1],j=g[3],i=g[4],l=a*e+b*n+g[2],a=a*j+b*i+g[5],e=c*e,n=d*n,c=c*j,d=d*i;f[0]=l+n;f[1]=a+d;f[2]=l+e+n;f[3]=a+c+d;f[4]=l;f[5]=a;f[6]=
l+e;f[7]=a+c;return f};T.prototype.transformPointTranslate=function(a,b){var c=this.matrix;return[a+c[2],b+c[5]]};T.prototype.transformRectTranslate=function(a,b,c,d,f){var g=this.matrix,a=a+g[2],b=b+g[5],c=a+c,d=b+d;f[0]=a;f[1]=d;f[2]=c;f[3]=d;f[4]=a;f[5]=b;f[6]=c;f[7]=b;return f};T.prototype.transformPointIdentity=function(a,b){return[a,b]};T.prototype.transformRectIdentity=function(a,b,c,d,f){c=a+c;d=b+d;f[0]=a;f[1]=d;f[2]=c;f[3]=d;f[4]=a;f[5]=b;f[6]=c;f[7]=b;return f};T.prototype.transformTranslate=
function(a,b,c,d,f,g){var e=this.matrix;e[0]=a;e[3]=b;e[1]=c;e[4]=d;e[2]=f+e[2];e[5]=g+e[5];this.resetTransformMethods()};T.prototype.scaleIdentity=function(a,b){if(0.999>a||1.001<a||0.999>b||1.001<b){var c=this.matrix;c[0]=a;c[4]=b;this.resetTransformMethods()}};T.prototype.translateIdentity=function(a,b){if(0!==a||0!==b){var c=this.matrix;c[2]=a;c[5]=b;this.translate=T.prototype.translate;this.transform=this.transformTranslate;this.transformPoint=this.transformPointTranslate;this.transformRect=
this.transformRectTranslate}};T.prototype.setTransformIdentity=function(a,b,c,d,f,g){var e=this.matrix;e[0]=a;e[1]=c;e[2]=f;e[3]=b;e[4]=d;e[5]=g;this.resetTransformMethods()};T.prototype.untransformPoint=function(a,b){if(this.transformPoint===this.transformPointIdentity)return a;var c=this.matrix,d=a[0],f=a[1];if(this.transformPoint===this.transformPointTranslate)return b[0]=d-c[2],b[1]=f-c[5],b;var g=c[0],e=c[1],n=c[2],j=c[3],i=c[4],l=c[5],m,k,p,s=g*i-e*j;if(0===s)return a;c=i;k=-j;m=-e;p=g;e=e*
l-i*n;g=n*j-g*l;1!==s&&(n=1/s,c*=n,k*=n,m*=n,p*=n,e*=n,g*=n);b[0]=d*c+f*m+e;b[1]=d*k+f*p+g;return b};T.prototype.calculateGradientUVtransform=function(a){var b=this.matrix,c=b[0],d=b[1],f=b[2],g=b[3],e=b[4],n=b[5],b=a[0],j=a[1],i=a[2],l=a[3],m=a[4],a=a[5],k,p,s,t,u=c*e-d*g;0===u?(k=1,p=s=0,t=1,c=d=0):(k=e,s=-g,p=-d,t=c,d=d*n-e*f,c=f*g-c*n,1!==u&&(f=1/u,k*=f,s*=f,p*=f,t*=f,d*=f,c*=f));f=this.uvtransform;f[0]=b*k+j*s;f[1]=b*p+j*t;f[2]=b*d+j*c+i;f[3]=l*k+m*s;f[4]=l*p+m*t;f[5]=l*d+m*c+a;return f};T.prototype.calculatePatternUVtransform=
function(a,b){var c=this.matrix,d=c[0],f=c[1],g=c[2],e=c[3],n=c[4],j=c[5],c=1/a,i=1/b,l,m,k,p,s=d*n-f*e;0===s?(l=1,m=k=0,p=1,d=f=0):(l=n,k=-e,m=-f,p=d,f=f*j-n*g,d=g*e-d*j,1!==s&&(g=1/s,l*=g,k*=g,m*=g,p*=g,f*=g,d*=g));g=this.uvtransform;g[0]=c*l;g[1]=c*m;g[2]=c*f;g[3]=i*k;g[4]=i*p;g[5]=i*d;return g};T.prototype.setShadowStyle=function(a,b){var c=this.shadowOffsetX,d=this.shadowOffsetY;if(1>c&&1>d||"source-over"!==this.globalCompositeOperation)return!1;var f=this.parseColor(this.shadowColor),g=f[3]*
this.globalAlpha;0<this.shadowBlur&&(g*=0.5);if(0.004>g)return!1;if(1>g){var e=this.tempColor;e[0]=f[0]*g;e[1]=f[1]*g;e[2]=f[2]*g;e[3]=g;f=e}var e=this.screen,n=e[0],j=e[1],i=this.tempScreen;i[0]=n;i[1]=j;i[2]=e[2]+c*n;i[3]=e[3]+d*j;e=i;if("string"!==typeof a&&!a.opaque)if(b)c=this.textureShadowTechnique,this.setTechniqueWithColor(c,e,f),c.texture=a;else if(a.stops){d=a.updateTexture(this.gd);c=d.height;if(!d.width||!c)throw"INVALID_STATE_ERR";c=this.gradientShadowTechnique;this.setTechniqueWithColor(c,
e,f);c.uvtransform=this.calculateGradientUVtransform(a.matrix);c.gradient=d}else{d=a.width;g=a.height;if(!d||!g)throw"INVALID_STATE_ERR";c=this.patternShadowTechnique;this.setTechniqueWithColor(c,e,f);c.uvtransform=this.calculatePatternUVtransform(d,g);c.pattern=a}else c=1>g?this.flatTechniques["source-over"]:this.flatTechniques.copy,this.setTechniqueWithColor(c,e,f);return!0};T.prototype.setStyle=function(a){if(!a)throw"INVALID_STATE_ERR";var b=this.globalCompositeOperation,c=this.screen,d;if("string"===
typeof a){a=this.parseColor(a);d=a[3]*this.globalAlpha;if(1>d){var f=this.tempColor;f[0]=a[0]*d;f[1]=a[1]*d;f[2]=a[2]*d;f[3]=d;a=f}if("source-over"!==b||1>d){if(d=this.flatTechniques[b],!d)throw"Unknown composite operation: "+b;}else d=this.flatTechniques.copy;this.setTechniqueWithColor(d,c,a)}else if(a.stops){f=a.updateTexture(this.gd);d=f.height;if(!f.width||!d)throw"INVALID_STATE_ERR";var g=this.globalAlpha;if("source-over"!==b||1>g||!a.opaque){if(d=this.gradientTechniques[b],!d)throw"Unknown composite operation: "+
b;}else d=this.gradientTechniques.copy;this.setTechniqueWithAlpha(d,c,g);d.uvtransform=this.calculateGradientUVtransform(a.matrix);d.gradient=f}else{f=a.width;g=a.height;if(!f||!g)throw"INVALID_STATE_ERR";d=this.patternTechniques[b];if(!d)throw"Unknown composite operation: "+b;this.setTechniqueWithAlpha(d,c,this.globalAlpha);d.uvtransform=this.calculatePatternUVtransform(f,g);d.pattern=a}};T.prototype.setStream=function(a,b){this.activeVertexBuffer!==a&&(this.activeVertexBuffer=a,this.gd.setStream(a,
b,0))};T.prototype.setTechniqueWithAlpha=function(a,b,c){var d=this.activeScreen,f=this.activeColor;if(this.activeTechnique!==a)this.activeTechnique=a,this.gd.setTechnique(a),a.screen=b,a.alpha=c,d[0]=b[0],d[1]=b[1],d[2]=b[2],d[3]=b[3],f[3]=c;else{if(d[0]!==b[0]||d[1]!==b[1]||d[2]!==b[2]||d[3]!==b[3])d[0]=b[0],d[1]=b[1],d[2]=b[2],d[3]=b[3],a.screen=b;f[3]!==c&&(f[3]=c,a.alpha=c)}};T.prototype.setTechniqueWithColor=function(a,b,c){var d=this.activeScreen,f=this.activeColor;if(this.activeTechnique!==
a)this.activeTechnique=a,this.gd.setTechnique(a),a.screen=b,a.color=c,d[0]=b[0],d[1]=b[1],d[2]=b[2],d[3]=b[3],f[0]=c[0],f[1]=c[1],f[2]=c[2],f[3]=c[3];else{if(d[0]!==b[0]||d[1]!==b[1]||d[2]!==b[2]||d[3]!==b[3])d[0]=b[0],d[1]=b[1],d[2]=b[2],d[3]=b[3],a.screen=b;if(f[0]!==c[0]||f[1]!==c[1]||f[2]!==c[2]||f[3]!==c[3])f[0]=c[0],f[1]=c[1],f[2]=c[2],f[3]=c[3],a.color=c}};T.prototype.parseColor=function(a){var b=this.cachedColors[a];if(void 0!==b)return b;1024<=this.numCachedColors&&(this.cachedColors={},
this.numCachedColors=0);if(b=Ni(a,new this.floatArrayConstructor(4)))return this.cachedColors[a]=b,this.numCachedColors+=1,b;throw"Unknown color: "+a;};T.prototype.interpolateArc=function(a,b,c,d,f,g){var e=Math.cos,n=Math.sin,j=2*Math.PI,i=this.currentSubPath,l=i.length,m=1/Math.sqrt(c*this.pixelRatio),k=this.matrix,p=k[0]*c,s=k[1]*c,t=k[3]*c,c=k[4]*c;if(g){for(;f>=d;)f-=j;if(d-f>=m)for(;d>f;d-=m)g=e(d),j=n(d),i[l]=[g*p+j*s+a,g*t+j*c+b],l+=1}else{for(;f<=d;)f+=j;if(f-d>=m)for(;d<f;d+=m)g=e(d),j=
n(d),i[l]=[g*p+j*s+a,g*t+j*c+b],l+=1}g=e(f);j=n(f);i[l]=[g*p+j*s+a,g*t+j*c+b]};T.prototype.getFlatBuffer=function(a){var b=this.bufferData,a=2*a;if(b.length<a)this.bufferData=b=new this.floatArrayConstructor(a),this.subBufferDataCache={};else if(a<b.length){var c=this.subBufferDataCache[a];void 0===c&&(c=b.subarray(0,a),this.subBufferDataCache[a]=c);b=c}return b};T.prototype.fillFlatBuffer=function(a,b){var c=this.flatVertexBuffer;c.numVertices<b?(c.destroy(),this.flatVertexBuffer=c=this.gd.createVertexBuffer({numVertices:b,
attributes:this.flatVertexFormats,dynamic:!0,"transient":!0}),this.flatOffset=0):this.flatOffset+b>c.numVertices&&(this.flatOffset=0);c.setData(a,this.flatOffset,b);this.setStream(c,this.flatSemantics)};T.prototype.getTextureBuffer=function(a){var b=this.bufferData,a=4*a;if(b.length<a)this.bufferData=b=new this.floatArrayConstructor(a),this.subBufferDataCache={};else if(a<b.length){var c=this.subBufferDataCache[a];void 0===c&&(c=b.subarray(0,a),this.subBufferDataCache[a]=c);b=c}return b};T.prototype.fillTextureBuffer=
function(a,b){var c=this.textureVertexBuffer;c.numVertices<b&&(c.destroy(),this.textureVertexBuffer=null,this.textureVertexBuffer=c=this.gd.createVertexBuffer({numVertices:b,attributes:this.textureVertexFormats,dynamic:!0,"transient":!0}));c.setData(a,0,b);this.setStream(c,this.textureSemantics)};T.prototype.fillFatStrip=function(a,b,c){var d=0,f=this.getFlatBuffer(2*b);if(f){var g,e,n,j,i,l,m,k,p,s,t,u,z,w,y,v=Math.sqrt;g=Math.abs;var x=0.5*c;e=a[0];n=e[0];j=e[1];i=a[b-1];var A=1>g(n-i[0])&&1>g(j-
i[1]);if(A){if(3>b)return 0;e=a[b-2];l=n-e[0];m=j-e[1]}else e=a[1],l=e[0]-n,m=e[1]-j;s=l*l+m*m;0<s&&(s=1/v(s),l*=s,m*=s);z=g=0;do{g+=1;if(g<b)e=a[g],i=e[0],e=e[1];else if(A)e=a[1],i=e[0],e=e[1];else{l*=x;m*=x;f[z+0]=n-m;f[z+1]=j+l;f[z+2]=n+m;f[z+3]=j-l;d+=2;break}k=i-n;p=e-j;s=k*k+p*p;1<=s&&(s=1/v(s),k*=s,p*=s,t=l+k,u=m+p,s=t*t+u*u,0.001<s?(w=c/s,y=x/v(s),m*k>l*p&&(s=w,w=y,y=s)):(t=-m,u=l,y=w=x),f[z+0]=n-u*w,f[z+1]=j+t*w,f[z+2]=n+u*y,f[z+3]=j-t*y,z+=4,d+=2,n=i,j=e,l=k,m=p)}while(g<b);this.fillFlatBuffer(f,
d)}return d};T.prototype.autoClose=function(a,b){var c=a[0],d=a[b-1];if(c===d)return b;var f=Math.abs;if(1>f(c[0]-d[0])&&1>f(c[1]-d[1]))return b;a[b]=c;return b+1};T.prototype.isClosed=function(a,b){if(a===b)return!0;var c=Math.abs;return 1>c(a[0]-b[0])&&1>c(a[1]-b[1])?!0:!1};T.prototype.canTriangulateAsFan=function(a,b){if(4>b)return!0;var c=0,d=a[0],f=a[1],g=d[0],d=d[1],e=f[0]-g,n=f[1]-d,f=2;do{var j=a[f],i=j[0]-g,j=j[1]-d,e=e*j-n*i;0>e?c|=1:0<e&&(c|=2);if(3===c)return!1;e=i;n=j;f+=1}while(f<b);
return 0!==c?!0:!1};T.prototype.simplifyShape=function(a){for(var b=Math.abs,c=0.5/this.pixelRatio,d=this.tempStack,f=0,g=0,e=a.length-1,n=a[e],j=n[0],i=n[1],l,m;;){var k=a[g];l=k[0];var p=k[1],s=j-l;m=i-p;var k=g+1,t=c,u=-1;if(b(s)<c)for(l=k;l<e;l+=1)m=b(a[l][0]-j),t<m&&(t=m,u=l);else if(b(m)<c)for(l=k;l<e;l+=1)m=b(a[l][1]-i),t<m&&(t=m,u=l);else{s=m/s;p-=s*l;t*=Math.sqrt(s*s+1);for(l=k;l<e;l+=1)m=a[l],m=b(s*m[0]-m[1]+p),t<m&&(t=m,u=l)}if(-1===u)if(e===a.length-1?(a[k]=n,a.length=k+1):a.splice(k,
e-k),0===f)break;else f-=2,g=d[f],e=d[f+1],n=a[e],j=n[0],i=n[1];else if(k<u)u+1<e?(d[f]=g,d[f+1]=u,f+=2,g=u):(e=u,n=a[e],j=n[0],i=n[1]);else if(u+1<e)g=u;else if(0===f)break;else f-=2,g=d[f],e=d[f+1],n=a[e],j=n[0],i=n[1]}return a.length-1};T.prototype.calculateArea=function(a,b){var c=0,d=a[b-2],f=a[b-1],g=0;do var e=a[g],c=c+f[0]*(e[1]-d[1]),d=f,f=e,g=g+1;while(g<b);return 0.5*c};T.prototype.triangulateAsFan=function(a,b,c,d){var f=a[0],g=a[1],e=2;do{var n=a[e];c[d]=f;c[d+1]=g;c[d+2]=n;d+=3;g=n;
e+=1}while(e<b);return d};T.prototype.getAngles=function(a,b,c){var d=a[0],f=a[1],g=d[0],d=d[1],e=f[0]-g,n=f[1]-d,j=e*e+n*n,f=2,i=Math.sqrt;do{var l=a[f],m=l[0]-g,l=l[1]-d,k=m*m+l*l,e=(e*l-n*m)/i(j*k);c[f-2]=100*e|0;e=m;n=l;j=k;f+=1}while(f<b);return f-2};T.prototype.lowerBound=function(a,b,c){for(var d=0,f=a.length>>>1,g,e,n,j,i,l;0<f;){g=f>>>1;e=d+g;n=(e<<1)+1;i=0;for(l=a[n];;){j=l[i]-b[i];if(0>j){d=e+1;f-=g+1;break}else if(0<j){f=g;break}i+=1;if(i>=c)return-n}}return d<<1};T.prototype.triangulateConcaveCached=
function(a,b,c,d){var f,g=this.tempAngles,e=this.getAngles(a,b,g);f=this.cachedTriangulation;var n=f[e];void 0===n?(f[e]=n=[],f=0):f=this.lowerBound(n,g,e);if(0>f)d=this.expandIndices(a,c,d,n[-f-1]);else{var j=this.calculateArea(a,b);if(0===j)return d;var i=b+1,l;for(l=0;l<i;l+=1)a[l][2]=l;var m=d,d=this.triangulateConcave(a,b,c,d,!1,j),a=d-m,b=256>i?new this.byteArrayConstructor(a):new this.shortArrayConstructor(a);for(l=0;l<a;l+=1)b[l]=c[m+l][2];1024<=n.length&&(f=n.length=0);c=g.slice(0,e);f<n.length?
n.splice(f,0,b,c):n.push(b,c)}return d};T.prototype.expandIndices=function(a,b,c,d){var f=d.length,g;for(g=0;g<f;g+=1,c+=1)b[c]=a[d[g]];return c};T.prototype.triangulateConcave=function(a,b,c,d,f,g){var e=this.canTriangulateAsFan;f?a.length=b:a=a.slice(0,b);var n,j,i,l,m,k,p,s,t,u,z,w,y,v,x,A,C,E,G,H,F,I,L,N,O,M,P,R,S;do{n=b-2;f=b-1;j=0;i=a[n];s=i[0];t=i[1];l=a[f];u=l[0];z=l[1];A=u-s;C=z-t;S=!1;do{k=!1;m=a[j];w=m[0];y=m[1];v=w-s;x=y-t;p=A*x-v*C;if(0<g*p){A=s<u?s:u;A=A<w?A:w;C=s>u?s:u;C=C>w?C:w;E=
t<z?t:z;E=E<y?E:y;G=t>z?t:z;G=G>y?G:y;0<p?(H=u-s,F=t-z,I=s*z-t*u,L=w-u,N=z-y,O=u*y-z*w,M=s-w,P=y-t,R=w*t-y*s):(H=s-u,F=z-t,I=t*u-s*z,L=u-w,N=y-z,O=z*w-u*y,M=w-s,P=t-y,R=y*s-w*t);var U=0.1;p=-1;k=0;do{var T=a[k],W=T[0];if(A<W&&W<C&&(T=T[1],E<T&&T<G)){var Y=P*W+M*T+R;U<Y&&(0.1<F*W+H*T+I&&0.1<N*W+L*T+O)&&(U=Y,p=k)}k+=1}while(k<b);if(0>p)c[d]=i,c[d+1]=l,c[d+2]=m,d+=3,k=!0;else if(p===(f+2)%b)f=j,j=p,i=l,s=u,t=z,l=m,m=a[j],w=m[0],y=m[1],v=w-s,x=y-t,c[d]=i,c[d+1]=l,c[d+2]=m,d+=3,k=!0;else if(f===(p+2)%
b)j=f,f=n,n=p,m=l,w=u,y=z,l=i,i=a[n],s=i[0],t=i[1],v=w-s,x=y-t,c[d]=i,c[d+1]=l,c[d+2]=m,d+=3,k=!0;else{f<p?(b=f,f=p):b=p;n=f-b+1;n<=a.length-n+2?(f=a.splice(b,n,a[b],a[f]),b=a):(b=a.splice(b,n,a[b],a[f]),f=a);a=f.length;3===a?(c[d]=f[0],c[d+1]=f[1],c[d+2]=f[2],d+=3):(f[a]=f[0],d=e(f,a)?this.triangulateAsFan(f,a,c,d):this.triangulateConcave(f,a,c,d,!0,g));f=b.length;if(3===f)return c[d]=b[0],c[d+1]=b[1],c[d+2]=b[2],d+=3;b[f]=b[0];a=b;b=f;a.length=b;S=!0;break}}else 0===p&&(k=!0);if(k){S=!0;a.splice(f,
1);b-=1;if(4>b)break;if(j<b){0===f?n=b-1:(n=f-1,f===b&&(f=0));j=f+1;l=m;u=w;z=y;A=v;C=x;continue}else break}n=f;f=j;j+=1;i=l;s=u;t=z;l=m;u=w;z=y;A=u-s;C=z-t}while(j<b)}while(S&&!e(a,b));if(!S)return d;i=a[0];s=i[0];t=i[1];l=a[1];u=l[0];z=l[1];A=u-s;C=z-t;k=2;do m=a[k],w=m[0],y=m[1],v=w-s,x=y-t,p=A*x-v*C,0<g*p&&(c[d]=i,c[d+1]=l,c[d+2]=m,d+=3),l=m,A=v,C=x,k+=1;while(k<b);return d};T.prototype.fillFlatVertices=function(a,b,c){var d=0,f=0;do{var g=b[d];a[f]=g[0];f+=1;a[f]=g[1];f+=1;d+=1}while(d<c)};T.prototype.isPointInPolygon=
function(a,b,c,d){var f,g,e,n,j,i;n=c[d-1];f=n[1]>=b;e=!1;for(i=0;i<d;i+=1)j=c[i],g=j[1]>=b,f!==g&&(j[1]-b)*(n[0]-j[0])>=(j[0]-a)*(n[1]-j[1])===g&&(e=!e),n=j,f=g;return e};T.prototype.isPointInSubPath=function(a,b,c){var d=c.length;return 2<d&&this.isClosed(c[0],c[d-1])?this.isPointInPolygon(a,b,c,d-1):!1};T.create=function(a,b,c,d){return new T(a,b,c,d)};T.version=1;var pc=function(){};pc.prototype.getContext=function(a){return"2d"===a.toLowerCase()?this.context:null};pc.prototype.toDataURL=function(){if(0===
this.width||0===this.height)return"data:,";var a=this.context.gd.getScreenshot(!0,0,0,this.width,this.height);return a?"data:image/jpeg;base64,"+a.toBase64():null};pc.prototype.toBlob=function(a){if(a){var b=this.context.gd.getScreenshot(!0,0,0,this.width,this.height);a(b)}};pc.prototype.setAttribute=function(a,b){"px"===b.substr(-2,2)&&(b=b.substr(0,b.lengh-2));b=parseInt(b,10);if("width"===a)this.width=b;else if("height"===a)this.height=b;else throw"UNSUPPORTED ATTRIBUTE!";};pc.prototype.setFontManager=
function(a){this.context.setFontManager(a)};pc.create=function(a){var b=a.width,c=a.height,d=new pc;d.context=T.create(d,a,b,c);Object.defineProperty?(Object.defineProperty(d,"width",{get:function(){return b},set:function(a){b=a;this.context.setWidth(a);this.clientWidth=a},enumerable:!0,configurable:!1}),Object.defineProperty(d,"height",{get:function(){return c},set:function(a){c=a;this.context.setHeight(a);this.clientHeight=a},enumerable:!0,configurable:!1})):(d.width=b,d.height=c);d.clientWidth=
b;d.clientHeight=c;return d};pc.version=1;T.prototype.floatArrayConstructor=Array;T.prototype.byteArrayConstructor=Array;T.prototype.shortArrayConstructor=Array;if("undefined"!==typeof Float32Array){var Fe=Object.prototype.toString.call(new Float32Array(4));"[object Float32Array]"===Fe&&(T.prototype.floatArrayConstructor=Float32Array)}"undefined"!==typeof Uint8Array&&(Fe=Object.prototype.toString.call(new Uint8Array(4)),"[object Uint8Array]"===Fe&&(T.prototype.byteArrayConstructor=Uint8Array));"undefined"!==
typeof Uint16Array&&(Fe=Object.prototype.toString.call(new Uint16Array(4)),"[object Uint16Array]"===Fe&&(T.prototype.shortArrayConstructor=Uint16Array));var ha=function(a){this.precision=1E-6;var b=[],c;for(c in a){var d=a[c];if("number"===typeof d||"string"===typeof d||0===c.indexOf("VERTEXFORMAT"))this[c]=d,0===c.indexOf("SEMANTIC_")&&b.length<=d&&(b[d]=c.slice(9))}this.gd=a;this.current=[];this.frames=[];this.commands=[];this.numCommands=0;this.lastId=-1;this.recycledIds=[];this.destroyedIds=[];
this.integerData={};this.floatData={};this.mixedData={};this.objects={};this.objectArray=[];this.names={};this.numNames=0;this.vertexBuffers={};this.indexBuffers={};this.techniqueParameterBuffers={};this.semantics={};this.semanticsMap={};this.formats={};this.formatsMap={};this.textures={};this.shaders={};this.techniques={};this.videos={};this.renderBuffers={};this.renderTargets={};this.occlusionQueries={};this.reverseSemantic=b;return this};ha.prototype._getCommandId=function(){var a=this.numCommands;
this.numCommands=a+1;return a};ha.prototype._getIntegerId=function(){if(this.recycledIds.length)return this.recycledIds.pop();var a=this.lastId+1;return this.lastId=a};ha.prototype._getStringId=function(){return this._getIntegerId().toString()};ha.prototype._addData=function(a,b,c){var d;d=a instanceof ArrayBuffer?this.mixedData:c?this.integerData:this.floatData;var f=d[b];if(void 0===f)d[b]=f=[],d=0;else if(d=a instanceof ArrayBuffer?this._lowerBoundGeneric(f,new Uint8Array(a,0,b),b,0):c?this._lowerBoundGeneric(f,
a,b,0):this._lowerBoundFloat(f,a,b),0>d)return f[-d-1].toString();if(a instanceof ArrayBuffer)a=new Uint8Array(a.slice(0,b));else if(c)if(a.BYTES_PER_ELEMENT)a=b<a.length?new a.constructor(a.subarray(0,b)):new a.constructor(a);else{var c=a[0],g=a[0],e;for(e=1;e<b;e+=1){var n=a[e];c>n?c=n:g<n&&(g=n)}c=0<=c&&255>=g?Uint8Array:-128<=c&&127>=g?Int8Array:0<=c&&65535>=g?Uint16Array:-32768<=c&&32767>=g?Int16Array:0<=c?Uint32Array:Int32Array;a=b<a.length?new c(a.slice(0,b)):new c(a)}else a=b<a.length?a.subarray?
new Float32Array(a.subarray(0,b)):new Float32Array(a.slice(0,b)):new Float32Array(a);b=this._getIntegerId();d<f.length?f.splice(d,0,b,a):f.push(b,a);return b.toString()};ha.prototype._addCommand=function(a,b,c,d,f,g,e,n,j){var i=arguments.length,l,m=this.commands[a];if(void 0===m)this.commands[a]=m=[],l=0;else if(0<m.length){if(1===i){this.current.push(m[0]);return}l=2===i?this._lowerBoundSimpleCommand(m,arguments):this._lowerBoundGeneric(m,arguments,i,1);if(0>l){this.current.push(m[-l-1]);return}}else l=
0;var k=Array(i),p;k[0]=a;for(p=1;p<i;p+=1)k[p]=arguments[p];i=this._getCommandId();l<m.length?m.splice(l,0,i,k):m.push(i,k);this.current.push(i)};ha.prototype._objectToArray=function(a){var b=this.objectArray;b.length=0;var c,d;for(c in a)a.hasOwnProperty(c)&&(d=a[c],void 0!==d&&null!==d&&b.push(this._addName(c),this._clone(d)));return b};ha.prototype._patchObjectArray=function(a){var b=a.length,c,d;for(c=0;c<b;c+=2)a[c]=this._addName(a[c]),d=a[c+1],void 0!==d&&null!==d&&(a[c+1]=this._clone(d));
return a};ha.prototype._sortObjectArray=function(a,b){var c,d,f,g;for(f=2;f<b;f+=2){c=a[f];d=a[f+1];for(g=f-2;-2<g&&a[g]>c;g-=2)a[g+2]=a[g],a[g+3]=a[g+1];a[g+2]=c;a[g+3]=d}};ha.prototype._addName=function(a){var b=this.names[a];void 0===b&&(b=this.numNames,this.numNames+=1,this.names[a]=b);return b};ha.prototype._addObject=function(a){var a=a instanceof Array?this._patchObjectArray(a):this._objectToArray(a),b=a.length;if(0===b)return null;2<b&&this._sortObjectArray(a,b);var c=this.objects[b];if(void 0===
c)this.objects[b]=c=[],b=0;else if(b=this._lowerBoundGeneric(c,a,b,0),0>b)return c[-b-1].toString();var d=this._getIntegerId();b<c.length?c.splice(b,0,d,a.slice()):c.push(d,a.slice());return d.toString()};ha.prototype._cloneObject=function(a,b){var c,d,f,g;if("string"===typeof a._id)return a._id;if(a.BYTES_PER_ELEMENT){c=a.length;if(b||0===c){f=Array(c);for(d=0;d<c;d+=1)f[d]=a[d];return f}return this._addData(a,c,!(a instanceof Float32Array||a instanceof Float64Array))}if(a instanceof Array){c=a.length;
if(!b&&0!==c){for(d=0;d<c&&"number"===typeof a[d];d+=1);if(d===c)return this._addData(a,c,!1)}f=Array(c);for(d=0;d<c;d+=1)g=a[d],void 0!==g&&"function"!==typeof g&&(f[d]=!g||"object"!==typeof g?g:this._cloneObject(g,b));return f}if(!(a instanceof ArrayBuffer)){if(a instanceof Date)return f=new Date(a.getTime());f={};for(c in a)a.hasOwnProperty(c)&&(g=a[c],void 0!==g&&"function"!==typeof g&&(f[c]=!g||"object"!==typeof g?g:this._cloneObject(g,b)));return f}};ha.prototype._clone=function(a){return!a||
"object"!==typeof a?a:this._cloneObject(a,!1)};ha.prototype._cloneVertexFormats=function(a){var b=this.gd,c=a.length,d=Array(c),f;for(f=0;f<c;f+=1){var g=a[f];"string"===typeof g?d[f]=g:g===b.VERTEXFORMAT_BYTE4?d[f]="BYTE4":g===b.VERTEXFORMAT_BYTE4N?d[f]="BYTE4N":g===b.VERTEXFORMAT_UBYTE4?d[f]="UBYTE4":g===b.VERTEXFORMAT_UBYTE4N?d[f]="UBYTE4N":g===b.VERTEXFORMAT_SHORT2?d[f]="SHORT2":g===b.VERTEXFORMAT_SHORT2N?d[f]="SHORT2N":g===b.VERTEXFORMAT_SHORT4?d[f]="SHORT4":g===b.VERTEXFORMAT_SHORT4N?d[f]="SHORT4N":
g===b.VERTEXFORMAT_USHORT2?d[f]="USHORT2":g===b.VERTEXFORMAT_USHORT2N?d[f]="USHORT2N":g===b.VERTEXFORMAT_USHORT4?d[f]="USHORT4":g===b.VERTEXFORMAT_USHORT4N?d[f]="USHORT4N":g===b.VERTEXFORMAT_FLOAT1?d[f]="FLOAT1":g===b.VERTEXFORMAT_FLOAT2?d[f]="FLOAT2":g===b.VERTEXFORMAT_FLOAT3?d[f]="FLOAT3":g===b.VERTEXFORMAT_FLOAT4&&(d[f]="FLOAT4")}a=d.join(",");b=this.formatsMap[a];void 0===b&&(b=this._getStringId(),this.formats[b]=d,this.formatsMap[a]=b);return b};ha.prototype._cloneSemantics=function(a){var b=
a.length,c=Array(b),d,f;for(d=0;d<b;d+=1)f=a[d],f="string"===typeof f?f:this.reverseSemantic[f],"TEXCOORD0"===f&&(f="TEXCOORD"),c[d]=f;return c};ha.prototype._checkProperties=function(a){var b={},c=this.objectArray;c.length=0;a.dirty=!1;var a=a.parameters,d;for(d in a)if(a.hasOwnProperty(d)){var f=a[d];if(f.dirty&&(f.dirty=0,(f=f.info)&&null!==location)){var g=f.values,f=void 0!==f.sampler?g:1===f.numValues?g[0]:g;b[d]=f;c.push(d,f)}}c=this._addObject(c);null!==c&&this._addCommand(0,c);this.gd.setTechniqueParameters(b)};
ha.prototype._lowerBoundGeneric=function(a,b,c,d){for(var f=0,g=a.length>>>1,e,n,j,i,l,m,k;0<g;){e=g>>>1;n=f+e;j=(n<<1)+1;l=a[j];for(i=d;;)if(m=l[i],k=b[i],m===k){if(i+=1,i>=c)return-j}else{m<k?(f=n+1,g-=e+1):g=e;break}}return f<<1};ha.prototype._lowerBoundSimpleCommand=function(a,b){for(var c=0,d=a.length>>>1,f,g,e,n,j;0<d;){f=d>>>1;g=c+f;e=(g<<1)+1;n=a[e][1];j=b[1];if(n===j)return-e;n<j?(c=g+1,d-=f+1):d=f}return c<<1};ha.prototype._lowerBoundFloat=function(a,b,c){for(var d=0,f=a.length>>>1,g,e,
n,j,i=this.precision,l=-i,m,k;0<f;){g=f>>>1;e=d+g;n=(e<<1)+1;m=0;for(k=a[n];;){j=k[m]-b[m];if(j<l){d=e+1;f-=g+1;break}else if(j>i){f=g;break}m+=1;if(m>=c)return-n}}return d<<1};ha.prototype._equalFloatArrays=function(a,b,c){var d=0,f=this.precision;do{if(Math.abs(a[d]-b[d])>=f)return!1;d+=1}while(d<c);return!0};ha.prototype._equalIntegerArrays=function(a,b,c){var d=0;do{if(a[d]!==b[d])return!1;d+=1}while(d<c);return!0};ha.prototype._setFilteredTechniqueParameters=function(a,b,c){var d=this.objectArray;
d.length=0;var f,g,e;for(f in a)void 0!==b[f]&&(g=a[f],e=c[f],e!==g&&(void 0!==g?void 0!==e&&(g instanceof Float32Array||g instanceof Array)&&void 0===g._id&&g.length<=e.length&&this._equalFloatArrays(g,e,g.length)||(c[f]=g,d.push(f,g)):delete a[f]));0<d.length&&(b=this._addObject(d),null!==b&&this._addCommand(0,b),this.gd.setTechniqueParameters(a))};ha.prototype.drawIndexed=function(a,b,c){this.gd.drawIndexed(a,b,c);this._addCommand(1,a,b,c||0)};ha.prototype.draw=function(a,b,c){this.gd.draw(a,b,
c);this._addCommand(2,a,b,c||0)};ha.prototype.setTechniqueParameters=function(a){for(var b=arguments.length,c=0;c<b;c+=1){var d=arguments[c];d&&(d=this._addObject(d),null!==d&&this._addCommand(0,d))}this.gd.setTechniqueParameters.apply(this.gd,arguments)};ha.prototype.setTechnique=function(a){if(1===a.passes.length){var b=a.passes[0];b.dirty&&this._checkProperties(b)}this.gd.setTechnique(a);a.device=null;b=a._id;if(void 0===b&&(b=this._getStringId(),a._id=b,this.techniques[b]={shader:a.shader._id,
name:a.name},1===a.passes.length)){var c=this;a.checkProperties=function(){var a=this.passes[0];a.dirty&&c._checkProperties(a)}}this._addCommand(5,b)};ha.prototype.setStream=function(a,b,c){void 0===c&&(c=0);this._addCommand(4,a._id,b._id,c);this.gd.setStream(a,b,c)};ha.prototype.setIndexBuffer=function(a){this._addCommand(3,a._id);this.gd.setIndexBuffer(a)};ha.prototype.drawArray=function(a,b,c){var d=a.length;if(!(0>=d)){1<d&&c&&(0<c?a.sort(function(a,b){return b.sortKey-a.sortKey}):a.sort(function(a,
b){return a.sortKey-b.sortKey}));for(var c=b.length,f=null,g=null,e=null,n=null,j=-1,i=null,l=0,m=!1,m=null,l=0,k=-1,p=this.current,s=this.gd,t=0;t<d;t+=1){var u=a[t],l=u.technique,m=u.endTechniqueParameters,k=u.endStreams,w=u.endInstances,B=u.indexBuffer,y=u.primitive,v=u.count,x=u.firstIndex;if(n!==l){n=l;this.setTechnique(l);g=1===l.passes.length?l.passes[0].parameters:l.shader.parameters;f={};for(l=0;l<c;l+=1)this._setFilteredTechniqueParameters(b[l],g,f)}for(l=48;l<m;l+=1)this._setFilteredTechniqueParameters(u[l],
g,f);m=j===k;for(l=0;m&&l<k;l+=3)m=i[l]===u[l]&&i[l+1]===u[l+1]&&i[l+2]===u[l+2];if(!m){j=k;i=u;for(l=0;l<k;l+=3)(m=u[l])&&this.setStream(m,u[l+1],u[l+2])}if(B)if(e!==B&&(e=B,this.setIndexBuffer(B)),l=56,l<w){k=-1;do this._setFilteredTechniqueParameters(u[l],g,f),-1===k?(this.drawIndexed(y,v,x),k=p[p.length-1]):(s.drawIndexed(y,v,x),p.push(k)),l+=1;while(l<w)}else this.drawIndexed(y,v,x);else if(l=56,l<w){k=-1;do this._setFilteredTechniqueParameters(u[l],g,f),-1===k?(this.draw(y,v,x),k=p[p.length-
1]):(s.draw(y,v,x),p.push(k)),l+=1;while(l<w)}else this.draw(y,v,x)}}};ha.prototype.beginDraw=function(a,b,c,d){var f=this.gd.beginDraw(a,b,c,d);if(f){var g=this,e=[],b=0,n=function(){for(var a=arguments.length,c=0;c<a;c+=1){var d=arguments[c];"number"===typeof d?e.push(d):e.push.apply(e,d)}b+=1;f.apply(this,arguments)};n.end=function(){0<b&&g._addCommand(11,a,b,g._cloneVertexFormats(c),d._id,g._addData(e,e.length,!1))};n.proxy=f;return n}return f};ha.prototype.endDraw=function(a){a.end();this.gd.endDraw(a.proxy)};
ha.prototype.setViewport=function(a,b,c,d){var f=this.gd;f.setViewport(a,b,c,d);c===f.width&&d===f.height&&(d=c=-1);this._addCommand(13,a,b,c,d)};ha.prototype.setScissor=function(a,b,c,d){var f=this.gd;f.setScissor(a,b,c,d);c===f.width&&d===f.height&&(d=c=-1);this._addCommand(12,a,b,c,d)};ha.prototype.clear=function(a,b,c){this._addCommand(9,this._clone(a),b,c);this.gd.clear(a,b,c)};ha.prototype.beginFrame=function(){this.width=this.gd.width;this.height=this.gd.height;return this.gd.beginFrame()};
ha.prototype.beginRenderTarget=function(a){this._addCommand(8,a._id);return this.gd.beginRenderTarget(a)};ha.prototype.endRenderTarget=function(){this._addCommand(10);this.gd.endRenderTarget()};ha.prototype.beginOcclusionQuery=function(a){this._addCommand(14,a._id);return this.gd.beginOcclusionQuery(a)};ha.prototype.endOcclusionQuery=function(a){this._addCommand(15,a._id);this.gd.endOcclusionQuery(a)};ha.prototype.endFrame=function(){this.frames.push(this.current);this.current=[];this.gd.endFrame();
this.fps=this.gd.fps};ha.prototype.createTechniqueParameters=function(a){return this.gd.createTechniqueParameters(a)};ha.prototype.createSemantics=function(a){var b=this.gd.createSemantics(a);if(b){var a=this._cloneSemantics(a),c=a.join(","),d=this.semanticsMap[c];void 0===d&&(d=this._getStringId(),this.semanticsMap[c]=d,this.semantics[d]=a);b._id=d}return b};ha.prototype.createVertexBuffer=function(a){var b=this.gd.createVertexBuffer(a);if(b){var c=this._getStringId();b._id=c;var d=this,f=b.setData;
b.setData=function(a,b,g){void 0===b&&(b=0);void 0===g&&(g=this.numVertices);var e;e=a instanceof ArrayBuffer?g*this.strideInBytes:g*this.stride;0===b&&g===this.numVertices?d._addCommand(7,c,d._addData(a,e,!1)):0<g&&d._addCommand(6,c,b,g,d._addData(a,e,!1));f.call(this,a,b,g)};var g=b.map;b.map=function(a,f){void 0===a&&(a=0);void 0===f&&(f=this.numVertices);var e=g.call(this,a,f);if(e){var h=[],f=0,j=function(){for(var a=arguments.length,b=0;b<a;b+=1){var c=arguments[b];"number"===typeof c?h.push(c):
h.push.apply(h,c)}f+=1;e.apply(this,arguments)};j.end=function(){0===a&&f===b.numVertices?d._addCommand(7,c,d._addData(h,h.length,!1)):0<f&&d._addCommand(6,c,a,f,d._addData(h,h.length,!1))};j.proxy=e;return j}return e};var e=b.unmap;b.unmap=function(a){a.end();e.call(this,a.proxy)};var n=b.destroy;b.destroy=function(){d.destroyedIds.push(parseInt(this._id,10));n.call(this)};var j=a.attributes;a.attributes=this._cloneVertexFormats(j);(!1===a.dynamic||a["transient"])&&delete a.dynamic;if(a.data){var i=
a.data;this._addCommand(7,c,this._addData(i,i.length,!1));delete a.data}this.vertexBuffers[c]=this._cloneObject(a,!0);a.attributes=j}return b};ha.prototype.createIndexBuffer=function(a){var b=this.gd.createIndexBuffer(a);if(b){var c=this._getStringId();b._id=c;var d=this,f=b.setData;b.setData=function(a,b,g){void 0===b&&(b=0);void 0===g&&(g=this.numIndices);0===b&&g===this.numIndices?d._addCommand(7,c,d._addData(a,g,!0)):0<g&&d._addCommand(6,c,b,g,d._addData(a,g,!0));f.call(this,a,b,g)};var g=b.map;
b.map=function(a,f){void 0===a&&(a=0);void 0===f&&(f=this.numIndices);var e=g.call(this,a,f);e&&(e.end=function(){var f=e.data,g=e.getNumWrittenIndices();0===a&&g===b.numIndices?d._addCommand(7,c,d._addData(f,g,!0)):0<g&&d._addCommand(6,c,a,g,d._addData(f,g,!0))});return e};var e=b.unmap;b.unmap=function(a){a.end();e.call(this,a)};var n=b.destroy;b.destroy=function(){d.destroyedIds.push(parseInt(this._id,10));n.call(this)};(!1===a.dynamic||a["transient"])&&delete a.dynamic;if(a.data){var j=a.data;
this._addCommand(7,c,this._addData(j,j.length,!0));delete a.data}a=this._cloneObject(a,!0);a.format===this.gd.INDEXFORMAT_USHORT?a.format="USHORT":a.format===this.gd.INDEXFORMAT_UINT?a.format="UINT":a.format===this.gd.INDEXFORMAT_UBYTE&&(a.format="UBYTE");this.indexBuffers[c]=a}return b};ha.prototype.createTexture=function(a){var b=this.gd.createTexture(a);if(b){var c=this._getStringId();b._id=c;var d=this,f=b.setData;b.setData=function(a){var b=d._addData(a,a.length,!(a instanceof Float32Array||
a instanceof Float64Array));1===arguments.length?(d._addCommand(7,c,b),f.call(this,a)):(d._addCommand(16,c,b,arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),f.apply(this,arguments))};if(a.data){var g=a.data;this._addCommand(7,c,this._addData(g,g.length,!(g instanceof Float32Array||g instanceof Float64Array)));delete a.data}!1===a.cubemap&&delete a.cubemap;!1===a.dynamic&&delete a.dynamic;!1===a.mipmaps&&delete a.mipmaps;a=this._cloneObject(a,!0);a.renderable&&(a.width===
this.gd.width&&a.height===this.gd.height)&&(a.width=-1,a.height=-1);this.textures[c]=a}return b};ha.prototype.createVideo=function(a){var b=this.gd.createVideo(a);if(b){var c=this._getStringId();b._id=c;this.videos[c]=this._cloneObject(a,!0)}return b};ha.prototype.createShader=function(a){var b=this._cloneObject(a,!0);if(a=this.gd.createShader(a)){var c=this._getStringId();a._id=c;this.shaders[c]=b}return a};ha.prototype.createTechniqueParameterBuffer=function(a){var b=new Float32Array(a.numFloats),
c=this._getStringId();b._id=c;if(b._id!==c)return this.gd.createTechniqueParameterBuffer(a);var d=this;b.setData=function(a,b,f){void 0===b&&(b=0);void 0===f&&(f=this.length);for(var e=0;e<f&&this[b]===a[e];)b+=1,e+=1;for(var i=b+f;e<f&&this[i-1]===a[f-1];)i-=1,f-=1;if(!(e>=f)){0<e&&(f-=e,a=a.subarray?a.subarray(e,e+f):a.slice(e,f));0===b&&f===this.length?d._addCommand(7,c,d._addData(a,f,!1)):d._addCommand(6,c,b,f,d._addData(a,f,!1));e=0;do this[b]=a[e],b+=1,e+=1;while(e<f)}};b.map=function(a,c){void 0===
a&&(a=0);void 0===c&&(c=this.length);var d=new Float32Array(c),f=0,e=function(){for(var a=arguments.length,b=0;b<a;b+=1){var c=arguments[b];if("number"===typeof c)d[f]=c,f+=1;else{var g=c.length,e;for(e=0;e<g;e+=1)d[f]=c[e],f+=1}}};e.end=function(){b.setData(d,a,f)};return e};b.unmap=function(a){a.end()};b.destroy=function(){d.destroyedIds.push(parseInt(this._id,10));this.length=0};!1===a.dynamic&&delete a.dynamic;if(a.data){var f=a.data;this._addCommand(7,c,this._addData(f,f.length,!1));delete a.data}this.techniqueParameterBuffers[c]=
this._cloneObject(a,!0);return b};ha.prototype.createRenderBuffer=function(a){var b=this.gd.createRenderBuffer(a);if(b){var c=this._getStringId();b._id=c;a=this._cloneObject(a,!0);a.width===this.gd.width&&a.height===this.gd.height&&(a.width=-1,a.height=-1);this.renderBuffers[c]=a}return b};ha.prototype.createRenderTarget=function(a){var b=this.gd.createRenderTarget(a);if(b){var c=this._getStringId();b._id=c;this.renderTargets[c]=this._cloneObject(a,!0)}return b};ha.prototype.createOcclusionQuery=
function(a){var b=this.gd.createOcclusionQuery(a);if(b){var c=this._getStringId();b._id=c;this.occlusionQueries[c]=this._cloneObject(a,!0)}return b};ha.prototype.createDrawParameters=function(a){return this.gd.createDrawParameters(a)};ha.prototype.isSupported=function(a){return this.gd.isSupported(a)};ha.prototype.maxSupported=function(a){return this.gd.maxSupported(a)};ha.prototype.loadTexturesArchive=function(a){var b=this._cloneObject(a,!0);b.archive={};this.textures[this._getStringId()]=b;var c=
this,d=a.ontextureload,f=a.onload;a.ontextureload=function(a){if(a){var f=c._getStringId();b.archive[a.name]=f;a._id=f;d(a)}};a.onload=function(b,c){a.ontextureload=d;if(a.onload=f)a.onload(b,c)};return this.gd.loadTexturesArchive(a)};ha.prototype.getScreenshot=function(a,b,c,d,f){return this.gd.getScreenshot(a,b,c,d,f)};ha.prototype.flush=function(){this.gd.flush()};ha.prototype.finish=function(){this.gd.finish()};ha.prototype.getFramesString=function(){var a;a='{"version":1,'+('"width":'+this.gd.width+
",");a+='"height":'+this.gd.height+",";a+='"names":[';var b=this.names,c=this.numNames,d=Array(c),f;for(f in b)b.hasOwnProperty(f)&&(d[b[f]]=f);for(b=0;b<c;b+=1)b&&(a+=","),a+='"'+d[b]+'"';a+='],"objects":[';var g=this.objects,e=!1,n,j,i,l;for(f in g)if(g.hasOwnProperty(f)){n=g[f];i=n.length;for(b=0;b<i;b+=2){d=n[b];j=n[b+1];c=j.length;e?a+=",":e=!0;a+=d+",[";for(l=0;l<c;l+=1){l&&(a+=",");var m=j[l];"string"===typeof m?a+='"'+m+'"':"number"===typeof m?(d=m|0,a=d===m?a+d:a+m.toFixed(4).replace(/\.?0+$/,
"")):a+=m}a+="]"}}d=this.commands;m=d.length;g=this.numCommands;e=Array(g);for(f=0;f<m;f+=1)if(n=d[f],void 0!==n){c=n.length;for(b=0;b<c;b+=2)e[n[b]]=n[b+1]}a+='],"commands":[';for(b=0;b<g;b+=1){b&&(a+=",");a+="[";f=e[b];c=f.length;for(n=0;n<c;n+=1)m=f[n],n&&(a+=","),"string"===typeof m?a+=m:"number"===typeof m?(d=m|0,a=d===m?a+d:a+m.toFixed(4).replace(/\.?0+$/,"")):a=void 0===m||null===m?a+"null":a+m;a+="]"}a+='],"frames":[';f=this.frames;c=f.length;for(b=0;b<c;b+=1)b&&(a+=","),a+="["+f[b].join(",")+
"]";return a+"]}"};ha.prototype._getDataBinSize=function(a,b){var c=0,d,f,g,e,n;for(d in a)if(a.hasOwnProperty(d)&&(f=a[d],g=f.length,0!==g)){c+=4;c+=4;for(e=0;e<g;e+=2)n=f[e+1],c+=4,b&&(c+=4),c+=n.byteLength+3&2147483644}return c+4};ha.prototype._getDataBinBuffer=function(a,b,c,d){var f,g,e,n,j;for(f in c)if(c.hasOwnProperty(f)&&(g=c[f],e=g.length,0!==e)){a[b]=e>>>1;b+=1;a[b]=parseInt(f,10);var b=b+1,i,l;for(n=0;n<e;n+=2)if(a[b]=g[n],b+=1,i=g[n+1],l=i.length,d&&(j=i instanceof Uint8Array?8:i instanceof
Int8Array?-8:i instanceof Uint16Array?16:i instanceof Int16Array?-16:i instanceof Uint32Array?32:-32,a[b]=j,b+=1),d){var m=new i.constructor(a.buffer,4*b,l);for(j=0;j<l;j+=1)m[j]=i[j];b+=i.byteLength+3>>>2}else{i=new Int32Array(i.buffer,0,i.length);for(j=0;j<l;j+=1)a[b]=i[j],b+=1}}a[b]=-1;return b+1};ha.prototype.getDataBuffer=function(){var a;a=8+this._getDataBinSize(this.integerData,!0);a+=this._getDataBinSize(this.floatData,!1);a+=this._getDataBinSize(this.mixedData,!0);var b=new ArrayBuffer(a);
a=new Uint8Array(b);a[0]=84;a[1]=90;a[2]=66;a[3]=68;b=new Int32Array(b);b[1]=1;var c;c=this._getDataBinBuffer(b,2,this.integerData,!0);c=this._getDataBinBuffer(b,c,this.floatData,!1);this._getDataBinBuffer(b,c,this.mixedData,!0);return a};ha.prototype.getResourcesString=function(){return JSON.stringify({version:1,resources:{vertexBuffers:this.vertexBuffers,indexBuffers:this.indexBuffers,techniqueParameterBuffers:this.techniqueParameterBuffers,semantics:this.semantics,formats:this.formats,textures:this.textures,
shaders:this.shaders,techniques:this.techniques,videos:this.videos,renderBuffers:this.renderBuffers,renderTargets:this.renderTargets}})};ha.prototype._recycleDataBinIds=function(a){var b=this.recycledIds,c,d,f,g;for(f in a)if(a.hasOwnProperty(f)){c=a[f];d=c.length;for(g=0;g<d;g+=2)b.push(c[g]);c.length=0}};ha.prototype.reset=function(){var a=this.frames,b=a.length,c;for(c=0;c<b;c+=1)a[c].length=0,a[c]=null;a.length=0;a=this.commands;b=a.length;for(c=0;c<b;c+=1)void 0!==a[c]&&(a[c].length=0);this.numCommands=
0;this._recycleDataBinIds(this.integerData);this._recycleDataBinIds(this.floatData);this._recycleDataBinIds(this.mixedData);this._recycleDataBinIds(this.objects);a=this.recycledIds;this.destroyedIds.length&&(a.push.apply(a,this.destroyedIds),this.destroyedIds.length=0);a.sort(function(a,b){return b-a});b=this.lastId;for(c=0;b===a[c];)c+=1,b-=1;c&&(this.lastId=b,c<a.length?a.splice(0,c):a.length=0);this.names={};this.numNames=0;this.vertexBuffers={};this.indexBuffers={};this.techniqueParameterBuffers=
{};this.semantics={};this.formats={};this.textures={};this.shaders={};this.techniques={};this.videos={};this.renderBuffers={};this.renderTargets={};this.occlusionQueries={}};ha.prototype.destroy=function(){this.gd.destroy();this.commands=this.frames=this.current=this.gd=null;this.numCommands=0;this.lastId=-1;this.names=this.objectArray=this.objects=this.mixedData=this.floatData=this.integerData=this.destroyedIds=this.recycledIds=null;this.numNames=0;this.reverseSemantic=this.occlusionQueries=this.renderTargets=
this.renderBuffers=this.videos=this.techniques=this.shaders=this.textures=this.semanticsMap=this.semantics=this.techniqueParameterBuffers=this.indexBuffers=this.vertexBuffers=null};ha.create=function(a){return new ha(a)};ha.version=1;"undefined"!==typeof debug&&(debug.evaluate=function(){},debug.info=function(a){window.console&&window.console.info(a)},debug.warn=function(a){window.console&&window.console.warn(a)},debug.warnAssert=function(a,b){a&&window.console&&window.console.warn(b)},debug.error=
function(){},debug.startProfile=function(a){ma.start(a)},debug.endProfile=function(a){ma.end(a)});var Ob,Oi;Ob={buildingMovementEnabled:!0,buildingUpgradesEnabled:!0,campaignsEnabled:!0,repairingEnabled:!0,wildlingHeroFollowingEnabled:!0};Oi={};Hj.prototype={set:function(a,b){this[0]=a;this[1]=b},getX:function(){return this[0]},getY:function(){return this[1]},setX:function(a){this[0]=a},setY:function(a){this[1]=a},copy:function(a){this.set(a[0],a[1])},getLength:function(){var a=this[0],b=this[1];
return Math.sqrt(a*a+b*b)},getLengthSq:function(){var a=this[0],b=this[1];return a*a+b*b},getDistance:function(a){var b=this[0]-a[0],a=this[1]-a[1];return Math.sqrt(b*b+a*a)},getDistanceSq:function(a){var b=this[0]-a[0],a=this[1]-a[1];return b*b+a*a},normalize:function(){var a=this[0],b=this[1],c=a*a+b*b;0<c?(c=1/Math.sqrt(c),this[0]=a*c,this[1]=b*c):(this[0]=0,this[1]=0);return this}};w.vec2New=function(){var a=Array(2);a.__proto__=Hj.prototype;return a};w.vec2BuildZero=function(a){void 0===a&&(a=
w.vec2New());a[0]=0;a[1]=0;return a};w.vec2BuildOne=function(a){void 0===a&&(a=w.vec2New());a[0]=1;a[1]=1;return a};w.vec2Build=function(a,b,c){void 0===c&&(c=w.vec2New());c[0]=a;c[1]=b;return c};w.vec2Copy=function(a,b){void 0===b&&(b=new H(2));b[0]=a[0];b[1]=a[1];return b};w.vec2Neg=function(a,b){void 0===b&&(b=w.vec2New());b[0]=-a[0];b[1]=-a[1];return b};w.vec2Add=function(a,b,c){void 0===c&&(c=w.vec2New());c[0]=a[0]+b[0];c[1]=a[1]+b[1];return c};w.vec2Sub=function(a,b,c){void 0===c&&(c=w.vec2New());
c[0]=a[0]-b[0];c[1]=a[1]-b[1];return c};w.vec2ScalarMul=function(a,b,c){void 0===c&&(c=w.vec2New());c[0]=a[0]*b;c[1]=a[1]*b;return c};w.vec2Equal=function(a,b,c){var d=Math.abs;void 0===c&&(c=this.precision);return d(a[0]-b[0])<=c&&d(a[1]-b[1])<=c&&d(a[2]-b[2])<=c};w.radiansToDegrees=180/Math.PI;w.degreesToRadians=Math.PI/180;w.scratchpad={};w.isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)};w.equal=function(a,b){return Math.abs(a-b)<=w.precision};w.v3UpperLimitLength=function(a,b,c){void 0===
c&&(c=new H(3));w.v3LengthSq(a)>b*b&&w.v3SetLength(a,b,c);return c};w.v3LowerLimitLength=function(a,b,c){void 0===c&&(c=new H(3));w.v3LengthSq(a)<b*b&&w.v3SetLength(a,b,c);return c};w.v3ClampLength=function(a,b,c,d){void 0===d&&(d=new H(3));w.v3LengthSq(a)<b*b&&w.v3SetLength(a,b,d);w.v3LengthSq(a)>c*c&&w.v3SetLength(a,c,d);return d};w.v3ClampDistance=function(a,b,c,d,f){void 0===f&&(f=new H(3));var g=this.scratchpad;g.v3aTob=w.v3Sub(b,a,g.v3aTob);w.v3ClampLength(g.v3aTob,c,d,g.v3aTob);return w.v3Add(a,
g.v3aTob,f)};w.v3SetLength=function(a,b,c){void 0===c&&(c=new H(3));w.v3ScalarMul(a,b/w.v3Length(a),c);return c};w.getRayPlaneIntersection=function(a,b,c,d){d=w.v3Copy(d);w.v3Normalize(d,d);a=w.v3Sub(c,a);a=w.v3Dot(a,b);b=w.v3Dot(d,b);return w.v3Sub(c,w.v3ScalarMul(d,a/b))};w.getRayPlanePositiveIntersection=function(a,b,c,d){d=w.v3Copy(d);w.v3Normalize(d,d);a=w.v3Sub(c,a);a=w.v3Dot(a,b);b=w.v3Dot(d,b);return 0<b?void 0:w.v3Sub(c,w.v3ScalarMul(d,a/b))};w.v3BuildRandom=function(a,b){void 0===b&&(b=
new H(3));b[0]=2*(Math.random()-0.5)*a;b[1]=2*(Math.random()-0.5)*a;b[2]=2*(Math.random()-0.5)*a;return b};w.v3BuildRandomCircle=function(a,b){void 0===b&&new H(3);b=w.angleToV3(2*Math.random()*Math.PI);return b=w.v3ScalarMul(b,Math.random()*a,b)};w.v3RotateY=function(a,b){var c=Math.cos(b),d=Math.sin(b),f=a[0],g=a[2];a[0]=c*f-d*g;a[2]=d*f+c*g};w.getNearestPointOnLineToPoint=function(a,b,c){var b=w.v3Sub(b,a),d=w.v3Length(b);w.v3Normalize(b,b);c=w.v3Sub(c,a);c=w.v3Dot(c,b);c=w.clamp(c,0,d);return w.v3Add(a,
w.v3ScalarMul(b,c))};w.getLineIntersectSphere=function(a,b,c,d){a=w.getNearestPointOnLineToPoint(a,b,c);if(w.v3DistanceSq(a,c)<=d*d)return w.v3Distance(a,c)};w.getDistanceBetweenSegmentsSq=function(a,b,c,d,f,g){var e=w,n=this.scratchpad,b=n.u=e.v3Sub(b,a,n.u),d=n.v=e.v3Sub(d,c,n.v),n=n.w=e.v3Sub(a,c,n.w),j=e.v3Dot(b,b),i=e.v3Dot(b,d),l=e.v3Dot(d,d),m=e.v3Dot(b,n),k=e.v3Dot(d,n),p=j*l-i*i,s,t=p,u;u=p;1E-8>p?(s=0,t=1,p=k,u=l):(s=i*k-l*m,p=j*k-i*m,0>s?(s=0,p=k,u=l):s>t&&(s=t,p=k+i,u=l));0>p?(p=0,0>-m?
s=0:-m>j?s=t:(s=-m,t=j)):p>u&&(p=u,0>-m+i?s=0:-m+i>j?s=t:(s=-m+i,t=j));j=1E-8>Math.abs(s)?0:s/t;u=1E-8>Math.abs(p)?0:p/u;e.v3AddScalarMul(n,b,j,n);e.v3AddScalarMul(n,d,-u,n);f&&e.v3AddScalarMul(a,b,j,f);g&&e.v3AddScalarMul(c,d,u,g);return e.v3LengthSq(n)};w.getLineIntersectCapsule=function(a,b,c,d,f){var g=w,e=g.scratchpad,n=e.v3NearestPoint=g.v3BuildZero(e.v3NearestPoint),e=e.v3CentreTop=g.v3Copy(c,e.v3CentreTop);e[1]+=f;a=g.getDistanceBetweenSegmentsSq(a,b,c,e,n);if(a<=d*d)return Math.sqrt(a)};
w.getLineIntersectSphereOrCapsule=function(a,b,c,d,f){var g=w;return f?g.getLineIntersectCapsule(a,b,c,d,f):g.getLineIntersectSphere(a,b,c,d)};w.angleToV3=function(a,b){void 0===b&&(b=new H(3));b[0]=-Math.sin(a);b[1]=0;b[2]=Math.cos(a);return b};w.v2BuildFromv3=function(a,b){void 0===b&&(b=new H(2));b[0]=a[0];b[1]=a[2];return b};w.v3ToAngle=function(a){return Math.atan2(-a[0],a[2])};w.clampAngleToNearest=function(a,b){var c=w.boundAngle(a);return Math.round(c/b)*b};w.angleToV2=function(a,b){void 0===
b&&(b=new H(2));b[0]=-Math.sin(a);b[1]=Math.cos(a);return b};w.angleToV3=function(a,b){void 0===b&&(b=new H(3));b[0]=-Math.sin(a);b[1]=0;b[2]=Math.cos(a);return b};w.v2ToAngle=function(a){return Math.atan2(-a[0],a[1])};w.boundAngle=function(a){var b=2*Math.PI;return a-=b*Math.floor(a/b)};w.lerpAngle=function(a,b,c){return w.boundAngle(a+w.diffAngles(a,b)*c)};w.diffAngles=function(a,b){var c=Math.PI,d=2*c,f=w.boundAngle(a),g=w.boundAngle(b),e=g-f;return Math.abs(e)<Math.PI?e:g<c?g+d-f:g-(f+d)};w.remap=
function(a,b,c,d,f){a=w.getFactor(a,b,f);a=w.saturate(a);return w.lerp(c,d,a)};w.lerp=function(a,b,c){return a+(b-a)*c};w.getFactor=function(a,b,c){return(c-a)/(b-a)};w.clamp=function(a,b,c){return Math.min(Math.max(a,b),c)};w.saturate=function(a){return Math.min(Math.max(a,0),1)};w.v3SafeEqual=function(a,b,c){var d=Math.abs;void 0===c&&(c=w.precision);return void 0===a!==(void 0===b)?!1:d(a[0]-b[0])<=c&&d(a[1]-b[1])<=c&&d(a[2]-b[2])<=c};w.aabbAddPoint=function(a,b){var c=a[0],d=a[1],f=a[2],g=a[3],
e=a[4],n=a[5],j,i,l;j=b[0];i=b[1];l=b[2];a[0]=c<j?c:j;a[1]=d<i?d:i;a[2]=f<l?f:l;a[3]=g>j?g:j;a[4]=e>i?e:i;a[5]=n>l?n:l};w.aabbPointDistanceSq=function(a,b){var c=b[0],d=b[1],f=b[2],g=a[0],e=a[1],n=a[2],j=a[3],i=a[4],l=a[5],m=0;c<g?(c=g-c,m+=c*c):c>j&&(c-=j,m+=c*c);d<e?(c=e-d,m+=c*c):d>i&&(c=d-i,m+=c*c);f<n?(c=n-f,m+=c*c):f>l&&(c=f-l,m+=c*c);return m};w.aabbPointDistance2DSq=function(a,b){var c=b[0],d=b[2],f=a[0],g=a[2],e=a[3],n=a[5],j=0;c<f?(c=f-c,j+=c*c):c>e&&(c-=e,j+=c*c);d<g?(c=g-d,j+=c*c):d>n&&
(c=d-n,j+=c*c);return j};w.aabbShrink=function(a,b,c){void 0===c&&(c=w.aabbBuildEmpty());var d=w.v3BuildZero(),f=w.v3BuildZero();w.aabbGetCenterAndHalf(a,d,f);w.v3ScalarSub(f,b,f);f=w.v3ScalarMax(f,0);w.aabbBuildFromCentreHalfExtents(d,f,c);return c};w.aabbSmallestPointOverlapDistance=function(a,b){var c=b[0],d=b[1],f=b[2],g=a[0],e=a[1],n=a[2],j=a[3],i=a[4],l=a[5],m;if(c>g&&(g=c-g,void 0===m||g<m))m=g;if(c<j&&(g=j-c,void 0===m||g<m))m=g;if(d>e&&(g=d-e,void 0===m||g<m))m=g;if(d<i&&(g=i-d,void 0===
m||g<m))m=g;if(f>n&&(g=f-n,void 0===m||g<m))m=g;if(f<l&&(g=l-f,void 0===m||g<m))m=g;return m};w.aabbClampSphere=function(a,b,c,d){void 0===d&&(d=new H(3));a=w.aabbShrink(a,c);return w.aabbClampv3(a,b,d)};w.aabbPointDistance=function(a,b){return Math.sqrt(w.aabbPointDistanceSq(a,b))};w.aabbPointDistance2D=function(a,b){return Math.sqrt(w.aabbPointDistance2DSq(a,b))};w.v2DistanceSq=function(a,b){var c=a[0]-b[0],d=a[1]-b[1];return c*c+d*d};w.v3DistanceSq=function(a,b){var c=a[0]-b[0],d=a[1]-b[1],f=a[2]-
b[2];return c*c+d*d+f*f};w.v3Distance=function(a,b){var c=a[0]-b[0],d=a[1]-b[1],f=a[2]-b[2];return Math.sqrt(c*c+d*d+f*f)};w.v3Distance2DSq=function(a,b){var c=a[0]-b[0],d=a[2]-b[2];return c*c+d*d};w.v3Distance2D=function(a,b){var c=a[0]-b[0],d=a[2]-b[2];return Math.sqrt(c*c+d*d)};w.v3GetX=function(a){return a[0]};w.v3GetY=function(a){return a[1]};w.v3GetZ=function(a){return a[2]};w.v3SetX=function(a,b){b[0]=a};w.v3SetY=function(a,b){b[1]=a};w.v3SetZ=function(a,b){b[2]=a};w.v3Length2DSq=function(a){return a[0]*
a[0]+a[2]*a[2]};w.v3Length2D=function(a){return Math.sqrt(a[0]*a[0]+a[2]*a[2])};w.v3MaxLength=function(a,b,c){void 0===c&&(c=new H(3));w.v3Copy(a,c);w.v3LengthSq(a)>b*b&&(w.v3Normalize(c,c),w.v3ScalarMul(c,b,c));return c};w.v3SafeCopy=function(a,b){void 0===b&&(b=new H(3));return void 0===a?b:w.v3Copy(a,b)};w.m43BuildScale=function(a,b){void 0===b&&(b=new H(12));b[0]=a[0];b[1]=0;b[2]=0;b[3]=0;b[4]=a[1];b[5]=0;b[6]=0;b[7]=0;b[8]=a[2];b[9]=0;b[10]=0;b[11]=0;return b};w.m43BuildScaleTranslate=function(a,
b,c){void 0===c&&(c=new H(12));c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=a[1];c[5]=0;c[6]=0;c[7]=0;c[8]=a[2];c[9]=b[0];c[10]=b[1];c[11]=b[2];return c};w.m43Equal=function(a,b,c){var d=Math.abs;void 0===c&&(c=this.precision);return d(a[0]-b[0])<=c&&d(a[1]-b[1])<=c&&d(a[2]-b[2])<=c&&d(a[3]-b[3])<=c&&d(a[4]-b[4])<=c&&d(a[5]-b[5])<=c&&d(a[6]-b[6])<=c&&d(a[7]-b[7])<=c&&d(a[8]-b[8])<=c&&d(a[9]-b[9])<=c&&d(a[10]-b[10])<=c&&d(a[11]-b[11])<=c};w.m43BuildRotationX=function(a,b){var c=Math.sin(a),d=Math.cos(a);void 0===
b&&(b=new H(12));b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=d;b[5]=-c;b[6]=0;b[7]=c;b[8]=d;b[9]=0;b[10]=0;b[11]=0;return b};w.m43BuildRotationY=function(a,b){var c=Math.sin(a),d=Math.cos(a);void 0===b&&(b=new H(12));b[0]=d;b[1]=0;b[2]=c;b[3]=0;b[4]=1;b[5]=0;b[6]=-c;b[7]=0;b[8]=d;b[9]=0;b[10]=0;b[11]=0;return b};w.m43BuildRotationZ=function(a,b){var c=Math.sin(a),d=Math.cos(a);void 0===b&&(b=new H(12));b[0]=d;b[1]=c;b[2]=0;b[3]=-c;b[4]=d;b[5]=0;b[6]=0;b[7]=0;b[8]=1;b[9]=0;b[10]=0;b[11]=0;return b};w.m33BuildRotationX=
function(a,b){var c=Math.sin(a),d=Math.cos(a);void 0===b&&(b=new H(9));b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=d;b[5]=-c;b[6]=0;b[7]=c;b[8]=d;return b};w.m33BuildRotationY=function(a,b){var c=Math.sin(a),d=Math.cos(a);void 0===b&&(b=new H(9));b[0]=d;b[1]=0;b[2]=c;b[3]=0;b[4]=1;b[5]=0;b[6]=-c;b[7]=0;b[8]=d;return b};w.m33BuildRotationZ=function(a,b){var c=Math.sin(a),d=Math.cos(a);void 0===b&&(b=new H(9));b[0]=d;b[1]=c;b[2]=0;b[3]=-c;b[4]=d;b[5]=0;b[6]=0;b[7]=0;b[8]=1;return b};w.m33RotateX=function(a,b,
c){var d=a[0],f=a[1],g=a[2],e=a[3],n=a[4],j=a[5],i=a[6],l=a[7],a=a[8],m=Math.sin(b),b=Math.cos(b);void 0===c&&(c=new H(9));c[0]=d;c[1]=b*f+m*g;c[2]=-m*f+b*g;c[3]=e;c[4]=b*n+m*j;c[5]=-m*n+b*j;c[6]=i;c[7]=b*l+m*a;c[8]=-m*l+b*a;return c};w.m33RotateY=function(a,b,c){var d=a[0],f=a[1],g=a[2],e=a[3],n=a[4],j=a[5],i=a[6],l=a[7],a=a[8],m=Math.sin(b),b=Math.cos(b);void 0===c&&(c=new H(9));c[0]=b*d-m*g;c[1]=f;c[2]=m*d+b*g;c[3]=b*e-m*j;c[4]=n;c[5]=m*e+b*j;c[6]=b*i-m*a;c[7]=l;c[8]=m*i+b*a;return c};w.m33RotateZ=
function(a,b,c){var d=a[0],f=a[1],g=a[2],e=a[3],n=a[4],j=a[5],i=a[6],l=a[7],a=a[8],m=Math.sin(b),b=Math.cos(b);void 0===c&&(c=new H(9));c[0]=b*d-m*f;c[1]=m*d+b*f;c[2]=g;c[3]=b*e-m*n;c[4]=m*e+b*n;c[5]=j;c[6]=b*i-m*l;c[7]=m*i+b*l;c[8]=a;return c};w.m43BuildRotationXZY=function(a,b){void 0===b&&(b=new H(12));var c=Math.sin(a[0]),d=Math.sin(a[1]),f=Math.sin(a[2]),g=Math.cos(a[0]),e=Math.cos(a[1]),n=Math.cos(a[2]);b[0]=e*n;b[1]=-f;b[2]=n*d;b[3]=c*d+g*e*f;b[4]=g*n;b[5]=-e*c+g*d*f;b[6]=-g*d+e*c*f;b[7]=n*
c;b[8]=g*e+c*d*f;b[9]=0;b[10]=0;b[11]=0;return b};w.v3GetMax=function(a){return a[0]>a[1]?a[0]>a[2]?a[0]:a[2]:a[1]>a[2]?a[1]:a[2]};w.v3IsZero=function(a){return!(0!==a[0]||0!==a[1]||0!==a[2])};w.aabbBuildFromCentreHalfExtents=function(a,b,c){void 0===c&&(c=w.aabbBuildEmpty());b=w.v3Abs(b);return w.aabbBuild(a[0]-b[0],a[1]-b[1],a[2]-b[2],a[0]+b[0],a[1]+b[1],a[2]+b[2],c)};w.aabbBuildFromCentreRadius=function(a,b,c){void 0===c&&(c=w.aabbBuildEmpty());return w.aabbBuild(a[0]-b,a[1]-b,a[2]-b,a[0]+b,a[1]+
b,a[2]+b,c)};w.aabbBuildFromMinAndMax=function(a,b,c){void 0===c&&(c=w.aabbBuildEmpty());return w.aabbBuild(a[0],a[1],a[2],b[0],b[1],b[2],c)};w.aabbEnclosesPoint=function(a,b){var c=b[0],d=b[1],f=b[2];return a[0]<=c&&a[1]<=d&&a[2]<=f&&a[3]>=c&&a[4]>=d&&a[5]>=f};w.aabbClampv3=function(a,b,c){var d=b[0],f=b[1],b=b[2];void 0===c&&(c=new H(3));d=Math.max(d,a[0]);f=Math.max(f,a[1]);b=Math.max(b,a[2]);d=Math.min(d,a[3]);f=Math.min(f,a[4]);b=Math.min(b,a[5]);c[0]=d;c[1]=f;c[2]=b;return c};w.aabbMove=function(a,
b){var c=b[0],d=b[1],f=b[2];a[0]+=c;a[1]+=d;a[2]+=f;a[3]+=c;a[4]+=d;a[5]+=f;return a};w.aabbMergeable=function(a,b){var c=a[0],d=a[1],f=a[2],g=a[3],e=a[4],n=a[5],j=b[0],i=b[1],l=b[2],m=b[3],k=b[4],p=b[5];return(c===m||j===g)&&d===i&&f===l&&e===k&&n===p||(d===k||i===e)&&c===j&&f===l&&g===m&&n===p||(f===p||l===n)&&c===j&&d===i&&g===m&&e===k?!0:!1};w.m43BuildRotationZ=function(a,b){var c=Math.sin(a),d=Math.cos(a);void 0===b&&(b=new H(12));b[0]=d;b[1]=-c;b[2]=0;b[3]=c;b[4]=d;b[5]=0;b[6]=0;b[7]=0;b[8]=
1;b[9]=0;b[10]=0;b[11]=0;return b};w.m44Equal=function(a,b,c){var d=Math.abs;void 0===c&&(c=this.precision);return d(a[0]-b[0])<=c&&d(a[1]-b[1])<=c&&d(a[2]-b[2])<=c&&d(a[3]-b[3])<=c&&d(a[4]-b[4])<=c&&d(a[5]-b[5])<=c&&d(a[6]-b[6])<=c&&d(a[7]-b[7])<=c&&d(a[8]-b[8])<=c&&d(a[9]-b[9])<=c&&d(a[10]-b[10])<=c&&d(a[11]-b[11])<=c&&d(a[12]-b[12])<=c&&d(a[13]-b[13])<=c&&d(a[14]-b[14])<=c&&d(a[15]-b[15])<=c};w.m43FromM33V3=function(a,b,c){void 0===c&&(c=new H(12));c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=
a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=b[0];c[10]=b[1];c[11]=b[2];return c};w.m33FromM43=function(a,b){void 0===b&&(b=new H(9));b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};w.randomIntInRange=function(a,b){return Math.floor(Math.random()*(b-a+1))+a};w.randomInRange=function(a,b){return Math.random()*(b-a)+a};w.applyPatches=function(a){for(var b in w)w.hasOwnProperty(b)&&!a.hasOwnProperty(b)&&(a[b]=w[b])};Ea.prototype.scratchpad={};
Ea.prototype.setFOV=function(a){this.recipViewWindowY=this.recipViewWindowX=1/Math.tan(0.5*a);a!==this.fov&&this.updateProjectionMatrix();this.fov=a};Ea.prototype.getFOV=function(){return void 0!==this.fov?this.fov:this.fov=2*Math.atan(1/this.recipViewWindowX)};Ea.prototype.extractSmallestFOV=function(){return this.recipViewWindowY*this.aspectRatio>this.recipViewWindowX?2*Math.atan(1/(this.recipViewWindowY*this.aspectRatio)):this.getFOV()};Ea.prototype.setGlobals=function(a){this.globals=a};Ea.prototype.normalisedToScreen=
function(a,b){var c=this.globals.graphicsDevice;return this.md.vec2Build(a[0]*c.width,a[1]*c.height,b)};Ea.prototype.screenToNormalised=function(a,b){var c=this.globals.graphicsDevice;return this.md.vec2Build(a[0]/c.width,a[1]/c.height,b)};Ea.prototype.screenRadiusToWorldRadius=function(a,b){var c=this.md,d=this.globals.graphicsDevice.width,f=this.getFOV(),g=c.m43Pos(this.matrix),c=c.v3Distance(a,g);return Math.sin(f*b/d)*c};Ea.prototype.getv3Location=function(){return this.md.m43Pos(this.matrix)};
Ea.prototype.getv3Forward=function(){return this.md.m43At(this.matrix)};Ea.prototype.screenToWorld=function(a,b,c){var d=this.md,a=d.vec2Build(a,b),a=this.screenToNormalised(a),a=d.v4Build(2*a[0]-1,1-2*a[1],-1,1);if(!this.prevViewProjectionMatrix||!d.m44Equal(this.prevViewProjectionMatrix,this.viewProjectionMatrix))this.invViewProjectionMatrix=d.m44Inverse(this.viewProjectionMatrix,this.invViewProjectionMatrix),this.prevViewProjectionMatrix=d.m44Copy(this.viewProjectionMatrix,this.prevViewProjectionMatrix);
return 0<this.invViewProjectionMatrix.length?(a=d.m44Transform(this.invViewProjectionMatrix,a),a=d.v3Build(a[0],a[1],a[2]),b=d.v3Sub(a,d.m43Pos(this.matrix)),d.v3Normalize(b,b),d.v3Add(a,d.v3ScalarMul(b,c))):null};Ea.prototype.worldToScreen=function(a,b){var c=Ea.prototype.scratchpad,d=this.md,f=this.viewProjectionMatrix,g=c.v4World=d.v4Build(a[0],a[1],a[2],1,c.v4World),c=c.v4Norm=d.m44Transform(f,g,c.v4Norm);if(0!==c[3]&&(c[0]/=c[3],c[1]/=c[3],c[2]/=c[3],!(0>c[3])))return d=d.vec2Build(0.5*(c[0]+
1),0.5*(-c[1]+1),b),this.normalisedToScreen(d,d)};pd.prototype={init:function(a){this.globals=a;this.k=this.r=this.i=this.u=this.s=this.arriveTime=this.elapsedTime=this.a=this.v=this.endV=this.d=this.x=0;this.scratchpad={}},setPosition:function(a){this.s=this.x=this.d=a;this.endV=this.u=this.v=this.i=this.a=this.r=this.k=this.elapsedTime=this.arriveTime=0},setDestination:function(a,b){this.setDestinationWithSpeedAndTime(a,0,b)},setDestinationWithSpeedAndTime:function(a,b,c){if(0.001>c)this.setPosition(a);
else{var d=this.globals.mathDevice;this.s=this.x;this.u=this.v;this.d=a;this.endV=b;this.arriveTime=c;this.elapsedTime=0;a=this.scratchpad;b=this.arriveTime*this.arriveTime/2;c=this.arriveTime*b/3;b=a.mat=d.m43Build(b*b/6,c,b,c,b,this.arriveTime,b,this.arriveTime,1,0,0,0,a.mat);b=a.inverse=d.m43Inverse(b,a.inverse);a=a.vector=d.v3Build(this.d-this.s-this.u*this.arriveTime,this.endV-this.u,0,a.vector);a=d.m43TransformPoint(b,a);this.k=a[0];this.r=a[1];this.i=a[2]}},getCurrentValue:function(){return this.x},
getDestination:function(){return this.d},update:function(a){this.elapsedTime+=a;if(this.elapsedTime>=this.arriveTime)this.x=this.d,this.v=this.endV,this.a=0,this.elapsedTime=this.arriveTime;else{var a=this.elapsedTime*this.elapsedTime/2,b=this.elapsedTime*a/3;this.v=this.k*b+this.r*a+this.i*this.elapsedTime+this.u;this.x=this.k*(a*a/6)+this.r*b+this.i*a+this.u*this.elapsedTime+this.s}},offset:function(a){this.x+=a;this.d+=a;this.s+=a},arrived:function(){return this.elapsedTime===this.arriveTime}};
pd.create=function(a){var b=new pd;b.init(a);return b};Nc.prototype={init:function(a){this.globals=a;this.x=pd.create(a);this.Y=pd.create(a);this.Z=pd.create(a)},setv3Position:function(a){this.x.setPosition(a[0]);this.Y.setPosition(a[1]);this.Z.setPosition(a[2])},setDestinationWithVelocityAndTime:function(a,b,c){this.x.setDestinationWithSpeedAndTime(a[0],b[0],c);this.Y.setDestinationWithSpeedAndTime(a[1],b[1],c);this.Z.setDestinationWithSpeedAndTime(a[2],b[2],c)},setv3Destination:function(a,b){this.x.setDestination(a[0],
b);this.Y.setDestination(a[1],b);this.Z.setDestination(a[2],b)},getv3Velocity:function(){return this.v3Velocity=this.globals.mathDevice.v3Build(this.x.v,this.Y.v,this.Z.v,this.v3Velocity)},getv3Location:function(){return this.v3Location=this.globals.mathDevice.v3Build(this.x.getCurrentValue(),this.Y.getCurrentValue(),this.Z.getCurrentValue(),this.v3Location)},getv3Destination:function(){return this.v3Destination=this.globals.mathDevice.v3Build(this.x.getDestination(),this.Y.getDestination(),this.Z.getDestination(),
this.v3Destination)},update:function(a){this.x.update(a);this.Y.update(a);this.Z.update(a)},offset:function(a){this.x.Offset(a[0]);this.Y.Offset(a[1]);this.Z.Offset(a[2])},arrived:function(){return this.x.arrived()}};Nc.create=function(a){var b=new Nc;b.init(a);return b};ma.getStoredAverageTime=function(a){if(!this.prevProfiles)return 0;a=this.prevProfiles[a];return void 0===a||0===a.calls?0:a.duration/a.calls};ma.getStoredCallCount=function(a){if(!this.prevProfiles)return 0;a=this.prevProfiles[a];
return void 0===a?0:a.calls};ma.getStoredDuration=function(a){if(!this.prevProfiles)return 0;a=this.prevProfiles[a];return void 0===a?0:a.duration};ma.resetAndStore=function(){this.prevProfiles=this.profiles;this.reset()};w.perlinNoise=function(a,b,c){var d=this.buildPerlin(),f=this.perlinFade,g=this.perlinLerp,e=this.perlinGrad,n=this.perlinScale,j=Math.floor(a)&255,i=Math.floor(b)&255,l=Math.floor(c)&255,a=a-Math.floor(a),b=b-Math.floor(b),c=c-Math.floor(c),m=f(a),k=f(b),f=f(c),p=d[j]+i,s=d[p]+
l,p=d[p+1]+l,i=d[j+1]+i,j=d[i]+l,l=d[i+1]+l;return n(g(f,g(k,g(m,e(d[s],a,b,c),e(d[j],a-1,b,c)),g(m,e(d[p],a,b-1,c),e(d[l],a-1,b-1,c))),g(k,g(m,e(d[s+1],a,b,c-1),e(d[j+1],a-1,b,c-1)),g(m,e(d[p+1],a,b-1,c-1),e(d[l+1],a-1,b-1,c-1)))))};w.buildPerlin=function(){if(void 0!==this.perlin)return this.perlin;var a=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,
20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,
251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];return this.perlin=a.concat(a)};w.perlinFade=function(a){return a*a*a*(a*(6*a-15)+10)};w.perlinLerp=function(a,b,c){return b+a*(c-b)};w.perlinGrad=function(a,b,c,d){var a=a&15,f=8>a?b:c,b=4>a?c:12==a||14==a?b:d;return(0==(a&1)?f:-f)+(0==(a&2)?b:-b)};w.perlinScale=function(a){return(1+
a)/2};Sd.prototype={complete:function(){if(!this.dependenciesLoaded&&this.sceneAssetsRequested&&0===this.textureManager.getNumPendingTextures()&&(!this.shaderManager||0===this.shaderManager.getNumPendingShaders()))this.dependenciesLoaded=!0;return this.dependenciesLoaded},load:function(a){function b(a,b){g.request({src:f&&f[a]||this.pathPrefix+a,onload:b})}function c(){d.postSceneLoadFn&&d.postSceneLoadFn(d.scene);d.sceneAssetsRequested=!0}var d=this;this.sceneAssetsRequested=!1;this.scene=a.scene;
this.assetPath=a.assetPath;this.textureManager=a.textureManager;this.shaderManager=a.shaderManager;this.effectManager=a.effectManager;this.animationManager=a.animationManager;this.requestHandler=a.requestHandler;void 0!==a.keepLights&&(this.keepLights=a.keepLights);void 0!==a.keepCameras&&(this.keepCameras=a.keepCameras);this.preSceneLoadFn=a.preSceneLoadFn;this.postSceneLoadFn=a.postSceneLoadFn;this.sceneLoaded=this.dependenciesLoaded=!1;a.append||this.scene.clear();var f=this.pathRemapping,g=this.requestHandler;
this.request=a.request?a.request:b;this.request(a.assetPath,function(b){function f(a){TurbulenzEngine.setTimeout(a,0)}(b=JSON.parse(b))||(b={});a.preSceneLoadFn&&a.preSceneLoadFn(b);var e,i=function(){};i.prototype=a;e=new i;sb.create().resolve({data:b,request:this.request,onload:function(a){d.animationManager&&d.animationManager.loadData(a);e.data=a;e.yieldFn=f;e.onload=c;d.scene.load(e)},requestHandler:g})})},setPathRemapping:function(a,b){this.pathRemapping=a;this.pathPrefix=b}};Sd.create=function(){var a=
new Sd;a.scene=null;a.assetPath=null;a.textureManager=null;a.shaderManager=null;a.effectManager=null;a.animationManager=null;a.preSceneLoadFn=null;a.postSceneLoadFn=null;a.dependenciesLoaded=!1;a.sceneAssetsRequested=!1;a.pathPrefix="";return a};rc.prototype={maximumLines:ea.maxDebugLines,drawDebugLine:function(a,b,c,d,f){if(!(this.debugLinesCount>=this.maximumLines)){var g=this.debugLinesCount*2*this.numAttributeComponents;this.data[g+0]=a[0];this.data[g+1]=a[1];this.data[g+2]=a[2];this.data[g+3]=
c;this.data[g+4]=d;this.data[g+5]=f;this.data[g+6]=b[0];this.data[g+7]=b[1];this.data[g+8]=b[2];this.data[g+9]=c;this.data[g+10]=d;this.data[g+11]=f;this.debugLinesCount+=1}},getColourFromID:function(a){var b=this.mathDevice;void 0===this.randomColours&&(this.randomColours=[b.v3Build(1,0,0),b.v3Build(0,1,0),b.v3Build(0,0,1),b.v3Build(0,1,1),b.v3Build(1,0,1),b.v3Build(1,1,0)]);return this.randomColours[a%this.randomColours.length]},drawDebugCircle:function(a,b,c,d,f,g){var e=this.mathDevice,n=5*c;
5>n&&(n=5);30<n&&(n=30);var j=2*Math.PI/n;e.v3Normalize(b,b);var i=e.v3Build(c,0,0);1!==b[1]&&-1!==b[1]&&(i=e.v3Cross(b,e.v3BuildYAxis()),e.v3ScalarMul(i,c,i));var b=e.m33FromAxisRotation(b,j),c=e.v3Add(a,i),j=e.v3Copy(c),l;for(l=1;l<n+1;l+=1)i=e.m33Transform(b,i),e.v3Add(a,i,j),this.drawDebugLine(c,j,d,f,g),e.v3Copy(j,c)},drawDebugPoint:function(a,b,c,d,f){var g=0.25;void 0!==f&&(g=f);var f=this.mathDevice,e=this.scratchpad,n=e.p0=f.v3BuildZero(e.p0),e=e.p1=f.v3BuildZero(e.p1);this.drawDebugLine(f.v3Add(a,
f.v3Build(-g,0,0,n),n),f.v3Add(a,f.v3Build(g,0,0,e),e),b,c,d);this.drawDebugLine(f.v3Add(a,f.v3Build(0,-g,0,n),n),f.v3Add(a,f.v3Build(0,g,0,e),e),b,c,d);this.drawDebugLine(f.v3Add(a,f.v3Build(0,0,-g,n),n),f.v3Add(a,f.v3Build(0,0,g,e),e),b,c,d)},drawDebugSphere:function(a,b,c,d,f){var g=this.mathDevice;this.drawDebugCircle(a,g.v3BuildXAxis(),b,c,d,f);this.drawDebugCircle(a,g.v3BuildYAxis(),b,c,d,f);this.drawDebugCircle(a,g.v3BuildZAxis(),b,c,d,f)},drawDebugHalfCube:function(a,b,c,d,f){var g=this.mathDevice,
e,n,j=g.v3Build(0.5*b,0.5*b,0.5*b),b=g.v3Add(a,g.v3Build(-j[0],+j[1],-j[2]));e=g.v3Add(a,g.v3Build(+j[0],+j[1],-j[2]));n=g.v3Add(a,g.v3Build(-j[0],+j[1],+j[2]));a=g.v3Add(a,g.v3Build(-j[0],-j[1],-j[2]));this.drawDebugLine(b,e,c,d,f);this.drawDebugLine(n,b,c,d,f);this.drawDebugLine(b,a,c,d,f)},drawDebugExtents:function(a,b,c,d){var f=this.mathDevice,g,e,n,j,i,l,m=this.scratchpad,k=m.v3pos=f.v3BuildZero(m.v3pos),p=m.half_length=f.v3BuildZero(m.half_length);f.aabbGetCenterAndHalf(a,k,p);a=m.ca=f.v3Add(k,
f.v3Build(-p[0],+p[1],-p[2],m.ca),m.ca);g=m.cb=f.v3Add(k,f.v3Build(+p[0],+p[1],-p[2],m.cb),m.cb);e=m.cc=f.v3Add(k,f.v3Build(-p[0],+p[1],+p[2],m.cc),m.cc);n=m.cd=f.v3Add(k,f.v3Build(+p[0],+p[1],+p[2],m.cd),m.cd);j=m.ce=f.v3Add(k,f.v3Build(-p[0],-p[1],-p[2],m.ce),m.ce);i=m.cf=f.v3Add(k,f.v3Build(+p[0],-p[1],-p[2],m.cf),m.cf);l=m.cg=f.v3Add(k,f.v3Build(-p[0],-p[1],+p[2],m.cg),m.cg);f=m.ch=f.v3Add(k,f.v3Build(+p[0],-p[1],+p[2],m.ch),m.ch);this.drawDebugLine(a,g,b,c,d);this.drawDebugLine(g,n,b,c,d);this.drawDebugLine(n,
e,b,c,d);this.drawDebugLine(e,a,b,c,d);this.drawDebugLine(a,j,b,c,d);this.drawDebugLine(g,i,b,c,d);this.drawDebugLine(n,f,b,c,d);this.drawDebugLine(e,l,b,c,d);this.drawDebugLine(j,i,b,c,d);this.drawDebugLine(i,f,b,c,d);this.drawDebugLine(f,l,b,c,d);this.drawDebugLine(l,j,b,c,d)},drawDebugHalfExtents:function(a,b,c,d){var f=this.mathDevice,g,e,n=this.scratchpad,j=n.v3pos=f.v3BuildZero(n.v3pos),i=n.half_length=f.v3BuildZero(n.half_length);f.aabbGetCenterAndHalf(a,j,i);a=n.ca=f.v3Add(j,f.v3Build(-i[0],
+i[1],-i[2],n.ca),n.ca);g=n.cb=f.v3Add(j,f.v3Build(+i[0],+i[1],-i[2],n.cb),n.cb);e=n.cc=f.v3Add(j,f.v3Build(-i[0],+i[1],+i[2],n.cc),n.cc);f=n.ce=f.v3Add(j,f.v3Build(-i[0],-i[1],-i[2],n.ce),n.ce);this.drawDebugLine(a,g,b,c,d);this.drawDebugLine(e,a,b,c,d);this.drawDebugLine(a,f,b,c,d)},drawDebugCube:function(a,b,c,d,f){var g=this.mathDevice,e,n,j,i,l,m,k=g.v3Build(0.5*b,0.5*b,0.5*b),b=g.v3Add(a,g.v3Build(-k[0],+k[1],-k[2]));e=g.v3Add(a,g.v3Build(+k[0],+k[1],-k[2]));n=g.v3Add(a,g.v3Build(-k[0],+k[1],
+k[2]));j=g.v3Add(a,g.v3Build(+k[0],+k[1],+k[2]));i=g.v3Add(a,g.v3Build(-k[0],-k[1],-k[2]));l=g.v3Add(a,g.v3Build(+k[0],-k[1],-k[2]));m=g.v3Add(a,g.v3Build(-k[0],-k[1],+k[2]));a=g.v3Add(a,g.v3Build(+k[0],-k[1],+k[2]));this.drawDebugLine(b,e,c,d,f);this.drawDebugLine(e,j,c,d,f);this.drawDebugLine(j,n,c,d,f);this.drawDebugLine(n,b,c,d,f);this.drawDebugLine(b,i,c,d,f);this.drawDebugLine(e,l,c,d,f);this.drawDebugLine(j,a,c,d,f);this.drawDebugLine(n,m,c,d,f);this.drawDebugLine(i,l,c,d,f);this.drawDebugLine(l,
a,c,d,f);this.drawDebugLine(a,m,c,d,f);this.drawDebugLine(m,i,c,d,f)},drawDebugMatrix:function(a){var b=this.mathDevice,c=b.m43Pos(a);this.drawDebugLine(c,b.v3Add(c,b.v3Normalize(b.m43Right(a))),255,0,0);this.drawDebugLine(c,b.v3Add(c,b.v3Normalize(b.m43Up(a))),0,255,0);this.drawDebugLine(c,b.v3Add(c,b.v3Normalize(b.m43At(a))),0,0,255)},drawDebugAxis:function(a,b){var c=this.mathDevice;this.drawDebugLine(a,c.v3Add(a,c.v3Build(b,0,0)),255,0,0);this.drawDebugLine(a,c.v3Add(a,c.v3Build(0,b,0)),0,255,
0);this.drawDebugLine(a,c.v3Add(a,c.v3Build(0,0,b)),0,0,255)},buildArrowPoints:function(){if(void 0===rc.prototype.arrowPoints){var a=this.mathDevice;rc.prototype.arrowPoints=[a.v3Build(0,0,-0.5),a.v3Build(0,0,0.5),a.v3Build(0.75,0,0.4),a.v3Build(0.75,0,1),a.v3Build(1,0,0),a.v3Build(0.75,0,-1),a.v3Build(0.75,0,-0.4),a.v3Build(0,0,-0.5)]}},drawDebugArrow:function(a,b,c,d,f,g){var e=this.mathDevice,n=e.v3Sub(b,a),b=e.v3Length(n),n=e.v3ToAngle(n),c=e.m43BuildScale(e.v3Build(b-0.5,1,c)),b=e.m43BuildRotationY(n),
c=e.m43Mul(c,b),b=e.m43TransformVector(b,e.v3Build(0.5,0,0));e.m43SetPos(c,e.v3Add(a,b));this.buildArrowPoints();var a=this.arrowPoints,b=a.length,j,n=e.m43TransformPoint(c,a[0]),i;for(i=1;i<b;i+=1)j=e.m43TransformPoint(c,a[i],j),this.drawDebugLine(n,j,d,f,g),n=e.v3Copy(j,n)},drawDebugLines:function(){if(0!==this.debugLinesCount){var a=this.graphicsDevice,b=this.camera,c=this.shaderManager.get("shaders/debug.cgfx").getTechnique("debug_lines");c&&(a.setTechnique(c),(c=this.debugLinesTechniqueParameters)?
c.worldViewProjection=b.viewProjectionMatrix:this.debugLinesTechniqueParameters=c=a.createTechniqueParameters({worldViewProjection:b.viewProjectionMatrix}),a.setTechniqueParameters(c),this.vertexBuffer.setData(this.data,0,2*this.debugLinesCount),b=a.createSemantics([a.SEMANTIC_POSITION,a.SEMANTIC_COLOR]),a.setStream(this.vertexBuffer,b),a.draw(a.PRIMITIVE_LINES,2*this.debugLinesCount,0),this.clearDebugLineList())}},preload:function(){this.shaderManager.load("shaders/debug.cgfx")},clearDebugLineList:function(){this.debugLinesCount=
0}};rc.createFromGlobals=function(a){return rc.create(a.mathDevice,a.shaderManager,a.graphicsDevice,a.camera)};rc.create=function(a,b,c,d){return new rc(a,b,c,d)};ff.prototype={isLoadingMesh:function(a){return void 0!==this.assetCache[a]},isLoading:function(){return 0<this.loadingAssetCounter},load:function(a,b,c,d,f){var g=this.globals,e=g.mathDevice,n,j,i,l=this,b=b?b:e.m43BuildIdentity();i={name:a+this.loadAssetCounter.toString(),local:b,dynamic:void 0!==c?!c:!0,disabled:!1,keepVertexData:ea.debugEnableWireframe||
ea.mergeStaticMeshes};var m=!1,k=d,c=function(){void 0===k&&(k=Sa.create(i),this.createdNodes+=1,m=!0)}.bind(this),p=this.assetCache[a],e=d?e.m43Copy(b):e.m43BuildIdentity();void 0!==p?p.loaded?(l.cloneAssetCounter+=1,j=p.loaded.name+"_copy"+l.cloneAssetCounter.toString(),n=g.scene.cloneRootNode(p.loaded,j),this.dontChildPreLoaded&&!d?(k=n,k.setLocalTransform(b)):(c(),n.setLocalTransform(e),k.addChild(n)),this.createdNodes+=1):(c(),p.Queue.push({node:k,localMatrix:e})):(this.uniqueMeshes+=1,c(),p=
this.assetCache[a]={rootNode:Sa.create(i),loaded:null},p.Queue=[],p.Queue.push({node:k,localMatrix:e}),a={scene:g.scene,append:!0,assetPath:a,keepLights:!1,graphicsDevice:g.graphicsDevice,mathDevice:g.mathDevice,textureManager:g.textureManager,shaderManager:g.shaderManager,effectManager:g.effectManager,requestHandler:g.requestHandler,animationManager:g.animationManager,shapesNamePrefix:a,skeletonNamePrefix:a,dynamic:!0,postSceneLoadFn:function(){var a=p.rootNode,b,c=p.Queue;for(b=0;b<c.length;b+=
1)l.cloneAssetCounter+=1,j=a.name+"_copy"+l.cloneAssetCounter.toString(),n=g.scene.cloneRootNode(a,j),n.setLocalTransform(c[b].localMatrix),c[b].node.addChild(n),this.createdNodes+=1;f&&g.instanceManager.queueSceneNode(a,f);p.loaded=a;c.length=0;l.loadingAssetCounter-=1},parentNode:p.rootNode,name:a+this.loadAssetCounter.toString()+"_child",keepVertexData:ea.debugEnableWireframe||ea.mergeStaticMeshes},d=Sd.create(),d.setPathRemapping(this.pathRemapping,this.pathPrefix),d.load(a),d=null,this.loadingAssetCounter+=
1);this.loadAssetCounter+=1;m&&g.scene.addRootNode(k);return k},setPathRemapping:function(a,b){this.pathRemapping=a;this.pathPrefix=b},getNumberOfUniqueMeshes:function(){return this.uniqueMeshes},getNumberOfNodes:function(){return this.createdNodes}};ff.create=function(a){var b=new ff;b.globals=a;b.loadAssetCounter=0;b.cloneAssetCounter=0;b.loadingAssetCounter=0;b.assetCache={};b.createdNodes=0;b.uniqueMeshes=0;b.dontChildPreLoaded=!0;return b};ua.prototype={maxSprites:256,blendStyle:{NORMAL:0,ADD:1,
NORMAL_NO_Z:2,ADD_NO_Z:3},blendNames:["blend_particle","add_particle","blend_particle_no_z","add_particle_no_z"],addSprite:function(a){if(!(this.spriteList.length>=this.maxSprites)){var b=this.globals.mathDevice,c=this.spriteCache[this.spriteList.length];c.v3location=a.v3Location?b.v3Copy(a.v3Location,c.v3location):b.v3BuildZero(c.v3location);c.sizeX=void 0!==a.sizeX?a.sizeX:void 0!==a.size?a.size:1;c.sizeY=void 0!==a.sizeY?a.sizeY:void 0!==a.size?a.size:1;c.v4color=a.v4color?b.v4Copy(a.v4color,c.v4color):
b.v4BuildOne(c.v4color);c.texture=a.texture?a.texture:"textures/Test.dds";c.blendStyle=a.blendStyle?a.blendStyle:this.blendStyle.NORMAL;c.outValid=!1;a.out&&(c.out=b.v3Copy(a.out,c.out),c.outValid=!0);c.angle=a.angle?a.angle:0;c.offsetX=a.offsetX?a.offsetX:0;c.offsetY=a.offsetY?a.offsetY:0;c.offsetAngle=a.offsetAngle?a.offsetAngle:0;this.spriteList.push(c)}},drawSprites:function(){function a(){m.vertexBuffer.setData(u,0,4*l);w=0;g.drawIndexed(g.PRIMITIVE_TRIANGLES,6*l,0);l=0}if(0!==this.spriteList.length){var b=
this.globals,c=b.mathDevice,d=b.camera,f=b.textureManager,g=b.graphicsDevice,e=b.shaderManager,n,j,b=this.spriteList,i=b.length,l=0,m=this,k=Math.sqrt(2),p=0.25*Math.PI,s,t,u=this.writerArray,w=0,B=function(a,b,c,d){u[w]=a[0];u[w+1]=a[1];u[w+2]=a[2];u[w+3]=b;u[w+4]=c;u[w+5]=d[0];u[w+6]=d[1];u[w+7]=d[2];u[w+8]=d[3];w+=9};g.setStream(this.vertexBuffer,this.semantics);g.setIndexBuffer(this.indexBuffer);this.globalTechniqueParameters.worldViewProjection=d.viewProjectionMatrix;if(B)for(var e=e.load("shaders/simplesprite.cgfx"),
y=d.matrix,d=c.m43Up(y),y=c.m43Right(y),v=this.scratchPad,x=v.thisUp=c.v3BuildOne(v.thisUp),A=v.thisRight=c.v3BuildOne(v.thisRight),C=v.rightScaled=c.v3BuildOne(v.rightScaled),E=v.upScaled=c.v3BuildOne(v.upScaled),G=v.yAxis=c.v3BuildYAxis(v.yAxis),H=v.tr=c.v3BuildOne(v.tr),F=v.tl=c.v3BuildOne(v.tl),I=v.br=c.v3BuildOne(v.br),v=v.bl=c.v3BuildOne(v.bl),L=this.localTechniqueParameters,N,O=0;O<i;O+=1){var M=b[O],P=M.blendStyle;s=M.texture;if(n!==P||j!==s){0<l&&a();n=P;j=s;s=f.load(s);P=e.getTechnique(this.blendNames[P]);
if(!P)return;P!==N&&(g.setTechnique(P),g.setTechniqueParameters(this.globalTechniqueParameters),N=P);L.diffuse=s;g.setTechniqueParameters(L)}P=M.v3location;s=M.sizeX;t=M.sizeY;M.outValid?(1===Math.abs(M.out[1])?(c.v3BuildZAxis(x),c.v3BuildXAxis(A)):(c.v3Cross(M.out,G,A),c.v3Cross(A,M.out,x),c.v3Normalize(A,A),c.v3Normalize(x,x)),c.v3Neg(A,A)):(c.v3Copy(d,x),c.v3Copy(y,A));c.v3ScalarMul(A,s,C);c.v3ScalarMul(x,t,E);if(0!==M.offsetX||M.offsetY)0!==M.offsetAngle?(s=Math.sin(M.offsetAngle),t=Math.cos(M.offsetAngle),
c.v3AddScalarMul(P,A,M.offsetX*t,P),c.v3AddScalarMul(P,x,-M.offsetX*s,P),c.v3AddScalarMul(P,A,M.offsetY*s,P),c.v3AddScalarMul(P,x,M.offsetY*t,P)):(c.v3AddScalarMul(P,A,M.offsetX,P),c.v3AddScalarMul(P,x,M.offsetY,P));c.v3Copy(P,H);c.v3Copy(P,F);c.v3Copy(P,I);c.v3Copy(P,v);0!==M.angle?(s=Math.sin(M.angle+p)*k,t=Math.cos(M.angle+p)*k,c.v3AddScalarMul(H,C,s,H),c.v3AddScalarMul(H,E,t,H),c.v3AddScalarMul(F,C,-t,F),c.v3AddScalarMul(F,E,s,F),c.v3AddScalarMul(I,C,t,I),c.v3AddScalarMul(I,E,-s,I),c.v3AddScalarMul(v,
C,-s,v),c.v3AddScalarMul(v,E,-t,v)):(c.v3Add(H,C,H),c.v3Add(H,E,H),c.v3Sub(F,C,F),c.v3Add(F,E,F),c.v3Add(I,C,I),c.v3Sub(I,E,I),c.v3Sub(v,C,v),c.v3Sub(v,E,v));M=M.v4color;B(v,0,1,M);B(I,1,1,M);B(H,1,0,M);B(F,0,0,M);l+=1}0<l&&a();this.clearSpriteList()}},clearSpriteList:function(){this.spriteList.length=0},preload:function(){this.globals.shaderManager.load("shaders/simplesprite.cgfx")}};ua.create=function(a){return new ua(a)};gf.prototype={numberToCommaString:function(a){return Math.round(a).toString().replace(/\B(?=(\d{3})+(?!\d))/g,
",")},drawFontDouble:function(a,b){var c=this.scratchPad,d=b.color,f=b.r,g=b.g,e=b.b,n=b.a;b.x+=1;b.y+=1;b.color=c.v4Black;void 0===a?this.drawFont("Error: String is undefined",b):this.drawFont(a,b);b.color=d;b.r=f;b.g=g;b.b=e;b.a=n;b.x-=1;b.y-=1;void 0===a?this.drawFont("Error: String is undefined",b):this.drawFont(a,b)},drawFont:function(a,b){var c=this.globals.mathDevice,d=this.allocateParams();d.string=a;d.spacing=void 0!==b.spacing?b.spacing:0;d.alignment=void 0!==b.alignment?b.alignment:0;d.valignment=
void 0!==b.valignment?b.valignment:1;c.v4BuildOne(d.color);void 0!==b.color?c.v4Copy(b.color,d.color):(d.color[0]=void 0!==b.r?b.r:1,d.color[1]=void 0!==b.g?b.g:1,d.color[2]=void 0!==b.b?b.b:1,d.color[3]=void 0!==b.a?b.a:1);this.calculateFontAndScaleFromInputParams(b,d);d.font&&(void 0===b.rect?this.calculateRectFromInputParams(d.font,d.string,d.scale,d.spacing,b.x,b.y,d.alignment,d.valignment,d.rect):c.v4Copy(b.rect,d.rect),this.textToDraw.push(d))},getRectangleDimensions:function(a,b){var c=this.allocateParams();
c.string=a;c.spacing=void 0!==b.spacing?b.spacing:0;c.alignment=void 0!==b.alignment?b.alignment:0;c.valignment=void 0!==b.valignment?b.valignment:1;this.calculateFontAndScaleFromInputParams(b,c);if(c.font)return c.font.calculateTextDimensions(c.string,c.scale,c.spacing)},calculateRectFromInputParams:function(a,b,c,d,f,g,e,n,j){a=a.calculateTextDimensions(b,c,d);j[0]=0===e?f:2===e?f-a.width:f-0.5*a.width;j[2]=a.width;j[1]=0===n?g:2===n?g-a.height:g-0.5*a.height;j[3]=a.height;return j},calculateScaleFromInputParams:function(a){var b=
1;void 0!==a.specialScale&&(b*=a.specialScale);return b},isStandardPointSize:function(a){switch(a){case 8:return!0;case 16:return!0;case 32:return!0;case 64:return!0}return!1},getFontFromPointSize:function(a,b){var c;if(!b||"regular"===b){switch(a){case 8:c=this.fontRegular8;break;case 16:c=this.fontRegular16;break;case 32:c=this.fontRegular32;break;case 64:c=this.fontRegular64;break;default:c=this.fontRegular16}return c}if("bold"===b){switch(a){case 8:c=this.fontBold8;break;case 16:c=this.fontBold16;
break;case 32:c=this.fontBold32;break;case 64:c=this.fontBold64;break;default:c=this.fontBold16}return c}if("styled"===b){switch(a){case 8:c=this.fontBold8;break;case 16:c=this.fontB16;break;case 32:c=this.fontB32;break;case 64:c=this.fontB64;break;default:c=this.fontB16}return c}return this.fontRegular16},calculateFontAndScaleFromInputParams:function(a,b){var c=this.calculateScaleFromInputParams(a),d=16;void 0!==a.pointSize&&(d=a.pointSize);if(1!==c||!this.isStandardPointSize(d))c*=d,d=Math.log(c)/
Math.LN2,d=Math.pow(2,Math.round(d)),d=Math.max(d,8),d=Math.min(d,64),c/=d,a.pointSize=d;b.scale=c;b.font=this.getFontFromPointSize(d,a.fontStyle)},preload:function(){this.globals.fontManager.load("fonts/avenirmedium-8.fnt");this.globals.fontManager.load("fonts/avenirmedium-16.fnt");this.globals.fontManager.load("fonts/avenirmedium-32.fnt");this.globals.fontManager.load("fonts/avenirmedium-64.fnt");this.globals.fontManager.load("fonts/bold-8.fnt");this.globals.fontManager.load("fonts/bold-16.fnt");
this.globals.fontManager.load("fonts/bold-32.fnt");this.globals.fontManager.load("fonts/bold-64.fnt");this.globals.fontManager.load("fonts/bikraplain-8.fnt");this.globals.fontManager.load("fonts/bikraplain-16.fnt");this.globals.fontManager.load("fonts/bikraplain-32.fnt");this.globals.fontManager.load("fonts/bikraplain-64.fnt");this.globals.shaderManager.load("shaders/font.cgfx")},hasLoaded:function(){var a=this.globals,b=a.fontManager,c=a.shaderManager,d=a.mathDevice,a=a.graphicsDevice;return 0===
b.getNumPendingFonts()&&0===c.getNumPendingShaders()?(this.technique2D||(this.fontRegular8=b.load("fonts/avenirmedium-8.fnt"),this.fontRegular16=b.load("fonts/avenirmedium-16.fnt"),this.fontRegular32=b.load("fonts/avenirmedium-32.fnt"),this.fontRegular64=b.load("fonts/avenirmedium-64.fnt"),this.fontBold8=b.load("fonts/bold-8.fnt"),this.fontBold16=b.load("fonts/bold-16.fnt"),this.fontBold32=b.load("fonts/bold-32.fnt"),this.fontBold64=b.load("fonts/bold-64.fnt"),this.fontB8=b.load("fonts/bikraplain-8.fnt"),
this.fontB16=b.load("fonts/bikraplain-16.fnt"),this.fontB32=b.load("fonts/bikraplain-32.fnt"),this.fontB64=b.load("fonts/bikraplain-64.fnt"),this.technique2D=c.get("shaders/font.cgfx").getTechnique("font"),this.technique2Dparameters=a.createTechniqueParameters({clipSpace:d.v4BuildZero(),alphaRef:0.01,color:d.v4BuildOne()})),!0):!1},render:function(){if(this.hasLoaded()&&0!==this.textToDraw.length){var a=this.globals.mathDevice,b=this.globals.graphicsDevice,c=b.width,d=b.height,f=this.technique2Dparameters;
b.setTechnique(this.technique2D);f.clipSpace=a.v4Build(2/c,-2/d,-1,1,f.clipSpace);for(var c=0,d=this.textToDraw,g=this.textToDraw.length,c=0;c<g;c+=1)a=d[c],a.font&&(f.color=a.color,b.setTechniqueParameters(f),a.font.drawTextRect(a.string,a));this.clearFontList()}},clearFontList:function(){this.textCacheIndex=0;this.textToDraw.length=0},allocateParams:function(){var a=this.textCache[this.textCacheIndex];a||(a=this.globals.mathDevice,a={string:null,spacing:0,alignment:0,valignment:0,color:a.v4BuildOne(),
font:null,pointSize:void 0,scale:0,rect:a.v4BuildOne()},this.textCache.push(a));a.pointSize=void 0;this.textCacheIndex+=1;return a}};gf.create=function(a){var b=new gf;b.globals=a;b.textToDraw=[];b.textCache=[];b.textCacheIndex=0;b.scratchPad={v4Black:a.mathDevice.v4Build(0,0,0,1)};return b};hf.prototype={fitTextToRegion:function(a,b,c){var d=void 0!==c.width?c.width:400,f=void 0!==c.spacing?c.spacing:0,g,e=[],n={};a.calculateFontAndScaleFromInputParams(c,n);a=n.scale;c=n.font;g=c.calculateTextDimensions(b,
a,f);if(g.width<=d)return b;do{var j,i=!0,n=b;do g=c.calculateTextDimensions(n,a,f),j=n.length,g.width>d&&(j=i?n.lastIndexOf(" "):n.length-1,0>=j&&(j=n.length,i=!1)),n=n.substr(0,j),g=c.calculateTextDimensions(n,a,f),g=g.width;while(g>d);e.push(n);b=b.substr(j,b.length)}while(0<b.length);for(d=0;d<e.length;d+=1)b=b+e[d]+"\n";return b=b.slice(0,-1)},format:function(a){var b=arguments;return a.replace(RegExp("%([1-"+(arguments.length-1)+"])","gi"),function(a,d){return b[d]})}};jf.prototype={init:function(a){this.globals=
a;this.initSVG(a);this.loadedSVGMap={}},initSVG:function(a){function b(a,b){for(var c=a.length,d=0;d<c;d+=1){var f=n?a.nextNode():a[d],g=f.name,e=g.indexOf(":"),e=-1!==e?g.slice(0,e):null;"sodipodi"!==e&&("inkscape"!==e&&"xmlns"!==e)&&(b[g]=f.value)}return b}function c(a,c){for(var d=c.length,f=0;f<d;f+=1){var g=c[f];if("stop"===g.tagName){var e=b(g.attributes,{}),g=parseFloat(e.offset),h=e["stop-color"];if(!h){e=e.style;if(!e)return!1;var e=e.replace(/\s+/g,""),n=e.indexOf("stop-color:");-1!==n&&
(h=e.indexOf(";",n),-1===h&&(h=e.length),h=e.slice(n+11,h))}a.addColorStop(g,h)}}return!0}function d(a,b){if("url"===a.slice(0,3)){var c=a.indexOf(")",3);if(-1!==c){var d=a.slice(4,c).replace(/["#]/g,"");if(d=b[d])return d;a=a.slice(c+1);if(!a)return"#000"}else return"#000"}return a}function f(a){return void 0!==a?parseFloat(a):0}function g(a,n){var i=a.tagName,m=[],k=[],p;for(p in a)if(a.hasOwnProperty(p)&&("@"===p[0]&&m.push({name:p.substr(1),value:a[p]}),"#children"===p))for(var s=a[p],t=0;t<s.length;t+=
1)s[t][1].tagName=s[t][0],k.push(s[t][1]);if(!i||"title"===i||"metadata"===i||"sodipodi:namedview"===i||"desc"===i)return null;if("defs"===i){var u=a.children;if(!u)for(var u=[],w=a.firstChild;w;)u[u.length]=w,w=w.nextSibling;var w=u.length,B,y={};for(B=0;B<w;B+=1)if(i=u[B],m=i.attributes)(k=i.getAttribute("id"))&&(y[k]=i);for(B=0;B<w;B+=1)if(i=u[B],m=i.attributes)if(m=b(m,{}),k=m.id)if(p=i.tagName,"linearGradient"===p){if(void 0!==m.x1){p=parseFloat(m.x1);var s=parseFloat(m.y1),t=parseFloat(m.x2),
v=parseFloat(m.y2);p=e.createLinearGradient(p,s,t,v);m=(m=m["xlink:href"])?y[m.slice(1)]:i;i=m.children;if(!i){i=[];for(m=m.firstChild;m;)i[i.length]=m,m=m.nextSibling}c(p,i)&&(n[k]=p)}}else if("radialGradient"===p&&void 0!==m.cx){p=parseFloat(m.cx);var s=parseFloat(m.cy),t=parseFloat(void 0!==m.fx?m.fx:p),v=parseFloat(void 0!==m.fy?m.fy:p),x=parseFloat(m.r);p=e.createRadialGradient(t,v,0,p,s,x);(m=m["xlink:href"])?(m=y[m.slice(1)],i=m.children||m.childNodes):i=i.children||i.childNodes;c(p,i)&&(n[k]=
p)}return null}if("text"===i)return null;p={};m&&b(m,p);if("path"===i){if(i=p.d)i=i.replace(","," ").replace(/\s+/g," ").replace(" -","-").replace(/\s([AaCcHhLlMmQqSsTtVvZz])/g,"$1"),B=new Rj(i)}else if("polygon"===i||"polyline"===i){if(s=p.points){s=s.replace(/\s+/g,",").split(",");B=s.length;for(m=0;m<B;m+=1)s[m]=parseFloat(s[m]);B="polygon"===i?new Sj(s):new Tj(s)}}else"rect"===i?B=new Uj(f(p.x),f(p.y),parseFloat(p.width),parseFloat(p.height)):"circle"===i?B=new Vj(f(p.cx),f(p.cy),parseFloat(p.r)):
"ellipse"===i?B=new Wj(f(p.cx),f(p.cy),parseFloat(p.rx),parseFloat(p.ry)):"line"===i&&(B=new Xj(f(p.x1),f(p.y1),f(p.x2),f(p.y2)));B||(B=new Di);(i=p.id)&&(n[i]=p);if(i=p.style)delete p.style,i=i.replace(/\s+/g,""),m=i.indexOf("fill:"),-1!==m&&(u=i.indexOf(";",m),-1===u&&(u=i.length),u=i.slice(m+5,u)),m=i.indexOf("stroke:"),-1!==m&&(w=i.indexOf(";",m),-1===w&&(w=i.length),w=i.slice(m+7,w)),m=i.indexOf("stroke-width:"),-1!==m&&(y=i.indexOf(";",m),-1===y&&(y=i.length),y=i.slice(m+13,y));p.fill&&(u=p.fill.replace(/\s+/g,
""),delete p.fill);p.stroke&&(w=p.stroke,delete p.stroke);p["stroke-width"]&&(y=p["stroke-width"],delete p["stroke-width"]);s=i=!1;u&&(u=d(u,n),B.setFillStyle(u),i=!0);w&&(w=d(w,n),B.setStrokeStyle(w),i=!0);y&&(i=parseFloat(y),-1!==y.indexOf("pt")?i*=1.25:-1!==y.indexOf("pc")?i*=15:-1!==y.indexOf("cm")?i*=96/2.54:-1!==y.indexOf("mm")?i*=96/25.4:-1!==y.indexOf("in")&&(i*=96),y=i,B.setLineWidth(y),i=!0);if(m=p.transform){delete p.transform;m=m.replace(/\s+/g,"");for(v=m.indexOf("(");-1!==v;){p=m.indexOf(")",
v+1);t=m.slice(v+1,p);t=-1!==t.indexOf(",")?t.split(","):t.split(" ");switch(m.slice(0,v).replace(/\s+/g,"")){case "translate":v=parseFloat(t[0]);t=1<t.length?parseFloat(t[1]):0;if(0!==v||0!==t)B.translate(v,t),s=!0;break;case "scale":v=parseFloat(t[0]);t=1<t.length?parseFloat(t[1]):v;if(1!==v||1!==t)B.scale(v,t),s=!0;break;case "rotate":v=parseFloat(t[0])*(Math.PI/180);0!==v&&(s=1<t.length?parseFloat(t[1]):0,t=2<t.length?parseFloat(t[2]):s,B.rotate(v,s,t),s=!0);break;case "matrix":var s=parseFloat(t[0]),
v=parseFloat(t[1]),x=parseFloat(t[2]),A=parseFloat(t[3]),C=parseFloat(t[4]),t=parseFloat(t[5]);B.transform(s,v,x,A,C,t);s=!0}p+=1;if(p>=m.length)break;","===m[p]&&(p+=1);m=m.slice(p);v=m.indexOf("(")}}if(k){t=k.length;for(m=0;m<t;m+=1)(p=g(k[m],n))&&B.addChild(p)}else for(k=a.firstChild;k;)(p=g(k,n))&&B.addChild(p),k=k.nextSibling;k=B.getNumChildren();if(B instanceof Di){if(0===k)return null;1===k&&!s&&(B=B.getChild(0),i&&(u&&B.setFillStyle(u),w&&B.setStrokeStyle(w),y&&B.setLineWidth(y)))}return B}
var e=a.canvas.getContext("2d"),n=!!window.ActiveXObject&&-1===window.navigator.userAgent.indexOf("MSIE 1");this.loadSVGInternal=function(a,b,c){var d={},f=b.getURL(a);c.request({src:f,onload:function(a,b){if(200===b||0===b){if(a){var c=JSON.parse(a).svg;if(c){var e={};c.tagName="svg";d.svg=g(c,e);var h=d.svg;h.idMap=e;h.findById=function(a){return this.idMap[a]};var j,n;c["@width"]&&c["@height"]?(j=parseFloat(c["@width"]),n=parseFloat(c["@height"])):c["@viewBox"]?(c=c["@viewBox"].split(" "),j=parseFloat(c[2])-
parseFloat(c[0]),n=parseFloat(c[3])-parseFloat(c[1])):h.width&&h.height&&(j=h.width,n=h.height);d.width=j;d.height=n}}}else window.alert('"'+f+'" not found.')}});d.draw=function(a,b,c,f,g,e,h,j){d.svg&&(f*=(this.width*f+j)/(this.width*f),g*=(this.height*g+j)/(this.height*g),a.fillStyle=h,a.rotate(e),a.translate(0.5*-this.width*f,0.5*-this.height*g),a.scale(f,g),a.matrix[2]+=b,a.matrix[5]+=c,d.svg.draw(a))};return d}},getSVG:function(a){this.loadedSVGMap[a]||(this.loadedSVGMap[a]=this.loadSVGInternal(a,
this.globals.mappingTable,this.globals.requestHandler));return this.loadedSVGMap[a]},begin:function(){var a=this.globals.canvas.getContext("2d");this.context2D=a;a.beginFrame();a.fillStyle="#050";a.strokeStyle="none"},end:function(){this.context2D.endFrame();this.context2D=null},draw:function(a){var b=void 0!==a.svg?this.getSVG(a.svg):this.getSVG("img/lion.svg"),c=void 0!==a.scaleX?a.scaleX:void 0!==a.scale?a.scale:1,d=void 0!==a.scaleY?a.scaleY:void 0!==a.scale?a.scale:1,f=void 0!==a.x?a.x:0,g=void 0!==
a.y?a.y:0,e=void 0!==a.angle?a.angle:0,n=void 0!==a.colorString?a.colorString:"#000",a=void 0!==a.border?a.border:0,j=this.context2D;b&&(c&&d)&&(j.save(),b.draw(j,f,g,c,d,e,n,a),j.restore())}};jf.create=function(a){var b=new jf;b.init(a);return b};i.prototype={init:function(a){this.globals=a;this.guiMap={};this.calculateScaleFactor();this.scratchPad={};this.scratchpadRectangleSizes={};this.openRefCount=0},destroy:function(){this.guiMap=null;i.archetypes=null},initArchetype:function(a,b,c,d){this.guiMap[a]=
b;var a=b.instructions,f=a.length,g;b.textInstructionMap={};for(g=0;g<f;g+=1)this.preLoadInstruction(b,a[g],c,d)},SAFE_WIDTH:850,SAFE_HEIGHT:650,preRender:function(){this.calculateScaleFactor()},calculateScaleFactor:function(){var a=this.globals,b=a.graphicsDevice,a=a.mathDevice,c=b.width,b=b.height;this.width=c;this.height=b;this.scaleFactor=Math.min(Math.floor(2*c/this.SAFE_WIDTH)/2,Math.floor(2*b/this.SAFE_HEIGHT)/2);this.scaleFactor=Math.max(this.scaleFactor,0.75);this.scaleFactor=Math.min(this.scaleFactor,
1.25);this.v2ScreenCentre=a.v2Build(c/2,b/2,this.v2ScreenCentre);this.v2ScreenTL=a.v2Build(0,0,this.v2ScreenTL);this.v2ScreenTR=a.v2Build(c,0,this.v2ScreenTR);this.v2ScreenBL=a.v2Build(0,b,this.v2ScreenBL);this.v2ScreenBR=a.v2Build(c,b,this.v2ScreenBR);this.v2ScreenT=a.v2Build(c/2,0,this.v2ScreenT);this.v2ScreenB=a.v2Build(c/2,b,this.v2ScreenB);this.v2ScreenL=a.v2Build(0,b/2,this.v2ScreenL);this.v2ScreenR=a.v2Build(c,b/2,this.v2ScreenR)},getScaleFactor:function(){return this.scaleFactor},getv2RenderLocation:function(a,
b,c,d){var f=this.globals.mathDevice,g=this.v2ScreenCentre;switch(c){case "centre":g=this.v2ScreenCentre;break;case "topLeft":g=this.v2ScreenTL;break;case "topRight":g=this.v2ScreenTR;break;case "bottomLeft":g=this.v2ScreenBL;break;case "bottomRight":g=this.v2ScreenBR;break;case "top":g=this.v2ScreenT;break;case "bottom":g=this.v2ScreenB;break;case "left":g=this.v2ScreenL;break;case "right":g=this.v2ScreenR}d=f.v2Build(a,b,d);return f.v2AddScalarMul(g,d,this.scaleFactor,d)},preload:function(){var a=
this.globals.vectorArtRenderer,b=this.globals.textureManager,c=i.archetypes,d;for(d in c)c.hasOwnProperty(d)&&this.initArchetype(d,c[d],a,b)},getGuiInfo:function(a){return this.guiMap[a]},render:function(a,b){var c=this.getGuiInfo(a);c&&this.renderAllInstructions(c.instructions,b,c)},getScaleFactorFromV2:function(a,b){if(!a)return 0;if(b)return 1;var c=this.globals,d=c.graphicsDevice,f=d.width,d=d.height,g=60*this.getScaleFactor(),e=c.mathDevice,c=e.clamp(a[0],0,f),e=e.clamp(a[1],0,d),n=1;c<g&&(n=
Math.min(c/g,n));e<g&&(n=Math.min(e/g,n));c>f-g&&(n*=Math.min((f-c)/g,n));e>d-g&&(n*=Math.min((d-e)/g,n));return n},renderAllInstructions:function(a,b,c){var d=a.length,f;b._scaleX=1;b._scaleY=1;void 0!==b.scale&&(b._scaleX*=b.scale,b._scaleY*=b.scale);b._scaleX*=void 0!==b.scaleX?b.scaleX:1;b._scaleY*=void 0!==b.scaleY?b.scaleY:1;b._scaleX*=this.scaleFactor;b._scaleY*=this.scaleFactor;var g,e=this.globals;f=e.mathDevice;var e=e.graphicsDevice,n;if(b.v3WorldLocation){g=this.globals.gameManager;g=
g.getGameCamera();g=g.getv2ScreenLocationFromWorld(b.v3WorldLocation,b.allowOffscreen);if(!g)return;b._x=g[0];b._y=g[1];g=this.getScaleFactorFromV2(g,b.allowOffscreen);if(0>=g)return;b._scaleX*=g;b._scaleY*=g;n=40*this.getScaleFactor();g=e.width;e=e.height;b._x=f.clamp(b._x,n,g-n);b._y=f.clamp(b._y,n,e-n)}else b.v2ScreenLocation?(b._x=b.v2ScreenLocation[0],b._y=b.v2ScreenLocation[1]):(b._x=void 0!==b.x?b.x:0,b._y=void 0!==b.y?b.y:0);b._angle=void 0!==b.angle?b.angle:0;b._randomAngle=void 0!==b.randomAngle?
b.randomAngle:0;void 0!==b.scale1&&(b._scale1=b.scale1*this.scaleFactor);void 0!==b.scale2&&(b._scale2=b.scale2*this.scaleFactor);f=this.globals.appCurrentTime;b._wonkSinX=Math.sin(12*b._x/this.width*Math.PI);b._wonkSinY=Math.sin(12*b._y/this.height*Math.PI);b._wobbleSinX=Math.sin(12*b._x/this.width*Math.PI+0.75*f);b._wobbleSinY=Math.sin(12*b._y/this.height*Math.PI+1.5*f);e=this.globals.gameCurrentTime;g=this.globals.gameTimeStep;0<this.shakeAmount&&0<g&&(b._shakeSinX=Math.sin(6*b._x/this.width*Math.PI+
16*e),b._shakeSinY=Math.sin(6*b._y/this.height*Math.PI+16*e),this.applyShake({amount:this.shakeAmount},b));b._appCurrentTime=f;for(f=0;f<d;f+=1)this.renderInstruction(a[f],b,c)},applyWonk:function(a,b){b._angle+=0.025*b._wonkSinX*b._wonkSinY},applyShake:function(a,b){var c=a.amount||1,c=c*this.scaleFactor;b._x+=5*c*b._shakeSinX;b._y+=5*c*b._shakeSinY;b._angle+=0.025*b._shakeSinX*b._shakeSinY},applyWobble:function(a,b){var c=a.amount||1,c=c*this.scaleFactor;b._x+=c*b._wobbleSinX;b._y+=c*b._wobbleSinY;
b._angle+=0.025*b._wobbleSinX*b._wobbleSinY},applyPulseScale:function(a,b){var c=a.amplitudeDiff*this.scaleFactor,d=Math.sin(b._appCurrentTime*2*Math.PI*a.frequency);b._scaleX*=1+c*d;b._scaleY*=1+c*d},preLoadInstruction:function(a,b,c,d){var f=this;void 0!==b.svgPath&&c.getSVG(b.svgPath);void 0!==b.spritePath&&d.load(b.spritePath);"setRenderLocation"===b.command&&(a.getRenderLocationFn=function(){return f.getv2RenderLocation(b.x,b.y,b.locationName)});void 0!==b.text&&(a.textInstructionMap[b.text]=
b)},renderInstruction:function(a,b,c){this[a.command](a,b,c)},renderWidget:function(a,b){var c=i.archetypes[a.name],d,f=c.instructions;for(d=0;d<f.length;d+=1)this.renderInstruction(f[d],b,c)},renderSVG:function(a,b){var c=this.globals.vectorArtRenderer,d,f;switch(a.scaleX){case "scale1":d=b._scale1;break;case "scale2":d=b._scale2;break;default:d=b._scaleX}switch(a.scaleY){case "scale1":f=b._scale1;break;case "scale2":f=b._scale2;break;default:f=b._scaleY}void 0!==a.scale&&(d*=a.scale,f*=a.scale);
"number"===typeof a.scaleX&&(d*=a.scaleX);"number"===typeof a.scaleY&&(f*=a.scaleY);var g=0,e=0;if(void 0!==a.alignX&&b._scaleX){var n=c.getSVG(a.svgPath).width*b._scaleX,j=n*(d/this.scaleFactor);d*=b._scaleX/this.scaleFactor;0===a.alignX?g=+(0.5*(j-n)):2===a.alignX&&(g=-(0.5*(j-n)))}void 0!==a.alignY&&b._scaleY&&(n=c.getSVG(a.svgPath).height*b._scaleY,j=n*(f/this.scaleFactor),f*=b._scaleY/this.scaleFactor,0===a.alignY?e=-(0.5*(j-n)):2===a.alignY&&(e=+(0.5*(j-n))));c.draw({svg:a.svgPathVar?b[a.svgPathVar]:
a.svgPath,x:b._x+g,y:b._y+e,colorString:a.colorString,border:a.border,scaleX:d,scaleY:f,angle:b._angle})},renderBarSVG:function(a,b){var c=this.globals.vectorArtRenderer,d=b._scaleX,f=b._scaleY;void 0!==a.scale&&(d*=a.scale,f*=a.scale);var g=c.getSVG(a.svgPath).width,e=void 0!==a.align?a.align:0,n=0;void 0!==e&&1!==e&&(0===e&&(n=-0.5*(1-b.completeFactor)*g*d),2===e&&(n=0.5*(1-b.completeFactor)*g*d));c.draw({svg:a.svgPath,x:b._x+n,y:b._y,colorString:a.colorString,border:a.border,scaleX:b.completeFactor*
d,scaleY:f,angle:b._angle})},renderSprite:function(a,b){var c=this.globals,d=c.textureManager.get(a.spritePathVar?b[a.spritePathVar]:a.spritePath);if(d){var f=d.width,g=d.height,e=1,n=1;switch(a.scaleX){case "scale1":e=b._scale1;break;case "scale2":e=b._scale2;break;default:e=b._scaleX}switch(a.scaleY){case "scale1":n=b._scale1;break;case "scale2":n=b._scale2;break;default:n=b._scaleY}void 0!==a.scale&&(e*=a.scale,n*=a.scale);"number"===typeof a.scaleX&&(e*=a.scaleX);"number"===typeof a.scaleY&&(n*=
a.scaleY);var j=0,i=0;void 0!==a.alignX&&(0===a.alignX?j=+(0.5*f*(e-1)):2===a.alignX&&(j=-(0.5*f*(e-1))));void 0!==a.alignY&&(0===a.alignY?i=+(0.5*g*(n-1)):2===a.alignY&&(i=-(0.5*g*(n-1))));c=c.canvas.getContext("2d");f*=e;g*=n;j=b._x+j;i=b._y+i;c.save();c.translate(j,i);c.rotate(b._angle);c.drawImage(d,-f/2,-g/2,f,g);c.restore()}},getTextInfo:function(a,b){var c=this.globals.simpleFontRenderer,d=void 0!==a.pointSize?a.pointSize:16,f=b._scaleX,g=b.text;a.text&&(g=b[a.text],g||(g=a.text));if(g){a.upperCase&&
(g=g.toUpperCase());var e=void 0!==a.align?a.align:1,n;a.boxWidth&&a.boxHeight&&(n={width:a.boxWidth*f,height:a.boxHeight*f,pointSize:d,specialScale:f,fontStyle:a.font},g=hf.prototype.fitTextToRegion(c,g,n));return{text:g,info:{x:b._x,y:b._y,alignment:e,pointSize:d,specialScale:f,color:a.color?a.color:k.words,fontStyle:a.font}}}},renderText:function(a,b){var c=this.globals.simpleFontRenderer,d=this.getTextInfo(a,b);6<d.info.pointSize*d.info.specialScale&&c.drawFont(d.text,d.info)},applyTextScale:function(a,
b,c){var d=c.textInstructionMap[a.text];d&&(c=this.globals.simpleFontRenderer,d=this.getTextInfo(d,b),c=this.scratchpadRectangleSizes[a.text]=c.getRectangleDimensions(d.text,d.info),0<c.width&&a.textBoxWidth&&(b._scaleX*=c.width/(a.textBoxWidth*this.scaleFactor)),0<c.height&&a.textBoxHeight&&(b._scaleY*=c.height/(a.textBoxHeight*this.scaleFactor)))},unApplyTextScale:function(a,b){var c=this.scratchpadRectangleSizes[a.text];c&&(0<c.width&&a.textBoxWidth&&(b._scaleX*=a.textBoxWidth*this.scaleFactor/
c.width),0<c.height&&a.textBoxHeight&&(b._scaleY*=a.textBoxHeight*this.scaleFactor/c.height))},applyScale:function(a,b){b._scaleX*=void 0!==a.scaleX?a.scaleX:a.scale;b._scaleY*=void 0!==a.scaleY?a.scaleY:a.scale},applySpinRotate:function(a,b){b._angle+=a.angle*b._appCurrentTime},applyRandomRotate:function(a,b){b._angle+=(void 0!==a.factor?a.factor:1)*(void 0!==b._randomAngle?b._randomAngle:1)},applyRotateFromCentre:function(a,b){var c=this.scratchPad;c.renderLocation=this.getv2RenderLocation(0,0,
"centre",c.renderLocation);b._angle+=(void 0!==a.factor?a.factor:1)*Math.atan2(b._x-c.renderLocation[0],-b._y+c.renderLocation[1])},applyRotate:function(a,b){b._angle+=a.angle},applyCompleteRotate:function(a,b){b._angle+=b.completeFactor*a.angle},offsetCentre:function(a,b){a.x&&(b._x+=a.x*b._scaleX);a.y&&(b._y+=a.y*b._scaleY)},setRenderLocation:function(a,b){var c=this.scratchPad;c.renderLocation=this.getv2RenderLocation(a.x,a.y,a.locationName,c.renderLocation);b._x=c.renderLocation[0];b._y=c.renderLocation[1]},
flush:function(){var a=this.globals,b=a.simpleFontRenderer,a=a.vectorArtRenderer;a.end();a.begin();b.render()},begin:function(){0===this.openRefCount&&this.globals.vectorArtRenderer.begin();this.openRefCount+=1},end:function(){if(1===this.openRefCount){var a=this.globals,b=a.simpleFontRenderer;a.vectorArtRenderer.end();b.render()}this.openRefCount-=1},addShake:function(a,b){var c=this;G.Create({shake:a}).to({shake:0},b).easing(G.Easing.Linear.None).onUpdate(function(){c.shakeAmount=Math.max(this.shake,
c.shakeAmount)}).start()},clearShakeAmount:function(){this.shakeAmount=0}};i.archetypes={};i.create=function(a){var b=new i;b.init(a);return b};kf.prototype={destroy:function(){for(var a in this)this.hasOwnProperty(a)&&(this[a]&&(this[a].destroy&&"function"===typeof this[a].destroy)&&this[a].destroy(),this[a]=null)}};kf.create=function(){var a=new kf;a.allowCheats=!1;a.allowResetKey=!1;a.profileCheats=!1;a.enableEditor=!1;a.cheats={godMode:!1,invisibleMode:!1,grindless:!1};a.debugDrawFlags={gameTime:ea.drawPlayDuration,
warInfo:!1,taskInfo:!1,requestCount:!1,gameSpaces:ea.debugDrawGameSpaces||!1,entityNames:!1,entitySmartPointers:!1,defenceRating:!1,physics:!1,nonBuildZones:!1,controller:!1,scene:!0,sceneTransforms:!1,sceneNodeHierarchy:!1,sceneRenderableExtents:!1,sceneDynamicNodesAABB:!1,sceneStaticNodesAABB:!1,sceneLights:!1,sceneLightExtents:!1,shadowMap1:!1,shadowMap2:!1,simpleSprites:!0,ui:!0,timeGPURendering:!1,camera:!1,navGridHeroWeighted:!1,navGridEnemyWeighted:!1,heroRefCountGrid:!1,enemyRefCountGrid:!1,
heightGrid:!1,gameGrid:!1,nav:!1,gui:!1};ea.debugEnableWireframe&&(a.debugDrawFlags.sceneWireframe=!1);a.debugDrawUIGroup=null;a.graphicsDevice=null;a.mathDevice=null;a.canvas=null;a.inputDevice=null;a.physicsDevice=null;a.soundDevice=null;a.mappingTable=null;a.canvas=null;a.canvasContext=null;a.requestHandler=null;a.gameSession=null;a.textureManager=null;a.soundManager=null;a.shaderManager=null;a.effectManager=null;a.leaderboardManager=null;a.userDataManager=null;a.storeManager=null;a.renderer=null;
a.scene=null;a.sceneLoader=null;a.simpleSceneLoader=null;a.simpleFontRenderer=null;a.simpleSpriteRenderer=null;a.vectorArtRenderer=null;a.guiRenderer=null;a.debugDraw=null;a.camera=null;a.gameCurrentTime=null;a.gameTimeStep=null;a.physTimeStep=null;a.gameAppTimeStep=null;a.appCurrentTime=null;a.appTimeStep=null;a.appFPS=null;a.isHost=!1;a.gameManager=null;a.metricsManager=null;a.gameBadgeManager=null;a.gamePurchaseManager=null;a.console=null;a.dynamicUI=null;a.draw2D=null;a.performanceTimer=null;
a.clearColor=[0,0,0,1];a.settings={volume:1,shadows:!0};return a};ni.prototype={version:1,setSelectedRadio:function(a,b){var c=this.radioControls[a],d;if(c&&(d=c.controls[b]))c.selected=b,this.updateRadio(d.id,!0)},addRadioControl:function(a){var b=this.radioControls,c=a.groupName,d=a.radioIndex,f=a.id,g=a.fn,e=a.isDefault;void 0===c||(null===c||0>d||void 0===f||null===f||void 0===g||null===g)||(g=b[c],g||(b[c]={},g=b[c],g.controls=[],g.selected=0),g.controls[d]=a,e&&(g.selected=d),this.updateRadio(f,
e))},addCheckboxControl:function(a){var b=a.id;this.checkboxControls[a.value]=a;this.updateCheckbox(b,a.isSelected)},addButtonControl:function(a){this.buttonControls[a.id]=a},addSliderControl:function(a){this.sliderControls[a.id]=a},getSliderValue:function(a){if(a=window.$("#"+a).value)return parseInt(a,10)},getHandler:function(){var a=this.radioControls,b=this.checkboxControls,c=this.buttonControls;return function(d){var f;d||(d=window.event);d.target?f=d.target:d.srcElement&&(f=d.srcElement);3===
f.nodeType&&(f=f.parentNode);d=f.id;switch(f.type){case "radio":for(var g in a)if(a.hasOwnProperty(g))for(var e=0,n=a[g].controls,j=n.length;e<j;){f=n[e];if(f.id===d){f.fn();return}e+=1}break;case "checkbox":for(e in b)if(b.hasOwnProperty(e)&&(f=b[e],f.id===d)){g=f.fn();void 0!==g&&(document.getElementById(f.id).checked=g?"checked":"");return}break;case "button":for(n in c)if(c.hasOwnProperty(n)&&(f=c[n],n===d)){f.fn();break}}}},register:function(){function a(a){return function(b,c){var d=window.$("#"+
a+"input");d.val(c.value);d.change()}}function b(a,b){return function(){var c=parseFloat(this.value,10);if(window.$){var d=$("#"+b),f=$("#"+b+"input");if(d&&f){var g=d.slider("value");c&&(g&&g!==c)&&(g=d.slider("option","min"),d=d.slider("option","max"),c<g?c=g:c>d&&(c=d),f.val(c),a.value=c,a.fn())}}}}var c=this.radioControls,d=this.checkboxControls,f=this.buttonControls,g=this.sliderControls,e,n,j;for(j in c)if(c.hasOwnProperty(j))for(var i=c[j].selected,l=c[j].controls,m=l.length,k=0;k<m;k+=1)if(e=
l[k],n=e.id,n=document.getElementById(n))n.value=e.value,n.name=e.groupName,n.onclick=this.getHandler(),n.checked=i===e.radioIndex?"checked":"";for(var p in d)if(d.hasOwnProperty(p)&&(e=d[p],n=e.id,n=document.getElementById(n)))n.value=e.value,n.onclick=this.getHandler(),n.checked=e.isSelected?"checked":"";for(var s in f)if(f.hasOwnProperty(s)&&(e=f[s],n=s,n=document.getElementById(n)))n.value=e.value,n.onclick=this.getHandler();for(var t in g)if(g.hasOwnProperty(t)){e=g[t];n=e.id;if(!window.$)return;
c=$("#"+n);d=$("#"+n+"input");if(!c||!d)return;c.slider({value:e.value,min:e.min,max:e.max,step:e.step,slide:a(n)});d.val(c.slider("value"));d.change(b(e,n))}this.registered=!0},updateRadio:function(a,b){if(this.registered){var c=document.getElementById(a);c&&(c.checked=b?"checked":"")}},updateCheckbox:function(a,b){if(this.registered){var c=document.getElementById(a);c&&(c.checked=b?"checked":"")}},updateSlider:function(a,b){if(this.registered&&window.$){var c=$("#"+a);c&&c.slider("option","value",
b)}}};ni.create=function(){var a=new ni;a.radioControls={};a.checkboxControls={};a.buttonControls={};a.sliderControls={};a.registered=!1;return a};lf.prototype={captureGraphicsDevice:function(a){this.captureGraphicsDevice=ha.create(a);this.frameIndex=0;this.xhrPool=[];return this.captureGraphicsDevice},updateTime:function(){TurbulenzEngine.time=(this.frameIndex+this.captureGraphicsDevice.frames.length)*(1/60)},endFrame:function(){var a=this.captureGraphicsDevice;if(a.frames&&60<=a.frames.length){var b=
"-"+this.frameIndex+"-"+(this.frameIndex+a.frames.length-1);this.frameIndex+=a.frames.length;this.postData("/local/v1/save/playback/capture/frames"+b+".json",a.getFramesString());this.postData("/local/v1/save/playback/capture/data"+b+".bin",a.getDataBuffer());this.postData("/local/v1/save/playback/capture/resources"+b+".json",encodeURIComponent(a.getResourcesString()));a.reset();3600<=this.frameIndex&&a.destroy()}},postData:function(a,b){var c=this,d;d=0===this.xhrPool.length?window.XMLHttpRequest?
new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP"):this.xhrPool.pop();d.open("POST",a,!0);d.onreadystatechange=function(){4===d.readyState&&(d.onreadystatechange=null,c.xhrPool.push(d))};d.send("content="+b)}};lf.create=function(){return new lf};mf.prototype={gameSettings:{maxPlayers:1},errorCallback:function(){},init:function(){this.requestHandler=cc.create({});this.createGameSession(this.initWithGameSession.bind(this),this.errorCallback.bind(this))},createGameSession:function(a,
b){this.gameSession=wa.createGameSession(this.requestHandler,a,b);this.globals.gameSession=this.gameSession},initWithGameSession:function(){var a=this.globals,b=Ff.create(this.globals);a.metricsManager=b;b.sendMetric("gameSessionCreated",1,!1);if(this.useLoadingBar){this.assetTracker=Zb.create(1E3,!1);var c=this.requestHandler;c.handlers.eventOnRequestMade=[];var d=c.request;c.request=function(a){d.call(c,a);c.sendEventToHandlers(c.handlers.eventOnRequestMade,{eventType:"eventOnRequestMade",name:a.src})};
c.addEventListener("eventOnRequestMade",this.onAssetRequestBound);c.addEventListener("eventOnload",this.assetTracker.eventOnLoadHandler)}this.createGlobals()&&(b.sendMetric("globalsInitialised",1,!1),this.hasShaderSupport()?(b.sendMetric("hasShaderSupport",1,!1),this.enterCallbackChain(this,[{func:this.createMappingTable,isDependent:!1},{func:this.assignMappingTable,isDependent:!0,noCallback:!0},{func:this.createUserDataManager,isDependent:!0,noCallback:!0},{func:this.createStoreManager,isDependent:!0,
noCallback:!0},{func:this.createUserProfile,isDependent:!1},{func:this.createLeaderboardManager,isDependent:!0},{func:this.createBadgeManager,isDependent:!1,noCallback:!0},{func:this.createNotificationsManager,isDependent:!1,noCallback:!0},{func:this.createGlobalSettingSliders,isDependent:!0,noCallback:!0},{func:this.createRenderer,isDependent:!0,noCallback:!0},{func:this.createMultiplayerManager,isDependent:!0,noCallback:!0},{func:this.createGame,isDependent:!0,noCallback:!0},{func:this.beginMultiplayer,
isDependent:!0},{func:this.enterLoadingLoop,isDependent:!0}])):b.sendMetric("hasShaderSupport",0,!1))},update:function(){var a=this.globals,b=a.graphicsDevice,c=a.camera,d=a.scene;ea.enableRecording&&a.playbackRecorder.updateTime();a.appCurrentTime=TurbulenzEngine.time;b=b.width/b.height;b!==c.aspectRatio&&(c.aspectRatio=b,c.updateProjectionMatrix());a.inputDevice.update();a.networkDevice.update();this.updateGame();d.update();a.soundDevice&&a.soundDevice.update()},updateGame:function(){var a=this.globals.isHost,
b=this.protoGame;b.setProfileECs(this.debugUpdate);b.update(a);this.multiplayerManager.update(b,a)},drawExtraDecals:function(){},drawExtraTransparent:function(){this.globals.debugDrawFlags.simpleSprites&&this.globals.simpleSpriteRenderer.drawSprites()},drawDebug:function(){var a=this.globals,b=a.camera,c=a.debugDrawFlags,d=a.graphicsDevice,f=a.scene;a.debugDraw.drawDebugLines();c.sceneTransforms&&f.drawTransforms(d,a.shaderManager,b,2);c.sceneNodeHierarchy&&f.drawSceneNodeHierarchy(d,a.shaderManager,
b);c.sceneRenderableExtents&&f.drawVisibleRenderablesExtents(d,a.shaderManager,b);c.sceneWireframe&&(f.debugWireFrameInfo||(f.debugWireFrameInfo={wireColor:[1,0,0,1],fillColor:[0,0,0,0],alphaRef:0.5}),f.drawWireframe(d,a.shaderManager,b,f.debugWireFrameInfo));var g;if(c.sceneDynamicNodesAABB)for(g=0;8>g;g+=1)f.drawDynamicNodesTree(d,a.shaderManager,b,g);if(c.sceneStaticNodesAABB)for(g=0;8>g;g+=1)f.drawStaticNodesTree(d,a.shaderManager,b,g);c.sceneLights&&f.drawLights(d,a.shaderManager,b);c.sceneLightExtents&&
f.drawLightsExtents(d,a.shaderManager,b)},render:function(){var a=this.globals,b=a.graphicsDevice,c=a.camera,d=a.renderer,f=a.scene,g=a.debugDrawFlags,e=a.canvas,n=a.postEffects,j=a.clearColor;if(b.beginFrame()){a.guiRenderer.preRender();this.protoGame.draw();e.width!==b.width&&(e.width=b.width);e.height!==b.height&&(e.height=b.height);var i,l,m=this.renderBufferCopyOperationOverride||this.renderBufferCopyOperation;this.useRenderBuffer?(e=1<<this.log2RenderBufferWidth,i=1<<this.log2RenderBufferHeight,
l=n.getEffectSetupCB(m)):(e=b.width,i=b.height);d&&d.updateBuffers(b,e,i)&&(this.globals.polycraftRender&&this.globals.polycraftRender.updateFX(),ma.start("Render - update scene"),d.update(b,c,f,a.appCurrentTime),ma.stop("Render - update scene"),g.scene&&a.gameManager.getSceneReadyToRender()?(ma.start("Render - draw scene"),d.draw(b,j,this.drawExtraDecalsCallback,this.drawExtraTransparentCallback,this.drawDebugCallback,l),ma.stop("Render - draw scene")):(b.clear(j),this.drawExtraDecalsCallback(),
this.drawExtraTransparentCallback(),this.drawDebugCallback()));this.globals.allowCheats&&this.drawCheatText();this.globals.allowResetKey&&this.drawResetText();g.ui&&(ma.start("Render - UI"),a.simpleFontRenderer.render(),this.protoGame.draw2D(),ma.stop("Render - UI"));this.drawUI();a.simpleFontRenderer.render();g.shadowMap1?a.gameManager.gameLighting.drawShadowMap(1):g.shadowMap2&&a.gameManager.gameLighting.drawShadowMap(2);b.endFrame()}ea.enableRecording&&a.playbackRecorder.endFrame();this.updateGPUTiming()},
hasUILoaded:function(){return this.globals.simpleFontRenderer.hasLoaded()},updateGPUTiming:function(){var a=this.globals,b=a.graphicsDevice.gl;b&&a.debugDrawFlags.timeGPURendering&&(a=TurbulenzEngine.time,b.flush(),b.finish(),this.GPURenderingDuration=TurbulenzEngine.time-a)},drawDebugText:function(){var a=this.globals;a.simpleFontRenderer.drawFontDouble("DEBUG MODE ON",{x:10,y:a.graphicsDevice.height-1.5*this.lineStep,pointSize:16,alignment:0})},drawCheatText:function(){var a=this.globals;a.simpleFontRenderer.drawFontDouble("CHEATS ENABLED",
{x:10,y:a.graphicsDevice.height-2.5*this.lineStep,pointSize:16,alignment:0})},drawResetText:function(){var a=this.globals;a.simpleFontRenderer.drawFontDouble("RESET KEY (del) ENABLED",{x:10,y:a.graphicsDevice.height-3.5*this.lineStep,pointSize:16,alignment:0})},drawUI:function(){var a=this.globals,b=a.mathDevice,c=a.simpleFontRenderer,d=a.graphicsDevice,f=this.multiplayerManager,g=0,a=this.lineStep,e={x:d.width-10,y:d.height-1.5*a,pointSize:16,alignment:2},n=this.logs,j=TurbulenzEngine.time;if(this.debugMessages){var i=
ma.getStoredAverageTime("Render - Main"),l=(1E3*i).toFixed(2),g=ma.getStoredAverageTime("Update - Main"),m=(1E3*g).toFixed(2),k=d.fps.toFixed(0)+" FPS",k=k+(" / "+(1E3/d.fps).toFixed(2)+"ms");e.color=b.v4Lerp(b.v4BuildOne(),b.v4Build(1,0,0,1),b.saturate(b.getFactor(this.fps,this.fps-5,d.fps)));c.drawFontDouble(k,e);b.v4BuildOne(e.color);e.y-=a;d=l+"ms (render)";e.color=b.v4Lerp(b.v4BuildOne(),b.v4Build(1,0,0,1),b.saturate(b.getFactor(this.goodRenderUpdateTime,this.badRenderUpdateTime,i)));c.drawFontDouble(d,
e);b.v4BuildOne(e.color);e.y-=a;d=m+"ms (update)";e.color=b.v4Lerp(b.v4BuildOne(),b.v4Build(1,0,0,1),b.saturate(b.getFactor(this.goodRenderUpdateTime,this.badRenderUpdateTime,g)));c.drawFontDouble(d,e);b.v4BuildOne(e.color);e.y-=a;c.drawFontDouble("Version "+this.version,e);e.y-=a;this.multiplayerManager.connecting?c.drawFontDouble("Connecting ...",e):this.multiplayerManager.connected?void 0!==this.multiplayerManager.connectedPlayerIndex&&(this.globals.isHost?c.drawFontDouble("Host, ID "+this.multiplayerManager.playerIndex+
".",e):c.drawFontDouble("Client, ID "+this.multiplayerManager.playerIndex+".",e)):c.drawFontDouble("Playing Solo",e);e.y-=a;c.drawFontDouble(""+f.getOutgoingMessageLength()+" Outgoing Message Length.",e);e.y-=a;if(void 0!==this.logs)for(g=this.logs.length-1;0<=g;g-=1)b=n[g],d=j-b.time,10<d?n.splice(g,1):(f=Math.min(2*d,1),f=Math.min(f,Math.min(2*(10-d),1)),f=Math.max(f,0.01),e.scale=0.5*f,e.y-=a*f,c.drawFontDouble(b.string,e));c=e.x;this.debugUpdate&&(c-=300,this.drawUIUpdate(c));this.debugRender&&
(c-=300,this.drawUIRender(c));this.debugNav&&(c-=300,this.drawUINav(c));this.debugPostRequests&&(c-=300,this.drawUIPostRequest(c));this.debugMonitorData&&this.drawUIMonitorData(c-300)}},drawUIUpdate:function(a){var b=this.globals,c=b.mathDevice,d=b.simpleFontRenderer,f=this.lineStep,a={x:a-10,y:b.graphicsDevice.height-1.5*f,pointSize:16,alignment:2},b=1E3*ma.getStoredAverageTime("Update - Game"),g=b.toFixed(2)+"ms (update)";a.color=c.v4Lerp(c.v4BuildOne(),c.v4Build(1,0,0,1),c.saturate(c.getFactor(this.goodRenderUpdateTime,
this.badRenderUpdateTime,b)));d.drawFontDouble(g,a);c.v4BuildOne(a.color);a.y-=f;b=ma.getStoredCallCount("Update - Game");g=ma.getStoredCallCount("Update - Main");g=Math.round(b/g)+" update(s) per frame";c.v4BuildOne(a.color);d.drawFontDouble(g,a);a.y-=2*f;var g=F.prototype.eCCreationMap,e,n,j;for(e in g)g.hasOwnProperty(e)&&(j="Update - "+e,n=Math.floor(ma.getStoredCallCount(j)/b),j=1E3*ma.getStoredDuration(j)/b,0<n?a.color=c.v4Lerp(c.v4BuildOne(),c.v4Build(1,0,0,1),c.saturate(c.getFactor(0,1,j))):
c.v4Build(0.25,0.25,0.25,1,a.color),d.drawFontDouble(e+" ("+n+") "+j.toFixed(2)+" ms",a),c.v4BuildOne(a.color),a.y=0<n?a.y-f:a.y-0.5*f);d.drawFontDouble("Off Screen Entities - "+(1E3*ma.getStoredAverageTime("Update - Off Screen Entities")).toFixed(2)+"ms",a);a.y-=f;d.drawFontDouble("On Screen Entities - "+(1E3*ma.getStoredAverageTime("Update - On Screen Entities")).toFixed(2)+"ms",a);a.y-=f;d.drawFontDouble("Entities - "+(1E3*ma.getStoredAverageTime("Update - Entities")).toFixed(2)+"ms",a);a.y-=f;
d.drawFontDouble("Physics - "+(1E3*ma.getStoredAverageTime("Update - Physics")).toFixed(2)+"ms",a);a.y-=f;1===this.activeEntityCount?d.drawFontDouble(""+this.protoGame.activeEntityCount+" Entity Processed Per Frame.",a):d.drawFontDouble(""+this.protoGame.activeEntityCount+" Entities Processed Per Frame.",a);a.y-=f;1===this.protoGame.activeSpaceCount?d.drawFontDouble(""+this.protoGame.activeSpaceCount+" Space Processed Per Frame.",a):d.drawFontDouble(""+this.protoGame.activeSpaceCount+" Spaces Processed Per Frame.",
a);a.y-=f},drawUIRender:function(a){var b=this.globals,c=b.mathDevice,d=b.simpleFontRenderer,f=b.graphicsDevice,g=this.lineStep,a={x:a-10,y:f.height-1.5*g,pointSize:16,alignment:2},e=1E3*ma.getStoredAverageTime("Render - Main"),n=e.toFixed(2)+"ms (render)";a.color=c.v4Lerp(c.v4BuildOne(),c.v4Build(1,0,0,1),c.saturate(c.getFactor(this.goodRenderUpdateTime,this.badRenderUpdateTime,e)));d.drawFontDouble(n,a);c.v4BuildOne(a.color);a.y-=g;e=1E3*ma.getStoredAverageTime("Render - update scene");n=e.toFixed(2)+
"ms (update scene)";d.drawFontDouble(n,a);a.y-=g;e=1E3*ma.getStoredAverageTime("Render - draw scene");n=e.toFixed(2)+"ms (draw scene)";d.drawFontDouble(n,a);a.y-=g;e=1E3*ma.getStoredAverageTime("Render - UI");n=e.toFixed(2)+"ms (UI)";d.drawFontDouble(n,a);a.y-=g;d.drawFontDouble("Draw Entities - "+(1E3*ma.getStoredAverageTime("Draw - Entities")).toFixed(2)+"ms",a);a.y-=g;var c=b.simpleSceneLoader.getNumberOfUniqueMeshes(),e=b.simpleSceneLoader.getNumberOfNodes(),n=b.scene.visibleNodes.length,j=b.scene.visibleRenderables.length,
i=b.scene.visibleLights.length;d.drawFontDouble(c+" unique meshes",a);a.y-=g;d.drawFontDouble(e+" created nodes",a);a.y-=g;d.drawFontDouble(i+" visible lights",a);a.y-=g;d.drawFontDouble(j+" visible renderables",a);a.y-=g;d.drawFontDouble(n+" visible nodes",a);a.y-=g;c=b.scene.getVisibilityMetrics();d.drawFontDouble(c.numOccluders+" occulders",a);a.y-=g;if(f=f.metrics)d.drawFontDouble(f.renderTargetChanges+" renderTargetChanges",a),a.y-=g,d.drawFontDouble(f.textureChanges+" textureChanges",a),a.y-=
g,d.drawFontDouble(f.renderStateChanges+" renderStateChanges",a),a.y-=g,d.drawFontDouble(f.vertexBufferChanges+" vertexBufferChanges",a),a.y-=g,d.drawFontDouble(f.indexBufferChanges+" indexBufferChanges",a),a.y-=g,d.drawFontDouble(f.techniqueChanges+" techniqueChanges",a),a.y-=g,d.drawFontDouble(f.drawCalls+" drawCalls",a),a.y-=g,d.drawFontDouble(f.primitives+" primitives",a),a.y-=g;b.debugDrawFlags.timeGPURendering&&void 0!==this.GPURenderingDuration&&(d.drawFontDouble((1E3*this.GPURenderingDuration).toFixed(2)+
" (ms) gl.finish",a),a.y-=g)},drawUINav:function(a){var b=this.globals,c=b.simpleFontRenderer,d=this.lineStep,a={x:a-10,y:b.graphicsDevice.height-25,pointSize:16,alignment:2,color:b.mathDevice.v4BuildOne()},b=ma.getStoredCallCount("Update - Game"),f=ma.getStoredDuration("navManagerGetV3ToV3PathFn"),g="Pathing Queries Per Frame: "+(ma.getStoredCallCount("navManagerGetV3ToV3PathFn")/b).toFixed(2);c.drawFontDouble(g,a);a.y-=d;g="Query Period: "+this.protoGame.getNavManager().getPathQueryPeriod().toFixed(2)+
"s";c.drawFontDouble(g,a);a.y-=d;a.y-=d;b="Nav Time Per Frame: "+(1E3*f/b).toFixed(2)+"ms";c.drawFontDouble(b,a);a.y-=d},drawUIPostRequest:function(a){var b=this.globals,c=b.simpleFontRenderer,d=b.mathDevice,f=b.gameManager,g=this.lineStep,a={x:a-10,y:b.graphicsDevice.height-25,pointSize:16,alignment:2,color:d.v4BuildOne()},e=0;if(f.playerData){var n=f.playerData.getNumberOfRequests(),e=e+n;c.drawFontDouble("PlayerData Saving: "+n,a);a.y-=g}n=f.getNumberOfLeaderboardRequests();e+=n;c.drawFontDouble("Leaderboard Setting: "+
n,a);a.y-=g;n=b.gameBadgeManager.getNumberOfBadgeRequests();e+=n;c.drawFontDouble("Badge Setting: "+n,a);a.y-=g;n=b.metricsManager.getNumberOfMetricsRequests();e+=n;c.drawFontDouble("Metrics: "+n,a);a.y-=g;f=f.numberOfLevelSaveRequests;e+=f;c.drawFontDouble("Level Saving: "+f,a);a.y-=g;c.drawFontDouble("Total Requests: "+e,a);a.y-=g;b=e/b.gameCurrentTime;f="Requests Per Second: "+b.toFixed(2)+"/s";a.color=d.v4Lerp(d.v4BuildOne(),d.v4Build(1,0,0,1),d.saturate(d.getFactor(0.75,1,b)));c.drawFontDouble(f,
a);a.y-=g},drawUIMonitorData:function(a){var b=this.globals,c=b.simpleFontRenderer,d=b.mathDevice,f=b.graphicsDevice.height;if(b=b.gameManager.gameMonitor){var g=this.lineStep,a={x:a-10,y:f-25,pointSize:16,alignment:2,color:d.v4BuildOne()},d=b.data.gathered,f="Hero Resource Gathered [L,S]: "+d.hero;c.drawFontDouble(f,a);a.y-=g;f="Wildling Resource Gathered [L,S]: "+d.wildlings[E.LUMBER].toFixed(1)+", "+d.wildlings[E.STONE].toFixed(1);c.drawFontDouble(f,a);a.y-=g;f="Wildling Average Gathered / min [L,S]: "+
b.getAverageGathered(E.LUMBER).toFixed(1)+", "+b.getAverageGathered(E.STONE).toFixed(1);c.drawFontDouble(f,a);a.y-=g;d=b.data.deposited;f="Hero Resource Deposited [L,S]: "+d.hero;c.drawFontDouble(f,a);a.y-=g;f="Wildling Resource Deposited [L,S]: "+d.wildlings;c.drawFontDouble(f,a);a.y-=g;f="Wildling Average Deposited / min [L,S]: "+b.getAverageDeposited(E.LUMBER).toFixed(1)+", "+b.getAverageDeposited(E.STONE).toFixed(1);c.drawFontDouble(f,a);a.y-=g}},log:function(a){void 0===this.logs&&(this.logs=
[]);this.logs.push({string:a,time:TurbulenzEngine.time})},hasShaderSupport:function(){return!this.globals.graphicsDevice.shadingLanguageVersion?(this.errorCallback("No shading language support detected.\nPlease check your graphics drivers are up to date."),!1):!0},createGlobals:function(){var a=this.globals,b=this.errorCallback,c=a.metricsManager,d=TurbulenzEngine.createGraphicsDevice({multisample:2,vsync:!0});c.sendMetric("graphicsDeviceInitialised",d?1:0,!1);ea.enableRecording&&(a.playbackRecorder=
lf.create(),d=a.playbackRecorder.captureGraphicsDevice(d));var f=TurbulenzEngine.createMathDevice({});w.applyPatches(f);var g=pc.create(d,f),e={},e=ea.disableSound?null:TurbulenzEngine.createSoundDevice(e);c.sendMetric("soundDeviceInitialised",e?1:0,!1);var c=TurbulenzEngine.createPhysicsDevice({}),n=TurbulenzEngine.createInputDevice({}),j=TurbulenzEngine.createNetworkDevice({}),k=this.requestHandler;a.graphicsDevice=d;a.mathDevice=f;a.canvas=g;a.soundDevice=e;a.physicsDevice=c;a.inputDevice=n;a.networkDevice=
j;a.requestHandler=k;a.textureManager=Ia.create(d,k,null,b);a.soundManager=e?ed.create(e,k,null,b):null;a.shaderManager=Be.create(d,k,null,b);a.effectManager=Ac.create(d,f,a.shaderManager,null,b);a.fontManager=Ee.create(d,k,null,b);a.animationManager=Kb.create();b=W.create(f);g=Sd.create();a.scene=b;a.sceneLoader=g;f=Ea.create(f);a.camera=f;f.setGlobals(a);f=rc.createFromGlobals(a);b=ff.create(a);g=gf.create(a);e=ua.create(a);c=jf.create(a);n=i.create(a);a.debugDraw=f;a.simpleSceneLoader=b;a.simpleFontRenderer=
g;a.simpleSpriteRenderer=e;a.vectorArtRenderer=c;a.guiRenderer=n;a.instanceManager=Of.create(d);a.gamePurchaseManager=Ef.create(a);f=Lf.create(a);window.top.CrashMob=f;a.dynamicUI=ea.enableDynamicUI?Mf.create("Debug Sliders",this.debugSliders):null;a.draw2D=gb.create({graphicsDevice:d});a.console=f;G.setGlobals(a);a.profiling&&(a.profilingData={performanceProfiling:!1,performanceProfilingCount:0,performanceProfileName:""},a.profilingData.reset=function(){this.performanceProfiling=!1;this.performanceProfilingCount=
0;this.performanceProfileName=""});return!0},enterCallbackChain:function(a,b){var c=b.length,d,f,g=-1,e=0;f=function(){g+=1;b[g].noCallback||(e+=1);b[g].func.call(a,d,arguments)};d=function(){e-=1;if(0===e&&g<c-1)for(f();g<c-1&&(0===e||!b[g].isDependent);)f()};f()},createRenderer:function(){var a=this.globals,b=a.mathDevice,c;"ForwardRendering"===this.renderType?c=Ga.create(a.graphicsDevice,a.mathDevice,a.shaderManager,a.effectManager,{shadowRendering:!0,shadowSizeLow:2048,shadowSizeHigh:2048}):"NLightRendering"===
this.renderType?c=ia.create(a.graphicsDevice,a.mathDevice,a.shaderManager,a.effectManager,{shadowRendering:!0,shadowSizeLow:512,shadowSizeHigh:2048}):(c=ta.create(a.graphicsDevice,a.mathDevice,a.shaderManager,a.effectManager),c.setGlobalLightPosition(b.v3Build(0,0,0)),c.setGlobalLightColor(b.v3BuildZero()),c.setAmbientColor(b.v3BuildZero()));a.renderer=c;ea.newRenderer&&(a.polycraftRender=Pf.create(a));a.postEffects=dd.create(a.graphicsDevice,a.shaderManager)},createMultiplayerManager:function(){this.multiplayerManager=
If.create(this,this.globals);this.multiplayerManager.setMaxPlayers(this.gameSettings.maxPlayers)},createGame:function(){var a=Hb.create({globals:this.globals,useSplashScreens:this.useSplashScreens,autoLoad:this.autoLoad,startUpLevelPath:this.startUpLevelPath,defaultPlayerSavePath:this.defaultPlayerSavePath,versionNumber:this.version,saveVersionNumber:this.saveVersion,versionMessage:this.versionMessage,autoSave:this.autoSave,outOfGameTimeFactor:this.outOfGameTimeFactor,runScripts:this.runScripts,saveLeaderboards:this.saveLeaderboards,
saveBadges:this.saveBadges,saveGameStats:this.saveGameStats});this.protoGame=this.globals.gameManager=a},createGlobalSettingSliders:function(){var a=this.globals.dynamicUI;if(a){var b=a.addGroup("Settings"),c=this.globals.settings;a.watchVariable("Debug Messages",this,"debugMessages","checkbox");a.watchVariable("Update Info",this,"debugUpdate","checkbox");a.watchVariable("Render Info",this,"debugRender","checkbox");a.watchVariable("Nav Info",this,"debugNav","checkbox");a.watchVariable("Post Request Info",
this,"debugPostRequests","checkbox");a.watchVariable("Monitor Data",this,"debugMonitorData","checkbox");a.watchVariable("Volume",c,"volume","slider",b,{min:0,max:10,step:0.1});this.initDebugDrawFlagsUI()}},initDebugDrawFlagsUI:function(){var a=this.globals,b=a.dynamicUI,c=b.addGroup("Debug Draw"),d=this.globals.debugDrawFlags,f;a.debugDrawFlagsUIGroup=c;for(f in d)d.hasOwnProperty(f)&&b.watchVariable(f,d,f,"checkbox",c);b.watchVariable("Render buffer",this,"useRenderBuffer","checkbox",c);b.watchVariable("copy operation",
this,"renderBufferCopyOperationOverride","select",c,{values:"copyFiltered copy bicolor fadein modulate blend".split(" ")});a={min:1,max:14,step:1};b.watchVariable("RenderBufferWidth",this,"log2RenderBufferWidth","slider",c,a);b.watchVariable("RenderBufferHeight",this,"log2RenderBufferHeight","slider",c,a)},initSinglePlayerGame:function(){this.globals.isHost=!0;this.protoGame.initialise(this.globals.isHost,this.multiplayerManager.getUniquePlayerNumber())},createMappingTable:function(a){this.mappingTable=
wa.createMappingTable(this.requestHandler,this.gameSession,a)},assignMappingTable:function(){var a=this.globals,b=this.mappingTable,c=b.urlMapping,d=b.assetPrefix;a.textureManager.setPathRemapping(c,d);a.soundManager&&a.soundManager.setPathRemapping(c,d);a.shaderManager.setPathRemapping(c,d);a.fontManager.setPathRemapping(c,d);a.sceneLoader.setPathRemapping(c,d);a.simpleSceneLoader.setPathRemapping(c,d);a.simpleFontRenderer.preload();a.simpleSpriteRenderer.preload();a.mappingTable=b},createUserDataManager:function(){this.globals.userDataManager=
Nb.create(this.requestHandler,this.gameSession)},createStoreManager:function(){if(this.enableStoreManager){var a=this.globals;wa.createStoreManager(this.requestHandler,this.gameSession,function(b){a.storeManager=b;if(a.gamePurchaseManager)a.gamePurchaseManager.onStoreManagerLoaded(b)},function(){a.storeManager=null})}},createUserProfile:function(a){this.globals.userProfile=wa.createUserProfile(this.requestHandler,a,a)},createLeaderboardManager:function(a){var b=this;this.globals.leaderboardManager=
wa.createLeaderboardManager(this.requestHandler,this.gameSession,a,function(){b.leaderboardManager=null;a()})},createBadgeManager:function(){var a=wa.createBadgeManager(this.requestHandler,this.gameSession);this.globals.gameBadgeManager=ab.create(this.globals,a)},createNotificationsManager:function(){this.globals.gameNotificationsManager=Gf.create(this.globals,this.requestHandler,this.gameSession)},beginMultiplayer:function(a){this.isMultiplayerMode?this.multiplayerManager.createEmptySession(a):a()},
onAssetRequest:function(){this.numberOfAssetRequests+=1},getNumberOfAssetRequests:function(){return this.numberOfAssetRequests},enterLoadingLoop:function(){var a=this.globals,b=a.graphicsDevice,c=a.mathDevice;a.metricsManager.sendMetric("loadingLoopEntered",1,!1);this.loadLoadingImage();this.protoGame.preload();this.useLoadingBar&&(this.assetTracker.setNumberAssetsToLoad(this.getNumberOfAssetRequests()),a={backgroundColor:k.loadingGrey,barBackgroundColor:k.loadingBarBack,barColor:k.wonderstruck,barCenter:{x:0.5,
y:0.91},assetTracker:this.assetTracker},this.loadingScreen=Cc.create(b,c,a));this.intervalID=TurbulenzEngine.setInterval(this.loadingStateLoop.bind(this),1E3/60)},loadingStateLoop:function(){var a=!1;this.useLoadingBar?(this.assetTracker.setNumberAssetsToLoad(this.getNumberOfAssetRequests()),a=1<=this.assetTracker.getLoadingProgress()):a=!0;this.numberOfFramesWithNoAssetRequests=a?this.numberOfFramesWithNoAssetRequests+1:0;2<this.numberOfFramesWithNoAssetRequests&&this.hasUILoaded()&&!1===this.globals.simpleSceneLoader.isLoading()?
(this.globals.requestHandler.removeEventListener("eventOnRequestMade",this.onAssetRequestBound),this.globals.polycraftRender&&(this.globals.polycraftRender.patchMaterials(),this.globals.instanceManager.flushQueuedSceneNodes()),this.globals.renderer.updateShader(this.globals.shaderManager),this.globals.postEffects.updateShader(this.globals.shaderManager),TurbulenzEngine.clearInterval(this.intervalID),this.log("Beginning Session..."),this.initSinglePlayerGame(),this.intervalID=TurbulenzEngine.setInterval(this.mainStateLoop.bind(this),
1E3/this.fps),this.globals.appFPS=this.fps,this.globals.appTimeStep=1/this.fps,this.globals.appMaxTimeSteps=5,this.protoGame.postload()):this.drawLoadingScreen()},drawLoadingScreen:function(){var a=this.globals,b=a.graphicsDevice,a=a.simpleFontRenderer,c={x:0.5*b.width,y:0.855*b.height,pointSize:32,alignment:1,color:k.loadingText};b.beginFrame()&&(this.useLoadingBar&&this.loadingScreen.render(1,1),this.drawLoadingImage());a.drawFont("Loading...",c);a.render();b.endFrame()},getLoadingImagePath:function(){var a=
"textures/loading-quests.jpg textures/loading-quests.jpg textures/loading-build-order.jpg textures/loading-charge.jpg textures/loading-hq.jpg textures/loading-huts.jpg textures/loading-library.jpg textures/loading-storage.jpg textures/loading-targeting.jpg textures/loading-outpost.jpg textures/loading-battle.jpg textures/loading-chest.jpg textures/loading-amberling.jpg textures/loading-statue.jpg textures/loading-marketplace.jpg textures/loading-totem.jpg".split(" ");this.loadingImagePath||(this.loadingImagePath=
a[Math.floor(Math.random()*(a.length-1))]);return this.loadingImagePath},loadLoadingImage:function(){var a=this.globals.textureManager,b=this.getLoadingImagePath();a&&a.load(b)},drawLoadingImage:function(){var a=this.globals,b=a.draw2D,c=a.graphicsDevice,d=a.textureManager,f,g,e;g=this.getLoadingImagePath();if(b&&(c&&d)&&(a=c.width,f=c.height,c=0.5*a,f*=0.4,(a=d.get(g))&&d.isTextureLoaded(g)))this.startLoadingImageAppTime||(this.startLoadingImageAppTime=TurbulenzEngine.time),g=a.width,e=a.height,
d=8*(TurbulenzEngine.time-this.startLoadingImageAppTime),d=Math.min(d,1),0<g&&0<e&&(textureWidthRatio=g/e,e*=0.5,g*=0.5,b.begin("alpha","texture"),b.draw({texture:a,destinationRectangle:[c-g,f-e,c+g,f+e],color:[1,1,1,d]}),b.end())},mainStateLoop:function(){ma.start("mainLoop");ma.start("Update - Main");this.update();ma.stop("Update - Main");ma.start("Render - Main");this.render();ma.stop("Render - Main");ma.stop("mainLoop");TurbulenzEngine.time>this.profilerTime+1&&(ma.resetAndStore(),this.profilerTime=
TurbulenzEngine.time)},shutdown:function(){if(!this.hasShutdown){this.hasShutdown=!0;TurbulenzEngine.clearInterval(this.intervalID);var a=this.multiplayerManager;a&&(a.exitSession(),a.destroy());this.protoGame&&this.protoGame.autoSave&&this.protoGame.saveLevel();this.protoGame.sendPerSessionMetrics();this.protoGame.destroy();this.protoGame=this.globals.gameManager=null;this.gameSession.destroy();this.font=this.technique2D=this.technique2Dparameters=this.gameSession=null;this.globals.destroy();this.globals=
null;this.requestHandler.destroy();this.requestHandler=null;TurbulenzEngine.flush()}}};mf.create=function(){var a=new mf;"undefined"!==typeof debug&&(debug.reportAssert=function(a){if(window.console&&(window.console.log(a),"undefined"!==typeof Error)){var c=function(){var a={};Error.captureStackTrace(a,c);return a.stack};window.console.log(c())}debugger});a.hasShutDown=!1;a.gameSession={};a.multiplayerManager=null;a.protoGame={};a.globals=kf.create();a.globals.allowCheats=ea.cheats||ea.profiling;
a.globals.allowResetKey=ea.resetKey;a.globals.enableEditor=ea.enableEditor;a.connectionTime=0;a.globals.profiling=ea.profiling;a.profilerTime=0;a.isMultiplayerMode=!1;a.font=null;a.technique2D=null;a.technique2Dparameters=null;a.renderType=ea.renderType;a.fps=ea.targetFPS;a.goodRenderUpdateTime=0.25*(1E3/a.fps);a.badRenderUpdateTime=1.5*a.goodRenderUpdateTime;a.useLoadingBar=ea.useLoadingBar;a.debugMessages=ea.debugText;a.debugUpdate=ea.debugUpdate;a.debugRender=ea.debugRender;a.debugNav=ea.debugNav;
a.debugPostRequests=ea.debugPostRequests;a.debugMonitorData=ea.debugMonitorData;a.debugSliders=ea.debugSliders;a.autoLoad=ea.autoLoad;a.autoSave=ea.autoSave;a.outOfGameTimeFactor=1;a.saveLeaderboards=ea.saveLeaderboards;a.saveBadges=ea.saveBadges;a.saveGameStats=ea.saveGameStats;a.useSplashScreens=ea.useSplashScreens;a.runScripts=ea.runScripts||ea.profiling;a.version=ea.version;a.saveVersion=ea.saveVersion;a.versionMessage=ea.versionMessage;a.startUpLevelPath=ea.startUpLevelPath;a.defaultPlayerSavePath=
ea.defaultPlayerSavePath;a.enableStoreManager=!0;a.lineStep=15;a.numberOfAssetRequests=0;a.onAssetRequestBound=a.onAssetRequest.bind(a);a.numberOfFramesWithNoAssetRequests=0;a.useRenderBuffer=ea.useRenderBuffer;a.renderBufferCopyOperation="copyFiltered";a.renderBufferCopyOperationOverride=void 0;a.log2RenderBufferWidth=ea.log2RenderBufferWidth;a.log2RenderBufferHeight=ea.log2RenderBufferHeight;a.drawDebugCallback=function(){a.drawDebug()};a.drawExtraDecalsCallback=function(){a.drawExtraDecals()};
a.drawExtraTransparentCallback=function(){a.drawExtraTransparent()};return a};var ra={createEmptyLevel:function(a){var b=a.versionNumber,c=a.saveVersionNumber,a=a.getTimeInSecondsSince1970();return{versionNumber:b,saveVersionNumber:c,timeStamp:a,uniqueIndex:null,uniqueLevelIndex:null,gameSettings:null,scriptData:null,gameSpaceList:[]}},Parse:{parseLevelDataFromLevelAndPlayerSave:function(a,b,c,d){a=ra.Parse.combineLevelAndPlayerSaveData(a.levelSaveData,a.playerSaveData,c);return ra.Parse.parseLevelData(a,
b,c,d)},areLevelAndPlayerSaveMergeable:function(a,b){var c=a.gameSpaceList.length===b.gameSpaceList.length;return a.saveVersionNumber===b.saveVersionNumber&&c},combineLevelAndPlayerSaveData:function(a,b,c){var d=a.gameSpaceList,f=b.gameSpaceList,a={versionNumber:b.versionNumber,saveVersionNumber:a.saveVersionNumber,timeStamp:b.timeStamp,uniqueIndex:b.uniqueIndex,uniqueLevelIndex:a.uniqueLevelIndex,scriptData:b.scriptData,gameSpaceList:a.gameSpaceList},b=ra.Parse.getEntityDataMapFromGamespaceList(d),
g,e=d.length,n=[];for(g=0;g<e;g+=1){var j=d[g],j=ra.Parse.mergeGameSpaceEntityLists(j,j.entityList,f[g].entityList,b,c);n.push(j)}a.gameSpaceList=n;return a},mergeGameSpaceEntityLists:function(a,b,c,d,f){a.entityList=ra.Parse.combineLevelAndPlayerSaveEntityLists(b,c,d,f);return a},combineLevelAndPlayerSaveEntityLists:function(a,b,c,d){var f,g,e,n,j=b.length;for(f=0;f<j;f+=1)if(e=b[f],n=e.name,g=c[n])g.ecData=e.ecData;else if(g=e.archetypeName,!(g?d.getEntityArchetype(g):e.customArchetype).shouldLevelSave)a.push(e),
c[n]=e;return a},getEntityDataMapFromGamespaceList:function(a){a=a.reduce(function(a,c){return a.concat(c.entityList||[])},[]);return ra.Parse.getMapFromList(a,"name")},getEntityMapFromGameSpaceList:function(a){a=a.reduce(function(a,c){return a.concat(c.entityList||[])},[]);return ra.Parse.getMapFromList(a,"name")},getMapFromList:function(a,b){return a.reduce(function(a,d){a[d[b]]=d;return a},{})},parseLevelData:function(a,b,c,d){var f=a.gameSpaceList,b=ra.Parse.parseGameSpaceDataList(f,null===a.uniqueIndex,
b,c,d),f=ra.Parse.deserializeGameSpaceList(b,f);f.forEach(function(a){a.finalizeIfNeeded()});return{versionNumber:a.versionNumber,saveVersionNumber:a.saveVersionNumber,timeStamp:a.timeStamp,uniqueIndex:a.uniqueIndex,uniqueLevelIndex:a.uniqueLevelIndex,gameSettings:a.gameSettings,scriptData:a.scriptData,gameSpaceList:f}},parseGameSpaceDataList:function(a,b,c,d,f){return a.map(function(a){return ra.Parse.parseGameSpaceData(a,b,c,d,f)})},parseGameSpaceData:function(a,b,c,d,f){var g=fa.create("GameSpace",
f,a.extents,a.m43Transform);a.blockList.map(function(a){return ra.Parse.parseBlockData(a,c)}).forEach(function(a){a.addToGameSpace(g)});a=a.entityList.map(function(a){return ra.Parse.parseEntityData(a,b,d)});g.addEntities(a);return g},parseBlockData:function(a,b){return b.createBlockInstance(a.archetype,a.v3Location,a.v3Scale,a.rotationY)},parseEntityData:function(a,b,c){var d=a.archetypeName,f=a.name,g=a.customArchetype,e=a.familyName,n=a.v3Location,j=void 0!==a.yRotation?a.yRotation:0,a=a.v3Scale,
c=d?c.createInactiveEntityInstance(f,d,n,j):c.createEntity(f,e,g,n,j);a&&c.setV3Scale(a);!b&&f&&(c.name=f);return c},deserializeGameSpaceList:function(a,b){var c=ra.Parse.getEntityMapFromGameSpaceList(a),d=a.length,f,g,e;for(f=0;f<d;f+=1)g=a[f],e=b[f],ra.Parse.deserializeGameSpace(g,e,c);return a},deserializeGameSpace:function(a,b,c){var a=a.getEntityList(),d=b.entityList;return a.map(function(a,b){return ra.Parse.deserializeEntity(a,d[b].ecData,c)})},deserializeEntity:function(a,b,c){b&&(a.setLevelEntityNameMap(c),
a.deserializeECSaveData(b),a.clearLevelEntityNameMap());return a}},SaveLoad:{saveLevelToUserData:function(a,b,c,d,f){b=JSON.stringify(b,ra.SaveLoad.typedArrayReplacer);ra.SaveLoad.saveDataToUserData(a,b,c,d,f)},loadLevelFromUserData:function(a,b,c,d){ra.SaveLoad.loadDataFromUserData(a,b,c,d)},deleteLevelFromUserData:function(a,b,c,d){ra.SaveLoad.saveDataToUserData(a,"",b,c,d)},loadLevelFromFile:function(a,b,c,d,f){a=c.getURL(a);ra.SaveLoad.loadDataFromLocal(a,b,d,f)},saveLevelToLocal:function(a,b,
c,d,f){b=JSON.stringify(b,ra.SaveLoad.typedArrayReplacer);ra.SaveLoad.saveDataToLocal(a,b,c,d,f)},loadLevelFromLocal:function(a,b,c,d){ra.SaveLoad.loadDataFromLocal(a,b,c,d)},listLocalLevelFiles:function(a,b,c,d){La.ajax({url:a,requestHandler:b,method:"POST",callback:function(b,g){if(200===g){var e=b.data.items.filter(function(a){return!a.isDirectory}).map(function(a){return a.assetName});c(a,e)}else d(a)}})},saveDataToUserData:function(a,b,c,d,f){c.set(a,b,function(a){d(a)},function(a,b,c,d){f(a,
b,c,d)})},loadDataFromUserData:function(a,b,c,d){var f=function(a,b){c(a,b)},g=function(c,e,j,i){404===e?d(c,e,j,i):TurbulenzEngine.setTimeout(function(){b.get(a,f,g)},5E3)};b.get(a,f,g)},saveDataToLocal:function(a,b,c,d,f){La.ajax({url:a,requestHandler:c,method:"POST",callback:function(b,c){200===c?d(a,b):f(a)},data:{content:b}})},loadDataFromLocal:function(a,b,c,d){b.request({src:a,onload:function(b,g){200===g?c(a,JSON.parse(b)):d(a)}})},typedArrayReplacer:function(a,b){return"[object Float32Array]"===
Object.prototype.toString.call(b)?Array.apply([],b):b}},Serialize:{serializeLevelIntoLevelAndPlayerSave:function(a,b){var c=ra.Serialize.serializeLevelSave(a,b),d=ra.Serialize.serializePlayerSave(a,b);return{levelSaveData:c,playerSaveData:d}},serializeLevelSave:function(a,b){return ra.Serialize.serializeLevel(a,!0,!0,!1,!1,b)},serializePlayerSave:function(a,b){return ra.Serialize.serializeLevel(a,!1,!1,!0,!0,b)},serializeLevelIntoSingleSave:function(a,b){return ra.Serialize.serializeLevel(a,!0,!0,
!0,!0,b)},serializeLevel:function(a,b,c,d,f,g){var e=a.getGameSpaceList(),n=a.gameScriptManager,j=a.versionNumber,i=a.saveVersionNumber,l=a.uniqueIndex,a=a.uniqueLevelIndex,m=0.001*(new Date).getTime(),e=e.map(function(a){return ra.Serialize.serializeGameSpace(a,b,c,d,g)}),f=f?n.serialize():null;return{versionNumber:j,saveVersionNumber:i,timeStamp:m,uniqueIndex:l,uniqueLevelIndex:a,scriptData:f,gameSpaceList:e}},serializeGameSpace:function(a,b,c,d,f){var g=null;b&&(g=a.getBlockList().map(function(a){return ra.Serialize.serializeBlock(a)}));
b=null;if(c||d)b=a.getEntityList().filter(function(a){return a.shouldLevelSave&&c||a.shouldPlayerSave&&d}).map(function(a){return ra.Serialize.serializeEntity(a,f)});return{extents:a.calculateExtents(),m43Transform:a.getM43FullTransform(),blockList:g,entityList:b}},serializeBlock:function(a){return{archetype:a.getArchetypeName(),v3Location:a.getv3Location(),v3Scale:a.getV3Scale(),rotationY:a.getRotationY()}},serializeEntity:function(a,b){return a.archetypeName?ra.Serialize.serializeArchetypeEntity(a,
b):ra.Serialize.serializeCustomEntity(a,b)},serializeArchetypeEntity:function(a,b){var c=a.name,d=a.getECSaveData(b);return{name:c,archetypeName:a.archetypeName,v3Location:a.getv3Location(),yRotation:a.getRotationY(),v3Scale:a.getV3Scale(),ecData:d}},serializeCustomEntity:function(a,b){var c=a.name,d=a.familyName,f=a.getECSaveData(b);return{name:c,familyName:d,customArchetype:a.getCustomArchetype(),v3Location:a.getv3Location(),yRotation:a.getRotationY(),v3Scale:a.getV3Scale(),ecData:f}}}},t={State:{saveLevelDirectory:null,
loadLevelDirectory:null,levelFileExtension:null,levelSaveFileNameEnding:null,playerSaveFileNameEnding:null,singleSaveFileNameEnding:null,cameraZoomSpeed:null,cameraLookSpeed:null,cameraMovementSpeed:null,controlLists:null,drawControlLists:null,draw2dControlLists:null,uiElementList:null,entityArchetypeList:null,blockArchetypeList:null,actionListOnEnterEditorMode:null,actionListOnExitEditorMode:null,selectedEntityExtentsColour:null,gameSpaceExtentsColour:null,objectAtCursorExtentsColour:null,positionFactor:null,
rotationFactor:null,scaleFactor:null,currentLevelName:null,saveAsLevelName:null,levelNameList:[],uiAdded:!1,cursorVisible:!0,v2CursorScreenLocation:null,selectedObjects:[],selectedObjectGroup:null,objectAtCursor:null,widgetAtCursor:null,flags:{},startDragState:null,v2CursorStartDragScreenLocation:null,aabbTreeBlocks:null,aabbTreeEntities:null,aabbTreeWidgets:null},initState:function(a,b,c,d,f,g){var e=t.State;e.saveLevelDirectory=a.saveLevelDirectory;e.loadLevelDirectory=a.loadLevelDirectory;e.levelFileExtension=
a.levelFileExtension;e.levelSaveFileNameEnding=a.levelSaveFileNameEnding;e.playerSaveFileNameEnding=a.playerSaveFileNameEnding;e.singleSaveFileNameEnding=a.singleSaveFileNameEnding;e.cameraLookSpeed=a.cameraLookSpeed;e.cameraMovementSpeed=a.cameraMovementSpeed;e.cameraZoomSpeed=a.cameraZoomSpeed;e.uiElementList=a.uiElementList;e.controlLists=a.controlLists;e.drawControlLists=a.drawControlLists;e.draw2dControlLists=a.draw2dControlLists;e.entityArchetypeList=b;e.blockArchetypeList=c;e.actionListOnEnterEditorMode=
a.actionListOnEnterEditorMode;e.actionListOnExitEditorMode=a.actionListOnExitEditorMode;e.selectedEntityExtentsColour=a.selectedEntityExtentsColour;e.gameSpaceExtentsColour=a.gameSpaceExtentsColour;e.objectAtCursorExtentsColour=a.objectAtCursorExtentsColour;e.positionFactor=a.positionFactor;e.rotationFactor=a.rotationFactor;e.scaleFactor=a.scaleFactor;e.uiAdded||(e.uiAdded=!0,t.UI.addEditorUI(a.uiElementList,g,a.uiGroupName));e.v2CursorScreenLocation=f.v2Copy(d);e.objectAtCursor=null},getEditorStateFromName:function(a){return t.State[a]},
getEditorFlagStateFromName:function(a){return t.State.flags[a]},createEditorObjectFromEntityArchetype:function(a,b,c,d,f){var g="editorObject_"+d,e=f.getECArchetype(d,"ECMesh"),a=f.createInactiveEditorObjectInstance(g,e,a);a.archetypeName=d;null!==b&&void 0!==b&&a.setV3Scale(b);null!==c&&void 0!==c&&a.setRotationY(c);a.activate();a.update();return a},createEditorObjectFromBlockArchetype:function(a,b,c,d,f,g){var e="editorObject_"+d,f=f.getArchetype(d),n=f.path;b||(b=f.v3CreationScale||[1,1,1]);a=
g.createInactiveEditorObjectInstance(e,{path:n},a);a.archetypeName=d;a.isFromBlock=!0;a.setV3Scale(b);null!==c&&void 0!==c&&a.setRotationY(c);a.activate();a.update();return a},addBlock:function(a){var b=t.getEditorBlockExtents(a);t.State.aabbTreeBlocks.add(a,b)},removeBlock:function(a){t.State.aabbTreeBlocks.remove(a)},addEntity:function(a,b){var c=t.getEditorEntityExtents(a,b);t.State.aabbTreeEntities.add(a,c)},removeEntity:function(a){t.State.aabbTreeEntities.remove(a)},updateEntity:function(a,
b){var c=t.getEditorEntityExtents(a,b);t.State.aabbTreeEntities.update(a,c)},cameraRayTest:function(a,b,c,d){a=b.screenToWorld(a[0],a[1],2);b=d.m43Pos(b.matrix);a=d.v3Sub(a,b);d.v3Normalize(a,a);c=xa.rayTest(c,{origin:b,direction:a,maxFactor:1E3},function(a,b,c,d){return{factor:d,externalNode:b}});d=[];c&&d.push(c.externalNode);return d},getV3NewObjectLocation:function(a,b){var c=a.camera,d=a.graphicsDevice,d=a.mathDevice.v2Build(d.width/2,d.height/2),f=c.screenToWorld(d[0],d[1],40),g=c.getv3Location();
return(f=b.getCollisionInfo(g,f))?c.screenToWorld(d[0],d[1],f.distance-5):c.screenToWorld(d[0],d[1],40)},getEditorBlockExtents:function(a){a=a.getExtents();a[0]===a[3]&&(a[0]-=0.001,a[3]+=0.001);a[1]===a[4]&&(a[1]-=0.001,a[4]+=0.001);a[2]===a[5]&&(a[2]-=0.001,a[5]+=0.001);return a},getEditorEntityExtents:function(a,b){var c=a.getEC("ECMesh"),d=a.getEC("ecPhysicsCube"),f;if(c){if(c=c.node)c.update(),f=c.calculateHierarchyWorldExtents()}else d&&(f=d.getExtents());f||(f=a.getv3Location(),c=b.v3Build(0.5,
0.5,0.5),f=b.aabbBuildFromCentreHalfExtents(f,c));return f},getScreenSpaceDragDistanceAlongWorldVector:function(a,b,c,d,f,g){c=f.worldToScreen(c);d=f.worldToScreen(d);d=g.v2Sub(d,c);g.v2Normalize(d,d);a=g.v2Sub(b,a);return g.v2Dot(d,a)},getSnappedEntityLocation:function(a,b,c,d,f){var g=b.getGameSpace(d),a=a.mathDevice.v3Copy(d);if(!g)return a;if(1===f)return a[1]=Math.round(2*a[1])/2,a;b=g.snapPositionToGridLine(d,!1);d=g.snapPositionToGridSquare(d,!1);c=c.getEC("ECMesh").node.calculateHierarchyWorldExtents();
c=c[f+3]-c[f];c=Math.round(c);1===c%2||0===c?a[f]=d[f]:0===c%2&&(a[f]=b[f]);return a},getValueMap:{getSaveAsLevelName:function(){return t.State.saveAsLevelName},getSelectedObjectWorldLocationX:function(){var a=t.State.selectedObjectGroup;return a?a.v3Location[0]:null},getSelectedObjectWorldLocationY:function(){var a=t.State.selectedObjectGroup;return a?a.v3Location[1]:null},getSelectedObjectWorldLocationZ:function(){var a=t.State.selectedObjectGroup;return a?a.v3Location[2]:null},getSelectedObjectScaleX:function(){var a=
t.State.selectedObjectGroup;return a?a.v3Scale[0]:null},getSelectedObjectScaleY:function(){var a=t.State.selectedObjectGroup;return a?a.v3Scale[1]:null},getSelectedObjectScaleZ:function(){var a=t.State.selectedObjectGroup;return a?a.v3Scale[2]:null},getSelectedObjectRotationYInDegrees:function(){var a=t.State.selectedObjectGroup;return a?Math.round(360/(2*Math.PI)*a.rotationY):null}},Actions:{createActionInstance:function(a,b,c){return{name:a,execute:b[a],params:"object"===typeof c?c:{}}},createActionList:function(a,
b,c){var d=a.length,f=[],g,e,n;for(n=0;n<d;n+=1)g=a[n],"object"===typeof g?(e=g.type,g=g.params,g=t.Actions.mergeActionParams(c,g),e=t.Actions.createActionInstance(e,b,g)):(e=g,e=t.Actions.createActionInstance(e,b,c)),f.push(e);return f},executeActionList:function(a,b,c){a.forEach(function(a){return a.execute(b,c,a.params)})},mergeActionParams:function(a,b){var c={},d;for(d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);for(d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);return c},actionMap:{}}};t.Actions.actionMap.freeCamForward=
function(a,b){b.getGameCamera().cameraController.moveForward(t.State.cameraMovementSpeed)};t.Actions.actionMap.freeCamBackward=function(a,b){b.getGameCamera().cameraController.moveBackward(t.State.cameraMovementSpeed)};t.Actions.actionMap.freeCamLeft=function(a,b){b.getGameCamera().cameraController.moveLeft(t.State.cameraMovementSpeed)};t.Actions.actionMap.freeCamRight=function(a,b){b.getGameCamera().cameraController.moveRight(t.State.cameraMovementSpeed)};t.Actions.actionMap.freeCamUp=function(a,
b){b.getGameCamera().cameraController.moveUp(t.State.cameraMovementSpeed)};t.Actions.actionMap.freeCamDown=function(a,b){b.getGameCamera().cameraController.moveDown(t.State.cameraMovementSpeed)};t.Actions.actionMap.enableFreeCamLook=function(a,b){b.getGameCamera().cameraController.enableFreeCamLook()};t.Actions.actionMap.disableFreeCamLook=function(a,b){b.getGameCamera().cameraController.disableFreeCamLook()};t.Actions.actionMap.freeCamTurn=function(a,b,c){b.getGameCamera().cameraController.look((c.delta||
1)*t.State.cameraLookSpeed,0)};t.Actions.actionMap.freeCamPitch=function(a,b,c){b.getGameCamera().cameraController.look(0,(c.delta||1)*t.State.cameraLookSpeed)};t.Actions.actionMap.translateSelectedObjectsInAxis=function(a,b,c){t.ObjectGroup.translateObjectGroupInAxis(a,b,t.State.selectedObjectGroup,c.value,c.axis,!1)};t.Actions.actionMap.positionSelectedObjectsFromDragInAxis=function(a,b,c){var d=t.State.startDragState;if(d){var c=c.axis,f=a.mathDevice,g=t.State.v2CursorScreenLocation,e=t.State.v2CursorStartDragScreenLocation,
n=d.v3Location,j=f.v3BuildZero();j[c]=1;j=f.v3Add(n,j);f=t.getScreenSpaceDragDistanceAlongWorldVector(e,g,n,j,a.camera,f);t.ObjectGroup.setObjectGroupLocationInAxis(a,b,t.State.selectedObjectGroup,d.v3Location[c]+f*t.State.positionFactor,c,t.State.flags.enableGridSnap)}};t.Actions.actionMap.setSelectedObjectsLocationInAxis=function(a,b,c){t.ObjectGroup.setObjectGroupLocationInAxis(a,b,t.State.selectedObjectGroup,c.value,c.axis,!1)};t.Actions.actionMap.rotateSelectedObjects=function(a,b,c){t.ObjectGroup.rotateObjectGroupInYAxis(a,
t.State.selectedObjectGroup,c.value,t.State.flags.enableGridSnap)};t.Actions.actionMap.rotateSelectedObjectsFromDragInYAxis=function(a){var b=t.State.startDragState;if(b){var c=a.mathDevice,d=t.State.v2CursorScreenLocation,f=t.State.v2CursorStartDragScreenLocation,g=b.v3Location,e=c.v3Build(0,1,0),e=c.v3Add(g,e),c=t.getScreenSpaceDragDistanceAlongWorldVector(f,d,g,e,a.camera,c);t.ObjectGroup.setObjectGroupRotationY(a,t.State.selectedObjectGroup,b.rotationY+c*t.State.rotationFactor,t.State.flags.enableGridSnap)}};
t.Actions.actionMap.setSelectedObjectsRotationYInDegrees=function(a,b,c){c.value*=2*Math.PI/360;t.Actions.actionMap.setSelectedObjectsRotationY(a,b,c)};t.Actions.actionMap.setSelectedObjectsRotationY=function(a,b,c){t.ObjectGroup.setObjectGroupRotationY(a,t.State.selectedObjectGroup,c.value,!1)};t.Actions.actionMap.addNewSelectedEntity=function(a,b,c){var d=b.getEntityFactory(),c=c.text,b=t.getV3NewObjectLocation(a,b),d=t.createEditorObjectFromEntityArchetype(b,null,null,c,d),a=a.mathDevice;(b=t.State.selectedObjectGroup)||
(b=t.ObjectGroup.createNewObjectGroup());t.State.selectedObjectGroup=t.ObjectGroup.addObjectToObjectGroup(b,d,a)};t.Actions.actionMap.addNewSelectedBlock=function(a,b,c){var d=b.getEntityFactory(),f=b.getBlockFactory(),c=c.text,b=t.getV3NewObjectLocation(a,b),d=t.createEditorObjectFromBlockArchetype(b,null,null,c,f,d),a=a.mathDevice;(f=t.State.selectedObjectGroup)||(f=t.ObjectGroup.createNewObjectGroup());t.State.selectedObjectGroup=t.ObjectGroup.addObjectToObjectGroup(f,d,a)};t.Actions.actionMap.selectObject=
function(a,b,c){if(c=c.objectToSelect||t.State.objectAtCursor)b=t.ObjectGroup.selectObject(a,b,c),a=a.mathDevice,(c=t.State.selectedObjectGroup)||(c=t.ObjectGroup.createNewObjectGroup()),t.State.selectedObjectGroup=t.ObjectGroup.addObjectToObjectGroup(c,b,a),t.State.objectAtCursor=null};t.Actions.actionMap.selectAllBlocksOfArchetype=function(a,b,c){var d=c.text;b.getGameSpaceList().reduce(function(a,b){return a.concat(b.getBlockList())},[]).filter(function(a){return a.getArchetypeName()===d}).forEach(function(c){t.Actions.actionMap.selectObject(a,
b,{objectToSelect:c})})};t.Actions.actionMap.removeObject=function(a,b){var c=t.State.objectAtCursor;if(c){var d=a.mathDevice,f=t.State.selectedObjectGroup;t.ObjectGroup.placeObject(b,d,c);t.ObjectGroup.discardObject(c);t.State.selectedObjectGroup=t.ObjectGroup.removeObjectFromObjectGroup(f,c,d);t.State.objectAtCursor=null}};t.Actions.actionMap.removeAllEntitiesFromLevel=function(a,b){b.getGameSpaceList().forEach(function(a){a.getEntityList().slice().forEach(t.ObjectGroup.discardObject)});var c=b.createHero("HeroDude",
ea.heroArchetype);b.setHero(c);t.addEntity(c)};t.Actions.actionMap.placeSelectedObjects=function(a,b){var c=t.State.selectedObjectGroup;c&&t.ObjectGroup.placeObjectGroup(c,b,a.mathDevice)};t.Actions.actionMap.discardSelectedObjects=function(){var a=t.State.selectedObjectGroup;a&&(t.ObjectGroup.discardObjectGroup(a),t.State.selectedObjectGroup=null)};t.Actions.actionMap.scaleSelectedObjectsInAxis=function(a,b,c){t.ObjectGroup.scaleObjectGroupInAxis(a,b,t.State.selectedObjectGroup,c.axis,c.value,t.State.flags.enableGridSnap)};
t.Actions.actionMap.scaleSelectedObjectsFromDragInAxis=function(a,b,c){var d=t.State.startDragState;if(d){var c=c.axis,f=a.mathDevice,g=t.State.v2CursorScreenLocation,e=t.State.v2CursorStartDragScreenLocation,n=d.v3Location,j=f.v3BuildZero();j[c]=1;j=f.v3Add(n,j);g=t.getScreenSpaceDragDistanceAlongWorldVector(e,g,n,j,a.camera,f);e=t.State.selectedObjectGroup;1!==c&&Math.abs(f.diffAngles(e.rotationY,0))>0.25*Math.PI&&Math.abs(f.diffAngles(e.rotationY,Math.PI))>0.25*Math.PI&&(c=0===c?2:0);t.ObjectGroup.setObjectGroupScaleInAxis(a,
b,e,c,d.v3Scale[c]+g*t.State.scaleFactor,t.State.flags.enableGridSnap)}};t.Actions.actionMap.setSelectedObjectsScaleInAxis=function(a,b,c){t.ObjectGroup.setObjectGroupScaleInAxis(a,b,t.State.selectedObjectGroup,c.axis,c.value,!1)};t.Actions.actionMap.toggleEditorMode=function(a,b){b.toggleEditor()};t.Actions.actionMap.setFlagOn=function(a,b,c){t.State.flags[c.name]=!0};t.Actions.actionMap.setFlagOff=function(a,b,c){t.State.flags[c.name]=!1};t.Actions.actionMap.toggleFlag=function(a,b,c){a=c.name;
t.State.flags[a]=t.State.flags[a]?!1:!0};t.Actions.actionMap.lockMouse=function(a){a.inputDevice.lockMouse()};t.Actions.actionMap.unlockMouse=function(a){a.inputDevice.unlockMouse()};t.Actions.actionMap.hideMouse=function(a){a.inputDevice.hideMouse()};t.Actions.actionMap.showMouse=function(a){a.inputDevice.showMouse()};t.Actions.actionMap.enableEditorECDebugDrawing=function(a,b){a.debugDrawFlags.gameSpaces=!0;b.addECDebugDrawMask(Hb.ecDebugDrawMasks.editor)};t.Actions.actionMap.disableEditorECDebugDrawing=
function(a,b){a.debugDrawFlags.gameSpaces=!1;b.removeECDebugDrawMask(Hb.ecDebugDrawMasks.editor)};t.Actions.actionMap.buildBlockAABBTree=function(a,b){t.State.aabbTreeBlocks=xa.create(!0);b.getGameSpaceList().forEach(function(a){a.getBlockList().forEach(function(a){t.addBlock(a)})});t.State.aabbTreeBlocks.finalize()};t.Actions.actionMap.buildEntityAABBTree=function(a,b){t.State.aabbTreeEntities=xa.create(!0);var c=b.getGameSpaceList(),d=a.mathDevice;c.forEach(function(a){a.getEntityList().forEach(function(a){t.addEntity(a,
d)})});t.State.aabbTreeEntities.finalize()};t.Actions.actionMap.updateBlockAABBTree=function(){t.State.aabbTreeBlocks.finalize()};t.Actions.actionMap.updateEntityAABBTree=function(){t.State.aabbTreeEntities.finalize()};t.Actions.actionMap.buildWidgetAABBTree=function(a){var b=t.State.selectedObjectGroup,c=null;if(b&&b.v3Location){var d=b.v3Location,c=xa.create(!0),a=a.mathDevice,b=a.v3Build(1,0,0),f=a.v3Build(0,1,0),g=a.v3Build(0,0,1),b=a.v3AddScalarMul(d,b,1),f=a.v3AddScalarMul(d,f,1),d=a.v3AddScalarMul(d,
g,1),e=a.v3Build(1,0.25,0.25),n=a.v3Build(0.25,1,0.25),g=a.v3Build(0.25,0.25,1),b=a.aabbBuildFromCentreHalfExtents(b,e),f=a.aabbBuildFromCentreHalfExtents(f,n),a=a.aabbBuildFromCentreHalfExtents(d,g);c.add({axis:0},b);c.add({axis:1},f);c.add({axis:2},a);c.finalize()}t.State.aabbTreeWidgets=c};t.Actions.actionMap.doGameButtons=function(a,b){var c=b.getIMGui(),d=a.guiRenderer;c.doButton({id:"Menu",text:"",v2ScreenLocation:d.getv2RenderLocation(79.5,56,"topLeft"),buttonType:aa.BUTTON_IN_GAME,guiArchetype:"menu"});
c.doButton({id:"Shop",text:void 0,v2ScreenLocation:d.getv2RenderLocation(79.5,121,"topLeft"),buttonType:aa.BUTTON_IN_GAME,guiArchetype:"shop"});c.doButton({id:"FIGHT",text:void 0,v2ScreenLocation:d.getv2RenderLocation(79.5,186,"topLeft"),buttonType:aa.BUTTON_IN_GAME,guiArchetype:"fight"})};t.Actions.actionMap.startDrag=function(a){var b=t.State.selectedObjectGroup;if(b){var a=a.mathDevice,c=a.v3Copy(b.v3Location),d=b.rotationY,b=a.v3Copy(b.v3Scale);t.State.startDragState={v3Location:c,rotationY:d,
v3Scale:b};t.State.v2CursorStartDragScreenLocation=a.v2Copy(t.State.v2CursorScreenLocation)}};t.Actions.actionMap.endDrag=function(){t.State.startDragState=null;t.State.v2CursorStartDragScreenLocation=null};t.Actions.actionMap.setCursorScreenLocation=function(a,b,c){var b=a.graphicsDevice,a=a.mathDevice,d=b.height,b=a.clamp(c.x,0,b.width),c=a.clamp(c.y,0,d);t.State.v2CursorScreenLocation[0]=b;t.State.v2CursorScreenLocation[1]=c};t.Actions.actionMap.togglePause=function(a,b){b.paused?(a.debugDrawFlags.gameSpaces=
!1,b.exitPaused()):(a.debugDrawFlags.gameSpaces=!0,b.startPaused())};t.Actions.actionMap.clearObjectAtCursor=function(){t.State.objectAtCursor=null};t.Actions.actionMap.createNewLevel=function(a,b){var c=a.mathDevice,d=c.v3Build(50,15,50),f=c.v3BuildZero(),d=c.aabbBuildFromCentreHalfExtents(f,d),f=c.m43BuildIdentity(),c=ra.createEmptyLevel(b),d=fa.create("GameSpace",a,d,f);c.gameSpaceList=[d];b.setCurrentLevel(c)};t.Actions.actionMap.updateObjectAtCursor=function(a){var b=t.State.v2CursorScreenLocation,
c=t.State.aabbTreeBlocks,d=t.State.aabbTreeEntities,f=[];t.State.flags.enableBlockSelection&&f.push(c);t.State.flags.enableEntitySelection&&f.push(d);a=t.cameraRayTest(b,a.camera,f,a.mathDevice);t.State.objectAtCursor=0<a.length?a[0]:null};t.Actions.actionMap.updateWidgetAtCursor=function(a){var b=t.State.v2CursorScreenLocation,c=t.State.aabbTreeWidgets;c&&(a=t.cameraRayTest(b,a.camera,[c],a.mathDevice),t.State.widgetAtCursor=0<a.length?a[0]:null)};t.Actions.actionMap.enableBlockMovement=function(a){Rg.disable(a)};
t.Actions.actionMap.disableBlockMovement=function(a){Rg.enable(a)};t.Actions.actionMap.drawGameSpaces=function(a,b){b.drawGameSpaces()};t.Actions.actionMap.drawGameSpaceExtents=function(a,b){var c=a.debugDraw,d=b.getGameSpaceList(),f=t.State.gameSpaceExtentsColour;d.forEach(function(a){t.Draw.drawExtents(a.getExtents(),f,c)})};t.Actions.actionMap.drawEntitiesWithoutMeshes=function(a,b,c){var d=c.v3Colour,f=a.debugDraw,b=b.getGameSpaceList(),g=a.mathDevice;b.forEach(function(a){a.getEntityList().filter(function(a){return!a.getEC("ECMesh")}).forEach(function(a){t.Draw.drawEntityExtents(a,
d,f,g)})})};t.Actions.actionMap.drawSelectedEntityExtents=function(a){var b=a.debugDraw,c=a.mathDevice,d=t.State.selectedEntityExtentsColour;t.State.selectedObjects.forEach(function(a){t.Draw.drawEntityExtents(a,d,b,c)})};t.Actions.actionMap.drawSelectedObjectGroupExtents=function(a){var b=a.debugDraw,c=a.mathDevice,d=t.State.selectedEntityExtentsColour;t.State.selectedObjectGroup.objectList.forEach(function(a){t.Draw.drawEntityExtents(a,d,b,c)})};t.Actions.actionMap.drawObjectAtCursorExtents=function(a){var b=
a.debugDraw,c=t.State.objectAtCursor;if(c){var d=t.State.objectAtCursorExtentsColour;c.isBlock?t.Draw.drawBlockExtents(c,d,b):t.Draw.drawEntityExtents(c,d,b,a.mathDevice)}};t.Actions.actionMap.drawGuiArchetype=function(a,b,c){b.getGuiManager().addDrawGui(c.guiArchetypeName,{})};t.Actions.actionMap.drawWidgetAABBTree=function(a){var b=t.State.aabbTreeWidgets.nodes,c=a.debugDraw,d=a.mathDevice.v3BuildOne();b.forEach(function(a){t.Draw.drawExtents(a.extents,d,c)})};t.Actions.actionMap.drawWidgetExtents=
function(a,b,c){if(t.State.widgetAABBList){var b=c.axis,d=a.mathDevice,a=a.debugDraw,c=t.State.widgetAABBList[b],f=d.v4Build(1,0,0,1),d=d.v4Build(1,1,0,1),g=t.State.widgetAtCursor;g&&g.axis===b&&(f=d);t.Draw.drawExtents(c,f,a)}};t.Actions.actionMap.drawWidgetX=function(a,b,c){var c=c.spritePath,b=a.simpleSpriteRenderer,a=a.mathDevice,d=t.State.selectedObjectGroup.v3Location,f=a.v3Build(1,0,0),d=a.v3AddScalarMul(d,f,1),f=a.v4Build(1,0,0,1),g=a.v4Build(1,1,0,1),e=t.State.widgetAtCursor;e&&0===e.axis&&
(f=g);a=a.v3Build(0,1,0);g=-Math.PI/2;f[3]=0.25;c={v3Location:d,sizeX:1,sizeY:1.5,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:c,v4color:f,out:a,angle:g};b.addSprite(c);c.v4color[3]=1;c.blendStyle=ua.prototype.blendStyle.NORMAL;b.addSprite(c)};t.Actions.actionMap.drawWidgetY=function(a,b,c){var c=c.spritePath,b=a.simpleSpriteRenderer,a=a.mathDevice,d=t.State.selectedObjectGroup.v3Location,f=a.v3Build(0,1,0),d=a.v3AddScalarMul(d,f,1),f=a.v4Build(0,1,0,1),g=a.v4Build(1,1,0,1),e=t.State.widgetAtCursor;
e&&1===e.axis&&(f=g);g=a.v3Build(0,0,1);f[3]=0.25;c={v3Location:d,sizeX:1.5,sizeY:1,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:c,v4color:f,out:g,angle:0};b.addSprite(c);c.out=a.v3Build(1,0,0);b.addSprite(c);c.v4color[3]=1;c.out=g;c.blendStyle=ua.prototype.blendStyle.NORMAL;b.addSprite(c);c.out=a.v3Build(1,0,0);b.addSprite(c)};t.Actions.actionMap.drawWidgetZ=function(a,b,c){var c=c.spritePath,b=a.simpleSpriteRenderer,a=a.mathDevice,d=t.State.selectedObjectGroup.v3Location,f=a.v3Build(0,
0,1),d=a.v3AddScalarMul(d,f,1),f=a.v4Build(0,0,1,1),g=a.v4Build(1,1,0,1),e=t.State.widgetAtCursor;e&&2===e.axis&&(f=g);a=a.v3Build(0,1,0);f[3]=0.25;c={v3Location:d,sizeX:1.5,sizeY:1,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:c,v4color:f,out:a,angle:0};b.addSprite(c);c.v4color[3]=1;c.blendStyle=ua.prototype.blendStyle.NORMAL;b.addSprite(c)};t.Actions.actionMap.drawEditorFlags=function(a){var b=a.simpleFontRenderer,c=t.State.flags,a=a.mathDevice.v2Build(300,10),d,f;for(d in c)c.hasOwnProperty(d)&&
(f=d+" : ",f+=c[d]?"true":"false",t.Draw.drawDebugText(b,a,f),a[1]+=15)};t.Actions.actionMap.drawCurrentLevelName=function(a){var b=a.simpleFontRenderer,a=a.guiRenderer.getv2RenderLocation(-10,10,"topRight");t.Draw.drawDebugText(b,a,"Current Level: "+(t.State.currentLevelName?t.State.currentLevelName:"un-named"),2)};t.Actions.actionMap.drawSelectedObjectName=function(a){var b=a.simpleFontRenderer,a=a.guiRenderer.getv2RenderLocation(-10,25,"topRight"),c=t.State.selectedObjectGroup,c=c.objectList.length?
c.objectList[0]:null;t.Draw.drawDebugText(b,a,"Selected Object: "+(c?c.archetypeName:"none"),2)};t.Actions.actionMap.drawObjectAtCursorName=function(a){var b=a.simpleFontRenderer,c=t.State.objectAtCursor,a=a.guiRenderer.getv2RenderLocation(-10,40,"topRight");t.Draw.drawDebugText(b,a,"Object At Cursor: "+(c?c.archetypeName:"none"),2)};t.Actions.actionMap.drawCursorLocation=function(a){var b=a.mathDevice,a=a.simpleFontRenderer,c=t.State.v3CursorWorldLocation;if(c){var b=b.v2Build(10,55),d="x: "+c[0];
t.Draw.drawDebugText(a,b,d);b[1]+=15;d="y: "+c[1];t.Draw.drawDebugText(a,b,d);b[1]+=15;d="z: "+c[2];t.Draw.drawDebugText(a,b,d)}};t.Actions.actionMap.drawCameraLocation=function(a,b){var c=a.simpleFontRenderer,d=a.mathDevice,f=a.guiRenderer.getv2RenderLocation(-10,70,"topRight"),g=b.getGameCamera().camera,e=g.getv3Location(),g=g.getv3Forward(),d=d.v3Add(e,g),e="Camera Location (v3Position, v3Focus): ["+e[0].toFixed(2)+", "+e[1].toFixed(2)+", "+e[2].toFixed(2)+"] ["+d[0].toFixed(2)+", "+d[1].toFixed(2)+
", "+d[2].toFixed(2)+"]";t.Draw.drawDebugText(c,f,e,2)};t.Actions.actionMap.drawInGameGui=function(a,b){b.drawGUI()};t.Actions.actionMap.draw2dCursor=function(a,b){var c=b.getGuiManager(),d=t.State.v2CursorScreenLocation;c.addDrawGui("editorCursor",{x:d[0],y:d[1]})};t.Actions.actionMap.setSaveAsLevelName=function(a,b,c){t.State.saveAsLevelName=c.text};t.Actions.actionMap.saveLevelToLocalAsSingleFile=function(a,b,c){var d=c.text||t.State.saveAsLevelName,b=ra.Serialize.serializeLevelIntoSingleSave(b,
!0),c="/local/v1/save/"+a.gameSession.gameSlug,c=c+"/"+t.State.saveLevelDirectory,c=c+"/",c=c+d,c=c+t.State.singleSaveFileNameEnding,c=c+".",c=c+t.State.levelFileExtension;ra.SaveLoad.saveLevelToLocal(c,b,a.requestHandler,function(){t.State.currentLevelName=d;t.State.saveAsLevelName=d},function(){})};t.Actions.actionMap.saveLevelToLocalAsSeparateLevelAndPlayerSave=function(a,b,c){var d=c.text||t.State.saveAsLevelName,c=ra.Serialize.serializeLevelSave(b,!0),b=ra.Serialize.serializePlayerSave(b,!0),
f=a.gameSession.gameSlug,g;g="/local/v1/save/"+f+"/";g+=t.State.saveLevelDirectory;g+="/";g+=d;g+=t.State.levelSaveFileNameEnding;g+=".";g+=t.State.levelFileExtension;var f="/local/v1/save/"+f+"/",f=f+t.State.saveLevelDirectory,f=f+"/",f=f+d,f=f+t.State.playerSaveFileNameEnding,f=f+".",f=f+t.State.levelFileExtension,a=a.requestHandler,e=0,n=function(){e+=1;2<=e&&(t.State.currentLevelName=d,t.State.saveAsLevelName=d)};ra.SaveLoad.saveLevelToLocal(g,c,a,n,function(){});ra.SaveLoad.saveLevelToLocal(f,
b,a,n,function(){})};t.Actions.actionMap.loadLevelFromLocalAsSingleFile=function(a,b,c){var d=c.text,f=t.State.loadLevelDirectory,f=f+"/"+d,f=f+".json";ra.SaveLoad.loadLevelFromLocal(f,a.requestHandler,function(f,e){var n=b.getBlockFactory(),j=b.getEntityFactory(),n=ra.Parse.parseLevelData(e,n,j,a);b.setCurrentLevel(n);t.State.currentLevelName=d;t.State.saveAsLevelName=d;t.Actions.actionMap.buildBlockAABBTree(a,b,c);t.Actions.actionMap.buildEntityAABBTree(a,b,c)},function(){})};t.Actions.actionMap.loadLevel=
function(a,b,c){var d=c.text,f=t.State.loadLevelDirectory,f=f+"/"+d,f=f+t.State.levelSaveFileNameEnding,f=f+".json",g=t.State.loadLevelDirectory,g=g+"/"+d,g=g+t.State.playerSaveFileNameEnding,g=g+".json",e=a.requestHandler,n=null,j=null,i=function(f,g,e){var f=b.getBlockFactory(),h=b.getEntityFactory(),g=ra.Parse.parseLevelDataFromLevelAndPlayerSave({levelSaveData:g,playerSaveData:e},f,h,a);b.setCurrentLevel(g);t.State.currentLevelName=d;t.State.saveAsLevelName=d;t.Actions.actionMap.buildBlockAABBTree(a,
b,c);t.Actions.actionMap.buildEntityAABBTree(a,b,c)};ra.SaveLoad.loadLevelFromLocal(f,e,function(a,b){(n=b)&&j&&i(a,n,j)},function(){});ra.SaveLoad.loadLevelFromLocal(g,e,function(a,b){j=b;n&&j&&i(a,n,j)},function(){})};t.Actions.actionMap.listLocalLevelFiles=function(a){var b;b="/local/v1/list/"+a.gameSession.gameSlug;b+="/files";b+="/";b+=t.State.loadLevelDirectory;ra.SaveLoad.listLocalLevelFiles(b,a.requestHandler,function(a,b){t.State.levelNameList=b.map(function(a){return a.substring(0,a.indexOf("."))})},
function(){})};nf.prototype={update:function(){var a=!1;if(0!==this.turn||0!==this.pitch)a=!0,this.rotate(this.turn,this.pitch),this.pitch=this.turn=0;0<this.step?this.forward+=this.step:0>this.step&&(this.backward-=this.step);var b=this.right-this.left,c=this.up-this.down,d=this.forward-this.backward;if(0!==b||0!==c||0!==d)a=!0,this.translate(b,c,d),0<this.step?(this.forward-=this.step,this.step=0):0>this.step&&(this.backward+=this.step,this.step=0);a&&this.camera.updateViewMatrix();this.down=this.up=
this.backward=this.forward=this.right=this.left=0},moveLeft:function(a){this.left+=a},moveRight:function(a){this.right+=a},moveForward:function(a){this.forward+=a},moveBackward:function(a){this.backward+=a},moveDown:function(a){this.up+=a},moveUp:function(a){this.down+=a},zoom:function(a){this.step=a},look:function(a,b){this.turn+=a;this.pitch+=b},rotateSpeed:2,maxSpeed:1,mouseRotateFactor:0.1,rotate:function(a,b){var c=Math.PI/180,d=this.md,f=this.camera.matrix,g=d.m43Pos(f);d.m43SetPos(f,d.v3BuildZero());
var e;0!==b&&(b*=this.rotateSpeed*c,b*=this.mouseRotateFactor,e=d.v3Normalize(d.m43Right(f)),d.m43SetRight(f,e),e=d.m43FromAxisRotation(e,b),f=d.m43Mul(f,e));0!==a&&(a*=this.rotateSpeed*c,a*=this.mouseRotateFactor,e=d.m43FromAxisRotation(d.v3BuildYAxis(),a),f=d.m43Mul(f,e));d.m43SetPos(f,g);this.camera.matrix=f},translate:function(a,b,c){var d=this.md,f=this.camera.matrix,g=d.m43Pos(f),e=this.maxSpeed,g=d.v3Add4(g,d.v3ScalarMul(d.m43Right(f),e*a),d.v3ScalarMul(d.m43Up(f),e*b),d.v3ScalarMul(d.m43At(f),
-(e*c)));d.m43SetPos(f,g)}};nf.create=function(a,b){var c=new nf;c.graphicsDevice=a;c.camera=b;c.md=b.md;c.turn=0;c.pitch=0;c.right=0;c.left=0;c.up=0;c.down=0;c.forward=0;c.backward=0;c.step=0;return c};t.Conditions={conditionMap:{keyPress:function(a,b,c,d){return t.Input.wasKeyPressed(b,c,d[a.key])},keyRelease:function(a,b,c,d){return t.Input.wasKeyReleased(b,c,d[a.key])},keyDown:function(a,b,c,d){return t.Input.isKeyDown(b,d[a.key])},keyUp:function(a,b,c,d){return!t.Input.isKeyDown(b,d[a.key])},
mouseDown:function(a,b,c,d,f){return t.Input.isMouseDown(b,f[a.button])},mouseUp:function(a,b,c,d,f){return!t.Input.isMouseDown(b,f[a.button])},mousePress:function(a,b,c,d,f){return t.Input.wasMousePressed(b,c,f[a.button])},mouseRelease:function(a,b,c,d,f){return t.Input.wasMouseReleased(b,c,f[a.button])},mouseEnter:function(a,b){return t.Input.wasMouseEntered(b)},mouseLeave:function(a,b){return t.Input.wasMouseLeft(b)},blur:function(a,b){return t.Input.wasBlurred(b)},mouseMoveX:function(a,b){var c=
t.Input.getMouseDeltaX(b);return c?{delta:c}:!1},mouseMoveY:function(a,b){var c=t.Input.getMouseDeltaY(b);return c?{delta:c}:!1},mouseOver:function(a,b){var c=t.Input.getMouseX(b),d=t.Input.getMouseY(b);return c||d?{x:c,y:d}:!1},mouseMove:function(a,b){var c=t.Input.getMouseDeltaX(b),d=t.Input.getMouseDeltaY(b);return c||d?{deltaX:c,deltaY:d}:!1},mouseWheel:function(a,b){var c=t.Input.getMouseWheelDelta(b);return c?{delta:c}:!1},hasSelectedObjects:function(){return t.State.selectedObjectGroup},hasNoSelectedObjects:function(){return!t.State.selectedObjectGroup},
isObjectAtCursorSelected:function(){return t.ObjectGroup.isInObjectGroup(t.State.selectedObjectGroup,t.State.objectAtCursor)},isObjectAtCursorUnselected:function(){return!t.ObjectGroup.isInObjectGroup(t.State.selectedObjectGroup,t.State.objectAtCursor)},isWidgetAtCursor:function(){return null!==t.State.widgetAtCursor},hasNoWidgetAtCursor:function(){return null===t.State.widgetAtCursor},isWidgetXAtCursor:function(){var a=t.State.widgetAtCursor;return a&&0===a.axis},isWidgetYAtCursor:function(){var a=
t.State.widgetAtCursor;return a&&1===a.axis},isWidgetZAtCursor:function(){var a=t.State.widgetAtCursor;return a&&2===a.axis},isDragging:function(){return null!==t.State.startDragState},isNotDragging:function(){return null===t.State.startDragState},isFlagOn:function(a){return t.State.flags[a.name]?!0:!1},isFlagOff:function(a){return t.State.flags[a.name]?!1:!0},isSet:function(a){return null!==t.getEditorStateFromName(a.name)},isNotSet:function(a){return null===t.getEditorStateFromName(a.name)},uiElementInteract:function(a,
b,c,d,f,g){return g[a.id]}}};t.Controller={convertControlsIntoActions:function(a,b,c,d,f,g,e){var n=e?e.keyCodes:null,j=e?e.mouseCodes:null,a=a.filter(function(a){return t.Controller.testConditionList(a.conditionList,b,d,f,n,j,g)}).map(function(a){return t.Controller.convertControlListToActions(a.controlList,b,c,d,f,e,g)}),i=[];return i.concat.apply(i,a)},convertControlListToActions:function(a,b,c,d,f,g,e){var n=a.length,j=[],i=g?g.keyCodes:null,g=g?g.mouseCodes:null,l,m,k;for(l=0;l<n;l+=1)if(m=a[l],
k=t.Controller.testConditionList(m.conditionList,b,d,f,i,g,e))m=m.actionNameList,k=t.Actions.createActionList(m,c,k),j.push.apply(j,k);return j},testConditionList:function(a,b,c,d,f,g,e){var n=a.length,j,i;if(0===n)return!0;for(j=0;j<n;j+=1)if(i=a[j],i=b[i.type](i,c,d,f,g,e),!i)return!1;return i}};t.Draw={drawEntityExtents:function(a,b,c,d){a.toBeDestroyed||(a=t.getEditorEntityExtents(a,d),t.Draw.drawExtents(a,b,c))},drawBlockExtents:function(a,b,c){var d=a.meshNode,a=d?d.calculateHierarchyWorldExtents():
a.getWorldCube().getExtents();t.Draw.drawExtents(a,b,c)},drawExtents:function(a,b,c){c.drawDebugExtents(a,b[0],b[1],b[2])},drawDebugText:function(a,b,c,d){a.drawFontDouble(c,{x:b[0],y:b[1],pointSize:16,alignment:d||0})}};t.Input={state:{pressedKeys:{},pressedButtons:{},mouseDeltaX:0,mouseDeltaY:0,mouseX:0,mouseY:0,mouseWheelDelta:0,mouseEnter:!1,mouseLeave:!1,blur:!1},previousState:{pressedKeys:{},pressedButtons:{},mouseDeltaX:0,mouseDeltaY:0,mouseX:0,mouseY:0,mouseWheelDelta:0,mouseEnter:!1,mouseLeave:!1,
blur:!1},eventHandlersActive:!1,getCurrentState:function(){return t.Input.state},getPreviousState:function(){return t.Input.previousState},clearState:function(){var a=t.Input.state;a.pressedKeys={};a.pressedButtons={}},updateState:function(){t.Input.previousState=t.Input.state;var a=t.Input.previousState.pressedKeys,b=t.Input.previousState.pressedButtons,c={},d={},f,g;for(f in a)a.hasOwnProperty(f)&&(c[f]=a[f]);for(g in b)b.hasOwnProperty(g)&&(d[g]=b[g]);t.Input.state={pressedKeys:c,pressedButtons:d,
mouseDeltaX:0,mouseDeltaY:0,mouseX:0,mouseY:0,mouseWheelDelta:0,mouseEnter:!1,mouseLeave:!1,blur:!1}},isMouseDown:function(a,b){return a.pressedButtons[b]?!0:!1},wasMousePressed:function(a,b,c){return a.pressedButtons[c]&&!b.pressedButtons[c]},wasMouseReleased:function(a,b,c){return!a.pressedButtons[c]&&b.pressedButtons[c]},isKeyDown:function(a,b){return a.pressedKeys[b]?!0:!1},wasKeyPressed:function(a,b,c){return a.pressedKeys[c]&&!b.pressedKeys[c]},wasKeyReleased:function(a,b,c){return!a.pressedKeys[c]&&
b.pressedKeys[c]},wasMouseEntered:function(a){return a.mouseEnter},wasMouseLeft:function(a){return a.mouseLeave},wasBlurred:function(a){return a.wasBlurred},getMouseDeltaX:function(a){return a.mouseDeltaX},getMouseX:function(a){return a.mouseX},getMouseY:function(a){return a.mouseY},getMouseDeltaY:function(a){return a.mouseDeltaY},getMouseWheelDelta:function(a){return a.mouseWheelDelta},onKeyDown:function(a){this.state.pressedKeys[a]=!0},onKeyUp:function(a){this.state.pressedKeys[a]=!1},onMouseDown:function(a){this.state.pressedButtons[a]=
!0;a===this.inputDevice.mouseCodes.BUTTON_1&&(this.inputDevice.lockMouse(),this.inputDevice.hideMouse())},onMouseUp:function(a){this.state.pressedButtons[a]=!1;a===this.inputDevice.mouseCodes.BUTTON_1&&(this.inputDevice.unlockMouse(),this.inputDevice.showMouse())},onMouseMove:function(a,b){this.state.mouseDeltaX+=a;this.state.mouseDeltaY+=b},onMouseOver:function(a,b){this.state.mouseX=a;this.state.mouseY=b},onMouseWheel:function(a){this.state.mouseWheelDelta+=a},onMouseEnter:function(){this.state.mouseEnter=
!0},onMouseLeave:function(){this.state.mouseLeave=!0},onBlur:function(){this.clearState();this.state.blur=!0},addEventHandlers:function(a){t.Input.eventHandlersActive=!0;this.onKeyUpBound||(this.onKeyUpBound=this.onKeyUp.bind(this),this.onKeyDownBound=this.onKeyDown.bind(this),this.onMouseUpBound=this.onMouseUp.bind(this),this.onMouseDownBound=this.onMouseDown.bind(this),this.onMouseMoveBound=this.onMouseMove.bind(this),this.onMouseWheelBound=this.onMouseWheel.bind(this),this.onMouseOverBound=this.onMouseOver.bind(this),
this.onMouseEnterBound=this.onMouseEnter.bind(this),this.onMouseLeaveBound=this.onMouseLeave.bind(this),this.onBlurBound=this.onBlur.bind(this));a.addEventListener("keyup",this.onKeyUpBound);a.addEventListener("keydown",this.onKeyDownBound);a.addEventListener("mouseup",this.onMouseUpBound);a.addEventListener("mousedown",this.onMouseDownBound);a.addEventListener("mousemove",this.onMouseMoveBound);a.addEventListener("mousewheel",this.onMouseWheelBound);a.addEventListener("mouseover",this.onMouseOverBound);
a.addEventListener("mouseenter",this.onMouseEnterBound);a.addEventListener("mouseleave",this.onMouseLeaveBound);a.addEventListener("blur",this.onBlurBound);this.inputDevice=a},removeEventHandlers:function(a){t.Input.eventHandlersActive=!1;a.removeEventListener("keyup",this.onKeyUpBound);a.removeEventListener("keydown",this.onKeyDownBound);a.removeEventListener("mouseup",this.onMouseUpBound);a.removeEventListener("mousedown",this.onMouseDownBound);a.removeEventListener("mousemove",this.onMouseMoveBound);
a.removeEventListener("mousewheel",this.onMouseWheelBound);a.removeEventListener("mouseover",this.onMouseOverBound);a.removeEventListener("mouseenter",this.onMouseEnterBound);a.removeEventListener("mouseleave",this.onMouseLeaveBound);a.removeEventListener("blur",this.onBlurBound);delete this.inputDevice}};t.ObjectGroup={createNewObjectGroup:function(){return{v3Location:null,YRotation:null,v3Scale:null,objectList:[]}},addObjectToObjectGroup:function(a,b,c){a.objectList.push(b);return a=t.ObjectGroup.updateObjectGroupValues(a,
c)},removeObjectFromObjectGroup:function(a,b,c){a.objectList=a.objectList.filter(function(a){return a!==b});a=t.ObjectGroup.updateObjectGroupValues(a,c);return 0===a.objectList.length?null:a},updateObjectGroupValues:function(a,b){a.v3Location=t.ObjectGroup.getV3ObjectGroupCentre(a,b);if(1===a.objectList.length){var c=a.objectList[0];a.rotationY=c.getRotationY();a.v3Scale=b.v3Copy(c.getV3Scale())}else a.rotationY=0,a.v3Scale=b.v3BuildOne();return a},isInObjectGroup:function(a,b){return 0<a.objectList.filter(function(a){return a===
b}).length},getV3ObjectGroupCentre:function(a,b){var c=b.v3BuildZero(),d=a.objectList,c=d.reduce(function(a,c){var d=c.getv3Location();b.v3Add(d,a,a);return a},c);b.v3ScalarMul(c,1/d.length,c);return c},selectObject:function(a,b,c){return c.isBlock?t.ObjectGroup.selectBlock(b,c):t.ObjectGroup.selectEntity(b,a,c)},selectBlock:function(a,b){var c=a.getEntityFactory(),d=a.getBlockFactory(),f=b.archetypeName,g=b.getv3Location(),e=b.getV3Scale(),n=b.getRotationY(),j=a.getGameSpace(b.getv3Location());b.removeFromGameSpace(j);
b.destroy();j.finalizeIfNeeded();c=t.createEditorObjectFromBlockArchetype(g,e,n,f,d,c);t.addEntity(c);t.removeBlock(b);return c},selectEntity:function(a,b,c){var d=a.getEntityFactory(),f=c.archetypeName,g=c.getv3Location();if(!f)return null;var e=c.getEC("ECMesh"),e=e?e.getV3ScaleToManipulate():c.getV3Scale(),n=c.getRotationY();c.setToBeDestroyed();a=a.getGameSpace(g);a.destroyDeadEntities();a.finalizeIfNeeded();d=t.createEditorObjectFromEntityArchetype(g,e,n,f,d);t.addEntity(d,b.mathDevice);t.removeEntity(c);
return d},placeObjectGroup:function(a,b,c){a.objectList.forEach(function(a){t.ObjectGroup.placeObject(b,c,a)})},placeObject:function(a,b,c){c.isFromBlock?t.ObjectGroup.placeBlock(a,c):t.ObjectGroup.placeEntity(a,b,c)},placeBlock:function(a,b){var c=a.getBlockFactory(),d=b.getv3Location(),f=a.getGameSpace(d);if(f){var g=b.archetypeName,e=b.getV3Scale(),n=b.getRotationY(),c=c.createBlockInstance(g,d,e,n);c.addToGameSpace(f);f.finalizeIfNeeded();t.addBlock(c)}},placeEntity:function(a,b,c){var d=a.getEntityFactory(),
f=c.getv3Location(),g=a.getGameSpace(f);if(g){var e=c.archetypeName,n=a.uniquifyLevelEntityName(e),d=d.createInactiveEntityInstance(n,e,f),f=c.getV3Scale();d.setV3Scale(f);c=c.getRotationY();d.setRotationY(c);if(c=d.getEC("ECFaction"))a=a.getFactionManager().getHeroFactionName(),c.setFaction(a);d.activate();d.update(void 0,!0);g.finalizeIfNeeded();t.addEntity(d,b)}},discardObjectGroup:function(a){a.objectList.forEach(t.ObjectGroup.discardObject)},discardObject:function(a){a.setToBeDestroyed();var b=
a.getGameSpace();b&&b.destroyDeadEntities();t.removeEntity(a)},translateObjectGroupInAxis:function(a,b,c,d,f,g){t.ObjectGroup.setObjectGroupLocationInAxis(a,b,c,c.v3Location[f]+d,f,g)},setObjectGroupLocationInAxis:function(a,b,c,d,f,g){var e=a.mathDevice,n=c.objectList,c=c.v3Location,j;if(g)if(1===n.length){var g=n[0],i=e.v3Copy(g.getv3Location());i[f]=d;i=t.getSnappedEntityLocation(a,b,g,i,f);d=i[f]}else j=d-c[f],j=Math.round(j),d=c[f]+j;j=d-c[f];c[f]=d;n.forEach(function(a){var b=j,c=e.v3Copy(a.getv3Location());
c[f]+=b;a.setv3Location(c);a.update(void 0,!0);t.updateEntity(a,e)})},rotateObjectGroupInYAxis:function(a,b,c,d){t.ObjectGroup.setObjectGroupRotationY(a,b,b.rotationY+c,d)},setObjectGroupRotationY:function(a,b,c,d){var f=a.mathDevice,a=Math.PI/4;d&&(c=Math.round(c/a)*a);var g=c-b.rotationY;b.rotationY=c;b.objectList.forEach(function(a){var b=a.getRotationY(),b=b+g;a.setRotationY(b);a.update(void 0,!0);t.updateEntity(a,f)})},scaleObjectGroupInAxis:function(a,b,c,d,f,g){t.ObjectGroup.setObjectGroupScaleInAxis(a,
b,c,d,c.v3Scale[d]+f,g)},setObjectGroupScaleInAxis:function(a,b,c,d,f,g){var e=a.mathDevice;g&&(f=1*Math.round(f/1));var a=c.v3Scale,n=f-a[d];a[d]=f;c.objectList.forEach(function(a){var b=e.v3Copy(a.getV3Scale());b[d]+=n;a.setV3Scale(b);a.update(void 0,!0);t.updateEntity(a,e)})}};t.Settings={saveLevelDirectory:"levels",loadLevelDirectory:"levels",levelFileExtension:"json",levelSaveFileNameEnding:"_levelsave",playerSaveFileNameEnding:"_playersave",singleSaveFileNameEnding:"",selectedEntityExtentsColour:[0,
1,0],objectAtCursorExtentsColour:[1,0,1],gameSpaceExtentsColour:[1,1,1],positionFactor:0.04,rotationFactor:0.01,scaleFactor:0.01,controlLists:[],drawControlLists:[],draw2dControlLists:[],cameraZoomSpeed:2.5,cameraLookSpeed:1,cameraMovementSpeed:1,uiGroupName:"Editor",actionListOnEnterEditorMode:["listLocalLevelFiles","unlockMouse","enableBlockMovement","buildBlockAABBTree","buildEntityAABBTree","buildWidgetAABBTree","enableEditorECDebugDrawing",{type:"setFlagOn",params:{name:"drawSelectedObjectName"}},
{type:"setFlagOn",params:{name:"drawObjectAtCursorName"}},{type:"setFlagOn",params:{name:"drawCameraLocation"}},{type:"setFlagOn",params:{name:"drawCurrentLevelName"}},{type:"setFlagOn",params:{name:"enableBlockSelection"}},{type:"setFlagOn",params:{name:"enableEntitySelection"}},{type:"setFlagOn",params:{name:"enableGridSnap"}},{type:"setFlagOn",params:{name:"enablePositionMode"}},{type:"setFlagOff",params:{name:"doInGameButtons"}},{type:"setFlagOff",params:{name:"drawCursor"}},{type:"setFlagOff",
params:{name:"drawCursor2d"}},{type:"setFlagOff",params:{name:"drawCursorLocation"}},{type:"setFlagOff",params:{name:"drawOuterCursor"}},{type:"setFlagOff",params:{name:"drawFlagStates"}},{type:"setFlagOff",params:{name:"enableFreeCamLook"}},{type:"setFlagOff",params:{name:"enableMultipleObjectSelection"}},{type:"setFlagOff",params:{name:"enablePositionX"}},{type:"setFlagOff",params:{name:"enablePositionY"}},{type:"setFlagOff",params:{name:"enablePositionZ"}},{type:"setFlagOff",params:{name:"enableRotationMode"}},
{type:"setFlagOff",params:{name:"enableRotationX"}},{type:"setFlagOff",params:{name:"enableScaleMode"}},{type:"setFlagOff",params:{name:"enableScaleX"}},{type:"setFlagOff",params:{name:"enableScaleY"}},{type:"setFlagOff",params:{name:"enableScaleZ"}},{type:"setFlagOff",params:{name:"enableScreenshotMode"}},{type:"setFlagOff",params:{name:"enableXAxisScaling"}},{type:"setFlagOff",params:{name:"enableYAxisScaling"}},{type:"setFlagOff",params:{name:"enableZAxisScaling"}},{type:"setFlagOff",params:{name:"enableXZPlaneDrag"}}],
actionListOnExitEditorMode:["disableBlockMovement","disableEditorECDebugDrawing"],uiElementList:[{id:"saveAsLevelName",type:"textBox",getValue:"getSaveAsLevelName",title:"Save Name"},{id:"save",type:"button",buttonText:"Save"},{id:"load",type:"selectBoxWithSubmitButton",valueListName:"levelNameList",buttonText:"Load"},{id:"refreshLevelFiles",type:"button",buttonText:"Refresh Level Filenames"},{id:"editorControlSeparatorFiles",title:". ",type:"text",text:""},{id:"setSelectedObjectWorldLocationX",type:"numberBox",
title:"Position x",getValue:"getSelectedObjectWorldLocationX"},{id:"setSelectedObjectWorldLocationY",type:"numberBox",title:"Position y",getValue:"getSelectedObjectWorldLocationY"},{id:"setSelectedObjectWorldLocationZ",type:"numberBox",title:"Position z",getValue:"getSelectedObjectWorldLocationZ"},{id:"editorControlSeparatorPosition",title:". ",type:"text",text:""},{id:"setSelectedObjectScaleX",type:"numberBox",title:"Scale x",getValue:"getSelectedObjectScaleX"},{id:"setSelectedObjectScaleY",type:"numberBox",
title:"Scale y",getValue:"getSelectedObjectScaleY"},{id:"setSelectedObjectScaleZ",type:"numberBox",title:"Scale z",getValue:"getSelectedObjectScaleZ"},{id:"editorControlSeparatorRotation",title:". ",type:"text",text:""},{id:"setSelectedObjectRotationY",type:"numberBox",title:"Rotate y",getValue:"getSelectedObjectRotationYInDegrees"},{id:"editorControlSeparatorEntity",title:". ",type:"text",text:""},{id:"addEntity",title:"Entities",type:"selectBoxWithSubmitButton",valueListName:"entityArchetypeList",
buttonText:"Add"},{id:"addBlock",title:"Blocks",type:"selectBoxWithSubmitButton",valueListName:"blockArchetypeList",buttonText:"Add"},{id:"selectAllBlocksOfArchetype",title:"Select Blocks",type:"selectBoxWithSubmitButton",valueListName:"blockArchetypeList",buttonText:"Select All"},{id:"removeAllEntities",type:"button",buttonText:"Clear Entities"},{id:"createNewLevel",type:"button",buttonText:"Create New Level"},{id:"enableBlockSelection",title:"Enable Block Selection",type:"checkbox",flagName:"enableBlockSelection"},
{id:"enableEntitySelection",title:"Enable Entity Selection",type:"checkbox",flagName:"enableEntitySelection"},{id:"editorControlSeparator0",title:". ",type:"text",text:""},{id:"editorControls",title:"Controls:",type:"text",text:""},{id:"editorControlSeparator1",title:". ",type:"text",text:""},{id:"editorControlsFreeCamTranslate",title:"Translate cam",type:"text",text:"RMB + WASD"},{id:"editorControlsFreeCamLook",title:"Cam look:",type:"text",text:"RMB + MOUSE MOVE"},{id:"editorControlsPositionMode",
title:"Position mode",type:"text",text:"W"},{id:"editorControlsRotationMode",title:"Rotation mode",type:"text",text:"E"},{id:"editorControlsScaleMode",title:"Scale mode",type:"text",text:"R"},{id:"editorControlsDuplicate",title:"Duplicate",type:"text",text:"LEFT CTRL + D"},{id:"editorControlsAddToSelection",title:"Add/remove from selection",type:"text",text:"LEFT CTRL + LMB"}]};t.Settings.controlLists.push({conditionList:[],controlList:[{conditionList:[{type:"keyPress",key:"RETURN"}],actionNameList:["placeSelectedObjects",
"discardSelectedObjects","toggleEditorMode"]},{conditionList:[{type:"keyPress",key:"P"}],actionNameList:["togglePause",{type:"toggleFlag",params:{name:"doInGameButtons"}}]},{conditionList:[],actionNameList:["updateBlockAABBTree","updateEntityAABBTree","buildWidgetAABBTree"]},{conditionList:[{type:"keyPress",key:"W"},{type:"isFlagOff",name:"enableFreeCamLook"}],actionNameList:[{type:"setFlagOn",params:{name:"enablePositionMode"}},{type:"setFlagOff",params:{name:"enableRotationMode"}},{type:"setFlagOff",
params:{name:"enableScaleMode"}}]},{conditionList:[{type:"keyPress",key:"E"},{type:"isFlagOff",name:"enableFreeCamLook"}],actionNameList:[{type:"setFlagOff",params:{name:"enablePositionMode"}},{type:"setFlagOn",params:{name:"enableRotationMode"}},{type:"setFlagOff",params:{name:"enableScaleMode"}}]},{conditionList:[{type:"keyPress",key:"R"},{type:"isFlagOff",name:"enableFreeCamLook"}],actionNameList:[{type:"setFlagOff",params:{name:"enablePositionMode"}},{type:"setFlagOff",params:{name:"enableRotationMode"}},
{type:"setFlagOn",params:{name:"enableScaleMode"}}]},{conditionList:[{type:"isFlagOn",name:"doInGameButtons"}],actionNameList:["doGameButtons"]},{conditionList:[{type:"mouseOver"}],actionNameList:["setCursorScreenLocation","updateObjectAtCursor","updateWidgetAtCursor"]},{conditionList:[{type:"hasNoSelectedObjects"},{type:"isSet",name:"objectAtCursor"},{type:"isFlagOff",name:"enableFreeCamLook"},{type:"mouseRelease",button:"BUTTON_0"}],actionNameList:["selectObject"]},{conditionList:[{type:"keyPress",
key:"LEFT_CONTROL"}],actionNameList:[{type:"setFlagOn",params:{name:"enableMultipleObjectSelection"}},{type:"setFlagOn",params:{name:"enableMultipleObjectSelection"}}]},{conditionList:[{type:"keyRelease",key:"LEFT_CONTROL"}],actionNameList:[{type:"setFlagOff",params:{name:"enableMultipleObjectSelection"}},{type:"setFlagOff",params:{name:"enableMultipleObjectSelection"}}]},{conditionList:[{type:"keyPress",key:"NUMBER_1"}],actionNameList:[{type:"setFlagOn",params:{name:"enableXAxisScaling"}}]},{conditionList:[{type:"keyRelease",
key:"NUMBER_1"}],actionNameList:[{type:"setFlagOff",params:{name:"enableXAxisScaling"}}]},{conditionList:[{type:"keyPress",key:"NUMBER_2"}],actionNameList:[{type:"setFlagOn",params:{name:"enableYAxisScaling"}}]},{conditionList:[{type:"keyRelease",key:"NUMBER_2"}],actionNameList:[{type:"setFlagOff",params:{name:"enableYAxisScaling"}}]},{conditionList:[{type:"keyPress",key:"NUMBER_3"}],actionNameList:[{type:"setFlagOn",params:{name:"enableZAxisScaling"}}]},{conditionList:[{type:"keyRelease",key:"NUMBER_3"}],
actionNameList:[{type:"setFlagOff",params:{name:"enableZAxisScaling"}}]},{conditionList:[{type:"keyPress",key:"CAPS_LOCK"}],actionNameList:[{type:"toggleFlag",params:{name:"enableGridSnap"}}]},{conditionList:[{type:"mousePress",button:"BUTTON_1"}],actionNameList:[{type:"setFlagOn",params:{name:"enableFreeCamLook"}},"lockMouse","hideMouse",{type:"setFlagOn",params:{name:"drawCursor2d"}}]},{conditionList:[{type:"mouseRelease",button:"BUTTON_1"}],actionNameList:[{type:"setFlagOff",params:{name:"enableFreeCamLook"}},
"unlockMouse","showMouse",{type:"setFlagOff",params:{name:"drawCursor2d"}}]},{conditionList:[{type:"keyPress",key:"B"},{type:"isFlagOff",name:"enableScreenshotMode"}],actionNameList:[{type:"setFlagOn",params:{name:"enableScreenshotMode"}},"disableEditorECDebugDrawing"]},{conditionList:[{type:"keyPress",key:"B"},{type:"isFlagOn",name:"enableScreenshotMode"}],actionNameList:[{type:"setFlagOff",params:{name:"enableScreenshotMode"}},"enableEditorECDebugDrawing"]},{conditionList:[{type:"keyPress",key:"F"}],
actionNameList:[{type:"toggleFlag",params:{name:"drawFlagStates"}}]}]});t.Settings.controlLists.push({conditionList:[],controlList:[{conditionList:[{type:"uiElementInteract",id:"saveAsLevelName"}],actionNameList:["setSaveAsLevelName"]},{conditionList:[{type:"uiElementInteract",id:"save"}],actionNameList:["placeSelectedObjects","discardSelectedObjects","saveLevelToLocalAsSeparateLevelAndPlayerSave","saveLevelToLocalAsSingleFile"]},{conditionList:[{type:"uiElementInteract",id:"load"}],actionNameList:["clearObjectAtCursor",
"discardSelectedObjects","loadLevelFromLocalAsSingleFile"]},{conditionList:[{type:"uiElementInteract",id:"refreshLevelFiles"}],actionNameList:["listLocalLevelFiles"]},{conditionList:[{type:"uiElementInteract",id:"setSelectedObjectWorldLocationX"}],actionNameList:[{type:"setSelectedObjectsLocationInAxis",params:{axis:0}}]},{conditionList:[{type:"uiElementInteract",id:"setSelectedObjectWorldLocationY"}],actionNameList:[{type:"setSelectedObjectsLocationInAxis",params:{axis:1}}]},{conditionList:[{type:"uiElementInteract",
id:"setSelectedObjectWorldLocationZ"}],actionNameList:[{type:"setSelectedObjectsLocationInAxis",params:{axis:2}}]},{conditionList:[{type:"uiElementInteract",id:"setSelectedObjectScaleX"}],actionNameList:[{type:"setSelectedObjectsScaleInAxis",params:{axis:0}}]},{conditionList:[{type:"uiElementInteract",id:"setSelectedObjectScaleY"}],actionNameList:[{type:"setSelectedObjectsScaleInAxis",params:{axis:1}}]},{conditionList:[{type:"uiElementInteract",id:"setSelectedObjectScaleZ"}],actionNameList:[{type:"setSelectedObjectsScaleInAxis",
params:{axis:2}}]},{conditionList:[{type:"uiElementInteract",id:"setSelectedObjectRotationY"}],actionNameList:["setSelectedObjectsRotationYInDegrees"]},{conditionList:[{type:"uiElementInteract",id:"addEntity"}],actionNameList:["placeSelectedObjects","discardSelectedObjects","addNewSelectedEntity"]},{conditionList:[{type:"uiElementInteract",id:"addBlock"}],actionNameList:["placeSelectedObjects","discardSelectedObjects","addNewSelectedBlock"]},{conditionList:[{type:"uiElementInteract",id:"selectAllBlocksOfArchetype"}],
actionNameList:["placeSelectedObjects","discardSelectedObjects","selectAllBlocksOfArchetype"]},{conditionList:[{type:"uiElementInteract",id:"removeAllEntities"}],actionNameList:["removeAllEntitiesFromLevel"]},{conditionList:[{type:"uiElementInteract",id:"createNewLevel"}],actionNameList:["discardSelectedObjects","clearObjectAtCursor","createNewLevel","buildBlockAABBTree","buildEntityAABBTree"]},{conditionList:[{type:"uiElementInteract",id:"enableBlockSelection"}],actionNameList:[{type:"toggleFlag",
params:{name:"enableBlockSelection"}}]},{conditionList:[{type:"uiElementInteract",id:"enableEntitySelection"}],actionNameList:[{type:"toggleFlag",params:{name:"enableEntitySelection"}}]}]});t.Settings.controlLists.push({conditionList:[{type:"isFlagOn",name:"enablePositionMode"},{type:"hasSelectedObjects"}],controlList:[{conditionList:[{type:"mousePress",button:"BUTTON_0"},{type:"hasNoWidgetAtCursor"},{type:"isObjectAtCursorSelected"}],actionNameList:[{type:"setFlagOn",params:{name:"enablePositionX"}},
{type:"setFlagOn",params:{name:"enablePositionZ"}},"startDrag"]},{conditionList:[{type:"mouseRelease",button:"BUTTON_0"}],actionNameList:[{type:"setFlagOff",params:{name:"enablePositionX"}},{type:"setFlagOff",params:{name:"enablePositionZ"}},"endDrag"]},{conditionList:[{type:"isFlagOn",name:"enablePositionX"},{type:"mouseOver"}],actionNameList:[{type:"positionSelectedObjectsFromDragInAxis",params:{axis:0}}]},{conditionList:[{type:"mousePress",button:"BUTTON_0"},{type:"isWidgetXAtCursor"}],actionNameList:[{type:"setFlagOn",
params:{name:"enablePositionX"}},"startDrag"]},{conditionList:[{type:"mouseRelease",button:"BUTTON_0"}],actionNameList:[{type:"setFlagOff",params:{name:"enablePositionX"}},"endDrag"]},{conditionList:[{type:"isFlagOn",name:"enablePositionY"},{type:"mouseOver"}],actionNameList:[{type:"positionSelectedObjectsFromDragInAxis",params:{axis:1}}]},{conditionList:[{type:"mousePress",button:"BUTTON_0"},{type:"isWidgetYAtCursor"}],actionNameList:[{type:"setFlagOn",params:{name:"enablePositionY"}},"startDrag"]},
{conditionList:[{type:"mouseRelease",button:"BUTTON_0"}],actionNameList:[{type:"setFlagOff",params:{name:"enablePositionY"}},"endDrag"]},{conditionList:[{type:"isFlagOn",name:"enablePositionZ"},{type:"mouseOver"}],actionNameList:[{type:"positionSelectedObjectsFromDragInAxis",params:{axis:2}}]},{conditionList:[{type:"mousePress",button:"BUTTON_0"},{type:"isWidgetZAtCursor"}],actionNameList:[{type:"setFlagOn",params:{name:"enablePositionZ"}},"startDrag"]},{conditionList:[{type:"mouseRelease",button:"BUTTON_0"}],
actionNameList:[{type:"setFlagOff",params:{name:"enablePositionZ"}},"endDrag"]},{conditionList:[{type:"keyPress",key:"NUMPAD_4"}],actionNameList:[{type:"translateSelectedObjectsInAxis",params:{axis:0,value:-1}}]},{conditionList:[{type:"keyPress",key:"NUMPAD_6"}],actionNameList:[{type:"translateSelectedObjectsInAxis",params:{axis:0,value:1}}]},{conditionList:[{type:"keyPress",key:"NUMPAD_8"}],actionNameList:[{type:"translateSelectedObjectsInAxis",params:{axis:2,value:-1}}]},{conditionList:[{type:"keyPress",
key:"NUMPAD_2"}],actionNameList:[{type:"translateSelectedObjectsInAxis",params:{axis:2,value:1}}]},{conditionList:[{type:"keyPress",key:"PAGE_DOWN"}],actionNameList:[{type:"translateSelectedObjectsInAxis",params:{axis:1,value:-1}}]},{conditionList:[{type:"keyPress",key:"PAGE_UP"}],actionNameList:[{type:"translateSelectedObjectsInAxis",params:{axis:1,value:1}}]}]});t.Settings.controlLists.push({conditionList:[{type:"isFlagOn",name:"enableRotationMode"},{type:"hasSelectedObjects"}],controlList:[{conditionList:[{type:"isFlagOn",
name:"enableRotationY"},{type:"mouseOver"}],actionNameList:["rotateSelectedObjectsFromDragInYAxis"]},{conditionList:[{type:"mousePress",button:"BUTTON_0"},{type:"isWidgetYAtCursor"}],actionNameList:[{type:"setFlagOn",params:{name:"enableRotationY"}},"startDrag"]},{conditionList:[{type:"mouseRelease",button:"BUTTON_0"}],actionNameList:[{type:"setFlagOff",params:{name:"enableRotationY"}},"endDrag"]},{conditionList:[{type:"isFlagOn",name:"enableGridSnap"},{type:"keyPress",key:"UP"}],actionNameList:[{type:"rotateSelectedObjects",
params:{value:Math.PI/4}}]},{conditionList:[{type:"isFlagOn",name:"enableGridSnap"},{type:"keyPress",key:"DOWN"}],actionNameList:[{type:"rotateSelectedObjects",params:{value:-Math.PI/4}}]},{conditionList:[{type:"isFlagOff",name:"enableGridSnap"},{type:"keyDown",key:"UP"}],actionNameList:[{type:"rotateSelectedObjects",params:{value:Math.PI/64}}]},{conditionList:[{type:"isFlagOff",name:"enableGridSnap"},{type:"keyDown",key:"DOWN"}],actionNameList:[{type:"rotateSelectedObjects",params:{value:-Math.PI/
64}}]}]});t.Settings.controlLists.push({conditionList:[{type:"isFlagOn",name:"enableScaleMode"},{type:"hasSelectedObjects"}],controlList:[{conditionList:[{type:"isFlagOn",name:"enableScaleX"},{type:"mouseOver"}],actionNameList:[{type:"scaleSelectedObjectsFromDragInAxis",params:{axis:0}}]},{conditionList:[{type:"mousePress",button:"BUTTON_0"},{type:"isWidgetXAtCursor"}],actionNameList:[{type:"setFlagOn",params:{name:"enableScaleX"}},"startDrag"]},{conditionList:[{type:"mouseRelease",button:"BUTTON_0"}],
actionNameList:[{type:"setFlagOff",params:{name:"enableScaleX"}},"endDrag"]},{conditionList:[{type:"isFlagOn",name:"enableScaleY"},{type:"mouseOver"}],actionNameList:[{type:"scaleSelectedObjectsFromDragInAxis",params:{axis:1}}]},{conditionList:[{type:"mousePress",button:"BUTTON_0"},{type:"isWidgetYAtCursor"}],actionNameList:[{type:"setFlagOn",params:{name:"enableScaleY"}},"startDrag"]},{conditionList:[{type:"mouseRelease",button:"BUTTON_0"}],actionNameList:[{type:"setFlagOff",params:{name:"enableScaleY"}},
"endDrag"]},{conditionList:[{type:"isFlagOn",name:"enableScaleZ"},{type:"mouseOver"}],actionNameList:[{type:"scaleSelectedObjectsFromDragInAxis",params:{axis:2}}]},{conditionList:[{type:"mousePress",button:"BUTTON_0"},{type:"isWidgetZAtCursor"}],actionNameList:[{type:"setFlagOn",params:{name:"enableScaleZ"}},"startDrag"]},{conditionList:[{type:"mouseRelease",button:"BUTTON_0"}],actionNameList:[{type:"setFlagOff",params:{name:"enableScaleZ"}},"endDrag"]},{conditionList:[{type:"isFlagOn",name:"enableGridSnap"},
{type:"keyPress",key:"UP"}],actionNameList:[{type:"scaleSelectedObjectsInAxis",params:{axis:0,value:1}},{type:"scaleSelectedObjectsInAxis",params:{axis:1,value:1}},{type:"scaleSelectedObjectsInAxis",params:{axis:2,value:1}}]},{conditionList:[{type:"isFlagOn",name:"enableGridSnap"},{type:"keyPress",key:"DOWN"}],actionNameList:[{type:"scaleSelectedObjectsInAxis",params:{axis:0,value:-1}},{type:"scaleSelectedObjectsInAxis",params:{axis:1,value:-1}},{type:"scaleSelectedObjectsInAxis",params:{axis:2,value:-1}}]},
{conditionList:[{type:"isFlagOff",name:"enableGridSnap"},{type:"keyDown",key:"UP"}],actionNameList:[{type:"scaleSelectedObjectsInAxis",params:{axis:0,value:0.1}},{type:"scaleSelectedObjectsInAxis",params:{axis:1,value:0.1}},{type:"scaleSelectedObjectsInAxis",params:{axis:2,value:0.1}}]},{conditionList:[{type:"isFlagOff",name:"enableGridSnap"},{type:"keyDown",key:"DOWN"}],actionNameList:[{type:"scaleSelectedObjectsInAxis",params:{axis:0,value:-0.1}},{type:"scaleSelectedObjectsInAxis",params:{axis:1,
value:-0.1}},{type:"scaleSelectedObjectsInAxis",params:{axis:2,value:-0.1}}]}]});t.Settings.controlLists.push({conditionList:[{type:"hasSelectedObjects"}],controlList:[{conditionList:[{type:"mouseRelease",button:"BUTTON_0"},{type:"isFlagOff",name:"enableMultipleObjectSelection"},{type:"isNotDragging"},{type:"isObjectAtCursorUnselected"}],actionNameList:["placeSelectedObjects","discardSelectedObjects","selectObject"]},{conditionList:[{type:"mouseRelease",button:"BUTTON_0"},{type:"isFlagOn",name:"enableMultipleObjectSelection"},
{type:"isObjectAtCursorUnselected"}],actionNameList:["selectObject"]},{conditionList:[{type:"mouseRelease",button:"BUTTON_0"},{type:"isFlagOn",name:"enableMultipleObjectSelection"},{type:"isObjectAtCursorSelected"}],actionNameList:["removeObject"]},{conditionList:[{type:"keyPress",key:"LEFT_CONTROL"},{type:"keyDown",key:"D"}],actionNameList:["placeSelectedObjects"]},{conditionList:[{type:"keyPress",key:"D"},{type:"keyDown",key:"LEFT_CONTROL"}],actionNameList:["placeSelectedObjects"]},{conditionList:[{type:"keyPress",
key:"DELETE"}],actionNameList:["discardSelectedObjects"]}]});t.Settings.controlLists.push({conditionList:[{type:"isFlagOn",name:"enableFreeCamLook"}],controlList:[{conditionList:[{type:"keyDown",key:"W"}],actionNameList:["freeCamForward"]},{conditionList:[{type:"keyDown",key:"S"}],actionNameList:["freeCamBackward"]},{conditionList:[{type:"keyDown",key:"A"}],actionNameList:["freeCamLeft"]},{conditionList:[{type:"keyDown",key:"D"}],actionNameList:["freeCamRight"]},{conditionList:[{type:"keyDown",key:"Q"}],
actionNameList:["freeCamUp"]},{conditionList:[{type:"keyDown",key:"E"}],actionNameList:["freeCamDown"]},{conditionList:[{type:"mouseMoveX"}],actionNameList:["freeCamTurn"]},{conditionList:[{type:"mouseMoveY"}],actionNameList:["freeCamPitch"]}]});t.Settings.drawControlLists.push({conditionList:[],controlList:[{conditionList:[],actionNameList:["drawGameSpaces"]}]});t.Settings.drawControlLists.push({conditionList:[{type:"isFlagOff",name:"enableScreenshotMode"}],controlList:[{conditionList:[],actionNameList:["drawGameSpaceExtents"]},
{conditionList:[],actionNameList:[{type:"drawEntitiesWithoutMeshes",params:{v3Colour:[0.8,0.8,0.8]}}]},{conditionList:[{type:"isNotDragging"}],actionNameList:["drawObjectAtCursorExtents"]},{conditionList:[{type:"hasSelectedObjects"}],actionNameList:["drawSelectedObjectGroupExtents"]},{conditionList:[{type:"isFlagOn",name:"drawFlagStates"}],actionNameList:["drawEditorFlags"]},{conditionList:[{type:"isFlagOn",name:"drawCurrentLevelName"}],actionNameList:["drawCurrentLevelName"]},{conditionList:[{type:"hasSelectedObjects"},
{type:"isFlagOn",name:"drawSelectedObjectName"}],actionNameList:["drawSelectedObjectName"]},{conditionList:[{type:"isFlagOn",name:"drawObjectAtCursorName"}],actionNameList:["drawObjectAtCursorName"]},{conditionList:[{type:"isFlagOn",name:"drawCursorLocation"}],actionNameList:["drawCursorLocation"]},{conditionList:[{type:"isFlagOn",name:"drawCameraLocation"}],actionNameList:["drawCameraLocation"]},{conditionList:[{type:"isFlagOn",name:"enablePositionMode"}],actionNameList:[{type:"drawGuiArchetype",
params:{guiArchetypeName:"editorPositionModeIcon"}}]},{conditionList:[{type:"isFlagOn",name:"enableRotationMode"}],actionNameList:[{type:"drawGuiArchetype",params:{guiArchetypeName:"editorRotationModeIcon"}}]},{conditionList:[{type:"isFlagOn",name:"enableScaleMode"}],actionNameList:[{type:"drawGuiArchetype",params:{guiArchetypeName:"editorScaleModeIcon"}}]}]});t.Settings.drawControlLists.push({conditionList:[{type:"isFlagOff",name:"enableScreenshotMode"},{type:"isFlagOn",name:"enablePositionMode"},
{type:"hasSelectedObjects"}],controlList:[{conditionList:[],actionNameList:[{type:"drawWidgetX",params:{spritePath:"textures/move_widget.dds"}}]},{conditionList:[],actionNameList:[{type:"drawWidgetZ",params:{spritePath:"textures/move_widget.dds"}}]},{conditionList:[],actionNameList:[{type:"drawWidgetY",params:{spritePath:"textures/move_widget.dds"}}]}]});t.Settings.drawControlLists.push({conditionList:[{type:"isFlagOff",name:"enableScreenshotMode"},{type:"isFlagOn",name:"enableRotationMode"},{type:"hasSelectedObjects"}],
controlList:[{conditionList:[],actionNameList:[{type:"drawWidgetY",params:{spritePath:"textures/move_widget.dds"}}]}]});t.Settings.drawControlLists.push({conditionList:[{type:"isFlagOff",name:"enableScreenshotMode"},{type:"isFlagOn",name:"enableScaleMode"},{type:"hasSelectedObjects"}],controlList:[{conditionList:[],actionNameList:[{type:"drawWidgetX",params:{spritePath:"textures/scale_widget.dds"}}]},{conditionList:[],actionNameList:[{type:"drawWidgetZ",params:{spritePath:"textures/scale_widget.dds"}}]},
{conditionList:[],actionNameList:[{type:"drawWidgetY",params:{spritePath:"textures/scale_widget.dds"}}]}]});t.Settings.draw2dControlLists.push({conditionList:[],controlList:[{conditionList:[{type:"isFlagOn",name:"doInGameButtons"}],actionNameList:["drawInGameGui"]},{conditionList:[{type:"isFlagOn",name:"drawCursor2d"}],actionNameList:["draw2dCursor"]}]});t.UI={uiElementStateMap:{},getUIState:function(){return t.UI.uiElementStateMap},clearState:function(){var a=t.UI.uiElementStateMap,b;for(b in a)a.hasOwnProperty(b)&&
delete a[b]},addEditorUI:function(a,b,c){var d=b.addGroup(c,null);a.map(function(a){return t.UI.addUIElement(a,b,d)})},addUIElement:function(a,b,c){t.UI.uiElementFactory[a.type](a,t.UI.uiElementStateMap,t.getValueMap,b,c)},uiElementFactory:{text:function(a,b,c,d,f){var g=a.text;d.watchVariable(a.title,b,a.id,"watch",f,{value:g,getValue:function(){return g}})},textFromValue:function(a,b,c,d,f){var c=a.id,g=a.title,e=a.textName,a={value:t.getEditorStateFromName(e),getValue:function(){return t.getEditorStateFromName(e)}};
d.watchVariable(g,b,c,"watch",f,a)},button:function(a,b,c,d,f){var g=a.id;d.watchVariable(a.title||"",b,g,"button",f,{value:a.buttonText,setValue:function(){b[g]=!0}})},checkbox:function(a,b,c,d,f){var g=a.id,e=a.flagName;d.addCheckbox(a.title||"",function(){return t.getEditorFlagStateFromName(e)},function(){b[g]=!0},f,null)},textBox:function(a,b,c,d,f){var g=a.id;d.watchVariable(a.title||"",b,g,"text",f,{getValue:c[a.getValue],setValue:function(a){b[g]={text:a}}})},numberBox:function(a,b,c,d,f){var g=
a.id;d.watchVariable(a.title||"",b,g,"text",f,{getValue:c[a.getValue],setValue:function(a){a=Number(a);isNaN(a)||(b[g]={value:a})},setOnEnter:!0})},textBoxWithSubmitButton:function(a,b,c,d,f){var g=a.id;d.watchVariable(a.title||"",b,g,"text",f,{value:a.buttonText,setValue:function(a){b[g]={text:a}}})},selectBoxWithSubmitButton:function(a,b,c,d,f){var g=a.id,c=a.title||"",e=a.buttonText,n=a.valueListName,j=a.optionalFilterString,a=t.getEditorStateFromName(n),i;j&&(i=a.filter(function(a){return-1!==
a.indexOf(j)}));d.watchVariable(c,b,g,"select",f,{value:e,values:a,getValue:function(){return i||t.getEditorStateFromName(n)},setValue:function(a){b[g]={text:a}}})}}};var L={archetypes:{},badgeArchetypes:{},conditions:{},locationFinders:{},helpers:{validateTaskArchetypeMap:function(a,b,c,d){var f,g;for(g in a)a.hasOwnProperty(g)&&(f=a[g],L.helpers.validateTaskArchetype(g,f,b,c,d))},validateTaskArchetype:function(a,b,c,d){L.helpers.validateConditionList(a,b.conditionList,c);b.locationFinder&&L.helpers.validateLocationFinder(a,
b.locationFinder,d)},validateConditionList:function(a,b,c){b.forEach(function(b){L.helpers.validateArchetypeCondition(a,b,c)})},validateArchetypeCondition:function(a,b,c){c=c[b.name].requiredParams;b=b.params;c.length&&L.helpers.validateTaskParams(a,b,c)},validateLocationFinder:function(a,b,c){c=c[b.name].requiredParams;b=b.params;c.length&&L.helpers.validateTaskParams(a,b,c)},validateTaskParams:function(a,b,c){a=c.length;for(b=0;b<a;b+=1);}}};of.prototype={handleEvents:function(a){for(var b=this.eventList,
c=b.length,d=[],f,g=0;g<c;g+=1)f=b[g],(f=this.handleEvent(f,a))&&d.push(f);this.eventList=[];return d},handleEvent:function(a,b){var c=a.total,d=a.awarded||!1,f=a.previousScore/c,c=a.currentScore/c,g=b.length,e=L.badgeArchetypes[a.badgeKey],n=!1,j=null,i;if(d)n=!0;else for(var l=0;l<g;l+=1)if(i=b[l],f<=i&&c>i){n=!0;break}n&&e&&(j={taskArchetype:e,taskProgress:c,isAwarded:d,taskId:"badgeId_uniqueGroupString_"+this.uniqueBadgeIndex},this.uniqueBadgeIndex+=1);return j},onBadgeEvent:function(a){this.eventList.push(a)},
validateBadgeTasks:function(a){var b=L.badgeArchetypes,c,d;for(d in a)a.hasOwnProperty(d)&&(c=b[d],this.validateBadgeTaskArchetype(c,d))},validateBadgeTaskArchetype:function(){},destroy:function(){var a=this.gameManager.getEventManager();a.unsubscribe("badgeAwarded",this.onBadgeEventBound);a.unsubscribe("badgeProgressUpdated",this.onBadgeEventBound)}};of.create=function(a,b,c){var d=new of;d.globals=a;d.gameManager=b;d.uniqueGroupString=c;d.renderInfoList=[];d.uniqueBadgeIndex=0;d.eventList=[];d.onBadgeEventBound=
d.onBadgeEvent.bind(d);a=b.getEventManager();a.subscribe("badgeAwarded",d.onBadgeEventBound);a.subscribe("badgeProgressUpdated",d.onBadgeEventBound);return d};Td.prototype={getRenderInfoForTaskList:function(a){for(var b=a.length,c=[],d=0;d<b;d+=1){var f=this.getRenderInfoForTask(a[d]);c.push(f)}return c},getRenderInfoForTask:function(a){var b=this.taskList[a],c=L.archetypes[b],d=this.getTaskProgress(a);return{taskArchetype:c,taskArchetypeName:b,taskProgress:d,taskId:"taskId"+this.uniqueGroupString+
"_"+a,displayDuration:0}},getTaskProgress:function(a){for(var b=L.archetypes[this.taskList[a]].conditionList,c=b.length,a=this.getTaskConditionState(a).conditionCountList,d,f=0,g=0,e=0;e<c;e+=1)d=b[e],f+=d.count?d.count:0,g+=a[e];return 0<f?g/f:0},getTaskConditionState:function(a){return this.taskConditionStateMap[a]},getFirstNIncompleteList:function(a){for(var b=this.taskCompleteStatusList,c=b.length,d=[],f=0;f<c&&(b[f]||!(d.push(f),d.length===a));f+=1);return d},isTaskActive:function(a){return this.taskConditionStateMap[a]?
!0:!1},setTasksVisible:function(a){for(var b=a.length,c=this.taskList,d=L.archetypes,f,g,e,n=0;n<b;n+=1)f=a[n],g=c[f],e=d[g],this.isTaskActive(f)||this.activateTask(e,f),this.isTaskVisible(g)||this.setTaskVisible(e,g)},isTaskVisible:function(a){return this.taskVisibilityMap[a]},setTaskVisible:function(a,b){this.taskVisibilityMap[b]=!0;a.visibleScript&&this.runScript(a.visibleScript)},activateTask:function(a,b){this.addTaskConditionState(a,b);this.addTaskEventHandlers(a,b)},deactivateTasks:function(a){for(var b=
a.length,c=0;c<b;c+=1)this.deactivateTask(a[c])},deactivateTask:function(a){var b=this.eventInterestMap,c=this.taskList[a],d=L.archetypes[c];this.removeTaskConditionState(a,this.taskConditionStateMap);this.removeTaskEventHandlers(d,a,b);this.taskCompleteStatusList[a]=!0;d.completionScript&&this.runScript(d.completionScript);this.globals.metricsManager.sendMetric("taskComplete_"+c,1,!1)},runScript:function(a){this.gameManager.gameScriptManager.runScript(a,ja.scriptMap[a],!1)},addTaskConditionState:function(a,
b){this.taskConditionStateMap[b]=this.createTaskConditionState(a)},removeTaskConditionState:function(a){delete this.taskConditionStateMap[a]},createTaskConditionState:function(a){for(var a=a.conditionList.length,b=[],c=0;c<a;c+=1)b[c]=0;return{conditionCountList:b}},addTaskEventHandlers:function(a,b){for(var c=this.eventInterestMap,d=this.gameManager.getEventManager(),f=this.eventHandlerMap,g=L.conditions,e=a.conditionList,n=e.length,j,i,l=0;l<n;l+=1)j=e[l],i=j.name,j=j.params,i=g[i],i=i.eventName||
j.eventName,f[i]||(j=this.createEventHandler(i),d.subscribe(i,j),f[i]=j),c[i]||(c[i]=[]),-1===c[i].indexOf(b)&&c[i].push(b)},removeTaskEventHandlers:function(a,b){for(var c=this.eventInterestMap,d=this.gameManager.getEventManager(),f=this.eventHandlerMap,g=L.conditions,e=a.conditionList,n=e.length,j,i,l=0;l<n;l+=1)if(j=e[l],i=j.name,j=j.params,i=g[i],i=i.eventName||j.eventName,j=c[i]){var m=j.indexOf(b);-1!==m&&(j.splice(m,1),0===j.length&&(delete c[i],j=f[i],d.unsubscribe(i,j),delete f[i]))}},createEventHandler:function(a){return function(b){var c=
this.eventMap;c[a]||(c[a]=[]);c[a].push(b)}.bind(this)},handleEvents:function(){var a=this.updateTaskStates(this.eventMap),a=this.getCompletedTasks(a),b=this.getRenderInfoForTaskList(a);this.deactivateTasks(a);this.eventMap={};return b},updateTaskStates:function(a){var b=[],c,d,f,g;for(g in a)if(a.hasOwnProperty(g)){d=a[g];f=d.length;for(var e=0;e<f;e+=1)c=d[e],c=this.handleEvent(g,c),b.push.apply(b,c)}return b.filter(function(a,b,c){return c.indexOf(a)===b})},handleEvent:function(a,b){for(var c=
this.taskList,d=this.taskConditionStateMap,f=this.eventInterestMap[a],g=f.length,e=L.archetypes,n=[],j,i,l,m=0;m<g;m+=1)j=f[m],i=c[j],i=e[i],i=i.conditionList,l=d[j],d[j]=this.updateTaskState(l,i,a,b),n.push(j);return n},getCompletedTasks:function(a){for(var b=[],c=this.taskList,d=this.taskConditionStateMap,f=L.archetypes,g=a.length,e=0;e<g;e+=1){var n=a[e];this.isTaskComplete(d[n],f[c[n]].conditionList)&&b.push(n)}return b},updateTaskState:function(a,b,c,d){for(var f=b.length,g=L.conditions,e,n,
j,i,l=0;l<f;l+=1)if(e=b[l],n=e.count,j=e.name,e=e.params,i=g[j],j=i.eventName||e.eventName,(i=i.evaluator)&&j===c&&i(d,e))a.conditionCountList[l]+=1,a.conditionCountList[l]=Math.min(n,a.conditionCountList[l]);return a},isTaskComplete:function(a,b){for(var c=this.globals,d=this.gameManager,f=L.conditions,g=a.conditionCountList,e=b.length,n,j,i,l=0;l<e;l+=1)if(n=b[l],j=n.params,i=n.name,i=f[i],n=n.count,i=i.isComplete){if(!i(c,d,j))return!1}else if(!g||g[l]<n)return!1;return!0},validateTaskList:function(a){for(var a=
a.length,b=0;b<a;b+=1);},initTaskCompleteStatusList:function(a,b){for(var c=L.archetypes,d=this.gameManager.getPlayerData(),f=!1,g=[],e,n,j,i=a.length-1;0<=i;i-=1)for(var l=a[i],m=!1,k=l.length-1;0<=k;k-=1){e=l[k];n=c[e];n=n.conditionList;j=b[e]||!1;m=m||j;if(!j&&(m||this.isTaskComplete({},n)))m=!0,d.setTaskFlag(e,!0,!1),f=!0;e=m;g.push(e)}f&&d.saveTaskFlags();g.reverse();return g},activateTasks:function(a,b){for(var c=L.archetypes,d=a.length,f,g=0;g<d;g+=1)f=a[g],f=c[f],!b[g]&&f.alwaysActive&&this.activateTask(f,
g)},runStartUpScripts:function(a,b){for(var c=L.archetypes,d=a.length,f,g=0;g<d;g+=1)f=a[g],f=c[f],f=f.startupScript,!b[g]&&f&&this.runScript(f)},destroy:function(){for(var a=this.taskList.length,b=0;b<a;b+=1)this.isTaskActive(b)&&this.deactivateTask(b)}};Td.create=function(a,b,c,d,f){var g=new Td;g.globals=a;g.gameManager=b;g.eventMap={};g.eventHandlerMap={};g.taskConditionStateMap={};g.eventInterestMap={};g.taskVisibilityMap={};g.uniqueGroupString=f;a=Array.prototype.concat.apply([],c);g.taskList=
a;c=g.initTaskCompleteStatusList(c,d);g.taskCompleteStatusList=c;g.activateTasks(a,c);g.runStartUpScripts(a,c);return g};pf.prototype={MAX_VISIBLE_BADGE_TASKS:1,MAX_VISIBLE_CRITICAL_TASKS:1,MAX_VISIBLE_FILLER_TASKS:2,BADGE_TASK_DISPLAY_DURATION:5,FILLER_ACTIVATION_TASK:"buildStonelingHut",MAX_ARROW_DISPLAY_DURATION:30,badgeThresholdList:[0.25,0.5,0.75],update:function(){var a=this.updateTasks(),b=this.updateBadgeTasks(),b={descriptionTaskRenderInfo:this.descriptionTaskRenderInfo,completedTaskRenderInfo:this.completedTaskRenderInfo,
taskRenderInfoList:a,badgeTaskRenderInfoList:b},a=!1,c;this.gameManager.getPlayFlags().showTasks&&(c=this.taskRenderer.doTaskUI(b));c?(b=c.buttonName,"closeDescription"===b?(this.descriptionTaskRenderInfo=null,this.arrowCreationTime=this.globals.gameCurrentTime,this.playTaskCloseDescriptionScripts(c.taskRenderInfo)):"acceptReward"===b?(this.completedTaskRenderInfo=null,this.awardCompletedTaskList([c.taskRenderInfo])):"openTaskDescription"===b&&(a=!0,this.activeTaskRenderInfo=this.descriptionTaskRenderInfo=
c.taskRenderInfo,this.gameManager.eventManager.notify("taskDescriptionOpened",{}))):this.completedTaskRenderInfo&&this.descriptionTaskRenderInfo&&(this.playTaskCloseDescriptionScripts(this.descriptionTaskRenderInfo),this.descriptionTaskRenderInfo=null);this.updateArrowAndCameraLocation(a)},updateTasks:function(){this.updateCompletedTasks();return this.getTaskRenderInfoList()},updateBadgeTasks:function(){var a=this.badgeTaskGroup.handleEvents(this.badgeThresholdList),a=this.badgeRenderInfoList.concat(a);
!this.completedTaskRenderInfo&&!this.descriptionTaskRenderInfo&&(a=this.updateRenderInfoList(a,this.BADGE_TASK_DISPLAY_DURATION));this.badgeRenderInfoList=a;return a.slice(0,this.MAX_VISIBLE_BADGE_TASKS)},updateArrowAndCameraLocation:function(a){var b=this.activeTaskRenderInfo;if(b){var c=null!==this.descriptionTaskRenderInfo,d=b.taskArchetype,f=this.arrowTargetEntity,g=this.getArrowTargetEntity(d);((f=g!==f)&&c||a)&&this.playTaskOpenDescriptionScripts(b,g);f&&this.setArrowLocation(b,g,d);null!==
this.arrowCreationTime&&(a=this.globals.gameCurrentTime-this.arrowCreationTime>this.MAX_ARROW_DISPLAY_DURATION,!c&&a&&(this.destroyArrow(),this.activeTaskRenderInfo=null))}},getArrowTargetEntity:function(a){return(a=a.locationFinder)?L.locationFinders[a.name].findFunction(this.globals,this.gameManager,a.params):null},updateCompletedTasks:function(){var a=this.getNewCompletedRenderInfoList();0<a.length&&this.saveCompletedTasks(a);this.destroyArrowIfArrowTaskComplete(a);this.completedTaskRenderInfo&&
a.unshift(this.completedTaskRenderInfo);var b=a.length;if(b){var c=a.slice(0,-1);this.awardCompletedTaskList(c);this.completedTaskRenderInfo=a[b-1]}else this.completedTaskRenderInfo=null},saveCompletedTasks:function(a){for(var b=this.gameManager.getPlayerData(),c=a.length,d=0;d<c;d+=1)b.setTaskFlag(a[d].taskArchetypeName,!0,!0)},getNewCompletedRenderInfoList:function(){var a=this.fillerTaskGroup,b=this.criticalTaskGroup.handleEvents(),a=a.handleEvents();return b.concat(a)},awardCompletedTaskList:function(a){for(var b=
a.length,c,d=0;d<b;d+=1)c=a[d],c=c.taskArchetype,this.giveTaskReward(c)},destroyArrowIfArrowTaskComplete:function(a){var b=a.length,c=this.activeTaskRenderInfo;if(c)for(var c=c.taskId,d,f=0;f<b;f+=1)if(d=a[f],d=d.taskId,d===c){this.destroyArrow();this.activeTaskRenderInfo=null;break}},getTaskRenderInfoList:function(){var a=this.criticalTaskGroup,b=this.fillerTaskGroup,c=this.FILLER_ACTIVATION_TASK,d=this.gameManager.getPlayerData().getTaskFlags(),f=a.getFirstNIncompleteList(this.MAX_VISIBLE_CRITICAL_TASKS);
a.setTasksVisible(f);a=a.getRenderInfoForTaskList(f);f=[];d[c]&&(c=b.getFirstNIncompleteList(this.MAX_VISIBLE_FILLER_TASKS),b.setTasksVisible(c),f=b.getRenderInfoForTaskList(c));b=this.fillerRenderInfoList;c=this.mergeRenderInfoLists(this.criticalRenderInfoList,a);b=this.mergeRenderInfoLists(b,f);this.criticalRenderInfoList=c;this.fillerRenderInfoList=b;return c.concat(b)},mergeRenderInfoLists:function(a,b){for(var c=b.length,d=[],f=[],g,e,n=0;n<c;n+=1)g=b[n],e=g.taskId,e=this.indexOfRenderInfoId(a,
e),-1!==e?(d[e]=a[e],d[e].taskProgress=b[n].taskProgress):f.push(g);for(n=0;n<c;n+=1)(g=d[n])||(d[n]=f.shift());return d},indexOfRenderInfoId:function(a,b){for(var c=a.length,d=0;d<c;d+=1)if(a[d].taskId===b)return d;return-1},playTaskOpenDescriptionScripts:function(a,b){b&&this.runScript("TaskOpenDescriptionScript",{targetEntity:b});this.activeTaskRenderInfo=a},playTaskCloseDescriptionScripts:function(a){a.taskArchetype.noTaskDescriptionCloseScript||this.runScript("TaskCloseDescriptionScript")},setArrowLocation:function(a,
b,c){this.runScript("TaskDestroyArrowScript");b&&(a={targetEntity:b},c.isCritical?this.runScript("TaskCreateCriticalArrowScript",a):this.runScript("TaskCreateArrowScript",a));this.arrowTargetEntity=b},destroyArrow:function(){this.runScript("TaskDestroyArrowScript");this.arrowCreationTime=this.arrowTargetEntity=null},runScript:function(a,b){this.gameManager.gameScriptManager.runScript(a,ja.scriptMap[a],!1,b)},giveTaskReward:function(a){var b=this.gameManager,c=b.getHero().getv3Location(),d=a.xpReward;
b.giveAmberReward(a.amberReward,c);b.giveXpReward(d,c)},updateRenderInfoList:function(a,b){var c=this.globals.gameTimeStep;if(a.length){var d=a[0];void 0===d.displayDuration&&(d.displayDuration=0,d.isAwarded&&this.giveTaskReward(d.taskArchetype));d.displayDuration+=c;d.displayDuration>b&&a.splice(0,1)}return a},completeDummyBadgeTask:function(){this.gameManager.getEventManager().notify("badgeAwarded",{badgeKey:"dummy-badge-key",awarded:!0})},updateDummyBadgeProgress:function(){this.gameManager.getEventManager().notify("badgeProgressUpdated",
{badgeKey:"dummy-badge-key",currentScore:3,previousScore:1,total:10})},completeTopCriticalTask:function(){this.completeFirstIncompleteTask(this.criticalTaskGroup)},completeTopFillerTask:function(){this.completeFirstIncompleteTask(this.fillerTaskGroup)},completeFirstIncompleteTask:function(a){var b=a.getFirstNIncompleteList(1);if(b.length){var c=a.getRenderInfoForTaskList(b);a.deactivateTasks(b);this.completedTaskRenderInfo=c[0]}},destroy:function(){this.criticalTaskGroup.destroy();this.fillerTaskGroup.destroy();
this.badgeTaskGroup.destroy()}};pf.create=function(a,b,c){var d=new pf;d.globals=a;d.gameManager=b;d.shouldArrowsPersistAfterDesc=!0;d.taskRenderer=qf.create(a,b);d.descriptionTaskRenderInfo=null;d.completedTaskRenderInfo=null;d.badgeRenderInfoList=[];d.criticalRenderInfoList=[];d.fillerRenderInfoList=[];if(!c||c instanceof Array)c={};d.activeTaskRenderInfo=null;d.arrowTargetEntity=null;d.arrowCreationTime=null;var f=L.fillerTaskList;d.criticalTaskGroup=Td.create(a,b,L.criticalTaskList,c,"crit");
d.fillerTaskGroup=Td.create(a,b,f,c,"fill");d.badgeTaskGroup=of.create(a,b,"badge");return d};qf.prototype={VERTICAL_TASK_SEPARATION:75,HORIZONTAL_TASK_OFFSET:173,VERTICAL_TASK_OFFSET:-51,HORIZONTAL_TASK_BOX_OFFSET:185,VERTICAL_TASK_BOX_OFFSET:-255,HORIZONTAL_DESCRIPTION_CLOSE_BUTTON_OFFSET:0,VERTICAL_DESCRIPTION_CLOSE_BUTTON_OFFSET:188,NEW_TASK_HIDE_DURATION:0.5,NEW_TASK_PULSE_DURATION:10,TASK_PULSE_SEPARATION_DURATION:180,NEW_TASK_PULSE_AMPLITUDE_DIFF:0.04,NEW_TASK_PULSE_FREQUENCY:2,TASK_NEWSFLASH_DURATION:4,
taskGuiArchetype:"taskInactive",taskGuiArchetypeCritical:"taskInactiveCritical",taskGuiArchetypePulsing:"taskPulsing",taskGuiArchetypeCriticalPulsing:"taskPulsingCritical",taskCompleteGuiArchetype:"taskComplete",taskDescriptionGuiArchetype:"taskDescription",acceptRewardButtonGuiArchetype:"taskAcceptRewardButton",taskDescriptionCloseButtonGuiArchetype:"taskDescriptionCloseButton",taskBadgeCompleteGuiArchetype:"badgeTaskComplete",taskBadgeIncompleteGuiArchetype:"badgeTaskIncomplete",taskNewsflashGuiArchetype:"taskNewsflash",
doTaskUI:function(a){var b=a.descriptionTaskRenderInfo,c=a.completedTaskRenderInfo,d=a.badgeTaskRenderInfoList,a=a.taskRenderInfoList;return b?this.doTaskDescription(b):c?this.doCompletedTask(c):this.doTasks(d,a)},doCompletedTask:function(a){this.doCompletedTaskBackground(a);return this.doCompletedTaskAcceptRewardButton(a)?{buttonName:"acceptReward",taskRenderInfo:a}:null},doCompletedTaskBackground:function(a){var b=this.gameManager.getGuiManager(),c=this.globals,d=c.guiRenderer,f=c.currentLanguage,
c=a.taskArchetype,g=f.TASK_COMPLETE,f=f[c.completeTextId],e=Math.round(c.amberReward),n=Math.round(c.xpReward),e="+"+e.toString(),n="+"+n.toString(),j=this.taskCompleteGuiArchetype,a="idCompletedTask"+a.taskId,d=d.getv2RenderLocation(this.HORIZONTAL_TASK_BOX_OFFSET,this.VERTICAL_TASK_BOX_OFFSET,"bottomLeft");b.addDrawGui(j,{v2ScreenLocation:d,svg1:c.iconPath,text1:g,text2:f,text3:e,text4:n},a)},doCompletedTaskAcceptRewardButton:function(a){var b=this.gameManager.getIMGui(),c=this.globals,d=c.guiRenderer.getv2RenderLocation(this.HORIZONTAL_TASK_BOX_OFFSET+
this.HORIZONTAL_DESCRIPTION_CLOSE_BUTTON_OFFSET,this.VERTICAL_TASK_BOX_OFFSET+this.VERTICAL_DESCRIPTION_CLOSE_BUTTON_OFFSET,"bottomLeft");return b.doButtonFromGuiArchetype(this.acceptRewardButtonGuiArchetype,{v2ScreenLocation:d,text1:c.currentLanguage.TASK_ACCEPT_REWARD_BUTTON},"idAcceptTaskRewardButton"+a.taskId)},doTaskDescription:function(a){this.doTaskDescriptionBackground(a);return this.doTaskDescriptionCloseButton(a)?{buttonName:"closeDescription",taskRenderInfo:a}:null},doTaskDescriptionBackground:function(a){var b=
this.gameManager.getGuiManager(),c=this.globals,d=c.guiRenderer,f=c.currentLanguage,c=a.taskArchetype,g=f[c.titleTextId],e=f[c.descriptionTextId],n=Math.round(c.amberReward),j=Math.round(c.xpReward),n="+"+n.toString()+" "+f.TASK_AMBER,f="+"+j.toString()+" "+f.TASK_XP,j=this.taskDescriptionGuiArchetype,a="idTaskDescriptionBackground"+a.taskId,d=d.getv2RenderLocation(this.HORIZONTAL_TASK_BOX_OFFSET,this.VERTICAL_TASK_BOX_OFFSET,"bottomLeft");b.addDrawGui(j,{v2ScreenLocation:d,svg1:c.iconPath,text1:g,
text2:e,text3:n,text4:f},a)},doTaskDescriptionCloseButton:function(a){var b=this.gameManager.getIMGui(),c=this.globals,d=c.guiRenderer.getv2RenderLocation(this.HORIZONTAL_TASK_BOX_OFFSET+this.HORIZONTAL_DESCRIPTION_CLOSE_BUTTON_OFFSET,this.VERTICAL_TASK_BOX_OFFSET+this.VERTICAL_DESCRIPTION_CLOSE_BUTTON_OFFSET,"bottomLeft");return b.doButtonFromGuiArchetype(this.taskDescriptionCloseButtonGuiArchetype,{v2ScreenLocation:d,text1:c.currentLanguage.TASK_DESCRIPTION_CLOSE_BUTTON},"idDescriptionCloseTaskButton"+
a.taskId)},doTasks:function(a,b){var c=this.globals.mathDevice,d=this.gameManager.getPlayFlags(),f=c.v2BuildZero();d.offsetTasks&&(f[1]=-115);var g=this.VERTICAL_TASK_SEPARATION,d=c.v2Build(this.HORIZONTAL_TASK_OFFSET,this.VERTICAL_TASK_OFFSET);c.v2Add(f,d,d);var f=c.v2Build(0,g),e=a.length,n=b.length,g=Math.max(0,n-1),e=Math.max(0,n+e-1),e=c.v2AddScalarMul(d,f,-e),c=c.v2AddScalarMul(d,f,-g);this.doBadgeTaskList(a,e,f);return this.doTaskList(b,c,f)},doBadgeTaskList:function(a,b,c){for(var d=this.globals,
f=d.mathDevice,d=d.guiRenderer,g=a.length,b=f.v2Copy(b),e,n,j=0;j<g;j+=1)e=d.getv2RenderLocation(b[0],b[1],"bottomLeft"),n=a[j],this.doBadgeTask(n,e),f.v2Add(c,b,b)},doTaskList:function(a,b,c){for(var d=this.globals,f=d.mathDevice,d=d.guiRenderer,g=a.length,b=f.v2Copy(b),e=null,n,j,i=0;i<g;i+=1)n=d.getv2RenderLocation(b[0],b[1],"bottomLeft"),j=a[i],e=(n=this.doTask(j,n))||e,f.v2Add(c,b,b);return e},doBadgeTask:function(a,b){var c=this.globals,d=this.gameManager.getGuiManager(),f=a.taskArchetype,g=
a.taskProgress||1,e=a.taskId,n=1===g?this.taskBadgeCompleteGuiArchetype:this.taskBadgeIncompleteGuiArchetype,j="+"+f.amberReward.toString(),c=c.currentLanguage[f.titleTextId];g&&(f="("+Math.round(100*g).toString()+"%)",c=c+" "+f);d.addDrawGui(n,{x:b[0],y:b[1],text1:c,text2:j,scale1:g},e)},doTask:function(a,b){var c=this.globals,d=this.gameManager,f=d.getIMGui(),g=c.currentLanguage,e=a.taskArchetype,n=a.taskProgress,j=a.taskId,i=(a.displayDuration-this.NEW_TASK_HIDE_DURATION)%this.TASK_PULSE_SEPARATION_DURATION<
this.NEW_TASK_PULSE_DURATION;a.displayDuration+=c.gameTimeStep;var l=a.displayDuration<this.NEW_TASK_HIDE_DURATION,i=e.taskGuiArchetype?i?e.taskGuiArchetypePulsing:e.taskGuiArchetype:e.isCritical?i?this.taskGuiArchetypeCriticalPulsing:this.taskGuiArchetypeCritical:i?this.taskGuiArchetypePulsing:this.taskGuiArchetype,m="+"+e.amberReward.toString(),c=g[e.summaryTextId||e.titleTextId];if(n)var k="("+Math.round(100*n).toString()+"%)",c=c+" "+k;n={x:b[0],y:b[1],text1:c,text2:m,scale1:n,svg1:e.iconPath};
return!l&&(!a.newsFlashShown&&e.isCritical&&(a.newsFlashShown=!0,l=this.TASK_NEWSFLASH_DURATION,g=g.TASK_NEWSFLASH_TITLE,m=this.taskNewsflashGuiArchetype,d.getGuiManager().addGameMessage("idTaskNewsFlash"+j,g,c,l,m)),!a.opened&&e.taskUnopenedArchetype&&d.getGuiManager().addDrawGui(e.taskUnopenedArchetype,n,"idTaskHelpUnopened"+j),f.doButtonFromGuiArchetype(i,n,"idTaskHelpButton"+j))?(a.opened=!0,{buttonName:"openTaskDescription",taskRenderInfo:a}):null}};qf.create=function(a,b){var c=new qf;c.globals=
a;c.gameManager=b;return c};L.conditions.onEvent={requiredParams:["eventName"],evaluator:function(){return!0}};L.conditions.buildingPlaced={eventName:"BuildingAdded",requiredParams:["buildingType"],evaluator:function(a,b){return a.building.buildingType===b.buildingType}};L.conditions.buildingBuilt={eventName:"BuildingEvent",requiredParams:["buildingType","count"],isComplete:function(a,b,c){a=b.getBuildingManager();b=c.count;return a.getBuildingsAtMinLevel(c.buildingType,c.level||1,!c.noScaffolds).length>=
b}};L.conditions.buildingMoved={eventName:"BuildingEvent",requiredParams:[],evaluator:function(a,b){var c="placed"===a.reason&&a.fromMove,d=b.familyName;return d?(d=d===a.building.familyName,c&&d):c}};L.conditions.chopTree={eventName:"ResourceDispsenserDepletedByHero",requiredParams:[],evaluator:function(a){return a.resourceType===E.LUMBER}};L.conditions.mineStone={eventName:"ResourceDispsenserDepletedByHero",requiredParams:[],evaluator:function(a){return a.resourceType===E.STONE}};L.conditions.harvestMushroom=
{eventName:"ResourceDispsenserDepletedByHero",requiredParams:[],evaluator:function(a){return a.resourceType===E.STONE}};L.conditions.enemyKilled={eventName:"EnemyKilled",requiredParams:["familyName"],evaluator:function(a,b){return a.victim.familyName===b.familyName}};L.conditions.enemyKilledByHero={eventName:"EnemyKilled",requiredParams:["familyName"],evaluator:function(a,b){var c=a.victim.familyName,d=b.familyName,f=a.aggressor;return!f.toBeDestroyed&&f.getEC("ECHero")&&c===d}};L.conditions.entitiesDispensed=
{eventName:"EntitiesDispensed",requiredParams:["dispenserfamilyName"],evaluator:function(a,b){return a.dispenser.familyName===b.dispenserfamilyName}};L.locationFinders.nearestResourceDispenser={requiredParams:["familyName"],findFunction:function(a,b,c){for(var c=b.getGameEntitiesByFamilyName(c.familyName),d=c.length,a=[],f=0;f<d;f+=1){var g=c[f],e=g.getEC("ECSelectable");e&&e.getValid()&&a.push(g)}c=b.getHero().getv3Location();return b.getNearestEntityFromList(c,a)}};L.locationFinders.nearestEntityOfFamilyName=
{requiredParams:["familyName"],findFunction:function(a,b,c){var a=c.familyName,c=b.getHero().getv3Location(),d=b.getNearestGameEntityByFamilyName(a,c);d||(d=b.getNearestScaffoldWithFamilyName(a,c));return d}};L.locationFinders.nearestSleepingWildling={requiredParams:[],findFunction:function(a,b){var c=b.getHero().getv3Location(),d=b.getGameEntitiesByFamilyName("friendlyLumberling",c),f=b.getGameEntitiesByFamilyName("friendlyStoneling",c),g=b.getGameEntitiesByFamilyName("friendlyBuildling",c),e=b.getGameEntitiesByFamilyName("friendlyWarling",
c),i=b.getGameEntitiesByFamilyName("friendlyWildling",c),d=d.concat(f,g,e,i).filter(function(a){return a.getEC("ECWildlingAgent").isSleeping()});return b.getNearestEntityFromList(c,d)}};L.locationFinders.buildLocation={requiredParams:["preCarryFamilyName"],findFunction:function(a,b,c){var d=c.preCarryFamilyName,c=c.carryFamilyName,f;f=b.getEntityFactory();var g=b.getHero().getv3Location();(g=b.getNearestGameEntityByFamilyName(d,g))?(g=g.getEC("ECDispenser").getDispenseArchetypeName(0),f=f.getEntityArchetype(g).familyName):
f=null;var g=b.getEntityFactory(),e=b.getHero().getEC("ECPlayerBuilder"),i=e.getHeldObjectName(),e=e.isThrowing(),j;i&&(j=g.getEntityArchetype(i).familyName);d=j&&j===f||e?c:d;j={familyName:d};return d?L.locationFinders.nearestEntityOfFamilyName.findFunction(a,b,j):null}};var E={LUMBER:0,STONE:1,NUM_RESOURCES:2},Za=[{pickupMesh:"environment/models/lumber_01.dae",pickupSound:"pickupWood",entityArchetype:"a_r_lumber",interactSound:"chop",depositStartSound:"depositWoodStart",depositEndSound:"depositWoodEnd",
barGUI:"lumberBar",convertGUI:"addLumber",convertInvalidGUUI:"addLumberInvalid",convertMetricName:"amberConvertedToLumber",wildlingOrder:"Gather Lumber",string:"Lumber",offlineResourceGenerationScale:1,bubbleArchetype:"resourceLumber",fullArchetype:"newsflashLumberFull"},{pickupMesh:"environment/models/stone_01.dae",pickupSound:"pickupStone",entityArchetype:"a_r_stone",interactSound:"mine",depositStartSound:"depositStoneStart",depositEndSound:"depositStoneEnd",barGUI:"stoneBar",convertGUI:"addStone",
convertInvalidGUUI:"addStoneInvalid",convertMetricName:"amberConvertedToStone",wildlingOrder:"Gather Stone",string:"Stone",offlineResourceGenerationScale:1,bubbleArchetype:"resourceStone",fullArchetype:"newsflashStoneFull"}];rf.prototype={isBlock:!0,getV3Scale:function(){return this.v3Scale},getv3Location:function(){return this.v3Location},getExtents:function(){return this.extents},getRotationY:function(){return this.rotationY},getWorldCube:function(){return this.worldCube},getArchetypeName:function(){return this.archetypeName},
isBuildZone:function(){return this.worldCube&&this.worldCube.buildZone},addToGameSpace:function(a){a.addBlock(this);this.worldCube&&a.addCube(this.worldCube)},removeFromGameSpace:function(a){a.removeBlock(this);this.worldCube&&a.removeCube(this.worldCube)},disableMeshNode:function(){this.meshNode&&this.globals.scene.removeRootNode(this.meshNode)},enableMeshNode:function(){if(this.meshNode){var a=this.globals.scene,b=this.meshNode;this.meshNode=b.clone();this.meshNode.setStatic();b.destroy();a.addRootNode(this.meshNode)}},
destroyMeshNode:function(){if(this.meshNode){var a=this.globals.scene;this.meshNode.isInScene()&&a.removeRootNode(this.meshNode);this.meshNode.destroy();this.meshNode=null}},drawDebug:function(){this.worldCube&&this.worldCube.drawDebug()},destroy:function(){this.worldCube&&(this.worldCube.destroy(),this.worldCube=null);this.destroyMeshNode()}};rf.create=function(a,b,c,d,f,g){var e=new rf,i=g.mathDevice,j;f&&(j=i.m43BuildRotationY(f));var k,l,m;b.path&&(l=i.m43BuildScale(d),f&&i.m43Mul(l,j,l),i.m43Translate(l,
c),l=g.simpleSceneLoader.load(b.path,l,!0,void 0),l.update());if(b.hasPhysics){var q=i.v3Copy(c);b.v3PhysicsScale||!l?(k=b.v3PhysicsScale||i.v3BuildOne(),k=i.v3Mul(d,k),f&&i.m43TransformVector(j,k,k)):(m=l.calculateHierarchyWorldExtents(),j=i.v3BuildZero(),k=i.v3BuildZero(),i.aabbGetCenterAndHalf(m,j,k),i.v3ScalarMul(k,2,k),k[0]=0.5*Math.round(2*k[0]),k[1]=0.5*Math.round(2*k[1]),k[2]=0.5*Math.round(2*k[2]),q=i.v3Copy(c),q[1]+=0.5*k[1]);b.v3PhysicsOffset&&i.v3Add(q,i.v3Mul(b.v3PhysicsOffset,d),q);
k=ic.create(q,g,g.gameManager,{isBuildZone:b.isBuildZone?!0:!1,terrainType:b.terrainType,stationary:!0,v3Scale:k});k.block=e}e.archetypeName=a;e.v3Location=i.v3Copy(c);e.v3Scale=i.v3Copy(d);e.rotationY=f;e.worldCube=k||null;e.meshNode=l||null;e.globals=g;m?e.extents=m:k?e.extents=k.getExtents():(l.update(),e.extents=l.calculateHierarchyWorldExtents());l&&l.setStatic();return e};Ud.prototype={HELD_THRESHOLD:0.5,CURSOR_YOFFSET:0.1,ATTACK_ON_DOWN:!0,END_TARGETED_IF_HELD:!0,update:function(a,b,c){this.determineDownOrUp(a,
b,c);this.collisionInfo=this.crashMobController.collisionInfo;this.validateEntities();if(!this.crashMobController.capturedMouse)return null;this.updateFunction&&this.updateFunction();this.worldDown?(this.prevDown||(this.storeDownInfo(),this.pressFunction&&this.pressFunction()),this.downFunction&&this.downFunction()):this.prevDown&&this.liftFunction&&this.liftFunction();this.prevDown=this.worldDown;return this.guiDown},validateEntities:function(){this.activatedEntity&&this.activatedEntity.toBeDestroyed&&
(this.activatedEntity=void 0);this.targetEntity&&this.targetEntity.toBeDestroyed&&(this.targetEntity=void 0)},getActivatedEntity:function(){return this.activatedEntity},activateTargetEntity:function(){var a,b=this.targetEntity;if(b&&(this.activatedEntity&&(a=this.activatedEntity.getEC("ECSelectable"))&&a.setActivated(!1),this.activatedEntity=b))(a=this.activatedEntity.getEC("ECSelectable"))&&a.setActivated(!0)},clearActivatedEntity:function(){var a;this.activatedEntity&&(a=this.activatedEntity.getEC("ECSelectable"))&&
a.setActivated(!1);this.activatedEntity=void 0},storeDownInfo:function(){this.downv2ScreenCoord=this.globals.mathDevice.v2Copy(this.crashMobController.getv2ScreenCoord());this.downTime=this.globals.appCurrentTime},determineDownOrUp:function(a,b,c){this.isIMGuiHot=this.gameManager.getIMGui().hasCapturedInput()&&c;a?(this.worldDown=!this.isIMGuiHot,this.guiDown=!0):b&&(this.guiDown=this.worldDown=!1)},draw:function(){this.drawFunction&&this.drawFunction()},draw2D:function(){this.draw2DFunction&&this.draw2DFunction()},
setModeSplashScreen:function(){this.updateFunction=null;this.pressFunction=this.skipCurrentSplashScreen;this.liftFunction=this.draw2DFunction=this.drawFunction=this.downFunction=null;this.resetModeFunction=this.setModeSplashScreen;this.useDirection=!1;this.typeValidFunction=this.allTypesValid},skipCurrentSplashScreen:function(){var a=this.gameManager;a&&a.skipCurrentSplashScreen()},setModeInactive:function(){this.resetModeFunction=this.liftFunction=this.draw2DFunction=this.drawFunction=this.downFunction=
this.pressFunction=this.updateFunction=null;this.useDirection=!1;this.typeValidFunction=this.allTypesValid},setModeMenuScreen:function(){this.resetModeFunction=this.liftFunction=this.draw2DFunction=this.drawFunction=this.downFunction=this.pressFunction=this.updateFunction=null;this.useDirection=!1;this.typeValidFunction=this.allTypesValid},setModeMove:function(){this.updateFunction=this.updateMove;this.drawFunction=null;this.drawFunction=this.drawMove;this.draw2DFunction=null;this.downFunction=this.downMove;
this.pressFunction=this.pressMove;this.liftFunction=this.liftMove;this.resetModeFunction=this.setModeMove;this.useDirection=!1;this.typeValidFunction=this.allTypesValid},updateMove:function(){},pressMove:function(){this.setControllableDestination(this.crashMobController.controlNavigate,!1,!0)},downMove:function(){this.hasHeldOrSwiped()&&this.setControllableDestination(!1,this.hasHeldOrSwiped(),!this.hasHeldOrSwiped())},liftMove:function(){this.hasHeldOrSwiped()&&this.setControllableDestination(this.crashMobController.controlNavigate,
this.hasHeldOrSwiped(),!0)},drawMove:function(){if(!this.isIMGuiHot){var a=this.globals,b=a.mathDevice,c=a.simpleSpriteRenderer,d=this.getv3WorldCursorLocation(),f=b.v3Copy(d),g=b.v3Copy(d),e=a.appCurrentTime-this.downTime,a=1-0.75*(3*(e-this.HELD_THRESHOLD)%1),e=e/this.HELD_THRESHOLD,i=this.getHeroEntity(),j=k.outline[0],r=k.outline[1],l=k.outline[2],m=0.5,m=1,q=b.v3BuildYAxis(),p=b.v3BuildYAxis(),s=0,t=this.CURSOR_YOFFSET;void 0!==this.collisionInfo&&(p=this.collisionInfo.v3Normal,b.v3Add(this.collisionInfo.v3Location,
b.v3ScalarMul(p,0.1),f));var u;i&&((u=i.getEC("ECNav"))&&u.isOnPath()?u=u.getv3Destination():(u=i.getEC("ECLocomotion"),u=u.getDestination()),g[1]=i.v3Location[1]-t);var f=!1,w;u&&(s=b.v3ToAngle(b.v3Sub(u,i.v3Location)),w=b.v3Copy(u),w[1]=i.v3Location[1]-t);void 0===w&&(s=b.v3ToAngle(b.v3Sub(d,i.v3Location)),w=d);this.prevDown&&(f=!0,this.hasHeldOrSwiped()?(c.addSprite({v3Location:g,size:0.75,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:this.crashMobController.bigArrowTexturePath,v4color:b.v4Build(j,
r,l,0.5),out:q,angle:s}),c.addSprite({v3Location:g,size:0.75*a,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:this.crashMobController.bigArrowTexturePath,v4color:b.v4Build(j,r,l,a),out:q,angle:s})):(c.addSprite({v3Location:w,size:0.5,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:this.crashMobController.bigArrowTexturePath,v4color:b.v4Build(j,r,l,1),out:q,angle:s}),c.addSprite({v3Location:g,size:0.75*e,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:this.crashMobController.bigArrowTexturePath,
v4color:b.v4Build(j,r,l,e),out:q,angle:s})));c.addSprite({v3Location:g,size:0.75,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:this.crashMobController.bigCircleTexturePath,v4color:k.outlineSoft,out:q});c.addSprite({v3Location:g,size:0.75,blendStyle:ua.prototype.blendStyle.NORMAL,texture:this.crashMobController.bigCircleTexturePath,v4color:b.v4Build(j,r,l,m),out:q});!f&&u&&c.addSprite({v3Location:w,size:0.5,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:this.crashMobController.bigArrowTexturePath,
v4color:b.v4Build(j,r,l,0.5),out:q,angle:s})}},setModeSwipeAttack:function(){this.updateFunction=null;this.drawFunction=this.drawSwipeAttack;this.draw2DFunction=null;this.downFunction=this.downSwipeAttack;this.pressFunction=this.pressSwipeAttack;this.liftFunction=this.liftSwipeAttack;this.resetModeFunction=this.setModeSwipeAttack;this.useDirection=!1;this.typeValidFunction=this.combatOnly},liftSwipeAttack:function(){var a=this.getHeroEntity().getEC("ECChargeableShot");a&&a.canCharge()&&a.stopCharging();
this.resetModeFunction&&this.resetModeFunction()},drawSwipeAttack:function(){this.drawChargeableShotUIOnHero()},getv3SwipeWorldDirection:function(){var a=this.globals,b=a.mathDevice,c=a.camera,a=this.getHeroEntity().getv3Location(),c=c.worldToScreen(a),d=this.crashMobController.getv2ScreenCoord(),c=b.v2Add(c,b.v2Sub(d,this.downv2ScreenCoord)),c=this.crashMobController.getv3WorldLocationFromCoord(c[0],c[1]),a=b.v3Sub(c,a);a[1]=0;b.v3Normalize(a,a);return a},downSwipeAttack:function(){if(this.hasSwiped()){this.downFunction=
null;var a=this.getv3SwipeWorldDirection(),b=this.getHeroEntity(),c=b.getv3Location(),d=this.getTargetFromWorldDirection(c,a,15),f=b.getEC("ECFirearm"),g=this.globals.mathDevice,e=b.getEC("ECChargeableShot");e&&e.isCharging()&&e.primeForFire();f&&f.getCanFire()&&(d?f.attemptFire(d):f.attemptFireAtLocation(this.setHeightToHeroHeight(g.v3AddScalarMul(c,a,10))),f.clearOverloadProjectile());(a=b.getEC("ECAutoFire"))&&(d?a.setTargetEntity(d):a.disable());d&&this.globals.gameManager.eventManager.notify("PlayerAttackedTarget",
this.getTargetEntity())}},pressSwipeAttack:function(){var a=this.getHeroEntity().getEC("ECChargeableShot");a&&a.canCharge()&&a.startCharging()},getTargetFromWorldDirection:function(a,b,c){var d=this.globals.mathDevice,f=null,g=0;b&&(b[1]=0,d.v3Normalize(b,b));var e=function(c){var e=c.getEC("ECSelectable");if(e&&(!e||e.isSelectable())&&this.getSelectedType(c)!==la.interactTypes.NONE){var h=c.getv3Location(),e=d.v3DistanceSq(a,h);if(b){h=d.v3Sub(h,a);d.v3Normalize(h,h);h=d.v3Dot(h,b);if(0>h)return;
h=d.remap(0,1,1,0.1,h);e*=h*h}if(!f||e<g)f=c,g=e}}.bind(this);this.gameManager.applyToEntitiesInGridCellsWithinRadius(a,c,e);return f},setModeInteractAlwaysDraw:function(){this.updateFunction=this.updateInteract;this.drawFunction=this.drawInteractAlwaysDraw;this.draw2DFunction=null;this.downFunction=this.downInteract;this.pressFunction=this.pressInteract;this.liftFunction=this.liftInteract;this.resetModeFunction=this.setModeInteractAlwaysDraw;this.useDirection=!1;this.typeValidFunction=this.allTypesValid},
setModeInteract:function(){this.updateFunction=this.updateInteract;this.drawFunction=this.drawInteract;this.draw2DFunction=null;this.downFunction=this.downInteract;this.pressFunction=this.pressInteract;this.liftFunction=this.liftInteract;this.resetModeFunction=this.setModeInteract;this.useDirection=!1;this.typeValidFunction=this.allTypesValid},setModeAttack:function(){this.updateFunction=this.updateInteract;this.drawFunction=this.drawInteractAlwaysDraw;this.draw2DFunction=null;this.downFunction=this.downInteract;
this.pressFunction=this.pressTargeted;this.liftFunction=this.liftInteract;this.resetModeFunction=this.setModeAttack;this.useDirection=!1;this.typeValidFunction=this.combatOnly},updateInteract:function(){var a=this.getHeroEntity().getEC("ECPlayerBuilder");this.useDirection=!(a&&a.isBuilding());this.calculateNearestTarget(this.getSelectionRadius())},drawInteractAlwaysDraw:function(){this.drawInteract(!0)},drawInteract:function(a){if(!this.isIMGuiHot){var b=this.globals,c=b.mathDevice,d=b.simpleSpriteRenderer,
f=this.getv3WorldCursorLocation(),g=c.v3Copy(f),e=this.getHeroEntity(),i=e.getEC("ECSuper"),j=k.outline[0],r=k.outline[1],l=k.outline[2],m=c.v3BuildYAxis(),q=c.v3BuildYAxis(),b=b.camera,p=b.getv3Location(),p=c.v3ToAngle(c.v3Sub(f,p));void 0!==this.collisionInfo&&(q=this.collisionInfo.v3Normal,c.v3Add(this.collisionInfo.v3Location,c.v3ScalarMul(q,0.1),g));this.drawChargeableShotUI();j=c.v3Build(j,r,l);r=this.getTextureAndRGBForChargeType(this.interactType,j);l=i?i.getChargeFactor():0;c.v3ScalarMul(j,
1<=l?2:1,j);(g=this.getTargetEntity())&&!g.toBeDestroyed?(a=c.v3Copy(g.getv3Location()),a[1]=g.v3Location[1]-0.2,this.prevDown&&r&&d.addSprite({v3Location:a,size:c.lerp(4,0.6,l),blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:r,v4color:c.v4Build(j[0],j[1],j[2],c.lerp(0,1,l)),out:m,angle:p}),c=g.getCentreLocation(),b.screenRadiusToWorldRadius(c,35),this.drawTargetCross(f,!0)):a&&this.drawTargetCross(f,!0);(f=e.getEC("ECPlayerBuilder"))&&f.isBuilding()&&f.drawPlacementInfo(this.getv3WorldCursorLocation(),
!this.hasHeldOrSwiped());i&&i.hasFinishedCharging()&&i.drawSuper(g,this.interactType)}},downInteract:function(){},pressInteract:function(){var a=this.getHeroEntity().getEC("ECPlayerBuilder");a&&a.isBuilding()?this.getTargetEntity()&&this.beginTargeted():this.beginTargeted()},pressTargeted:function(){this.beginTargeted()},liftInteract:function(){var a=this.getHeroEntity().getEC("ECPlayerBuilder");a&&a.isBuilding()&&a.isValidToBuildOnMoveAndPlaceSpot(this.getv3WorldCursorLocation())&&a.attemptToPlaceBuilding(this.getv3WorldCursorLocation());
this.activateTargetEntityIfValid()},setModeCommand:function(){this.updateFunction=this.updateIssueCommand;this.drawFunction=this.drawIssueCommand;this.draw2DFunction=null;this.downFunction=this.downIssueCommand;this.pressFunction=this.pressTargetedOrMove;this.liftFunction=this.liftIssueCommand;this.resetModeFunction=this.setModeCommand;this.useDirection=!1;this.typeValidFunction=this.allTypesValid},setModeMoveInteract:function(){this.updateFunction=this.updateIssueCommand;this.drawFunction=this.drawIssueCommand;
this.draw2DFunction=null;this.downFunction=this.downIssueCommand;this.pressFunction=this.pressTargetedOrMove;this.liftFunction=this.liftIssueCommand;this.resetModeFunction=this.setModeMoveInteract;this.useDirection=!1;this.typeValidFunction=this.nonCombatOnly},drawIssueCommand:function(){if(!this.isIMGuiHot){var a=this.globals,b=a.mathDevice,c=a.simpleSpriteRenderer,d=this.getv3WorldCursorLocation(),f=b.v3Copy(d),g=b.v3Copy(d),e=this.getHeroEntity(),i=e.getEC("ECSuper"),j=k.outline[0],r=k.outline[1],
l=k.outline[2],m=b.v3BuildYAxis(),q=b.v3BuildYAxis(),a=a.camera,p=a.getv3Location(),s=b.v3ToAngle(b.v3Sub(d,p)),t,u,w=this.CURSOR_YOFFSET;e&&((u=e.getEC("ECNav"))&&u.isOnPath()?u=u.getv3Destination():(u=e.getEC("ECLocomotion"),u=u.getDestination()),g[1]=e.v3Location[1]-w);p=!1;u&&(b.v3ToAngle(b.v3Sub(u,e.v3Location)),t=b.v3Copy(u),t[1]=e.v3Location[1]-w);void 0===t&&(b.v3ToAngle(b.v3Sub(d,e.v3Location)),t=d);void 0!==this.collisionInfo&&(q=this.collisionInfo.v3Normal,b.v3Add(this.collisionInfo.v3Location,
b.v3ScalarMul(q,0.1),f));this.drawChargeableShotUI();var q=b.v3Build(j,r,l),B=this.getTextureAndRGBForChargeType(this.interactType,q),y=i?i.getChargeFactor():0;b.v3ScalarMul(q,1<=y?2:1,q);(d=this.getTargetEntity())&&!d.toBeDestroyed?(f=b.v3Copy(d.getv3Location()),f[1]=d.v3Location[1]-w,this.prevDown&&B&&c.addSprite({v3Location:f,size:b.lerp(4,0.6,y),blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:B,v4color:b.v4Build(q[0],q[1],q[2],b.lerp(0,1,y)),out:m,angle:s}),s=d.getEC("ECSelectable"),w=
d.getCentreLocation(),a.screenRadiusToWorldRadius(w,this.getSelectionRadius()+this.getAddedSelectionRadius()),s&&s.isSelectable()&&s.getRadiusFactor(),s=this.gameManager.getHero(),a=d.getEC("ECTarget"),s=s.isFriendlyWith(d),a&&!s?this.crashMobController.setCursorTexture("textures/cursors/attack.png"):this.crashMobController.setCursorTexture("textures/cursors/interact.png")):this.prevDown?(p=!0,this.crashMobController.setCursorTexture("textures/cursors/move.png")):this.crashMobController.setCursorTexture("textures/cursors/default.png");
!p&&u&&(c.addSprite({v3Location:this.prevDown?g:t,size:0.75,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:this.crashMobController.bigCircleTexturePath,v4color:k.outlineSoft,out:m}),c.addSprite({v3Location:this.prevDown?g:t,size:0.75,blendStyle:ua.prototype.blendStyle.NORMAL,texture:this.crashMobController.bigCircleTexturePath,v4color:b.v4Build(j,r,l,0.5),out:m}));(b=e.getEC("ECPlayerBuilder"))&&b.isBuilding()&&b.drawPlacementInfo(this.getv3WorldCursorLocation(),!this.hasHeldOrSwiped());i&&
i.hasFinishedCharging()&&i.drawSuper(d,this.interactType)}},drawChargeableShotUI:function(){var a=this.getHeroEntity(),b=a.getEC("ECChargeableShot"),c=this.getTargetEntity();b&&(c&&b.isCharging()&&b.drawChargeUI(c.getCentreLocation(),1,0,!0),b.isFullyCharged()&&b.drawChargeUI(a.getv3Location(),1.5,-0.25,!1))},drawChargeableShotUIOnHero:function(){var a=this.getHeroEntity(),b=a.getEC("ECChargeableShot");b&&(b.isCharging()&&b.drawChargeUI(a.getCentreLocation(),1,0,!0),b.isFullyCharged()&&b.drawChargeUI(a.getv3Location(),
1.5,-0.25,!1))},getTextureAndRGBForChargeType:function(a,b){var c=this.getHeroEntity(),d=c.getEC("ECHero"),f=d.g,g=d.b;b[0]=d.r;b[1]=f;b[2]=g;if((c=c.getEC("ECSuper"))&&c.getSpecialFromChargeType(a))switch(a){case la.interactTypes.FRIEND:return this.crashMobController.chargeFriendTexturePath;case la.interactTypes.ENEMY:return this.crashMobController.chargeEnemyTexturePath;case la.interactTypes.ENEMY_MELEE:return this.crashMobController.chargeEnemyTexturePath;case la.interactTypes.ENEMY_RANGED:return this.crashMobController.chargeEnemyTexturePath;
case la.interactTypes.SELF:return this.crashMobController.chargeYouTexturePath}},drawTargetCross:function(a,b){var c=this.globals,d=c.mathDevice,f=c.simpleSpriteRenderer,g=c.camera,e=this.getHeroEntity().getEC("ECFirearm"),c=!1,i=2*Math.PI/4,g=g.screenRadiusToWorldRadius(a,30),j,r,l,m,q=k.outline[0],p=k.outline[1],s=k.outline[2];e&&(c=e.getCanFireFactor());b&&(q*=2,p*=2,s*=2);for(e=0;4>e;e+=1)m=d.remap(e,e+1,0,1,4*c),j=d.lerp(0.5,0.5,m),r=0.5*d.lerp(0,1,m)*Math.PI,l=d.lerp(1,1,m),f.addSprite({v3Location:a,
size:0.25*l,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:this.crashMobController.verticalTexturePath,v4color:d.v4Build(q,p,s,0.35+0.65*m),angle:0+e*i+r,offsetAngle:0+e*i+r,offsetY:1*g*j})},drawTargetScreenCircle:function(a,b,c,d,f){var g=this.globals,e=g.mathDevice,i=g.simpleSpriteRenderer,j=g.camera,k=Math.PI,l=a.getCentreLocation(),a=a.getEC("ECSelectable"),j=j.screenRadiusToWorldRadius(l,b);a&&(j*=a.getRadiusFactor());for(var b=e.clamp(0.1*b,5,30),b=Math.floor(b),a=2*k/b,m=0.125*g.gameCurrentTime,
g=0;g<b;g+=1)i.addSprite({v3Location:l,size:0.15,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:this.crashMobController.verticalTexturePath,v4color:e.v4Build(c,d,f,1),angle:m+g*a+0.5*k,offsetAngle:m+g*a,offsetY:1*j})},beginTargeted:function(){this.updateFunction=this.updateTargeted;this.downFunction=this.downTargeted;this.liftFunction=this.liftTargeted;this.interactType=la.interactTypes.NONE},endTargeted:function(){var a=this.getHeroEntity(),b=a.getEC("ECSuper");b&&b.release();var b=a.getEC("ECChargeableShot"),
c=a.getEC("ECFirearm");b&&b.isCharging()&&(b.canFireNonTargetedShot()?(b.primeForFire(),c&&c.attemptFireAtLocation(this.getv3WorldAimLocation()),c.clearOverloadProjectile()):b.stopCharging());(a=a.getEC("ECLocomotion"))&&a.clearLookAt();this.resetModeFunction&&this.resetModeFunction();this.interactType=la.interactTypes.NONE},updateTargeted:function(){this.calculateNearestTarget(this.getSelectionRadius()+this.getAddedSelectionRadius());var a=this.interactType;this.interactType=this.getSelectedType(this.getTargetEntity());
this.useDirection&&this.interactType===la.interactTypes.NONE&&(this.interactType=la.interactTypes.ENEMY_RANGED);this.END_TARGETED_IF_HELD&&this.hasHeld()?(this.endTargetedMode(a),this.clearTargetEntity(),this.beginMove()):(this.interactType!==a&&(this.endTargetedMode(a),this.beginTargetedMode(this.interactType)),this.updateTargetedMode(this.interactType))},liftTargeted:function(){var a=this.getHeroEntity().getEC("ECSuper");a&&a.hasFinishedCharging()&&a.activate(this.getTargetEntity(),this.interactType,
this.getv3WorldCursorLocation());this.liftTargetedMode(this.interactType);this.activateTargetEntityIfValid();this.endTargeted()},beginTargetedMode:function(a){switch(a){case la.interactTypes.ENEMY:this.beginTargetedRunMelee();break;case la.interactTypes.ENEMY_MELEE:this.beginTargetedMelee();break;case la.interactTypes.ENEMY_RANGED:this.beginTargetedRanged();break;case la.interactTypes.SELF:this.beginTargetedSelf();break;case la.interactTypes.INTERACTABLE:this.beginTargetedInteractable()}},endTargetedMode:function(a){switch(a){case la.interactTypes.ENEMY:this.endTargetedRunMelee();
break;case la.interactTypes.ENEMY_MELEE:this.endTargetedMelee();break;case la.interactTypes.ENEMY_RANGED:this.endTargetedRanged();break;case la.interactTypes.SELF:this.endTargetedSelf();break;case la.interactTypes.INTERACTABLE:this.endTargetedInteractable()}},updateTargetedMode:function(a){switch(a){case la.interactTypes.NONE:this.updateTargetedNone();break;case la.interactTypes.ENEMY:this.updateTargetedRunMelee();break;case la.interactTypes.ENEMY_MELEE:this.updateTargetedMelee();break;case la.interactTypes.ENEMY_RANGED:this.updateTargetedRanged();
break;case la.interactTypes.SELF:this.updateTargetedSelf();break;case la.interactTypes.INTERACTABLE:this.updateTargetedInteractable()}},liftTargetedMode:function(a){switch(a){case la.interactTypes.ENEMY:this.liftTargetedRunMelee();break;case la.interactTypes.ENEMY_MELEE:this.liftTargetedMelee();break;case la.interactTypes.ENEMY_RANGED:this.liftTargetedRanged();break;case la.interactTypes.SELF:this.liftTargetedSelf();break;case la.interactTypes.INTERACTABLE:this.liftTargetedInteractable()}},updateTargetedNone:function(){var a=
!0,b=!1,c=this.getHeroEntity(),d=c.getEC("ECChargeableShot");d&&d.isCharging()&&(d.canMoveFreely()||(a=!1),d.canFireNonTargetedShot()&&(b=!0));this.hasHeldOrSwiped()&&a&&this.beginMove();b&&(a=c.getEC("ECLocomotion"))&&a.setLookAt(this.getv3WorldCursorLocation())},beginTargetedMelee:function(){var a=this.getHeroEntity(),b=a.getEC("ECMelee");b&&b.charge();(a=a.getEC("ECLocomotion"))&&a.clearDestination()},updateTargetedMelee:function(){if(this.getTargetEntity()){var a=this.getHeroEntity().getEC("ECLocomotion");
a&&a.setFacing(this.getTargetEntity().getv3Location())}},endTargetedMelee:function(){var a=this.getHeroEntity(),b=a.getEC("ECMelee");b&&b.release();(a=a.getEC("ECLocomotion"))&&a.clearFacing()},liftTargetedMelee:function(){var a=this.getHeroEntity(),b=a.getEC("ECMelee");b&&b.attemptAttack(this.getTargetEntity(),!this.collisionInfo);(a=a.getEC("ECLocomotion"))&&a.clearFacing();this.globals.gameManager.eventManager.notify("PlayerAttackedTarget",this.getTargetEntity())},beginTargetedRunMelee:function(){},
updateTargetedRunMelee:function(){if(this.getTargetEntity()){var a=this.getHeroEntity().getEC("ECLocomotion");a&&a.setFacing(this.getTargetEntity().getv3Location())}},endTargetedRunMelee:function(){var a=this.getHeroEntity().getEC("ECLocomotion");a&&a.clearFacing()},liftTargetedRunMelee:function(){var a=this.getHeroEntity(),b=a.getEC("ECChargeAttack");b&&b.attemptAttack(this.getTargetEntity());(a=a.getEC("ECLocomotion"))&&a.clearFacing();this.globals.gameManager.eventManager.notify("PlayerAttackedTarget",
this.getTargetEntity())},beginTargetedRanged:function(){var a=this.getHeroEntity().getEC("ECChargeableShot");a&&a.canCharge()&&a.startCharging();this.ATTACK_ON_DOWN&&this.attackRangedTargetedEntity()},updateTargetedRanged:function(){var a=this.getHeroEntity().getEC("ECLocomotion"),b;a&&(b=this.getTargetEntity()?this.getTargetEntity().getv3Location():this.getv3WorldCursorLocation(),a.setLookAt(b),a.setFacing(b))},endTargetedRanged:function(){var a=this.getHeroEntity().getEC("ECLocomotion");a&&(a.clearLookAt(),
a.clearFacing())},attackRangedTargetedEntity:function(){var a=this.getHeroEntity(),b=a.getEC("ECChargeableShot"),c=this.getTargetEntity();c&&c.toBeDestroyed&&(c=null);b&&b.isCharging()&&b.primeForFire();b=a.getEC("ECFirearm");a=a.getEC("ECAutoFire");if(b&&b.getCanFire()&&(!a||!c||a.isWithinFiringRange(c.getv3Location())))c?b.attemptFire(this.getTargetEntity()):b.attemptFireAtLocation(this.getv3WorldAimLocation()),b.clearOverloadProjectile();a&&(c?a.setTargetEntity(c):a.disable());this.globals.gameManager.eventManager.notify("PlayerAttackedTarget",
this.getTargetEntity())},liftTargetedRanged:function(){this.ATTACK_ON_DOWN||this.attackRangedTargetedEntity();var a=this.getHeroEntity().getEC("ECLocomotion");a&&(a.clearLookAt(),a.clearFacing())},beginTargetedInteractable:function(){},updateTargetedInteractable:function(){},endTargetedInteractable:function(){},liftTargetedInteractable:function(){var a=this.getTargetEntity().getEC("ECInteractable"),b=this.getHeroEntity();a&&(a.shouldApproachOnUp(b)?this.setControllableDestination(!1,!1,!0):a.executeCallbacks(b))},
beginTargetedSelf:function(){},updateTargetedSelf:function(){},endTargetedSelf:function(){},liftTargetedSelf:function(){},downTargeted:function(){var a=this.getHeroEntity().getEC("ECSuper");a&&a.charge()},pressTargetedOrMove:function(){var a=this.getHeroEntity();this.getTargetEntity()?this.beginTargeted():(a=a.getEC("ECPlayerBuilder"))&&a.isBuilding()?this.beginBuildingPlacement():this.beginMove()},beginBuildingPlacement:function(){var a=0,b=0;if((b=this.getHeroEntity().getEC("ECPlayerBuilder"))&&
b.isBuilding()&&b.isValidToBuildOnV3CursorLocation(this.getv3WorldCursorLocation())&&!b.isValidToBuildOnMoveAndPlaceSpot(this.getv3WorldCursorLocation()))a=b.getRequiredCloseness(),b=b.getMaxRequiredCloseness()-2,this.setControllableDestination(this.crashMobController.controlNavigate,!1,!0,!1,b,a);this.updateFunction=this.updateBuildingPlacement;this.downFunction=this.downBuildingPlacement;this.liftFunction=this.liftBuildingPlacement},liftMoveIssueCommand:function(){this.liftMove();this.clearActivatedEntity();
this.resetModeFunction&&this.resetModeFunction()},beginMove:function(){this.updateFunction=this.updateMove;this.downFunction=this.downMove;this.liftFunction=this.liftMoveIssueCommand;this.getHeroEntity()&&this.setControllableDestination(this.crashMobController.controlNavigate,!1,!0)},endMove:function(){this.resetModeFunction&&this.resetModeFunction()},setControllableDestination:function(a,b,c,d,f,g){var e,i,j=this.collisionInfo,k,l=this.globals.mathDevice,m,q=this.getHeroEntity(),p=!1;if(q){m=q.getv3Location();
e=q.getEC("ECLocomotion");i=q.getEC("ECNav");if(e){k=this.getv3WorldCursorLocation();if(f||g)j=l.v3Distance(k,m),m=l.v3Sub(k,m),l.v3Normalize(m,m),f&&(j=Math.min(j,f)),g&&(j=Math.max(j,g)),k=l.v3Sub(k,l.v3ScalarMul(m,j)),j=this.buildCollisionInfo(k);i&&(a&&this.gameManager.getGameSpace(k,0)&&i.setDestinationV3Location(k,!0)&&(p=!0),p||i.endPath());d&&this.getTargetEntity()?(k=this.getTargetEntity().getv3Location(),e.setDestinationEntity(this.getTargetEntity())):e.clearDestinationEntity();j&&c&&(k=
void 0!==j.v3PointOut?j.v3PointOut:j.v3Location);p||e.setDestination(k,b)}(a=q.getEC("ECChargeAttack"))&&a.cancel()}},downIssueCommand:function(){this.hasHeldOrSwiped()&&this.setControllableDestination(!1,this.hasHeldOrSwiped(),!this.hasHeldOrSwiped(),!1)},updateIssueCommand:function(){this.calculateNearestTarget(this.getSelectionRadius())},liftIssueCommand:function(){this.resetModeFunction&&this.resetModeFunction();this.activateTargetEntityIfValid()},updateBuildingPlacement:function(){},downBuildingPlacement:function(){this.hasHeldOrSwiped()&&
this.beginMove()},liftBuildingPlacement:function(){var a=this.getHeroEntity().getEC("ECPlayerBuilder");a&&a.isBuilding()&&a.isValidToBuildOnMoveAndPlaceSpot(this.getv3WorldCursorLocation())&&a.attemptToPlaceBuilding(this.getv3WorldCursorLocation());this.resetModeFunction&&this.resetModeFunction();this.activateTargetEntityIfValid()},setModeDebugNav:function(){this.updateFunction=this.updateDebugNav;this.pressFunction=this.downFunction=null;this.drawFunction=this.drawDebugNav;this.draw2DFunction=null;
this.liftFunction=this.liftDebugNav;this.resetModeFunction=this.setModeDebugNav;this.useDirection=!1;this.typeValidFunction=this.allTypesValid},drawDebugNav:function(){var a=this.globals,b=a.mathDevice,c=a.simpleSpriteRenderer,a=a.gameManager.getNavManager(),d=this.getv3WorldCursorLocation(),f=this.getHeroEntity().getEC("ECHero"),g=f.r,e=f.g,i=f.b,f=b.v4Build(0,1,0,1),j=b.v4Build(1,0,0,1),k=b.v3BuildYAxis();c.addSprite({v3Location:d,size:0.5,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:this.crashMobController.bigCircleTexturePath,
v4color:b.v4Build(g,e,i,1),out:k});b=a.getDebugPathStartEntity();a=a.getDebugPathEndEntity();b&&c.addSprite({v3Location:b.getv3Location(),size:1.5,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:this.crashMobController.bigCircleTexturePath,v4color:f,out:k});a&&c.addSprite({v3Location:a.getv3Location(),size:1.5,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:this.crashMobController.bigCircleTexturePath,v4color:j,out:k})},updateDebugNav:function(){var a=this.inputDevice,b=a.keyCodes,c=
a.mouseCodes,d=this.globals.gameManager,a=d.getNavManager(),f=this.getv3WorldCursorLocation(),g=d.getGameSpace(f),d=g.getNavGridEnemyWeighted();if(this.worldDown)if(this.crashMobController.pressedKeys[b.LEFT_SHIFT]){if(a=g.getV2GridLocationFromV3WorldLocation(f))this.crashMobController.pressedButtons[c.BUTTON_0]?d.setImpassable(a):d.setPassable(a),d.finalise()}else this.crashMobController.pressedKeys[b.LEFT_ALT]&&(this.crashMobController.pressedButtons[c.BUTTON_0]?(c=this.getNearestTarget(this.getSelectionRadius()))?
a.setDebugPathStartEntity(c):a.setDebugPathV3LocationStart(f):(c=this.getNearestTarget(this.getSelectionRadius()))?a.setDebugPathEndEntity(c):a.setDebugPathV3LocationEnd(f));this.crashMobController.pressedKeys[b.SPACE]&&d.reset()},liftDebugNav:function(){var a=this.getNearestTarget(this.getSelectionRadius()),b=this.selectedEntity,c,d;if(!a&&b){if(a=this.globals.gameManager,a=a.getNavManager(),c=b.getv3Location(),d=this.getv3WorldCursorLocation(),b=b.getEC("ECNav"))(a=a.getV3ToV3Path(c,d,null,0))&&
b.setPath(a)}else this.selectedEntity=a;this.activateTargetEntityIfValid()},allTypesValid:function(a){return a},combatOnly:function(a){switch(a){case la.interactTypes.ENEMY:return a;case la.interactTypes.ENEMY_MELEE:return a;case la.interactTypes.ENEMY_RANGED:return a}return la.interactTypes.NONE},nonCombatOnly:function(a){switch(a){case la.interactTypes.FRIEND:return a;case la.interactTypes.SELF:return a;case la.interactTypes.INTERACTABLE:return a}return la.interactTypes.NONE},setTargetEntity:function(a){var b;
if(this.targetEntity!==a&&(this.targetEntity&&(b=this.targetEntity.getEC("ECSelectable"))&&b.setHot(!1),this.targetEntity=a))(b=this.targetEntity.getEC("ECSelectable"))&&b.setHot(!0);this.targetEntity&&(b||(b=this.targetEntity.getEC("ECSelectable")),b&&(a=(a=this.getHeroEntity().getEC("ECChargeableShot"))&&a.isFullyCharged(),b.setSelectedByFullyChargedShot(a)))},clearTargetEntity:function(){this.setTargetEntity(void 0)},calculateNearestTarget:function(a){this.targetEntity&&!0===this.targetEntity.toBeDestroyed&&
(this.targetEntity=void 0);a=this.getNearestValidTarget(a,this.useDirection);this.setTargetEntity(a)},getNearestTarget:function(a){if(this.isIMGuiHot)return this.targetEntity;var b=this.globals,c=b.mathDevice,d=b.camera,b=b.graphicsDevice.width,f=this.crashMobController.getv2ScreenCoord(),g=null,e=0,i=a/1E3*b,a=function(a){var b=i,l=a.getEC("ECSelectable");if(l&&(!l||l.isSelectable()))if(b*=l.getRadiusFactor(),l=d.worldToScreen(a.getCentreLocation()))if(l=c.v2DistanceSq(f,l),!(l>b*b)&&(null===g||
l<e))g=a,e=l}.bind(this),b=this.getv3WorldCursorLocation();this.gameManager.applyToEntitiesInGridCellsWithinRadius(b,10,a);return g},getNearestValidTarget:function(a,b){if(this.isIMGuiHot)return this.targetEntity;var c=this.globals,d=c.mathDevice,f=c.camera,c=c.graphicsDevice.width,g=this.crashMobController.getv2ScreenCoord(),e=null,i=0,j=a/1E3*c,k=this.getHeroEntity().getv3Location(),c=this.getv3WorldCursorLocation(),l=d.v3Sub(c,k);d.v3Normalize(l,l);var m=0,q=!1,p=function(a){var c=j,p=a.getEC("ECSelectable");
if(p&&(!p||p.isSelectable())){var c=c*p.getRadiusFactor(),t=this.getSelectedType(a);if(t!==la.interactTypes.NONE&&(p=f.worldToScreen(a.getCentreLocation())))if(b&&(!q&&t===la.interactTypes.ENEMY_RANGED)&&(t=d.v3Sub(a.getCentreLocation(),k),d.v3Normalize(t,t),t=d.v3Dot(t,l),t>m&&(e=a,m=t)),p=d.v2DistanceSq(g,p),!(p>c*c)&&(!q||p<i))e=a,i=p,q=!0}}.bind(this);this.gameManager.applyToEntitiesInGridCellsWithinRadius(c,10,p);return e},getHeldDuration:function(){return this.globals.appCurrentTime-this.downTime},
hasHeld:function(){return this.prevDown&&this.getHeldDuration()>this.HELD_THRESHOLD?!0:!1},hasHeldOrSwiped:function(){return this.hasHeld()||this.hasSwiped()},hasSwiped:function(){var a=this.globals.mathDevice;return this.prevDown&&100<a.v2DistanceSq(this.crashMobController.getv2ScreenCoord(),this.downv2ScreenCoord)?!0:!1},getSelectionRadius:function(){return this.crashMobController.selectionRadius},getAddedSelectionRadius:function(){return this.crashMobController.addedSelectionRadius},getv3WorldCursorLocation:function(){return this.crashMobController.getv3WorldCursorLocation()},
getv3WorldAimLocation:function(){var a=this.globals.mathDevice,b=this.getv3WorldCursorLocation(),a=a.v3Copy(b);return this.setHeightToHeroHeight(a)},setHeightToHeroHeight:function(a){var b=this.getHeroEntity(),c;c=b.getv3Location();if(b&&(a[1]=c[1],b=b.getEC("ECPhysicsSphere")))c=b.getv3CapsuleTopLocation()[1]-c[1],a[1]+=c;return a},getTargetEntity:function(){return this.targetEntity},getHeroEntity:function(){return this.crashMobController.getHeroEntity()},getSelectedType:function(a){return this.typeValidFunction(this.crashMobController.getSelectedType(a))},
activateTargetEntityIfValid:function(){this.interactType!==la.interactTypes.NONE&&this.activateTargetEntity()},buildCollisionInfo:function(a){return this.crashMobController.buildCollisionInfo(a)}};Ud.create=function(a,b,c){var d=new Ud;d.globals=a;d.gameManager=b;d.crashMobController=c;return d};la.interactTypes={NONE:-1,FRIEND:0,ENEMY:1,ENEMY_MELEE:2,ENEMY_RANGED:3,ENEMY_INVALID:4,SELF:5,INTERACTABLE:6,LAST:7};la.prototype={initUI:function(){var a=this.globals.dynamicUI;if(a){var b=a.addGroup("Controller");
a.watchVariable("Selection Radius",this,"selectionRadius","slider",b,{min:10,max:100,step:0.1});a.watchVariable("Added Selection Radius",this,"addedSelectionRadius","slider",b,{min:10,max:50,step:0.1})}},setActive:function(a){this.active!==a&&((this.active=a)?this.addEventHandlers():this.removeEventHandlers())},isActive:function(){return this.active},setScreenCoord:function(a,b){this.sx=a;this.sy=b},getv2ScreenCoord:function(){return this.globals.mathDevice.v2Build(this.sx,this.sy)},getGuiDown:function(){return this.guiDown},
update:function(){this.evaluateMouseOwnership();this.calculateCollisionInfo();var a,b;this.controlOneButton||this.controlwsad?a=this.controllerActionA.update(this.mousePressed,this.mouseLifted,!0):(a=this.controllerActionA.update(this.mousePressed0,this.mouseLifted0,!1),b=this.controllerActionB.update(this.mousePressed1,this.mouseLifted1,!0));(this.guiDown=a)?this.mousePressed0=this.mousePressed=!1:this.mouseLifted0=this.mouseLifted=!1;b?this.mousePressed1=!1:this.mouseLifted1=!1;this.controlwsad&&
this.updateMovementFromKeys();this.updateCamera()},getActivatedEntity:function(){if(!this.capturedMouse||!this.isActive()){var a=this.controllerActionA.getActivatedEntity();return a?a:this.controllerActionB.getActivatedEntity()}},lockMouse:function(){this.inputDevice.lockMouse()},unlockMouse:function(){var a=this.inputDevice;a&&a.unlockMouse()},callDown:function(a){var b=this.inputDevice.mouseCodes;this.mousePressed=!0;this.mousePressed0=a===b.BUTTON_0;this.mousePressed1=a===b.BUTTON_1},callUp:function(a){var b=
this.inputDevice.mouseCodes;this.mouseLifted=!0;this.mouseLifted0=a===b.BUTTON_0;this.mouseLifted1=a===b.BUTTON_1},clearMouseInputs:function(){this.mouseLifted1=this.mousePressed1=this.mouseLifted0=this.mousePressed0=this.mouseLifted=this.mousePressed=!1},draw:function(){this.calculateCollisionInfo();this.isActive()&&this.drawFunction&&this.drawFunction();this.controllerActionA.draw();this.controllerActionB.draw()},draw2D:function(){this.isActive()&&this.draw2DFunction&&this.draw2DFunction();this.controllerActionA.draw2D();
this.controllerActionB.draw2D()},calculateCollisionInfo:function(){this.v3WorldCursorLocation=this.calculatev3WorldCursorLocation();this.collisionInfo=this.buildCollisionInfo(this.v3WorldCursorLocation)},buildCollisionInfo:function(a){var b=this.globals.mathDevice,c=this.getHighHeroLocation(),d=b.v3Copy(a);d[1]=c[1];if(a=this.gameManager.getCollisionInfo(c,d))c=b.v3Sub(d,c),c=b.v3Normalize(c),d=b.v3Dot(c,a.v3Normal),b=1E-4<=Math.abs(d)?b.v3Sub(a.v3Location,b.v3ScalarMul(c,-(0.35/d))):b.v3Copy(a.v3Location),
a.v3PointOut=b;return a},drawDebug:function(){var a=this.globals,b=a.debugDraw,a=a.mathDevice,c=this.getHighHeroLocation(),d=a.v3Copy(this.v3WorldCursorLocation);d[1]=c[1];void 0!==this.heroEntity&&(void 0!==this.collisionInfo?(b.drawDebugLine(c,this.collisionInfo.v3Location,1,0,0),b.drawDebugLine(this.collisionInfo.v3Location,a.v3Add(this.collisionInfo.v3Location,this.collisionInfo.v3Normal),1,0,0),b.drawDebugLine(this.collisionInfo.v3Location,this.collisionInfo.v3PointOut,1,0,1)):(b.drawDebugLine(c,
d,0,1,0),b.drawDebugPoint(d,0,1,0,1)))},clearInputs:function(){this.callUp();this.clearFunction&&this.clearFunction()},setHero:function(a){this.heroEntity=a},setModeSplashScreen:function(){this.draw2DFunction=this.drawFunction=null;this.controllerActionA.setModeSplashScreen();this.controllerActionB.setModeSplashScreen()},setModeInactive:function(){this.draw2DFunction=this.drawFunction=null;this.controllerActionA.setModeInactive();this.controllerActionB.setModeInactive()},setModeEditor:function(){this.liftFunction=
this.downFunction=this.pressFunction=this.draw2DFunction=this.drawFunction=this.updateFunction=null},setModeMenuScreen:function(){this.drawFunction=null;this.draw2DFunction=this.draw2DCursorIfNeeded;this.controllerActionA.setModeMenuScreen();this.controllerActionB.setModeMenuScreen()},draw2DCursorIfNeeded:function(){this.gameManager.getIMGui().hasCapturedInput()&&this.capturedMouse&&this.setCursorTexture("textures/cursors/menu.png")},setModeCommand:function(){this.drawFunction=this.drawIssueCommand;
this.draw2DFunction=this.draw2DCursorIfNeeded;this.controlwsad?(this.controllerActionA.setModeInteractAlwaysDraw(),this.controllerActionB.setModeInactive()):this.controlOneButton?(this.controllerActionA.setModeCommand(),this.controllerActionB.setModeInactive()):(this.controllerActionA.setModeMoveInteract(),this.controlSwipe?this.controllerActionB.setModeSwipeAttack():this.controllerActionB.setModeAttack())},setModeDebugNav:function(){this.drawFunction=this.drawDebugNav;this.draw2DFunction=null;this.controllerActionA.setModeDebugNav();
this.controllerActionB.setModeDebugNav()},getHeroEntity:function(){return this.heroEntity},getHeroLocation:function(){var a=this.globals.mathDevice;return this.heroEntity?this.heroEntity.getv3Location():a.v3BuildZero()},getHighHeroLocation:function(){var a=this.globals.mathDevice;return this.heroEntity?this.heroEntity.getCentreLocation():a.v3BuildZero()},getv3WorldLocationFromCoord:function(a,b){var c,d,f,g;f=this.globals.camera;g=f.screenToWorld(a,b,2);c=null;if(g){var e=this.globals.mathDevice;
c=this.getHeroLocation();d=e.v3BuildYAxis();f=e.m43Pos(f.matrix);g=e.v3Sub(g,f);c=e.getRayPlaneIntersection(c,d,f,g)}return c},getv3WorldGroundLocationFromCoord:function(a,b){var c=this.globals.camera,d=c.screenToWorld(a,b,3E3);if(d){var f=this.gameManager,c=this.globals.mathDevice.m43Pos(c.matrix);if(d=f.getCollisionInfo(c,d,!1))return d.v3Location}return null},calculatev3WorldCursorLocation:function(){return this.getv3WorldLocationFromCoord(this.sx,this.sy)},getv3WorldCursorLocation:function(){return this.v3WorldCursorLocation},
getv3CameraCursorLocation:function(){return this.globals.camera.screenToWorld(this.sx,this.sy,2)},getSelectedType:function(a){var b=this.getHeroEntity();if(!a)return la.interactTypes.NONE;var c=b.getEC("ECPlayerBuilder"),c=c&&c.isBuilding(),d=a.getEC("ECInteractable"),f=a.getEC("ECDispenser");return d&&d.getActive()&&f&&c?la.interactTypes.INTERACTABLE:c?la.interactTypes.NONE:d&&d.getActive()?la.interactTypes.INTERACTABLE:a===b?la.interactTypes.SELF:a.hasEC("ECTarget")?(c=b.getEC("ECMelee"))&&c.isWithinRange(a)?
la.interactTypes.ENEMY_MELEE:(a=b.getEC("ECFirearm"))&&a.hasWeapon()?la.interactTypes.ENEMY_RANGED:la.interactTypes.ENEMY:la.interactTypes.NONE},getNearestValidTarget:function(a,b){if(this.isIMGuiHot)return this.targetEntity;var c=this.globals,d=c.mathDevice,f=c.camera,c=c.graphicsDevice.width,g=d.vec2Build(this.sx,this.sy),e=null,i=0,j=a/1E3*c,k=this.heroEntity.getv3Location(),c=this.getv3WorldCursorLocation(),l=d.v3Sub(c,k);d.v3Normalize(l,l);var m=0,q=!1,p=function(a){var c=j,p=a.getEC("ECSelectable");
if(p&&(!p||p.isSelectable())){var c=c*p.getRadiusFactor(),t=this.getSelectedType(a);if(t!==la.interactTypes.NONE&&(p=f.worldToScreen(a.getCentreLocation())))if(b&&(!q&&t===la.interactTypes.ENEMY_RANGED)&&(t=d.v3Sub(a.getCentreLocation(),k),d.v3Normalize(t,t),t=d.v3Dot(t,l),t>m&&(e=a,m=t)),p=g.getDistanceSq(p),!(p>c*c)&&(!q||p<i))e=a,i=p,q=!0}}.bind(this);this.gameManager.applyToEntitiesInGridCellsWithinRadius(c,10,p);return e},setWantsToMinScreen:function(a){this.wantsToMinscreen=a},setWantsToFullScreen:function(a){this.wantsToFullscreen=
a},updateMovementFromKeys:function(){var a=this.inputDevice.keyCodes,b=this.getHeroLocation(),c=this.globals.camera.matrix,d=this.globals.mathDevice,f=d.m43At(c),g=d.m43Right(c);f[1]=0;g[1]=0;d.v3Normalize(f,f);d.v3Normalize(g,g);c=d.v3BuildZero();this.pressedKeys[a.W]&&d.v3AddScalarMul(c,f,-1,c);this.pressedKeys[a.S]&&d.v3AddScalarMul(c,f,1,c);this.pressedKeys[a.A]&&d.v3AddScalarMul(c,g,-1,c);this.pressedKeys[a.D]&&d.v3AddScalarMul(c,g,1,c);0.1<d.v3LengthSq(c)&&(d.v3Normalize(c,c),d.v3ScalarMul(c,
5,c));(a=this.heroEntity.getEC("ECLocomotion"))&&a.setDestination(d.v3Add(b,c))},updateCamera:function(){var a=this.globals,b=this.inputDevice.keyCodes,c=a.gameManager,d=c.getEventManager();this.pressedKeys[b.RIGHT]&&(c.gameCamera.rotate(-0.5*Math.PI*a.gameTimeStep),d.notify("RotateCamera",{}));this.pressedKeys[b.LEFT]&&(c.gameCamera.rotate(0.5*Math.PI*a.gameTimeStep),d.notify("RotateCamera",{}))},isPressed:function(a){return this.pressedKeys[a]?!0:!1},onKeyUp:function(a){this.pressedKeys[a]=!1},
jump:function(){var a=this.heroEntity.getEC("ECPhysicsSphere"),b=this.globals.mathDevice;a&&!0===a.softForce&&a.applyForce(b.v3Build(0,qa.prototype.jumpForce*a.getMass()/this.globals.gameTimeStep,0))},onKeyDown:function(a){var b=this.globals,c=this.inputDevice.keyCodes,d=b.gameManager,f=d.getEventManager();a===c.P&&d.togglePause();if(a===c.F||a===c.LEFT_ALT&&this.pressedKeys[c.RETURN]||a===c.RETURN&&this.pressedKeys[c.LEFT_ALT])this.globals.graphicsDevice.fullscreen=!this.globals.graphicsDevice.fullscreen,
this.appTimeFullscreenChanged=this.globals.appCurrentTime,f.notify("GoFullScreen",{});this.globals.allowCheats&&(a===c.EQUALS&&d.speedUp(),a===c.MINUS&&d.slowDown(),a===c.N&&d.toggleDebugNav(),a===c.K&&d.saveLevel(!0),a===c.L&&d.restart(!0),a===c.SPACE&&d.speedReset(),a===c.I&&(this.globals.cheats.grindless=!this.globals.cheats.grindless),a===c.V&&d.forceCampaignEnd(!0),a===c.B&&d.forceCampaignEnd(!1),a===c.UP&&d.getTaskManager().completeTopCriticalTask(),a===c.DOWN&&d.getTaskManager().completeTopFillerTask(),
a===c.NUMPAD_8&&d.getTaskManager().updateDummyBadgeProgress(),a===c.NUMPAD_2&&d.getTaskManager().completeDummyBadgeTask());this.globals.enableEditor&&a===c.RETURN&&d.toggleEditor();this.globals.allowResetKey&&a===c.DELETE&&(d.clearUserData(),d.restart(!1));var g,e,i,j,k;if(this.globals.allowCheats&&(a===c.LEFT_CONTROL||a===c.LEFT_ALT)){f=this.getv3WorldCursorLocation();f[0]=Math.floor(f[0]);f[2]=Math.floor(f[2]);g=this.gameManager.getEntityFactory();e=g.getCurrentArchetype();var l=1;for(a===c.LEFT_CONTROL&&
b.profiling&&(l=10);0<l;){e&&(i=g.createActiveEntityInstance(e,e,f));if(i&&(j=i.getEC("ECFaction")))k=a===c.LEFT_CONTROL?d.getFactionManager().getEnemyFactionName():d.getFactionManager().getHeroFactionName(),j.setFaction(k);l-=1;f[0]+=2;5===l&&(f[0]-=10,f[2]+=2)}}this.globals.profiling&&(b=b.profilingData,a===c.HOME&&(b.performanceProfiling?(b.performanceProfiling=!1,console.profileEnd(b.performanceProfileName)):(b.performanceProfiling=!0,b.performanceProfilingCount+=1,b.performanceProfileName="PolyCraft Profile "+
b.performanceProfilingCount,console.profile(b.performanceProfileName))));this.pressedKeys[a]=!0},evaluateMouseOwnership:function(){var a=this.globals,b=a.graphicsDevice,a=a.mathDevice,c=b.width,b=b.height;this.capturedMouse&&(this.sx+=this.dx,this.sy+=this.dy,this.dy=this.dx=0,this.sx=a.clamp(this.sx,0,c),this.sy=a.clamp(this.sy,0,b),this.justLocked=!1)},onMouseUp:function(a){this.pressedButtons[a]=!1;this.callUp(a)},onMouseDown:function(a,b,c){var d=this.inputDevice;this.pressedButtons[a]=!0;this.mouseLockingEnabled&&
!d.isLocked()?(d.lockMouse(),this.sx=b,this.sy=c,this.dy=this.dx=0,this.justLocked=this.capturedMouse=!0):this.callDown(a);this.wantsToFullscreen&&(a=this.globals.gameManager,a=a.getEventManager(),a.notify("GoFullScreen",{}),this.globals.graphicsDevice.fullscreen=!0,this.appTimeFullscreenChanged=this.globals.appCurrentTime);this.wantsToFullscreen=!1;this.wantsToMinscreen&&(this.globals.graphicsDevice.fullscreen=!1,this.appTimeFullscreenChanged=this.globals.appCurrentTime);this.wantsToMinscreen=!1;
if(this.onMouseDownCallback)this.onMouseDownCallback()},onMouseMove:function(a,b){var c=this.inputDevice;this.mouseLockingEnabled&&c.isLocked()&&(this.dx+=a,this.dy+=b)},onMouseLockLost:function(){this.capturedMouse=!1;var a=this.gameManager;a.forceLevelSave();a.forceLeaderboardUpdate()},onMouseOver:function(a,b){var c=this.inputDevice;this.mouseLockingEnabled||(this.sx=a,this.sy=b,c.isHidden()||(this.capturedMouse=!0))},onMouseLeave:function(){},onTouchStart:function(a){a=a.changedTouches[0];this.sx=
a.positionX;this.sy=a.positionY;this.capturedMouse=!0;this.callDown(this.inputDevice.mouseCodes.BUTTON_0);if(this.onMouseDownCallback)this.onMouseDownCallback()},onTouchEnd:function(){this.callUp(this.inputDevice.mouseCodes.BUTTON_0)},onTouchMove:function(a){a=a.changedTouches[0];this.sx=a.positionX;this.sy=a.positionY},addEventHandlers:function(){var a=this.inputDevice;a.addEventListener("keyup",this.onKeyUpBound);a.addEventListener("keydown",this.onKeyDownBound);a.addEventListener("mouseup",this.onMouseUpBound);
a.addEventListener("mousedown",this.onMouseDownBound);a.addEventListener("mousemove",this.onMouseMoveBound);a.addEventListener("mouselocklost",this.onMouseLockLostBound);a.addEventListener("mouseover",this.onMouseOverBound);a.addEventListener("mouseleave",this.onMouseLeaveBound);a.addEventListener("touchstart",this.onTouchStartBound);a.addEventListener("touchend",this.onTouchEndBound);a.addEventListener("touchmove",this.onTouchMoveBound)},removeEventHandlers:function(){var a=this.inputDevice;a.removeEventListener("keyup",
this.onKeyUpBound);a.removeEventListener("keydown",this.onKeyDownBound);a.removeEventListener("mouseup",this.onMouseUpBound);a.removeEventListener("mousedown",this.onMouseDownBound);a.removeEventListener("mousemove",this.onMouseMoveBound);a.removeEventListener("mouselocklost",this.onMouseLockLostBound);a.removeEventListener("mouseover",this.onMouseOverBound);a.removeEventListener("mouseleave",this.onMouseLeaveBound);a.removeEventListener("touchstart",this.onTouchStartBound);a.removeEventListener("touchend",
this.onTouchEndBound);a.removeEventListener("touchmove",this.onTouchMoveBound)},loadTexture:function(a,b){var c=this;this.globals.textureManager.load(b,!1,function(b){c[a]=b})},preload:function(){this.loadTexture("cursorTexture",this.cursorTexturePath);this.loadTexture("chargeFriendTexture",this.chargeFriendTexturePath);this.loadTexture("chargeEnemyTexture",this.chargeEnemyTexturePath);this.loadTexture("chargeYouTexture",this.chargeYouTexturePath);this.loadTexture("noTexture",this.noTexturePath);
this.loadTexture("bigCircleTexture",this.bigCircleTexturePath);this.loadTexture("bigCircleDashedTexture",this.bigCircleDashedTexturePath);this.loadTexture("bigArrowTexture",this.bigArrowTexturePath);this.loadTexture("verticalTexture",this.verticalTexturePath);this.loadTexture("interactCursorTexture","textures/cursors/interact.png");this.loadTexture("moveCursorTexture","textures/cursors/move.png");this.loadTexture("defaultCursorTexture","textures/cursors/default.png");this.loadTexture("combatCursorTexture",
"textures/cursors/attack.png")},reset:function(){this.pressedKeys={}},setMouseLockable:function(a){this.mouseLockingEnabled=a},setOnMouseDownCallback:function(a){this.onMouseDownCallback=a},setCursorTexture:function(a){a="url("+this.globals.mappingTable.getURL(a)+"), auto";TurbulenzEngine.canvas&&ea.enableCustomCursors&&(TurbulenzEngine.canvas.style.cursor=a)}};la.create=function(a,b){var c=new la;c.globals=a;c.sx=0;c.sy=0;c.dx=0;c.dy=0;c.capturedMouse=!1;c.gameManager=b;c.inputDevice=a.inputDevice;
c.selectionRadius=35;c.addedSelectionRadius=10;c.placingBuilding=!1;c.pressedKeys={};c.pressedButtons={};c.cursorTexture=null;c.cursorTexturePath="textures/cursor.dds";c.chargeFriendTexture=null;c.chargeFriendTexturePath="textures/friend.dds";c.chargeEnemyTexture=null;c.chargeEnemyTexturePath="textures/enemy.dds";c.chargeYouTexture=null;c.chargeYouTexturePath="textures/you.dds";c.noTexture=null;c.noTexturePath="textures/no.dds";c.bigCircleTexture=null;c.bigCircleTexturePath="textures/bigcircle.dds";
c.bigCircleDashedTexture=null;c.bigCircleDashedTexturePath="textures/bigcircledashed.dds";c.bigArrowTexture=null;c.bigArrowTexturePath="textures/bigarrow.dds";c.verticalTexture=null;c.verticalTexturePath="textures/vertical.dds";c.mouseLockingEnabled=ea.lockMouseInMenus;c.controllerActionA=Ud.create(a,b,c);c.controllerActionB=Ud.create(a,b,c);c.controlOneButton=ea.controlOneButton;c.controlwsad=ea.controlwsad;c.controlNavigate=ea.controlNavigate;c.controlSwipe=ea.controlSwipe;c.onKeyUpBound=c.onKeyUp.bind(c);
c.onKeyDownBound=c.onKeyDown.bind(c);c.onMouseUpBound=c.onMouseUp.bind(c);c.onMouseDownBound=c.onMouseDown.bind(c);c.onMouseMoveBound=c.onMouseMove.bind(c);c.onMouseLockLostBound=c.onMouseLockLost.bind(c);c.onMouseOverBound=c.onMouseOver.bind(c);c.onMouseLeaveBound=c.onMouseLeave.bind(c);c.onTouchStartBound=c.onTouchStart.bind(c);c.onTouchEndBound=c.onTouchEnd.bind(c);c.onTouchMoveBound=c.onTouchMove.bind(c);c.appTimeFullscreenChanged=0;c.onMouseDownCallback=null;c.setActive(!0);return c};var fd=
Object,Pi=!1,rk=/xyz/.test(function(){})?/\b_super\b/:/.*/;fd.extend=function(a){function b(){!Pi&&this.init&&this.init.apply(this,arguments);return this}var c=this.prototype;Pi=!0;var d=new this;Pi=!1;for(var f in a)d[f]="function"==typeof a[f]&&"function"==typeof c[f]&&rk.test(a[f])?function(a,b){return function(){var d=this._super;this._super=c[a];var f=b.apply(this,arguments);this._super=d;return f}}(f,a[f]):a[f];b.prototype=d;b.constructor=b;b.extend=arguments.callee;return b};Function.bind||
(Function.prototype.bind=function(a){var b=this;return function(){return b.apply(a,arguments)}});db.prototype={activate:function(){var a=this.eCMap,b=this.getv3Location(),b=this.gameManager.getGameSpace(b);this.setGameSpace(b);var c,d;for(c in a)a.hasOwnProperty(c)&&(d=a[c],d.activate(),d.setGameSpace(b));this.active=!0;this.addUpdateLists();this.sortECUpdateList();this.safeToManipulate=!0;this.nextTimeToUpdate=0},addECToCustomEntity:function(a){this.archetypeName=null;this.custom=!0;this.eCMap[a.entityComponentName]=
a;a.attach(this);this.sortECUpdateList()},addEC:function(a){this.eCMap[a.entityComponentName]=a;a.attach(this);this.sortECUpdateList();return this},removeECFromCustomEntity:function(a){a=this.eCMap[a];this.archetypeName=null;this.custom=!0;this.eCMap[a.entityComponentName]=null;delete this.eCMap[a.entityComponentName];var b=this.eCUpdateList.indexOf(a);-1!==b&&this.eCUpdateList.splice(b,1);this.removeECFromMoveInterest(a);this.removeECFromAlwaysUpdate(a);this.removeECFromDraw(a)},addECToMoveInterest:function(a){var b=
this.eCMoveInterestList;-1===b.indexOf(a)&&b.push(a)},removeECFromMoveInterest:function(a){var b=this.eCMoveInterestList,a=b.indexOf(a);-1!==a&&b.splice(a,1)},addECToRotateInterest:function(a){var b=this.eCRotateInterestList;-1===b.indexOf(a)&&b.push(a)},removeECFromRotateInterest:function(a){var b=this.eCRotateInterestList,a=b.indexOf(a);-1!==a&&b.splice(a,1)},addECToScaleInterest:function(a){var b=this.eCScaleInterestList;-1===b.indexOf(a)&&b.push(a)},removeECFromScaleInterest:function(a){var b=
this.eCScaleInterestList,a=b.indexOf(a);-1!==a&&b.splice(a,1)},addECToUpdate:function(a){var b=this.eCRemoveFromUpdateList.indexOf(a);-1!==b&&this.eCRemoveFromUpdateList.splice(b,1);this.safeToManipulate?this.addECToUpdateInstant(a):this.addECToUpdateDelayed(a)},addECToUpdateInstant:function(a){var b=this.eCUpdateList;-1===b.indexOf(a)&&(b.push(a),1===b.length&&this.refreshEntityLists(),this.eCUpdateListDirty=!0);this.refreshNextTimeToUpdate(a)},addECToUpdateDelayed:function(a){-1===this.eCAddToUpdateList.indexOf(a)&&
this.eCAddToUpdateList.push(a)},removeECFromUpdate:function(a){var b=this.eCAddToUpdateList.indexOf(a);-1!==b&&this.eCAddToUpdateList.splice(b,1);this.safeToManipulate?this.removeECFromUpdateInstant(a):this.removeECFromUpdateDelayed(a)},removeECFromUpdateInstant:function(a){var b=this.eCUpdateList,a=b.indexOf(a);-1!==a&&(b.splice(a,1),0===b.length&&this.refreshEntityLists())},removeECFromUpdateDelayed:function(a){-1===this.eCRemoveFromUpdateList.indexOf(a)&&this.eCRemoveFromUpdateList.push(a)},addECToAlwaysUpdate:function(a){-1===
this.eCAlwaysUpdateList.indexOf(a)&&(this.eCAlwaysUpdateList.push(a),1===this.eCAlwaysUpdateList.length&&this.refreshEntityLists())},removeECFromAlwaysUpdate:function(a){a=this.eCAlwaysUpdateList.indexOf(a);-1!==a&&(this.eCAlwaysUpdateList.splice(a,1),0===this.eCAlwaysUpdateList.length&&this.refreshEntityLists())},shouldUpdate:function(){return 0<this.eCUpdateList.length},shouldAlwaysUpdate:function(){return 0<this.eCAlwaysUpdateList.length},shouldDraw:function(){return 0<this.eCDrawList.length},
addECToDraw:function(a){var b=this.eCDrawList;-1===b.indexOf(a)&&(b.push(a),1===this.eCDrawList.length&&this.refreshEntityLists())},removeECFromDraw:function(a){var b=this.eCDrawList,a=b.indexOf(a);-1!==a&&(b.splice(a,1),0===this.eCDrawList.length&&this.refreshEntityLists())},getEC:function(a){return this.eCMap[a]},hasEC:function(a){var b=!1;this.eCMap[a]&&(b=!0);return b},sortECUpdateList:function(){this.eCUpdateList.sort(function(a,b){return a.sortPriority-b.sortPriority})},refreshEntityLists:function(){var a=
this.currentGameSpace;a&&a.refreshEntityLists(this);(a=this.getEC("ECGameGridEntity"))&&a.refresh()},addUpdateLists:function(){if(0!==this.eCAddToUpdateList.length){var a=0===this.eCUpdateList.length;this.refreshNextTimeToUpdateFromList(this.eCAddToUpdateList);this.eCUpdateList.push.apply(this.eCUpdateList,this.eCAddToUpdateList);this.eCUpdateListDirty=!0;this.eCAddToUpdateList.length=0;a&&this.refreshEntityLists()}},removeUpdateLists:function(){if(0!==this.eCRemoveFromUpdateList.length){var a,b,
c=this.eCRemoveFromUpdateList,d=c.length,f=this.eCUpdateList;for(a=0;a<d;a+=1)b=c[a],b=f.indexOf(b),-1!==b&&f.splice(b,1);this.eCRemoveFromUpdateList.length=0;0===this.eCUpdateList.length&&this.refreshEntityLists()}},isTimeToUpdate:function(a){return a>this.nextTimeToUpdate},refreshNextTimeToUpdate:function(a){a=a.getTimeForNextUpdate();this.nextTimeToUpdate=0>this.nextTimeToUpdate?a:Math.min(this.nextTimeToUpdate,a)},refreshNextTimeToUpdateFromList:function(a){var b,c=a.length;for(b=0;b<c;b+=1)this.refreshNextTimeToUpdate(a[b])},
manageLargeTimeStep:function(a){var b=this.eCMap,c,d;for(d in b)b.hasOwnProperty(d)&&(c=b[d],c.manageLargeTimeStep(a))},update:function(a,b){this.flagMovedThisFrame();this.flagRotatedThisFrame();this.flagScaledThisFrame();this.updateCurrentGameSpace();var c=this.gameManager.profileECs,d,f,g=this.eCUpdateList,e=g.length;this.safeToManipulate=!1;var i=this.globals.gameCurrentTime;this.nextTimeToUpdate=-1;for(d=0;d<e;d+=1)if(f=g[d],f.isTimeToUpdate(i)||b)c&&ma.start("Update - "+f.entityComponentName),
f.preUpdate(i),a?f.update():f.updateOffScreen(),f.postUpdate(i),this.refreshNextTimeToUpdate(f),c&&ma.stop("Update - "+f.entityComponentName);this.safeToManipulate=!0;this.addUpdateLists();this.removeUpdateLists();this.eCUpdateListDirty&&(this.sortECUpdateList(),this.eCUpdateListDirty=!1);this.gameManager.activeEntityCount+=1;return this.toBeDestroyed},getRadius:function(){var a=0,b=this.getEC("ECPhysicsSphere");b&&(a=b.getRadius());(b=this.getEC("ECPhysicsCube"))&&(a=b.getRadius());return a},getMinRadius:function(){var a=
0,b=this.getEC("ECPhysicsSphere");b&&(a=b.getRadius());(b=this.getEC("ECPhysicsCube"))&&(a=b.getMinRadius());return a},getDistanceUsingSize:function(a){var b=0,c=this.globals.mathDevice;return(b=this.getEC("ECPhysicsSphere"))?(b=b.getRadius(),c.v3Distance(a,this.getv3Location())-b):(b=this.getEC("ECPhysicsCube"))?c.aabbPointDistance(b.getExtents(),a):c.v3Distance(a,this.getv3Location())},getDistanceSqUsingSize:function(a){var b=0,c=this.globals.mathDevice;return(b=this.getEC("ECPhysicsSphere"))?(b=
b.getRadius(),a=c.v3Distance(a,this.getv3Location())-b,a*a):(b=this.getEC("ECPhysicsCube"))?c.aabbPointDistanceSq(b.getExtents(),a):c.v3DistanceSq(a,this.getv3Location())},get2DDistanceUsingSize:function(a){var b=0,c=this.globals.mathDevice;return(b=this.getEC("ECPhysicsSphere"))?(b=b.getRadius(),c.v3Distance2D(a,this.getv3Location())-b):(b=this.getEC("ECPhysicsCube"))?c.aabbPointDistance2D(b.getExtents(),a):c.v3Distance(a,this.getv3Location())},get2DDistanceSqUsingSize:function(a){var b=0,c=this.globals.mathDevice;
return(b=this.getEC("ECPhysicsSphere"))?(b=b.getRadius(),a=c.v3Distance2D(a,this.getv3Location())-b,a*a):(b=this.getEC("ECPhysicsCube"))?c.aabbPointDistance2DSq(b.getExtents(),a):c.v3DistanceSq(a,this.getv3Location())},getAabbExtents:function(a){var b=0,c=this.globals.mathDevice;a||(a=c.aabbBuildEmpty());(b=this.getEC("ECPhysicsSphere"))?(b=b.getRadius(),a=c.aabbBuildFromCentreRadius(this.getv3Location(),b,a)):(b=this.getEC("ECPhysicsCube"))&&(a=c.aabbCopy(b.getExtents(),a));return a},shouldBeDestroyed:function(){return this.toBeDestroyed},
draw:function(){var a=this.eCDrawList,b,c;for(b=a.length-1;0<=b;b-=1)c=a[b],c.draw();0===a.length&&this.refreshEntityLists()},drawDebug:function(a){var b=this.eCMap,c=this.globals.debugDrawFlags,d,f;if(a)for(f in b)b.hasOwnProperty(f)&&a[f]&&(d=b[f],d.drawDebug());else for(f in b)b.hasOwnProperty(f)&&(d=b[f],d.drawDebug());c.entityNames&&this.name&&this.drawWorldText(this.name);c.entitySmartPointers&&this.smartPointer&&this.drawWorldText(""+this.smartPointer.smartPointerIndex,1)},appendToName:function(a){this.name+=
a},teleport:function(a,b,c){var d=this.globals.mathDevice;this.v3Location=d.v3Copy(a,this.v3Location);this.v3LocationPrev=d.v3Copy(this.v3Location,this.v3LocationPrev);this.movedThisFrame=!0;this.onMoved();c&&this.setGameSpace(c);var c=this.eCMap,f;for(f in c)c.hasOwnProperty(f)&&(d=c[f],d.teleport(a,b))},getv3Location:function(){return this.v3Location},getv3Velocity:function(){var a=this.getEC("ECPhysicsSphere");if(a||(a=this.getEC("ECProjectile")))return a.getv3Velocity()},getCentreLocation:function(){this.scratchpad.v3CenterLocation=
this.globals.mathDevice.v3Copy(this.getv3Location(),this.scratchpad.v3CenterLocation);this.scratchpad.v3CenterLocation[1]+=0.25;return this.scratchpad.v3CenterLocation},getv3BottomLocation:function(){var a,b;b=this.globals.mathDevice;(a=this.getEC("ECPhysicsCube"))?b=a.getv3BottomLocation():(a=this.getEC("ECPhysicsSphere"))?(b=b.v3Copy(this.getv3Location()),b[1]-=a.getRadius()):b=b.v3Copy(this.getv3Location());return b},setToBeDestroyed:function(){var a=this.eCMap,b,c;if(!this.toBeDestroyed){this.toBeDestroyed=
!0;for(c in a)a.hasOwnProperty(c)&&(b=a[c],b.onToBeDestroyed());if(a=this.getGameSpace())a.onEntityToBeDestroyed(this);this.setChildrenToBeDestroyed();this.clearSmartPointer()}},setDead:function(){var a=this.eCMap,b,c;if(!this.dead)for(c in this.dead=!0,a)a.hasOwnProperty(c)&&(b=a[c],b.onDeath())},isDead:function(){return this.dead},flagMovedThisFrame:function(){var a=this.globals.mathDevice;if(this.movedThisFrame=!a.v3SafeEqual(this.v3Location,this.v3LocationPrev))this.v3LocationPrev=a.v3Copy(this.v3Location,
this.v3LocationPrev),this.onMoved()},flagRotatedThisFrame:function(){if(this.rotatedThisFrame=this.yAnglePrev!==this.yAngle)this.yAnglePrev=this.yAngle,this.onRotated()},flagScaledThisFrame:function(){if(this.scaledThisFrame=this.scaleAdjusted)this.scaleAdjusted=!1,this.onScaled()},onMoved:function(){var a,b,c=this.eCMoveInterestList;for(a=c.length-1;0<=a;a-=1)b=c[a],b.onMoved()},onRotated:function(){var a,b,c=this.eCRotateInterestList;for(a=c.length-1;0<=a;a-=1)b=c[a],b.onRotated()},onScaled:function(){var a=
this.eCScaleInterestList,b,c;for(b=a.length-1;0<=b;b-=1)c=a[b],c.onScaled()},updateCurrentGameSpace:function(){if(this.movedThisFrame&&!this.ignoreGameSpace){var a=this.gameManager.getGameSpace(this.v3Location);a?(this.insideGameSpace=!0,this.gameManager.requestNewGameSpace(this,a)):this.insideGameSpace=!1}},isInLimbo:function(){return!this.insideGameSpace},getGameSpace:function(){return this.currentGameSpace?this.currentGameSpace:this.gameSpaceOnDestroy},setGameSpace:function(a,b){var c,d=this.eCMap,
f;a&&(this.insideGameSpace=!0);if(a!==this.currentGameSpace){void 0!==this.currentGameSpace&&(this.currentGameSpace.removeGameEntity(this,b),c=!0);this.currentGameSpace=a;void 0!==this.currentGameSpace&&this.currentGameSpace.addGameEntity(this,!c);if(this.active)for(f in d)d.hasOwnProperty(f)&&(c=d[f],c.setGameSpace(a));this.propagateGameSpaceToChildren()}},setGameSpaceDynamic:function(a){this.ignoreGameSpace=!a},serialize:function(a){var b=this.globals.mathDevice;void 0===a[this.name]&&(a=a[this.name]=
{},a.name=this.name,a.archetype=this.archetypeName,a.toBeDestroyed=this.toBeDestroyed,a.v3Location=b.v3Copy(this.v3Location),a.ownedByAPlayer=this.ownedByAPlayer,a.shouldDeltaSerialize=this.shouldDeltaSerialize,this.serializeEntityComponents(a))},serializeDelta:function(a){var b=this.globals.mathDevice;void 0===a[this.name]&&(a=a[this.name]={},a.name=this.name,a.toBeDestroyed=this.toBeDestroyed,a.v3Location=b.v3Copy(this.v3Location),a.ownedByAPlayer=this.ownedByAPlayer,a.shouldDeltaSerialize=this.shouldDeltaSerialize,
this.serializeDeltaEntityComponents(a))},getShouldDeltaSerialize:function(){return this.shouldDeltaSerialize},deserialize:function(a){var b=this.globals.mathDevice;void 0!==a[this.name]&&(a=a[this.name],this.name=a.name,this.toBeDestroyed=a.toBeDestroyed,b.v3Copy(a.v3Location,this.v3Location),this.ownedByAPlayer=a.ownedByAPlayer,this.shouldDeltaSerialize=a.shouldDeltaSerialize,this.deserializeEntityComponents(a))},getCustomArchetype:function(){var a={},b=this.eCMap,c,d;for(c in b)b.hasOwnProperty(c)&&
(d=b[c],d=d.getECParameters(),a[c]=d);a.shouldPlayerSave=this.shouldPlayerSave;a.shouldLevelSave=this.shouldLevelSave;return a},getECSaveData:function(a){var b=this.eCMap,c={},d,f;for(f in b)if(b.hasOwnProperty(f)&&(d=b[f],a&&d.getShouldLevelSaveSerialize()||d.getShouldSaveSerialize()))c[f]=d.saveSerialize(a);return c},deserializeECSaveData:function(a){var b=this.eCMap,c,d,f;for(f in a)a.hasOwnProperty(f)&&(c=b[f],d=a[f],c.deserialize(d))},serializeEntityComponents:function(a){var b=this.eCMap,c,
d=a.eCData={},f;for(f in b)b.hasOwnProperty(f)&&(a=b[f],a.getShouldSerialize()&&(c=d[f]={},a.serializeArchetype(c),a.serialize(c)))},serializeDeltaEntityComponents:function(a){var b=this.eCMap,c,d=a.eCData={},f;for(f in b)b.hasOwnProperty(f)&&(a=b[f],a.getShouldDeltaSerialize()&&(c=d[f]={},a.serializeDelta(c)))},deserializeEntityComponents:function(a){var b=this.eCMap,c,d,f=a.eCData;for(d in f)f.hasOwnProperty(d)&&(a=b[d],c=f[d],void 0!==c&&(void 0===a?(a=F.createFromName(d,this.globals,c.archetype),
a.deserialize(c),this.addEC(a),a.update()):a.deserialize(c)))},shrinkDisappear:function(a){if(!this.shouldBeDestroyed()){this.shouldPlayerSave=this.shouldLevelSave=!1;var b=this.getEC("ECMesh"),c,d=this.gameManager.getEntityFactory(),f,g;if(b&&(c=b.getScale(),f=d.createInactiveEntityInstance("idShrinkDisappearMesh","a_b_shrinkDisappearMesh",this.getv3Location())))f.setRotationY(this.getRotationY()),g=f.getEC("ECMesh"),g.setPath(b.getPath()),g.copyTransform(b),f.activate(),G.Create({scale:c}).to({scale:0},
a).onUpdate(function(){f.shouldBeDestroyed()||g.setScale(this.scale)}).onComplete(function(){f.setToBeDestroyed()}).start();this.setToBeDestroyed()}},shudder:function(a,b,c){if(!this.shouldBeDestroyed()){var d=this,f=this.getEC("ECMesh");if(f&&!this.isSuddering){var g=this.globals.mathDevice;this.isSuddering=!0;var e=g.v3Copy(f.getLocalOffset()),i=g.v3BuildZero();G.Create({scale:0.2*a}).to({scale:0},b).onUpdate(function(){d.shouldBeDestroyed()||(g.v3BuildRandom(this.scale,i),i[1]=Math.max(i[1],0),
f.setLocalOffset(g.v3Add(e,i,i)))}).onComplete(function(){d.shouldBeDestroyed()||(f.setLocalOffset(e),d.isSuddering=!1)}).delay(c).start()}}},setv3Location:function(a){this.globals.mathDevice.v3Copy(a,this.v3Location)},scaleByV3:function(a){var b=this.globals.mathDevice,c=this.getEC("ECMesh"),d=this.getEC("ECPhysicsCube");if(c){var f=c.getV3Scale(),f=b.v3Mul(f,a);c.setV3Scale(f)}d&&(c=d.getv3Scale(),a=b.v3Mul(c,a),d.setV3Scale(a))},getRotationY:function(){return this.yAngle},setRotationY:function(a){this.yAngle=
a},getV3Scale:function(){return this.v3Scale},setV3Scale:function(a){var b=this.globals.mathDevice;b.v3Equal(this.v3ScaleCopy,a)||(this.scaleAdjusted=!0,b.v3Copy(a,this.v3ScaleCopy),b.v3Copy(a,this.v3Scale))},playSound:function(a){if(a){var b=this.gameManager.getGameSoundManager();b&&b.play(a,this.getv3Location(),this)}},stopSound:function(a,b){if(a){var c=this.gameManager.getGameSoundManager();c&&c.stop(a,this,b)}},playEffect:function(a,b){if(a){var c=this.gameManager.getEffectFactory();c&&c.play(a,
this.getv3Location(),this,b?b:this.getv3Velocity())}},stopEffect:function(a,b){if(a){var c=this.gameManager.getEffectFactory();c&&c.stop(a,this,b)}},playPersistentEffect:function(a){return this.gameManager.getEffectFactory().playPersistentEffect(a,null,this)},stopPersistentEffect:function(a){this.gameManager.getEffectFactory().stopPersistentEffect(a)},drawWorldText:function(a,b,c,d,f){var g=this.globals,e=g.mathDevice,i=g.simpleFontRenderer,g=g.camera.worldToScreen(e.v3Add(this.getv3Location(),e.v3Build(0,
1.5,0)));void 0!==g&&(b={x:g[0],y:g[1]+35*(void 0!==b?b:0),pointSize:32,alignment:1,r:void 0!==c?c:1,g:void 0!==d?d:1,b:void 0!==f?f:1},i.drawFontDouble(a,b))},drawProgressBar:function(a,b,c,d,f,g,e,i,j,k){0>b||a>=b?this.drawProgressBarFromFraction(1,c,d,d,f,g,e):this.drawProgressBarFromFraction(a/b,c,d,d,i,j,k)},drawProgressBarFromFraction:function(a,b,c,d,f,g,e){var i=this.globals,j=i.mathDevice,i=i.simpleSpriteRenderer,r=this.getv3Location(),c=0.5*c,d=0.5*d,b=d*(1-0.22*b),l=db.progressBarTexturePath;
j&&i&&(i.addSprite({v3Location:r,sizeX:1.03*c,sizeY:0.11*d,offsetY:b,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:l,v4color:k.outline}),0<a&&i.addSprite({v3Location:r,sizeX:c*a,sizeY:0.08*d,offsetX:-1*c*(1-a),offsetY:b,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:l,v4color:j.v4Build(f,g,e,1)}))},isManagedByThisMachine:function(a){if(this.isOwnedByAPlayer())return this.ownedByThisPlayer;void 0===a&&(a=this.globals.isHost);return a},setOwnedByThisPlayer:function(a){this.ownedByAPlayer=
this.ownedByThisPlayer=a},isOwnedByThisPlayer:function(){return this.ownedByThisPlayer},isOwnedByAPlayer:function(){return this.ownedByAPlayer},getName:function(){return this.name},getArchetypeName:function(){return this.archetypeName},getFamilyName:function(){return this.familyName},destroy:function(){this.gameSpaceOnDestroy=this.currentGameSpace;this.setGameSpace(void 0,!0);var a=this.eCMap,b,c;for(c in a)a.hasOwnProperty(c)&&(b=a[c],b.destroy());this.eCMap=null;this.eCUpdateList&&(this.eCUpdateList.length=
0,this.eCUpdateList=null);this.eCAddToUpdateList.length=0;this.eCRemoveFromUpdateList.length=0;this.eCAlwaysUpdateList.length=0;this.eCDrawList.length=0;this.toBeDestroyed=!0},getAge:function(){return this.globals.gameCurrentTime-this.creationTime},hideMesh:function(){var a=this.getEC("ECMesh");a&&(a.setScale(0),a.disableScaling())},showMesh:function(){var a=this.getEC("ECMesh");a&&(a.enableScaling(),a.setScale(1))},hideSprite:function(){var a=this.getEC("ECSprite");a&&a.setVisible(!1)},showSprite:function(){var a=
this.getEC("ECSprite");a&&a.setVisible(!0)},flashInvulnerable:function(a){var b=this.getEC("ECMesh");b&&(a?b.setScale(Math.floor(4*this.globals.gameCurrentTime)%2):b.setScale(1))},flashDeath:function(a){if(!(3<a)){var b=this.getEC("ECMesh");b&&b.setScale(this.getFlashFactor(a))}},getFlashFactor:function(a){return 3<a?1:Math.floor(a/(1<a?0.25:0.1))%2},createHeldEntity:function(a,b,c,d){var f=this.globals,g=f.mathDevice,e=this.gameManager.getEntityFactory(),i=this.getEC("ECMesh"),j=1;i&&(j=i.getSummedScale(),
0===j&&(j=i.getBaseScale()),0===j&&(j=1));d=e.createCustomEntityInstance(d,"custom_heldentity_"+d,this.getv3Location(),this.isOwnedByThisPlayer());d.addECToCustomEntity(F.createFromName("ECMesh",f,{path:a,scale:c/j,localOffset:g.v3ScalarMul(b,1/j)}));a=F.createFromName("ECAttach",f);a.setParent(this);d.addECToCustomEntity(a);d.activate();return d},addChild:function(a){this.childEntities||(this.childEntities=[]);this.childEntities.push(a);this.propagateGameSpaceToChildren(this.childEntities.length-
1)},removeChild:function(a){this.childEntities&&(a=this.childEntities.indexOf(a),this.childEntities.splice(a,1))},setChildrenToBeDestroyed:function(){if(this.childEntities)for(var a=this.childEntities;a.length;)a[a.length-1].setToBeDestroyed()},applyToChildren:function(a){var b,c=this.childEntities,d;if(c){d=c.length;for(b=0;b<d;b+=1)a(c[b])}},propagateGameSpaceToChildren:function(a){if(this.childEntities){var b,c=this.childEntities,d=c.length,f;b=void 0!==a?a:0;for(a=this.getGameSpace();b<d;b+=1)f=
c[b],f.getGameSpace()!==a?f.setGameSpace(a):(a.shuffleGameEntityToEnd(f),f.propagateGameSpaceToChildren())}},isFriendlyWith:function(a){return this.gameManager.getFactionManager().areFriendly(this,a)},getSmartPointer:function(){this.smartPointer||(this.smartPointer=this.createSmartPointer());return this.smartPointer},createSmartPointer:function(){db.prototype.smartPointerIndex=void 0===db.prototype.smartPointerIndex?0:db.prototype.smartPointerIndex+1;return{entity:this,smartPointerIndex:db.prototype.smartPointerIndex,
get:function(){return this.entity}}},clearSmartPointer:function(){this.smartPointer&&(this.smartPointer.entity=void 0);this.smartPointer=void 0},transferIdentity:function(a){a&&(this.smartPointer=a.smartPointer,a.clearSmartPointer(),this.smartPointer&&(this.smartPointer.entity=this))},setLevelEntityNameMap:function(a){this.levelEntityNameMap=a},clearLevelEntityNameMap:function(){this.levelEntityNameMap=void 0}};db.progressBarTexturePath="textures/block.dds";db.create=function(a,b,c,d,f,g,e){var i=
c.gameManager;void 0===db.prototype.globals&&(db.prototype.globals=c);void 0===db.prototype.gameManager&&(db.prototype.gameManager=i);var j=new db,k=c.mathDevice;j.toBeDestroyed=!1;j.active=!1;j.eCMap={};j.eCUpdateList=[];j.eCAddToUpdateList=[];j.eCRemoveFromUpdateList=[];j.eCAlwaysUpdateList=[];j.eCDrawList=[];j.eCMoveInterestList=[];j.eCRotateInterestList=[];j.eCScaleInterestList=[];j.v3Location=void 0!==d?k.v3Copy(d):k.v3Build(0,0,0);j.yAngle=void 0!==e?e:0;j.v3Scale=k.v3Build(1,1,1);j.v3ScaleCopy=
k.v3Build(1,1,1);j.insideGameSpace=!1;j.shouldDeltaSerialize=!0;j.isGameEntity=!0;j.creationTime=c.gameCurrentTime;j.shouldPlayerSave=g?!0:!1;j.shouldLevelSave=f?!0:!1;j.familyName=void 0!==b?b:"no family";j.archetypeName=null;j.custom=!1;j.safeToManipulate=!1;j.scratchpad={};j.name=i.uniqueifyString(a);j.setGameSpaceDynamic(!1);return j};sf.prototype={createProjectile:function(a,b,c,d){var f=this.globals,g=f.mathDevice,d=f.gameManager.getEntityFactory().createActiveEntityInstance(d,d,b),f=d.getEC("ECProjectile");
f.setV3Direction(g.v3Sub(c,b));f.setOwner(a);return d}};sf.create=function(a,b){var c=new sf;c.globals=a;c.gameManager=b;return c};var F=fd.extend({entityComponentName:"ECBase",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldAlwaysUpdate:!1,shouldDraw:!0,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,shouldLevelSave:!1,realTime:!1,interestedInMovement:!1,storeGlobalList:!1,eCCreationMap:[],init:function(a,b){void 0===F.prototype.globals&&(F.prototype.globals=a,F.prototype.globalnumberAlive=
{},F.prototype.globalrationedCounters={},F.prototype.globalActiveEntityList={});this.entity=null;this.dirtyDeserialized=!1;this.archetype=b;this.rationedCounterTracker={};this.nextTimeToUpdate=0;this.hasUpdated=!1;this.lastUpdateTime=this.timeSinceLastUpdate=0},addToGlobalActiveEntityList:function(){void 0===this.globalActiveEntityList[this.getName()]&&(this.globalActiveEntityList[this.getName()]=[]);0>this.globalActiveEntityList[this.getName()].indexOf(this.entity)&&this.globalActiveEntityList[this.getName()].push(this.entity)},
removeFromGlobalActiveEntityList:function(){var a;void 0===this.globalActiveEntityList[this.getName()]&&(this.globalActiveEntityList[this.getName()]=[]);a=this.globalActiveEntityList[this.getName()].indexOf(this.entity);0<=a&&this.globalActiveEntityList[this.getName()].splice(a,1)},getAllActiveEntitiesWithEC:function(){return this.globalActiveEntityList[this.getName()]},adjustGlobalECCount:function(a){void 0===this.globalnumberAlive[this.getName()]&&(this.globalnumberAlive[this.getName()]=0,this.globalrationedCounters[this.getName()]=
{});this.globalnumberAlive[this.getName()]+=a},getGlobalECCount:function(){return this.globalnumberAlive[this.getName()]},getRationedCounter:function(){return this.globalrationedCounters[this.getName()]},canDoRationedAction:function(a){var b=this.gameManager.gameClock.getFrameIndex(),c=this.getRationedCounter(),d=!1;if(this.rationedCounterTracker[a]>b)return!1;void 0===c[a]&&(c[a]=b,d=!0);c[a]<b&&(d=!0);return d?(c[a]=b,this.rationedCounterTracker[a]=b+this.getGlobalECCount(),!0):!1},getName:function(){return this.entityComponentName},
getArchetypeName:function(){return this.entity.getArchetypeName()},attach:function(a){this.entity=a;void 0===F.prototype.gameManager&&(F.prototype.gameManager=a.gameManager)},activate:function(){this.shouldAlwaysUpdate&&this.setToAlwaysUpdate(!0);this.shouldUpdate&&this.setToUpdate(!0);this.shouldDraw&&this.setToDraw(!0);this.storeGlobalList&&this.addToGlobalActiveEntityList();this.adjustGlobalECCount(1);var a=this.globals.gameCurrentTime;this.nextTimeToUpdate=a+Math.random()*this.updatePeriod;this.lastUpdateTime=
a},setUpdatePeriod:function(a){this.updatePeriod=a;this.entity&&(this.nextTimeToUpdate=this.globals.gameCurrentTime+this.updatePeriod,this.entity.refreshNextTimeToUpdate(this))},isActive:function(){return this.entity&&this.entity.active},getInterestedInMovement:function(){return this.interestedInMovement},setInterestedInMovement:function(a){this.interestedInMovement!==a&&((this.interestedInMovement=a)?this.entity.addECToMoveInterest(this):this.entity.removeECFromMoveInterest(this))},setInterestedInRotation:function(a){this.interestedInRotation!==
a&&((this.interestedInRotation=a)?this.entity.addECToRotateInterest(this):this.entity.removeECFromRotateInterest(this))},setInterestedInScaling:function(a){this.interestedInScaling!==a&&((this.interestedInScaling=a)?this.entity.addECToScaleInterest(this):this.entity.removeECFromScaleInterest(this))},setToUpdate:function(a){this.toUpdate!==a&&((this.toUpdate=a)?(this.entity.addECToUpdate(this),this.toAlwaysUpdate&&this.entity.addECToAlwaysUpdate(this),a=this.globals.gameCurrentTime,this.nextTimeToUpdate=
a+Math.random()*this.updatePeriod,this.lastUpdateTime=a):(this.entity.removeECFromUpdate(this),this.entity.removeECFromAlwaysUpdate(this)))},setToAlwaysUpdate:function(a){this.toAlwaysUpdate!==a&&((this.toAlwaysUpdate=a)&&this.toUpdate?this.entity.addECToAlwaysUpdate(this):this.entity.removeECFromAlwaysUpdate(this))},isTimeToUpdate:function(a){return!this.hasUpdated||a>this.nextTimeToUpdate},preUpdate:function(a){this.timeSinceLastUpdate=a-this.lastUpdateTime},getTimeSinceLastUpdate:function(){return this.timeSinceLastUpdate},
getTimeForNextUpdate:function(){return this.nextTimeToUpdate},postUpdate:function(a){this.hasUpdated&&(this.nextTimeToUpdate=a+this.updatePeriod);this.dirtyDeserialized=!1;this.hasUpdated=!0;this.lastUpdateTime=a},update:function(){},updateOffScreen:function(){this.update()},setToDraw:function(a){this.toDraw!==a&&((this.toDraw=a)?this.entity.addECToDraw(this):this.entity.removeECFromDraw(this))},draw:function(){},drawDebug:function(){this.globals.debugDraw.drawDebugPoint(this.entity.v3Location,0,
0,1)},teleport:function(){},getv3Location:function(){return this.entity.v3Location},getRotationY:function(){return this.entity.yAngle},getEntityEC:function(a){return this.entity.getEC(a)},entityHasEC:function(a){var b=!1;this.entity&&this.entity.hasEC(a)&&(b=!0);return b},autoSaveLevel:function(){this.globals.gameManager.autoSaveLevel()},setShouldSerialize:function(a){this.shouldSerialize=a},setShouldDeltaSerialize:function(a){this.shouldDeltaSerialize=a},setShouldSaveSerialize:function(a){this.shouldSave=
a},getShouldSaveSerialize:function(){return this.shouldSave},getShouldLevelSaveSerialize:function(){return this.shouldLevelSave},getShouldSerialize:function(){return this.shouldSerialize},getShouldDeltaSerialize:function(){return this.shouldDeltaSerialize},serializeArchetype:function(a){a.archetype=this.archetype},getECParameters:function(){return this.archetype},serialize:function(){},serializeDelta:function(a){this.serialize(a)},deserialize:function(a){this.dirtyDeserialized=!0;var b,c;for(b in a)a.hasOwnProperty(b)&&
((c=a[b])&&c.isGameEntity&&(c=c.isSmartPointer?this.unpackSmartPointer(c):this.unpackGameEntity(c)),c&&c.isGameEntityList&&(c=this.unpackEntityList(c)),this[b]=c)},packGameEntity:function(a){return!a?void 0:{isGameEntity:!0,entityName:a.getName()}},unpackGameEntity:function(a){var b=null;a&&(b=this.entity.levelEntityNameMap?this.entity.levelEntityNameMap[a.entityName]:this.gameManager.getGameEntityByName(a.entityName));return b},packSmartPointer:function(a){if(a=this.packGameEntity(a.get()))a.isSmartPointer=
!0;return a},unpackSmartPointer:function(a){a=this.unpackGameEntity(a);return!a?void 0:a.getSmartPointer()},packEntityList:function(a){var b=[],c=a.length,d,f;for(f=0;f<c;f+=1)d=a[f],d=this.packGameEntity(d),b.push(d);return{isGameEntityList:!0,packedList:b}},unpackEntityList:function(a){var a=a.packedList,b=[],c;for(c=0;c<a.length;c+=1){var d=this.unpackGameEntity(a[c]);d&&(b.push(d),a.splice(c,1),c-=1)}return b},getTimeAdjustedBlendFactor:function(a){return 1-Math.pow(1-a,30*this.globals.gameTimeStep)},
saveSerialize:function(){},manageLargeTimeStep:function(){},onToBeDestroyed:function(){this.storeGlobalList&&this.removeFromGlobalActiveEntityList()},onDeath:function(){},destroy:function(){this.adjustGlobalECCount(-1)},safeCopy:function(a,b){return void 0!==a?a:b},v3SafeCopy:function(a,b){return void 0===a?b:b=this.globals.mathDevice.v3Copy(a,b)},setGameSpace:function(){},buildTwoNumberHash:function(a,b){return 1E3*a+b},buildIDArray:function(a,b){var c,d;if(b){d=[b.length];for(c=0;c<b.length;c+=
1)d[c]=this.buildTwoNumberHash(a,b[c]);return d}},arrayContains:function(a,b){return void 0===a?!1:-1<a.indexOf(b)},numberToCommaString:function(a){return this.globals.simpleFontRenderer.numberToCommaString(a)},formatTimeToString:function(a,b){var c=Math.floor(a/3600),d=Math.floor(a/60)-60*c,f=Math.floor(a%60),g="";0<c&&(g=g+c+(b?1<c?" hrs ":" hr ":"h"));0<d&&(g=g+d+(b?1<d?" mins ":" min ":"m"));if(0<f||!c&&!d)g=g+f+(b?1<f?" secs ":" sec ":"s");return g},playSound:function(a){this.entity.playSound(a)},
stopSound:function(a,b){this.entity.stopSound(a,b)},playEffect:function(a,b){this.entity.playEffect(a,b)},stopEffect:function(a,b){this.entity.stopEffect(a,b)},playPersistentEffect:function(a){return this.entity.playPersistentEffect(a)},stopPersistentEffect:function(a){this.entity.stopPersistentEffect(a)},drawStunned:function(){var a=this.globals.simpleSpriteRenderer,b=this.globals,c=b.mathDevice,b=b.gameCurrentTime,d=2*Math.PI/3,f=this.entity.getRadius(),g=c.v3Copy(this.getv3Location());g[1]+=3*
f;var e,i,j,k;for(i=0;3>i;i+=1)j=i*d+6*b,k=c.angleToV3(j),e=c.v3AddScalarMul(g,k,1.25*f,e),e[1]+=0.25*Math.sin(8*(b+d*i)),j={v3Location:e,size:0.125*(1+0.125*Math.sin(4*(b+j))),texture:"textures/star.dds",v4color:c.v4Build(245/255,215/255,86/255,1),angle:3*j,out:k},a.addSprite(j)},getParentAge:function(){return this.entity.getAge()},isManagedByThisMachine:function(){return this.entity.isManagedByThisMachine(this.globals.isHost)}});F.createFromName=function(a,b,c){var d=F.prototype.eCCreationMap[a],
c=F.completeParameters(a,c);return d.create(b,c)};F.getECClass=function(a){return F.prototype.eCCreationMap[a]};F.forEachECClass=function(a){var b,c,d=F.prototype.eCCreationMap;for(b in d)d.hasOwnProperty(b)&&(c=d[b],a(c))};F.getECPrototype=function(a){return F.prototype.eCCreationMap[a].prototype};F.getECParameters=function(a){return F.prototype.eCCreationMap[a].prototype.parameters};F.completeParameters=function(a,b){void 0===b&&(b={});if(b.entityComponentParametersCompleted)return b;var c=F.getECParameters(a),
d,f;for(d in c)c.hasOwnProperty(d)&&(f=c[d],f=f instanceof Array?f.slice():"object"===typeof f?f.defaultValue:f,void 0!==f&&void 0===b[d]&&(b[d]=f));b.entityComponentParametersCompleted=!0;return b};F.getEntitiesWithEC=function(a){var b;F.prototype.globalActiveEntityList&&(b=F.prototype.globalActiveEntityList[a]);b||(b=[]);return b};F.create=function(a,b){return new F(a,b)};tf.prototype={addEntity:function(a){var b=this.resourceDestinations,c=this.healthRegenerators,d=this.buildings,f=this.traps,
g=this.towers,e=this.walls,i=this.stores,j=this.outposts;this.entityList.push(a);a.hasEC("ECGameCritical")&&(this.hq=a);a.hasEC("ECResourceDestination")&&b.push(a);a.hasEC("ECHealthRegenerator")&&c.push(a);a.hasEC("ECResourceStorage")&&i.push(a);if(b=a.getEC("ECBuilding"))"Trap"===b.getBuildingType()?f.push(a):(d.push(a),"Tower"===b.getBuildingType()?g.push(a):"Wall"===b.getBuildingType()?e.push(a):"Outpost"===b.getBuildingType()&&j.push(a));a.hasEC("ECAgent")&&(this.agentRefCount+=1)},removeEntity:function(a){var b=
this.entityList,c=b.length,d,f=this.resourceDestinations,g=this.healthRegenerators,e=this.buildings,i=this.traps,j=this.towers,k=this.walls,l=this.stores,m=this.outposts;this.hq===a&&(this.hq=null);a.hasEC("ECAgent")&&(this.agentRefCount-=1);a.hasEC("ECResourceDestination")&&(d=f.indexOf(a),0<=d&&f.splice(d,1));a.hasEC("ECHealthRegenerator")&&(d=f.indexOf(a),0<=d&&g.splice(d,1));a.hasEC("ECResourceStorage")&&(d=l.indexOf(a),0<=d&&l.splice(d,1));if(f=a.getEC("ECBuilding"))d=e.indexOf(a),0<=d&&e.splice(d,
1),"Trap"===f.getBuildingType()?(d=i.indexOf(a),0<=d&&i.splice(d,1)):(d=e.indexOf(a),0<=d&&e.splice(d,1),"Tower"===f.getBuildingType()?(d=j.indexOf(a),0<=d&&j.splice(d,1)):"Wall"===f.getBuildingType()?(d=k.indexOf(a),0<=d&&k.splice(d,1)):"Outpost"===f.getBuildingType()&&(d=m.indexOf(a),0<=d&&m.splice(d,1)));for(d=0;d<c;d+=1)if(b[d]===a){b.splice(d,1);break}},hasEntity:function(a){var b=this.entityList,c=b.length,d;for(d=0;d<c;d+=1)if(b[d]===a)return!0;return!1},getEntityList:function(){return this.entityList},
getResourceDestinations:function(){return this.resourceDestinations},getHealthRegenerators:function(){return this.healthRegenerators},getBuildings:function(){return this.buildings},getTraps:function(){return this.traps},getTowers:function(){return this.towers},getWalls:function(){return this.walls},getStores:function(){return this.stores},getOutposts:function(){return this.outposts},getAgentRefCount:function(){return this.agentRefCount},isFriendlyWith:function(a){var b=this.friendlyFactions,c=a.getName();
return a===this||-1!==b.indexOf(c)?!0:!1},getName:function(){return this.name},getHQ:function(){return this.hq}};tf.create=function(a){var b=new tf;b.name=a;b.entityList=[];b.friendlyFactions=[];b.hq=null;b.resourceDestinations=[];b.healthRegenerators=[];b.buildings=[];b.traps=[];b.towers=[];b.walls=[];b.stores=[];b.outposts=[];b.agentRefCount=0;return b};uf.prototype={createNewFaction:function(a){var b=this.factions,a=tf.create(a);b.push(a)},addEntityToFaction:function(a,b){this.getFactionByName(b).addEntity(a)},
removeEntityFromFaction:function(a,b){this.getFactionByName(b).removeEntity(a)},getFactionEntityList:function(a){return this.getFactionByName(a).getEntityList()},setHeroFactionName:function(a){this.heroFactionName=a},setEnemyFactionName:function(a){this.enemyFactionName=a},getHeroFactionName:function(){return this.heroFactionName},getEnemyFactionName:function(){return this.enemyFactionName},getNearestAlly:function(a,b,c){return this.getEntityOfAllegiance(a,!0,!0,b,c)},getFarthestAlly:function(a,b,
c){return this.getEntityOfAllegiance(a,!1,!0,b,c)},getNearestEnemy:function(a,b,c){return this.getEntityOfAllegiance(a,!0,!1,b,c)},getFarthestEnemy:function(a,b,c){return this.getEntityOfAllegiance(a,!1,!1,b,c)},areEnemies:function(a,b){return!this.areFriendly(a,b)},applyToAllies:function(a,b){var c=a.getEC("ECFaction").getFactionName(),c=this.getEntityListOfAllegiance(c,!0),d=c.length,f;for(f=0;f<d;f+=1)b(c[f])},applyToEnemies:function(a,b){var c=a.getEC("ECFaction").getFactionName(),c=this.getEntityListOfAllegiance(c,
!1),d=c.length,f;for(f=0;f<d;f+=1)b(c[f])},getNearestFriendlyHQ:function(a){var b=a.getEC("ECFaction").getFactionName(),b=this.getFactionByName(b),c=this.factions,d=c.length,f=Number.MAX_VALUE,g=this.globals.mathDevice,e,i,j,k;for(i=0;i<d;i+=1)if(e=c[i],e.isFriendlyWith(b)&&(e=e.getHQ()))j=g.v3LengthSq(g.v3Sub(a.getv3Location(),e.getv3Location())),j<f&&(f=j,k=e);return k},getNearestEnemyHQ:function(a){var b=a.getEC("ECFaction").getFactionName(),b=this.getFactionByName(b),c=this.factions,d=c.length,
f=Number.MAX_VALUE,g=this.globals.mathDevice,e,i,j,k,l;for(i=0;i<d;i+=1)if(e=c[i],!e.isFriendlyWith(b)&&(e=e.getHQ())&&!e.toBeDestroyed)if(j=g.v3LengthSq(g.v3Sub(a.getv3Location(),e.getv3Location())),j<f&&(l=e.getEC("ECTarget"))&&l.isValidTarget())f=j,k=e;return k},getNearestEnemyBuilding:function(a){var b=a.getEC("ECFaction").getFactionName(),b=this.getFactionByName(b),c=this.factions,d=c.length,f=Number.MAX_VALUE,g=this.globals.mathDevice,e,i,j,k,l,m,q=null,p;for(i=0;i<d;i+=1)if(e=c[i],!e.isFriendlyWith(b)){e=
e.getBuildings();k=e.length;for(j=0;j<k;j+=1)if((l=e[j])&&!l.toBeDestroyed)if(m=g.v3LengthSq(g.v3Sub(a.getv3Location(),l.getv3Location())),m<f&&(p=l.getEC("ECTarget"))&&p.isValidTarget())f=m,q=l}return q},getNearestFriendlyResourceDestination:function(a,b){var c=a.getEC("ECFaction").getFactionName(),c=this.getFactionByName(c),d=this.factions,f=d.length,g=Number.MAX_VALUE,e=this.globals.mathDevice,i,j,k,l,m,q,p,s;for(j=0;j<f;j+=1)if(i=d[j],i.isFriendlyWith(c)){i=i.getResourceDestinations();l=i.length;
for(k=0;k<l;k+=1)if(m=i[k])if(q=m.getEC("ECResourceDestination"),q.canDepositResource(b)&&(q=e.v3LengthSq(e.v3Sub(a.getv3Location(),m.getv3Location())),q<g&&(s=m.getEC("ECTarget"))&&s.isValidTarget()))g=q,p=m}return p},getNearestFriendlyOutpost:function(a){var b=a.getEC("ECFaction").getFactionName(),b=this.getFactionByName(b),c=this.factions,d=c.length,f=Number.MAX_VALUE,g=this.globals.mathDevice,e,i,j,k,l,m,q=null,p;for(i=0;i<d;i+=1)if(e=c[i],e.isFriendlyWith(b)){e=e.getOutposts();k=e.length;for(j=
0;j<k;j+=1)if(l=e[j])if(m=g.v3LengthSq(g.v3Sub(a.getv3Location(),l.getv3Location())),m<f&&(p=l.getEC("ECTarget"))&&p.isValidTarget())f=m,q=l}return q},getNearestEnemyTower:function(a){var b=a.getEC("ECFaction").getFactionName(),b=this.getFactionByName(b),c=this.factions,d=c.length,f=Number.MAX_VALUE,g=this.globals.mathDevice,e,i,j,k,l,m,q=null,p;for(i=0;i<d;i+=1)if(e=c[i],!e.isFriendlyWith(b)){e=e.getTowers();k=e.length;for(j=0;j<k;j+=1)if((l=e[j])&&!l.toBeDestroyed)if(m=g.v3LengthSq(g.v3Sub(a.getv3Location(),
l.getv3Location())),m<f&&(p=l.getEC("ECTarget"))&&p.isValidTarget())f=m,q=l}return q},getNearestEnemyWall:function(a){var b=a.getEC("ECFaction").getFactionName(),b=this.getFactionByName(b),c=this.factions,d=c.length,f=Number.MAX_VALUE,g=this.globals.mathDevice,e,i,j,k,l,m,q=null,p;for(i=0;i<d;i+=1)if(e=c[i],!e.isFriendlyWith(b)){e=e.getWalls();k=e.length;for(j=0;j<k;j+=1)if((l=e[j])&&!l.toBeDestroyed)if(m=g.v3LengthSq(g.v3Sub(a.getv3Location(),l.getv3Location())),m<f&&(p=l.getEC("ECTarget"))&&p.isValidTarget())f=
m,q=l}return q},getNearestEnemyStore:function(a){var b=a.getEC("ECFaction").getFactionName(),b=this.getFactionByName(b),c=this.factions,d=c.length,f=Number.MAX_VALUE,g=this.globals.mathDevice,e,i,j,k,l,m,q=null,p;for(i=0;i<d;i+=1)if(e=c[i],!e.isFriendlyWith(b)){e=e.getStores();k=e.length;for(j=0;j<k;j+=1)if((l=e[j])&&!l.toBeDestroyed)if(m=g.v3LengthSq(g.v3Sub(a.getv3Location(),l.getv3Location())),m<f&&(p=l.getEC("ECTarget"))&&p.isValidTarget())f=m,q=l}return q},getNearestEnemyOutpost:function(a){var b=
a.getEC("ECFaction").getFactionName(),b=this.getFactionByName(b),c=this.factions,d=c.length,f=Number.MAX_VALUE,g=this.globals.mathDevice,e,i,j,k,l,m,q=null,p;for(i=0;i<d;i+=1)if(e=c[i],!e.isFriendlyWith(b)){e=e.getOutposts();k=e.length;for(j=0;j<k;j+=1)if((l=e[j])&&!l.toBeDestroyed)if(m=g.v3LengthSq(g.v3Sub(a.getv3Location(),l.getv3Location())),m<f&&(p=l.getEC("ECTarget"))&&p.isValidTarget())f=m,q=l}return q},getNearestEnemyNonHero:function(a){var b=a.getEC("ECFaction").getFactionName(),b=this.getFactionByName(b),
c=this.factions,d=c.length,f=Number.MAX_VALUE,g=this.globals.mathDevice,e,i,j,k,l,m,q=null,p;for(i=0;i<d;i+=1)if(e=c[i],!e.isFriendlyWith(b)){e=e.getEntityList();k=e.length;for(j=0;j<k;j+=1)if((l=e[j])&&!l.toBeDestroyed&&!l.hasEC("ECHero"))if(m=g.v3LengthSq(g.v3Sub(a.getv3Location(),l.getv3Location())),m<f&&(p=l.getEC("ECTarget"))&&p.isValidTarget())f=m,q=l}return q},reset:function(){this.factions=[];this.setHeroFactionName("heroFaction");this.setEnemyFactionName("enemyFaction");this.createNewFaction("heroFaction");
this.createNewFaction("enemyFaction")},getEntityOfAllegiance:function(a,b,c,d,f){var g=a.getEC("ECFaction").getFactionName(),c=this.getEntityListOfAllegiance(g,c);return b?void 0!==d||void 0!==f?this.getNearestEntityWithinRanges(c,a,d,f):this.getNearestEntity(c,a):void 0!==d||void 0!==f?this.getFarthestEntityWithinRanges(c,a,d,f):this.getFarthestEntity(c,a)},areFriendly:function(a,b,c,d){if(a.shouldBeDestroyed()&&!c||b.shouldBeDestroyed()&&!d)return!1;c||(a=a.getEC("ECFaction"))&&(c=a.getFactionName());
d||(b=b.getEC("ECFaction"))&&(d=b.getFactionName());if(!c||!d)return!1;b=this.getFactionByName(c);c=this.getFactionByName(d);return b.isFriendlyWith(c)},getEntityListOfAllegiance:function(a,b){var c=this.getFactionByName(a),d=this.factions,f=d.length,g=[],e,i;for(i=0;i<f;i+=1)e=d[i],c.isFriendlyWith(e)===b&&g.push.apply(g,e.getEntityList());return g},getNearestEntityWithinRanges:function(a,b,c,d){var f=this.globals.mathDevice,g=b.getv3Location(),e=a.length,d=void 0!==d?d*d:Number.MAX_VALUE,c=void 0!==
c?c*c:0,i,j,k,l,m;for(l=0;l<e;l+=1)if((k=a[l])&&!k.toBeDestroyed&&k!==b)if(i=f.v3DistanceSq(k.v3Location,g),i>c&&i<d&&(m=k.getEC("ECTarget"))&&m.isValidTarget())j=k,d=i;return j},getFarthestEntityWithinRanges:function(a,b,c,d){var f=this.globals.mathDevice,g=b.getv3Location(),e=a.length,d=void 0!==d?d*d:Number.MAX_VALUE,c=void 0!==c?c*c:0,i,j,k,l,m;for(l=0;l<e;l+=1)if((k=a[l])&&!k.toBeDestroyed&&k!==b)if(i=f.v3DistanceSq(k.v3Location,g),i<d&&i>c&&(m=k.getEC("ECTarget"))&&m.isValidTarget())j=k,c=i;
return j},getNearestEntity:function(a,b){var c=this.globals.mathDevice,d=b.getv3Location(),f=a.length,g=Number.MAX_VALUE,e,i,j,k,l;for(k=0;k<f;k+=1)if((j=a[k])&&!j.toBeDestroyed&&j!==b)if(e=c.v3DistanceSq(j.v3Location,d),e<g&&(l=j.getEC("ECTarget"))&&l.isValidTarget())i=j,g=e;return i},getFarthestEntity:function(a,b){var c=this.globals.mathDevice,d=b.getv3Location(),f=a.length,g=0,e,i,j,k,l;for(k=0;k<f;k+=1)if((j=a[k])&&!j.toBeDestroyed&&j!==b)if(e=c.v3DistanceSq(j.v3Location,d),e>g&&(l=j.getEC("ECTarget"))&&
l.isValidTarget())i=j,g=e;return i},getFactionByName:function(a){var b=this.factions,c=b.length,d,f;for(f=0;f<c;f+=1)if(d=b[f],d.getName()===a)return d;return null},hasFaction:function(a){return this.factions.hasOwnProperty(a)}};uf.create=function(a){var b=new uf;b.globals=a;b.factions=[];b.reset();return b};vf.prototype={initialise:function(){this.buildings.length=0;this.buildingCaps={};this.buildingCount={};this.defenceRating=0;this.capDispensers.length=0;this.buildingsWithUpgradableCaps.length=
0;this.scaffolds={};this.upgraders={};this.numScaffoldsForCap={};this.scaffoldCap={}},buildingAdded:function(a){var b=this.getBuildings(),c=this.getBuildingsWithUpgradableCaps();a&&b&&0>b.indexOf(a)&&(b.push(a),a.hasUpgradableGlobalCaps()&&0>c.indexOf(a)&&c.push(a),this.globals.gameManager.eventManager.notify("BuildingAdded",{building:a}),this.defenceRating+=a.getDefenceLevel(),this.adjustScaffoldCap(a.getScaffoldCapType(),a.getScaffoldCap()),this.adjustGlobalCaps(a.getGlobalCaps(),1),this.adjustBuildingCount(a.getBuildingType(),
1),this.triggerBuildingChangedEvent(),this.autoSaveLevel())},buildingRemoved:function(a){var b=this.getBuildings(),c,d=this.getBuildingsWithUpgradableCaps();a&&b&&(c=b.indexOf(a),0<=c&&(b.splice(c,1),this.defenceRating-=a.getDefenceLevel(),this.adjustScaffoldCap(a.getScaffoldCapType(),-a.getScaffoldCap()),this.adjustGlobalCaps(a.getGlobalCaps(),-1),this.adjustBuildingCount(a.getBuildingType(),-1),this.triggerBuildingChangedEvent(),this.autoSaveLevel()),a=d.indexOf(a),0<=a&&d.splice(a,1))},capDispenserAdded:function(a){var b=
this.getCapDispensers();a&&b&&0>b.indexOf(a)&&b.push(a)},capDispenserRemoved:function(a){var b=this.getCapDispensers();a&&b&&(a=b.indexOf(a),0<=a&&b.splice(a,1))},adjustScaffoldCap:function(a,b){b&&(this.scaffoldCap[a]||(this.scaffoldCap[a]=0),this.scaffoldCap[a]+=b)},scaffoldAdded:function(a,b){if(a){var c=a.getScaffoldType(),d=this.getScaffolds(c);d&&0>d.indexOf(a)&&(d.push(a),b&&(void 0===this.numScaffoldsForCap[c]&&(this.numScaffoldsForCap[c]=0),this.numScaffoldsForCap[c]+=1),this.triggerBuildingChangedEvent(),
this.autoSaveLevel())}},scaffoldRemoved:function(a,b){if(a){var c=a.getScaffoldType(),d=this.getScaffolds(c),f;a&&d&&(f=d.indexOf(a),0<=f&&(d.splice(f,1),b&&(this.numScaffoldsForCap[c]-=1),this.triggerBuildingChangedEvent(),this.autoSaveLevel()))}},upgraderAdded:function(a,b){if(a){var c=a.getScaffoldType(),d=this.getUpgraders(c);d&&0>d.indexOf(a)&&(d.push(a),b&&(void 0===this.numScaffoldsForCap[c]&&(this.numScaffoldsForCap[c]=0),this.numScaffoldsForCap[c]+=1),this.triggerBuildingChangedEvent(),this.autoSaveLevel())}},
upgraderRemoved:function(a,b){if(a){var c=a.getScaffoldType(),d=this.getUpgraders(c),f;a&&d&&(f=d.indexOf(a),0<=f&&(d.splice(f,1),b&&(this.numScaffoldsForCap[c]-=1),this.triggerBuildingChangedEvent(),this.autoSaveLevel()))}},triggerBuildingChangedEvent:function(){var a=this.globals.gameManager.eventManager;a&&a.notify("BuildingChanged")},autoSaveLevel:function(){this.globals.gameManager.autoSaveLevel()},getDefenceRating:function(){return this.defenceRating},getDefenceLevel:function(){var a=this.getDefenceRating(),
b=this.defenceRatingMappingTable,c=b.length,d;for(d=0;d<c&&!(a<=b[d]);d+=1);return d},getScaffolds:function(a){this.scaffolds[a]||(this.scaffolds[a]=[]);return this.scaffolds[a]},getNumScaffolds:function(a){return(a=this.getScaffolds(a))?a.length:0},getUpgraders:function(a){this.upgraders[a]||(this.upgraders[a]=[]);return this.upgraders[a]},getNumUpgraders:function(a){return(a=this.getUpgraders(a))?a.length:0},getNumScaffoldsForCap:function(a){return this.numScaffoldsForCap[a]},getScaffoldCap:function(a){return Math.max(this.scaffoldCap[a],
1)},hasReachedScaffoldCap:function(a){return this.getNumScaffoldsForCap(a)>=this.getScaffoldCap(a)},adjustGlobalCaps:function(a,b){if(a){var c=a.length,d,f;for(d=0;d<c;d+=1)f=a[d],this.adjustGlobalBuildingCap(f.buildingType,f.quantity*b)}},adjustGlobalBuildingCap:function(a,b){void 0===this.buildingCaps[a]&&(this.buildingCaps[a]=0);this.buildingCaps[a]+=b},getGlobalBuildingCap:function(a){return this.buildingCaps[a]},adjustBuildingCount:function(a,b){void 0===this.buildingCount[a]&&(this.buildingCount[a]=
0);this.buildingCount[a]+=b},getBuildingCount:function(a){return this.buildingCount[a]?this.buildingCount[a]:0},getBuildingCountUsingParent:function(a,b){var c;if(b&&(c=b.getEC("ECPlacedBuildingTracker"))&&c.getLocalBuildingCap(a))if(c=c.getBuildingCount(a),void 0!==c)return c;return this.getBuildingCount(a)},getBuildingCapUsingParent:function(a,b){var c,d;if(Oi[a])return 0;b&&(c=b.getEC("ECPlacedBuildingTracker"))&&(d=c.getLocalBuildingCap(a));void 0===d&&(d=0);c=this.getGlobalBuildingCap(a);void 0===
c&&(c=0);return d+c},hasReachedBuildingCap:function(a,b){return""===a?!1:0>=this.getRemainingBuildingsBeforeCap(a,b)},getRemainingBuildingsBeforeCap:function(a,b){if(""===a)return 0;var c=this.getBuildingCountUsingParent(a,b),d=this.getBuildingCapUsingParent(a,b);return Math.max(0,d-c)},getBuildingToUpgradeToIncreaseBuildingCap:function(a,b){var c=this.buildingsWithUpgradableCaps,d,f,g,e,i=null;if(b&&!b.shouldBeDestroyed()&&(d=b.getEC("ECPlacedBuildingTracker")))e=d.getMinLevelToIncreaseLocalCapForBuildingType(a),
void 0!==e&&(i=b.getEC("ECBuilding"));if(!i&&c){d=c.length;for(f=0;f<d;f+=1)if(g=c[f])if(e=g.getMinLevelToIncreaseGlobalCapForBuildingType(a),void 0!==e){i=g;break}}return i?{name:i.getBuildingName(),level:e}:null},getBuildings:function(){return this.buildings},getCapDispensers:function(){return this.capDispensers},getBuildingsWithUpgradableCaps:function(){return this.buildingsWithUpgradableCaps},getBuildingByType:function(a,b){for(var c=0;c<this.buildings.length;c+=1)if(this.buildings[c].getBuildingType()===
a&&!(void 0!==b&&this.buildings[c].getLevel()!==b))return this.buildings[c];return null},getBuildingsAtMinLevel:function(a,b,c){for(var d=this.globals.gameManager.getEntityFactory(),f=this.buildings,g=f.length,e=[],i=0;i<g;i+=1){var j=f[i],k=j.entity;if(j.getBuildingType()===a)if(j.getLevel()>=b){if(!c&&(j=k.getEC("ECScaffold"))&&1>j.getBuildCompleteFraction())continue;e.push(k)}else if((j=k.getEC("ECUpgrader"))&&j.isUpgrading())j=j.getUpgradeArchetypeName(),(j=d.getECArchetype(j,"ECBuilding"))&&
j.buildingType===a&&j.level>=b&&e.push(k)}return e},getPrerequisitesDescription:function(a){var b="";if(!a)return b;var c=a.length,d,f;for(d=0;d<c;d+=1)0<d&&(b+="\n"),f=a[d],f.minimumQuantity&&(b+=f.minimumQuantity),b=b+" Level "+f.level+" "+f.buildingType,1<f.minimumQuantity&&(b+="'s");return b},arePrerequisitesMet:function(a){var b,c,d,f=this.isPrerequisiteMet,g=!0;if(a){b=a.length;for(c=0;c<b;c+=1)if(d=a[c],!f.call(this,d)){g=!1;break}}return g},isPrerequisiteMet:function(a){var b=!0,c,d=0,f=1,
g=Number.MAX_VALUE,e,i,j,k=0;if(a&&(c=a.buildingType)){void 0!==a.level&&(d=a.level);void 0!==a.minimumQuantity&&(f=a.minimumQuantity);void 0!==a.maximumQuantity&&(g=a.maximumQuantity);if(a=this.getBuildings()){e=a.length;for(i=0;i<e;i+=1)(j=a[i])&&(j.getBuildingType()===c&&j.getLevel()>=d)&&(k+=1)}if(a=this.getCapDispensers()){e=a.length;for(i=0;i<e;i+=1)(j=a[i])&&j.getLevelForPrerequisites(c)>=d&&(k+=1)}k<f&&(b=!1);k>=g&&(b=!1)}return b},canCreateBuilding:function(a,b,c,d,f,g){var e=!0;e&&c&&(e=
this.arePrerequisitesMet(c));e&&(a&&!g)&&(e=!this.hasReachedBuildingCap(a,b));e&&d&&(e=!this.hasReachedScaffoldCap(f));return e}};vf.create=function(a){var b=new vf;b.globals=a;b.buildings=[];b.capDispensers=[];b.buildingsWithUpgradableCaps=[];b.scaffolds={};b.upgraders={};b.numScaffoldsForCap={};b.scaffoldCap={};b.defenceRatingMappingTable=[1,2,3,4,5,Number.MAX_VALUE];return b};wf.prototype={subscribe:function(a,b){var c=this.events[a];c||(c=this.events[a]=ub.create());c.subscribe(b)},unsubscribe:function(a,
b){this.events[a].unsubscribe(b)},notify:function(a){var b=this.events[a];b&&b.notify.apply(b,Array.prototype.slice.call(arguments,1))},reset:function(){var a=this.events,b;for(b in a)a.hasOwnProperty(b)&&a[b].unsubscribeAll();this.events={}}};wf.create=function(){var a=new wf;a.events={};return a};Vd.prototype={initialise:function(){this.resourceDispensers.length=0},resourceDispenserAdded:function(a){var b=this.getResourceDispensers();a&&b&&0>b.indexOf(a)&&b.push(a)},resourceDispenserRemoved:function(a){var b=
this.resourceDispensers,c=b.indexOf(a);this.unclaimResourceDispenser(a.entity);b.splice(c,1)},getResourceDispensers:function(){return this.resourceDispensers},getNearestValidResourceDispenser:function(a,b){var c=this.globals.mathDevice,d=this.resourceDispensers,f,g,e,i=null,j=Infinity,k,l;b&&(l=b.getEC("ECWildlingAgent"));g=d.length;for(f=0;f<g;f+=1)if((e=d[f])&&0<e.getUnclaimedResource()&&(!b||!this.isResourceDispenserClaimed(e.entity,b))&&(!l||!l.isResourceDispenserRejected(e.entity)))k=c.v3DistanceSq(e.entity.getv3Location(),
a),k<j&&(i=e,j=k);!i&&b&&(i=this.getNearestValidResourceDispenser(a,null));return i},validResourceDispenserExists:function(){var a=this.resourceDispensers,b,c,d,f=!1;if(a){c=a.length;for(b=0;b<c;b+=1)if((d=a[b])&&0.1<=d.getResource()){f=!0;break}}return f},isResourceDispenserClaimed:function(a,b){var c=!1,d,f,g,e;if(a&&!a.shouldBeDestroyed()&&(d=this.resourceDispenserClaims[a.getName()])){g=d.length;for(f=0;f<g;f+=1)if((e=d[f])&&e!==b){c=!0;break}}return c},claimResourceDispenser:function(a,b){var c=
this.resourceDispensers,d=this.resourceDispenserClaims,f;if(a&&!a.shouldBeDestroyed()&&b&&!b.shouldBeDestroyed()&&(f=a.getEC("ECResourceDispenser"))&&0<=c.indexOf(f)&&!this.isResourceDispenserClaimed(a,b))c=d[a.getName()],c||(c=[],d[a.getName()]=c),0>c.indexOf(b)&&c.push(b)},unclaimResourceDispenser:function(a,b){var c=this.resourceDispensers,d=this.resourceDispenserClaims,f;if(a&&(f=a.getEC("ECResourceDispenser"))&&0<=c.indexOf(f))if(b){if(c=d[a.getName()])d=c.indexOf(b),0<=d&&c.splice(d,1)}else d[a.getName()]&&
(d[a.getName()]=void 0)}};Vd.create=function(a){var b=new Vd;b.globals=a;b.resourceDispensers=[];b.resourceDispenserClaims={};return b};var gc={addToArea:function(a,b,c,d){var f=c[0]-b[0]+1,c=c[1]-b[1]+1,g=b[0],b=b[1],e,i;for(e=0;e<f;e+=1)for(i=0;i<c;i+=1)a[g+e][b+i]+=d},setArea:function(a,b,c,d){var f=c[0]-b[0]+1,c=c[1]-b[1]+1,g=b[0],b=b[1],e,i;for(e=0;e<f;e+=1)for(i=0;i<c;i+=1)a[g+e][b+i]=d},setAreaToValueIfGreater:function(a,b,c,d){var f=c[0]-b[0]+1,c=c[1]-b[1]+1,g=b[0],b=b[1],e,i;for(e=0;e<f;e+=
1)for(i=0;i<c;i+=1)a[g+e][b+i]<d&&(a[g+e][b+i]=d)},create:function(a,b,c){var d,f,g=Array(a);for(d=0;d<a;d+=1)if(g[d]=Array(b),void 0!==c)for(f=0;f<b;f+=1)g[d][f]=c;return g},debugDrawHeightArray2D:function(a,b,c,d,f,g,e,i){var c=f.v3BuildZero(),j=f.v3BuildZero(),k=f.v3Build(0,1,0),l=f.v4BuildZero(),m=a.length,q=a[0].length,p,s;for(p=0;p<m;p+=1)for(s=0;s<q;s+=1)f.v3Build(p,0,s,j),f.v3Add(j,b,c),l=a[p][s],c[1]=l,l=(l=(p+s)%2)?i:e,gc.debugDrawArrayElement(c,k,0.5,l,d,g)},debugDrawArrayElement:function(a,
b,c,d,f,g){g.addSprite({v3Location:a,size:c,v4color:d,texture:f,out:b})},hasLOS:function(a,b,c,d,f){var g=f.v2Sub(c,b),g=f.v2Build(-g[1],g[0]);f.v2Normalize(g,g);for(var e=f.v2BuildZero(),i=f.v2BuildZero(),j=Math.min(b[0],c[0]),k=Math.max(b[0],c[0]),l=Math.min(b[1],c[1]),c=Math.max(b[1],c[1]),m=a[b[0]][b[1]],q,p;j<=k;j+=1)for(p=l;p<=c;p+=1)if(e[0]=j,e[1]=p,f.v2Sub(e,b,i),q=f.v2Dot(i,g),q=Math.abs(q),1.41>q&&(q=a[j][p]-m,q>d[0]||q<d[1]))return!1;return!0}};Wd.prototype={calculatePath:function(a,b,
c,d){var f=this.astarGraph;return sk.search(f.nodes,f.nodes[a[0]][a[1]],f.nodes[b[0]][b[1]],c,d)},setElementValue:function(a,b){var c=this.getGridArray();a[0]<this.getGridSizeX()&&(0<=a[0]&&a[1]<this.getGridSizeY()&&0<=a[1])&&(c[a[0]][a[1]]=b)},addElementValue:function(a,b){var c=this.getGridArray();a[0]<this.getGridSizeX()&&(0<=a[0]&&a[1]<this.getGridSizeY()&&0<=a[1])&&(c[a[0]][a[1]]+=b)},setImpassable:function(a){this.setElementValue(a,fa.terrainTypes.terrainTypes.impass)},setPassable:function(a){this.setElementValue(a,
fa.terrainTypes.terrainTypes.pass)},isPassable:function(a){return this.getGridArray()[a[0]][a[1]]!==fa.terrainTypes.impass},finalise:function(){var a=this.getGridArray();this.astarGraph?this.astarGraph.reset(a):this.astarGraph=new oi(a)},getTraversablePerimeterLocationList:function(a,b){var c=this.globals.mathDevice,d=this.getGridArray(),f=[],g=a[1],e=b[0]+1,i=b[1]+1,j,k,l;for(k=a[0];k<e;k+=1)for(l=g;l<i;l+=1)d[k][l]!==fa.terrainTypes.impass&&(j=c.v2Build(k,l),f.push(j));return f},debugDraw:function(a){var b=
this.getGridArray(),c=this.globals.mathDevice,d=c.v3BuildZero(),f=c.v3Build(0,1,0),g=c.v4BuildZero(),e=this.getElementTexture(),i=this.getGridSizeX(),j=this.getGridSizeY(),k,l,m;for(k=0;k<i;k+=1)for(l=0;l<j;l+=1)g=b[k][l],g!==fa.terrainTypes.pass&&(d=c.v2Build(k,l),d=this.getV3WorldLocationFromV2GridLocation(d),void 0!==a&&(d[1]=a),m=(k+l)%2,g=this.getElementColour(g,m),this.drawElement(d,f,g,e))},reset:function(){var a=this.getGridArray(),b=this.getGridSizeX(),c=this.getGridSizeY(),d,f;for(d=0;d<
b;d+=1)for(f=0;f<c;f+=1)a[d][f]=fa.terrainTypes.pass},isV2LocationWithinGrid:function(a){return a[0]<this.getGridSizeX()&&0<=a[0]&&a[1]<this.getGridSizeY()&&0<=a[1]},hasLOS:function(a,b,c,d){return this.getCollisionInfo(a,b,c,d)?!1:!0},getCollisionInfo:function(a,b,c,d){var f=this.getGridArray(),g=this.globals.mathDevice,e=g.v2Sub(b,a),e=g.v2Build(-e[1],e[0]);g.v2Normalize(e,e);for(var i=g.v2BuildZero(),j=g.v2BuildZero(),k=Math.min(a[0],b[0]),l=Math.max(a[0],b[0]),m=Math.min(a[1],b[1]),b=Math.max(a[1],
b[1]),q=c[a[0]][a[1]],p,s;k<=l;k+=1)for(s=m;s<=b;s+=1){i[0]=k;i[1]=s;p=Math.abs(c[k][s]-q);if(p>d)return i;g.v2Sub(i,a,j);p=g.v2Dot(j,e);p=Math.abs(p);if(1.41>p&&f[k][s]===fa.terrainTypes.impass)return i}return null},getV3WorldLocationFromV2GridLocation:function(a){var b=this.globals.mathDevice,c=this.v3GridToWorldOffset,a=b.v3Build(a[0],0,a[1]);b.v3Add(c,a,a);return a},getV2GridLocationFromV3WorldLocation:function(a){var b=this.v3WorldToGridOffset;return this.globals.mathDevice.v2Build(Math.floor(a[0]+
b[0]),Math.floor(a[2]+b[2]))},getElementColour:function(a,b){return a===fa.terrainTypes.impass?b?this.v4ElementColourImpassAlt:this.v4ElementColourImpass:a===fa.terrainTypes.pass?b?this.v4ElementColourPassAlt:this.v4ElementColourPass:b?this.v4ElementColourTerrainAlt:this.v4ElementColourTerrain},drawElement:function(a,b,c,d){this.globals.simpleSpriteRenderer.addSprite({v3Location:a,size:0.5,v4color:c,texture:d,out:b})},getGridArray:function(){return this.gridArray},getGridSizeX:function(){return this.sizeX},
getGridSizeY:function(){return this.sizeY},getElementTexture:function(){return this.elementTexture}};Wd.create=function(a,b,c,d,f){var g=new Wd,e=a.mathDevice;g.globals=a;g.v3GridToWorldOffset=e.v3Copy(d);g.v3WorldToGridOffset=e.v3Copy(f);g.gridArray=gc.create(b,c,fa.terrainTypes.pass);g.sizeX=b;g.sizeY=c;g.elementTexture="textures/block.dds";g.debugAlpha=0.1;g.debugAlphaAlt=0.3;g.impassDebugAlpha=0.5;g.impassDebugAlphaAlt=0.8;g.v4ElementColourImpass=e.v4Build(1,0,0,g.impassDebugAlpha);g.v4ElementColourImpassAlt=
e.v4Build(1,0,0,g.impassDebugAlphaAlt);g.v4ElementColourPass=e.v4Build(1,1,1,g.debugAlpha);g.v4ElementColourPassAlt=e.v4Build(1,1,1,g.debugAlphaAlt);g.v4ElementColourTerrain=e.v4Build(1,0.5,0.5,g.debugAlpha);g.v4ElementColourTerrainAlt=e.v4Build(1,0.5,0.5,g.debugAlphaAlt);return g};Xd.prototype={getTraversablePerimeterLocationList:function(a,b){var c=this.globals.mathDevice,d=this.getGridArray(),f=[],g=a[1],e=b[0]+1,i=b[1]+1,j,k,l;for(k=a[0];k<e;k+=1)for(l=g;l<i;l+=1)0===d[k][l]&&(j=c.v2Build(k,l),
f.push(j));return f},isV2LocationWithinGrid:function(a){return a[0]<this.getGridSizeX()&&0<=a[0]&&a[1]<this.getGridSizeY()&&0<=a[1]},debugDraw:function(a){var b=this.getGridArray(),c=this.globals.mathDevice,d=c.v3BuildZero(),f=c.v3Build(0,1,0),g=c.v4BuildZero(),e=this.getElementTexture(),i=this.getGridSizeX(),j=this.getGridSizeY(),k,l,m;for(k=0;k<i;k+=1)for(l=0;l<j;l+=1)if(g=b[k][l])d=c.v2Build(k,l),d=this.getV3WorldLocationFromV2GridLocation(d),void 0!==a&&(d[1]=a),m=(k+l)%2,g=this.getElementColour(g,
m),this.drawElement(d,f,g,e)},reset:function(){var a=this.getGridArray(),b=this.getGridSizeX(),c=this.getGridSizeY(),d,f;for(d=0;d<b;d+=1)for(f=0;f<c;f+=1)a[d][f]=0},hasLOS:function(a,b){return this.getCollisionInfo(a,b)?!1:!0},getCollisionInfo:function(a,b){var c=this.getGridArray(),d=this.globals.mathDevice,f=d.v2Sub(b,a),g=d.v2Build(-f[1],f[0]);d.v2Normalize(g,g);var e=d.v2BuildZero(),i=d.v2BuildZero(),j=Math.abs(f[0]),k=Math.abs(f[1]),l=a[0],m=a[1],q=0<=f[0]?1:-1,f=0<=f[1]?1:-1,p,s,t,u,w;for(u=
0;u<=j;u+=1){s=l+u*q;for(w=0;w<=k;w+=1)if(t=m+w*f,e[0]=s,e[1]=t,d.v2Sub(e,a,i),p=d.v2Dot(i,g),p=Math.abs(p),1.41>p&&0!==c[s][t])return e}return null},addToArea:function(a,b,c){var d=this.getGridArray(),f=this.globals.mathDevice,a=f.v2Copy(a),b=f.v2Copy(b),g=this.getGridSizeX(),e=this.getGridSizeY();a[0]=f.clamp(a[0],0,g-1);a[1]=f.clamp(a[1],0,e-1);b[0]=f.clamp(b[0],0,g-1);b[1]=f.clamp(b[1],0,e-1);gc.addToArea(d,a,b,c)},getV3WorldLocationFromV2GridLocation:function(a){var b=this.globals.mathDevice,
c=this.v3GridToWorldOffset,a=b.v3Build(a[0],0,a[1]);b.v3Add(c,a,a);return a},getElementColour:function(a,b){return a?b?this.v4ElementColourImpassAlt:this.v4ElementColourImpass:b?this.v4ElementColourPassAlt:this.v4ElementColourPass},getV2TraversableLocationListWithinArea:function(a,b){var c=this.globals.mathDevice,b=Math.round(b),b=Math.max(1,b),d=c.v2Build(a[0]-b,a[1]-b),f=c.v2Build(a[0]+b,a[1]+b),g=[],e=this.getGridArray(),i=this.getGridSizeX(),j=this.getGridSizeY();d[0]=c.clamp(d[0],0,i-1);d[1]=
c.clamp(d[1],0,j-1);f[0]=c.clamp(f[0],0,i-1);f[1]=c.clamp(f[1],0,j-1);for(var k,i=d[1],j=f[0],f=f[1],d=d[0];d<j;d+=1)for(k=i;k<f;k+=1)0===e[d][k]&&g.push(c.v2Build(d,k));return g},drawElement:function(a,b,c,d){this.globals.simpleSpriteRenderer.addSprite({v3Location:a,size:0.5,v4color:c,texture:d,out:b})},getGridArray:function(){return this.gridArray},getGridSizeX:function(){return this.sizeX},getGridSizeY:function(){return this.sizeY},getElementTexture:function(){return this.elementTexture}};Xd.create=
function(a,b,c,d,f){var g=new Xd,e=a.mathDevice;g.globals=a;g.v3GridToWorldOffset=e.v3Copy(d);g.v3WorldToGridOffset=e.v3Copy(f);g.gridArray=gc.create(b,c,0);g.sizeX=b;g.sizeY=c;g.elementTexture="textures/block.dds";g.debugAlpha=0.1;g.debugAlphaAlt=0.3;g.v4ElementColourImpass=e.v4Build(1,0,0,g.debugAlpha);g.v4ElementColourImpassAlt=e.v4Build(1,0,0,g.debugAlphaAlt);g.v4ElementColourPass=e.v4Build(1,1,1,g.debugAlpha);g.v4ElementColourPassAlt=e.v4Build(1,1,1,g.debugAlphaAlt);return g};var sk={init:function(a){for(var b,
c=0,d=a.length;c<d;c+=1){b=a[c];for(var f=0,g=b.length;f<g;f+=1){var e=b[f];e.f=0;e.g=0;e.h=0;e.cost=e.type;e.visited=!1;e.closed=!1;e.parent=null}}},heap:function(){return new Ij(function(a){return a.f})},search:function(a,b,c,d,f,g,e){this.init(a);var e=e||this.manhattan,g=!!g,i=this.heap();i.push(b);for(var j=0,k=Math.round(d.length*d[0].length/3);0<i.size()&&j<k;){var j=j+1,l=i.pop();if(l===c){a=l;for(c=[];a.parent;)d=[a.x,a.y],c.push(d),a=a.parent;d=[b.x,b.y];c.push(d);return c.reverse()}l.closed=
!0;for(var m=this.neighbors(a,l,g),q=0,p=m.length;q<p;q+=1){var s=m[q];if(!s.closed&&!s.isWall()){var t=l.g+s.cost,u=d[s.pos.x][s.pos.y]-d[l.pos.x][l.pos.y];if(u>f[0]||u<f[1])t+=Number.MAX_VALUE;u=s.visited;if(!u||t<s.g)s.visited=!0,s.parent=l,s.h=s.h||e(s.pos,c.pos),s.g=t,s.f=s.g+s.h,u?i.rescoreElement(s):i.push(s)}}}return[]},manhattan:function(a,b){var c=Math.abs(b.x-a.x),d=Math.abs(b.y-a.y);return c+d},neighbors:function(a,b,c){var d=[],f=b.x,b=b.y;a[f-1]&&a[f-1][b]&&d.push(a[f-1][b]);a[f+1]&&
a[f+1][b]&&d.push(a[f+1][b]);a[f]&&a[f][b-1]&&d.push(a[f][b-1]);a[f]&&a[f][b+1]&&d.push(a[f][b+1]);c&&(a[f-1]&&a[f-1][b-1]&&d.push(a[f-1][b-1]),a[f+1]&&a[f+1][b-1]&&d.push(a[f+1][b-1]),a[f-1]&&a[f-1][b+1]&&d.push(a[f-1][b+1]),a[f+1]&&a[f+1][b+1]&&d.push(a[f+1][b+1]));return d}};oi.prototype.reset=function(a){for(var b=this.nodes,c,d,f=0;f<a.length;f+=1){d=a[f];c=b[f];for(var g=0;g<d.length;g+=1)c[g].type=d[g]}this.input=a};oi.prototype.toString=function(){for(var a="\n",b=this.nodes,c,d,f,g,e=0,i=
b.length;e<i;e+=1){c="";d=b[e];f=0;for(g=d.length;f<g;f+=1)c+=d[f].type+" ";a=a+c+"\n"}return a};pi.prototype.toString=function(){return"["+this.x+" "+this.y+"]"};pi.prototype.isWall=function(){return 0===this.type};Ij.prototype={push:function(a){this.content.push(a);this.sinkDown(this.content.length-1)},pop:function(){var a=this.content[0],b=this.content.pop();0<this.content.length&&(this.content[0]=b,this.bubbleUp(0));return a},remove:function(a){var b=this.content.indexOf(a),c=this.content.pop();
b!==this.content.length-1&&(this.content[b]=c,this.scoreFunction(c)<this.scoreFunction(a)?this.sinkDown(b):this.bubbleUp(b))},size:function(){return this.content.length},rescoreElement:function(a){this.sinkDown(this.content.indexOf(a))},sinkDown:function(a){for(var b=this.content[a];0<a;){var c=(a+1>>1)-1,d=this.content[c];if(this.scoreFunction(b)<this.scoreFunction(d))this.content[c]=b,this.content[a]=d,a=c;else break}},bubbleUp:function(a){for(var b=this.content.length,c=this.content[a],d=this.scoreFunction(c);;){var f=
a+1<<1,g=f-1,e=null;if(g<b){var i=this.scoreFunction(this.content[g]);i<d&&(e=g)}if(f<b&&this.scoreFunction(this.content[f])<(null===e?d:i))e=f;if(null!==e)this.content[a]=this.content[e],this.content[e]=c,a=e;else break}}};Yd.prototype={getEntityToEntityPath:function(a,b,c,d,f){var g=a.getv3Location(),e=a.getGameSpace(),i=e.getHeightGrid(),i=this.getV2GridDestinationForEntity(b,g,c,i,d);if(!i||a.isInLimbo()||b.isInLimbo())return null;e=e.getV3WorldLocationFromV2GridLocation(i);return this.getV3ToV3Path(g,
e,c,d,f,a,b)},hasEntityToEntityLOS:function(a,b,c,d){var f=a.getv3Location(),g=a.getGameSpace(),e=g.getHeightGrid(),e=this.getV2GridDestinationForEntity(b,f,c,e,d);if(!e||a.isInLimbo()||b.isInLimbo())return null;a=g.getV3WorldLocationFromV2GridLocation(e);return this.hasV3ToV3LOS(f,a,c,d)},getV3ToV3Path:function(a,b,c,d,f){ma.start("navManagerGetV3ToV3PathFn");var g=this.gameManager,e=g.getGameSpace(a,0),g=g.getGameSpace(b,0);if(!e||!g)return null;var g=e.getV2GridLocationFromV3WorldLocation(a),i=
e.getV2GridLocationFromV3WorldLocation(b),j=this.globals.mathDevice;if(!g||!i)return null;if(j.v2Equal(g,i))return j=qd.create(this.globals,[a,b]);var k=e.getNavGrid(c);if(!k.isPassable(i))return null;var c=e.getRefCountGrid(c),l=e.getHeightGrid(),m=c.hasLOS(g,i),q=!1;m&&(q=gc.hasLOS(l,g,i,d,j));j=null;if(m&&q)j=qd.create(this.globals,[a,b]);else if(this.aStarSearchesMadeThisFrame<this.maxAStarSearchesPerFrame||f)this.aStarSearchesMadeThisFrame+=1,j=this.calculatePathFromGridLocations(e,g,i,k,c,l,
d);ma.stop("navManagerGetV3ToV3PathFn");return j},hasV3ToV3LOS:function(a,b,c,d){ma.start("navManagerHasV3ToV3LOSFn");var f=this.gameManager,e=f.getGameSpace(a,0),f=f.getGameSpace(b,0);if(!e||!f)return!1;a=e.getV2GridLocationFromV3WorldLocation(a);b=e.getV2GridLocationFromV3WorldLocation(b);f=this.globals.mathDevice;if(!a||!b)return!1;if(f.v2Equal(a,b))return!0;if(!e.getNavGrid(c).isPassable(b))return!1;var c=e.getRefCountGrid(c),e=e.getHeightGrid(),h=!1;return c.hasLOS(a,b)&&(h=gc.hasLOS(e,a,b,d,
f))?!0:!1},getEntityBlockingPath:function(a,b,c,d){var f=a.getWaypointList(),e=f.length,a=this.gameManager.getGameSpace(f[0]),h=a.getRefCountGrid(b),b=null,i,j,k,l=!1;for(i=0;i<e-1&&!(j=f[i],k=f[i+1],j=a.getV2GridLocationFromV3WorldLocation(j),k=a.getV2GridLocationFromV3WorldLocation(k),k=h.getCollisionInfo(j,k));i+=1);k&&(h=a.getV3WorldLocationFromV2GridLocation(k),0<c?(i=this.globals.mathDevice,f=i.v3Distance2DSq(h,f[e-1]),f>=c*c&&(l=!0)):l=!0,l&&(c=a.getEntitiesInRadius2D(h,1,d),c.length&&(b=this.getOptimalBlockingEntity(c))));
return b},getOptimalBlockingEntity:function(a){for(var b=a.length,c=Number.MAX_VALUE,d=null,f,e,h=0;h<b;h+=1)if(e=a[h],f=e.getv3Location()[1],(e.getEC("ECTarget")||e.getEC("ECHealth"))&&f<c)d=e,c=f;return d},update:function(){this.aStarSearchesMadeThisFrame=0;var a=this.globals.graphicsDevice.fps,a=qc.prototype.ecNavCount/this.getMaxSearchesPerFrame()/a;this.pathQueryPeriod=Math.max(a,this.minPathQueryPeriod)},getMaxSearchesPerFrame:function(){return this.maxAStarSearchesPerFrame},getPathQueryPeriod:function(){return this.pathQueryPeriod},
setDebugPathStartEntity:function(a){this.debugPathStartEntity=a},setDebugPathEndEntity:function(a){this.debugPathEndEntity=a},getDebugPathStartEntity:function(){return this.debugPathStartEntity},getDebugPathEndEntity:function(){return this.debugPathEndEntity},setDebugPathV3LocationStart:function(a){this.debugPathV3LocationStart=this.globals.mathDevice.v3Copy(a)},setDebugPathV3LocationEnd:function(a){this.debugPathV3LocationEnd=this.globals.mathDevice.v3Copy(a)},storeDebugInfoIfFailedPath:function(a,
b,c,d,f){if(!a){var a=this.globals,e=this.globals.mathDevice;this.failedPath=!0;this.failedPathStartEntity=d;this.failedPathEndEntity=f;this.v3FailedPathStartLocation=e.v3Copy(b);this.v3FailedPathEndLocation=e.v3Copy(c);a.debugDrawFlags.nav=!0}},debugDraw:function(){var a,b=this.globals.debugDraw;this.debugPathV3LocationStart&&this.debugPathV3LocationEnd?(a=this.getV3ToV3Path(this.debugPathV3LocationStart,this.debugPathV3LocationEnd,null,0))&&a.debugDraw():this.debugPathV3LocationStart&&b.drawDebugPoint(this.debugPathV3LocationStart,
this.debugPointColour,this.debugPointRadius);this.debugPathStartEntity&&this.debugPathEndEntity&&(this.debugEntityPath=this.getEntityToEntityPath(this.debugPathStartEntity,this.debugPathEndEntity,null,0),this.debugEntityPath.debugDraw());if(this.failedPath){var c=this.v3FailedPathStartLocation;a=this.v3FailedPathEndLocation;var d=this.globals.mathDevice,d=d.v3Add(c,d.v3Build(0,100,0)),f=[1,0,0],e=[1,1,1];b.drawDebugLine(c,a,f[0],f[1],f[2]);b.drawDebugLine(c,d,f[0],f[1],f[2]);d=this.globals;b=d.camera;
d=d.simpleFontRenderer;e={pointSize:16,alignment:1,r:e[0],g:e[1],b:e[2]};if(f=this.failedPathStartEntity)if(c=b.worldToScreen(c))e.x=c[0],e.y=c[1],d.drawFontDouble(f.name,e);if(c=this.failedPathEndEntity)if(a=b.worldToScreen(a))e.x=a[0],e.y=a[1],d.drawFontDouble(c.name,e)}},debugPointColour:[1,0,0],debugPointRadius:0.1,calculatePathFromGridLocations:function(a,b,c,d,f,e,h){var i;if(!b||!c||!d.isPassable(c))return null;b=d.calculatePath(b,c,e,h);if(!b.length)return null;this.enablePathSmoothing&&(this.storeLessSmoothPaths&&
(i=[]),b=this.smoothWaypointList(f,e,b,i));a=a.v2GridLocationListToV3WorldLocationList(b);return qd.create(this.globals,a)},getV2GridDestinationForEntity:function(a,b,c,d,f){var e=this.globals.mathDevice,h=a.getEC("ECPhysicsCube"),i=a.getGameSpace();if(!i)return null;var j=i.getV2GridLocationFromV3WorldLocation(a.getv3Location()),a=null,k,l;if(!h)return j;for(var h=h.getExtents(),c=this.getTraversableV2PerimeterLocationsFromWorldExtents(i,h,c),h=i.getV2GridLocationFromV3WorldLocation(b),b=c.length,
i=Number.MAX_VALUE,m=d[j[0]][j[1]],q,j=0;j<b;j+=1)k=c[j],l=e.v2DistanceSq(h,k),q=d[k[0]][k[1]],q=m-q,l<i&&q<=f[0]&&(i=l,a=k);return a},getTraversableV2PerimeterLocationsFromWorldExtents:function(a,b,c){var d=this.globals.mathDevice,c=a.getRefCountGrid(c),f=d.v3Build(b[0],b[1],b[2]),e=d.v3Build(b[3]-0.01,b[4]-0.01,b[5]-0.01),b=a.getV2GridLocationFromV3WorldLocation(f),a=a.getV2GridLocationFromV3WorldLocation(e),f=d.v2Build(1,1);d.v2Sub(b,f,b);d.v2Add(a,f,a);return c.getTraversablePerimeterLocationList(b,
a)},smoothWaypointList:function(a,b,c,d){var f=this.numberOfSmoothingPasses,e,h;for(e=0;e<f;e+=1)this.storeLessSmoothPaths&&d&&(h=[],h.push.apply(h,c),d.push(h)),c=this.applySmoothingPassToWaypointList(a,b,c);return c},applySmoothingPassToWaypointList:function(a,b,c){this.enableRemoveRightAngleTurns&&(c=this.removeTurns(a,b,c));this.enableRemoveAdjacentLinearWaypoints&&(c=this.removeAdjacentLinearWaypoints(c));return c},removeAdjacentLinearWaypoints:function(a){var b=this.globals.mathDevice,c=a.length,
d,f=b.v2BuildZero(),e=b.v2BuildZero(),h;if(3>c)return a;for(d=0;d<a.length-1;d+=1){b.v2Sub(a[d+1],a[d],f);h=1;for(c=d+1;c<a.length-1&&!(b.v2Sub(a[c+1],a[c],e),h+=1,!b.v2Equal(f,e));c+=1);c===a.length-1&&(h+=1);2<h&&a.splice(d+1,h-2)}return a},removeTurns:function(a,b,c){var d=this.globals.mathDevice,f=c.length,e=d.v2BuildZero(),h=d.v2BuildZero(),i,j,k;if(3>f)return c;for(var l=[0,0],f=0;f<c.length-2;f+=1)d.v2Sub(c[f+1],c[f],e),i=null,d.v2Sub(c[f+2],c[f+1],h),d.v2Equal(e,h)||(i=f+2),i&&(j=c[f],k=c[i],
a.hasLOS(j,k)&&gc.hasLOS(b,j,k,l,d)&&c.splice(f+1,i-f-1));return c}};Yd.create=function(a,b){var c=new Yd;c.globals=a;c.gameManager=b;c.debugPathV3LocationStart=null;c.debugPathV3LocationEnd=null;c.debugEntityPath=null;c.debugPathStartEntity=null;c.debugPathEndEntity=null;c.numberOfSmoothingPasses=3;c.maxAStarSearchesPerFrame=1;c.aStarSearchesMadeThisFrame=0;c.minPathQueryPeriod=0.1;c.pathQueryPeriod=0.1;c.enablePathSmoothing=!0;c.enableRemoveAdjacentLinearWaypoints=!0;c.enableRemoveRightAngleTurns=
!0;c.storeLessSmoothPaths=!1;return c};qd.prototype={getV3WaypointLocationByIndex:function(a){return this.waypointList[a]},getEndWaypointIndex:function(){return Math.max(this.waypointList.length-1,0)},debugDraw:function(){var a=this.globals.gameManager.getNavManager(),b=this.getWaypointList(),c,d,f;this.debugDrawSection(0,this.getEndWaypointIndex(),this.debugLineColour0);if(a.debugDrawUnsmoothed&&(a=this.unsmoothedWaypointLists)){c=a.length;for(d=0;d<c;d+=1)f=0===d?this.debugLineColour1:1===d?this.debugLineColour2:
this.debugLineColour3,b=a[d],this.debugDrawSectionOfList(b,0,b.length-1,f)}},debugDrawSection:function(a,b,c){this.debugDrawSectionOfList(this.getWaypointList(),a,b,c)},debugLineColour0:[1,0,1],debugLineColour1:[1,0,0],debugLineColour2:[0,1,1],debugLineColour3:[0,0,1],debugWaypointColour:[0,0.2,0],debugLineVerticalOffset:0.1,debugDrawSectionOfList:function(a,b,c,d){for(var f=this.globals,e=f.debugDraw,f=f.mathDevice,h,i;b<=c;b+=1)h=f.v3Copy(a[b]),h[1]+=this.debugLineVerticalOffset,e.drawDebugPoint(h,
this.debugWaypointColour[0],this.debugWaypointColour[1],this.debugWaypointColour[2],0.1),b!==c&&(h=f.v3Copy(a[b]),i=f.v3Copy(a[b+1]),h[1]+=this.debugLineVerticalOffset,i[1]+=this.debugLineVerticalOffset,e.drawDebugLine(h,i,d[0],d[1],d[2]))},getWaypointList:function(){return this.waypointList},getTotalLength:function(){var a=this.globals.mathDevice,b=this.getWaypointList(),c=b.length-1,d,f,e,h=0;for(d=0;d<=c;d+=1)d!==c&&(f=a.v3Copy(b[d]),e=a.v3Copy(b[d+1]),h+=a.v3Distance(f,e));return h}};qd.create=
function(a,b,c){var d=new qd;d.globals=a;d.waypointList=b;d.unsmoothedWaypointLists=c;return d};var Ge=F.extend({entityComponentName:"ECAgent",updatePeriod:0.1,sortPriority:2,shouldUpdate:!0,shouldAlwaysUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{recoveryDuration:{description:"Time (s) after attacking before agent is able to attack again",type:"slider",minValue:0,maxValue:5},targetFocusDuration:{description:"Time (s) after being attacked before agent is able to switch targets",
type:"slider",defaultValue:3,minValue:0,maxValue:60},priorityTargetType:"None",onlyAttackPriorityTargetType:!1,shouldAggroWhenAttacked:!0,maxAllyAggroDistance:3,maxNumberOfAlliesToAggroWhenAttacked:1,crashIntoSolidObjectStunDuration:0,growInitialize:!0,aggro:1,stunnable:!0,xp:0,importantBuildingDamageLimit:-1,iconSpritePath:"textures/enemy_berserker.dds",displayNameTextId:"ENEMY_DISPLAY_NAME_BASIC_MELEE"},init:function(a,b){this._super(a,b);this.recoveryDuration=b.recoveryDuration;this.currentAction=
this.wanderTimer=this.targetEntity=null;this.hasTakenDamage=!1;this.active=!0;this.critical=!1;this.spawnTimer=0.5;this.spawnTimerActive=!1;this.spawnTimeRemaining=0;this.topPriorityPotentialTarget=null;this.focusingOnTargetEntity=!1;this.targetFocusTimeRemaining=0;this.scratchpad={};this.actions=this.createActionsFromArchetype(this.archetype.actions);this.importantBuildingDamageAmount=0},activate:function(){this._super();var a=this.getEntityEC("ECPhysicsSphere");a&&a.addOnImpactCallback(this.onImpact.bind(this));
this.beginSpawnCountdown(this.spawnTimer);this.entity.setGameSpaceDynamic(!0);this.archetype.growInitialize&&this.beginAppearAnim()},onApplyDamage:function(a,b){var c;if(a&&!a.shouldBeDestroyed()&&(c=a.getEC("ECBuilding"))&&c.isImportantBuildingForDamage())c=this.archetype.importantBuildingDamageLimit,this.importantBuildingDamageAmount+=b,0<=c&&this.importantBuildingDamageAmount>c&&this.entity.setToBeDestroyed()},setStunned:function(a){var b;if(0<a&&this.archetype.stunnable){this.abortCurrentAction();
if(b=this.getEntityEC("ECLocomotion"))b.clearDestination(),b.clearDestinationEntity();this.stunnedDuration=a;this.setToDraw(!0)}},getXP:function(){return this.archetype.xp},createActionsFromArchetype:function(a){var b=[],c=a.length,d=this.gameManager.getAIActionFactory(),f,e,h;for(h=0;h<c;h+=1)e=a[h],"object"===typeof e?f=e.name:(f=e,e={}),f=d.getAIActionInstance(f,this,e),b.push(f);return b},setActive:function(a){this.active=a},setID:function(a){this.enemyID=a;this.originalGameSpace&&this.originalGameSpace.addEnemyOfID(1,
this.enemyID)},beginAppearAnim:function(){var a=this,b=this.globals.mathDevice,c=this.getEntityEC("ECMesh"),d=this.getEntityEC("ECLocomotion"),f=this.getEntityEC("ECTarget");d&&d.setActive(!1);c.setLocalOffset(b.v3Build(0,-1,0));c.setScale(0);c.setScaleY(0.2);c.update();f&&f.setValid(!1);this.appearTween=G.Create({yScale:0.2,scale:1.5,yOffset:-0.25}).to({yScale:1,scale:1,yOffset:0.2},0.25+0.5*Math.random()).easing(G.Easing.Linear.None).onUpdate(function(){c.setLocalOffset(b.v3Build(0,this.yOffset,
0));c.setScale(this.scale);c.setScaleY(this.yScale)}).onComplete(function(){a.appearTween=void 0;d&&d.setActive(!0);f&&f.setValid(!0)}).start()},beginSpawnCountdown:function(a){var b,c;!this.spawnTimerActive&&0<a&&(b=this.getEntityEC("ECLocomotion"),c=this.getEntityEC("ECTarget"),b&&b.setActive(!1),c&&c.setValid(!1),this.spawnTimeRemaining=a,this.spawnTimerActive=!0)},endSpawnCountdown:function(){var a,b;this.spawnTimerActive&&(a=this.getEntityEC("ECLocomotion"),b=this.getEntityEC("ECTarget"),a&&
a.setActive(!0),b&&b.setValid(!0),this.spawnTimeRemaining=0,this.spawnTimerActive=!1)},setDelayTime:function(a){this.beginSpawnCountdown(a)},update:function(){var a;this._super();this.isManagedByThisMachine()&&(this.entity&&this.entity.isInLimbo()?((a=this.getEntityEC("ECHealth"))&&a.killSelf(),this.entity.setToBeDestroyed()):!this.appearTween&&this.active&&(this.updateStunnedDuration(),this.updateSpawnCountdown(),this.updateTargetFocus(),this.updateActions()))},updateStunnedDuration:function(){0<
this.stunnedDuration&&(this.stunnedDuration-=this.getTimeSinceLastUpdate(),0>=this.stunnedDuration&&this.setToDraw(!1))},updateSpawnCountdown:function(){var a=this.getTimeSinceLastUpdate();this.spawnTimerActive&&(this.spawnTimeRemaining-=a,0>=this.spawnTimeRemaining&&this.endSpawnCountdown())},updateTargetFocus:function(){var a=this.getTimeSinceLastUpdate();this.focusingOnTargetEntity&&(this.getTargetEntity()?0<a&&(this.targetFocusTimeRemaining-=a,0>=this.targetFocusTimeRemaining&&(this.focusingOnTargetEntity=
!1)):this.focusingOnTargetEntity=!1)},updateActions:function(){var a=this.currentAction;if(!a||a.update())a=this.actions,this.currentAction=this.chooseNewAction(a)},chooseNewAction:function(a){var b=a.length;if(!(0<this.stunnedDuration)){var c,d;for(d=0;d<b;d+=1)if(c=a[d],c.canDoAction())return c.reset(),c}},abortCurrentAction:function(){this.currentAction&&(this.currentAction.abort(),this.currentAction=null);return!0},moveTowardsEntity:function(a){var b=this.getEntityEC("ECNav"),c=!1;b&&(c=b.setDestinationEntity(a));
return c},randomWander:function(a){null===this.wanderTimer&&(this.wanderTimer=0);var b=!1,c=this.globals,d,a=void 0!==a?a:2;c.gameCurrentTime>this.wanderTimer&&(b=!0);this.ranIntoSomething&&(b=!0,this.ranIntoSomething=!1);b&&(d=c.mathDevice,b=d.v3BuildRandom(5),d.v3SetY(0,b),b=d.v3Add(b,this.getv3Location(),b),(d=this.getEntityEC("ECLocomotion"))&&d.setDestination(b),this.wanderTimer=c.gameCurrentTime+a*(Math.random()+1))},stopRandomWander:function(){var a=this.getEntityEC("ECLocomotion");a&&(this.wanderTimer=
null,a.clearDestination())},getCrashIntoSolidObjectStunDuration:function(){return this.archetype.crashIntoSolidObjectStunDuration},onCrashedIntoSolidObject:function(){var a=this.getCrashIntoSolidObjectStunDuration();0<a&&this.setStunned(a)},isMovingTowards:function(a){var b=this.globals.mathDevice,c=this.scratchpad;c.toTarget=b.v3Sub(a.getv3Location(),this.getv3Location(),c.toTarget);b.v3Normalize(c.toTarget,c.toTarget);return-0.707>c.toTarget[1]},onImpact:function(a){!a.hasEC("ECPlayerLife")&&!a.hasEC("ECProjectile")&&
this.isMovingTowards(a)&&(this.ranIntoSomething=!0)},onTakeDamage:function(a,b){var c;c=this.gameManager;var d;a||this.makeUnskilled();if(b&&(this.hasTakenDamage=!0,this.shouldAggroWhenAttacked()&&!b.toBeDestroyed&&((d=b.getEC("ECAttach"))&&(b=d.getBaseEntity()),b===this.targetEntity||!this.isFocusingOnTargetEntity())))if((d=b.getEC("ECTarget"))&&d.isValidTarget())(c=c.getFactionManager())&&!c.areFriendly(this.entity,b)&&this.abortCurrentActionAndFocusOnEntity(b)&&this.tellNearbyAlliesToFocusOnEntity(b,
this.getMaxNumberOfAlliesToAggroWhenAttacked())},abortCurrentActionAndFocusOnEntity:function(a){var b=!1;a&&this.abortCurrentAction()&&(this.setTopPriorityPotentialTarget(a),this.clearTargetEntity(),b=!0);return b},tellNearbyAlliesToFocusOnEntity:function(a,b){var c;c=this.gameManager;var d=this.globals.mathDevice,f,e=this.getv3Location(),h,i,j,k,l,m=0;if(a&&(0<b&&c&&d)&&(l=a.getEC("ECTarget"),(c=c.getFactionManager())&&l&&l.isValidTarget()))if(f=this.getEntityEC("ECFaction")){f=f.getFactionName();
c=c.getEntityListOfAllegiance(f,!0);f=c.length;for(h=0;h<f;h+=1)if((i=c[h])&&i!==this&&i!==a)if((j=i.getEC("ECAgent"))&&j.shouldAggroWhenAttacked())if(k=j.getMaxAllyAggroDistance(),0<k&&(i=d.v3LengthSq(d.v3Sub(e,i.getv3Location())),i<=k*k&&(a===j.getTargetEntity()?j.focusOnTargetEntity():j.abortCurrentActionAndFocusOnEntity(a),m+=1,m>=b||!l.isValidTarget())))break}},makeUnskilled:function(){this.unskilledKill||(this.unskilledKill=!0)},updateMeleeTargetEntity:function(a,b){return this.updateTargetEntity(0,
a,b)},updateRangedTargetEntity:function(a,b,c){var d=0,f;c||(f=this.getEntityEC("ECFirearm"))&&(d=f.getMaxRange()-1);return this.updateTargetEntity(a,b,c,d)},updateTargetEntity:function(a,b,c,d){var f=this.getTargetEntity(),e,h,i=!1,j=this.getPriorityTargetType(),k=!1,l=(h=this.getEntityEC("ECFaction"))?h.getFactionName():null;if(!f||f.shouldBeDestroyed())this.clearTargetEntity(),f=null,e=this.gameManager,h=e.getFactionManager(),this.topPriorityPotentialTarget&&(this.topPriorityPotentialTarget.shouldBeDestroyed()||
(f=this.topPriorityPotentialTarget,k=i=!0),this.topPriorityPotentialTarget=null),!f&&j&&(f=this.getTargetOfType(j))&&!f.shouldBeDestroyed()&&(k=!0),!f&&!this.onlyAttackPriorityTargetType()&&(f=h.getNearestEnemy(this.entity,a,b)),f&&f.shouldBeDestroyed()&&(f=null),f&&!c&&(c=e.getNavManager(),j=this.getMaxNavigableHeight(),(j=c.getEntityToEntityPath(this.entity,f,l,j))?(a=c.getEntityBlockingPath(j,l,d,this.entity))&&!a.shouldBeDestroyed()&&(f=(a.hasEC("ECTarget")||a.hasEC("ECHealth"))&&!h.areFriendly(this.entity,
a)?a:null):f=k?h.getNearestEnemy(this.entity,a,b):null),f&&(i?this.focusOnTargetEntity(f):this.setTargetEntity(f));return f},getMaxNavigableHeight:function(){var a=this.getEntityEC("ECNav");if(a)return a.getMaxNavigableHeight();this.maxNavigableHeight||(this.maxNavigableHeight[0]=0,this.maxNavigableHeight[1]=0);return this.maxNavigableHeight},getTargetOfType:function(a){var b,c=null;if(a)switch(b=this.gameManager,b=b.getFactionManager(),a){case "Anything":c=b.getNearestEnemy(this.entity);break;case "AnythingButHeroes":c=
b.getNearestEnemyNonHero(this.entity);break;case "Heroes":c=this.getNearestEnemyHero();break;case "HQs":c=b.getNearestEnemyHQ(this.entity);break;case "Buildings":c=b.getNearestEnemyBuilding(this.entity);break;case "Towers":c=b.getNearestEnemyTower(this.entity);break;case "Walls":c=b.getNearestEnemyWall(this.entity);break;case "Storage":c=b.getNearestEnemyStore(this.entity);break;case "Outposts":c=b.getNearestEnemyOutpost(this.entity)}return c},getNearestEnemyHero:function(){var a=null,b=this.gameManager,
c;if(b&&(b=b.getHero())&&!this.entity.isFriendlyWith(b))(c=b.getEC("ECTarget"))&&c.isValidTarget(!0)&&(a=b);return a},stopMoving:function(){var a;(a=this.getEntityEC("ECNav"))&&a.endPath();if(a=this.getEntityEC("ECLocomotion"))a.clearDestination(),a.clearDestinationEntity()},draw:function(){0<this.stunnedDuration&&this.drawStunned()},drawDebug:function(){this.entity.drawWorldText("Current Action: "+(this.currentAction?this.currentAction.actionName:"none"),-1,1,1,1);var a=this.getTargetEntity();if(a&&
!a.toBeDestroyed){var b=a.getv3Location(),c=a.getEC("ECPhysicsSphere"),d=a.getEC("ECPhysicsCube"),a=this.getv3Location(),f=this.globals,e=f.mathDevice,f=f.debugDraw,h=[1,0,0],c=c?c.getRadius():d?d.getRadius():1,c=1.1*c;f.drawDebugLine(a,b,h[0],h[1],h[2]);f.drawDebugCircle(b,e.v3BuildYAxis(),c,h[0],h[1],h[2])}},setGameSpace:function(a){a!==this.currentGameSpace&&(this.originalGameSpace||(this.originalGameSpace=a,this.enemyID&&this.originalGameSpace.addEnemyOfID(1,this.enemyID)),void 0!==this.currentGameSpace&&
this.currentGameSpace.removeLiveEnemy(1),this.currentGameSpace=a,void 0!==this.currentGameSpace&&this.currentGameSpace.addLiveEnemy(1))},setFacing:function(a){var b=this.getEntityEC("ECOrientate"),c=this.getEntityEC("ECLocomotion");b?b.setFacing(a):c&&c.setFacing(a)},clearFacing:function(){var a=this.getEntityEC("ECOrientate"),b=this.getEntityEC("ECLocomotion");a?a.clearFacing():b&&b.clearFacing()},setTargetEntity:function(a){if(a!==this.targetEntity&&(this.clearTargetEntity(),a&&!a.toBeDestroyed&&
(this.targetEntity=a)))(a=a.getEC("ECAttackerLimit"))&&a.addAttacker(this.entity)},getTargetEntity:function(){return this.targetEntity},clearTargetEntity:function(){var a;this.targetEntity&&!this.targetEntity.toBeDestroyed&&(a=this.targetEntity.getEC("ECAttackerLimit"))&&a.removeAttacker(this.entity);this.targetEntity=null;this.focusingOnTargetEntity=!1},setTopPriorityPotentialTarget:function(a){this.topPriorityPotentialTarget=a},focusOnTargetEntity:function(a){a&&this.setTargetEntity(a);this.targetEntity&&
(this.focusingOnTargetEntity=!0,this.targetFocusTimeRemaining=this.getTargetFocusDuration())},isFocusingOnTargetEntity:function(){return this.getTargetEntity()&&this.focusingOnTargetEntity},getTargetFocusDuration:function(){return this.archetype.targetFocusDuration},shouldAggroWhenAttacked:function(){return this.archetype.shouldAggroWhenAttacked},getMaxAllyAggroDistance:function(){return this.archetype.maxAllyAggroDistance},getMaxNumberOfAlliesToAggroWhenAttacked:function(){return this.archetype.maxNumberOfAlliesToAggroWhenAttacked},
getPriorityTargetType:function(){return this.archetype.priorityTargetType},onlyAttackPriorityTargetType:function(){return this.archetype.onlyAttackPriorityTargetType},isCritical:function(){return this.critical},setCritical:function(a){this.critical=a},hasLostHealth:function(){var a=!1,b;(b=this.getEntityEC("ECHealth"))&&b.getHealth()<b.getMaxHealth()&&(a=!0);return a},canKeepAttackingTarget:function(a){var b=!1,c;if(a&&!a.shouldBeDestroyed()&&(c=a.getEC("ECTarget"))&&c.isValidTarget())if(c=a.getEC("ECHealth"),
!c||0<c.getHealth())if(a=a.getEC("ECRepairable"),!a||!a.isBroken())b=!0;return b},onDeath:function(){},onToBeDestroyed:function(){this._super();this.clearTargetEntity()},deInitActions:function(){var a=this.actions,b=a.length,c;for(c=0;c<b;c+=1)a[c].deInit();a.length=0},destroy:function(){var a=this.targetEntity;this._super();a&&!a.toBeDestroyed&&(a=a.getEC("ECMeleeTarget"))&&a.endAttack(this.entity.name);this.originalGameSpace&&(this.originalGameSpace.removeEnemy(1),this.enemyID&&this.originalGameSpace.removeEnemyOfID(1,
this.enemyID));this.originalGameSpace=void 0;this.deInitActions()}});F.prototype.eCCreationMap[Ge.prototype.entityComponentName]=Ge;Ge.create=function(a,b){return new Ge(a,b)};var Sg=F.extend({entityComponentName:"ECAnimationPlayer",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldAlwaysUpdate:!1,shouldDraw:!1,shouldSerialize:!1,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,storeGlobalList:!1,parameters:{animationSet:""},init:function(a,b){this._super(a,b);this.animation=Ld.archetypes[this.archetype.animationSet].initialAnimation},
activate:function(){this._super();this.updateController(0)},update:function(){this._super();this.updateController(this.globals.gameTimeStep)},draw:function(){},drawDebug:function(){},manageLargeTimeStep:function(a){this._super(a)},serialize:function(a){this._super(a)},serializeDelta:function(){},onDeath:function(){},onToBeDestroyed:function(){this._super()},destroy:function(){this._super()},setSpeed:function(a){var b=this.getSkinController();b&&b.inputController.setRate(a)},getSkinController:function(){return this.getEntityEC("ECMesh").node.skinController},
changeAnimation:function(a){var b=Ld.archetypes[this.archetype.animationSet].animations[a],c=this.globals.animationManager.get(b.source),d=this.getSkinController().inputController;d.setAnimation(c,b.looping);b.randomStartTime&&d.setTime(c.length*Math.random());void 0!==b.speedRange&&d.setRate(b.speedRange[0]+(b.speedRange[1]-b.speedRange[0])*Math.random());this.animation=a},attachSceneNodeController:function(a,b){var c=a.renderables;if(c)for(var d=c.length,f=0;f<d;f+=1){var e=c[f];e.isSkinned()&&
(e.skinController=b)}if(c=a.children){d=c.length;for(f=0;f<d;f+=1)this.attachSceneNodeController(c[f],b)}},updateController:function(a){var b=this.globals,c=this.getEntityEC("ECMesh");if(c){c=c.node;if(!c.skinController){var d=b.animationManager,f=d.nodeHasSkeleton(c);f&&(d=d.get(Ld.archetypes[this.archetype.animationSet].animations[this.animation].source),d=Ma.create(d.hierarchy),b=Eb.create(b.graphicsDevice,b.mathDevice),b.setInputController(d),b.setSkeleton(f),this.attachSceneNodeController(c,
b),c.skinController=b,this.changeAnimation(this.animation))}c.skinController&&c.skinController.inputController.addTime(a)}}});Sg.create=function(a,b){return new Sg(a,b)};F.prototype.eCCreationMap[Sg.prototype.entityComponentName]=Sg;var Tg=F.extend({entityComponentName:"ECAttackerLimit",updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{maxAttackers:3,maxHighPriorityAttackers:10},init:function(a,b){this._super(a,
b);this.attackers=[]},addAttacker:function(a){var a=a.name,b=this.attackers;0>b.indexOf(a)&&b.push(a)},removeAttacker:function(a){var b=this.attackers,a=b.indexOf(a.name);0<=a&&b.splice(a,1)},getMaxHighPriorityAttackers:function(){return this.archetype.maxHighPriorityAttackers},getMaxAttackers:function(){return this.archetype.maxAttackers},getNumAttackers:function(){return this.attackers.length},isFull:function(a){a=a?this.getMaxHighPriorityAttackers():this.getMaxAttackers();return this.getNumAttackers()>=
a},drawDebug:function(){this.entity.drawWorldText(""+this.getNumAttackers()+"/"+this.getMaxAttackers()+" (or "+this.getMaxHighPriorityAttackers()+" High Priority) Attackers",-1,1,1,1)},serialize:function(a){this._super(a);a.attackers=this.attackers},serializeDelta:function(){this._super()}});Tg.create=function(a,b){return new Tg(a,b)};F.prototype.eCCreationMap[Tg.prototype.entityComponentName]=Tg;var Ug=F.extend({entityComponentName:"ECAttach",updatePeriod:0,sortPriority:3,shouldUpdate:!0,shouldAlwaysUpdate:!1,
shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,init:function(a,b){this._super(a,b);this.stationary=!1;this.v3LocalOffset=null},activate:function(){this._super();this.parentEntity&&(this.parentEntity.addChild(this.entity),this.isStationary()&&this.updateTransform());this.setToAlwaysUpdate(!0)},setParent:function(a){this.parentEntity=a;this.entity&&(this.parentEntity.addChild(this.entity),this.isStationary()&&this.updateTransform())},getParent:function(){return this.parentEntity},
clearParent:function(){this.parentEntity&&(this.parentEntity.removeChild(this.entity),this.parentEntity=null)},getBaseEntity:function(){for(var a=this.entity,b=this.getParent();b;)a=b,b=(b=a.getEC("ECAttach"))?b.getParent():null;return a},clearTransform:function(){var a=this.getEntityEC("ECMesh");a&&(a=this.getEntityEC("ECMesh"),a.m43BaseTransformMatrix&&a.clearm43BaseTransformMatrixOffset())},isStationary:function(){return this.stationary},setStationary:function(a){this.stationary=a;this.entity&&
this.setToAlwaysUpdate(!a)},getv3LocalOffset:function(){return this.v3LocalOffset},setv3LocalOffset:function(a){this.v3LocalOffset=a},clearv3LocalOffset:function(){this.v3LocalOffset=null},update:function(){this._super();this.isStationary()?this.setToUpdate(!1):this.updateTransform()},updateTransform:function(){var a=this.globals.mathDevice,b=this.parentEntity,c=this.parentEntity.getEC("ECMesh"),d=this.getEntityEC("ECMesh"),f=this.getv3LocalOffset();a&&b&&(c=this.parentEntity.getEC("ECMesh"),d=this.getEntityEC("ECMesh"),
f?c?(b=a.m43TransformPoint(c.getm43Transform(),f),c=a.m43Copy(c.getm43Transform()),a.m43SetPos(c,b),this.entity.setv3Location(b),d&&d.setm43BaseTransformMatrix(c)):(b=a.v3Add(this.parentEntity.getv3Location(),f),this.entity.setv3Location(b)):c?(this.entity.setv3Location(a.m43Pos(c.getm43Transform())),d&&d.setm43BaseTransformMatrix(c.getm43Transform())):this.entity.setv3Location(this.parentEntity.getv3Location()))},draw:function(){},drawDebug:function(){var a=this.globals.debugDraw,b=this.parentEntity;
b&&(b=b.getEC("ECMesh"))&&a.drawDebugMatrix(b.getm43Transform())},serialize:function(a){this._super(a);this.parentEntity&&(a.parentEntity=this.packGameEntity(this.parentEntity))},serializeDelta:function(){},setGameSpace:function(){},onToBeDestroyed:function(){this._super();this.clearParent()},destroy:function(){this.clearParent()}});Ug.create=function(a,b){return new Ug(a,b)};F.prototype.eCCreationMap[Ug.prototype.entityComponentName]=Ug;var Vg=F.extend({entityComponentName:"ECAttackWavesManager",
updatePeriod:0.1,sortPriority:4,shouldUpdate:!0,shouldAlwaysUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,spawnRadius:0,parameters:{},init:function(a,b){this._super(a,b);this.nextWaveIndex=0;this.spawnedEntityList=[];this.thresholdTime=null;this.enemiesKilled=0;this.critical=!1;this.onEnemyKilledBound=this.onEnemyKilled.bind(this);this.spawnLocationList=this.realisedWaves=null},activate:function(){this._super();this.enemiesKilled=0;this.globals.gameManager.eventManager.subscribe("EnemyKilled",
this.onEnemyKilledBound)},onToBeDestroyed:function(){this._super();this.onEnemyKilledBound&&this.globals.gameManager.eventManager.unsubscribe("EnemyKilled",this.onEnemyKilledBound);var a=this.spawnedEntityList,b=a.length,c,d;for(c=0;c<b;c+=1)d=a[c],d.toBeDestroyed||d.setToBeDestroyed()},destroy:function(){this._super()},isCritical:function(){return this.critical},setCritical:function(a){this.critical=a},setLevel:function(a){this.level=a;this.realiseWaves()},realiseWaves:function(){var a=[],b=this.archetype.waves,
c=b.length,d,f;for(d=0;d<c;d+=1)f=b[d],f=this.realiseWave(f),a.push(f);this.realisedWaves=a},setSpawnLocationList:function(a){this.spawnLocationList=a},getSpawnLocationList:function(){return this.spawnLocationList},update:function(){var a=this.gameManager,b=this.globals,c=this.realisedWaves,d=this.nextWaveIndex,f=c.length;this._super();this.isComplete()||(d<f&&(c=c[d],null!==this.thresholdTime?(b=b.gameCurrentTime-this.thresholdTime,b=void 0===c.postThresholdDelay||b>=c.postThresholdDelay,!a.pauseAttacks&&
b&&(this.spawnWave(c),this.thresholdTime=null,this.nextWaveIndex+=1)):this.hasMetThreshold(c)&&(this.thresholdTime=b.gameCurrentTime)),this.updateNumberOfAliveSpawnedEntities())},hasMetThreshold:function(a){a=a.enemyThreshold;return void 0!==a&&this.getNumberOfAliveSpawnedEnemies()>a?!1:!0},realiseWave:function(a){var b={},c=this.globals.mathDevice,d={archetypeQuantities:b,postThresholdDelay:a.postThresholdDelay,enemyThreshold:a.enemyThreshold},f=this.level,a=a.families,e=a.length,h,i,j;for(h=0;h<
e;h+=1){i=a[h];var k=Math.floor(f),l=Math.ceil(f),m=f-k;j=c.randomIntInRange(i.min,i.max);var m=Math.round(j*m),q=j-m;i.familyName?(j=Zj[i.familyName][k],i=Zj[i.familyName][l],q&&(b[j]=q),m&&(b[i]=m)):(i=i.archetype,b[i]=j)}return d},getTotalArchetypeQuantities:function(){var a={},b=this.realisedWaves,c=b.length,d,f;for(d=0;d<c;d+=1){var e=b[d].archetypeQuantities;for(f in e)e.hasOwnProperty(f)&&(a.hasOwnProperty(f)||(a[f]=0),a[f]+=e[f])}return a},getTotalEnemyCount:function(){var a=this.realisedWaves,
b=a.length,c,d,f=0;for(c=0;c<b;c+=1){var e=a[c].archetypeQuantities;for(d in e)e.hasOwnProperty(d)&&(f+=e[d])}return f},spawnWave:function(a){var b=this.gameManager,c=this.globals.mathDevice,d=b.getEntityFactory(),b=b.getFactionManager().getEnemyFactionName(),a=a.archetypeQuantities,f=this.getSpawnLocationList(),e=f.length,h,i,j,k,l;for(j in a)if(a.hasOwnProperty(j)){h=a[j];for(i=0;i<h;i+=1)k=c.randomIntInRange(0,e-1),k=f[k],k=this.getRandomLocationWithinRadius(k,this.spawnRadius),k=d.createActiveEntityInstance(j,
j,k),this.spawnedEntityList.push(k),this.isCritical()&&(l=k.getEC("ECAgent"))&&l.setCritical(!0),k=k.getEC("ECFaction"),k.setFaction(b)}},getRandomLocationWithinRadius:function(a,b){var c=this.gameManager.getTraversableLocationListInRadius(a,b);if(c.length){var d=this.globals.mathDevice,f=d.randomIntInRange(0,c.length-1),c=d.v3Copy(c[f]);c[1]+=1;return c}return null},isComplete:function(){var a=this.nextWaveIndex,b=this.archetype.waves.length,c=this.getNumberOfAliveSpawnedEnemies();return a>=b&&0===
c},updateNumberOfAliveSpawnedEntities:function(){var a=this.spawnedEntityList,b,c;if(0<a.length)for(b=0;b<a.length;b+=1)c=a[b],c.toBeDestroyed&&a.splice(b,1)},getNumberOfAliveSpawnedEnemies:function(){return this.spawnedEntityList.length},onEnemyKilled:function(a){a.isCritical&&(this.enemiesKilled+=1)},getEnemiesKilled:function(){return this.enemiesKilled},draw:function(){},drawDebug:function(){var a=this.globals,b=a.mathDevice,a=a.debugDraw,c=this.getv3Location();a.drawDebugPoint(c,1,1,1);a.drawDebugCircle(c,
b.v3BuildYAxis(),this.spawnRadius,0,1,0)},serialize:function(a){this._super(a)},serializeDelta:function(){}});Vg.create=function(a,b){return new Vg(a,b)};F.prototype.eCCreationMap[Vg.prototype.entityComponentName]=Vg;var Wg=F.extend({entityComponentName:"ECAutoFire",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldDraw:!0,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{additionalPauseBetweenShots:{description:"Additional Pause between Shots",defaultValue:0.5,minValue:0,
maxValue:20},targetRange:0,triggerRange:0,onlyUseTriggerRangeForFirstShotInClip:!1},init:function(a,b){this._super(a,b)},activate:function(){this._super()},update:function(){var a=this.globals.mathDevice;this._super();if(this.targetEntity){var b=this.targetEntity;if(b.toBeDestroyed)this.clearTargetEntity();else{var c=this.getEntityEC("ECHealth");if(c&&0>=c.getHealth())this.clearTargetEntity();else if((c=this.getEntityEC("ECPlayerBuilder"))&&c.isBuilding())this.clearTargetEntity();else{var c=this.getEntityEC("ECFirearm"),
d=this.archetype.targetRange;if(0<d){if(a.v3Distance2DSq(this.getv3Location(),b.getv3Location())>d*d){this.clearTargetEntity();return}}else if(c&&!c.isWithinRange(b.getv3Location())){this.clearTargetEntity();return}if(a=this.getEntityEC("ECBumpAttack"))this.suppress=a.isCharging();(a=this.getEntityEC("ECLocomotion"))&&(this.suppress?a.clearLookAt():a.setLookAt(b.getv3Location()));!this.suppress&&(c&&c.getCanFire()&&c.getCanFireDuration()>this.archetype.additionalPauseBetweenShots&&this.isWithinFiringRange(b.getv3Location()))&&
c.attemptFire(b);this.targetEntity&&this.drawTargetCross()}}}},isWithinFiringRange:function(a){var b=this.globals.mathDevice,c=this.archetype.triggerRange,d=this.getEntityEC("ECFirearm"),f=!1;d&&(f=0<c&&(!this.archetype.onlyUseTriggerRangeForFirstShotInClip||d.getAmmo()>=d.getClipSize())?b.v3Distance2DSq(this.getv3Location(),a)<=c*c:d.isWithinRange(a));return f},isWithinDamageRange:function(a){var b=this.getEntityEC("ECFirearm"),c=!1;b&&(c=b.isWithinRange(a));return c},drawTargetCross:function(){var a=
this.targetEntity;if(a){var b=a.getv3Location(),c=this.gameManager.getGuiManager();this.isWithinDamageRange(b)?c.addDrawGui("crosshair",{v3WorldLocation:b},"targetCross"+a.getName()):c.addDrawGui("crosshairNo",{v3WorldLocation:b},"targetCross"+a.getName())}},disable:function(){this.clearTargetEntity()},clearTargetEntity:function(){var a;this.targetEntity&&(a=this.getEntityEC("ECLocomotion"))&&a.clearLookAt();this.targetEntity=void 0},getTargetEntity:function(){return this.targetEntity},setTargetEntity:function(a){this.targetEntity=
a},draw:function(){},drawDebug:function(){},serialize:function(a){this._super(a)},serializeDelta:function(){},destroy:function(){this._super()}});Wg.create=function(a,b){return new Wg(a,b)};F.prototype.eCCreationMap[Wg.prototype.entityComponentName]=Wg;var Fc=F.extend({entityComponentName:"ECBoomerang",updatePeriod:0,sortPriority:3,shouldUpdate:!0,shouldAlwaysUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!0,shouldSave:!1,realTime:!1,parameters:{outwardsDeceleration:0,returningAcceleration:0,
returningMaxSpeed:0},init:function(a,b){this._super(a,b);this.scratchpad={};this.v3NormalizedInitialVelocity=this.v3InitialVelocity=null},activate:function(){this._super();this.ecProjectile=this.getEntityEC("ECProjectile");this.state=Fc.boomerangStates.movingOutwards},getOutwardsDeceleration:function(){return this.archetype.outwardsDeceleration},getReturningAcceleration:function(){return this.archetype.returningAcceleration},getReturningMaxSpeed:function(){return this.archetype.returningMaxSpeed},
update:function(){if(this.isManagedByThisMachine()){if(!this.v3InitialVelocity){var a=this.globals.mathDevice;this.v3InitialVelocity=a.v3Copy(this.getv3Velocity());this.v3NormalizedInitialVelocity=a.v3Normalize(this.v3InitialVelocity)}this.state===Fc.boomerangStates.movingOutwards?this.updateMovingOutwards():this.updateReturningToOwner()}},updateMovingOutwards:function(){var a=this.globals,b=a.mathDevice,c=a.gameTimeStep,a=this.getv3Velocity(),d=b.v3Length(a),f=this.getOutwardsDeceleration(),c=d-
f*c;0<d&&0<c?b.v3ScalarMul(a,c/d,a):(b.v3BuildZero(a),this.state=Fc.boomerangStates.returningToOwner,this.ecProjectile.clearImpactedEntities())},updateReturningToOwner:function(){var a=this.scratchpad,b=this.globals,c=b.mathDevice,d=b.gameTimeStep,b=this.getv3Velocity(),f=this.getOwner(),e=c.v3Length(b),h=this.getReturningMaxSpeed(),i=this.getReturningAcceleration(),d=Math.min(e+i*d,h);f&&!f.toBeDestroyed?(a.v3ToOwner=c.v3Sub(f.getv3Location(),this.getv3Location(),a.v3ToOwner),f=c.v3Length(a.v3ToOwner),
0.5<f?c.v3ScalarMul(a.v3ToOwner,d/f,b):this.entity.setToBeDestroyed()):0<e?c.v3ScalarMul(b,d/e,b):this.v3NormalizedInitialVelocity&&c.v3ScalarMul(this.v3NormalizedInitialVelocity,-e,b)},getv3Velocity:function(){return this.ecProjectile.v3Velocity},getOwner:function(){return this.ecProjectile.owner},drawDebug:function(){},destroy:function(){this._super()},serialize:function(a){this._super(a)}});Fc.boomerangStates={movingOutwards:0,returningToOwner:1};F.prototype.eCCreationMap[Fc.prototype.entityComponentName]=
Fc;Fc.create=function(a,b){return new Fc(a,b)};var Xg=F.extend({entityComponentName:"ECBoulder",sortPriority:4,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!0,shouldSave:!1,realTime:!1,DAMAGE_SPEED_THRESHOLD:1,init:function(a,b){this._super(a,b);this.v3Direction=this.v3SafeCopy(b.v3Direction,void 0)},activate:function(){this._super();var a=this.entity.getEC("ECPhysicsSphere"),b=function(a){this.onImpact(a)}.bind(this);a&&a.addOnImpactCallback(b);if(a=this.getEntityEC("ECMesh"))a.disableDeltaSerialize=
!0;this.entity.setGameSpaceDynamic(!0);this.animateAppear()},animateAppear:function(){var a=this.getEntityEC("ECMesh"),b=this.globals.mathDevice;G.Create({y:2}).to({y:0},1.5).easing(G.Easing.Bounce.Out).onUpdate(function(){a.setLocalOffset(b.v3Build(0,this.y,0))}).start();G.Create({scale:0.01}).to({scale:1},0.5).onUpdate(function(){a.setScale(this.scale)}).start();a.setLocalOffset(b.v3Build(0,2,0));a.setScale(0.01);a.update()},onImpact:function(a){var b=this.globals.mathDevice,c,d=this.getEntityEC("ECPhysicsSphere"),
f=this.gameManager.actionManager;if(a&&d){c=a.getEC("ECHealth");var e=b.v3Sub(a.getv3Location(),this.getv3Location());b.v3Normalize(e);c?b.v3Dot(d.getv3Velocity(),e)>this.DAMAGE_SPEED_THRESHOLD&&this.isManagedByThisMachine()&&f.addAction("ApplyDamageToEntity",{damageType:"DAMAGE_TYPE_BOULDER",victim:a,aggressor:this.entity,v3InputDirection:e,v3InputOrigin:null}):void 0!==this.v3Direction&&-0.707<b.v3GetY(e)&&0.9<b.v3Dot(this.v3Direction,e)&&(this.v3Direction=void 0)}},update:function(){this._super();
var a=this.globals.mathDevice,b=this.getEntityEC("ECPhysicsSphere"),c=this.getEntityEC("ECMesh");if(b&&c){var d=b.getv3Velocity();if(0.01<a.v3LengthSq(d)){var f=a.v3Cross(d,a.v3BuildYAxis());a.v3Normalize(f,f);d=a.quatFromAxisRotation(f,a.v3Length(d)*this.getTimeSinceLastUpdate()/b.getRadius());c.addRotationQuat(d)}void 0!==this.v3Direction&&b.applyForce(a.v3ScalarMul(this.v3Direction,1200))}},getPulse:function(){return Math.sin(this.globals.gameCurrentTime*this.DEFAULT_PULSE_SCALAR+this.heroNumber)*
this.DEFAULT_MAX_PULSE_AMPLITUDE},draw:function(){},drawDebug:function(){},setGameSpace:function(){},destroy:function(){this._super();this.setGameSpace(void 0)},serialize:function(){}});F.prototype.eCCreationMap[Xg.prototype.entityComponentName]=Xg;Xg.create=function(a,b){return new Xg(a,b)};var Yg=F.extend({entityComponentName:"ECBuilding",updatePeriod:0,sortPriority:6,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!1,shouldDeltaSerialize:!1,shouldSave:!0,shouldLevelSave:!0,realTime:!1,parameters:{buildingType:"",
buildingName:"",level:1,scaffoldCap:0,scaffoldCapType:"normal",scaffoldType:"normal",obeysScaffoldCap:!0,usesInfiniteBuildMode:!1,canPlaceAnywhere:!1,mustPlaceNearCreator:!1,prerequisites:[],addedFootprintSize:1,stackable:!1,randomRotate:!1,noRotate:!1,resourceCost:{description:"Resource Cost",type:"slider",defaultValue:0,minValue:0,maxValue:1E4},secondaryResourceCost:{description:"Secondary Resource Cost",type:"slider",defaultValue:0,minValue:0,maxValue:1E4},softCurrencyCost:{description:"Soft Currency Cost",
type:"slider",defaultValue:0,minValue:0,maxValue:1E4},buildTime:{description:"Build Duration",defaultValue:30,minValue:-1,maxValue:60},rebuildTime:{description:"Rebuild Duration",defaultValue:30,minValue:-1,maxValue:60},maxLinePlacementLength:0,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,canBeMoved:!0,defenceLevel:0,importantBuildingForDamage:!1},init:function(a,b){this._super(a,b);this.upgradableGlobalCaps=null;this.setScaffoldCap(b.scaffoldCap);this.setScaffoldCapType(b.scaffoldCapType);this.setGlobalCaps(b.globalCaps)},
activate:function(){var a;a=this.gameManager;var b;this._super();b=this.getBuildingParentEntity();this.buildUpgradableGlobalCaps();if(a&&(a=a.getBuildingManager()))a.buildingAdded(this),b&&!b.shouldBeDestroyed()&&((b=b.getEC("ECPlacedBuildingTracker"))&&b.adjustBuildingCount(this.getBuildingType(),1),this.setToUpdate(!0));this.isStackable()?this.setToUpdate(!0):this.setTop(!0)},attachHandlers:function(){var a=this.globals.gameManager.eventManager;this.getBuildingParentEntity()&&!this.buildingTrackerMovedCallback&&
(this.buildingTrackerMovedCallback=this.evaluateProximityToParent.bind(this),a.subscribe("BuildingTrackerMoved",this.buildingTrackerMovedCallback))},detachHandlers:function(){var a=this.globals.gameManager.eventManager;this.buildingTrackerMovedCallback&&(a.unsubscribe("BuildingTrackerMoved",this.buildingTrackerMovedCallback),this.buildingTrackerMovedCallback=void 0)},buildUpgradableGlobalCaps:function(){var a,b,c=this.gameManager.getEntityFactory(),d={},f,e=!1;b=!1;if((a=this.getEntityEC("ECUpgradable"))&&
this.getGlobalCaps())for(a=a.getUpgradeArchetypeName();a;)b=c.getECArchetype(a,"ECBuilding"),a=c.getECArchetype(a,"ECUpgradable"),b&&(f=b.level,b=this.addBuildingCapsToUpgradableGlobalCaps(b.globalCaps,d,f),e=e||b),a=a?a.upgradeArchetypeName:null;e&&(this.upgradableGlobalCaps=d)},addBuildingCapsToUpgradableGlobalCaps:function(a,b,c){var d,f,e=this.getGlobalCaps(),h,i,j,k=!1;if(a&&b){void 0===c&&(c=0);i=a.length;for(h=0;h<i;h+=1)if(f=a[h],d=f.buildingType,f=f.quantity,void 0===b[d]&&(j=this.getCapIndexForBuildingType(e,
d),0>j||f>e[j].quantity))b[d]=c,k=!0}return k},getCapIndexForBuildingType:function(a,b){var c=-1,d,f,e;if(a){f=a.length;for(d=0;d<f;d+=1)if(e=a[d],e.buildingType===b){c=d;break}}return c},evaluateProximityToParent:function(a){var b;if(this.getBuildingParentEntity()===a&&(b=a.getEC("ECPlacedBuildingTracker"))&&b.shouldDeactivateBuildingsOutsideRange())if(a=a.getEC("ECBuildingPlacementRadius"))a=a.isValid(this.getv3Location(),"Trap"===this.archetype.buildingType,this.archetype.buildingType),this.setValidProximity(a)},
setValidProximity:function(a){if(void 0===this.validProximity||this.validProximity!==a){(this.validProximity=a)?this.destroyInactiveMesh():this.createInactiveMesh();var b=function(b){var d=b.getEC("ECHealth");d&&d.scaleMaxHealth(a?1:0.1);(b=b.getEC("ECAgent"))&&b.setActive(a)};this.entity.applyToChildren(b);b(this.entity)}},createInactiveMesh:function(){if(!this.inactiveMesh){var a=this.entity.getRadius(),a=a+0.25,b=this.gameManager.getEntityFactory().createActiveEntityInstance("idInvalidMesh","a_b_scaffoldMesh",
this.getv3Location()),c=this.globals.mathDevice,d=b.getEC("ECMesh");d.setScale(0.1);G.Create({scale:0.1,yOffset:-1}).to({scale:a/2,yOffset:0},0.5).easing(G.Easing.Elastic.Out).onUpdate(function(){d.setLocalOffset(c.v3Build(0,this.yOffset,0));d.setScale(this.scale)}).start();this.inactiveMesh=b}},destroyInactiveMesh:function(){this.inactiveMesh&&(this.inactiveMesh.shrinkDisappear(0.5),this.inactiveMesh=void 0)},getResourceCost:function(){return this.archetype.resourceCost},getSecondaryResourceCost:function(){return this.archetype.secondaryResourceCost},
setBuildingParentEntity:function(a){this.spBuildingParentEntity=a?a.getSmartPointer():void 0},getBuildingParentEntity:function(){return this.spBuildingParentEntity?this.spBuildingParentEntity.get():void 0},isImportantBuildingForDamage:function(){return this.archetype.importantBuildingForDamage},setAddedFootprintSize:function(a){this.addedFootprintSize=a},getBuildingsBeneath:function(){var a=this.globals.mathDevice,b;b=this.getEntityEC("ECPhysicsCube");this.getEntityEC("ecPhysicsSphere");b=b?a.aabbCopy(b.getExtents()):
a.aabbBuildFromCentreRadius(this.getv3Location(),0.1);a.aabbAddPoint(b,a.v3Add(this.getv3Location(),a.v3Build(0,-5,0)));a.aabbShrink(b,0.25,b);a=[];this.gameManager.getOverlappingObjects(b,a);return this.extractValidEntitiesFromCubeList(a)},getBuildingsAbove:function(){var a=this.globals.mathDevice,b;b=this.getEntityEC("ECPhysicsCube");this.getEntityEC("ecPhysicsSphere");b=b?a.aabbCopy(b.getExtents()):a.aabbBuildFromCentreRadius(this.getv3Location(),0.1);a.aabbAddPoint(b,a.v3Add(this.getv3Location(),
a.v3Build(0,5,0)));a.aabbShrink(b,0.25,b);a=[];this.gameManager.getOverlappingObjects(b,a);return this.extractValidEntitiesFromCubeList(a)},getAddedFootprintSize:function(){return void 0!==this.addedFootprintSize?this.addedFootprintSize:this.archetype.addedFootprintSize},extractValidEntitiesFromCubeList:function(a){var b=a.length,c,d=[],f;for(c=0;c<b;c+=1)(f=a[c].entity)&&(f!==this.entity&&!f.shouldBeDestroyed()&&f.hasEC("ECBuilding")&&!f.hasEC("ECScaffold"))&&d.push(f);return d},refreshTopAndBottomAndBuildingsBelow:function(){var a=
this.getBuildingsBeneath(),b=a.length,c,d;for(c=0;c<b;c+=1)d=a[c],(d=d.getEC("ECBuilding"))&&d.refreshTopAndBottom();0<a.length?this.setBottom(!1):this.setBottom(!0);this.refreshTop()},refreshBuildingsBelow:function(){var a=this.getBuildingsBeneath(),b=a.length,c,d;for(c=0;c<b;c+=1)d=a[c],(d=d.getEC("ECBuilding"))&&d.refreshTopAndBottom()},refreshTop:function(){0<this.getBuildingsAbove().length?this.setTop(!1):this.setTop(!0)},refreshBottom:function(){0<this.getBuildingsBeneath().length?this.setBottom(!1):
this.setBottom(!0)},refreshTopAndBottom:function(){this.refreshTop();this.refreshBottom()},destroyBuildingsAbove:function(){var a=this.getBuildingsAbove(),b=a.length,c,d;for(c=0;c<b;c+=1)d=a[c],d.setToBeDestroyed()},placeRebuildScaffold:function(){var a=this.gameManager;if(a&&this.archetype.autoRebuild){var b=a.getHero(),b=a.getEntityFactory().createScaffold("RebuildObject",this.getArchetypeName(),this.getv3Location(),this.getRotationY(),b,void 0,!0,4.5,0,this.getBuildingParentEntity());if((a=this.generateTemporaryBuildingData(!1))&&
b)(b=b.getEC("ECScaffold"))&&b.setTemporaryBuildingData(a)}},canPlaceAnywhere:function(){return this.archetype.canPlaceAnywhere},mustPlaceNearCreator:function(){return this.archetype.mustPlaceNearCreator},getCanMove:function(){return this.archetype.canBeMoved&&!this.movementDisabled&&this.top},disableMovement:function(a){this.movementDisabled=a},setTop:function(a){if(this.top!==a){var b=this.getEntityEC("ECSelectable");b&&b.setValid(a);this.top=a}},setBottom:function(a){if(this.bottom!==a){var b=
this.getEntityEC("ECHealth");b&&b.setInvulnerable(!a);(b=this.getEntityEC("ECTarget"))&&b.setValid(a);this.bottom=a}},move:function(a){if(this.archetype.canBeMoved){var b=a.getEC("ECPlayerBuilder"),c=a.getEC("ECLocomotion"),d=this.getArchetypeName(),f=this.getEntityEC("ECScaffold"),e=this.getEntityEC("ECResourceStorage"),h=[],i=null;if(!(b.isBuilding()&&b.getMoveFromEntity()===this.entity)){var j=this.getEntityEC("ECRadialMenu");j&&j.closeMenu();f&&(d=f.getPlannedObject());if(b){e&&(h[E.LUMBER]=e.getMaxResource(E.LUMBER),
h[E.STONE]=e.getMaxResource(E.STONE));if(f){f.getPreUpgradeObject();if(!h[E.LUMBER]||0>=h[E.LUMBER])h[E.LUMBER]=f.temporaryResourceCaps[E.LUMBER];if(!h[E.STONE]||0>=h[E.STONE])h[E.STONE]=f.temporaryResourceCaps[E.STONE];f.generateTemporaryScaffoldData();i=f.getTemporaryBuildingData()}i||this.generateTemporaryBuildingData(!0);this.globals.gameManager.eventManager.notify("BuildingEvent",{reason:"moving",building:this.entity,scaffold:a});b.placeMoveScaffoldInHand(d,this.entity,this.getBuildingParentEntity());
c&&(c.clearDestination(),c.clearDestinationEntity())}}}},generateTemporaryBuildingData:function(a){var b={},c=this.getEntityEC("ECWildlingHouse");c&&(b.wildling=c.getWildling());if(c=this.getEntityEC("ECPlacedBuildingTracker"))b.ecPlacedBuildingTrackerData=c.createTempData();if(c=this.getEntityEC("ECCapDispenser"))b.ecCapDispenserTrackerData=c.createTempData();if(c=this.getEntityEC("ECUpgrader"))b.ecUpgraderData=c.createTempData();if(c=this.getEntityEC("ECEntityDispenser"))b.ecEntityDispenserData=
c.createTempData();if((c=this.getEntityEC("ECHealth"))&&a)b.ecHealthData=c.createTempData();return b},applyTemporaryBuildingData:function(a){var b,c;if(a){if((b=a.wildling)&&!b.toBeDestroyed)(c=this.getEntityEC("ECWildlingHouse"))&&c.setWildling(b);(b=this.getEntityEC("ECPlacedBuildingTracker"))&&b.applyTempData(a.ecPlacedBuildingTrackerData);(b=this.getEntityEC("ECCapDispenser"))&&b.applyTempData(a.ecCapDispenserTrackerData);(b=this.getEntityEC("ECUpgrader"))&&b.applyTempData(a.ecUpgraderData);(b=
this.getEntityEC("ECEntityDispenser"))&&b.applyTempData(a.ecEntityDispenserData);(b=this.getEntityEC("ECHealth"))&&b.applyTempData(a.ecHealthData)}},onToBeDestroyed:function(){var a,b;a=this.gameManager;this._super();b=this.getBuildingParentEntity();if(a&&(a=a.getBuildingManager()))a.buildingRemoved(this),b&&!b.shouldBeDestroyed()&&(b=b.getEC("ECPlacedBuildingTracker"))&&b.adjustBuildingCount(this.getBuildingType(),-1);this.isStackable()&&this.refreshBuildingsBelow();this.getEntityEC("ECScaffold")||
this.destroyBuildingsAbove();this.destroyInactiveMesh();this.detachHandlers()},isStackable:function(){return this.archetype.stackable},getBuildingType:function(){return this.buildingType||this.archetype.buildingType},setBuildingType:function(a){this.buildingType=a},getBuildingName:function(){return this.buildingName||this.archetype.buildingName||this.getBuildingType()},setBuildingName:function(a){this.buildingName=a},getLevel:function(){return this.archetype.level},getDefenceLevel:function(){return this.archetype.defenceLevel},
setScaffoldCap:function(a){this.scaffoldCap=a},getScaffoldCap:function(){return this.scaffoldCap},setScaffoldCapType:function(a){this.scaffoldCapType=a},getScaffoldCapType:function(){return this.scaffoldCapType},getScaffoldType:function(){return this.archetype.scaffoldType},obeysScaffoldCap:function(){return this.archetype.obeysScaffoldCap},usesInfiniteBuildMode:function(){return this.archetype.usesInfiniteBuildMode},getPrerequisites:function(){return this.archetype.prerequisites},setGlobalCaps:function(a){this.globalCaps=
a},getGlobalCaps:function(){return this.globalCaps},hasUpgradableGlobalCaps:function(){return this.upgradableGlobalCaps?!0:!1},getUpgradableGlobalCaps:function(){return this.upgradableGlobalCaps},getMinLevelToIncreaseGlobalCapForBuildingType:function(a){var b;this.upgradableGlobalCaps&&(b=this.upgradableGlobalCaps[a]);return b},update:function(){this._super();if(!this.entity.shouldBeDestroyed()){this.isStackable()&&this.refreshTopAndBottomAndBuildingsBelow();var a=this.getBuildingParentEntity();a&&
(this.evaluateProximityToParent(a),this.attachHandlers());this.setToUpdate(!1)}},draw:function(){this.top&&this.entity.drawWorldText("-Top");this.bottom&&this.entity.drawWorldText("-          Bottom")},drawDebug:function(){},saveSerialize:function(){var a={buildingType:this.getBuildingType()};this.spBuildingParentEntity&&(a.spBuildingParentEntity=this.packSmartPointer(this.spBuildingParentEntity));return a},deserialize:function(a){this._super(a)}});Yg.create=function(a,b){return new Yg(a,b)};F.prototype.eCCreationMap[Yg.prototype.entityComponentName]=
Yg;var Pb=F.extend({entityComponentName:"ECBuildingPlacementRadius",updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!1,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,storeGlobalList:!0,parameters:{buildingRadius:10,trapRadius:15,square:!0},init:function(a,b){this._super(a,b);this.buildingRadius=b.buildingRadius;this.trapRadius=b.trapRadius;this.scratchpad={};var c=this.archetype.validBuildingTypes;this.validBuildingTypesMap={};if(c){var d=c.length,f;for(f=0;f<d;f+=1)this.validBuildingTypesMap[c[f]]=
!0}c=this.archetype.invalidBuildingTypes;this.invalidBuildingTypesMap={};if(c){d=c.length;for(f=0;f<d;f+=1)this.invalidBuildingTypesMap[c[f]]=!0}},activate:function(){this._super()},update:function(){this._super()},copyParameters:function(a){this.buildingRadius=a.buildingRadius;this.buildingRadius=a.trapRadius},getBuildingRadius:function(){return this.buildingRadius},getTrapRadius:function(){return this.trapRadius},draw:function(){},drawDebug:function(){this.drawPlacementRadius(!1,"none");this.drawPlacementRadius(!0,
"none")},drawPlacementRadiusIfRelevant:function(a,b,c,d){d&&(this.invalidBuildingTypesMap[b]||this.invalidBuildingTypesMap.all)?this.drawPlacementRadius(a,b):c&&(this.validBuildingTypesMap[b]||this.validBuildingTypesMap.all)&&this.drawPlacementRadius(a,b)},drawPlacementRadius:function(a,b){var c,d;aOutline=0.25;aFilled=0.175;var f=this.invalidBuildingTypesMap.all||this.invalidBuildingTypesMap[b],e,h;f?(e=this.globals.gameCurrentTime%10/10,h=(this.globals.gameCurrentTime+2)%10/10,blendFactorC=(this.globals.gameCurrentTime+
4)%10/10,blendFactorD=(this.globals.gameCurrentTime+6)%10/10,blendFactorE=(this.globals.gameCurrentTime+8)%10/10,c=1,d=0):(c=a?0.8:0,d=1);this.archetype.square?(a?(this.drawRectangle(this.getTrapRadius(),c,d,0,aOutline),this.drawSquare(this.getTrapRadius(),c,d,0,aFilled)):(this.drawRectangle(this.getBuildingRadius(),c,d,0,aOutline),this.drawSquare(this.getBuildingRadius(),c,d,0,aFilled)),f&&(this.drawRectangle(this.getTrapRadius()*e,c,d,0,aOutline*(1-e)),this.drawRectangle(this.getTrapRadius()*h,
c,d,0,aOutline*(1-h)),this.drawRectangle(this.getTrapRadius()*blendFactorC,c,d,0,aOutline*(1-blendFactorC)),this.drawRectangle(this.getTrapRadius()*blendFactorD,c,d,0,aOutline*(1-blendFactorD)),this.drawRectangle(this.getTrapRadius()*blendFactorE,c,d,0,aOutline*(1-blendFactorE)))):a?this.drawRadius(this.getTrapRadius(),c,d,0,aOutline):this.drawRadius(this.getBuildingRadius(),c,d,0,aFilled)},drawRadius:function(a,b,c,d,f){var e=this.globals,h=e.simpleSpriteRenderer,e=e.mathDevice,i=this.entity.getv3BottomLocation(),
j,k,l;0<a&&(h&&e)&&(i=i?e.v3Copy(i):this.getv3BaseLocation(),i[1]+=1E-4,j=e.v3Build(0,1,0),k=e.v3BuildZero(),l=e.v3BuildZero(),b={v3Location:k,size:0.5*a,blendStyle:ua.prototype.blendStyle.NORMAL,texture:this.getBuildingPlacementRadiusQuarterTexturePath(),v4color:[b,c,d,f],angle:0,out:j},e.v3Build(0.5*a,0,0.5*a,l),e.v3Add(i,l,k),h.addSprite(b),e.v3Build(-0.5*a,0,0.5*a,l),b.angle=0.5*Math.PI,e.v3Add(i,l,k),h.addSprite(b),e.v3Build(-0.5*a,0,-0.5*a,l),b.angle=Math.PI,e.v3Add(i,l,k),h.addSprite(b),e.v3Build(0.5*
a,0,-0.5*a,l),b.angle=1.5*Math.PI,e.v3Add(i,l,k),h.addSprite(b))},drawRectangle:function(a,b,c,d,f){var e=this.globals,h=e.simpleSpriteRenderer,e=e.mathDevice,i=this.entity.getv3BottomLocation(),j,k,l;0<a&&(h&&e)&&(i=e.v3Copy(i),!this.getEntityEC("ECPhysicsCube")&&!this.getEntityEC("ECPhysicsSphere")&&(i[1]-=0.4),i[1]+=1E-4,j=e.v3Build(0,1,0),k=e.v3BuildZero(),l=e.v3BuildZero(),b={v3Location:k,sizeX:1*a,sizeY:1,blendStyle:ua.prototype.blendStyle.NORMAL,texture:this.getBuildingPlacementEdgeTexturePath(),
v4color:[b,c,d,f],angle:0,out:j},e.v3Build(0,0,-a+0.5,l),b.sizeX=a+0.5,b.sizeY=1,e.v3Add(i,l,k),h.addSprite(b),e.v3Build(a-0.5,0,0,l),b.angle=0.5*Math.PI,b.sizeX=1,b.sizeY=a+0.5,e.v3Add(i,l,k),h.addSprite(b),e.v3Build(0,0,a-0.5,l),b.angle=Math.PI,b.sizeX=a+0.5,b.sizeY=1,e.v3Add(i,l,k),h.addSprite(b),e.v3Build(-a+0.5,0,0,l),b.angle=1.5*Math.PI,b.sizeX=1,b.sizeY=a+0.5,e.v3Add(i,l,k),h.addSprite(b))},drawSquare:function(a,b,c,d,f){var e=this.globals,h=e.simpleSpriteRenderer,e=e.mathDevice,i=this.entity.getv3BottomLocation();
0<a&&(h&&e)&&(i=e.v3Copy(i),!this.getEntityEC("ECPhysicsCube")&&!this.getEntityEC("ECPhysicsSphere")&&(i[1]-=0.4),i[1]+=1E-4,e=e.v3Build(0,1,0),a={v3Location:i,sizeX:a+0.5,sizeY:a+0.5,blendStyle:ua.prototype.blendStyle.NORMAL,texture:"textures/block.dds",v4color:[b,c,d,f],angle:0,out:e},h.addSprite(a))},isValid:function(a,b,c){return this.validBuildingTypesMap[c]||this.validBuildingTypesMap.all?this.isv3LocationWithinBuildArea(a,b):!1},isInvalid:function(a,b,c){return this.invalidBuildingTypesMap[c]||
this.invalidBuildingTypesMap.all?this.isv3LocationWithinBuildArea(a,b):!1},isv3LocationWithinBuildArea:function(a,b){var c,d;c=b?this.getTrapRadius():this.getBuildingRadius();var f=this.globals.mathDevice;return this.archetype.square?(d=f.v3Sub(a,this.getv3Location()),f.v3Abs(d,d),d[0]<=c&&d[2]<=c):f.v3Distance2DSq(a,this.getv3Location())<=c*c},getBuildingPlacementRadiusQuarterTexturePath:function(){return Pb.buildingPlacementRadiusQuarterTexturePath},getBuildingPlacementEdgeTexturePath:function(){return Pb.buildingPlacementRadiusEdgeTexturePath},
serialize:function(a){this._super(a)},serializeDelta:function(){},destroy:function(){this._super()}});Pb.buildingPlacementRadiusQuarterTexturePath="textures/tower_range_outer.dds";Pb.buildingPlacementRadiusEdgeTexturePath="textures/build_area.dds";Pb.preload=function(a){var a=a.textureManager,b=Pb.buildingPlacementRadiusEdgeTexturePath;a.load(Pb.buildingPlacementRadiusQuarterTexturePath);a.load(b)};Pb.create=function(a,b){return new Pb(a,b)};F.prototype.eCCreationMap[Pb.prototype.entityComponentName]=
Pb;var Zg=F.extend({entityComponentName:"ECBumpAttack",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldDraw:!0,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!0,parameters:{damageType:"",hitEffect:"",minimumSpeed:0,cooldownDuration:1,drawCooldownBar:!1,cooldownBarRow:9},init:function(a,b){this._super(a,b);this.lastAttackTime=void 0;this.damageType=this.archetype.damageType;this.scratchpad={}},getDamageType:function(){return this.damageType},getHitEffect:function(){return this.archetype.hitEffect},
getMinimumSpeed:function(){return this.archetype.minimumSpeed},getCooldownDuration:function(){return this.archetype.cooldownDuration},isCoolingDown:function(){return void 0!==this.lastAttackTime&&this.globals.gameCurrentTime<=this.lastAttackTime+this.getCooldownDuration()},getCooldownFactor:function(){var a=this.globals,b=a.mathDevice,c=1,d=this.lastAttackTime,a=a.gameCurrentTime,f=this.getCooldownDuration();void 0!==d&&0<f&&(c=b.saturate((a-d)/f));return c},shouldDrawCooldownBar:function(){return this.archetype.drawCooldownBar&&
this.isCoolingDown()},getCooldownBarRow:function(){return this.archetype.cooldownBarRow},findTargetEnemy:function(){if(!this.isCoolingDown()){var a=this.getEntityEC("ECLocomotion");if(a&&a.hasDestination()&&!(0.25>a.getTimeHeld())){var b=this.entity,c=this.getv3Location(),d=9,f=this.globals.mathDevice,e=this.scratchpad;e.v3Direction=f.v3Sub(a.getDestination(),c,e.v3Direction);f.v3Normalize(e.v3Direction,e.v3Direction);var h,a=function(a){if(!a.shouldBeDestroyed()){var i;if(a.getEC("ECAgent")&&!b.isFriendlyWith(a)){i=
f.v3Sub(a.getv3Location(),c);var n=f.v3LengthSq(i);n<=d&&(f.v3Normalize(i,i),0.85<f.v3Dot(i,e.v3Direction)&&(d=n,h=a))}}},i=this.gameManager;i&&i.applyToEntitiesInGridCellsWithinRadius(c,3,a);return h}}},activate:function(){this._super();var a=this.entity.getEC("ECPhysicsCube"),b=this.entity.getEC("ECPhysicsSphere"),c=function(a){this.onImpact(a)}.bind(this);a&&a.setOnImpactCallback(c);b&&b.addOnImpactCallback(c);this.setToDraw(this.archetype.drawCooldownBar?!0:!1)},onImpact:function(a){!this.isCoolingDown()&&
(a===this.targetEntity&&this.isMovingTowards(a))&&this.doAttack(a)},isMovingTowards:function(a){var b=this.globals.mathDevice,c=this.scratchpad,d=!1,f=this.getMinimumSpeed(),e,h;(h=this.getEntityEC("ECPhysicsSphere"))&&(e=h.getv3Velocity());e&&b.v3Length2DSq(e)>=f*f&&(c.v3DirectionToOtherEntity=b.v3Sub(a.getv3Location(),this.getv3Location(),c.v3DirectionToOtherEntity),1E-4<b.v3Dot(e,c.v3DirectionToOtherEntity)&&(d=!0));return d},doAttack:function(a){var b=this.gameManager.actionManager,c=this.globals.mathDevice;
this.isManagedByThisMachine()&&(b.addAction("ApplyDamageToEntity",{damageType:this.getDamageType(),victim:a,aggressor:this.entity,v3InputOrigin:this.getv3Location()}),this.lastAttackTime=this.globals.gameCurrentTime);this.globals.gameManager.eventManager.notify("ChargeAttack",this.entity);var b=this.getHitEffect(),d=this.getv3Location(),a=a.getv3Location(),f=this.gameManager.getEffectFactory();f&&f.play(b,c.v3Lerp(d,a,0.5),this.entity,c.v3Sub(a,d))},update:function(){this._super();this.targetEntity=
this.findTargetEnemy()},isCharging:function(){return!this.targetEntity||this.isCoolingDown()?!1:!0},getSpeedMod:function(){return this.isCharging()?1.5:1},draw:function(){this.shouldDrawCooldownBar()&&this.drawCooldownBar(this.getCooldownBarRow());var a=this.globals.debugDraw;this.targetEntity&&a.drawDebugPoint(this.targetEntity.getv3Location(),1,0,0,3)},drawCooldownBar:function(a){this.entity.drawProgressBarFromFraction(this.getCooldownFactor(),a,1,0.4,0.6,0.9)},drawDebug:function(){},onToBeDestroyed:function(){this._super()},
serialize:function(a){this._super(a)},serializeDelta:function(){}});Zg.create=function(a,b){return new Zg(a,b)};F.prototype.eCCreationMap[Zg.prototype.entityComponentName]=Zg;var $g=F.extend({entityComponentName:"ECCameraFollower",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldAlwaysUpdate:!0,shouldDraw:!1,shouldAlwaysDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,storeGlobalList:!1,parameters:{},init:function(a,b){this._super(a,b)},activate:function(){this._super()},
update:function(){this._super();this.entity.setv3Location(this.globals.mathDevice.m43Pos(this.globals.camera.matrix));var a=this.getEntityEC("ECMesh");a&&(a.setDirtyMatrix(!0),a.update())},draw:function(){},drawDebug:function(){},manageLargeTimeStep:function(a){this._super(a)},serialize:function(a){this._super(a)},serializeDelta:function(){},onDeath:function(){},onToBeDestroyed:function(){this._super()},destroy:function(){this._super()}});$g.create=function(a,b){return new $g(a,b)};F.prototype.eCCreationMap[$g.prototype.entityComponentName]=
$g;var ah=F.extend({entityComponentName:"ECCampaignStarter",updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!1,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,storeGlobalList:!1,init:function(a,b){this._super(a,b);this.campaignRegionName=null;this.campaignRegionEnabled=!1},activate:function(){var a,b;this._super();a=this.gameManager;b=a.eventManager;this.onCampaignRegionEnabledCallback=this.onCampaignRegionEnabled.bind(this);b.subscribe("CampaignRegionEnabled",this.onCampaignRegionEnabledCallback);
this.onCampaignRegionDisabledCallback=this.onCampaignRegionDisabled.bind(this);b.subscribe("CampaignRegionDisabled",this.onCampaignRegionDisabledCallback);this.campaignRegionEnabled=a.isCampaignRegionEnabled(this.campaignRegionName);this.getEntityEC("ECInteractable").setOnInteractCallback(this.onInteract.bind(this));if(b=this.entity.getGameSpace()){a=this.getEntityEC("ECMesh");var c=this.globals.mathDevice;a&&(b=c.v3ToAngle(c.v3Sub(b.getv3Location(),this.getv3Location())),a.setRotationY(b),a.update())}},
onToBeDestroyed:function(){var a=this.gameManager.eventManager;this._super();a.unsubscribe("CampaignRegionEnabled",this.onCampaignRegionEnabledCallback);a.unsubscribe("CampaignRegionDisabled",this.onCampaignRegionDisabledCallback)},onCampaignRegionEnabled:function(a){!this.campaignRegionEnabled&&(a&&a===this.getCampaignRegionName())&&(this.campaignRegionEnabled=!0)},onCampaignRegionDisabled:function(a){this.campaignRegionEnabled&&(a&&a===this.getCampaignRegionName())&&(this.campaignRegionEnabled=
!1)},onInteract:function(){var a=this.gameManager;this.isCampaignRegionEnabled()&&a.eventManager.notify("CampaignStarterInteract",this.getCampaignRegionName())},setCampaignRegionName:function(a){var b=this.gameManager;a!==this.campaignRegionName&&(this.campaignRegionEnabled=(this.campaignRegionName=a)&&b.isCampaignRegionEnabled(a)?!0:!1)},getCampaignRegionName:function(){return this.campaignRegionName},isCampaignRegionEnabled:function(){return this.campaignRegionEnabled},update:function(){this._super()},
draw:function(){},drawDebug:function(){},destroy:function(){this._super()}});ah.create=function(a,b){return new ah(a,b)};F.prototype.eCCreationMap[ah.prototype.entityComponentName]=ah;var bh=F.extend({entityComponentName:"ECCapDispenser",updatePeriod:5,sortPriority:4,shouldUpdate:!0,shouldAlwaysUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!0,realTime:!1,storeGlobalList:!1,parameters:{},init:function(a,b){this._super(a,b);this.initUpgradeLevels(this.archetype.upgradeLevels);
this.buildingLevels={}},initUpgradeLevels:function(a){this.upgradeLevelsIndices=[];var a=a.length,b;for(b=0;b<a;b+=1)this.upgradeLevelsIndices[b]=0},evaluateUpgradeLevelsValidity:function(){var a=this.gameManager;if(a&&(a=a.getBuildingManager())){this.menuToValidIndex=[];var b=this.archetype.upgradeLevels,c=b.length,d,f;for(d=0;d<c;d+=1)f=b[d],(!f.prerequisites||a.arePrerequisitesMet(f.prerequisites))&&this.menuToValidIndex.push(d)}},getUpgradeLevelsIndices:function(a){return this.upgradeLevelsIndices[a]},
padOutLevelsIndices:function(){if(this.upgradeLevelsIndices.length<this.archetype.upgradeLevels.length)for(var a=this.archetype.upgradeLevels.length-this.upgradeLevelsIndices.length,b=0;b<a;b+=1)this.upgradeLevelsIndices.push(0)},initLevels:function(){var a=this.upgradeLevelsIndices,b=a.length,c;for(c=0;c<b;c+=1)this.applyUpgrade(c,a[c])},unlockCap:function(a){this.upgradeLevelsIndices[a]+=1;this.applyUpgrade(a,this.upgradeLevelsIndices[a]);var b=this.getLevelInfo(a,this.getUpgradeLevelsIndices(a));
this.gameManager.getGuiManager().addGameMessage("ecCapDispenser"+this.entity.getName(),"Research "+this.getBuildingDisplayName(a)+" Level "+b.level,"Complete!",4,"newsflashResearchComplete");this.gameManager.getGameSoundManager().play("aud_celebrate")},applyUpgrade:function(a,b){var c=this.getBuildingType(a),d=this.getLevelInfo(a,b).level;this.buildingLevels[c]=d},getBuildingDisplayName:function(a){return this.archetype.upgradeLevels[a].buildingDisplayName},getBuildingType:function(a){return this.archetype.upgradeLevels[a].buildingType},
isFullyUpgraded:function(a){return this.getUpgradeLevelsIndices(a)>=this.archetype.upgradeLevels[a].levels.length-1?!0:!1},getLevelInfo:function(a,b){return this.archetype.upgradeLevels[a].levels[b]},getLevelForPrerequisites:function(a){if(void 0!==this.buildingLevels[a])return this.buildingLevels[a]},getRadialMenuButtonCount:function(){return this.menuToValidIndex.length},canUpgrade:function(a,b){return this.isUpgrading()||this.isFullyUpgraded(a)||!this.canAfford(b,a)?!1:!0},isUpgrading:function(){return 0<
this.timeToUnlock},getGuiArchetype:function(a,b,c,d){if(this.isFullyUpgraded(a))return"unlockComplete";a=this.getLevelInfo(a,b);return 0<a.secondaryResourceCost?c?d?"unlockStone":"unlockInvalidStoneCantAfford":"unlockInvalidStone":0<a.softCurrencyCost?c?d?"unlockAmber":"unlockInvalidAmberCantAfford":"unlockInvalidAmber":c?d?"unlockLumber":"unlockInvalidLumberCantAfford":"unlockInvalidLumber"},canAfford:function(a,b){var c=this.getLevelInfo(b,this.getUpgradeLevelsIndices(b)+1),d=c.resourceCost,f=c.secondaryResourceCost,
c=c.softCurrencyCost,e=a.getEC("ECPlayerData");return e?e.getResource(E.LUMBER)>=d&&e.getResource(E.STONE)>=f&&e.getSoftCurrency()>=c:!1},remapMenuIndexToValidIndex:function(a){return this.menuToValidIndex[a]},getCostToInstantResearch:function(){var a=this.timeToUnlock;return 60>=a?5:3600>=a?Math.ceil(100*(a/3600)):86400>=a?Math.ceil(1E3*(a/86400)):604800>=a?Math.ceil(2E3*(a/604800)):Math.ceil(4E3*(a/1209600))},canEntityAffordInstantResearch:function(a){return(a=a.getEC("ECPlayerData"))?a.getSoftCurrency()>
this.getCostToInstantResearch():!1},payForInstantResearch:function(a){(a=a.getEC("ECPlayerData"))&&a.adjustSoftCurrency(-this.getCostToInstantResearch())},sendInstantResearchSpeedupBought:function(){this.globals.metricsManager.sendGameMetric("instantResearchBought",this.getCostToInstantResearch())},doInstantResearchRadialMenuButton:function(a,b,c){var d=this.globals.currentLanguage.GAME_HUD_SPEED_UP,f=this.numberToCommaString(this.getCostToInstantResearch());this.canEntityAffordInstantResearch(b)?
a.doButton({id:"eccapdispenser"+this.entity.getName()+"instantResearch",text1:d,text2:f,v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:"speedup"})&&(this.payForInstantResearch(b),this.sendInstantResearchSpeedupBought(),this.completeUnlock()):(d=this.globals.currentLanguage.GUI_BUTTON_BUY_AMBER,a.doButton({id:"eccapdispenser"+this.entity.getName()+"instantResearchUnavailable",text1:d,text2:f,v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:"addAmberShop"})&&this.openInstantResearchShop())},
doRadialMenuButton:function(a,b,c,d){var d=this.remapMenuIndexToValidIndex(d),f=this.getBuildingDisplayName(d),e=this.canUpgrade(d,b),h,i="",j="",k="",l="",m="",q=this.isUpgrading(),p=this.isFullyUpgraded(d);h=!1;p||(h=this.canAfford(b,d));var s=this.getGuiArchetype(d,this.getUpgradeLevelsIndices(d)+1,!q&&!p,h);h=this.isFullyUpgraded(d)?this.getLevelInfo(d,this.getUpgradeLevelsIndices(d)):this.getLevelInfo(d,this.getUpgradeLevelsIndices(d)+1);j+=this.numberToCommaString(h.resourceCost);k+=this.numberToCommaString(h.secondaryResourceCost);
l+=this.numberToCommaString(h.softCurrencyCost);m+=this.formatTimeToString(h.duration,!0);e?(i="Research\n"+f+" Level "+h.level,a.doButton({id:"ecRadialMenu"+this.entity.getName()+"Upgrade"+d,text1:i,text2:j,text3:k,text4:l,text5:m,v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:s})&&(this.payForUnlock(b,d),this.beginUnlock(b,d))):(i=q?i+"Research already\n in Progress":p?i+(f+"\nFully Researched"):"Research\n"+f+" Level "+h.level,a.doButton({id:"ecRadialMenu"+this.entity.getName()+"Upgrade Unavailable"+
d,text1:i,text2:j,text3:k,text4:l,text5:m,v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:s})&&!q&&!p&&this.openUpgradeShop(b,d))},openUpgradeShop:function(a,b){var c=this,d=this.getLevelInfo(b,this.getUpgradeLevelsIndices(b)+1),f=d.resourceCost,e=d.secondaryResourceCost,h=d.softCurrencyCost,i=this.gameManager,j=Wa.create(i,this.globals);i.setGameState(j);0<h?j.setButtonPanal("purchase"):(j.setPurchaseFn(function(){c.beginUnlock(a,b)}),j.setRequiredResource(E.LUMBER,f),j.setRequiredResource(E.STONE,
e),f=this.getBuildingType(b),j.setPurchaseReason("purchaseUpgrade_"+f+"_"+d.level),j.setButtonPanal("convert"))},openInstantResearchShop:function(){var a=this.gameManager,b=Wa.create(a,this.globals);a.setGameState(b);b.setButtonPanal("purchase")},createTempData:function(){return{upgradeLevelsIndices:this.upgradeLevelsIndices,upgradeUnlockIndex:this.upgradeUnlockIndex,timeToUnlock:this.timeToUnlock}},applyTempData:function(a){a&&(this.upgradeLevelsIndices=a.upgradeLevelsIndices,this.upgradeUnlockIndex=
a.upgradeUnlockIndex,this.timeToUnlock=a.timeToUnlock)},activate:function(){var a;a=this.gameManager;this._super();a&&(a=a.getBuildingManager())&&a.capDispenserAdded(this);this.padOutLevelsIndices();this.initLevels();this.evaluateUpgradeLevelsValidity();0<this.timeToUnlock&&this.setUpdatePeriod(0)},update:function(){this._super();if(this.isUpgrading()){var a=this.getTimeSinceLastUpdate()+this.gameManager.getAdditionalTimeFromSave();this.updateCap(a)}else this.evaluateUpgradeLevelsValidity()},isResearching:function(){return 0<
this.timeToUnlock},getTimeToUnlock:function(){return this.timeToUnlock},updateCap:function(a){this.timeToUnlock-=a;var b=this.globals.mathDevice,a=this.formatTimeToString(this.timeToUnlock);if(0>=this.timeToUnlock)this.completeUnlock();else{b=b.v3Copy(this.getv3Location());b[1]+=2;var c=this.getLevelInfo(this.upgradeUnlockIndex,this.getUpgradeLevelsIndices(this.upgradeUnlockIndex)+1).duration,a={v3WorldLocation:b,text:a,completeFactor:1-this.timeToUnlock/c};this.gameManager.getGuiManager().addDrawGui("unlockProgressBar",
a,this.entity.getName()+"UnlockProgress")}},completeUnlock:function(){this.unlockCap(this.upgradeUnlockIndex);this.setUpdatePeriod(5);this.timeToUnlock=-1;this.evaluateUpgradeLevelsValidity()},payForUnlock:function(a,b){var c=this.getLevelInfo(b,this.getUpgradeLevelsIndices(b)+1),d=c.resourceCost,f=c.secondaryResourceCost,c=c.softCurrencyCost,e=a.getEC("ECPlayerData");e&&(e.adjustResource(E.LUMBER,-d),e.adjustResource(E.STONE,-f),e.adjustSoftCurrency(-c))},beginUnlock:function(a,b){var c=this.getLevelInfo(b,
this.getUpgradeLevelsIndices(b)+1);this.upgradeUnlockIndex=b;this.timeToUnlock=c.duration;this.setUpdatePeriod(0);(c=this.getEntityEC("ECSelectable"))&&c.setActivated(!1);this.gameManager.forceLevelSave()},draw:function(){},drawDebug:function(){},serialize:function(a){this._super(a)},serializeDelta:function(){},onDeath:function(){},onToBeDestroyed:function(){this._super();var a;a=this.gameManager;this._super();a&&(a=a.getBuildingManager())&&a.capDispenserRemoved(this)},manageLargeTimeStep:function(a){this._super(a);
this.isUpgrading()&&this.updateCap(a)},saveSerialize:function(){return{upgradeLevelsIndices:this.upgradeLevelsIndices,upgradeUnlockIndex:this.upgradeUnlockIndex,timeToUnlock:this.timeToUnlock,startTimeToUnlock:this.startTimeToUnlock}},destroy:function(){this._super()}});bh.create=function(a,b){return new bh(a,b)};F.prototype.eCCreationMap[bh.prototype.entityComponentName]=bh;var He=F.extend({entityComponentName:"ECChargeableShot",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!0,
shouldDeltaSerialize:!1,shouldSave:!1,realTime:!0,parameters:{chargeRateWhenMoving:1,chargeRateWhenStill:1,canMoveFreelyWhileCharging:!1,canMoveFreelyWhileFullyCharged:!1,canFireNonTargetedShotsWhileCharging:!1,canFireNonTargetedShotsWhileFullyCharged:!1,chargingSound:"",chargingTexture:"",projectiles:[]},init:function(a,b){this._super(a,b);this.charging=!1;this.charge=0},update:function(){this._super();this.updateCharge()},draw:function(){},drawChargeUI:function(a,b,c,d){var f=this.globals,e=f.mathDevice,
h=f.simpleSpriteRenderer,i=this.getChargeFactor(),j=k.outline,r=k.fullyChargedShot,l=j[3],m,q=this.getChargingTexture();q&&(""!==q&&e&&h&&this.isCharging()&&0<this.getCharge())&&(l=e.lerp(0,l,i),this.isFullyCharged()?(j=0.125*(1+Math.sin(10*f.gameCurrentTime)),i=0.7*b*(1+j),b=r[0],f=r[1],r=r[2]):(i=b*e.lerp(4,0.7,i),b=j[0],f=j[1],r=j[2]),0<i&&0<l&&(d?d=ua.prototype.blendStyle.NORMAL_NO_Z:(d=ua.prototype.blendStyle.NORMAL,m=e.v3BuildYAxis()),a=e.v3Copy(a),c&&(a[1]+=c),h.addSprite({v3Location:a,size:i,
blendStyle:d,texture:q,v4color:e.v4Build(b,f,r,l),out:m})))},getProjectiles:function(){return this.archetype.projectiles},getChargeRateWhenMoving:function(){return this.archetype.chargeRateWhenMoving},getChargeRateWhenStill:function(){return this.archetype.chargeRateWhenStill},getCurrentChargeRate:function(){var a=this.getEntityEC("ECFirearm");return a&&!a.getCanFire()?0:this.isMoving()?this.getChargeRateWhenMoving():this.getChargeRateWhenStill()},isMoving:function(){var a=this.getEntityEC("ECLocomotion");
return a&&a.hasDestination()},canMoveFreelyWhileCharging:function(){return this.archetype.canMoveFreelyWhileCharging},canMoveFreelyWhileFullyCharged:function(){return this.archetype.canMoveFreelyWhileFullyCharged},canFireNonTargetedShotsWhileCharging:function(){return this.archetype.canFireNonTargetedShotsWhileCharging},canFireNonTargetedShotsWhileFullyCharged:function(){return this.archetype.canFireNonTargetedShotsWhileFullyCharged},getChargingSound:function(){return this.archetype.chargingSound},
getChargingTexture:function(){return this.archetype.chargingTexture},canCharge:function(){var a=!0,b=this.getEntityEC("ECFirearm");b&&b.isUsingTemporaryWeapon()&&(a=!1);return a},onEquipTemporaryWeapon:function(){this.stopCharging()},canMoveFreely:function(){var a=!0;this.isFullyCharged()?a=this.canMoveFreelyWhileFullyCharged():this.isCharging()&&(a=this.canMoveFreelyWhileCharging());return a},canFireNonTargetedShot:function(){var a=!1;this.isFullyCharged()?a=this.canFireNonTargetedShotsWhileFullyCharged():
this.isCharging()&&(a=this.canFireNonTargetedShotsWhileCharging());return a},getCharge:function(){var a=0;this.isCharging()&&(a=this.charge);return a},getMaxCharge:function(){var a=0,b=this.getProjectiles();if(b&&(b=b[b.length-1])&&0<=b.charge)a=b.charge;return a},getChargeFactor:function(){var a=this.getMaxCharge(),b=0;this.isCharging()&&(b=0<a?this.getCharge()/a:1);return b},isCharging:function(){return this.charging},isFullyCharged:function(){return this.isCharging()&&this.getCharge()>=this.getMaxCharge()},
startCharging:function(){this.isCharging()||(this.charging=!0,this.charge=0)},stopCharging:function(){this.isCharging()&&(0<this.charge&&this.stopChargeSound(),this.charging=!1,this.charge=0)},updateCharge:function(){var a=this.getTimeSinceLastUpdate(),b,c=this.getMaxCharge();this.isCharging()&&(this.charge<c&&0<a)&&(b=this.getCurrentChargeRate(),0<b&&(a*=b,0>=this.charge&&0<a&&this.startChargeSound(),this.charge+=a,this.charge>=c&&(this.charge=c,this.onFullyCharged())))},startChargeSound:function(){var a=
this.getChargingSound();a&&this.playSound(a)},stopChargeSound:function(){var a=this.getChargingSound();a&&this.stopSound(a)},getCurrentProjectile:function(){return this.getProjectileForChargeAmount(this.getCharge())},getProjectileForChargeAmount:function(a){var b,c=this.getProjectiles(),d,f,e;void 0===a&&(a=0);if(c){d=c.length;for(f=0;f<d;f+=1)if(e=c[f])if(e.charge>a)break;else b=e.projectile}return b},primeForFire:function(){var a=this.getEntityEC("ECFirearm");a&&this.isCharging()&&a.setOverloadProjectile(this.getCurrentProjectile());
this.stopCharging()},onFullyCharged:function(){var a=this.gameManager.getActionManager(),b=this.globals.mathDevice.v3Copy(this.getv3Location());this.entity.playSound("chargeUp");a.addAction("VisualEffect",{archetype:"chargeUp",v3Location:b})}});He.preloadComponent=function(a,b){a.textureManager.load(b.chargingTexture)};He.create=function(a,b){return new He(a,b)};F.prototype.eCCreationMap[He.prototype.entityComponentName]=He;var ch=F.extend({entityComponentName:"ECChargeAttack",updatePeriod:0,sortPriority:4,
shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!0,parameters:{closeSpeedBoost:{description:"Speed boost when carrying out charge attack",type:"slider",defaultValue:0.5,minValue:0,maxValue:2},speedBoost:{description:"Speed boost when carrying out heavy charge attack",type:"slider",defaultValue:1,minValue:0,maxValue:2},bigChargeTimeThreshold:{description:"Min charge duration (s) for big damage",type:"slider",defaultValue:0.8,minValue:0,maxValue:10}},
init:function(a,b){this._super(a,b)},activate:function(){this._super();var a=this.getEntityEC("ECPhysicsSphere"),b=function(a){this.onImpact(a)}.bind(this);a&&a.addOnImpactCallback(b)},attemptAttack:function(a){this.targetEntity=a;this.startChargeTime=this.globals.gameCurrentTime;this.charging=!0},cancel:function(){this.targetEntity=void 0;this.charging=!1},update:function(){this._super();this.validateTarget();this.isChargeAttacking()&&this.getEntityEC("ECLocomotion").setDestination(this.destinationLocation,
!0)},validateTarget:function(){var a=this.globals.mathDevice;this.targetEntity&&(this.targetEntity.shouldBeDestroyed()?this.targetEntity=void 0:this.destinationLocation=a.v3Copy(this.targetEntity.getv3Location()))},isChargeAttacking:function(){return this.charging},getSpeedBoostFactor:function(){var a=this.archetype;return this.isChargeAttacking()?this.inBigCharge()?1+a.speedBoost:1+a.closeSpeedBoost:1},draw:function(){},drawDebug:function(){},isMovingTowards:function(a){var b=this.globals.mathDevice,
a=b.v3Sub(a.getv3Location(),this.getv3Location());b.v3Normalize(a,a);return-0.707>a[1]?!1:!0},onImpact:function(a){this.isMovingTowards(a)&&this.isChargeAttacking()&&this.applyCharge(a)},inBigCharge:function(){return this.globals.gameCurrentTime-this.startChargeTime>this.archetype.bigChargeTimeThreshold},applyCharge:function(a){var b,c=this.gameManager.actionManager;b=this.globals.mathDevice;var d=this.getEntityEC("ECPhysicsSphere"),d=b.v3Copy(d.getv3Velocity());b.v3Normalize(d,d);var f=this.gameManager.damager,
e="DAMAGE_TYPE_CHARGE_CLOSE";this.inBigCharge()&&(e="DAMAGE_TYPE_CHARGE");this.isManagedByThisMachine()&&f.archetypes[e].applyToArea(this.entity,b.v3Copy(d),this.getv3Location(),a);this.globals.gameManager.eventManager.notify("ChargeAttack",this.entity);this.playSound("chargeImpact");this.isManagedByThisMachine()&&(c.addAction("VisualEffect",{archetype:"charge",v3Location:b.v3Copy(this.getv3Location()),v3Direction:d}),c.addAction("VisualEffect",{archetype:"charge",v3Location:b.v3Copy(this.getv3Location())}));
this.targetEntity=void 0;this.charging=!1},serialize:function(a){this._super(a)},serializeDelta:function(){}});ch.create=function(a,b){return new ch(a,b)};F.prototype.eCCreationMap[ch.prototype.entityComponentName]=ch;var dh=F.extend({entityComponentName:"ECCloud",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldAlwaysUpdate:!0,shouldDraw:!1,shouldSerialize:!1,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,storeGlobalList:!1,parameters:{minSpeed:1,maxSpeed:1,minLife:100,maxLife:200},init:function(a,
b){this._super(a,b);var c=a.mathDevice,d=this.archetype;this.life=c.randomInRange(d.minLife,d.maxLife);this.speed=c.randomInRange(d.minSpeed,d.maxSpeed)},activate:function(){this._super();var a=this.globals.gameCurrentTime;this.startTime=a;this.deathTime=a+this.life;this.updateScale()},updatePosition:function(){var a=this.globals.mathDevice,b=(this.globals.gameCurrentTime-this.startTime-this.life/2)*this.speed,c=this.getEntityEC("ECMesh");c&&c.setLocalOffset(a.v3Build(b,0,b))},updateScale:function(){var a=
this.globals.gameCurrentTime,a=Math.min(a-this.startTime,this.deathTime-a),a=Math.min(a/20,1),b=this.getEntityEC("ECMesh");b&&b.setScale(a)},update:function(){this._super();this.globals.gameCurrentTime>this.deathTime?this.entity.setToBeDestroyed():(this.updatePosition(),this.updateScale())},draw:function(){},drawDebug:function(){},serialize:function(a){this._super(a)},serializeDelta:function(){},onDeath:function(){},onToBeDestroyed:function(){this._super()},destroy:function(){this._super()}});dh.create=
function(a,b){return new dh(a,b)};F.prototype.eCCreationMap[dh.prototype.entityComponentName]=dh;var eh=F.extend({entityComponentName:"ECDeathAgent",updatePeriod:0.1,sortPriority:4,shouldUpdate:!0,shouldAlwaysUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{minDistanceFromTarget:15,timeout:30},init:function(a,b){this._super(a,b);this.startedHealthDegeneration=!1},activate:function(){var a;this._super();(a=this.getEntityEC("ECHealth"))&&a.disableRegen()},
getMinDistanceFromTarget:function(){return this.archetype.minDistanceFromTarget},getTimeout:function(){return this.archetype.timeout},update:function(){this._super();!this.hasStartedHealthDegeneration()&&this.shouldStartHealthDegeneration()&&(this.startHealthDegeneration(),this.setToUpdate(!1))},hasStartedHealthDegeneration:function(){return this.startedHealthDegeneration},shouldStartHealthDegeneration:function(){return!this.hasStartedHealthDegeneration()&&(this.isWithinRangeOfTarget()||this.hasTimeoutPassed())},
isWithinRangeOfTarget:function(){var a=this.globals.mathDevice,b=this.getEntityEC("ECAgent"),c=this.getMinDistanceFromTarget(),d=!1;if(b&&(b=b.getTargetEntity()))a=a.v3Distance2DSq(this.getv3Location(),b.getv3Location()),d=a<=c*c;return d},hasTimeoutPassed:function(){var a=this.globals,b=this.getTimeout(),c=!1;0<=b&&(a=a.gameCurrentTime-this.entity.creationTime,a>=b&&(c=!0));return c},startHealthDegeneration:function(){var a;this.hasStartedHealthDegeneration()||(this.startedHealthDegeneration=!0,
(a=this.getEntityEC("ECHealth"))&&a.enableRegen())},onToBeDestroyed:function(){this._super()},destroy:function(){this._super()}});F.prototype.eCCreationMap[eh.prototype.entityComponentName]=eh;eh.create=function(a,b){return new eh(a,b)};var Ie=F.extend({entityComponentName:"ECDispenser",updatePeriod:5,sortPriority:4,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!0,realTime:!1,parameters:{showUnavailableDueToPrerequisites:!0,destroySelfOnDispense:!1,disableWhenCapReached:!1,
meshWhenCapReached:void 0},init:function(a,b){this._super(a,b);this.currentPrerequisitesMet=[];this.isValid=[]},activate:function(){this._super();this.attachHandlers();this.loadContents(this.archetype.contents);this.calculateBuildingParentEntity()},calculateBuildingParentEntity:function(){var a,b;if(a=this.getEntityEC("ECPlacedBuildingTracker"))this.buildingParentEntity=this.entity;else if(a=this.getEntityEC("ECAttach"))if(b=a.getParent())if(a=b.getEC("ECPlacedBuildingTracker"))this.buildingParentEntity=
b},attachHandlers:function(){var a=this.globals.gameManager.eventManager;this.buildingChangedCallback||(this.buildingChangedCallback=this.onBuildingChanged.bind(this),a.subscribe("BuildingChanged",this.buildingChangedCallback))},detachHandlers:function(){var a=this.globals.gameManager.eventManager;this.buildingChangedCallback&&(a.unsubscribe("BuildingChanged",this.buildingChangedCallback),this.buildingChangedCallback=void 0)},update:function(){this._super();this.evaluateProductInfo();this.setToUpdate(!1)},
updateButtonState:function(){this.evaluateProductInfo();this.setToUpdate(!1)},onBuildingChanged:function(){this.setToUpdate(!0);this.setUpdatePeriod(1.1)},getRadialMenuButtonCount:function(){if(this.archetype.showUnavailableDueToPrerequisites)return this.contents.length;var a=0,b;for(b=0;b<this.contents.length;b+=1)this.arePrerequisitesMet(b)&&(a+=1);return a},remapRadialMenuIndexToContentIndex:function(a){if(this.archetype.showUnavailableDueToPrerequisites)return a;var b=0,c;for(c=0;c<this.contents.length;c+=
1)if(this.arePrerequisitesMet(c)){if(b===a)return c;b+=1}return-1},getGuiArchetype:function(a,b,c){var d=this.getSecondaryResourceCost(a),a=this.getSoftCurrencyCost(a);return 0<d?b?c?"buildStone":"buildInvalidStoneCantAfford":"buildInvalidStone":0<a?b?c?"buildAmber":"buildInvalidAmberCantAfford":"buildInvalidAmber":b?c?"buildLumber":"buildInvalidLumberCantAfford":"buildInvalidLumber"},doRadialMenuButton:function(a,b,c,d){var f=this.globals.currentLanguage,d=this.remapRadialMenuIndexToContentIndex(d),
e=this.getDispenseCap(d),h=this.getDispensedCount(d),i;i=this.gameManager.buildingManager;var j=f.GAME_HUD_BUILD+" "+this.getDispenseName(d);1<e&&(j=j+" ("+h+"/"+e+")");var k=this.numberToCommaString(this.getResourceCost(d)),l=this.numberToCommaString(this.getSecondaryResourceCost(d)),m=this.numberToCommaString(this.getSoftCurrencyCost(d)),q=this.formatTimeToString(this.getBuildTime(d),!0),p=!0,s=this.canAfford(b,d),t=this.getValid(d),u=this.getGuiArchetype(d,t,s);s&&t?a.doButton({id:"ecRadialMenu"+
this.entity.getName()+"Build"+d,text1:j,text2:k,text3:l,text4:m,text5:q,v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:u})&&(this.getUsesInfiniteBuildMode(d)||this.payForDispensedEntity(b,d),this.dispenseToEntity(b,d)):(this.arePrerequisitesMet(d)||(p=this.archetype.showUnavailableDueToPrerequisites,(i=i.getPrerequisitesDescription(this.getPrerequisites(d)))&&(j=j+"\n"+i+" "+f.GAME_HUD_REQUIRED)),e===h?j=(j=this.getBuildingToUpgradeToIncreaseBuildingCap(d))?f.GAME_HUD_UPGRADE+" "+j.name+
" "+f.GAME_HUD_TO_LEVEL+" "+j.level+"\n"+f.GAME_HUD_TO_BUILD_MORE+" "+this.getDispenseName(d)+f.GAME_HUD_PLURAL_S:f.GAME_HUD_MAXIMUM+" "+this.getDispenseName(d)+f.GAME_HUD_PLURAL_S+" "+f.GAME_HUD_BUILT:this.hasFailedScaffoldCap(d)&&(j=f.GAME_HUD_CANT_BUILD),p&&a.doButton({id:"ecRadialMenu"+this.entity.getName()+"Build Unavailable"+d,text1:j,text2:k,text3:l,text4:m,text5:q,v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:u})&&this.arePrerequisitesMet(d)&&(h<e&&!this.hasFailedScaffoldCap(d))&&
this.openPurchaseShop(b,d))},getBuildingToUpgradeToIncreaseBuildingCap:function(a){var b=this.gameManager.getBuildingManager(),a=this.getProductInfo(a),c,d=this.entity;a&&((c=d.getEC("ECAttach"))&&(d=c.getBaseEntity()),c=b.getBuildingToUpgradeToIncreaseBuildingCap(a.buildingType,d));return c},openPurchaseShop:function(a,b){var c=this.gameManager,d=Wa.create(c,this.globals),f=this;c.setGameState(d);var e=this.getUsesInfiniteBuildMode(b)&&1<this.getMaxLinePlacementLength(b)?this.getMaxLinePlacementLength(b):
1,c=this.getResourceCost(b),h=this.getSecondaryResourceCost(b),i=a.getEC("ECPlayerData");i&&1<e&&(0<c&&(e=Math.min(e,i.getResourceCap(E.LUMBER)/c)),0<h&&(e=Math.min(e,i.getResourceCap(E.STONE)/h)),e=Math.max(e,1));0<this.getSoftCurrencyCost(b)?d.setButtonPanal("purchase"):(d.setPurchaseFn(function(){f.dispenseToEntity(a,b,1===e)}),d.setRequiredResource(E.LUMBER,c*e),d.setRequiredResource(E.STONE,h*e),c="purchaseBuilding_"+this.getDispensedArchetypeName(b),d.setPurchaseReason(c),d.setGiveUserResource(1<
e),d.setButtonPanal("convert"))},draw:function(){},setContentIndex:function(a){this.contentIndex!==a&&(this.contentIndex=a,(a=this.getEntityEC("ECWorldText"))&&(this.contentIndex>=this.contents.length?a.setText2(""):a.setText2(this.getDispenseName())))},loadContents:function(a){this.contents=a;var b=this.gameManager.getEntityFactory(),c=a.length,d,f,e;for(d=0;d<c;d+=1)f=b.getECArchetype(a[d].dispensedArchetypeName,"ECBuilding"),e=this.contents[d],e.resourceCost=f?f.resourceCost:99,e.secondaryResourceCost=
f?f.secondaryResourceCost:99,e.softCurrencyCost=f?f.softCurrencyCost:0,e.prerequisites=f?f.prerequisites:[],e.buildingType=f?f.buildingType:"",e.obeysScaffoldCap=f?f.obeysScaffoldCap:!0,e.scaffoldType=f?f.scaffoldType:"normal",e.usesInfiniteBuildMode=f?f.usesInfiniteBuildMode:!1,e.buildTime=f?f.buildTime:0,e.maxLinePlacementLength=f?f.maxLinePlacementLength:0;this.setContentIndex(0)},getValid:function(a){return this.isValid[a]},arePrerequisitesMet:function(a){return this.currentPrerequisitesMet[a]},
hasFailedScaffoldCap:function(a){var b=this.gameManager,c;if(a=this.getProductInfo(a))c=a.obeysScaffoldCap;return b&&a&&(b=b.getBuildingManager())&&c&&b.hasReachedScaffoldCap(a.scaffoldType)?!0:!1},getPrerequisites:function(a){return(a=this.getProductInfo(a))?a.prerequisites:null},calculatePrerequisitesMet:function(a){var b=this.gameManager,c=!1;b&&a&&(b=b.getBuildingManager())&&(c=b.arePrerequisitesMet(a.prerequisites));return c},calculateIsValid:function(a,b){var c=this.gameManager,d,f,e,h;d=!1;
if(c&&a&&(c=c.getBuildingManager()))d=b?void 0:a.prerequisites,f=a.buildingType,e=a.obeysScaffoldCap,h=a.scaffoldType,d=c.canCreateBuilding(f,this.buildingParentEntity,d,e,h,this.archetype.destroySelfOnDispense);return d},calculateHasReachedCap:function(a){var b=this.gameManager,c;if(b&&a){if(b=b.getBuildingManager())c=a.buildingType;return 0===b.getRemainingBuildingsBeforeCap(c,this.buildingParentEntity)}return 0},hasZeroCaps:function(a){var b=this.gameManager,c;if(b&&a){if(b=b.getBuildingManager())c=
a.buildingType;return 0===b.getBuildingCapUsingParent(c,this.buildingParentEntity)}return 0},evaluateProductInfo:function(){var a=this.contents.length,b,c,d=0,f=0;if(0<a)for(b=0;b<a;b+=1)c=this.contents[b],this.calculatePrerequisitesMet(c)?(this.currentPrerequisitesMet[b]=!0,this.isValid[b]=this.calculateIsValid(c,!0)):(this.currentPrerequisitesMet[b]=!1,this.isValid[b]=!1),this.calculateHasReachedCap(c)&&(d+=1),this.hasZeroCaps(c)&&(f+=1);(this.archetype.disableWhenCapReached||this.archetype.meshWhenCapReached)&&
this.setCapReached(d===a,f===a)},setCapReached:function(a,b){a!==this.capReached&&(a?this.applyCapReachedBehaviour(b):this.unapplyCapReachedBehaviour(),this.capReached=a)},applyCapReachedBehaviour:function(a){var b=this.getEntityEC("ECSelectable");if(this.archetype.disableWhenCapReached||a)b.setPermanentValid(!1),this.hasSetInvalid=!0;a=this.getEntityEC("ECMesh");this.archetype.meshWhenCapReached&&(this.prevMesh=a.getMeshPath(),a.loadMesh(this.archetype.meshWhenCapReached),a.update())},unapplyCapReachedBehaviour:function(){var a=
this.getEntityEC("ECSelectable");this.hasSetInvalid&&(a.setPermanentValid(!0),this.hasSetInvalid=!1);a=this.getEntityEC("ECMesh");this.prevMesh&&(a.loadMesh(this.prevMesh),a.update())},payForDispensedEntity:function(a,b){var c=a.getEC("ECPlayerData");if(this.getValid(b)&&this.getProductInfo(b)){var d=this.getResourceCost(b),f=this.getSecondaryResourceCost(b),e=this.getSoftCurrencyCost(b);c.adjustResource(E.LUMBER,-d);c.adjustResource(E.STONE,-f);c.adjustSoftCurrency(-e);c=this.gameManager.getGuiManager();
c.addResourceBubble(this.getv3Location(),-d,E.LUMBER);c.addResourceBubble(this.getv3Location(),-f,E.STONE)}},dispenseToEntity:function(a,b,c){var d=a.getEC("ECPlayerBuilder"),a=a.getEC("ECLocomotion");if(this.getValid(b)){var f=this.getProductInfo(b);if(f){var f=f.dispensedArchetypeName,e=this.getQuantityPerPurchase(b),b=this.getUsesInfiniteBuildMode(b),h=this.buildingParentEntity,i=this.getEntityEC("ECBuilding");this.archetype.destroySelfOnDispense&&(h=i.getBuildingParentEntity());d&&(d.getHeldObjectName()!==
f?d.placeInHand(f,e,!1,b&&!c,h,!0):!b&&this.isStackableInHand()&&d.increaseQuantityOfHeldObject(e),this.archetype.destroySelfOnDispense&&d.setCannotCancel(!0),a&&(a.clearDestination(),a.clearDestinationEntity()));(c=this.getEntityEC("ECSelectable"))&&c.setActivated(!1);this.archetype.destroySelfOnDispense&&this.entity.setToBeDestroyed()}}},getProductInfo:function(a){return a<this.contents.length?this.contents[a]:null},getDispenseName:function(a){return(a=this.getProductInfo(a))?a.dispenseName:""},
getDispenseArchetypeName:function(a){return(a=this.getProductInfo(a))?a.dispensedArchetypeName:""},getDispensedCount:function(a){var a=this.getProductInfo(a),b=this.gameManager.getBuildingManager();return a?b.getBuildingCountUsingParent(a.buildingType,this.buildingParentEntity):0},getDispenseCap:function(a){var a=this.getProductInfo(a),b=this.gameManager.getBuildingManager();return a?b.getBuildingCapUsingParent(a.buildingType,this.buildingParentEntity):0},isStackableInHand:function(a){return(a=this.getProductInfo(a))?
a.stackableInHand:!1},getQuantityPerPurchase:function(a){return(a=this.getProductInfo(a))?a.quantityPerPurchase:1},canAfford:function(a,b){var c,d=this.getResourceCost(b),f=this.getSecondaryResourceCost(b),e=this.getSoftCurrencyCost(b);return(c=a.getEC("ECPlayerData"))?c.getResource(E.LUMBER)>=d&&c.getResource(E.STONE)>=f&&c.getSoftCurrency()>=e:!1},getResourceCost:function(a){return(a=this.getProductInfo(a))?a.resourceCost:1},getSecondaryResourceCost:function(a){return(a=this.getProductInfo(a))?
a.secondaryResourceCost:1},getSoftCurrencyCost:function(a){return(a=this.getProductInfo(a))?a.softCurrencyCost:0},getBuildTime:function(a){return(a=this.getProductInfo(a))?a.buildTime:0},getDispensedArchetypeName:function(a){return(a=this.getProductInfo(a))?a.dispensedArchetypeName:null},getMaxLinePlacementLength:function(a){return(a=this.getProductInfo(a))?a.maxLinePlacementLength:0},getUsesInfiniteBuildMode:function(a){return(a=this.getProductInfo(a))?a.usesInfiniteBuildMode:!1},drawDebug:function(){},
saveSerialize:function(){return{contentIndex:this.contentIndex}},serialize:function(a){this._super(a);a.contentIndex=this.contentIndex},destroy:function(){this.detachHandlers();this._super()},serializeDelta:function(){},deserialize:function(a){this._super(a);this.setContentIndex(this.contentIndex)}});Ie.preloadComponent=function(a,b){var c=a.simpleSceneLoader,d=Sa.create({name:"temp",dynamic:!1,disabled:!0});b.meshWhenCapReached&&(c.isLoadingMesh(b.meshWhenCapReached)||c.load(b.meshWhenCapReached,
void 0,void 0,d))};Ie.create=function(a,b){return new Ie(a,b)};F.prototype.eCCreationMap[Ie.prototype.entityComponentName]=Ie;var fh=F.extend({entityComponentName:"ECEntityDispenser",updatePeriod:1,sortPriority:4,shouldUpdate:!0,shouldAlwaysUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!0,realTime:!1,parameters:{resourceCost:0,secondaryResourceCost:0,cooldownTime:0,readyGuiArchetype:"welcomeAmber",refillingGuiArchetype:"dispenseProgressBar",startCooldownTime:0,useRadial:!0,
drawCooldown:!1,dispenseSFX:"none"},init:function(a,b){this._super(a,b);this.dailyCount=this.cooldownTimeRemaining=0},activate:function(){this._super();var a=function(a){this.onInteract(a)}.bind(this),b=this.entity.getEC("ECInteractable");b&&b.setOnInteractCallback(a);("none"!==this.archetype.readyGuiArchetype||this.archetype.drawCooldown)&&this.setToDraw(!0)},onInteract:function(a){this.isCoolingDown()||this.dispenseToEntity(a)},update:function(){this._super();var a=this.gameManager,b=this.getTimeSinceLastUpdate(),
b=b+a.getAdditionalTimeFromSave();this.isCoolingDown()&&this.decrementCooldownTimer(b);(a=this.getEntityEC("ECBuilding"))&&a.disableMovement(!this.isCoolingDown())},drawCooldownIfHot:function(){var a=this.getEntityEC("ECSelectable");a&&a.isHot()&&this.drawCooldown()},drawCooldown:function(){var a=Math.floor(this.getCooldownTimeRemaining());if(!(0>=this.getCooldownTime())){var b=this.globals.mathDevice.v3Copy(this.getv3Location());b[1]+=2;this.gameManager.getGuiManager().addDrawGui(this.archetype.refillingGuiArchetype,
{v3WorldLocation:b,text:this.formatTimeToString(a),completeFactor:1-a/this.getCooldownTime()},"idCooldown"+this.entity.getName())}},shouldUseRadial:function(){return!this.isCoolingDown()&&this.archetype.useRadial},getIndexToDispense:function(){return Math.min(this.dailyCount,this.archetype.contents.length-1)},draw:function(){var a=this.gameManager;a.isPaused()||(this.isCoolingDown()?this.archetype.drawCooldown&&this.drawCooldownIfHot():(a=a.getGuiManager())&&a.addDrawGui("welcomeAmber",{v3WorldLocation:this.getv3Location(),
layer:-2},"idECEntityDispenser"+this.entity.getName()))},createTempData:function(){return{cooldownTimeRemaining:this.cooldownTimeRemaining,dailyCount:this.dailyCount}},applyTempData:function(a){a&&(this.cooldownTimeRemaining=a.cooldownTimeRemaining,this.dailyCount=a.dailyCount)},getDispensedArchetypeName:function(a){return this.archetype.contents[a].archetype},getDispensedArchetypeCount:function(a){return this.archetype.contents[a].quantity},getDispenseName:function(){return this.archetype.dispenseName},
getResourceCost:function(){return this.archetype.resourceCost},getSecondaryResourceCost:function(){return this.archetype.secondaryResourceCost},getCooldownTime:function(){return this.archetype.cooldownTime},getCooldownTimeRemaining:function(){return this.cooldownTimeRemaining},isCoolingDown:function(){return 0<this.getCooldownTimeRemaining()},startCooldownTimer:function(){this.cooldownTimeRemaining=this.archetype.cooldownTime},decrementCooldownTimer:function(a){this.cooldownTimeRemaining-=a;0>this.cooldownTimeRemaining&&
(this.dailyCount=-172800>this.cooldownTimeRemaining?0:this.dailyCount+1,this.cooldownTimeRemaining=0)},manageLargeTimeStep:function(a){this._super(a);this.decrementCooldownTimer(a)},dispenseToEntity:function(a){var b=a.getEC("ECPlayerData"),c=this.getResourceCost(),d=this.getSecondaryResourceCost(),f=this.getIndexToDispense();this.canDispenseToEntity(a)&&("none"!==this.archetype.dispenseSFX&&this.playEffect(this.archetype.dispenseSFX),b&&(a=this.gameManager.getGuiManager(),0<c&&(b.adjustResource(E.LUMBER,
-c),a.addResourceBubble(this.getv3Location(),-c,E.LUMBER)),0<d&&(b.adjustResource(E.STONE,-d),a.addResourceBubble(this.getv3Location(),-d,E.STONE))),this.spawnDispensedEntity(this.getDispensedArchetypeCount(f),this.getDispensedArchetypeName(f)),this.startCooldownTimer(),this.gameManager.forceLevelSave())},spawnDispensedEntity:function(a,b){var c=this.gameManager,d=c.getEventManager(),c=c.getEntityFactory(),f=this.getv3Location();d.notify("EntitiesDispensed",{dispenser:this.entity,number:a,dispensedArchetype:b});
for(var e,h,d=0;d<a;d+=1)if(e=c.createActiveEntityInstance("DispensedEntity_"+b,b,f),e.setGameSpace(this.entity.getGameSpace()),e=e.getEC("ECFaction"))if(h=this.getEntityEC("ECFaction"))(h=h.getFactionName())&&e.setFaction(h)},canAfford:function(a){var b=this.getResourceCost(),c=this.getSecondaryResourceCost();return(a=a.getEC("ECPlayerData"))?a.getResource(E.LUMBER)>=b&&a.getResource(E.STONE)>=c:!0},isRadialMenuButtonActive:function(a){return this.canDispenseToEntity(a)},canDispenseToEntity:function(a){return!this.isCoolingDown()&&
this.canAfford(a)},doRadialMenuButton:function(a,b,c){var d=this.isRadialMenuButtonActive(b),f=this.getDispenseName(),e=this.globals.currentLanguage.GAME_HUD_DISPENSE+"  \n"+this.getDispenseName(),h=this.getResourceCost().toString(),i=this.getSecondaryResourceCost().toString();d?a.doButton({id:"ecRadialMenu"+this.entity.getName()+this.globals.currentLanguage.GAME_HUD_DISPENSE,text:f,text1:e,text2:h,text3:i,v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:"dispense"})&&this.dispenseToEntity(b):
(this.isCoolingDown()&&(e=e+"\n "+this.globals.currentLanguage.GAME_HUD_COOL_DOWN+": "+Math.ceil(this.getCooldownTimeRemaining())+this.globals.currentLanguage.GAME_HUD_PLURAL_S),a.doButton({id:"ecRadialMenu"+this.entity.getName()+"Dispense Unavailable",text:f,text1:e,text2:h,text3:i,v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:"dispenseInvalid"}))},drawDebug:function(){},serialize:function(a){this._super(a)},destroy:function(){this._super()},serializeDelta:function(){},saveSerialize:function(){return{cooldownTimeRemaining:this.cooldownTimeRemaining,
dailyCount:this.dailyCount}},deserialize:function(a){this._super(a)}});fh.create=function(a,b){return new fh(a,b)};F.prototype.eCCreationMap[fh.prototype.entityComponentName]=fh;var gh=F.extend({entityComponentName:"ECEntitySpawnManager",updatePeriod:10,sortPriority:4,shouldUpdate:!0,shouldAlwaysUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!0,realTime:!0,parameters:{minTimeBetweenAddingNewEntity:120,maxTimeBetweenAddingNewEntity:300,maxEntities:4,randomGenerateRadius:5},
init:function(a,b){this._super(a,b);this.globals=a;this.gameManager=a.gameManager;this.entityList=[];this.packedEntityList=[];this.previousEntityCreationTime=this.currentCombatManager=null;this.previousEntityCreationTime=this.globals.gameCurrentTime;this.entityArchetypes=this.safeCopy(b.entityArchetypes,[{likelihood:1,archetype:"a_r_rock01"}]);this.buildTotalLikelihood();this.countDownTimer=this.globals.mathDevice.randomIntInRange(this.archetype.minTimeBetweenAddingNewEntity,this.archetype.maxTimeBetweenAddingNewEntity);
this.pause=!1},draw:function(){},buildTotalLikelihood:function(){var a=this.entityArchetypes,b=a.length,c;for(c=this.totalLikelihood=0;c<b;c+=1)this.totalLikelihood+=a[c].likelihood},getArchetypeToSpawn:function(){var a=this.entityArchetypes,b=a.length,c,d=Math.random(this.totalLikelihood),f=0;for(c=0;c<b;c+=1)if(f+=a[c].likelihood,d<=f)return a[c].archetype;return a[b-1].archetype},drawDebug:function(){var a=this.globals.debugDraw,b=this.debugSpawnLocationColour,c=this.debugEntityLocationLineColour,
d=this.getv3Location();a.drawDebugPoint(d,b[0],b[1],b[2]);var b=this.entityList,f=b.length,e;for(e=0;e<f;e+=1){var h=b[e].getv3Location();a.drawDebugLine(d,h,c[0],c[1],c[2])}this.drawDebugText()},drawDebugText:function(){var a=this.globals,b=a.mathDevice,c=a.simpleFontRenderer,d=a.camera.worldToScreen(b.v3Add(this.getv3Location(),b.v3Build(0,1.5,0))),a="Entitys : "+this.getNumberOfEntitys()+"/"+this.getmaxEntities(),b="New entity in: "+this.formatTimeToString(this.getTimeToNextEntityCreation()),f=
[1,1,1];void 0!==d&&(d={x:d[0],y:d[1]+-10,pointSize:16,alignment:1,r:f[0],g:f[1],b:f[2]},c.drawFontDouble(a,d),d.y+=20,c.drawFontDouble(b,d))},pauseEntityPlacement:function(){this.pause=!0},unPauseEntityPlacement:function(){this.pause=!1},update:function(){this.updateActiveEntitys();var a=0;this.getNumberOfEntitys()<this.getmaxEntities()?(this.gameManager.pauseEntitys?this.pauseEntityPlacement():this.unPauseEntityPlacement(),a=this.updateCountdownTimer(),0<a&&this.placeNewEntities(a)):this.pauseEntityPlacement()},
getNumberOfEntitys:function(){return this.entityList.length},getmaxEntities:function(){return this.archetype.maxEntities},getEntityList:function(){return this.entityList},getType:function(){return this.type},getTimeToNextEntityCreation:function(){return this.countDownTimer},debugSpawnLocationColour:[1,1,0],debugSpawnLocationLineColour:[0.25,0.25,0],debugEntityLocationLineColour:[0.75,0.75,0],updateCountdownTimer:function(){var a=this.globals.mathDevice,b=this.getTimeSinceLastUpdate(),c=this.gameManager.getAdditionalTimeFromSave();
this.countDownTimer-=b+c;for(b=0;0>this.countDownTimer;)b+=1,this.countDownTimer+=a.randomIntInRange(this.archetype.minTimeBetweenAddingNewEntity,this.archetype.maxTimeBetweenAddingNewEntity);return b},getv3SpawnLocation:function(){var a=this.globals.mathDevice,a=a.v3Add(this.getv3Location(),a.v3BuildRandomCircle(this.archetype.randomGenerateRadius)),b=this.gameManager;return!b?a:a=b.placeOnGround(a,0.5)},placeNewEntities:function(a){var b;for(b=0;b<a;b+=1)this.placeNewEntity()},placeNewEntity:function(){if(!(this.entityList.length>=
this.getmaxEntities())){var a=this.gameManager.getEntityFactory(),b=this.getArchetypeToSpawn(),c=this.getv3SpawnLocation(),a=a.createActiveEntityInstance(b,b,c);a.shouldLevelSave=!1;this.entityList.push(a)}},updateActiveEntitys:function(){var a=this.getEntityList(),b,c;for(c=0;c<a.length;c+=1)b=a[c],b.toBeDestroyed&&(a.splice(c,1),c-=1)},saveSerialize:function(){return{countDownTimer:this.countDownTimer,entityList:this.packEntityList(this.entityList)}},serialize:function(a){this._super(a);a.countDownTimer=
this.countDownTimer;a.entityList=this.packEntityList(this.entityList)},serializeDelta:function(){},deserialize:function(a){this._super(a)},destroy:function(){this._super()}});gh.create=function(a,b){return new gh(a,b)};F.prototype.eCCreationMap[gh.prototype.entityComponentName]=gh;var hh=F.extend({entityComponentName:"ECEffectSpawner",updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!1,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,storeGlobalList:!1,parameters:{onCreateEffect:"none",
onDestroyEffect:"none",onDeathEffect:"none",ambientEffect:"none",incidentalEffect:"none",incidentalMinTime:10,incidentalMaxTime:20,impactEffect:"none"},init:function(a,b){this._super(a,b)},activate:function(){this._super();0.25<this.globals.gameCurrentTime&&("none"!==this.archetype.onCreateEffect&&this.playEffect(this.archetype.onCreateEffect),"none"!==this.archetype.ambientEffect&&this.playEffect(this.archetype.ambientEffect));"none"!==this.archetype.incidentalEffect&&this.prepareIncidentalEffect()},
prepareIncidentalEffect:function(){"none"!==this.archetype.incidentalEffect&&(this.setToUpdate(!0),this.setUpdatePeriod(this.archetype.incidentalMinTime+Math.random()*this.archetype.incidentalMaxTime))},onTakeDamage:function(){"none"!==this.archetype.impactEffect&&this.playEffect(this.archetype.impactEffect)},update:function(){this._super();this.playEffect(this.archetype.incidentalEffect);this.prepareIncidentalEffect()},draw:function(){},drawDebug:function(){},serialize:function(a){this._super(a)},
serializeDelta:function(){},onDeath:function(){"none"!==this.archetype.onDeathEffect&&this.playEffect(this.archetype.onDeathEffect)},onToBeDestroyed:function(){this._super();"none"!==this.archetype.ambientEffect&&this.stopEffect(this.archetype.ambientEffect);"none"!==this.archetype.onDestroyEffect&&this.playEffect(this.archetype.onDestroyEffect)},destroy:function(){this._super()}});hh.create=function(a,b){return new hh(a,b)};F.prototype.eCCreationMap[hh.prototype.entityComponentName]=hh;var ih=F.extend({entityComponentName:"ECExplode",
updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!0,parameters:{damageType:-1,explodeOnDeath:!0,sfxArchetype:"sfx_explosion"},init:function(a,b){this._super(a,b)},explode:function(){var a=this.gameManager.damager,b=this.getv3Location(),c=this.archetype;this.isManagedByThisMachine()&&("DAMAGE_TYPE_NONE"!==c.damageType&&""!==c.damageType&&a.archetypes[c.damageType].applyToArea(this.entity,null,b),c.sfxArchetype&&this.entity.playEffect(c.sfxArchetype))},
onKilled:function(){this.archetype.explodeOnDeath&&this.explode()},onToBeDestroyed:function(){this._super()},update:function(){this._super()},draw:function(){},drawDebug:function(){},serialize:function(a){this._super(a)},serializeDelta:function(){}});ih.create=function(a,b){return new ih(a,b)};F.prototype.eCCreationMap[ih.prototype.entityComponentName]=ih;var jh=F.extend({entityComponentName:"ECExchanger",updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,
shouldSave:!1,realTime:!0,parameters:{heroCollide:{description:"Hero Collision",defaultValue:!0},agentCollide:{description:"Agent Collision",defaultValue:!0},wildlingCollide:void 0,selfDamage:-1,otherDamage:-1,killSelf:!1,selfRepeatTime:0,otherRepeatTime:0,selfRepeatLimit:-1,otherRepeatLimit:-1},init:function(a,b){this._super(a,b);this.otherRepeatCount=this.selfRepeatCount=this.otherRepeatTime=this.selfRepeatTime=0},activate:function(){this._super();var a=this.entity.getEC("ECPhysicsCube"),b=this.entity.getEC("ECPhysicsSphere"),
c=function(a){this.onImpact(a)}.bind(this);a&&a.setOnImpactCallback(c);b&&b.addOnImpactCallback(c)},shouldCollideWithWildlings:function(){var a=this.archetype.wildlingCollide;return void 0!==a?a:this.archetype.agentCollide},onImpact:function(a){var b=this.archetype;b.heroCollide&&a.hasEC("ECHero")&&this.applyDamagers(a);(b.agentCollide&&a.hasEC("ECAgent")||this.shouldCollideWithWildlings()&&a.hasEC("ECWildlingAgent"))&&this.applyDamagers(a)},applyDamagers:function(a){var b=this.archetype;if(this.isManagedByThisMachine()){var c=
this.gameManager.actionManager,d=this.getv3Location(),f=this.globals.gameCurrentTime,e;if(-1!==b.selfDamage||b.killSelf)if(f-this.selfRepeatTime>b.selfRepeatTime&&(0>b.selfRepeatLimit||this.selfRepeatCount<b.selfRepeatLimit))b.killSelf?(e=this.getEntityEC("ECHealth"))&&e.killSelf():c.addAction("ApplyDamageToEntity",{damageType:b.selfDamage,victim:this.entity,aggressor:this.entity,v3InputOrigin:d}),this.selfRepeatTime=f,this.selfRepeatCount+=1;if(-1!==b.otherDamage&&f-this.otherRepeatTime>b.otherRepeatTime&&
(0>b.otherRepeatLimit||this.otherRepeatCount<b.otherRepeatLimit))c.addAction("ApplyDamageToEntity",{damageType:b.otherDamage,victim:a,aggressor:this.entity,v3InputOrigin:d}),this.otherRepeatTime=f,this.otherRepeatCount+=1}},update:function(){this._super()},draw:function(){},drawDebug:function(){},serialize:function(a){this._super(a)},serializeDelta:function(){}});jh.create=function(a,b){return new jh(a,b)};F.prototype.eCCreationMap[jh.prototype.entityComponentName]=jh;var kh=F.extend({entityComponentName:"ECFaction",
updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!0,shouldLevelSave:!0,realTime:!1,parameters:{},init:function(a,b){this._super(a,b);this.deserializedFactionName=null},activate:function(){this._super();this.deserializedFactionName&&(this.setFaction(this.deserializedFactionName),this.deserializedFactionName=null)},setFaction:function(a){var b=this.gameManager.getFactionManager(),c=this.factionName,d=this.entity;a!==c&&(this.factionName=
a,c&&b.removeEntityFromFaction(this.entity,c),b.addEntityToFaction(this.entity,a),d&&(b=function(b){b&&(b=b.getEC("ECFaction"))&&b.setFaction(a)},d.applyToChildren(b)))},getHQ:function(){return this.gameManager.getFactionManager().getFactionByName(this.getFactionName()).getHQ()},getFactionName:function(){return this.factionName},getFaction:function(){return this.gameManager.getFactionManager().getFactionByName(this.getFactionName())},update:function(){this._super()},draw:function(){},drawDebug:function(){var a=
this.globals,b=a.mathDevice,c=a.simpleFontRenderer,b=a.camera.worldToScreen(b.v3Add(this.getv3Location(),b.v3Build(0,1.5,0))),a="Faction: "+this.getFactionName(),d=[1,1,1];void 0!==b&&(b={x:b[0],y:b[1]+-10,pointSize:16,alignment:1,r:d[0],g:d[1],b:d[2]},c.drawFontDouble(a,b))},saveSerialize:function(){return{currentFactionName:this.factionName}},serialize:function(a){this._super(a);a.currentFactionName=this.factionName},deserialize:function(a){this._super(a);a.currentFactionName!==this.factionName&&
(this.deserializedFactionName=a.currentFactionName)},serializeDelta:function(){},onToBeDestroyed:function(){this._super();var a=this.gameManager.getFactionManager();this.factionName&&a.removeEntityFromFaction(this.entity,this.factionName)}});kh.create=function(a,b){return new kh(a,b)};F.prototype.eCCreationMap[kh.prototype.entityComponentName]=kh;var tb=F.extend({entityComponentName:"ECFirearm",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldDraw:!0,shouldSerialize:!0,shouldDeltaSerialize:!0,
shouldSave:!1,realTime:!1,parameters:{shootOffset:{description:"Where projectiles will emerge",defaultValue:[0,0,0],minValue:-1,maxValue:1,step:0.1},drawWeaponRadius:!1},init:function(a,b){this._super(a,b);var c=this.safeCopy(b.weapon,"wp_h_pistol");this.setWeapon(c);this.ammoChangedTime=this.rechamberTimer=this.reloadTimer=0;this.ammoVisible=!0;this.canFireDuration=0;this.reloadSpeedFactor=this.damageFactor=1;this.hasShootOffset=!this.globals.mathDevice.v3IsZero(this.archetype.shootOffset)},setDamageFactor:function(a){this.damageFactor=
a},getReloadSpeedFactor:function(){return this.reloadSpeedFactor},setReloadSpeedFactor:function(a){this.reloadSpeedFactor=a},getReloadDuration:function(){var a=this.reloadDuration,b=this.getReloadSpeedFactor();0.01<b&&(a/=b);return a},activate:function(a,b){this._super(a,b);var c=this.getEntityEC("ECInventory");c&&c.equipWeapon(this.mainWeaponName)},update:function(){this._super();this.updateRechamber();this.updateReload();this.updateAutoReload();this.updateCanFireDuration();this.shouldDrawWeaponRadius()&&
this.drawWeaponRadius()},updateRechamber:function(){0<this.rechamberTimer&&(this.rechamberTimer-=this.getTimeSinceLastUpdate(),0>=this.rechamberTimer&&this.playCock())},updateAutoReload:function(){this.ammo!==this.getClipSize()&&!this.isReloading()&&(void 0!==this.autoReloadTime?this.globals.gameCurrentTime>this.autoReloadTime&&(this.beginReload(),this.autoReloadTime=void 0,this.onAmmoChange()):(this.autoReloadTime=this.globals.gameCurrentTime+3,this.onAmmoChange()))},updateCanFireDuration:function(){this.canFireDuration=
this.getCanFire()?this.canFireDuration+this.getTimeSinceLastUpdate():0},getCanFireDuration:function(){return this.canFireDuration},getReloadedBullets:function(){var a=this.globals.mathDevice,b=a.getFactor(this.getReloadDuration(),0,this.reloadTimer);return Math.floor(a.lerp(0,this.getClipSize(),b))},updateReload:function(){var a,b;0<this.reloadTimer&&(a=this.getReloadedBullets(),this.reloadTimer-=this.getTimeSinceLastUpdate(),b=this.getReloadedBullets(),b>a&&this.playReload(),0>=this.reloadTimer&&
this.instantReload())},shouldDrawWeaponRadius:function(){var a,b=!1;if(this.archetype.drawWeaponRadius&&(a=this.gameManager.getHero()))(a=a.getEC("ECPlayerBuilder"))&&(a.isBuilding()&&0<a.getHeldEntityWeaponRange())&&(b=!0);return b},drawWeaponRadius:function(a,b,c){var d=this.globals,f=d.simpleSpriteRenderer,d=d.mathDevice,e,h,i,j;void 0===c&&(c=this.getMaxRange());void 0===b&&(b=this.getMinRange());0<c&&(f&&d)&&(h=a?d.v3Copy(a):this.getv3BaseLocation(),h[1]+=0.01,e=d.v3Build(0,1,0),i=d.v3BuildZero(),
j=d.v3BuildZero(),e={v3Location:i,size:0.5*c,blendStyle:ua.prototype.blendStyle.NORMAL,texture:this.getWeaponRadiusQuarterTexturePath(),angle:0,out:e},d.v3Build(0.5*c,0,0.5*c,j),d.v3Add(h,j,i),f.addSprite(e),d.v3Build(-0.5*c,0,0.5*c,j),e.angle=0.5*Math.PI,d.v3Add(h,j,i),f.addSprite(e),d.v3Build(-0.5*c,0,-0.5*c,j),e.angle=Math.PI,d.v3Add(h,j,i),f.addSprite(e),d.v3Build(0.5*c,0,-0.5*c,j),e.angle=1.5*Math.PI,d.v3Add(h,j,i),f.addSprite(e));0<b&&(f&&d)&&(h=a?d.v3Copy(a):this.getv3BaseLocation(),h[1]+=
0.01,e=d.v3Build(0,1,0),i=d.v3BuildZero(),j=d.v3BuildZero(),e={v3Location:i,size:b,blendStyle:ua.prototype.blendStyle.NORMAL,texture:this.getMinWeaponRadiusQuarterTexturePath(),angle:0,out:e},d.v3Build(1*b,0,1*b,j),d.v3Add(h,j,i),f.addSprite(e),d.v3Build(-1*b,0,1*b,j),e.angle=0.5*Math.PI,d.v3Add(h,j,i),f.addSprite(e),d.v3Build(-1*b,0,-1*b,j),e.angle=Math.PI,d.v3Add(h,j,i),f.addSprite(e),d.v3Build(1*b,0,-1*b,j),e.angle=1.5*Math.PI,d.v3Add(h,j,i),f.addSprite(e))},getv3BaseLocation:function(a){var b,
c;a||(a=this.entity);return a?((b=a.getEC("ECAttach"))&&(c=b.getParent()),c?this.getv3BaseLocation(c):a.getv3BottomLocation()):null},getVisibleAmmoCount:function(){return this.isReloading()?this.getReloadedBullets():this.ammo},draw:function(){},isPertinant:function(){return 1>=this.getClipSize()?!1:this.globals.gameCurrentTime<this.ammoChangedTime+5?!0:!1},setAmmoVisible:function(a){this.ammoVisible=a},discardWeapon:function(){this.weapon=null},hasWeapon:function(){return this.weapon?!0:!1},setWeapon:function(a,
b){var c=this.globals.mathDevice,d=ba.archetypes[a];this.weapon=a;this.projectileType=d.projectileType;this.clipSize=d.clipSize;this.projectilesPerShot=this.safeCopy(d.projectilesPerShot,1);this.ammo=d.clipSize;this.reloadDuration=d.reloadDuration;this.rechamberDuration=d.rechamberDuration;this.effectProjectileType=this.safeCopy(d.effectProjectileType,null);this.numEffectProjectiles=this.safeCopy(d.numEffectProjectiles,1);this.effectProjectileSpreadAngle=this.safeCopy(d.effectProjectileSpreadAngle*
c.degreesToRadians,0);this.speedModAiming=this.safeCopy(d.speedModAiming,1);this.speedModRechambering=this.safeCopy(d.speedModRechambering,1);this.speedModReloading=this.safeCopy(d.speedModReloading,1);this.minRange=d.minRange;this.maxRange=d.maxRange;this.maxProjectileRange=this.safeCopy(d.maxProjectileRange,void 0);this.maxRandomSpreadAngle=void 0!==d.randomSpreadAngle?d.randomSpreadAngle*c.degreesToRadians:0;this.firesfx=d.firesfx;this.fireEffect=d.fireEffect;this.fireSound=d.fireSound;this.cockSound=
d.cockSound;this.reloadSound=this.safeCopy(d.reloadSound,null);this.dryFireSound=d.dryFireSound;if(0<b){if(this.temporaryWeaponAmmo=b,this.clearOverloadProjectile(),c=this.getEntityEC("ECChargeableShot"))c.onEquipTemporaryWeapon()}else this.temporaryWeaponAmmo=0,this.mainWeaponName=a},isUsingTemporaryWeapon:function(){return 0<this.temporaryWeaponAmmo},unequipTemporaryWeapon:function(){var a,b=this.mainWeaponName;this.setWeapon(b);(a=this.getEntityEC("ECInventory"))&&a.setHeldWeapon(b)},onAmmoChange:function(){this.ammoChangedTime=
this.globals.gameCurrentTime},isWithinRange:function(a){var b=this.globals.mathDevice,c=this.getv3Location(),a=b.v3Distance2DSq(c,a);return this.minRange*this.minRange<=a&&a<=this.maxRange*this.maxRange},getMaxRandomSpreadAngle:function(){return this.maxRandomSpreadAngle},calculateRandomSpreadAngle:function(a,b,c){var d=this.globals.mathDevice,f=0;void 0===c&&(c=this.getMaxRandomSpreadAngle());0<c&&(1<b?f=d.remap(0,1,-c,c,a/(b-1)):(f=Math.random()*c,0.5>Math.random()&&(f*=-1)));return f},drawAmmo:function(a,
b,c,d){var f=this.globals,e=f.mathDevice,h=f.simpleSpriteRenderer,i=this.getEntityEC("ECHero"),j=this.getClipSize(),k=this.getVisibleAmmoCount(),l=1*b,m=0,c=(void 0!==c?c:0)*b,i=i.getPulse(),i=i*b,q=4.5*b/(j-1),m=0.5*-q*(j-1),p;d&&(p=e.m43At(f.camera.matrix),p[1]=0,e.v3Normalize(p,p));20<=k&&(k=this.getVisibleAmmoCount());for(d=0;d<k;d+=1)l=0.7*b,d===k-1&&(l*=1.75),h.addSprite({v3Location:a,size:1*(l+i),offsetX:m,offsetY:c,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:this.getAmmoGUITexturePath(),
v4color:e.v4Build(0,0,0,1),out:p}),m+=q},isRechambering:function(){return 0<this.rechamberTimer},getRechamberFactor:function(){var a=this.globals.mathDevice,b=this.rechamberDuration;return 0<b?a.remap(0.5,0,0,1,this.rechamberTimer/b):1},isReloading:function(){return 0<this.reloadTimer},getReloadingFactor:function(){var a=this.globals.mathDevice,b=this.getReloadDuration();return 0<b?a.remap(0.75,0,0,1,this.reloadTimer/b):1},getCanFireFactor:function(){return Math.min(this.getRechamberFactor(),this.getReloadingFactor())},
getCanFire:function(){return!this.isRechambering()&&!this.isReloading()&&this.hasWeapon()},getSpeedMod:function(){return this.isRechambering()?this.speedModRechambering:this.isReloading()?this.speedModReloading:1},getClipSize:function(){return this.clipSize},getProjectilesPerShot:function(){return this.projectilesPerShot},getAmmo:function(){return this.ammo},getRechamberDuration:function(){return this.rechamberDuration},setRechamberDuration:function(a){this.rechamberDuration=a},getMaxProjectileRange:function(){return void 0!==
this.maxProjectileRange?this.maxProjectileRange:this.maxRange},getMaxRange:function(){return this.maxRange},getMinRange:function(){return this.minRange},setMaxRange:function(a){this.maxRange=a},attemptFire:function(a,b,c,d){this.onAmmoChange();this.autoReloadTime&&(this.autoReloadTime=void 0);this.isRechambering()?this.playDryFire():this.isReloading()?this.playDryFire():this.fire(a,b,c,d)},attemptFireAtLocation:function(a){this.onAmmoChange();this.autoReloadTime&&(this.autoReloadTime=void 0);this.isRechambering()?
this.playDryFire():this.isReloading()?this.playDryFire():this.fireAtLocation(a)},fire:function(a,b,c,d){var f=this.globals.mathDevice,e=!1;if(a&&!a.toBeDestroyed){var h=f.v3Copy(a.getv3Location()),i=h[1],j;if(a=a.getEC("ECPhysicsSphere"))h=this.projectileUsesGravity()?f.v3Copy(a.getv3CapsuleBottomLocation(),h):f.v3Copy(a.getv3CapsuleTopLocation(),h),j=f.v3Copy(a.getv3Velocity());c&&(j&&1E-5<f.v3Length2DSq(j))&&(this.leadTargetLocation(h,j),e=!0);(b||e)&&f.v3ClampDistance(this.getv3Location(),h,this.minRange,
this.maxRange,h);b=f.v3Sub(h,this.getv3Location());b[1]=i-this.getv3Location()[1];b=f.v3Normalize(b,b);this.fireAtLocation(h,b,d)}},leadTargetLocation:function(a,b){var c=this.globals.mathDevice,d=this.getv3Location(),f=this.getProjectileSpeed(),e;a&&(b&&0<f)&&(d=c.v3Sub(a,d),e=c.v3Length2DSq(b)-f*f,f=2*(b[0]*d[0]+b[2]*d[2]),c=c.v3Length2DSq(d),d=f*f-4*e*c,0<d&&(c=2*c/(Math.sqrt(d)-f),a[0]+=c*b[0],a[2]+=c*b[2]))},getProjectileSpeed:function(){var a=this.getProjectileParameters(),b=0;a&&(b=a.speed);
return b},getProjectileParameters:function(a){var b=this.gameManager.getEntityFactory();a||(a=this.overloadProjectile?this.overloadProjectile:this.projectileType);return b.getECArchetype(a,"ECProjectile")},projectileUsesGravity:function(){var a=this.getProjectileParameters(),b=!1;a&&(b=a.usesGravity);return b},fireAtLocation:function(a,b,c){var d=this.globals.mathDevice,f=this.getProjectilesPerShot(),e;if(this.entity.isManagedByThisMachine()){var h=this.getEntityEC("ECPhysicsSphere"),h=h?d.v3Copy(h.getv3CapsuleTopLocation()):
d.v3Copy(this.getv3Location()),i;this.hasShootOffset&&((e=this.getEntityEC("ECMesh"))?(i=this.archetype.shootOffset,d.v3AddScalarMul(h,e.getX(),i[0],h),d.v3AddScalarMul(h,e.getY(),i[1],h),d.v3AddScalarMul(h,e.getZ(),i[2],h)):h[1]+=this.archetype.shootOffset);d=this.projectileType;this.overloadProjectile&&(d=this.overloadProjectile);this.createProjectiles(d,f,a,b,h,c?0:this.getMaxRandomSpreadAngle());this.effectProjectileType&&this.createProjectiles(this.effectProjectileType,this.numEffectProjectiles,
a,b,h,this.effectProjectileSpreadAngle);this.playFire();this.playFireEffect(h,b)}this.ammo-=1;0<this.temporaryWeaponAmmo&&(this.temporaryWeaponAmmo-=1,0>=this.temporaryWeaponAmmo&&this.unequipTemporaryWeapon());0>=this.ammo?this.beginReload():this.beginRechamber()},createProjectiles:function(a,b,c,d,f,e){var h=this.globals.mathDevice,i=this.gameManager.getProjectileFactory(),j=!1,k=this.getGravity(),l,m,q,p,s,t,u,w,B;if(a&&0<b){if(l=this.getProjectileParameters(a))j=l.usesGravity,p=l.speed;d||(d=
h.v3Sub(c,f),w=h.v3LengthSq(d),0<w&&(d=h.v3ScalarMul(d,1/w,d)));void 0===w&&(w=h.v3Length(h.v3Sub(c,this.getv3Location())));for(l=0;l<b;l+=1)m=h.v3Copy(c,m),q=h.v3Copy(d,q),u=this.calculateRandomSpreadAngle(l,b,e),0!==u&&(u=h.quatFromAxisRotation(h.v3BuildYAxis(),u),q=h.quatTransformVector(u,q,q),m=h.v3AddScalarMul(this.getv3Location(),q,w,m)),j&&(k&&0<p&&0<w)&&(u=Math.min(w/p,1.2),s=h.v3Sub(m,f,s),t=h.v3Build(s[0]/u,(s[1]+0.5*k*u*u)/u,s[2]/u,t),q=h.v3Normalize(t,q)),u=i.createProjectile(this.entity,
f,m,a),B=u.getEC("ECProjectile"),t&&B&&(B.v3Velocity=t,B.v3Direction=q),B&&B.setMaxRange(this.getMaxProjectileRange()),this.entity.isOwnedByThisPlayer()&&u.setOwnedByThisPlayer(!0),B.setDamageFactor(this.damageFactor)}},getGravity:function(){return qa.prototype.gravity},beginRechamber:function(){this.rechamberTimer=this.rechamberDuration},beginReload:function(){var a=this.globals.mathDevice,b=a.getFactor(this.getClipSize(),0,this.ammo),b=a.saturate(b);this.reloadTimer=a.lerp(0,this.getReloadDuration(),
b)},instantReload:function(a){this.playCock();var b=this.getClipSize();void 0!==a&&(b=a);this.ammo=b;this.onAmmoChange();this.reloadTimer=0},setOverloadProjectile:function(a){this.overloadProjectile=a},clearOverloadProjectile:function(){this.overloadProjectile=null},playFire:function(){this.playSound(this.fireSound)},playFireEffect:function(a,b){var c,d=this.globals.mathDevice;this.fireEffect&&(c=this.gameManager.actionManager,c.addAction("VisualEffect",{archetype:this.fireEffect,v3Location:d.v3Copy(a),
v3Direction:d.v3Copy(b)}));this.firesfx&&(c=this.gameManager.getEffectFactory())&&c.play(this.firesfx,d.v3Copy(a),this.entity,d.v3Copy(b))},playCock:function(){this.playSound(this.cockSound)},playReload:function(){var a=this.reloadSound;a&&this.playSound(a)},playDryFire:function(){this.playSound(this.dryFireSound);this.unskilled=!0},getAmmoGUITexturePath:function(){return tb.ammoGUITexturePath},getWeaponRadiusQuarterTexturePath:function(){return tb.weaponRadiusQuarterTexturePath},getMinWeaponRadiusQuarterTexturePath:function(){return tb.weaponMinRadiusQuarterTexturePath},
onToBeDestroyed:function(){this._super()},serialize:function(a){this._super(a);a.clipSize=this.clipSize;a.ammo=this.ammo;a.reloadDuration=this.reloadDuration;a.rechamberDuration=this.rechamberDuration;a.temporaryWeaponAmmo=this.temporaryWeaponAmmo;a.mainWeaponName=this.mainWeaponName;a.reloadTimer=this.reloadTimer;a.rechamberTimer=this.rechamberTimer;a.ammoChangedTime=this.ammoChangedTime;a.speedModAiming=this.speedModAiming;a.speedModRechambering=this.speedModRechambering;a.speedModReloading=this.speedModReloading;
a.ammoVisible=this.ammoVisible},serializeDelta:function(){}});tb.ammoGUITexturePath="textures/smallbomb.dds";tb.weaponRadiusQuarterTexturePath="textures/tower_range_outer.dds";tb.weaponMinRadiusQuarterTexturePath="textures/tower_range_inner.dds";tb.preload=function(a){var a=a.textureManager,b=tb.weaponRadiusQuarterTexturePath,c=tb.weaponMinRadiusQuarterTexturePath;a.load(tb.ammoGUITexturePath);a.load(b);a.load(c)};F.prototype.eCCreationMap[tb.prototype.entityComponentName]=tb;tb.create=function(a,
b){return new tb(a,b)};var lh=F.extend({entityComponentName:"ECGameGridEntity",updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{},init:function(a,b){this._super(a,b)},activate:function(){this._super();this.setInterestedInMovement(!0);this.onMoved()},updateLocationAndRadius:function(){var a=this.globals.mathDevice,b=this.getv3Location(),c=this.entity.getRadius();this.aabbExtents=a.aabbBuildFromCentreRadius(b,
c+0.5,this.aabbExtents)},onMoved:function(){this.aabbExtents&&this.removeFromGrid();this.updateLocationAndRadius();this.aabbExtents&&this.addToGrid()},refresh:function(){this.onMoved()},removeFromGrid:function(){this.gameSpace&&this.gameSpace.getGameGrid().removeEntityFromGridSquaresWithinExtents(this.aabbExtents,this.entity)},addToGrid:function(){this.gameSpace&&this.gameSpace.getGameGrid().addEntityToGridSquaresWithinExtents(this.aabbExtents,this.entity)},update:function(){this._super()},draw:function(){},
drawDebug:function(){},setGameSpace:function(a){if(a!==this.gameSpace&&(this.gameSpace&&this.removeFromGrid(),this.gameSpace=a))this.updateLocationAndRadius(),this.addToGrid()},serialize:function(a){this._super(a)},serializeDelta:function(){},destroy:function(){this._super()}});lh.create=function(a,b){return new lh(a,b)};F.prototype.eCCreationMap[lh.prototype.entityComponentName]=lh;var gd=F.extend({entityComponentName:"ECGameCritical",updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!0,
shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,storeGlobalList:!0,parameters:{},init:function(a,b){this._super(a,b)},onToBeDestroyed:function(){this._super()},update:function(){this._super()},draw:function(){},drawDebug:function(){},onDeath:function(){this.gameManager.eventManager.notify("hqDeath")},serialize:function(a){this._super(a)},serializeDelta:function(){}});gd.count=0;gd.create=function(a,b){var c=new gd(a,b);gd.count+=1;return c};F.prototype.eCCreationMap[gd.prototype.entityComponentName]=
gd;var mh=F.extend({entityComponentName:"ECGate",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldAlwaysUpdate:!0,shouldDraw:!0,shouldSerialize:!0,shouldDeltaSerialize:!0,shouldSave:!0,shouldLevelSave:!0,init:function(a,b){this._super(a,b);this.animSpeed=4;this.maxAnimDistance=0.8;this.animTween=null;this.desiredOpen=!1;this.desiredOpenPrev=null;this.triggererEntityList=[];this.v3CreationLocation=null;this.currentOffset=0},activate:function(){this._super();var a=this.globals.mathDevice;if(!this.v3CreationLocation){var b=
this.getv3Location();this.v3CreationLocation=a.v3Copy(b)}0===this.currentOffset&&this.setToUpdate(!1)},update:function(){this._super();this.desiredOpen!==this.desiredOpenPrev&&(this.stopAnim(),this.desiredOpen?this.animOpen():this.animClose());this.desiredOpenPrev=this.desiredOpen;this.triggererEntityList.length&&(this.updateTriggererEntityList(),0===this.triggererEntityList.length&&this.close())},updateTriggererEntityList:function(){var a=this.triggererEntityList,b=this.getv3Location(),c,d,f;for(f=
0;f<a.length;f+=1)c=a[f],d=void 0,c.toBeDestroyed||(d=c.getEC("ECGateTriggerer")),(!d||!d.isValidToTrigger(b))&&a.splice(f,1)},draw:function(){},open:function(a){this.desiredOpen=!0;this.addTriggerer(a)},close:function(){this.desiredOpen=!1},addTriggerer:function(a){var b=this.triggererEntityList;0>b.indexOf(a)&&(this.setToUpdate(!0),b.push(a))},setYOffset:function(a){if(this.currentOffset!==a){var b=this.globals.mathDevice,c=this.getEntityEC("ECMesh"),d=this.getEntityEC("ECPhysicsCube");c&&c.setLocalOffset(b.v3Build(0,
a,0));d&&d.setAdditionalOffsetY(a*(0.98/this.maxAnimDistance));this.currentOffset=a}},animOpen:function(){var a=this,b={offset:-this.maxAnimDistance},c=this.maxAnimDistance/this.animSpeed;this.animTween=G.Create({offset:this.currentOffset}).to(b,c).easing(G.Easing.Quadratic.Out).onUpdate(function(){a.setYOffset(this.offset)}).onComplete(function(){a.animTween=null;a.playSound("thud")}).start()},animClose:function(){var a=this,b=this.maxAnimDistance/this.animSpeed;this.animTween=G.Create({offset:this.currentOffset}).to({offset:0},
b).easing(G.Easing.Quadratic.Out).onUpdate(function(){a.setYOffset(this.offset)}).onComplete(function(){a.animTween=null;a.playSound("thud");0===a.triggererEntityList.length&&a.setToUpdate(!1)}).start()},stopAnim:function(){this.animTween&&(this.animTween.stop(),this.animTween=null)},drawDebug:function(){},saveSerialize:function(){return{v3CreationLocation:this.v3CreationLocation,currentOffset:this.currentOffset}},serialize:function(a){this._super(a)},serializeDelta:function(){},onToBeDestroyed:function(){this._super()},
destroy:function(){this._super();this.stopAnim()}});mh.create=function(a,b){return new mh(a,b)};F.prototype.eCCreationMap[mh.prototype.entityComponentName]=mh;var nh=F.extend({entityComponentName:"ECGateTriggerer",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldDraw:!0,shouldSerialize:!0,shouldDeltaSerialize:!0,shouldSave:!1,init:function(a,b){this._super(a,b);this.triggerRadius=2},activate:function(){this._super()},update:function(){this._super();if(this.getEntityEC("ECHero")||this.canDoRationedAction("TriggerGates")){var a=
this.getv3Location(),b=this.triggerRadius,c=b*b,d=this.globals.mathDevice,f=this.entity,e=function(a){var b=a.getEC("ECGate");b&&f.isFriendlyWith(a)&&d.v3Distance2DSq(f.getv3Location(),a.getv3Location())<=c&&b.open(f)},h=this.gameManager;h&&h.applyToEntitiesInGridCellsWithinRadius(a,b,e)}},isValidToTrigger:function(a){return this.globals.mathDevice.v3Distance2DSq(this.getv3Location(),a)<=this.triggerRadius*this.triggerRadius},draw:function(){},drawDebug:function(){var a=this.globals,b=a.debugDraw,
a=a.mathDevice.v3BuildYAxis();b.drawDebugCircle(this.getv3Location(),a,this.triggerRadius)},serialize:function(a){this._super(a)},serializeDelta:function(){},destroy:function(){this._super()}});nh.create=function(a,b){return new nh(a,b)};F.prototype.eCCreationMap[nh.prototype.entityComponentName]=nh;var hd=F.extend({entityComponentName:"ECHealth",updatePeriod:0.25,sortPriority:4,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!0,shouldSave:!0,realTime:!1,parameters:{health:{description:"Health Per Life",
type:"slider",defaultValue:3,minValue:0,maxValue:20},invunTime:{description:"Invulerable Time (s) After Taking Damage",type:"slider",defaultValue:0,minValue:0,maxValue:5},canTakeDamage:{description:"Whether or not the entity can take damage (regen/degen ignores this).",defaultValue:!0},takesFullDamageFromFriendlyFire:{description:"Whether or not the entity takes full damage from friendly fire.",defaultValue:!1},rooted:{description:"No damage forces are applied to rooted entities",defaultValue:!1},
regen:{description:"Health Regen Per Second",type:"slider",defaultValue:0,minValue:-5,maxValue:5},regenDelay:{description:"Health Regen Delay (s)",type:"slider",defaultValue:1,minValue:0,maxValue:1E3},canOnlyRegenNearRegenerators:!1,canOnlyBeDamagedByHero:!1,immuneToIndirectHits:!1,deathBehavior:"flash",drawInWorldBar:!1,drawInWorldBarIfNotFull:!1,drawInWorldBarIfDamagedRecently:!1,drawOffScreenIconIfDamagedRecently:!1,onlyDrawIconIfOffScreen:!0,offScreenDamageIconArchetype:"offScreenBuildingDamaged",
shrinkMeshWhenLowHealth:!1,worldBarRow:-2,healthBarScale:1,barLevel:1},fallingDamage:1.5,scaleMaxHealth:function(a){var b=this.getHealthFactor();this.startHealth=this.archetype.health*a;this.health=this.startHealth*b},init:function(a,b){this._super(a,b);this.startHealth=this.health=this.safeCopy(b.health,3);this.invunTime=this.safeCopy(b.invunTime,0);this.vulnerableTime=0;this.invunerable=!1;this.healthChangedTime=-10;this.initialMeshScale=1;this.meshExpandFactor=2;this.meshExpandDuration=1.2;this.rooted=
this.safeCopy(b.rooted,!1);this.disableHealthBar=!1;this.deathEnabled=this.active=this.regenEnabled=!0;this.healing=!1;this.healingEffectName=null;this.explosionDamageFactor=1;this.healthBarScale=b.healthBarScale},upgradeMaxHealth:function(a){var b=this.getBaseMaxHealth(),c=this.health/this.startHealth;this.startHealth=a;this.health=a*c;this.healthBarScale=this.archetype.healthBarScale*(a/b)},getBaseMaxHealth:function(){return this.archetype.health},getExplosionDamageFactor:function(){return this.explosionDamageFactor},
setExplosionDamageFactor:function(a){this.explosionDamageFactor=a},activate:function(){this._super();this.calculateToUpdate()},beginFadeDeath:function(){var a;if(!this.isFading()&&(this.fadeDeathTime=this.globals.gameCurrentTime,this.entity.setDead(),a=this.getEntityEC("ECMesh")))this.initialMeshScale=a.getScale();this.setUpdatePeriod(0);this.setToUpdate(!0)},updateFadeDeath:function(){if(void 0!==this.fadeDeathTime){var a;switch(this.getDeathBehavior()){case "flash":a=0.5-(this.globals.gameCurrentTime-
this.fadeDeathTime);this.entity.flashDeath(a);break;case "expand":a=this.meshExpandDuration-(this.globals.gameCurrentTime-this.fadeDeathTime);this.updateExpandDeath();break;default:a=0}if(0>=a){if(this.isManagedByThisMachine()){(a=this.getEntityEC("ECBuilding"))&&a.placeRebuildScaffold();if(a=this.getEntityEC("ECResourceStorage"))a.onKilled();if(a=this.getEntityEC("ECExplode"))a.onKilled()}this.entity.setToBeDestroyed()}}},takesFullDamageFromFriendlyFire:function(){return this.archetype.takesFullDamageFromFriendlyFire},
getDeathBehavior:function(){return this.archetype.deathBehavior},updateExpandDeath:function(){var a,b,c=this.initialMeshScale,d=this.meshExpandFactor,f=this.meshExpandDuration,e,h=this.globals.mathDevice;if((b=this.getEntityEC("ECMesh"))&&h)a=c,0<f&&(e=this.globals.gameCurrentTime-this.fadeDeathTime,0<e&&(a=h.lerp(c,c*d,e/f))),b.setScale(a)},isFading:function(){return void 0!==this.fadeDeathTime},getRegenRate:function(){return this.archetype.regen},getRegenDelay:function(){return this.archetype.regenDelay},
canOnlyRegenNearRegenerators:function(){return this.archetype.canOnlyRegenNearRegenerators},canOnlyBeDamagedByHero:function(){return this.archetype.canOnlyBeDamagedByHero},isImmuneToIndirectHits:function(){return this.archetype.immuneToIndirectHits},isWithinRangeOfRegenerator:function(){var a=this.globals.mathDevice,b=this.getv3Location(),c,d,f,e,h,i=!1;if(c=this.getEntityEC("ECFaction"))if(c=c.getFaction()){c=c.getHealthRegenerators();f=c.length;for(d=0;d<f;d+=1)if((e=c[d])&&!e.toBeDestroyed)if(h=
e.getEC("ECHealthRegenerator"))if(h=h.getRadius(),0<h&&a.v3Distance2DSq(b,e.getv3Location())<h*h){i=!0;break}}return i},shouldRegen:function(){var a=this.getRegenRate();return 0!==a&&this.isRegenEnabled()&&this.getTimeSinceHealthChange()>this.getRegenDelay()&&(0>a||this.getHealth()<this.getMaxHealth())&&(!this.canOnlyRegenNearRegenerators()||this.isWithinRangeOfRegenerator())?!0:!1},enableRegen:function(){this.regenEnabled=!0},disableRegen:function(){this.regenEnabled=!1},isRegenEnabled:function(){return this.regenEnabled},
calculateToUpdate:function(){var a=this.entity,b=this.getHealth(),a=this.isFading()||b<this.getMaxHealth()||0>=b||0>this.getRegenRate()||a.hasEC("ECPlayerLife")||a.hasEC("ECPhysicsSphere")||a.hasEC("ECGameCritical");this.setToUpdate(a)},updateInvulnerable:function(){0<=this.vulnerableTime&&(this.vulnerableTime-=this.getTimeSinceLastUpdate(),this.entity.flashInvulnerable(0.5<this.vulnerableTime))},update:function(){this._super();var a=this.globals,b=this.entity,c=b.getEC("ECPlayerLife");if(c||b.hasEC("ECGameCritical"))this.godMode=
a.cheats.godMode;this.updateFadeDeath();this.updateInvulnerable();this.shouldRegen()?(this.isHealing()||this.beginHealing(),this.addHealth(this.getRegenRate()*this.getTimeSinceLastUpdate()),this.getHealth()>=this.getMaxHealth()&&this.endHealing()):this.isHealing()&&this.endHealing();a=0>=this.health&&this.isDeathEnabled();!c&&(a&&!this.entity.isDead())&&this.beginFadeDeath()},beginHealing:function(){this.healing=!0;0<=this.getRegenRate()&&(this.entity.playSound("healStart"),this.healingEffectName=
this.playPersistentEffect("sfx_hero_heal"));this.evaluateShouldDraw()},endHealing:function(){this.healing=!1;0<=this.getRegenRate()&&(this.entity.playSound("healEnd"),this.stopPersistentEffect(this.healingEffectName),this.healingEffectName=null)},isHealing:function(){return this.healing},draw:function(){var a,b;this.shouldDrawBar()&&(a=this.getWorldBarRow(),b=this.getHealthBarScale(),this.drawHealthBar(a,b));this.shouldDrawOffScreenIcon()&&this.drawOffScreenIcon();this.evaluateShouldDraw()},drawDebug:function(){var a=
this.globals,b=a.mathDevice,c=a.simpleFontRenderer,b=a.camera.worldToScreen(b.v3Add(this.getv3Location(),b.v3Build(0,1.5,0))),a="Health : "+this.getHealth()+"/"+this.getMaxHealth(),d=[1,1,1];void 0!==b&&(b={x:b[0],y:b[1]+5,pointSize:16,alignment:1,r:d[0],g:d[1],b:d[2]},c.drawFontDouble(a,b))},getWorldBarRow:function(){return this.archetype.worldBarRow},getHealthBarScale:function(){return this.healthBarScale},shouldDrawBar:function(){var a=this.archetype;return this.disableHealthBar?!1:a.drawInWorldBar||
a.drawInWorldBarIfNotFull&&this.getHealth()<this.getMaxHealth()||a.drawInWorldBarIfDamagedRecently&&(2.5>this.getTimeSinceHealthChange()||this.shouldRegen())||this.isHealing()?!0:!1},shouldDrawOffScreenIcon:function(){var a=!1,b=this.gameManager.getGameCamera();if(this.archetype.drawOffScreenIconIfDamagedRecently&&2.5>this.getTimeSinceHealthChange()&&(!this.archetype.onlyDrawIconIfOffScreen||!b.isOnScreen(this.getv3Location())))a=!0;return a},getOffScreenDamageIconArchetype:function(){return this.archetype.offScreenDamageIconArchetype},
getOffScreenDamageIconScale:function(){var a=this.globals.mathDevice,b=this.getTimeSinceHealthChange(),b=0.05>b?b/0.05:0.45>b?a.remap(0.05,0.45,1,0,b):0;return a.lerp(1,1.5,b)},evaluateShouldDraw:function(){this.setToDraw(this.shouldDrawBar()||this.shouldDrawOffScreenIcon())},setDisableHealthBar:function(a){this.disableHealthBar=a},getHealthFactor:function(){return this.health/this.startHealth},drawHealthBar:function(a,b){if(this.entity){var c=this.getHealthFactor(),d=this.globals.mathDevice,d=0.5<
c?d.v4Lerp(k.healthMid,k.healthFull,d.getFactor(0.5,1,c)):d.v4Lerp(k.healthLow,k.healthMid,d.getFactor(0,0.5,c));this.entity.drawProgressBarFromFraction(c,a,b*(1+0.25*(this.archetype.barLevel-1)),b,d[0],d[1],d[2])}},drawOffScreenIcon:function(){var a=this.getOffScreenDamageIconArchetype(),b=this.gameManager.getGuiManager();a&&"none"!==a&&b.addDrawGui(a,{v3WorldLocation:this.getv3Location(),scale:this.getOffScreenDamageIconScale(),allowOffscreen:!0},"idECHealth"+this.entity.getName()+a)},createTempData:function(){return{healthFactor:this.health/
this.getMaxHealth()}},applyTempData:function(a){a&&(this.health=a.healthFactor*this.getMaxHealth())},getTimeSinceHealthChange:function(){return this.globals.gameCurrentTime-this.healthChangedTime},onHealthChange:function(){this.healthChangedTime=this.globals.gameCurrentTime;this.calculateToUpdate()},resetHealth:function(){this.health=this.startHealth;this.hasShrunkMesh&&this.growMesh();this.onHealthChange()},setInvulnerable:function(a){this.invunerable=a},getVulnerableTimeRemaining:function(){return Math.max(0,
this.vulnerableTime)},getInvulnerable:function(){return 0<this.getVulnerableTimeRemaining()||this.invunerable||this.godMode||!this.archetype.canTakeDamage||!this.active},setActive:function(a){this.active=a},shrinkMesh:function(){var a=this.getEntityEC("ECMesh");a&&(a.setScaleY(0.25),this.hasShrunkMesh=!0)},growMesh:function(){var a=this.getEntityEC("ECMesh");a&&(a.setScaleY(1),this.hasShrunkMesh=!1)},enableDeath:function(){this.deathEnabled=!0},disableDeath:function(){this.deathEnabled=!1},isDeathEnabled:function(){return this.deathEnabled},
setInvulnerableDuration:function(a){this.vulnerableTime=Math.max(this.vulnerableTime,a)},takeDamage:function(a,b,c,d,f){var e=this.entity,h=e.getEC("ECPlayerLife"),i=e.getEC("ECAgent"),j=e.getEC("ECLootDropper"),k=e.getEC("ECResourceStorage"),l=e.getEC("ECResourceCarrier"),m=e.getEC("ECRepairable"),q=e.getEC("ECBuilding"),p=e.getEC("ECEffectSpawner");if(0!==a){var s,t=!1;if(c&&!c.shouldBeDestroyed()&&(s=c.getEC("ECAgent")))s.onApplyDamage(e,a),s.getTargetEntity()===e&&(t=!0);if(!this.canOnlyBeDamagedByHero()||
c&&!c.shouldBeDestroyed()&&c.hasEC("ECHero")){if(this.isImmuneToIndirectHits()&&(!t&&c&&!c.shouldBeDestroyed()&&(s=c.getEC("ECAutoFire"))&&s.getTargetEntity()===e&&(t=!0),!t))return;if(d||!this.getInvulnerable()){f&&(a*=this.getExplosionDamageFactor());this.health-=a;this.health=Math.max(this.health,0);this.setInvulnerableDuration(this.invunTime);this.onHealthChange();d=4*a/this.getMaxHealth();d=Math.min(d,1);e.shudder(d,d,0);e=!1;i&&(i.onTakeDamage(b,c),e=i.isCritical());if(k)k.onTakeDamage(a,c);
if(l)l.onTakeDamage(a,c);if(j)j.onTakeDamage(c);if(p)p.onTakeDamage();if(m)m.onTakeDamage(a,c);this.archetype.shrinkMeshWhenLowHealth&&(!this.hasShrunkMesh&&0.25>this.getHealthFactor())&&this.shrinkMesh();if(0>=this.health&&this.isDeathEnabled()&&!this.isFading()){h&&h.loseLife(c);var j=this.gameManager,a=j.getFactionManager().getHeroFactionName(),b=this.entity.getEC("ECFaction"),k=c.getEC("ECFaction"),u,w;b&&(u=b.getFactionName());k&&(w=k.getFactionName());b=j.eventManager;j=j.getScoreInfo();w&&
(w===a&&w!==u)&&(u=this.entity,u={v3Location:this.getv3Location(),victim:u,aggressor:c,isCritical:e},b.notify("EnemyKilled",u));if(q)if("Wall"===q.getBuildingType())j.onWallDestroyed();else j.onBuildingDestroyed();if(this.entity.hasEC("ECGameCritical"))j.onHQDestroyed();i&&this.sendEnemyDeathMetric(c);!h&&!this.entity.isDead()&&this.beginFadeDeath()}this.evaluateShouldDraw()}}}},sendBuildingDestroyedMetric:function(){this.globals.metricsManager.sendGameMetric("buildingDestroyed_"+this.entity.archetypeName,
1)},sendEnemyDeathMetric:function(a){var b=this.globals.metricsManager,c=this.entity.archetypeName,d="enemyDeath_"+c;!a.shouldBeDestroyed()&&a.getEC("ECHero")&&(d="enemyDeathFromHero_"+c);b.sendGameMetric(d,1)},killSelf:function(){this.setActive(!0);this.takeDamage(this.getHealth(),!1,this.entity,!0)},getHealth:function(){return this.health},getMaxHealth:function(){return this.startHealth},addHealth:function(a){var b=this.getMaxHealth();this.health+=a;this.hasShrunkMesh&&0.25<=this.getHealthFactor()&&
this.growMesh();this.health>=b&&(this.health=b,this.calculateToUpdate())},isRooted:function(){return this.rooted},onToBeDestroyed:function(){this._super()},serialize:function(a){this._super(a);a.startHealth=this.startHealth;a.health=this.health},serializeDelta:function(a){a.startHealth=this.startHealth;a.health=this.health},saveSerialize:function(){return{health:this.health,startHealth:this.startHealth,regenEnabled:this.regenEnabled}},deserialize:function(a){this._super(a)}});F.prototype.eCCreationMap[hd.prototype.entityComponentName]=
hd;hd.create=function(a,b){return new hd(a,b)};var oh=F.extend({entityComponentName:"ECHealthRegenerator",updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!1,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{radius:6},init:function(a,b){this._super(a,b)},activate:function(){this._super()},getRadius:function(){return this.archetype.radius},update:function(){this._super()},draw:function(){},drawDebug:function(){},serialize:function(a){this._super(a)},serializeDelta:function(){},
destroy:function(){this._super()}});oh.create=function(a,b){return new oh(a,b)};F.prototype.eCCreationMap[oh.prototype.entityComponentName]=oh;var ph=F.extend({entityComponentName:"ECHero",updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldAlwaysUpdate:!1,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,DEFAULT_PULSE_SCALAR:5,DEFAULT_MAX_PULSE_AMPLITUDE:0.05,init:function(a,b){this._super(a,b)},activate:function(){this._super();this.gameManager.addHeroEntity(this.entity);
this.entity.setGameSpaceDynamic(!0)},getPulse:function(){return Math.sin(this.globals.gameCurrentTime*this.DEFAULT_PULSE_SCALAR+this.getHeroNumber())*this.DEFAULT_MAX_PULSE_AMPLITUDE},draw:function(){},drawDebug:function(){},setHeroColour:function(a,b,c){this.r=a;this.g=b;this.b=c},setHeroNumber:function(a){this.heroNumber=a},getHeroNumber:function(){return this.heroNumber},setGameSpace:function(a){a!==this.currentGameSpace&&(void 0!==this.currentGameSpace&&(this.currentGameSpace.removeHero(),this.hasEntered&&
(this.currentGameSpace.removeEnteredHero(),this.hasEntered=void 0)),this.currentGameSpace=a,void 0!==this.currentGameSpace&&this.currentGameSpace.addHero())},destroy:function(){this._super();this.setGameSpace(void 0)},serialize:function(a){this._super(a);a.r=this.r;a.g=this.g;a.b=this.b;a.heroNumber=this.heroNumber}});F.prototype.eCCreationMap[ph.prototype.entityComponentName]=ph;ph.create=function(a,b){return new ph(a,b)};var qh=F.extend({entityComponentName:"ECHeroUpgrades",updatePeriod:0,sortPriority:4,
shouldUpdate:!1,shouldAlwaysUpdate:!1,shouldDraw:!1,shouldSerialize:!1,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,storeGlobalList:!1,parameters:{},init:function(a,b){this._super(a,b);this.playerData=a.gameManager.playerData},activate:function(){this._super();this.refreshUpgrades()},update:function(){this._super()},draw:function(){},drawDebug:function(){},manageLargeTimeStep:function(a){this._super(a)},serialize:function(a){this._super(a)},serializeDelta:function(){},getHeroUpgrade:function(a){return this.playerData.getHeroUpgrade(a)},
setHeroUpgrade:function(a,b){this.playerData.setHeroUpgrade(a,b);this.refreshUpgrades()},refreshUpgrades:function(){this.applyMovementSpeedUpgrade();this.applyCarrySpeedUpgrade();this.applyShotgunDamageUpgrade();this.applyReloadSpeedUpgrade();this.applyMaxHealthUpgrade();this.applyExplosionDamageUpgrade();this.applyCarryCapacityUpgrade();this.applyChopEffectivenessUpgrade()},applyMovementSpeedUpgrade:function(){var a=this.getEntityEC("ECLocomotion");a&&a.setFastSpeedFactor(this.archetype.movementSpeedFactors[this.getHeroUpgrade("movementSpeed")])},
applyCarrySpeedUpgrade:function(){var a=this.getEntityEC("ECResourceCarrier");a&&a.setEncumberedSpeedFactor(this.archetype.carrySpeedFactors[this.getHeroUpgrade("carrySpeed")])},applyShotgunDamageUpgrade:function(){var a=this.getEntityEC("ECFirearm");a&&a.setDamageFactor(this.archetype.shotgunDamageFactors[this.getHeroUpgrade("shotgunDamage")])},applyReloadSpeedUpgrade:function(){var a=this.getEntityEC("ECFirearm");a&&a.setReloadSpeedFactor(this.archetype.reloadSpeedFactors[this.getHeroUpgrade("reloadSpeed")])},
applyMaxHealthUpgrade:function(){var a=this.getEntityEC("ECHealth");a&&a.upgradeMaxHealth(a.getBaseMaxHealth()*this.archetype.maxHealthFactors[this.getHeroUpgrade("maxHealth")])},applyExplosionDamageUpgrade:function(){var a=this.getEntityEC("ECHealth");a&&a.setExplosionDamageFactor(this.archetype.explosionDamageFactors[this.getHeroUpgrade("explosionDamage")])},applyCarryCapacityUpgrade:function(){var a=this.getEntityEC("ECResourceCarrier");a&&a.adjustMaxBlocks(this.archetype.carryCapacityBlocks[this.getHeroUpgrade("carryCapacity")])},
applyChopEffectivenessUpgrade:function(){var a=this.getEntityEC("ECResourceCarrier");a&&a.setAddedBlocksPerChop(this.archetype.chopExtraBlocks[this.getHeroUpgrade("chopEffectiveness")])},onDeath:function(){},onToBeDestroyed:function(){this._super()},destroy:function(){this._super()}});qh.create=function(a,b){return new qh(a,b)};F.prototype.eCCreationMap[qh.prototype.entityComponentName]=qh;var rh=F.extend({entityComponentName:"ECHeroShrine",updatePeriod:5,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,
shouldSerialize:!1,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,storeGlobalList:!1,parameters:{svgPath:"gui/icon_hero.svg"},init:function(a,b){this._super(a,b)},evaluateupgradeTypesValidity:function(){if(this.gameManager){this.menuIndexToValidIndex=[];this.upgradeLevels=[];this.prerequisitesMet=[];this.heroLevelMet=[];var a=this.archetype.upgradeTypes,b=a.length,c,d,f=this.gameManager.getPlayerData(),e=this.gameManager.getHero().getEC("ECPlayerData");for(c=0;c<b;c+=1)d=a[c],this.upgradeLevels[c]=
f.getHeroUpgrade(d.upgradeType),this.prerequisitesMet[c]=this.arePrerequisitesMet(d.prerequisites),this.heroLevelMet[c]=d.minimumHeroLevel<=e.getLevel(),this.menuIndexToValidIndex.push(c)}},getPrerequisitesMet:function(a){return this.prerequisitesMet[a]},getHeroLevelMet:function(a){return this.heroLevelMet[a]},arePrerequisitesMet:function(a){var b=a.length,c,d=this.gameManager.getPlayerData(),f;for(c=0;c<b;c+=1)if(f=a[c],d.getHeroUpgrade(f.upgradeType)<f.level)return!1;return!0},getupgradeLevel:function(a){return this.upgradeLevels[a]},
upgradeHero:function(a,b){this.upgradeLevels[b]+=1;var c=a.getEC("ECHeroUpgrades"),d=this.getupgradeType(b);this.getLevelInfo(b,this.upgradeLevels[b]);c.setHeroUpgrade(d,this.upgradeLevels[b]);this.gameManager.getGuiManager().addGameMessage("ecHeroShrine"+this.entity.getName(),"Hero Upgraded! ",""+this.getupgradeDisplayName(b),4,"newsflashHeroUpgrade");this.gameManager.getGameSoundManager().play("aud_celebrate");this.gameManager.getEventManager().notify("HeroUpgraded",{})},getupgradeDisplayName:function(a){return this.archetype.upgradeTypes[a].upgradeDisplayName},
getupgradeMinimumHeroLevel:function(a){return this.archetype.upgradeTypes[a].minimumHeroLevel},getPrerequisiteText:function(a){return this.archetype.upgradeTypes[a].prerequisiteText},getupgradeType:function(a){return this.archetype.upgradeTypes[a].upgradeType},isFullyUpgraded:function(a){return this.getupgradeLevel(a)>=this.archetype.upgradeTypes[a].levels.length-1?!0:!1},getLevelInfo:function(a,b){return this.archetype.upgradeTypes[a].levels[b]},getRadialMenuButtonCount:function(){return this.menuIndexToValidIndex.length},
getGuiArchetype:function(a,b,c){return!c?"heroUpgradeUsingAmber":b?"heroUpgradeValid":"heroUpgradeInvalid"},canLevelUp:function(a){return(a=a.getEC("ECPlayerData"))?a.canUpgrade():!1},isOnZeroLevel:function(a){return(a=a.getEC("ECPlayerData"))?0===a.getLevel():!0},remapMenuIndexToValidIndex:function(a){return this.menuIndexToValidIndex[a]},doRadialMenuButton:function(a,b,c,d){d=this.remapMenuIndexToValidIndex(d);if(void 0!==d){var f=this.getupgradeDisplayName(d),e,h="",i="";e=this.isOnZeroLevel(b);
var j=this.canLevelUp(b),k=!this.isFullyUpgraded(d),l=this.getHeroLevelMet(d),m=this.getPrerequisitesMet(d),h=j&&l&&m&&k,m=this.getGuiArchetype(d,h,j||!k||e);h?(e=this.getLevelInfo(d,this.getupgradeLevel(d)+1),h=""+f+"\n"+e.levelText,c={text1:h,v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,svg1:this.archetype.svgPath},f="ecHeroShrine"+this.entity.getName()+"Upgrade"+d,a.doButtonFromGuiArchetype(m,c,f)&&(this.unlockUpgrade(b,d),this.sendUpgradeUnlockedMetric(this.getupgradeType(d)))):(h=""+f+"\n",
e?h="Level Up\nto unlock hero upgrades":k?j?h=l?"(Need to upgrade "+this.getPrerequisiteText(d)+")":h+("(Unlocked at Level "+this.getupgradeMinimumHeroLevel(d)+")"):(h+="(Level up or boost using Amber)",i="75"):h+="(Maxed Out!)",c={v2ScreenLocation:c,text1:h,text4:i,buttonType:aa.BUTTON_ROUND,svg1:this.archetype.svgPath},f="ecHeroShrine"+this.entity.getName()+"Upgrade Unavailable"+d,a.doButtonFromGuiArchetype(m,c,f)&&(!j&&k&&!e)&&(this.canAffordHeroLevelUp(b,75)?(this.payForLevelUp(b,75),this.levelUpHero(b),
this.sendLevelUpBoughtMetric(),this.unlockUpgrade(b,d),this.sendUpgradeUnlockedMetric(this.getupgradeType(d))):this.openAmberShop(),this.closeRadialMenu()))}},sendLevelUpBoughtMetric:function(){this.globals.metricsManager.sendGameMetric("heroLevelBought",1)},sendUpgradeUnlockedMetric:function(a){this.globals.metricsManager.sendGameMetric("heroAbilityUnlocked_"+a,1)},canAffordHeroLevelUp:function(a,b){var c=a.getEC("ECPlayerData");return c?c.getSoftCurrency()>=b:!1},payForLevelUp:function(a,b){var c=
a.getEC("ECPlayerData");c&&c.adjustSoftCurrency(-b)},levelUpHero:function(a){(a=a.getEC("ECPlayerData"))&&a.levelUp()},openAmberShop:function(){var a=this.gameManager,b=Wa.create(a,this.globals);a.setGameState(b);b.setButtonPanal("purchase")},activate:function(){this._super();this.setToUpdate(!0);this.attachHandlers()},attachHandlers:function(){var a=this.globals.gameManager.eventManager;this.heroLevelUpCallback||(this.heroLevelUpCallback=this.evaluateupgradeTypesValidity.bind(this),a.subscribe("HeroLevelledUp",
this.heroLevelUpCallback))},detachHandlers:function(){var a=this.globals.gameManager.eventManager;this.heroLevelUpCallback&&(a.unsubscribe("HeroLevelledUp",this.heroLevelUpCallback),this.heroLevelUpCallback=void 0)},update:function(){this._super();this.evaluateupgradeTypesValidity();this.setToUpdate(!1)},unlockUpgrade:function(a,b){this.upgradeHero(a,b);this.evaluateupgradeTypesValidity();this.closeRadialMenu()},closeRadialMenu:function(){var a=this.getEntityEC("ECSelectable");a&&a.setActivated(!1)},
draw:function(){},drawDebug:function(){},serialize:function(a){this._super(a)},serializeDelta:function(){},onDeath:function(){},onToBeDestroyed:function(){this._super()},manageLargeTimeStep:function(a){this._super(a)},saveSerialize:function(){},destroy:function(){this._super();this.detachHandlers()}});rh.create=function(a,b){return new rh(a,b)};F.prototype.eCCreationMap[rh.prototype.entityComponentName]=rh;var sh=F.extend({entityComponentName:"ECHeroTorch",updatePeriod:10,sortPriority:4,shouldUpdate:!0,
shouldAlwaysUpdate:!1,shouldDraw:!1,shouldSerialize:!1,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,storeGlobalList:!0,init:function(a,b){this._super(a,b)},activate:function(){this._super()},setNight:function(a){a!==this.isNight&&(a?(this.destroyheldTorchEntity(),this.createAndStoreHeldEntity("characters/models/hero_torchhand.dae",1.25)):(this.destroyheldTorchEntity(),this.createAndStoreHeldEntity("characters/models/hero_lefthand.dae",1.25)));this.isNight=a},getNight:function(){return this.isNight},
update:function(){this._super();var a=this.gameManager.isNight();this.setNight(a)},createAndStoreHeldEntity:function(a,b){this.heldTorchEntity=this.entity.createHeldEntity(a,this.globals.mathDevice.v3Build(0,0,0),b,"Carried Weapon");var c=this.heldTorchEntity.getEC("ECMesh");c&&(c.setScale(0),G.Create({scale:0}).to({scale:1},0.5).easing(G.Easing.Elastic.Out).onUpdate(function(){c.setScale(this.scale)}).start())},destroyheldTorchEntity:function(){this.heldTorchEntity&&this.heldTorchEntity.setToBeDestroyed()},
draw:function(){},drawDebug:function(){},manageLargeTimeStep:function(a){this._super(a)},serialize:function(a){this._super(a)},serializeDelta:function(){},onDeath:function(){},onToBeDestroyed:function(){this._super()},destroy:function(){this._super()}});sh.create=function(a,b){return new sh(a,b)};F.prototype.eCCreationMap[sh.prototype.entityComponentName]=sh;var th=F.extend({entityComponentName:"ECInventory",updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,
shouldSave:!1,realTime:!1,init:function(a,b){this._super(a,b);this.equippedItems=[];this.heldWeapon=null;this.weapon=b.weapon},activate:function(){this._super();this.weapon&&this.entity.isManagedByThisMachine()&&this.equipWeapon(this.weapon)},createEmptyHandEntity:function(){this.destroyHeldWeaponEntity();this.createAndStoreHeldEntity("characters/models/hero_righthand.dae",1.25)},update:function(){this._super()},canEquipItem:function(a){var b;b=ba.archetypes[a].isMelee?this.getEntityEC("ECMelee"):
this.getEntityEC("ECFirearm");return!b?!1:!this.isItemEquipped(a)},canEquipTemporaryWeapon:function(a){return this.canEquipItem(a)},equipWeapon:function(a){var b=ba.archetypes[a].isMelee,c=this.getHeldWeapon();if(c!==a){this.equipItem(a);b=b?this.getEntityEC("ECMelee"):this.getEntityEC("ECFirearm");if(!b)return;b.setWeapon(a);c&&this.dropItem(c);this.setHeldWeapon(a)}},unequipWeapon:function(){var a=this.getEntityEC("ECFirearm"),b=this.getHeldWeapon();if(b){var c=ba.archetypes[b].isMelee;this.unequipItem(b);
this.destroyHeldWeaponEntity();this.createEmptyHandEntity();this.heldWeapon=null;c||a.discardWeapon(null)}},equipTemporaryWeapon:function(a,b){var c=ba.archetypes[a].isMelee;if(this.getHeldWeapon()!==a){if(c){c=this.getEntityEC("ECMelee");if(!c)return;c.setWeapon(a)}else{c=this.getEntityEC("ECFirearm");if(!c)return;c.setWeapon(a,b)}this.setHeldWeapon(a)}},createAndStoreHeldEntity:function(a,b){var c=this.globals.mathDevice;this.heldWeaponEntity=this.getEntityEC("ECAgent")?this.entity.createHeldEntity(a,
c.v3Build(-0.3,0.5,0.5),b,"Carried Weapon"):this.entity.createHeldEntity(a,c.v3Build(0,0,0),b,"Carried Weapon");var d=this.heldWeaponEntity.getEC("ECMesh");d&&(d.setScale(0),G.Create({scale:0}).to({scale:1},0.5).easing(G.Easing.Elastic.Out).onUpdate(function(){d.setScale(this.scale)}).start())},destroyHeldWeaponEntity:function(){this.heldWeaponEntity&&this.heldWeaponEntity.setToBeDestroyed()},isItemEquipped:function(a){return-1!==this.getEquippedItems().indexOf(a)},equipItem:function(a){this.getEquippedItems().push(a);
this.setShouldDeltaSerialize(!0)},unequipItem:function(a){var b=this.getEquippedItems(),a=b.indexOf(a);-1!==a&&(b.splice(a,1),this.setShouldDeltaSerialize(!0))},dropItem:function(a){var b=this.globals.mathDevice,c=this.gameManager.getEntityFactory(),d=this.getEntityEC("ECLocomotion"),f=this.getv3Location();this.isItemEquipped(a);this.unequipItem(a);this.getHeldWeapon()===a&&(this.destroyHeldWeaponEntity(),this.createEmptyHandEntity());c.archetypes[a]&&(d=b.v3Copy(d.getNormalizedDirection()),b.v3ScalarMul(d,
-1,d),b=b.v3Add(f,d),c.createActiveEntityInstance(a,a,b))},setHeldWeapon:function(a){if(this.heldWeapon!==a){this.destroyHeldWeaponEntity();this.heldWeapon=a;var b=ba.archetypes[a].meshScale;void 0===b&&(b=1);ba.archetypes[a].meshPath&&this.createAndStoreHeldEntity(ba.archetypes[a].meshPath,b)}},getHeldWeapon:function(){return this.heldWeapon},getEquippedItems:function(){return this.equippedItems},serialize:function(a){a.equippedItems=this.getEquippedItems()},serializeDelta:function(a){this.getShouldDeltaSerialize()&&
(this.setShouldDeltaSerialize(!1),a.equippedItems=this.equippedItems)}});th.create=function(a,b){return new th(a,b)};F.prototype.eCCreationMap[th.prototype.entityComponentName]=th;var uh=F.extend({entityComponentName:"ECInteractable",updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!0,parameters:{requiresMovement:!1,selectType:"selectTypeAlways"},init:function(a,b){this._super(a,b);this.shouldSerialize=!0;this.onInteractCallbacks=
[];this.active=!0},activate:function(){this._super();var a=function(a){this.onImpact(a)}.bind(this),b=this.getEntityEC("ECPhysicsSphere");b&&b.addOnImpactCallback(a);(b=this.getEntityEC("ECPhysicsCube"))&&b.setOnImpactCallback(a);this.refreshValidity()},refreshValidity:function(){var a=this.gameManager.getPlayFlags();a&&this.setActive(a.validSelectTypes[this.getSelectType()])},getSelectType:function(){return this.archetype.selectType},setActive:function(a){this.active=a},getActive:function(){return this.active},
setOnInteractCallback:function(a){this.onInteractCallbacks.push(a)},shouldApproachOnDown:function(){return!1},setPassive:function(a){this.passive=a},shouldApproachOnUp:function(){return this.passive?!1:this.archetype.requiresMovement?!0:!1},executeCallbacks:function(a){var b,c=this.onInteractCallbacks,d=c.length;for(b=0;b<d;b+=1)c[b](a)},onImpact:function(a){if(this.active){var b=a.getEC("ECLocomotion");b&&b.getDestinationEntity()===this.entity&&(this.executeCallbacks(a),b.clearDestination(),b.clearDestinationEntity())}},
update:function(){this._super()},draw:function(){},drawDebug:function(){},serialize:function(a){this._super(a)},serializeDelta:function(){}});uh.create=function(a,b){return new uh(a,b)};F.prototype.eCCreationMap[uh.prototype.entityComponentName]=uh;var vh=F.extend({entityComponentName:"ECLifetime",updatePeriod:1,sortPriority:4,shouldUpdate:!1,shouldAlwaysUpdate:!1,shouldDraw:!0,shouldSerialize:!1,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,storeGlobalList:!1,parameters:{lifetimeDurationInSeconds:1,
startCountdownOnCreation:!0},init:function(a,b){this._super(a,b);this.countdownStartTime=null},activate:function(){this._super();this.archetype.startCountdownOnCreation&&this.startCountdown()},startCountdown:function(){this.countdownStartTime=this.globals.gameCurrentTime;this.setToUpdate(!0)},update:function(){this._super();this.globals.gameCurrentTime-this.countdownStartTime>this.archetype.lifetimeDurationInSeconds&&this.entity.setToBeDestroyed()},onToBeDestroyed:function(){this._super()},destroy:function(){this._super()}});
vh.create=function(a,b){return new vh(a,b)};F.prototype.eCCreationMap[vh.prototype.entityComponentName]=vh;var Fb=F.extend({entityComponentName:"ECLight",updatePeriod:0,sortPriority:7,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!0,parameters:{underGroundOnly:!1,colour:{description:"The colour of the light",defaultValue:[0.5,0,0],minValue:0,maxValue:1,step:0.1},dynamic:!0,flicker:{description:"How much the light intensity varies",defaultValue:0.15,
minValue:0,maxValue:1},radius:{description:"Light radius",defaultValue:5,minValue:0,maxValue:20},shadows:!1,wobble:{description:"Defines the radius of the spherical bound in which the light can wobble.",defaultValue:0,minValue:0,maxValue:5},yOffset:{description:"Y axis offset of light to entity",defaultValue:0,minValue:0,maxValue:10}},init:function(a,b){this._super(a,b);var c=this.globals.mathDevice;this.m43Transform=c.m43BuildIdentity();this.roomID=b.roomID;void 0===b.groupID?this.instant=!0:(this.groupID=
b.groupID,this.outputNetworkID=this.buildIDArray(this.roomID,this.groupID));this.dynamic=this.safeCopy(b.dynamic,!0);this.radius=this.safeCopy(b.radius,5);this.baseColour=c.v3Copy(b.colour);this.colour=c.v3Copy(b.colour);this.flicker=this.safeCopy(b.flicker,0);this.wobble=this.safeCopy(b.wobble,0);this.yOffset=this.safeCopy(b.yOffset,0);this.shadows=this.safeCopy(b.shadows,!1);this.keyName=this.safeCopy(b.keyName,void 0);this.flickerTime=0;this.desiredFlicker=this.currentFlicker=1;this.wobbleTime=
0;this.currentWobble=c.v3Build(0,0,0);this.desiredWobble=c.v3Build(0,0,0);this.fade=this.fadeTarget=0},activate:function(){this._super();this.light=this.createPointLight();this.lightNode=this.addLight(this.light);this.dynamic&&(this.updateFlicker(),this.updateWobble(),this.setBrightness(this.fade*this.currentFlicker))},setGroupAndRoom:function(a,b){this.roomID=b;void 0===a?this.instant=!0:(this.groupID=a,this.outputNetworkID=this.buildIDArray(this.roomID,this.groupID))},getInstant:function(){return this.instant},
getUnderground:function(){return this.archetype.underGroundOnly},hasOutputNetworkID:function(a){return this.instant?!1:this.arrayContains(this.outputNetworkID,a)},triggerOn:function(a){a!==this.on&&((this.on=a)?this.setFadeTarget(1):this.setFadeTarget(0))},toggle:function(){this.triggerOn(!this.on)},setRoomStateTarget:function(a){this.instant||this.setFadeTarget(a)},setFadeTarget:function(a){this.fadeTarget=a},fadeTo:function(a){if(0.01>Math.abs(this.fade-a))return this.fade=a,!0;this.fade=this.globals.mathDevice.lerp(this.fade,
a,0.1);return!1},uniqueifyStringLightName:function(a){a=a+"_PointLight_"+Fb.prototype.uniqueIndex;Fb.prototype.uniqueIndex+=1;return a},createPointLight:function(){if(this.keyName&&this.keyedLights[this.keyName])return this.keyedLights[this.keyName];var a=this.globals.mathDevice,b=this.radius,a=ad.create({name:this.uniqueifyStringLightName(this.entity.name),color:this.colour,point:!0,shadows:this.shadows,halfExtents:a.v3Build(b,b,b),origin:a.v3Build(0,this.yOffset,0),material:this.getLightMaterial()});
this.keyName&&(Fb.prototype.keyedLights[this.keyName]=a);return a},addLight:function(a){var b=this.globals.scene;b.addLight(a);this.buildLocationMatrix(this.m43Transform);var c=Sa.create({name:a.name+"-node",local:this.m43Transform,dynamic:this.dynamic,disabled:!1});c.addLightInstance(bd.create(a));b.addRootNode(c);return c},removeLight:function(a){var b=this.globals.scene;this.keyName||b.removeLight(this.light);b.removeRootNode(a)},getLightMaterial:function(){var a=this.globals;void 0===Fb.prototype.lightMaterial&&
(a.scene.loadMaterial(a.graphicsDevice,a.textureManager,a.effectManager,"defaultLightMaterial",{effect:"lambert",parameters:{lightfalloff:"textures/default_light.dds",lightprojection:"textures/default_light.dds"}}),Fb.prototype.lightMaterial=a.scene.getMaterial("defaultLightMaterial"));return Fb.prototype.lightMaterial},buildLocationMatrix:function(a){var b=this.globals.mathDevice,c=b.v3Add(this.getv3Location(),this.currentWobble);b.m43SetPos(a,c)},updateFlicker:function(){if(!(0>=this.flicker)){var a=
this.globals,b=a.mathDevice,a=a.gameCurrentTime;this.flickerTime<a&&(this.desiredFlicker=1-Math.random()*this.flicker,this.flickerTime=a+0.05+0.1*Math.random());this.currentFlicker=b.lerp(this.currentFlicker,this.desiredFlicker,0.125)}},setBrightness:function(a){var b=this.globals.mathDevice;a!==this.brightness&&(this.light&&(this.light.color=b.v3ScalarMul(this.colour,a)),this.brightness=a)},updateWobble:function(){if(!(0>=this.wobble)){var a=this.globals,b=a.mathDevice,a=a.gameCurrentTime;this.wobbleTime<
a&&(this.desiredWobble=b.v3BuildRandom(this.wobble,this.desiredWobble),this.wobbleTime=a+0.2+0.4*Math.random());this.currentWobble=b.v3Lerp(this.currentWobble,this.desiredWobble,0.015)}},updateRadius:function(a){var b=this.globals.mathDevice,c=this.light;this.radius=a;a=b.v3Build(a,a,a);c.halfExtents=a},updateBaseColour:function(a){var b=this.globals.mathDevice;b.v3Copy(a,this.baseColour);b.v3Copy(a,this.colour)},updateShadows:function(a){this.shadows=a;this.light.shadows=a},updateYOffset:function(a){this.light.origin[1]=
a},updateFromArchetype:function(){var a=this.globals.mathDevice,b=this.archetype;this.radius!==b.radius&&this.updateRadius(b.radius);a.v3Equal(this.baseColour,b.colour)||this.updateBaseColour(b.colour);this.shadows!==b.shadows&&this.updateShadows(b.shadows);this.yOffset!==b.yOffset&&this.updateYOffset(b.yOffset);this.flicker=b.flicker;this.wobble=b.wobble;this.dynamic=b.dynamic},update:function(){this._super();this.dynamic&&(this.updateFlicker(),this.fadeTo(this.fadeTarget),this.updateWobble(),this.setBrightness(this.fade*
this.currentFlicker),this.buildLocationMatrix(this.m43Transform),this.lightNode.setLocalTransform(this.m43Transform))},draw:function(){},setGameSpace:function(a){a!==this.currentGameSpace&&(void 0!==this.currentGameSpace&&this.currentGameSpace.removeLight(this),this.currentGameSpace=a,void 0!==this.currentGameSpace&&this.currentGameSpace.addLight(this))},destroy:function(){this._super();this.setGameSpace(void 0);this.removeLight(this.lightNode);this.lightNode=null},serialize:function(a){this._super(a);
a.radius=this.radius;a.flicker=this.flicker;a.yOffset=this.yOffset;a.shadows=this.shadows;a.keyName=this.keyName}});F.prototype.eCCreationMap[Fb.prototype.entityComponentName]=Fb;Fb.prototype.uniqueIndex=0;Fb.create=function(a,b){return new Fb(a,b)};var wh=F.extend({entityComponentName:"ECLocationMarker",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,storeGlobalList:!0,realTime:!1,parameters:{},init:function(a,b){this._super(a,
b)},update:function(){this._super();var a=this.gameManager.eventManager,b=this.getType(),c=this.getGroupName(),d=this.getLocationName(),f=this.getv3Location();a.notify("LocationMarkerCreated",c,d,b,f);this.setToUpdate(!1)},getGroupName:function(){return this.archetype.groupName},getType:function(){return this.archetype.type},getLocationName:function(){return this.archetype.locationName},draw:function(){},drawDebug:function(){this.globals.debugDraw.drawDebugPoint(this.entity.v3Location,0,0,1);var a=
this.globals,b=a.mathDevice,c=a.simpleFontRenderer,b=a.camera.worldToScreen(b.v3Add(this.getv3Location(),b.v3Build(0,1.5,0))),a=this.getLocationName(),d=[1,1,1];void 0!==b&&(b={x:b[0],y:b[1]+-10,pointSize:16,alignment:1,r:d[0],g:d[1],b:d[2]},c.drawFontDouble(a,b))},serialize:function(a){this._super(a)},serializeDelta:function(){},onToBeDestroyed:function(){this._super();var a=this.gameManager.eventManager,b=this.getType(),c=this.getGroupName(),d=this.getLocationName(),f=this.getv3Location();a.notify("LocationMarkerDestroyed",
c,d,b,f)},destroy:function(){this._super()}});wh.create=function(a,b){return new wh(a,b)};F.prototype.eCCreationMap[wh.prototype.entityComponentName]=wh;var Md=F.extend({entityComponentName:"ECLocomotion",updatePeriod:0,sortPriority:2,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!0,parameters:{normalSpeed:{description:"Normal speed",type:"slider",defaultValue:20,minValue:0,maxValue:50},fastSpeed:{description:"Fast speed",type:"slider",defaultValue:40,
minValue:0,maxValue:60},angleLerpFactor:{description:"Turn rate",type:"slider",defaultValue:0.25,minValue:0,maxValue:1},fastLerpFactor:{description:"Acceleration rate",type:"slider",defaultValue:0.5,minValue:0,maxValue:1},fastDistance:4,normalMaxDistance:1.5,normalMinDistance:1,closeEnoughDistance:0.1,animationRate:1,animationWobble:1,hasLookAhead:!1},active:!0,init:function(a,b){this._super(a,b);this.v3LookAhead=this.globals.mathDevice.v3BuildZero();this.scratchpad={};this.additionalY=this.additionalX=
this.appliedScale=0;var c=this.archetype;this.mobile=0<c.normalSpeed||0<c.fastSpeed;this.timeHeld=0;this.fastSpeedFactor=1},activate:function(){this._super();var a=this.globals.mathDevice;this.setDestination(a.v3Add(this.getv3Location(),a.v3Build(0,0,0.0125)));this.desiredSpeedFactor=this.speedFactor=0;this.v3NormalizedDirection=a.angleToV3(0);this.v3DesiredNormalizedDirection=a.v3Copy(this.v3NormalizedDirection,this.v3DesiredNormalizedDirection);this.smoothAngle=0;this.entity.setGameSpaceDynamic(!0)},
update:function(){this._super();this.updateLocomotion(!0);0<=this.timeHeld&&(this.timeHeld-=this.globals.gameTimeStep,this.timeHeld=Math.max(this.timeHeld,0))},getTimeHeld:function(){return this.timeHeld},updateOffScreen:function(){this._super();this.updateLocomotion(!1)},updateLocomotion:function(a){this.active&&(this.buildMovementFromDestination(),this.applyAcceleration(),a&&this.applyMotionToAnim(),this.archetype.hasLookAhead&&this.updateLookAhead())},onApplyForce:function(a){this.appliedAngle=
this.globals.mathDevice.v3ToAngle(a);this.applyForceOutTween&&this.applyForceOutTween.stop();this.applyForceInTween&&this.applyForceInTween.stop();var b=this;this.applyForceInTween=G.Create({scale:1}).to({scale:0},0.5).onUpdate(function(){b.appliedScale=this.scale}).onComplete(function(){b.applyForceInTween=void 0});this.applyForceOutTween=G.Create({scale:this.appliedScale}).to({scale:1},0.07125).onUpdate(function(){b.appliedScale=this.scale}).onComplete(function(){b.applyForceOutTween=void 0}).chain(this.applyForceInTween).start()},
shouldApplyKnockback:function(){return this.ignoreImpactResponses?!1:this.applyForceInTween},buildMovementFromDestination:function(){var a,b,c;c=this.scratchpad;this.v3Destination?(a=this.globals.mathDevice,b=this.getv3Location(),a.v3SetY(a.v3GetY(b),this.v3Destination),b=c.v3NormalizedToDest=a.v3Sub(this.v3Destination,b,c.v3NormalizedToDest),c=a.v3LengthSq(b),c<this.archetype.closeEnoughDistance*this.archetype.closeEnoughDistance?(this.clearDestination(),this.clearDestinationEntity(),this.desiredSpeedFactor=
this.speedFactor=0):(c=Math.sqrt(c),b=a.v3ScalarMul(b,1/c,b),this.updateDirectionAndSpeedFactor(b,c))):this.v3Facing?(a=this.globals.mathDevice,b=this.getv3Location(),a.v3SetY(a.v3GetY(b),this.v3Facing),b=c.v3NormalizedToDest=a.v3Sub(this.v3Facing,b,c.v3NormalizedToDest),a.v3Normalize(b,b),this.updateDirectionAndSpeedFactor(b,0)):this.desiredSpeedFactor=this.speedFactor=0},updateDirectionAndSpeedFactor:function(a,b){var c=this.globals,d=c.mathDevice,f=60*c.gameTimeStep,e=this.archetype,c=1-Math.pow(1-
e.angleLerpFactor,f),f=1-Math.pow(1-e.fastLerpFactor,f),e=this.calculateSpeedFactorFromDistance(b,!0),h=d.v3ToAngle(a),i=d.v3ToAngle(this.v3NormalizedDirection);this.v3DesiredNormalizedDirection=d.v3Copy(a,this.v3DesiredNormalizedDirection);this.v3NormalizedDirection=d.angleToV3(d.lerpAngle(i,h,c),this.v3NormalizedDirection);this.speedFactor=d.lerp(this.speedFactor,e,e>this.speedFactor?f:1);this.desiredSpeedFactor=e},getDesiredNormalizedDirection:function(){return this.v3DesiredNormalizedDirection},
getNormalizedDirection:function(){return this.v3NormalizedDirection},setDirectionAndSpeedFactor:function(a,b){this.v3NormalizedDirection=this.globals.mathDevice.v3Copy(a,this.v3NormalizedDirection);this.desiredSpeedFactor=this.speedFactor=b},applyAcceleration:function(){var a=this.globals.mathDevice,b=this.scratchpad,c=this.getEntityEC("ECPhysicsSphere"),d=this.calculateForceFromSpeed(this.speedFactor);b.appliedForce=a.v3ScalarMul(this.v3NormalizedDirection,d,b.appliedForce);0<d&&!0===c.softForce&&
(b.scaledAppliedForce=a.v3ScalarMul(b.appliedForce,c.getMass(),b.scaledAppliedForce),c.applyForce(b.scaledAppliedForce))},applyMotionToAnim:function(){var a=this.getEntityEC("ECMesh"),b=this.getEntityEC("ECPhysicsSphere"),c=this.globals,d=c.mathDevice,f=this.scratchpad,e,h=Math.PI;e=1-Math.pow(0.8,60*c.gameTimeStep);var i=!0===b.softForce,j=i?-0.05:-0.075,k=this.getEntityEC("ECChargeAttack");k&&k.isChargeAttacking()&&(j*=2);(k=this.getEntityEC("ECBumpAttack"))&&k.isCharging()&&(j*=2);void 0===this.footstep&&
(this.footstep=0);k=0;i?(i=this.smoothAngle,this.smoothAngle=this.v3LookAt?d.lerpAngle(this.smoothAngle,d.v3ToAngle(d.v3Sub(this.v3LookAt,this.getv3Location())),e):d.lerpAngle(this.smoothAngle,d.v3ToAngle(this.v3NormalizedDirection),e),this.smoothAngle!==i&&(this.smoothAngle=d.boundAngle(this.smoothAngle),k=d.diffAngles(this.smoothAngle,i)),e=this.footstep,f.v3HorizontalVel=d.v3ScalarMul(f.appliedForce,0.16,f.v3HorizontalVel),d.v3SetY(0,f.v3HorizontalVel),this.footstep+=2*d.v3Length(f.v3HorizontalVel)*
c.gameTimeStep*this.getAnimationRate(),Math.floor(e/h+0.5)<Math.floor(this.footstep/h+0.5)&&this.playSound("footStep"),this.mobile?(this.entity.setRotationY(this.smoothAngle),a.setRotationY(0.1*Math.cos(this.footstep)*this.getAnimationWobble()+this.additionalY),a.setRotationZ(0.2*Math.sin(this.footstep)*this.getAnimationWobble()+k),f.bounce=d.v3Build(0,0.1+0.3*Math.abs(Math.cos(this.footstep)),0,f.bounce),a.setLocalOffset(f.bounce)):(this.entity.setRotationY(this.smoothAngle),a.setRotationY(0),a.setRotationZ(0))):
(a.setRotationZ(0),this.entity.setRotationY(this.smoothAngle),a.setRotationY(0),a.setLocalOffset(d.v3Build(0,0.1,0)));this.v3NormalizedDirection?a.setRotationX(d.v3Dot(b.v3Velocity,this.v3NormalizedDirection)*j+this.additionalX):a.setRotationX(0);this.shouldApplyKnockback()&&(b=d.angleToV3(this.appliedAngle-this.entity.getRotationY()),a.addRotationZ(0.5*b[0]*this.appliedScale),a.addRotationX(0.5*-b[2]*this.appliedScale))},getAnimationRate:function(){return this.archetype.animationRate},getAnimationWobble:function(){return this.archetype.animationWobble},
setAdditionalX:function(a){this.additionalX=a},setAdditionalY:function(a){this.additionalY=a},setIgnoreImpactResponses:function(a){this.ignoreImpactResponses=a},getDesiredSpeedFactor:function(){return this.desiredSpeedFactor},calculateForceFromSpeed:function(a){var b=this.globals.mathDevice,c=1,d=this.getEntityEC("ECFirearm"),f=this.getEntityEC("ECMelee"),e=this.getEntityEC("ECResourceCarrier"),h=this.getEntityEC("ECChargeAttack"),i=this.getEntityEC("ECBumpAttack"),j=this.archetype,k=a;if(void 0===
a)return 0;d&&(c*=d.getSpeedMod());f&&(c*=f.getSpeedMod());e&&(c*=e.getSpeedMod());h&&(h.isChargeAttacking()&&(k=1),c*=h.getSpeedBoostFactor());i&&(c*=i.getSpeedMod());return(0.5>k?b.remap(0,0.5,0,j.normalSpeed,k)*c:b.remap(0.5,1,j.normalSpeed,j.fastSpeed*this.fastSpeedFactor,k)*c)*qa.defaultFriction},setFastSpeedFactor:function(a){this.fastSpeedFactor=a},calculateSpeedFactorFromDistance:function(a,b){var c=this.globals.mathDevice,d;d=this.archetype;return a<d.fastDistance?a>d.normalMaxDistance&&
b?(d=c.getFactor(d.normalMaxDistance,d.fastDistance,a),d=c.clamp(d,0,1),c.lerp(0.5,1,d)):a<d.normalMinDistance?(d=c.getFactor(0,d.normalMinDistance,a),d=c.clamp(d,0,1),c.lerp(0,0.5,d)):0.5:b?1:0.5},playControl:function(){this.playSound("appear")},draw:function(){},updateLookAhead:function(){var a=this.globals.mathDevice,b,c=0.15,d;this.v3Destination?(b=a.v3Sub(this.v3Destination,this.getv3Location()),c=a.v3Sub(b,this.v3LookAhead),d=a.v3Copy(this.v3LookAhead),a.v3Normalize(c,c),a.v3Normalize(d,d),
c=a.v3Dot(c,d),c=a.remap(-1,1,0.15,0.035,c),b=a.v3MaxLength(b,20,b)):b=a.v3BuildZero();this.v3LookAhead=a.v3Lerp(this.v3LookAhead,b,this.getTimeAdjustedBlendFactor(c))},getLookAhead:function(){return this.globals.mathDevice.v3Add(this.getv3Location(),this.v3LookAhead)},teleport:function(a,b){var c=this.globals.mathDevice;this.v3Destination&&c.v3Add(this.v3Destination,b,this.v3Destination)},drawDebug:function(){var a=this.globals,b=this.archetype,c=a.debugDraw,a=a.mathDevice,d=this.getv3Location(),
f=a.v3BuildYAxis();c.drawDebugCircle(d,f,b.normalMinDistance,1,1,1);c.drawDebugCircle(d,f,b.normalMaxDistance,1,1,1);c.drawDebugCircle(d,f,b.fastDistance,1,1,1);var b=this.v3Destination,f=this.destinationEntity,e=this.v3Facing,h=this.v3LookAt,i;b?(c.drawDebugLine(d,b,1,0,0),i=b):f&&!f.shouldBeDestroyed()?(c.drawDebugLine(d,f.getv3Location(),1,0,0),i=f.getv3Location()):e&&(c.drawDebugLine(d,e,0,1,0),i=e);h&&(!i||0.01<a.v3DistanceSq(i,h))&&c.drawDebugLine(d,h,0,0,1)},drawArrow:function(){var a=this.globals,
b=a.debugDraw,c=a.mathDevice,d,f,e,h=this.getEntityEC("ECPlayerLife");this.v3Destination&&h&&(a=this.getv3Location(),d=c.v3Sub(this.v3Destination,a),f=c.v3Length(d),e=this.calculateSpeedFactorFromDistance(f),c.v3Normalize(d,d),f=c.clamp(f,1,this.fastDistance),c=c.v3Add(a,c.v3ScalarMul(d,f)),b.drawDebugArrow(a,c,0.5*e,h.r,h.g,h.b))},getDestination:function(){return this.v3Destination},hasDestination:function(){return null!==this.v3Destination},setLookAt:function(a){this.v3LookAt=this.globals.mathDevice.v3Copy(a,
this.v3LookAt)},clearLookAt:function(){this.v3LookAt=void 0},setDestination:function(a,b){this.run=b;var c=this.globals.mathDevice;this.v3Destination||(this.v3Destination=c.v3BuildZero());this.v3Destination=c.v3Copy(a,this.v3Destination);this.timeHeld+=2*this.globals.gameTimeStep;this.timeHeld=Math.min(this.timeHeld,1)},clearDestination:function(){this.v3Destination=null},setDestinationEntity:function(a){this.destinationEntity=a},getDestinationEntity:function(){return this.destinationEntity},clearDestinationEntity:function(){this.destinationEntity=
null},setFacing:function(a){this.v3Facing=this.globals.mathDevice.v3Copy(a,this.v3Facing)},clearFacing:function(){this.v3Facing=void 0},reset:function(){this.v3Destination=null},onDeath:function(){this.setActive(!1)},setActive:function(a){this.active=a},serialize:function(a){this._super(a);a.speedFactor=this.speedFactor;a.v3NormalizedDirection=this.v3NormalizedDirection}});F.prototype.eCCreationMap[Md.prototype.entityComponentName]=Md;Md.create=function(a,b){return new Md(a,b)};var xh=F.extend({entityComponentName:"ECLootDropper",
updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{numHitsThatDropLoot:0,animate:!1,placed:!1,dropOnDeath:!0},init:function(a,b){this._super(a,b);this.coinGroups=b.coinGroups;this.animate=this.safeCopy(b.animate,!1);this.placed=this.safeCopy(b.placed,!1);this.lootDroppingEnabled=!0;this.hitsTaken=0},activate:function(){this._super();this.entity.setGameSpaceDynamic(!0);this.addAllPickupCounts();this.animate&&
this.setToUpdate(!0)},update:function(){this.animate&&this.updateAnim()},updateAnim:function(){var a=this.getEntityEC("ECMesh");a&&a.addRotationY(0.125*this.getTimeSinceLastUpdate())},draw:function(){},drawDebug:function(){},dropCoins:function(a,b,c){if(this.lootDroppingEnabled){var d=this.gameManager.getEntityFactory(),f=this.getv3Location(),e,h=void 0!==c?c:1;for(e=0;e<a;e+=1)1>h&&Math.random()>h||(c=d.createActiveEntityInstance("pickup",b,f),c.setGameSpace(this.entity.getGameSpace()))}},dropAllCoins:function(){if(this.lootDroppingEnabled){var a,
b=this.coinGroups,c=b.length,d;for(a=0;a<c;a+=1)d=b[a],this.dropCoins(d.number,d.archetype,d.likelihood);this.playSound("collectBig");this.droppedAllCoins=!0}},addAllPickupCounts:function(){var a,b=this.coinGroups,c=b.length,d,f=this.entity.getGameSpace(),g=this.gameManager,h=e.archetypes,i;for(a=0;a<c;a+=1)if(d=b[a],this.placed&&f.addPickup(d.number),i=h[d.archetype].ECPickup)(i=i.score)&&d.number&&g.addPotentialScore(i*d.number)},removeGroupOfType:function(a){var b,c=this.coinGroups,d=c.length,
f;for(b=0;b<d;)f=c[b],f.archetype===a?(c.splice(b,1),d=c.length):b+=1},getHitsTaken:function(){return this.hitsTaken},getNumHitsThatDropLoot:function(){return this.archetype.numHitsThatDropLoot},onTakeDamage:function(){this.isManagedByThisMachine()&&this.getHitsTaken()<this.getNumHitsThatDropLoot()&&(this.dropLootOnDamage(),this.hitsTaken+=1)},getLootToDropWhenDamaged:function(){return this.archetype.lootToDropWhenDamaged},dropLootOnDamage:function(a){var b=this.getLootToDropWhenDamaged(),c,d,f,e;
void 0===a&&(a=1);if(b&&0<a&&(c=b.length,0<c))for(e=0;e<a;e+=1)for(d=0;d<c;d+=1)f=b[d],this.dropCoins(f.number,f.archetype,f.likelihood)},onToBeDestroyed:function(){this._super()},onDeath:function(){var a=this.archetype,b=this.getNumHitsThatDropLoot()-this.getHitsTaken();this._super();this.lootDroppingEnabled&&this.isManagedByThisMachine()&&(0<b&&this.dropLootOnDamage(b),a.dropOnDeath&&!this.droppedAllCoins&&this.dropAllCoins())},destroy:function(){this._super()},serialize:function(a){this._super(a)}});
F.prototype.eCCreationMap[xh.prototype.entityComponentName]=xh;xh.create=function(a,b){return new xh(a,b)};var yh=F.extend({entityComponentName:"ECMelee",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldDraw:!0,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{attackAngle:{description:"Angle (degrees) of the attack cone",type:"slider",defaultValue:45,minValue:0,maxValue:120},attackDuration:{description:"Time duration (s) of attack",type:"slider",defaultValue:0.25,
minValue:0,maxValue:2},attackRange:{description:"Radius (m) of the attack cone",type:"slider",defaultValue:2,minValue:0,maxValue:3},chargeDuration:{description:"Time (s) of charge phase",type:"slider",defaultValue:0.25,minValue:0,maxValue:3},prepareDuration:{description:"Time (s) of prepration period before attack",type:"slider",defaultValue:0.7,minValue:0,maxValue:2},needsNavLOS:!1},init:function(a,b){this._super(a,b);void 0===b&&(b={});b.weapon?this.setWeapon(b.weapon):(this.prepareDuration=this.safeCopy(b.prepareDuration,
0.7),this.chargeDuration=this.safeCopy(b.chargeDuration,0.25),this.attackDuration=this.safeCopy(b.attackDuration,0.25),this.damageType=this.safeCopy(b.damageType,"DAMAGE_TYPE_SWIPE"),this.attackType=this.safeCopy(b.attackType,"MeleeSwing"),this.attackParameters=this.safeCopy(b.attackParameters,{}),this.attackAngle=2*(this.safeCopy(b.attackAngle,45)*Math.PI)*(1/360),this.attackRange=this.safeCopy(b.attackRange,2),this.beginAttackSound=b.beginAttackSound,this.attackImpactSound=b.attackImpactSound);
this.meleeAttack=null;this.attackActive=!1;this.attackDamage=1},activate:function(){var a,b;this._super();this.initMeleeAttack();if(a=this.getEntityEC("ECPhysicsSphere"))b=function(a){this.onImpact(a)}.bind(this),a.addOnImpactCallback(b),this.meleeAttack&&this.meleeAttack.usesHardImpactWithSceneryCallback&&(b=function(a){this.onHardImpactWithScenery(a)}.bind(this),a.addOnHardImpactWithSceneryCallback(b))},onImpact:function(a){if(this.isAttacking()&&this.meleeAttack)this.meleeAttack.onImpact(a)},onHardImpactWithScenery:function(a){if(this.isAttacking()&&
this.meleeAttack)this.meleeAttack.onHardImpactWithScenery(a)},setWeapon:function(a){a=ba.archetypes[a];this.prepareDuration=this.safeCopy(a.prepareDuration,0.7);this.chargeDuration=this.safeCopy(a.chargeDuration,0.25);this.attackDuration=this.safeCopy(a.attackDuration,0.25);this.damageType=this.safeCopy(a.damageType,"DAMAGE_TYPE_SWIPE");this.attackType=this.safeCopy(a.attackType,"MeleeSwing");this.attackParameters=this.safeCopy(a.attackType,{});this.attackAngle=2*(this.safeCopy(a.attackAngle,45)*
Math.PI)*(1/360);this.attackRange=this.safeCopy(a.attackRange,2);this.beginAttackSound=a.beginAttackSound;this.attackImpactSound=a.attackImpactSound;this.initMeleeAttack()},initMeleeAttack:function(){var a=this.globals,b=this.attackType,c=this.attackParameters,d=this.entity;d&&(this.meleeAttack&&this.meleeAttack.getName()!==b&&(this.endAttack(),this.meleeAttack.destroy(),this.meleeAttack=null),this.meleeAttack||(c||(c={}),(this.meleeAttack=zb.createFromName(this.attackType,a,c))&&this.meleeAttack.attach(d)))},
update:function(){this._super();this.updateAttack();this.applyLeanToMesh()},charge:function(){this.chargeStartTime||(this.chargeStartTime=this.globals.gameCurrentTime)},release:function(){this.chargeStartTime=void 0},isCharging:function(){return void 0!==this.chargeStartTime},hasFinishedCharging:function(){return this.globals.gameCurrentTime-this.chargeStartTime>=this.chargeDuration},getPrepareFactor:function(){return!this.chargeStartTime?0:this.globals.mathDevice.remap(0.2,1,0,1,(this.globals.gameCurrentTime-
this.chargeStartTime)/this.prepareDuration)},attemptAttack:function(a){this.attackActive||(this.targetEntity=a,this.los=!0,this.playSound(this.beginAttackSound),this.startAttack());this.release()},isAttacking:function(){return this.attackActive},getDamage:function(){return this.attackDamage},startAttack:function(){var a=this.meleeAttack;a&&!this.attackActive&&(a.begin(),this.attackActive=!0)},updateAttack:function(){var a=this.meleeAttack;a&&this.attackActive&&(a.update(),a.isFinished()&&this.endAttack())},
endAttack:function(){var a=this.meleeAttack;a&&this.attackActive&&(a.end(),this.attackActive=!1)},dealDamage:function(){this.targetEntity&&!this.targetEntity.toBeDestroyed&&this.attack(this.targetEntity,this.getDamage(),this.los&&this.isWithinRange(this.targetEntity))},attack:function(a,b,c){var d=this.gameManager.damager,b=this.globals.mathDevice;if(!this.entity.shouldBeDestroyed()){var f=this.getEntityEC("ECLocomotion");f?f=f.getNormalizedDirection():(f=b.v3Sub(a.getv3Location(),this.getv3Location()),
b.v3Normalize(f,f));c&&(a&&this.isManagedByThisMachine())&&d.archetypes[this.damageType].applyToArc(this.entity,f,this.getv3Location(),this.attackRange,this.attackAngle);this.playSound(this.attackImpactSound);c=this.gameManager.actionManager;this.isManagedByThisMachine()&&(c.addAction("VisualEffect",{archetype:"meleeHit",v3Location:b.v3Lerp(this.getv3Location(),a.getv3Location(),0.5),v3Direction:b.v3Copy(f)}),c.addAction("VisualEffect",{archetype:"meleeHit",v3Location:b.v3Lerp(this.getv3Location(),
a.getv3Location(),0.5)}))}},dealRadialDamage:function(a){var b=this.targetEntity,c=this.gameManager.damager,d=this.globals.mathDevice,f=this.getEntityEC("ECLocomotion"),e=!1;b&&(!b.toBeDestroyed&&this.isManagedByThisMachine())&&(f?b=f.getNormalizedDirection():(b=d.v3Sub(b.getv3Location(),this.getv3Location()),d.v3Normalize(b,b)),e=c.archetypes[this.damageType].applyToArea(this.entity,b,this.getv3Location(),null,a));return e},isWithinAttackRegion:function(a){var b=this.globals.mathDevice,c=this.getEntityEC("ECLocomotion"),
a=b.v3Sub(a,this.getv3Location()),c=c.getNormalizedDirection();if(b.v3Length(a)>this.attackRange)return!1;a=b.v3ToAngle(a);c=b.v3ToAngle(c);return b.diffAngles(c,a)<0.5*this.attackAngle},applyLeanToMesh:function(){var a,b=this.getEntityEC("ECLocomotion");b&&!this.isAttacking()&&(a=this.getPrepareFactor(),b.setAdditionalX(0.75*a),b.setAdditionalY(0.5*a))},draw:function(){var a=this.meleeAttack;a&&a.draw()},drawDebug:function(){var a=this.globals,b=a.mathDevice,a=a.debugDraw,c=this.getv3Location(),
d=this.getEntityEC("ECLocomotion").getNormalizedDirection(),d=b.v3ScalarMul(d,this.attackRange),f=b.v3BuildYAxis(),e=0.5*this.attackAngle,h=b.m43FromAxisRotation(f,-e),f=b.m43FromAxisRotation(f,e),h=b.m43TransformVector(h,d),f=b.m43TransformVector(f,d),d=b.v3Add(c,h),h=b.v3Add(c,f),f=[0,1,0];this.isWithinAttackRegion(this.gameManager.getHero().getv3Location())&&(f[0]=1,f[1]=0);a.drawDebugLine(c,d,f[0],f[1],f[2]);a.drawDebugLine(c,h,f[0],f[1],f[2]);a.drawDebugCircle(c,b.v3BuildYAxis(),this.attackRange,
f[0],f[1],f[2])},drawTargetCross:function(a,b){for(var c=this.globals,d=c.mathDevice,f=c.simpleSpriteRenderer,e=2*Math.PI/8,h=c.camera.screenRadiusToWorldRadius(a,100),i,j,k,l=this.getCanFireFactor(),m,c=0;8>c;c+=1)m=d.remap(c,c+1,0,1,8*l)*b,i=d.lerp(1,0.3,m),i*=d.lerp(1,0.35+0.65*((c+1)%2),m),i*=d.remap(c,c+1,1,0.5,0),j=0.5*d.lerp(1,1+1*((c+1)%2),m)*Math.PI,k=d.lerp(1,1+0.5*((c+1)%2),m),f.addSprite({v3Location:a,size:0.1*k,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:"textures/vertical.dds",
v4color:d.v4Build(1,1,1,0.35+0.65*m),angle:0+c*e+j,offsetAngle:0+c*e,offsetY:1*h*i})},drawTarget:function(a,b,c){this.drawTargetCross(a.getCentreLocation(),c)},needsNavLOS:function(){return this.archetype.needsNavLOS},isWithinRange:function(a,b){var c,d,f;c=a.getDistanceUsingSize(this.getv3Location());d=this.attackRange;void 0!==b&&(d=b);if(c<d)if(this.needsNavLOS()){if(c=this.gameManager,c=c.getNavManager(),d=this.getEntityEC("ECFaction"),f=this.getEntityEC("ECNav"),c&&(d&&f)&&(f=f.getMaxNavigableHeight(),
c.hasEntityToEntityLOS(this.entity,a,d.getFactionName(),f)))return!0}else return!0;else return!1},getSpeedMod:function(){return this.isAttacking()&&this.meleeAttack?this.meleeAttack.getSpeedMod():1},serialize:function(a){this._super(a)},serializeDelta:function(){}});F.prototype.eCCreationMap[yh.prototype.entityComponentName]=yh;yh.create=function(a,b){return new yh(a,b)};var zh=F.extend({entityComponentName:"ECMeleeTarget",updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!0,
shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{},attackRateReductionPerExtraEnemy:-0.2,attackRateForSingleEnemy:1,init:function(a,b){b||(b={});this._super(a,b);this.currentAttackers=[];this.previousAttackTime=null},canAttack:function(){var a;if(null===this.previousAttackTime)return!0;a=this.getCurrentWaitDuration();return this.globals.gameCurrentTime-this.previousAttackTime>=a},getCurrentWaitDuration:function(){var a=this.attackRateReductionPerExtraEnemy*this.currentAttackers.length+
(this.attackRateForSingleEnemy-this.attackRateReductionPerExtraEnemy),a=Math.min(a,this.attackRateForSingleEnemy);return a=Math.max(a,0)},startAttack:function(a){this.currentAttackers.push(a);this.previousAttackTime=this.globals.gameCurrentTime},endAttack:function(a){var b=this.currentAttackers,a=b.indexOf(a);-1!==a&&b.splice(a,1)},update:function(){this._super()},serialize:function(a){this._super(a);a.currentAttackers=this.currentAttackers;a.previousAttackTime=this.previousAttackTime;a.attackRateForSingleEnemy=
this.attackRateForSingleEnemy;a.attackRateReductionPerExtraEnemy=this.attackRateReductionPerExtraEnemy},serializeDelta:function(){this._super()}});zh.create=function(a,b){return new zh(a,b)};F.prototype.eCCreationMap[zh.prototype.entityComponentName]=zh;var Je=F.extend({entityComponentName:"ECMesh",updatePeriod:0,sortPriority:7,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!0,shouldSave:!0,shouldLevelSave:!0,realTime:!0,parameters:{path:"environment/models/prototype_cube04.dae",
pathBackup:"models/axes.dae",rotationX:{description:"Rotation (radians) around x-axis",type:"slider",defaultValue:0,minValue:-Math.PI,maxValue:Math.PI},rotationY:{description:"Rotation (radians) around y-axis",type:"slider",defaultValue:0,minValue:-Math.PI,maxValue:Math.PI},rotationZ:{description:"Rotation (radians) around z-axis",type:"slider",defaultValue:0,minValue:-Math.PI,maxValue:Math.PI},randomRotationY:{description:"Random Rotation (radians) around y-axis",type:"slider",defaultValue:0,minValue:0,
maxValue:Math.PI},scale:{description:"Overall scale factor",type:"slider",defaultValue:1,minValue:0,maxValue:5},scaleX:{description:"X-axis scale factor",type:"slider",defaultValue:1,minValue:0,maxValue:5},scaleY:{description:"Y-axis scale factor",type:"slider",defaultValue:1,minValue:0,maxValue:5},scaleZ:{description:"Z-axis scale factor",type:"slider",defaultValue:1,minValue:0,maxValue:5},randomScale:{description:"Scale Variation",type:"slider",defaultValue:0,minValue:0,maxValue:0.9},localOffset:[0,
0,0],offsetY:{description:"Y-local offset",type:"slider",defaultValue:0,minValue:-2,maxValue:2}},scale:1,timeOutCounter:3,timeOutCounterStart:3,init:function(a,b){this._super(a,b);var c=this.globals.mathDevice;this.localOffset=c.v3BuildZero();this.dirtyOffset=!0;this.randomScale=c.randomInRange(1-b.randomScale,1+b.randomScale);this.randomRotationY=c.randomInRange(-b.randomRotationY,b.randomRotationY);this.v3Rotation=c.v3BuildZero();this.dirtyRotation=!0;this.scale=1;this.v3Scale=c.v3BuildOne();this.dirtyScale=
!0;this.m43Transform=c.m43BuildIdentity();this.timeOutCounter=0;this.scratchPad={}},activate:function(){this._super();this.updateMatrix();this.loadMesh(this.getPath())},setPath:function(a){this.path=a},getPath:function(){return this.path||this.archetype.path},updateMatrixOld:function(){var a=this.globals.mathDevice;this.buildDirection(this.m43Transform);this.m43Unscaled=a.m43Copy(this.m43Transform,this.m43Unscaled);this.buildScale(this.m43Transform);this.buildRotation(this.m43Unscaled,this.m43Transform);
this.buildLocation(this.m43Unscaled,this.m43Transform)},updateMatrix:function(){this.buildLocalOffsetScaleRotationLocation(this.m43Transform)},buildLocalOffsetScaleRotationLocation:function(a){var b=this.globals.mathDevice,c=this.archetype,d=this.scratchPad,f;this.dirtyScale&&(f=this.scale*c.scale*this.randomScale,this.v3TotalScale=b.v3Build(f*this.v3Scale[0]*c.scaleX,f*this.v3Scale[1]*c.scaleY,f*this.v3Scale[2]*c.scaleZ,this.v3TotalScale),f=this.entity.getV3Scale(),b.v3Mul(f,this.v3TotalScale,this.v3TotalScale),
this.dirtyScale=!1);this.dirtyRotation&&(this.v3TotalRotation=b.v3Build(this.v3Rotation[0]+c.rotationX,this.v3Rotation[1]+c.rotationY+this.randomRotationY+this.entity.getRotationY(),this.v3Rotation[2]+c.rotationZ,this.v3TotalRotation),this.dirtyRotation=!1);this.dirtyOffset&&(this.totalOffset=b.v3Add(this.localOffset,c.localOffset,this.totalOffset),this.totalOffset[1]+=c.offsetY,this.dirtyOffset=!1);b.m43BuildScaleTranslate(this.v3TotalScale,this.totalOffset,a);b.v3IsZero(this.v3TotalRotation)||(d.m43RotationMatrix=
b.m43BuildRotationXZY(this.v3TotalRotation,d.m43RotationMatrix),b.m43Mul(a,d.m43RotationMatrix,a));this.m43BaseTransformMatrix?(b.m43Mul(a,this.m43BaseTransformMatrix,a),this.baseTransformNoLocation&&b.m43Translate(a,this.getv3Location())):b.m43Translate(a,this.getv3Location())},removeNode:function(){this.node&&(this.globals.scene.removeRootNode(this.node),this.node=null)},loadMesh:function(a){a!==this.meshPath&&(this.removeNode(),this.meshPath=a,this.node=this.globals.simpleSceneLoader.load(a,this.m43Transform),
this.setDirtyMatrix(!0),(a=this.entity.getEC("ECAnimationPlayer"))&&a.updateController(0))},getMeshPath:function(){return this.meshPath},teleport:function(){this.update()},onRotated:function(){this.dirtyRotation=!0;this.setDirtyMatrix(!0)},onMoved:function(){this.setDirtyMatrix(!0)},onScaled:function(){this.dirtyScale=!0;this.setDirtyMatrix(!0)},update:function(){this._super();var a=this.entity;if(a.movedThisFrame||a.rotatedThisFrame||a.scaledThisFrame)this.dirtyRotation=a.rotatedThisFrame||this.dirtyRotation,
this.dirtyScale=a.scaledThisFrame||this.dirtyScale,this.setDirtyMatrix(!0);this.dirtyMatrix?(this.timeOutCounter=this.timeOutCounterStart,this.updateMatrix(),this.node.setLocalTransform(this.m43Transform),this.dirtyMatrix=!1,this.dirtySerialize=!0):(this.timeOutCounter-=1,0>=this.timeOutCounter&&(this.setInterestedInMovement(!0),this.setInterestedInRotation(!0),this.setInterestedInScaling(!0),this.setToUpdate(!1)))},setDirtyMatrix:function(a){if(this.dirtyMatrix!==a&&(this.dirtyMatrix=a))this.setInterestedInMovement(!1),
this.setInterestedInRotation(!1),this.setInterestedInScaling(!1),this.setToUpdate(!0)},copyTransform:function(a){a&&(this.setScale(a.getScale()),this.setv3Rotation(a.v3Rotation),this.setV3Scale(a.getV3Scale()),this.setLocalOffset(a.getLocalOffset()))},setm33TransformMatrix:function(a){var b=this.globals.mathDevice;if(!this.m33TransformMatrix||!b.m33Equal(a,this.m33TransformMatrix))this.m33TransformMatrix=b.m33Copy(a,this.m33TransformMatrix),this.setDirtyMatrix(!0)},getm43BaseTransformMatrix:function(){return this.m43BaseTransformMatrix},
clearm43BaseTransformMatrix:function(){this.m43BaseTransformMatrix&&(this.m43BaseTransformMatrix=void 0)},clearm43BaseTransformMatrixOffset:function(){var a=this.globals.mathDevice;this.m43BaseTransformMatrix&&(a.m43SetPos(this.m43BaseTransformMatrix,a.v3BuildZero()),this.baseTransformNoLocation=!0,this.setDirtyMatrix(!0))},setm43BaseTransformMatrix:function(a){var b=this.globals.mathDevice;if(!this.m43BaseTransformMatrix||!b.m43Equal(a,this.m43BaseTransformMatrix))this.m43BaseTransformMatrix=b.m43Copy(a,
this.m43BaseTransformMatrix),this.baseTransformNoLocation=!1,this.setDirtyMatrix(!0)},setUp:function(a){var b=this.globals.mathDevice;this.setRotationY(b.v3ToAngle(a));this.setRotationX(-Math.atan2(b.v3Length2D(a),a[1]))},addRotationX:function(a){a=w.boundAngle(this.v3Rotation[0]+a);this.setRotationX(a)},setv3Rotation:function(a){var b=this.globals.mathDevice;b.v3Equal(a,this.v3Rotation)||(b.v3Copy(a,this.v3Rotation),this.dirtyRotation=!0,this.setDirtyMatrix(!0))},setRotationX:function(a){w.equal(a,
this.v3Rotation[0])||(this.v3Rotation[0]=a,this.dirtyRotation=!0,this.setDirtyMatrix(!0))},addRotationY:function(a){a=w.boundAngle(this.v3Rotation[1]+a);this.setRotationY(a)},setRotationY:function(a){w.equal(a,this.v3Rotation[1])||(this.v3Rotation[1]=a,this.dirtyRotation=!0,this.setDirtyMatrix(!0))},getRotationY:function(){return this.v3Rotation[1]},getBaseRotationY:function(){return this.archetype.rotationY},addRotationZ:function(a){a=w.boundAngle(this.v3Rotation[2]+a);this.setRotationZ(a)},setRotationZ:function(a){w.equal(a,
this.v3Rotation[2])||(this.v3Rotation[2]=a,this.dirtyRotation=!0,this.setDirtyMatrix(!0))},disableScaling:function(){this.scalingDisabled=!0},enableScaling:function(){this.scalingDisabled=!1},setScale:function(a){!w.equal(a,this.scale)&&!this.scalingDisabled&&(this.scale=a,this.dirtyScale=!0,this.setDirtyMatrix(!0))},getScale:function(){return this.scale},getV3Scale:function(){return this.v3Scale},getScaleY:function(){return this.v3Scale[1]},getv3ManipulatedScale:function(){return this.globals.mathDevice.v3ScalarMul(this.v3Scale,
this.scale)},getV3TotalScale:function(){return this.v3TotalScale},getV3ScaleToManipulate:function(){return this.globals.mathDevice.v3ScalarMul(this.v3Scale,this.scale)},getSummedScale:function(){return this.scale*this.archetype.scale},getBaseScale:function(){return this.archetype.scale},setV3Scale:function(a){w.v3Equal(a,this.v3Scale)||(this.v3Scale=this.globals.mathDevice.v3Copy(a),this.dirtyScale=!0,this.setDirtyMatrix(!0))},setScaleX:function(a){w.equal(a,this.v3Scale[0])||(this.v3Scale[0]=a,this.dirtyScale=
!0,this.setDirtyMatrix(!0))},setScaleY:function(a){w.equal(a,this.v3Scale[1])||(this.v3Scale[1]=a,this.dirtyScale=!0,this.setDirtyMatrix(!0))},setScaleZ:function(a){w.equal(a,this.v3Scale[2])||(this.v3Scale[2]=a,this.dirtyScale=!0,this.setDirtyMatrix(!0))},setLocalOffset:function(a){var b=this.globals.mathDevice;if(!this.localOffset||!b.v3Equal(a,this.localOffset,0))this.localOffset=b.v3Copy(a,this.localOffset),this.dirtyOffset=!0,this.setDirtyMatrix(!0)},getBaseLocalOffset:function(){return this.archetype.localOffset},
getLocalOffset:function(){return this.localOffset},buildDirection:function(a){var b=this.globals.mathDevice;if(this.m33TransformMatrix)b.m43FromM33V3(this.m33TransformMatrix,b.v3BuildZero(),a);else if(!this.up&&!this.at&&!this.right)b.m43BuildIdentity(a);else{var c=this.up||b.v3BuildYAxis(),d=this.at||b.v3BuildZAxis(),f=this.right||b.v3BuildXAxis();this.up&&!this.right&&(0.01>b.v3DistanceSq(c,d)&&b.v3BuildXAxis(d),b.v3Cross(c,d,f),b.v3Normalize(f,f),b.v3Cross(f,c,d));b.m43SetRight(a,f);b.m43SetUp(a,
c);b.m43SetAt(a,d);b.m43Orthonormalize(a,a)}},buildRotation:function(a,b){var c=this.globals.mathDevice,d=this.archetype,f=this.v3Rotation[0]+d.rotationX,e=this.v3Rotation[1]+d.rotationY+this.randomRotationY,h=this.v3Rotation[2]+d.rotationZ;if(e||h)d=c.m33BuildIdentity(),0!==f&&c.m33RotateX(d,f,d),0!==h&&c.m33RotateZ(d,h,d),0!==e&&c.m33RotateY(d,e,d),f=c.v3BuildZero(),f=c.m43FromM33V3(d,f),c.m43Mul(a,f,a),c.m43Mul(b,f,b)},buildScale:function(a){var b=this.globals.mathDevice,c=this.archetype,d=this.scale*
c.scale*this.randomScale;b.m43Scale(a,b.v3Build(d*this.v3Scale[0]*c.scaleX,d*this.v3Scale[1]*c.scaleY,d*this.v3Scale[2]*c.scaleZ),a)},buildLocation:function(a,b){var c=this.globals.mathDevice,d=this.getv3Location();this.m43BaseTransformMatrix?(c.m43Mul(b,this.m43BaseTransformMatrix,b),c.m43Mul(a,this.m43BaseTransformMatrix,a)):(c.m43SetPos(b,d),c.m43SetPos(a,d));void 0!==this.localOffset&&c.m43SetPos(b,c.m43TransformPoint(a,this.localOffset))},draw:function(){},getm43Transform:function(){return this.m43Transform},
getX:function(){return this.globals.mathDevice.m43Right(this.m43Transform)},getY:function(){return this.globals.mathDevice.m43Up(this.m43Transform)},getZ:function(){return this.globals.mathDevice.m43At(this.m43Transform)},transformPoint:function(a,b){return this.globals.mathDevice.m43TransformPoint(this.m43Transform,a,b)},getTransformedv3Location:function(){return this.globals.mathDevice.m43Pos(this.m43Transform)},setOnlySaveRotation:function(a){this.onlySaveRotation=a},saveSerialize:function(){var a=
{};a.rotationY=this.getRotationY();a.scale=this.scale;a.v3Scale=this.v3Scale;this.path&&(a.path=this.path);return a},serialize:function(a){this._super(a);this.onlySaveRotation?a.rotationY=this.rotationY:(a.scale=this.scale,a.v3Scale=this.v3Scale,this.up&&(a.up=this.up),this.at&&(a.at=this.at),this.right&&(a.right=this.right),this.localOffset&&(a.localOffset=this.localOffset),a.v3Rotation=this.v3Rotation,a.dr=this.dr||this.r,a.dg=this.dg||this.g,a.db=this.db||this.b)},serializeDelta:function(a){this.dirtySerialize&&
!this.disableDeltaSerialize&&(this.serialize(a),this.dirtySerialize=!1)},deserialize:function(a){void 0!==a.rotationY&&this.setRotationY(a.rotationY);this._super(a);this.entity&&(this.updateMatrix(),this.setDirtyMatrix(!0))},destroy:function(){this._super();this.removeNode()}});F.prototype.eCCreationMap[Je.prototype.entityComponentName]=Je;Je.preloadComponent=function(a,b){var c=a.simpleSceneLoader;if(!c.isLoadingMesh(b.path)){var d=Sa.create({name:"temp",dynamic:!1,disabled:!0});c.load(b.path,void 0,
void 0,d,b.numInstances)}};Je.create=function(a,b){return new Je(a,b)};var Ah=F.extend({entityComponentName:"ECMeshAnimation",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldAlwaysUpdate:!1,shouldDraw:!1,shouldSerialize:!1,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,storeGlobalList:!1,parameters:{v3RotationSpeed:[0,0.4,0],v3Offset:[0,0.0625,0],v3OffsetFrequency:[0,1/6,0],v3Oscillate:[0,0,0],v3OscillateFrequency:[0,0,0]},init:function(a,b){this._super(a,b);var c=a.mathDevice;this.scratchpad=
{v3Temp:a.mathDevice.v3BuildZero()};this.randomOffset=Math.random();this.v3RandomOffset=c.v3Build(Math.random(),Math.random(),Math.random());this.v3RotationRandomOffset=c.v3Build(Math.random(),Math.random(),Math.random());this.v3RotationRandomOffset[0]/=0<this.archetype.v3RotationSpeed[0]?this.archetype.v3RotationSpeed[0]:1;this.v3RotationRandomOffset[1]/=0<this.archetype.v3RotationSpeed[1]?this.archetype.v3RotationSpeed[1]:1;this.v3RotationRandomOffset[2]/=0<this.archetype.v3RotationSpeed[2]?this.archetype.v3RotationSpeed[2]:
1},activate:function(){this._super()},update:function(){this._super();var a=this.globals,b=a.mathDevice,c=this.archetype,d=this.getEntityEC("ECMesh");if(!this.flyingTween){var f=this.scratchpad,a=a.gameCurrentTime;if(d){var e=c.v3RotationSpeed,h=c.v3OscillateFrequency,i=c.v3Oscillate;if(!b.v3IsZero(e)||!b.v3IsZero(i))d.setv3Rotation(b.v3Build((0>=i[0]?0:i[0]*Math.sin((a*h[0]+this.v3RandomOffset[0])*2*Math.PI))+e[0]*(a+this.v3RotationRandomOffset[0]),(0>=i[1]?0:i[1]*Math.sin((a*h[1]+this.v3RandomOffset[1])*
2*Math.PI))+e[1]*(a+this.v3RotationRandomOffset[1]),(0>=i[2]?0:i[2]*Math.sin((a*h[2]+this.v3RandomOffset[2])*2*Math.PI))+e[2]*(a+this.v3RotationRandomOffset[2]),f.v3Temp));e=c.v3Offset;c=c.v3OffsetFrequency;b.v3IsZero(e)||d.setLocalOffset(b.v3Build(0>=e[0]?0:e[0]*Math.sin((a*c[0]+this.v3RandomOffset[0])*2*Math.PI),0>=e[1]?0:e[1]*Math.sin((a*c[1]+this.v3RandomOffset[1])*2*Math.PI),0>=e[2]?0:e[2]*Math.sin((a*c[2]+this.v3RandomOffset[2])*2*Math.PI),f.v3Temp))}}},draw:function(){},drawDebug:function(){},
manageLargeTimeStep:function(a){this._super(a)},serialize:function(a){this._super(a)},serializeDelta:function(){},onDeath:function(){},onToBeDestroyed:function(){this._super()},destroy:function(){this._super()}});Ah.create=function(a,b){return new Ah(a,b)};F.prototype.eCCreationMap[Ah.prototype.entityComponentName]=Ah;var qc=F.extend({entityComponentName:"ECNav",sortPriority:4,realTime:!0,updatePeriod:0,shouldUpdate:!0,shouldDraw:!1,ecNavCount:0,waypointArrivalTolerance:0.3,debugLineToTargetWaypointColour:[0.5,
0,0],parameters:{canClimb:!0,canDrop:!1},init:function(a,b){this._super(a,b);this.path=null;this.lastQueryTime=0;qc.prototype.ecNavCount+=1},update:function(){this._super();this.path&&this.hasReachedTargetWaypoint()&&(this.targetWaypointIndex===this.endWaypointIndex?this.endPath():(this.targetWaypointIndex+=1,this.setTargetWaypointByIndex(this.targetWaypointIndex)))},shouldRequestPathQuery:function(){var a=this.gameManager.getNavManager(),b=this.globals.gameCurrentTime-this.lastQueryTime,a=a.getPathQueryPeriod();
return b>a},registerPathQuery:function(){this.lastQueryTime=this.globals.gameCurrentTime},hasAlreadyArrived:function(a){return 0.01>this.globals.mathDevice.v3Distance2DSq(this.getv3Location(),a)},getMaxNavigableHeight:function(){this.maxNavigableHeight||(this.maxNavigableHeight=[],this.archetype.canClimb?(this.maxNavigableHeight[0]=0.5,this.maxNavigableHeight[1]=-0.5):(this.maxNavigableHeight[0]=0,this.maxNavigableHeight[1]=0),this.archetype.canDrop&&(this.maxNavigableHeight[1]=-2));return this.maxNavigableHeight},
setDestinationEntity:function(a,b){var c=this.gameManager.getNavManager();if(this.shouldRequestPathQuery()||b){var d=this.getEntityEC("ECFaction"),d=d?d.getFactionName():null,f=this.getMaxNavigableHeight();return(c=c.getEntityToEntityPath(this.entity,a,d,f,b))?(this.registerPathQuery(),this.endPath(),this.setPath(c),!0):!1}return!0},setDestinationV3Location:function(a,b){var c=this.gameManager.getNavManager();if(!this.hasAlreadyArrived(a)&&(this.shouldRequestPathQuery()||b)){var d=this.getEntityEC("ECFaction"),
d=d?d.getFactionName():null,f=this.getMaxNavigableHeight();return(c=c.getV3ToV3Path(this.getv3Location(),a,d,f,b))?(this.registerPathQuery(),this.endPath(),this.setPath(c),!0):!1}return!0},getPathTotalLength:function(){return!this.isOnPath()?0:this.path.getTotalLength()},setPath:function(a){this.path=a;this.targetWaypointIndex=1;this.endWaypointIndex=a.getEndWaypointIndex();this.v3TargetWaypointLocation=null;this.setTargetWaypointByIndex(this.targetWaypointIndex)},endPath:function(){this.v3TargetWaypointLocation=
this.endWaypointIndex=this.targetWaypointIndex=this.path=null},hasReachedTargetWaypoint:function(){var a=this.globals.mathDevice,b=this.getv3Location();return a.v3Distance2DSq(b,this.v3TargetWaypointLocation)<this.waypointArrivalTolerance},setTargetWaypointByIndex:function(a){var b=this.getEntityEC("ECLocomotion");this.targetWaypointIndex=a;this.v3TargetWaypointLocation=this.path.getV3WaypointLocationByIndex(a);b.setDestination(this.v3TargetWaypointLocation)},isOnPath:function(){return null!==this.path},
getv3Destination:function(){return this.path?this.path.getV3WaypointLocationByIndex(this.endWaypointIndex):null},draw:function(){},drawDebug:function(){var a=this.path;if(a){var b=Math.max(this.targetWaypointIndex-1,0);a.debugDrawSection(b,this.endWaypointIndex,this.debugLineToTargetWaypointColour)}},serialize:function(a){this._super(a)},serializeDelta:function(){},destroy:function(){this._super();qc.prototype.ecNavCount-=1}});qc.create=function(a,b){return new qc(a,b)};F.prototype.eCCreationMap[qc.prototype.entityComponentName]=
qc;var Bh=F.extend({entityComponentName:"ECOrientate",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,init:function(a,b){this._super(a,b);this.v3LocationToFace=null;this.scratchpad={}},update:function(){this._super();if(this.v3LocationToFace){var a=this.getv3Location(),b=this.globals.mathDevice,c=1-Math.pow(1-this.archetype.angleLerpFactor,60*this.globals.gameTimeStep),d=this.getEntityEC("ECMesh"),f=this.scratchpad.v3Temp=
this.scratchpad.v3Temp||b.v3BuildZero(),e=0;d&&(e=b.v3ToAngle(b.m43At(d.getm43Transform(),f)),e-=d.getBaseRotationY());a=b.v3Sub(this.v3LocationToFace,a,f);a=b.v3ToAngle(a);a=b.boundAngle(a);e=b.lerpAngle(e,a,c);e=b.boundAngle(e);if(d){a=0;if(c=d.getm43BaseTransformMatrix())f=b.m43At(c,f),a=b.v3ToAngle(f);d.setRotationY(b.diffAngles(a,e))}}},setFacing:function(a){this.v3LocationToFace=this.globals.mathDevice.v3Copy(a)},clearFacing:function(){this.v3LocationToFace=null},draw:function(){},drawDebug:function(){},
serialize:function(a){this._super(a)},serializeDelta:function(){},destroy:function(){this._super()}});Bh.create=function(a,b){return new Bh(a,b)};F.prototype.eCCreationMap[Bh.prototype.entityComponentName]=Bh;var qa=F.extend({entityComponentName:"ECPhysicsSphere",updatePeriod:0,sortPriority:3,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!0,shouldSave:!1,realTime:!0,uniqueCounter:0,parameters:{bounce:0.5,canClimb:!1,fixed:!1,mass:{description:"Mass",type:"slider",defaultValue:100,
minValue:0,maxValue:1E3},radius:1,usesGravity:!0,height:0},directionType:{XPOS:0,YPOS:1,ZPOS:2,XNEG:3,YNEG:4,ZNEG:5},velClamp:15,init:function(a,b){this._super(a,b);var c=this.globals.mathDevice;this.v3Velocity=c.v3BuildZero();this.v3Acceleration=c.v3BuildZero();this.scratchpad={};this.frictionType=this.safeCopy(b.frictionType,qa.frictionType.GROUND);this.collisionLogs=[];this.valid=!0;this.onImpactCallbackFn=void 0;this.usingOnImpactCallbackList=!1;this.onImpactCallbackList=[];this.receivesSceneryImpactCallbacks=
!1;this.onHardImpactWithSceneryCallbackList=[];this.uniqueCollisionIndex=qa.prototype.uniqueCounter;qa.prototype.uniqueCounter+=1},activate:function(){this._super();this.impactEntity=this.entity},setFrictionOverride:function(a){this.frictionOverride=a},setFrictionType:function(a){this.frictionType=a},setValid:function(a){this.valid=a},isValid:function(){return this.valid},setVelocity:function(a){this.globals.mathDevice.v3Copy(a,this.v3Velocity)},clearVelocity:function(){this.globals.mathDevice.v3BuildZero(this.v3Velocity)},
clearAcceleration:function(){this.globals.mathDevice.v3BuildZero(this.v3Acceleration)},isFixed:function(){return this.archetype.fixed},getRadius:function(){return this.archetype.radius},setBounce:function(a){this.bounce=a},getBounce:function(){return this.bounce?this.bounce:this.archetype.bounce},getMass:function(){return this.archetype.mass},getInverseMass:function(){var a=this.getMass();return 0<a?1/a:0},update:function(){this._super();var a=this.globals.mathDevice,b=this.globals.physTimeStep;if(this.isFixed())a.v3BuildZero(this.v3Velocity);
else{if(this.archetype.usesGravity&&!this.ignoreGravity){var c=this.scratchpad;c.v3UpdateForce=a.v3Build(0,-this.gravity*this.getMass(),0,c.v3UpdateForce);this.applyForce(c.v3UpdateForce)}a.v3AddScalarMul(this.v3Velocity,this.v3Acceleration,b,this.v3Velocity);a.v3UpperLimitLength(this.v3Velocity,this.velClamp,this.v3Velocity);a.v3AddScalarMul(this.entity.v3Location,this.v3Velocity,b,this.entity.v3Location)}a.v3BuildZero(this.v3Acceleration)},draw:function(){},drawDebug:function(){var a=this.globals.debugDraw;
a.drawDebugSphere(this.entity.v3Location,this.getRadius(),0.5,0.5,0.5);0<this.getCapsuleHeight()&&a.drawDebugSphere(this.getv3CapsuleTopLocation(),this.getRadius(),0.5,0.5,0.5)},getCanClimb:function(){return this.archetype.canClimb},getv3Velocity:function(){return this.v3Velocity},getCapsuleHeight:function(){return this.archetype.height},getv3CapsuleTopLocation:function(){var a=this.globals.mathDevice,b=this.getCapsuleHeight();return 0<b?(this.v3CapsuleLocation=a.v3Copy(this.getv3Location()),this.v3CapsuleLocation[1]+=
b,this.v3CapsuleLocation):this.getv3Location()},getv3CapsuleBottomLocation:function(){var a=this.globals.mathDevice,b=this.getCapsuleHeight();return 0<b?(this.v3CapsuleLocation=a.v3Copy(this.getv3Location()),this.v3CapsuleLocation[1]-=b,this.v3CapsuleLocation):this.getv3Location()},serialize:function(a){this._super(a);a.v3Velocity=this.globals.mathDevice.v3Copy(this.v3Velocity);a.debugDraw=this.debugDraw},setGameSpace:function(a){a!==this.currentGameSpace&&(void 0!==this.currentGameSpace&&this.currentGameSpace.removePhysicsSphere(this),
this.currentGameSpace=a,void 0!==this.currentGameSpace&&this.currentGameSpace.addPhysicsSphere(this))},destroy:function(){this._super();this.setGameSpace(void 0);this.collisionLogs.length=0},getHasImpactedThisFrame:function(){return this.impacted},addOnImpactCallback:function(a){this.usingOnImpactCallbackList?0>this.onImpactCallbackList.indexOf(a)&&this.onImpactCallbackList.push(a):this.onImpactCallbackFn?(this.onImpactCallbackList.push(this.onImpactCallbackFn),a!==this.onImpactCallbackFn&&this.onImpactCallbackList.push(a),
this.usingOnImpactCallbackList=!0,this.onImpactCallbackFn=void 0):this.onImpactCallbackFn=a},onImpact:function(a){var b,c,d,f;this.impacted=!0;if(this.usingOnImpactCallbackList){b=this.onImpactCallbackList;c=b.length;for(d=0;d<c;d+=1)(f=b[d])&&f(a)}else if(this.onImpactCallbackFn)this.onImpactCallbackFn(a)},addOnHardImpactWithSceneryCallback:function(a){a&&0>this.onHardImpactWithSceneryCallbackList.indexOf(a)&&(this.onHardImpactWithSceneryCallbackList.push(a),this.receivesSceneryImpactCallbacks=!0)},
onHardImpactWithScenery:function(a){var b,c,d,f;this.impacted=!0;b=this.onHardImpactWithSceneryCallbackList;c=b.length;for(d=0;d<c;d+=1)(f=b[d])&&f(a)},applyForce:function(a){this.isFixed()||this.globals.mathDevice.v3AddScalarMul(this.v3Acceleration,a,1/this.getMass(),this.v3Acceleration)},reset:function(){var a=this.globals.mathDevice;a.v3BuildZero(this.v3Acceleration);a.v3BuildZero(this.v3Velocity)},setUseGravity:function(a){this.ignoreGravity=!a},prePhysicsClear:function(){this.impacted=this.softForce=
!1},shove:function(a){if(!this.isFixed()){var b=this.globals.mathDevice,c=this.getv3Location(),d=this.scratchpad;d.shoveToApply=b.v3Copy(a,d.shoveToApply);a=d.shoveToApply;a[1]=Math.max(a[1],0);b.v3Add(c,a,c)}},detectsCollision:function(a){var b=this.globals.mathDevice;if(!this.isValid()||!a.isValid())return!1;var c=this.getv3Location(),d=a.getv3Location(),a=this.getRadius()+a.getRadius();return b.v3DistanceSq(c,d)<a*a},resolveCollision:function(a){var b=this.globals.mathDevice,c=this.globals.physTimeStep,
d=this.scratchpad,f=this.getv3Location(),e=a.getv3Location(),h=!1;0===b.v3DistanceSq(f,e)&&(e[1]+=0.5*a.getRadius());this.v3Direction=b.v3Sub(e,f,this.v3Direction);f=b.v3Length(this.v3Direction);b.v3Normalize(this.v3Direction,this.v3Direction);var i=f-this.getRadius()-a.getRadius();d.v3this_next_vel=b.v3AddScalarMul(this.v3Velocity,this.v3Acceleration,c,d.v3this_next_vel);d.v3other_next_vel=b.v3AddScalarMul(a.v3Velocity,a.v3Acceleration,c,d.v3other_next_vel);d.v3relative_vel=b.v3Sub(d.v3other_next_vel,
d.v3this_next_vel,d.v3relative_vel);var f=b.v3Dot(d.v3relative_vel,this.v3Direction),f=Math.min(f,20),e=1+Math.max(0.5*(this.getBounce()+a.getBounce()),0),j=0.5,k=this.isFixed(),l=a.isFixed();if(3>Math.abs(f)){e=1;if(l||k)j=1;d.v3ShoveDisplacement=b.v3ScalarMul(this.v3Direction,i*j,d.v3ShoveDisplacement);this.shove(d.v3ShoveDisplacement);b.v3ScalarMul(d.v3ShoveDisplacement,-1,d.v3ShoveDisplacement);a.shove(d.v3ShoveDisplacement);this.softForce=!0;a.softForce=!0}else h=!0,this.playThud(),a.playThud();
d.v3relative_vel_tangential=b.v3AddScalarMul(d.v3relative_vel,this.v3Direction,-f,d.v3relative_vel_tangential);var m;this.frictionOverride?m=a.frictionOverride?Math.max(this.frictionOverride,a.frictionOverride):this.frictionOverride:a.frictionOverride&&(m=a.frictionOverride);void 0===m&&(m=this.getFriction(this.frictionType,a.frictionType));i=this.getMass();j=a.getMass();d.v3tangential_momentum_applied=b.v3ScalarMul(d.v3relative_vel_tangential,k?m*j:l?m*i:m*i*j/(i+j),d.v3tangential_momentum_applied);
this.applyForce(d.v3tangential_momentum_applied);b.v3ScalarMul(d.v3tangential_momentum_applied,-1,d.v3tangential_momentum_applied);a.applyForce(d.v3tangential_momentum_applied);if(!(0<=f)){d.v3radial_momentum_applied=b.v3ScalarMul(this.v3Direction,(k?e*j*f:l?e*i*f:e*i*j*f/(i+j))/c,d.v3radial_momentum_applied);this.applyForce(d.v3radial_momentum_applied);b.v3ScalarMul(d.v3radial_momentum_applied,-1,d.v3radial_momentum_applied);a.applyForce(d.v3radial_momentum_applied);if(a.impactEntity)this.onImpact(a.impactEntity);
else if(h&&this.receivesSceneryImpactCallbacks)this.onHardImpactWithScenery(this.v3Direction);if(this.impactEntity)a.onImpact(this.impactEntity);else if(h&&a.receivesSceneryImpactCallbacks)a.onHardImpactWithScenery(this.v3Direction)}},getDirectionType:function(a,b){return this.getDirectionTypeThreshold(a,0.7071,b)},getPerfectDirectionType:function(a,b){return this.getDirectionTypeThreshold(a,0.99,b)},getDirectionTypeThreshold:function(a,b,c){a=this.globals.mathDevice.v3Normalize(a,c);c=qa.prototype.directionType;
return Math.abs(a[0])>b?0<a[0]?c.XPOS:c.XNEG:Math.abs(a[1])>b?0<a[1]?c.YPOS:c.YNEG:Math.abs(a[2])>b?0<a[2]?c.ZPOS:c.ZNEG:-1},getDirectionVector:function(a){var b=this.globals.mathDevice,c=this.prototype.directions,d=qa.prototype.directionType;void 0===c&&(c=this.prototype.directions=[],c[d.XPOS]=b.v3Build(1,0,0),c[d.YPOS]=b.v3Build(0,1,0),c[d.ZPOS]=b.v3Build(0,0,1),c[d.XNEG]=b.v3Build(-1,0,0),c[d.YNEG]=b.v3Build(0,-1,0),c[d.ZNEG]=b.v3Build(0,0,-1));return c[a]},clearCollisionLogs:function(){var a,
b=this.collisionLogs;for(a=0;a<b.length;a+=1)this.collisionLogs[a]=!1},checkAndLogDirectionalCollision:function(a){var b=this.scratchpad;b.normalized_direction||(b.normalized_direction=this.globals.mathDevice.v3BuildZero());var c=this.getDirectionType(a,b.normalized_direction);if(this.collisionLogs[c])return!1;a=this.getPerfectDirectionType(a,b.normalized_direction);0<=a&&(this.collisionLogs[a]=!0);return!0},playThud:function(){void 0!==this.thudTime&&this.globals.gameCurrentTime<this.thudTime+0.75||
(this.playSound("thud"),this.thudTime=this.globals.gameCurrentTime)},getFriction:function(a,b){return qa.frictionValues[a][b]}});qa.prototype.gravity=20;qa.prototype.jumpForce=8;qa.frictionType={GROUND:0,CHARACTER:1,WALL:2};qa.defaultFriction=6;qa.frictionValues=[[qa.defaultFriction,qa.defaultFriction,qa.defaultFriction],[qa.defaultFriction,qa.defaultFriction,0],[qa.defaultFriction,0,qa.defaultFriction]];F.prototype.eCCreationMap[qa.prototype.entityComponentName]=qa;qa.create=function(a,b){return new qa(a,
b)};var Ke=F.extend({entityComponentName:"ECPhysicsCube",updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!0,parameters:{stationary:!1,offsetY:0,v3Scale:{description:"The Scale of the Physics Cube",defaultValue:[1,1,1],minValue:0,maxValue:10,step:0.1},scaleMesh:!0},init:function(a,b){this._super(a,b);this.setOffsetY(b.offsetY);this.setV3Scale(b.v3Scale)},activate:function(){this._super();var a=this.globals,b=this.entity,
c=b.gameManager,b=b.getEC("ECMesh"),d=a.mathDevice,f=this.archetype,e=this.v3Scale,h=this.offsetY,h=d.v3Add(this.entity.getv3Location(),d.v3Build(0,h,0)),d={stationary:f.stationary,terrainType:f.terrainType,v3Scale:d.v3Copy(e)};this.worldCube=ic.create(h,a,c,d);this.worldCube.entity=this.entity;this.randomSeed=Math.random();b&&this.shouldScaleMesh()&&b.setm33TransformMatrix(this.worldCube.buildTransformMatrix(this.randomSeed,this.entity.getGameSpace().getM43FullTransform()));f.stationary||this.setInterestedInMovement(!0);
this.ignoringCollision?(this.ignoringCollision=!1,this.setIgnoringCollision(!0)):this.ignoringCollision=!1},update:function(){this._super()},onMoved:function(){this.worldCube.setv3Location(this.getv3LocationWithOffset());void 0!==this.currentGameSpace&&this.currentGameSpace.movedCube(this.worldCube)},getv3LocationWithOffset:function(){var a;return void 0!==this.additionOffsetY||0!==this.offsetY?(a=this.globals.mathDevice,a=a.v3Copy(this.getv3Location()),this.additionOffsetY&&(a[1]+=this.additionOffsetY),
this.offsetY&&(a[1]+=this.offsetY),a):this.getv3Location()},setAdditionalOffsetY:function(a){a!==this.additionOffsetY&&(this.additionOffsetY=a,this.onMoved())},setV3Scale:function(a){this.v3Scale=this.globals.mathDevice.v3Copy(a)},setOffsetY:function(a){this.offsetY=a},shouldScaleMesh:function(){return this.archetype.scaleMesh},setIgnoringCollision:function(a){var b=this.worldCube;a!==this.ignoringCollision&&(this.ignoringCollision=a,b&&(b.ignoringCollision=a),void 0!==this.currentGameSpace&&(a&&
b.terrainType?this.currentGameSpace.removeCubeFromNavGrids(b):this.currentGameSpace.addCubeToNavGrids(b)))},setOnImpactCallback:function(a){this.worldCube.setOnImpactCallback(a)},draw:function(){},drawDebug:function(){this.globals.debugDraw.drawDebugHalfCube(this.entity.v3Location,1,0.5,0.5,0.5)},getv3Scale:function(){return this.v3Scale},getRadius:function(){var a;void 0===this.radius&&(a=this.globals.mathDevice,this.radius=0.5*a.v3Length(this.getv3Scale()));return this.radius},getMinRadius:function(){var a,
b;void 0===this.minRadius&&(a=this.getv3Scale(),b=a[0],b=Math.min(b,a[1]),b=Math.min(b,a[2]),this.minRadius=0.5*b);return this.minRadius},getExtents:function(){return this.worldCube.extents},getv3BottomLocation:function(){var a=this.worldCube,b=this.globals.mathDevice.v3Copy(a.getv3Location());b[1]=a.extents[1];return b},saveSerialize:function(){return{offsetY:this.offsetY,v3Scale:this.getv3Scale(),shouldSaveSerialize:this.getShouldSaveSerialize()}},serialize:function(){},deserialize:function(a){a.shouldSaveSerialize&&
this.setShouldSaveSerialize(!0);this._super(a)},setGameSpace:function(a){a!==this.currentGameSpace&&(void 0!==this.currentGameSpace&&this.currentGameSpace.removeCube(this.worldCube),this.currentGameSpace=a,void 0!==this.currentGameSpace&&this.currentGameSpace.addCube(this.worldCube))},destroy:function(){this._super();this.worldCube.destroy();this.setGameSpace(void 0)}});F.prototype.eCCreationMap[Ke.prototype.entityComponentName]=Ke;Ke.create=function(a,b){return new Ke(a,b)};var Qb=F.extend({entityComponentName:"ECPickup",
updatePeriod:0,sortPriority:4,shouldAlwaysUpdate:!0,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!0,shouldSave:!1,realTime:!0,parameters:{cost:0,health:0,itemAmmo:0,lifeTime:{description:"Lifetime of pickup before automatic destruction",type:"slider",minValue:0,maxValue:20},noAdd:!1,placed:!1,randomRadius:{description:"Maximum radius within which pickup is spread upon creation",type:"slider",defaultValue:0,minValue:0,maxValue:10},carriedResource:{description:"Resource given to collector of this pickup to carry",
defaultValue:[0,0],minValue:0,maxValue:100},resource:{description:"Resource given to collector of this pickup",defaultValue:[0,0],minValue:0,maxValue:100},softCurrency:{description:"Soft Currency given to collector of this pickup",type:"slider",defaultValue:0,minValue:0,maxValue:100},xp:{description:"Xp given to collector of this pickup",type:"slider",defaultValue:0,minValue:0,maxValue:100},pulseFrequency:{description:"How fast the sprite transparency changes",type:"slider",defaultValue:0,minValue:0,
maxValue:5},minPulseScale:{description:"The min scale when pulsing",type:"slider",defaultValue:1,minValue:0,maxValue:10},maxPulseScale:{description:"The max scale when pulsing",type:"slider",defaultValue:1,minValue:0,maxValue:10},attractRadius:{description:"The collection radius (m)",type:"slider",defaultValue:2,minValue:0,maxValue:10},attractDuration:{description:"The time (s) duration of the collection tween",type:"slider",defaultValue:0.25,minValue:0,maxValue:5},beginCollectScale:{description:"The scale multiplier applied to the pickup when the collection tween starts.",
type:"slider",defaultValue:1.25,minValue:1,maxValue:5}},yRotationFactor:4,init:function(a,b){this._super(a,b);this.placed=this.safeCopy(b.placed,!1);this.noAdd=this.safeCopy(b.noAdd,!1);this.item=b.item;this.itemAmmo=b.itemAmmo;this.pulsing=1!==b.minPulseScale||1!==b.maxPulseScale;this.randomOffset=2*Math.random()*Math.PI;this.attractDuration=this.safeCopy(b.attractDuration,0.2);this.beginCollectScale=this.safeCopy(b.beginCollectScale,1.25);this.scratchpad={v3Temp:a.mathDevice.v3BuildZero()};this.xp=
b.xp;void 0===Qb.prototype.liveCount&&(Qb.prototype.liveCount=0)},activate:function(){this._super();var a=this.archetype,b=this.getEntityEC("ECMesh");b&&(b.setRotationY(this.randomOffset),b.disableDeltaSerialize=!0);0<a.randomRadius&&this.generateDestLocation();this.animateAppear();var c=this.entity,b=c.getGameSpace(),c=c.gameManager;this.placed&&(!this.noAdd&&b)&&b.addPickup(1);a.score&&c.addPotentialScore(a.score);this.displayPrice();Qb.prototype.liveCount+=1},generateDestLocation:function(){var a=
this.globals.mathDevice,b=this.archetype,c=this.gameManager,d=this.getv3Location(),b=c.getTraversableLocationListInRadius(d,b.randomRadius);b.length&&(a=a.randomIntInRange(0,b.length-1),this.v3DestLocation=c.placeOnGround(b[a],0.5))},animateAppear:function(){var a=this.v3DestLocation||this.getv3Location(),b=0.15*Math.random();this.entity.setGameSpaceDynamic(!0);a=this.gameManager.placeOnGround(a,0.5);this.isManagedByThisMachine()&&a&&this.tweenToStartLocation(b,a);this.tweenUpDown(b)},tweenToStartLocation:function(a,
b){var c=this.getv3Location(),d=this,f=this.globals.mathDevice,e={x:b[0],y:b[1],z:b[2]},h=G.Easing.Circular.Out;G.Create({x:c[0],y:c[1],z:c[2]}).to(e,1+a).easing(h).onUpdate(function(){d.entity.setv3Location(f.v3Build(this.x,this.y,this.z,d.scratchpad.v3Temp))}).onComplete(function(){d.animatedIn=!0;d.entity.setGameSpaceDynamic(!1)}).start()},tweenUpDown:function(a){var b=this.globals,c=b.mathDevice,d=this,f=this.getEntityEC("ECMesh"),e=this.getEntityEC("ECSprite"),h=2*Math.random(),i={y:h+2,scale:1},
j=G.Easing.Circular.Out,a=G.Create({y:0,scale:0.2}).to(i,0.25+a).easing(j).onUpdate(f?function(){f.addRotationY(d.yRotationFactor*b.gameTimeStep);f.setLocalOffset(c.v3Build(0,this.y,0,d.scratchpad.v3Temp));f.setScale(this.scale)}:function(){e.setScale(this.scale);e.setOffset(0,this.y)}),i=G.Easing.Bounce.Out,h=G.Create({y:h+2}).to({y:0.5},1).easing(i).onUpdate(f?function(){f.addRotationY(d.yRotationFactor*b.gameTimeStep);f.setLocalOffset(c.v3Build(0,this.y,0,d.scratchpad.v3Temp))}:function(){e.setOffset(0,
this.y)});a.chain(h).start()},displayPrice:function(a){var b=this.getEntityEC("ECWorldText");b&&(this.archetype.cost&&!a?b.setText2("$"+this.archetype.cost.toString()+"!"):b.setText2("Owned"))},checkOwned:function(){if(!this.hasChecked){var a=this.gameManager.getHero();if(a&&(a=a.getEC("ECPlayerData"),!this.item||!a.getLoading()))this.hasChecked=!0}},update:function(){this._super();var a=this.globals,b=a.mathDevice,c=this.archetype,d=this.entity,f=this.getEntityEC("ECMesh"),e=this.getEntityEC("ECSprite");
this.beginFlyIfNeeded();this.checkOwned();if(!this.flyingTween){if(this.pulsing){var h=this.getPulseScale();e?e.setScale(h):f.setScale(h)}f&&(f.addRotationY(this.yRotationFactor*this.getTimeSinceLastUpdate()),this.animatedIn&&f.setLocalOffset(b.v3Build(0,0.25+0.25*Math.sin(3*a.gameCurrentTime+this.randomOffset),0,this.scratchpad.v3Temp)));0<=c.lifeTime&&(a=c.lifeTime-this.getParentAge(),this.entity.flashDeath(a),0>=a&&this.entity.setToBeDestroyed());if(this.isManagedByThisMachine()&&this.animatedIn){var i=
this,j,k,l,m=c.cost,q=c.carriedResource,p=this.getv3Location(),c=c.attractRadius;20<Qb.prototype.liveCount&&this.xp&&(c=100);var s=c*c;this.gameManager.applyToEntitiesInGridCellsWithinRadius(p,c,function(a){if(void 0===i.collectorName&&a!==d&&b.v3Distance2DSq(a.v3Location,p)<s){if(0<q[E.LUMBER]||0<q[E.STONE]){if(l=a.getEC("ECResourceCarrier"),!l||0<q[E.LUMBER]&&l.isFull(E.LUMBER)||0<q[E.STONE]&&l.isFull(E.STONE))return}else if(!a.hasEC("ECHero"))return;if(i.item&&(j=a.getEC("ECInventory"),!j||!j.canEquipItem(i.item))||
m&&(k=a.getEC("ECPlayerData"),!k))return;i.storeCollector(a)}})}}},getCarriedResource:function(a){return this.archetype.carriedResource[a]},getCollectorName:function(){return this.collectorName},hasBeenPickedUp:function(){var a=!1;this.collectorName&&(a=!0);return a},getPulseScale:function(){var a=this.archetype,b=Math.sin((this.globals.gameCurrentTime+this.randomOffset)*(2*Math.PI)*a.pulseFrequency);return b=0.5*(b+1)*(a.maxPulseScale-a.minPulseScale)+a.minPulseScale},storeCollector:function(a){var b=
a.getEC("ECHealth"),c=this.item,d;b&&0>=b.getHealth()||(0<this.archetype.carriedResource[E.LUMBER]&&(d=a.getEC("ECResourceCarrier"))&&d.adjustInbound(E.LUMBER,this.archetype.carriedResource[E.LUMBER]),0<this.archetype.carriedResource[E.STONE]&&(d||(d=a.getEC("ECResourceCarrier")),d&&d.adjustInbound(E.STONE,this.archetype.carriedResource[E.STONE])),this.reduceLiveCount(),c?(this.collectorName=a.name,this.givePickupIfCollector(),this.entity.setToBeDestroyed()):this.collectorName=a.name)},reduceLiveCount:function(){this.reducedLiveCount||
(Qb.prototype.liveCount-=1);this.reducedLiveCount=!0},beginFlyIfNeeded:function(){void 0!==this.collectorName&&!this.flyingTween&&this.beginFly()},beginFly:function(){var a=this,b=this.globals,c=b.mathDevice,d=this.getEntityEC("ECMesh"),f=this.getEntityEC("ECSprite"),e=c.v3Copy(this.getv3Location()),h=this.gameManager.getGameEntityByName(this.collectorName),i=this.getv3Location(),j;j=d?d.getScale():f.getScale();j*=this.beginCollectScale;var k=this.attractDuration,l=G.Easing.Circular.In;this.flyingTween=
G.Create({t:0,scale:j}).to({t:1,scale:0.5},k).easing(l).onUpdate(d?function(){var a=h.getv3Location();c.v3Lerp(e,a,this.t,i);d.addRotationY(8*b.gameTimeStep);d.setScale(this.scale)}:function(){var a=h.getv3Location();c.v3Lerp(e,a,this.t,i);f.setScale(this.scale)}).onComplete(function(){a.flyingTween=void 0;a.isManagedByThisMachine()&&(a.givePickupIfCollector(),a.entity.setToBeDestroyed())}).start()},giveToCollector:function(a){var b=this.archetype;if(a.isManagedByThisMachine()){if(b.health)this.onPickupHealth(a);
b.cost&&a.getEC("ECPlayerData");if(this.item)this.onPickupItem(a);this.onPickupCarriedResource(a);this.onPickupResource(a);this.onPickupSoftCurrency(a);this.onPickupXp(a)}},givePickupIfCollector:function(){var a=this.gameManager.actionManager,b;void 0!==this.collectorName&&(b=this.gameManager.getGameEntityByName(this.collectorName),a.addAction("GivePickup",{pickup:this.entity,collector:b}));this.collectorName=void 0},onPickupHealth:function(a){var b=this.archetype;if((a=a.getEC("ECHealth"))&&b.health)a.addHealth(b.health),
a.onHealthChange()},onPickupCarriedResource:function(a){var b=this.archetype;if(a=a.getEC("ECResourceCarrier"))for(var c=0;c<E.NUM_RESOURCES;c+=1)b.carriedResource[c]&&(a.adjustResource(c,b.carriedResource[c]),a.adjustInbound(c,-b.carriedResource[c]))},onPickupResource:function(a){var b=this.archetype,a=a.getEC("ECPlayerData");b.resource&&a&&(a.adjustResource(E.LUMBER,b.resource[E.LUMBER],!0),a.adjustResource(E.STONE,b.resource[E.STONE],!0))},onPickupSoftCurrency:function(a){var b=this.archetype,
a=a.getEC("ECPlayerData");b.softCurrency&&(a&&a.adjustSoftCurrency(b.softCurrency),this.gameManager.eventManager.notify("SoftCurrencyFound",b.softCurrency))},setXP:function(a){this.xp=a},onPickupXp:function(a){a=a.getEC("ECPlayerData");this.xp&&a&&a.adjustXP(this.xp)},onPickupItem:function(a){var a=a.getEC("ECInventory"),b=this.item;this.isItemTemporary()?a&&a.canEquipTemporaryWeapon(b)&&a.equipTemporaryWeapon(b,this.itemAmmo):a&&a.canEquipItem(b)&&a.equipWeapon(b)},isItemTemporary:function(){return 0<
this.itemAmmo},setClaimed:function(a){this.claimed=a},isClaimed:function(){return this.claimed},draw:function(){},drawDebug:function(){this.globals.debugDraw.drawDebugSphere(this.getv3Location(),0.5,1,1,0)},serialize:function(a){a.item=this.item;a.collectorName=this.collectorName},onToBeDestroyed:function(){this._super();var a=this.entity.getGameSpace();a&&this.placed&&a.removePickup(1);this.reduceLiveCount()},destroy:function(){this._super()}});F.prototype.eCCreationMap[Qb.prototype.entityComponentName]=
Qb;Qb.create=function(a,b){return new Qb(a,b)};var Ch=F.extend({entityComponentName:"ECPlacedBuildingTracker",updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,storeGlobalList:!1,parameters:{canMoveIfBuildingsAlreadyPlaced:!1,reduceHealthOfPlacedBuildingsWhenMove:!1},init:function(a,b){this._super(a,b);this.buildingCount={};this.totalBuildingCount=0;this.upgradableLocalCaps=null;this.buildLocalCaps()},shouldDeactivateBuildingsOutsideRange:function(){return this.archetype.reduceHealthOfPlacedBuildingsWhenMove},
activate:function(){this._super();this.upgradableLocalCaps=null;this.buildUpgradableLocalCaps();this.archetype.reduceHealthOfPlacedBuildingsWhenMove&&this.setToUpdate(!0)},update:function(){this._super();this.archetype.reduceHealthOfPlacedBuildingsWhenMove&&(this.globals.gameManager.eventManager.notify("BuildingTrackerMoved",this.entity),this.setToUpdate(!1))},buildLocalCaps:function(){if(void 0!==this.archetype.localCaps){this.localCaps={};var a=this.archetype.localCaps,b=a.length,c,d;for(c=0;c<
b;c+=1)d=a[c],this.localCaps[d.buildingType]=d.quantity}},buildUpgradableLocalCaps:function(){var a=this.localCaps,b,c,d=this.gameManager.getEntityFactory(),f=!1;c=!1;var e={};if((b=this.getEntityEC("ECUpgradable"))&&a)for(b=b.getUpgradeArchetypeName();b;)c=d.getECArchetype(b,"ECBuilding"),a=d.getECArchetype(b,"ECPlacedBuildingTracker"),b=d.getECArchetype(b,"ECUpgradable"),a&&c&&(c=c.level,c=this.addBuildingCapsToUpgradableLocalCaps(a.localCaps,e,c),f=f||c),b=b?b.upgradeArchetypeName:null;f&&(this.upgradableLocalCaps=
e)},addBuildingCapsToUpgradableLocalCaps:function(a,b,c){var d,f;d=this.localCaps;var e,h,i,j=!1;if(a&&d&&b){void 0===c&&(c=0);h=a.length;for(e=0;e<h;e+=1)if(f=a[e],d=f.buildingType,f=f.quantity,void 0===b[d]&&(i=this.localCaps[d],void 0===i||f>i))b[d]=c,j=!0}return j},getUpgradableLocalCaps:function(){return this.upgradableLocalCaps},getMinLevelToIncreaseLocalCapForBuildingType:function(a){var b;this.upgradableLocalCaps&&(b=this.upgradableLocalCaps[a]);return b},adjustBuildingCount:function(a,b){void 0===
this.buildingCount[a]&&(this.buildingCount[a]=0);this.buildingCount[a]+=b;this.totalBuildingCount+=b},getLocalBuildingCap:function(a){return!this.localCaps?void 0:this.localCaps[a]},getCanMove:function(){if(this.archetype.canMoveIfBuildingsAlreadyPlaced||0===this.totalBuildingCount)return!0},getBuildingCount:function(a){return this.buildingCount[a]?this.buildingCount[a]:0},createTempData:function(){return{buildingCount:this.buildingCount,totalBuildingCount:this.totalBuildingCount}},applyTempData:function(a){a&&
(this.buildingCount=a.buildingCount,this.totalBuildingCount=a.totalBuildingCount)},draw:function(){},drawDebug:function(){},serialize:function(a){this._super(a)},serializeDelta:function(){},destroy:function(){this._super()}});Ch.create=function(a,b){return new Ch(a,b)};F.prototype.eCCreationMap[Ch.prototype.entityComponentName]=Ch;var Dh=F.extend({entityComponentName:"ECPlayerData",sortPriority:4,updatePeriod:1,shouldUpdate:!0,shouldDraw:!0,shouldSerialize:!0,shouldDeltaSerialize:!0,shouldSave:!1,
realTime:!1,dataKeyScriptFlags:"scriptFlags",MIN_TIME_BETWEEN_SAVING_GAMESTATS:8,MAX_TIME_BETWEEN_SAVING_GAMESTATS:15,MIN_TIME_BETWEEN_SAVING_PROGRESS:8,init:function(a,b){this._super(a,b);this.playerData=a.gameManager.playerData;this.shouldAutoSaveGameStats=!1;this.lastGameStatSaveTime=0;this.shouldAutoSaveProgress=!1;this.lastProgressSaveTime=0;this.initScoreTimes();this.initResourceTime();this.initSoftCurrencyTime();this.initXPTime()},activate:function(){this._super();this.attachHandlers()},initResourceTime:function(){this.resourceTime=
[0,0];this.resourceStartPoint=[0,0]},initScoreTimes:function(){this.scorePingTime=this.scorePing=this.scoreStartPoint=this.scoreTime=0},initSoftCurrencyTime:function(){this.softCurrencyStartPoint=this.softCurrencyTime=0},initXPTime:function(){this.xpStartPoint=this.xpTime=0},attachHandlers:function(){var a=this.globals.gameManager.eventManager;this.addInvasionSurvivedCallback||a.subscribe("InvasionEnded",this.addInvasionSurvivedCallback);this.addResourceDispsenserDepletedByHeroCallback||(this.addResourceDispsenserDepletedByHeroCallback=
this.addResourceDispsenserDepletedByHero.bind(this),a.subscribe("ResourceDispsenserDepletedByHero",this.addResourceDispsenserDepletedByHeroCallback));this.addKillCallback||(this.addKillCallback=this.addKill.bind(this),a.subscribe("EnemyKilled",this.addKillCallback));this.addSoftCurrencyFoundCallback||(this.addSoftCurrencyFoundCallback=this.addSoftCurrencyFound.bind(this),a.subscribe("SoftCurrencyFound",this.addSoftCurrencyFoundCallback));this.onBuildingEventCallback||(this.onBuildingEventCallback=
this.onBuildingEvent.bind(this),a.subscribe("BuildingEvent",this.onBuildingEventCallback));this.onCampaignEndedCallback||(this.onCampaignEndedCallback=this.onCampaignEnded.bind(this),a.subscribe("CampaignEnded",this.onCampaignEndedCallback))},detachHandlers:function(){var a=this.globals.gameManager.eventManager;this.addResourceDispsenserDepletedByHeroCallback&&(a.unsubscribe("ResourceDispsenserDepletedByHero",this.addResourceDispsenserDepletedByHeroCallback),this.addResourceDispsenserDepletedByHeroCallback=
void 0);this.addKillCallback&&(a.unsubscribe("EnemyKilled",this.addKillCallback),this.addKillCallback=void 0);this.addSoftCurrencyFoundCallback&&(a.unsubscribe("SoftCurrencyFound",this.addSoftCurrencyFoundCallback),this.addSoftCurrencyFoundCallback=void 0);this.onBuildingEventCallback&&(a.unsubscribe("BuildingEvent",this.onBuildingEventCallback),this.onBuildingEventCallback=void 0);this.onCampaignEndedCallback&&(a.unsubscribe("CampaignEnded",this.onCampaignEndedCallback),this.onCampaignEndedCallback=
void 0)},loadInfoFromThisPlayer:function(){this.load()},update:function(){this._super();if(this.playerData.getHasLoadedGameStats()){var a=this.globals.gameCurrentTime,b=a-this.lastGameStatSaveTime,a=a-this.lastProgressSaveTime;(this.shouldAutoSaveGameStats&&b>=this.MIN_TIME_BETWEEN_SAVING_GAMESTATS||b>=this.MAX_TIME_BETWEEN_SAVING_GAMESTATS)&&this.saveGameStats();this.shouldAutoSaveProgress&&a>=this.MIN_TIME_BETWEEN_SAVING_PROGRESS&&this.saveProgress()}},getNumberOfGamesPlayed:function(){return this.playerData.getNumberOfGamesPlayed()},
getScriptFlags:function(){return this.playerData.getScriptFlags()},setScriptFlag:function(a,b){this.playerData.setScriptFlag(a,b);this.playerData.saveScriptFlags()},getResource:function(a){return this.playerData.getResource(a)},adjustResource:function(a,b,c){0!==b&&(c&&(c=this.gameManager.getGuiManager(),c.addResourceBubble(this.getv3Location(),b,a)),this.resourceStartPoint[a]=this.getVisibleResource(a),this.resourceTime[a]=this.globals.appCurrentTime,this.getResource(a)<this.getResourceCap(a)&&this.getResource(a)+
b>=this.getResourceCap(a)&&this.showFullMessage(a),this.playerData.adjustResource(a,b))},showFullMessage:function(a){this.gameManager.getGuiManager().addGameMessage("ecPlayerData"+this.entity.getName()+"resourceFull",Za[a].string+" storage","full!",4,Za[a].fullArchetype)},adjustXP:function(a){if(!(0>=a)){this.gameManager.getGuiManager().addXpBubble(this.getv3Location(),a);this.xpStartPoint=this.getVisibleXP();this.xpTime=this.globals.appCurrentTime;var b=this.getLevel();this.playerData.addXP(a);this.getLevel()>
b&&(this.saveProgress(),this.onLevelUp(),this.gameManager.refreshHeroEntity());this.autoSaveProgress()}},levelUp:function(){var a=this.getLevel()+1,b=this.getXP();(a=id.getXPFromLevel(a))&&this.adjustXP(a-b)},onLevelUp:function(){var a=this.globals.gameManager.getHero();a&&a.playEffect("sfx_hero_level_up");this.sendLevelUpMetric();this.sendLevelUpEvent();this.gameManager.getGuiManager().addGameMessage("ecPlayerData"+this.entity.getName()+"levelUp","Hero Rank Up","Level "+this.getLevel().toString(),
4,"newsflashRankUp");this.gameManager.getGameSoundManager().play("aud_celebrate")},sendLevelUpMetric:function(){this.globals.metricsManager.sendGameMetric("heroLevelledUp",this.getLevel())},sendLevelUpEvent:function(){this.globals.gameManager.eventManager.notify("HeroLevelledUp")},getUpgradedLevel:function(){return this.playerData.getHeroUpgrade("total")},canUpgrade:function(){return this.getUpgradedLevel()<this.getLevel()},getXP:function(){return this.playerData.getXP()},getTimeSinceAddedXP:function(){return this.globals.appCurrentTime-
this.xpTime},getVisibleXP:function(){var a=this.globals.mathDevice,b=this.getXP(),c=this.xpStartPoint,d=b-c,f=Math.max(100,d),d=Math.abs(d/f);return Math.round(a.lerp(c,b,a.saturate(this.getTimeSinceAddedXP()/d)))},getVisibleRank:function(){return this.getLevelFromXP(this.getVisibleXP())},getVisibleNextRankXP:function(){var a=this.getVisibleRank()+1;if(void 0!==id.xpTable[a])return id.xpTable[a]},getVisibleCurrentRankXP:function(){var a=this.getVisibleRank();if(void 0!==id.xpTable[a])return id.xpTable[a]},
getLevel:function(){return this.getLevelFromXP(this.getXP())},getLevelFromXP:function(a){return id.getLevelFromXP(a)},getTimeSinceAddedResource:function(a){return this.globals.appCurrentTime-this.resourceTime[a]},getVisibleResource:function(a){var b=this.globals.mathDevice,c=this.getResource(a),d=this.resourceStartPoint[a],f=c-d;if(0===f)return c;var e=0.25*this.getResourceCap(a);0>=e&&(e=100);a=(f=Math.abs(f/e))?b.saturate(this.getTimeSinceAddedResource(a)/f):0;return Math.round(b.lerp(d,c,a))},
adjustResourceCap:function(a,b){this.playerData.adjustResourceCap(a,b);this.resourceStartPoint[a]=this.getVisibleResource(a);this.resourceTime[a]=this.globals.appCurrentTime},getResourceCap:function(a){return this.playerData.getResourceCap(a)},getSoftCurrency:function(){return this.playerData.getSoftCurrency()},getVisibleSoftCurrency:function(){var a=this.globals.mathDevice,b=this.getSoftCurrency();return Math.round(a.lerp(this.softCurrencyStartPoint,b,a.saturate(this.getTimeSinceAddedSoftCurrency()/
1)))},adjustSoftCurrency:function(a){if(0!==a){0<a?this.playSound("pickupSoftCurrency"):this.gameManager.gameSoundManager.play("aud_amber_spend");var b,c=1;this.gameManager.getAmberCrown()&&0<a&&(c=2);0!==a&&(b=this.gameManager.getGuiManager(),b.addSoftCurrencyBubble(this.getv3Location(),a,c));this.softCurrencyStartPoint=this.getVisibleSoftCurrency();this.softCurrencyTime=this.globals.appCurrentTime;this.playerData.adjustSoftCurrency(a*c)}},consumeSoftCurrency:function(a){this.softCurrencyStartPoint=
this.getVisibleSoftCurrency();this.softCurrencyTime=this.globals.appCurrentTime;this.playerData.consumeSoftCurrency(a)},getConsumedSoftCurrency:function(){return this.playerData.getConsumedSoftCurrency()},setConsumedSoftCurrency:function(a){this.playerData.setConsumedSoftCurrency(a)},getTimeSinceAddedSoftCurrency:function(){return this.globals.appCurrentTime-this.softCurrencyTime},playScorePing:function(){this.scorePing=this.scorePingTime+2>this.globals.gameCurrentTime?this.scorePing+1:0;this.scorePingTime=
this.globals.gameCurrentTime;this.playSound("coinDing_"+(Math.min(this.scorePing,9)+1))},getLoading:function(){return this.playerData.getLoading()},draw:function(){if(this.playerData.getLoading()||this.playerData.getSaving()){var a=this.globals,b=a.simpleFontRenderer,a=a.graphicsDevice,a={x:a.width/2,y:a.height-50-20,pointSize:16,alignment:1};this.playerData.getLoading()&&b.drawFont("Loading Player...",a);this.playerData.getSaving()&&b.drawFont("Saving Player...",a)}},drawDebug:function(){},getScore:function(){return this.playerData.getScore()},
getVisibleScore:function(){var a=this.globals.mathDevice,b=this.getScore(),c=this.scoreStartPoint,d=Math.abs((b-c)/100);return Math.round(a.lerp(c,b,a.saturate(this.getTimeSinceAddedScore()/d)))},clearScore:function(){this.playerData.clearScore()},getTimeSinceAddedScore:function(){return this.globals.appCurrentTime-this.scoreTime},getKey:function(a){return a},load:function(){},saveResource:function(){this.playerData.saveResource()},saveGameStats:function(){var a=this.globals.gameCurrentTime;this.addTimePlayed(a-
this.lastGameStatSaveTime);this.lastGameStatSaveTime=a;this.shouldAutoSaveGameStats=!1;this.gameManager.saveGameStats&&this.playerData.saveGameStats();this.gameManager.autoUpdateLeaderboards()},saveProgress:function(){this.lastProgressSaveTime=this.globals.gameCurrentTime;this.shouldAutoSaveProgress=!1;this.playerData.saveProgress()},increaseNumberOfGamesPlayed:function(){this.playerData.increaseNumberOfGamesPlayed();this.playerData.saveNumberOfGamesPlayed()},autoSaveGameStats:function(){this.shouldAutoSaveGameStats=
!0;this.gameManager.autoUpdateBadges()},autoSaveProgress:function(){this.shouldAutoSaveProgress=!0},addPlayerScore:function(a){this.playerData.addPlayerScore(a);this.autoSaveGameStats()},getPlayerScore:function(){return this.playerData.getPlayerScore()},addKill:function(a){a.victim.getEC("ECAgent")&&(this.playerData.addKill(),this.autoSaveGameStats())},getTotalEnemiesKilled:function(){return this.playerData.getTotalEnemiesKilled()},addResourceDispsenserDepletedByHero:function(a){a.resourceType===
E.LUMBER?this.playerData.addTreeChopped():this.playerData.addRockDestroyed();this.autoSaveGameStats()},getTotalTreesChopped:function(){return this.playerData.getTotalTreesChopped()},getTotalRocksDestroyed:function(){return this.playerData.getTotalRocksDestroyed()},onBuildingEvent:function(a){"firstBuild"===a.reason&&"wall"===a.building.familyName&&this.addWallsBuilt(1)},onCampaignEnded:function(a){a&&(this.playerData.addCampaignsWon(1),this.autoSaveGameStats())},addWallsBuilt:function(a){this.playerData.addWallsBuilt(a);
this.autoSaveGameStats()},addTimePlayed:function(a){this.playerData.addTimePlayed(a);this.autoSaveGameStats()},getTotalTimePlayed:function(){return this.playerData.getTotalTimePlayed()},addSoftCurrencyFound:function(a){this.playerData.addSoftCurrencyFound(a);this.autoSaveGameStats()},getSoftCurrencyFound:function(){return this.playerData.getSoftCurrencyFound()},sendResourceRegisterMetric:function(){this.globals.metricsManager.sendGameMetric("resourceRegister",[this.getResource(E.LUMBER),this.getResource(E.STONE),
this.getSoftCurrency()])},destroy:function(){this._super();this.setGameSpace(void 0);this.detachHandlers()},serialize:function(a){this._super(a)},reset:function(){this.initScoreTimes();this.initResourceTime();this.initSoftCurrencyTime();this.playerData.reset()}});F.prototype.eCCreationMap[Dh.prototype.entityComponentName]=Dh;Dh.create=function(a,b){return new Dh(a,b)};var Eh=F.extend({entityComponentName:"ECPlayerLife",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldAlwaysUpdate:!0,shouldDraw:!1,
shouldSerialize:!0,shouldDeltaSerialize:!0,shouldSave:!1,realTime:!1,parameters:{infiniteLives:{description:"Whether or not the entity has infinite lives",type:"checkbox",defaultValue:!1},lives:{description:"The number of lives this entity has",type:"slider",defaultValue:3,minValue:0,maxValue:10,step:1},respawnDelay:{description:"The time delay after dying before this entity respawns",type:"slider",defaultValue:20,minValue:0,maxValue:60,step:0.1},respawnHighCostDelay:{description:"The time left to respawn that costs amber to skip",
type:"slider",defaultValue:10,minValue:0,maxValue:60,step:0.1},respawnInvulnerableTime:5},states:{NORMAL:0,DYING:1,RESPAWNING:2},RESPAWN_START_HEIGHT:2,init:function(a,b){this._super(a,b);this.state=this.states.NORMAL;this.deathAnimationDuration=1;this.deathTime=0;this.infiniteLives=this.safeCopy(b.infiniteLives,!1);this.lives=this.maxLives=this.safeCopy(b.lives,3)},update:function(){var a=this.states;this._super();this.state===a.NORMAL?this.updateDefault():this.state===a.DYING&&this.updateDeathAnimation();
this.updateScheduleRespawn();this.updateCheats();if(a=this.getTimeToRespawn())this.displayRespawnCountdown(a),this.displayRespawnOption(a)},isDead:function(){return void 0!==this.respawnTime},playOuch:function(){this.playSound("ouch")},updateDefault:function(){var a;if((a=this.getEntityEC("ECPhysicsSphere"))&&a.softForce)a=this.globals.mathDevice,this.v3SafeLocation=a.v3Copy(this.getv3Location(),this.v3SafeLocation)},updateCheats:function(){var a=this.globals.cheats;a.kill&&(a.kill=!1,a=this.getEntityEC("ECHealth"),
this.infiniteLives=!1,this.lives=0,a.takeDamage(1E3),this.loseLife())},loseLife:function(a){var b=this.gameManager.getScoreInfo();this.infiniteLives||(this.lives-=1);b.onHeroDeath();this.sendLoseLifeMetrics(a);this.beginRespawn()},sendLoseLifeMetrics:function(a){this.globals.metricsManager.sendGameMetric("heroDeath_"+a.archetypeName)},onTakeDamage:function(){this.gameManager.getScoreInfo();this.isManagedByThisMachine()},beginRespawn:function(){var a=this.getEntityEC("ECHealth");a.setInvulnerable(!0);
a.setDisableHealthBar(!0);this.playDeathAnimation(this.getV3RespawnLocation());this.state=this.states.DYING},draw:function(){void 0!==this.respawnTime&&this.drawStunned()},drawLives:function(a,b,c,d){var f=this.globals,e=f.mathDevice,h=f.simpleSpriteRenderer,i=this.getEntityEC("ECHero");if(i){var j=i.r,k=i.g,l=i.b,m=1*b,q=0,c=(void 0!==c?c:0)*b,i=i.getPulse(),i=i*b,p;d&&(p=e.m43At(f.camera.matrix),p[1]=0,e.v3Normalize(p,p));f=this.getLives();for(d=0;d<f;d+=1)q=2*(-1+d)*b,h.addSprite({v3Location:a,
size:1*(m+i),offsetX:q,offsetY:c,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:"textures/character.dds",v4color:e.v4Build(j,k,l,1),out:p})}},hasInfiniteLives:function(){return this.infiniteLives},getLives:function(){return this.lives},getMaxLives:function(){return this.maxLives},drawDebug:function(){this._super()},playDeathAnimation:function(a){var b=this.globals,c=b.mathDevice;if(!(this.state===this.states.DYING||this.state===this.states.RESPAWNING)){var d=this.getEntityEC("ECLocomotion");
this.deathTime=b.gameCurrentTime;this.respawnLocation=c.v3Copy(a,this.respawnLocation);d&&(d.reset(),d.setActive(!1))}},updateDeathAnimation:function(){var a=this.globals,b=this.deathTime,c=this.getDeathAnimationDuration(),a=a.gameCurrentTime-b;0<=a&&(c-=a,0>=c?this.startDelayedRespawn():this.entity.flashDeath(c))},startDelayedRespawn:function(){this.scheduleRespawn(this.respawnLocation,this.getRespawnDelay());this.state=this.states.RESPAWNING},getDeathAnimationDuration:function(){return this.deathAnimationDuration},
getRespawnDelay:function(){return this.archetype.respawnDelay},getRespawnHighCostDelay:function(){return this.archetype.respawnHighCostDelay},getTimeToRespawn:function(){var a=this.globals,b=0,c=this.respawnTime;a&&void 0!==c&&(b=c-a.gameCurrentTime);return b},updateScheduleRespawn:function(){var a;void 0!==this.respawnTime&&(a=this.getTimeToRespawn(),0>=a?(a=this.getEntityEC("ECHealth"),a.resetHealth(),a=this.getV3RespawnLocation(),this.respawn(a),this.respawnLocation=this.respawnTime=void 0,this.setToDraw(!1)):
(this.entity.showMesh(),this.setToDraw(!0)))},displayRespawnCountdown:function(a){a="Revive in: "+Math.ceil(a)+" s";this.gameManager.getGuiManager().addGameMessage("ecPlayerLife"+this.entity.getName()+"revive","You have been knocked out",a,2)},displayRespawnOption:function(a){var b=0,c=0,d=this.gameManager.getIMGui(),f=this.globals.guiRenderer,e=this.getRespawnHighCostDelay();a>e?(b=10,this.canAffordToRevive(b,c)&&d.doButton({id:"ecPlayerLife"+this.entity.getName()+"Respawn",text1:"BUY INSTANT REVIVE",
text2:""+b,v2ScreenLocation:f.getv2RenderLocation(0,-140,"bottom"),buttonType:aa.BUTTON_NORMAL,guiArchetype:"respawnButtonAmber"})&&this.payToRevive(b,c,!0)):(c=50,this.canAffordToRevive(b,c)&&d.doButton({id:"ecPlayerLife"+this.entity.getName()+"Respawn",text1:"BUY INSTANT REVIVE",text2:""+c,v2ScreenLocation:f.getv2RenderLocation(0,-140,"bottom"),buttonType:aa.BUTTON_NORMAL,guiArchetype:"respawnButtonLumber"})&&this.payToRevive(b,c,!1))},canAffordToRevive:function(a,b){var c=this.getEntityEC("ECPlayerData");
return c&&(0<b&&c.getResource(E.LUMBER)<b||0<a&&c.getSoftCurrency()<a)?!1:!0},payToRevive:function(a,b,c){var d=this.getEntityEC("ECPlayerData"),f=this.globals.mathDevice;d&&(0<b&&d.adjustResource(E.LUMBER,-b),0<a&&d.adjustSoftCurrency(-a),this.respawnTime=this.globals.gameCurrentTime+0.2,c&&(this.respawnLocation=f.v3Copy(this.getv3Location(),this.respawnLocation)))},scheduleRespawn:function(a,b){var c=this.globals,d=c.mathDevice;if(!(this.state===this.states.RESPAWNING||this.state===this.states.RESTARTING)){var f=
this.getEntityEC("ECLocomotion");this.respawnTime=c.gameCurrentTime+b;this.respawnLocation=d.v3Copy(a,this.respawnLocation);f&&(f.reset(),f.setActive(!1))}},respawn:function(a){var b=this.globals.mathDevice,c=this.entity,d=c.getEC("ECLocomotion"),f=c.getEC("ECPhysicsSphere"),e=this.getEntityEC("ECHealth");f.reset();a=b.v3Add(b.v3Build(0,this.RESPAWN_START_HEIGHT,0),a);c.setv3Location(a);d&&(d.reset(),d.setActive(!0));e.setInvulnerable(!1);e.setDisableHealthBar(!1);e.setInvulnerableDuration(this.archetype.respawnInvulnerableTime);
this.playSpawnSound();this.state=this.states.NORMAL},getV3RespawnLocation:function(){return this.respawnLocation?this.respawnLocation:this.gameManager.getHeroRespawnPosition()},playSpawnSound:function(){this.playSound("spawnHero")},destroy:function(){this._super();this.setGameSpace(void 0);this.gameManager.removeHeroEntity(this.entity)},serialize:function(a){this._super(a);a.lives=this.lives}});F.prototype.eCCreationMap[Eh.prototype.entityComponentName]=Eh;Eh.create=function(a,b){return new Eh(a,
b)};var Fh=F.extend({entityComponentName:"ECProjectile",updatePeriod:0,sortPriority:3,shouldUpdate:!0,shouldAlwaysUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!0,shouldSave:!1,realTime:!1,parameters:{rotationSpeed:0,speed:1},init:function(a,b){this._super(a,b);var c=this.globals.mathDevice;this.speed=this.safeCopy(b.speed,1);this.usesGravity=this.safeCopy(b.usesGravity,!1);this.damageType=this.safeCopy(b.damageType,"DAMAGE_TYPE_NONE");this.ignoresAllies=this.safeCopy(b.ignoresAllies,
!1);this.maxImpacts=this.safeCopy(b.maxImpacts,1);this.impactedEntities=[];this.explodeInstantly=this.safeCopy(b.explodeInstantly,!1);this.v3Direction=this.v3SafeCopy(b.v3Direction,c.v3Build(1,0,0));c.v3Normalize(this.v3Direction,this.v3Direction);this.v3Velocity=c.v3ScalarMul(this.v3Direction,this.speed);this.fireTime=a.gameCurrentTime;this.hasPlayedFlightSound=!1;this.flySound=this.safeCopy(b.flySound);this.hitSound=this.safeCopy(b.hitSound);this.hurtSound=this.safeCopy(b.hurtSound);this.hitEffect=
this.safeCopy(b.hitEffect);this.hurtEffect=this.safeCopy(b.hurtEffect);this.scratchpad={};this.damageFactor=1},setDamageFactor:function(a){damageFactor=a},activate:function(){this._super();var a=this.getEntityEC("ECMesh");a&&a.setUp(this.v3Direction);this.startLocation=this.globals.mathDevice.v3Copy(this.getv3Location(),this.startLocation)},setOwner:function(a){this.owner=a},setMaxRange:function(a){this.maxRange=a},setV3Direction:function(a){var b=this.globals.mathDevice;this.v3Direction=b.v3Copy(a,
this.v3Direction);b.v3Normalize(this.v3Direction,this.v3Direction);b.v3ScalarMul(this.v3Direction,this.speed,this.v3Velocity);(a=this.getEntityEC("ECMesh"))&&a.setUp(this.v3Direction)},applyRotation:function(){var a,b;this.archetype.rotationSpeed&&(a=this.getEntityEC("ECMesh"),b=this.globals.gameTimeStep,a&&(a.addRotationX(b*this.archetype.rotationSpeed),a.addRotationZ(0.6*b*this.archetype.rotationSpeed)))},update:function(){var a=this.globals,b=a.mathDevice,c=this.gameManager,d=this.ignoresAllies,
f=!1,e=this.getOwner(),h=this.scratchpad,i=this.maxRange;if(this.isManagedByThisMachine())if(this.explodeInstantly)this.onImpact(null,this.getv3Location());else{var j=this.v3Velocity,k=this.getTimeSinceLastUpdate();this._super();if(this.usesGravity){var l=this.getGravity();l&&(j[1]-=l*k)}l=this.getv3Location();h=h.v3Next=b.v3AddScalarMul(l,j,k,h.v3Next);if((c=c.getCollisionInfo(l,h,!0))&&c.collidedEntity!==e){if(d&&(c.collidedEntity&&e&&e.isFriendlyWith(c.collidedEntity))&&(d=c.collidedEntity.getEC("ECHealth"),
!d||!d.takesFullDamageFromFriendlyFire()))f=!0;!f&&(1<this.maxImpacts&&c.collidedEntity&&0<=this.impactedEntities.indexOf(c.collidedEntity))&&(f=!0);f||(this.onImpact(c.collidedEntity,c.v3Location),this.entity.toBeDestroyed&&(h=c.v3Location))}this.applyRotation();this.entity.setv3Location(h);a=a.gameCurrentTime-this.fireTime;!this.hasPlayedFlightSound&&0.1<a&&(this.hasPlayedFlightSound=!0,this.playSound(this.flySound));30<this.entity.getAge()&&this.entity.setToBeDestroyed();void 0!==i&&(i=this.usesGravity?
i+5:i+0.1,b.v3DistanceSq(this.startLocation,h)>i*i&&this.entity.setToBeDestroyed());b=0.5*b.v3DistanceSq(this.startLocation,h);(i=this.getEntityEC("ECMesh"))&&i.setScale(Math.min(0.25*b,1))}},clearImpactedEntities:function(){this.impactedEntities.length=0},getGravity:function(){var a=0;this.usesGravity&&(a=qa.prototype.gravity);return a},onImpact:function(a,b){var c=this.gameManager.damager,d=this.gameManager.actionManager,f=this.globals.mathDevice,e,h=!1;e=!1;if(a&&((e=a.getEC("ECHealth"))&&(h=!0),
e=a.getEC("ECAgent")||a.getEC("ECWildlingAgent")))e.onImpact(this.entity);if(this.isManagedByThisMachine()&&(c=c.archetypes[this.damageType])){e=this.getOwner();if(!e||e.toBeDestroyed)e=this.entity;e&&!e.toBeDestroyed&&(0<c.radius?0<c.arcAngle?c.applyToArc(e,this.v3Velocity,this.getv3Location(),void 0,void 0,this.startLocation,this.damageFactor):c.applyToArea(e,this.v3Velocity,this.getv3Location(),a,void 0,this.startLocation,this.damageFactor):a&&c.applyToEntity(a,e,this.v3Velocity,null,null,this.startLocation,
this.damageFactor))}h?(this.hurtSound&&this.playSound(this.hurtSound),this.hurtEffect&&d.addAction("SpecialEffect",{archetype:this.hurtEffect,v3Location:f.v3Copy(b)})):(this.hitSound&&this.playSound(this.hitSound),this.hitEffect&&d.addAction("SpecialEffect",{archetype:this.hitEffect,v3Location:f.v3Copy(b)}));a?(this.impactedEntities.push(a),e=this.impactedEntities.length>=this.maxImpacts):e=!0;e&&this.entity.setToBeDestroyed()},getv3Velocity:function(){return this.v3Velocity},getOwner:function(){return this.owner},
drawDebug:function(){this._super();var a=this.globals,b=a.mathDevice;a.debugDraw.drawDebugLine(this.getv3Location(),b.v3Add(this.getv3Location(),this.v3Velocity),0,1,0)},destroy:function(){this._super()},serialize:function(a){this._super(a)}});F.prototype.eCCreationMap[Fh.prototype.entityComponentName]=Fh;Fh.create=function(a,b){return new Fh(a,b)};var Gh=F.extend({entityComponentName:"ECRadar",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,
shouldSave:!1,realTime:!1,parameters:{minChangeTime:1,maxChangeTime:3},init:function(a,b){this._super(a,b);this.refreshChangeTime()},refreshChangeTime:function(){this.changeTime=this.globals.gameCurrentTime+this.globals.mathDevice.randomInRange(this.archetype.minChangeTime,this.archetype.maxChangeTime)},update:function(){this._super();var a;a=!1;this.globals.gameCurrentTime>this.changeTime&&(a=!0);if(a&&(this.refreshChangeTime(),a=this.getEntityEC("ECOrientate"))){var b=this.getAttackPoint();b&&a.setFacing(b)}},
getAttackPoint:function(){var a=this.gameManager.getEntitiesWithEC("ECWarManager"),b=a.length;if(!b)return null;b=this.globals.mathDevice.randomIntInRange(0,b-1);return this.getAttackPointFromWarManager(a[b])},getAttackPointFromWarManager:function(a){return a.getEC("ECWarManager").getChosenV3SpawnLocation()},draw:function(){},drawDebug:function(){var a=this.globals.debugDraw,b=this.getAttackPoint();a&&b&&a.drawDebugLine(this.entity.getv3Location(),b,0,1,0)},serialize:function(a){this._super(a)},serializeDelta:function(){},
destroy:function(){this._super()}});Gh.create=function(a,b){return new Gh(a,b)};F.prototype.eCCreationMap[Gh.prototype.entityComponentName]=Gh;var Hh=F.extend({entityComponentName:"ECRadialMenu",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{},init:function(a,b){this._super(a,b);this.selected=this.activated=this.smartValid=!1;this.radialMenuEnabled=!0},activate:function(){this._super();var a=this.getEntityEC("ECInteractable");
a&&a.setPassive(!0);if(a=this.getEntityEC("ECSelectable"))this.setSmartValid(a.isSmartValid()),this.setActivated(a.isActivated()),this.setHot(a.isHot())},closeMenu:function(){var a=this.getEntityEC("ECSelectable");a&&a.setActivated(!1)},updateButtons:function(a,b,c){var d=[];this.isRepairerButtonValid()&&d.push("repairer");if(this.isRepairButtonExclusive())d.push("repair");else{this.isMoveButtonValid()&&d.push("move");if(this.isHeroUpgradeButtonValid()){var f=this.getEntityEC("ECHeroShrine").getRadialMenuButtonCount(),
e;for(e=0;e<f;e+=1)d.push("unlockHeroUpgrade")}this.isPurchaseSoftCurrencyButtonValid()&&d.push("purchaseSoftCurrency");this.isConvertButtonValid()&&d.push("convert");this.isCancelUpgradeButtonValid()&&d.push("cancelUpgrade");this.isInstantUpgradeButtonValid()&&d.push("instantUpgrade");this.isInstantBuildButtonValid()&&d.push("instantBuild");this.isSpeedUpResearchButtonValid()&&d.push("instantResearch");if(this.isUnlockCapButtonValid()&&!this.isSpeedUpResearchButtonValid()){f=this.getEntityEC("ECCapDispenser").getRadialMenuButtonCount();
for(e=0;e<f;e+=1)d.push("unlockCap")}this.isDispenseEntityButtonValid()&&d.push("dispenseEntity");if(this.isBuildButtonValid()){f=this.getEntityEC("ECDispenser");f.updateButtonState();f=f.getRadialMenuButtonCount();for(e=0;e<f;e+=1)d.push("build")}this.isUpgradeButtonValid()&&!this.isSpeedUpResearchButtonValid()&&d.push("upgrade");this.isMultipleUpgradeButtonValid()&&!this.isSpeedUpResearchButtonValid()&&d.push("multipleUpgrade");this.isRepairButtonValid()&&d.push("repair")}(a||b&&1===d.length)&&
this.doButtons(d,c)},doButtons:function(a,b){var c=a.length,d=1<c,f=0,e=this.globals.currentLanguage,h=this.gameManager.getHero(),i=this.entity,j="ecRadialMenu"+i.getName(),k,l=this.gameManager.getGameCamera().getv2ScreenLocationFromWorld(this.getv3Location(),!1),m=this.gameManager,q=m.getIMGui();k=m.getGuiManager();var m=q.getRadialScaleFactor(c),p;p=d?q.getRadialCentre(l,m):l;d&&(k.addDrawGui("radialFrame",{v2ScreenLocation:p,scale:m},"idECRadialMenu"+this.entity.getName()+"Background"),q.gobbleCursorInRadius(p,
q.getRadialSize(1.5*m)),q.isMouseCursorFarFromRadius(p,q.getRadialSize(1.5*m))&&(k=this.getEntityEC("ECSelectable"))&&k.setActivated(!1));var s,t,u,w=0;for(s=0;s<c;s+=1)t=a[s],k=j+t,t===u?w+=1:(w=0,u=t),d&&(p=q.addRadialOffset(l,f,c,m)),b[t](q,p,k,e,i,h,w),f+=1},doButtonMap:{repair:function(a,b,c,d,f,e){f.getEC("ECRepairable").doRadialRepairMenuButton(a,e,b)},repairer:function(a,b,c,d,f,e){f.getEC("ECRepairer").doRadialMenuButton(a,e,b)},move:function(a,b,c,d,f,e){a.doButton({id:c,text:d.GAME_HUD_MOVE,
v2ScreenLocation:b,buttonType:aa.BUTTON_ROUND,guiArchetype:"move"})&&f.getEC("ECBuilding").move(e)},upgrade:function(a,b,c,d,f,e){f.getEC("ECUpgradable").doRadialMenuButton(a,e,b)},multipleUpgrade:function(a,b,c,d,f,e){f.getEC("ECUpgradable").doMultipleUpgradeRadialMenuButton(a,e,b)},build:function(a,b,c,d,f,e,h){f.getEC("ECDispenser").doRadialMenuButton(a,e,b,h)},dispenseEntity:function(a,b,c,d,f,e){f.getEC("ECEntityDispenser").doRadialMenuButton(a,e,b)},instantResearch:function(a,b,c,d,f,e,h){f.getEC("ECCapDispenser").doInstantResearchRadialMenuButton(a,
e,b,h)},unlockCap:function(a,b,c,d,f,e,h){f.getEC("ECCapDispenser").doRadialMenuButton(a,e,b,h)},instantBuild:function(a,b,c,d,f,e){f.getEC("ECScaffold").doRadialMenuInstantBuildButton(a,e,b)},instantUpgrade:function(a,b,c,d,f,e){f.getEC("ECUpgrader").doRadialMenuInstantUpgradeButton(a,e,b)},cancelUpgrade:function(a,b,c,d,f,e){f.getEC("ECUpgrader").doRadialMenuCancelUpgradeButton(a,e,b)},convert:function(a,b,c,d,f,e){f.getEC("ECResourceGenerator").doRadialMenuButton(a,e,b)},purchaseSoftCurrency:function(a,
b,c,d,f){a.doButton({id:c,text1:d.GUI_BUTTON_BUY_AMBER,v2ScreenLocation:b,buttonType:aa.BUTTON_ROUND,guiArchetype:"addAmberShop"})&&(a=f.gameManager,f=f.globals,a&&(f=Wa.create(a,f),a.setGameState(f),f.setButtonPanal("amber")))},unlockHeroUpgrade:function(a,b,c,d,f,e,h){f.getEC("ECHeroShrine").doRadialMenuButton(a,e,b,h)}},isDisabledDueToPlayerThrowingBuilding:function(){var a=!1,b=this.gameManager.getHero();b&&(b=b.getEC("ECPlayerBuilder"))&&(a=b.isThrowing());return a},isSmartValid:function(){return this.smartValid},
setSmartValid:function(a){a!==this.smartValid&&(this.smartValid=a,this.updateSelectionValidity())},isActivated:function(){return this.activated},setActivated:function(a){a!==this.activated&&(this.activated=a,this.updateSelectionValidity(),a&&(this.entityHasEC("ECScaffold")&&this.gameManager.eventManager.notify("ScaffoldClicked",{scaffoldEntity:this.entity,clickedBy:null}),this.entityHasEC("ECUpgrader")&&this.gameManager.eventManager.notify("UpgraderClicked",{upgraderEntity:this.entity,clickedBy:null})))},
isHot:function(){return this.selected},setHot:function(a){a!==this.selected&&(this.selected=a,this.updateSelectionValidity())},updateSelectionValidity:function(){var a=this.isSmartValid()||this.isActivated()||this.isHot(),b=this.getEntityEC("ECInteractable");b&&!b.getActive()&&(a=!1);this.setToUpdate(a)},update:function(){this._super();!this.isDisabledDueToPlayerThrowingBuilding()&&(this.isRadialMenuEnabled()&&(this.activated||this.selected))&&this.updateButtons(this.activated,this.selected,this.doButtonMap)},
enableRadialMenu:function(){this.radialMenuEnabled=!0},disableRadialMenu:function(){this.radialMenuEnabled=!1},isRadialMenuEnabled:function(){return this.radialMenuEnabled},isRepairButtonExclusive:function(){var a=this.getEntityEC("ECRepairable"),b=Ob.repairingEnabled;return a&&a.isBroken()&&b},isRepairButtonValid:function(){var a=this.getEntityEC("ECRepairable"),b=Ob.repairingEnabled;return a&&a.canBeToppedUp()&&b},isRepairerButtonValid:function(){var a=this.getEntityEC("ECRepairer")?!0:!1,b=Ob.repairingEnabled;
return a&&b},isMoveButtonValid:function(){var a=this.getEntityEC("ECBuilding"),b=this.getEntityEC("ECPlacedBuildingTracker");return a&&a.getCanMove()&&Ob.buildingMovementEnabled?b&&!b.getCanMove()?!1:!0:!1},isUpgradeButtonValid:function(){var a=this.getEntityEC("ECUpgradable");return a&&a.shouldShowUpgradeButton()&&Ob.buildingUpgradesEnabled},isMultipleUpgradeButtonValid:function(){var a=this.getEntityEC("ECUpgradable");return a&&a.shouldShowMultipleUpgradeButton()&&Ob.buildingUpgradesEnabled},isBuildButtonValid:function(){return this.getEntityEC("ECDispenser")?
!0:!1},isDispenseEntityButtonValid:function(){var a=this.getEntityEC("ECEntityDispenser");return a?a.shouldUseRadial():!1},isUnlockCapButtonValid:function(){var a=this.getEntityEC("ECCapDispenser");return a?!a.isResearching():!1},isHeroUpgradeButtonValid:function(){var a=this.getEntityEC("ECHeroShrine");return a?0<a.getRadialMenuButtonCount():!1},isSpeedUpResearchButtonValid:function(){var a=this.getEntityEC("ECCapDispenser");return a?a.isResearching():!1},isInstantBuildButtonValid:function(){var a=
this.getEntityEC("ECScaffold");return a&&!a.isWaitingForClick()&&(a.shouldDelayBuildingUntilBuilderPresent()||a.hasStartedBuilding())?!0:!1},isInstantUpgradeButtonValid:function(){var a=this.getEntityEC("ECUpgrader");return a&&a.isUpgrading()&&!a.isWaitingForClick()},isCancelUpgradeButtonValid:function(){var a=this.getEntityEC("ECUpgrader");return a&&a.isUpgrading()&&!a.isWaitingForClick()},isConvertButtonValid:function(){return this.getEntityEC("ECResourceGenerator")?!0:!1},isPurchaseSoftCurrencyButtonValid:function(){return this.getEntityEC("ECResourceGenerator")?
!0:!1},draw:function(){},drawDebug:function(){},serialize:function(a){this._super(a)},serializeDelta:function(){},destroy:function(){this._super()}});Hh.create=function(a,b){return new Hh(a,b)};F.prototype.eCCreationMap[Hh.prototype.entityComponentName]=Hh;var Le=F.extend({entityComponentName:"ECRepairable",sortPriority:1,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!1,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{minResourceRepairCost:{description:"Primary resource cost for repair",
defaultValue:[0,0],minValue:0,maxValue:1E4,step:1},maxResourceRepairCost:{description:"Secondary resource cost for repair",defaultValue:[0,0],minValue:0,maxValue:1E4,step:1},damagedEntityArchetype:"a_s_damaged_big",canBeDestroyed:!1,breaksfx:void 0},MAX_HEALTH_FACTOR_REQUIRED_TO_BREAK:0.1,init:function(a,b){this._super(a,b);this.broken=!1},activate:function(){this._super();this.isBreakable()&&(!this.isBroken()&&this.shouldBreak())&&this.breakBuilding(!0)},update:function(){this._super();this.updateBrokenStatus();
this.setToUpdate(!1)},updateBrokenStatus:function(){this.isBreakable()&&(!this.isBroken()&&this.shouldBreak())&&this.breakBuilding();var a=this.canBeToppedUp()&&!this.isBroken();this.setToDraw(a)},shouldBreak:function(){var a=this.getEntityEC("ECHealth");return a&&a.getHealthFactor()<this.MAX_HEALTH_FACTOR_REQUIRED_TO_BREAK?!0:!1},onTakeDamage:function(){this.updateBrokenStatus()},isBreakable:function(){return ea.repairableBuildings},isBroken:function(){return this.broken},canBeToppedUp:function(){var a=
this.getEntityEC("ECHealth");return a&&1>a.getHealthFactor()?!0:!1},createDamageEntity:function(){var a=this.archetype.damagedEntityArchetype;if(a&&!this.damagedEntity){var b=this.gameManager.getEntityFactory(),c;if(b){c=this.damagedEntity=b.createActiveEntityInstance("damaged_"+this.entity.getName(),a,this.getv3Location());var d=this.damagedEntity.getEC("ECMesh");d&&(d.setScale(0.1),d.update(),G.Create({scale:0.1}).to({scale:1},2).onUpdate(function(){c.shouldBeDestroyed()||d.setScale(this.scale)}).delay(0.4).start())}}},
removeDamageEntity:function(){this.damagedEntity&&(this.damagedEntity.setToBeDestroyed(),this.damagedEntity=void 0)},breakBuilding:function(a){this.broken=!0;this.setToUpdate(!0);var b=this.archetype,c=b.disablePhysicsWhenBroken;this.applyBrokenBehaviourToEntity(this.entity,c);var d=this.getEntityEC("ECSockets");if(d){var f=this.applyBrokenBehaviourToEntity.bind(this);d.applyToSocketedEntities(f,c)}(b=b.damagedMeshPath)?(c=this.getEntityEC("ECMesh"))&&c.loadMesh(b):this.createDamageEntity();this.archetype.breaksfx&&
!a&&this.playEffect(this.archetype.breaksfx);a||this.sendBrokenMetric()},sendBrokenMetric:function(){this.globals.metricsManager.sendGameMetric("buildingBroken_"+this.entity.archetypeName,1)},sendRepairMetric:function(){this.globals.metricsManager.sendGameMetric("buildingRepaired_"+this.entity.archetypeName,1)},applyBrokenBehaviourToEntity:function(a,b){var c=this.getEntityEC("ECBuilding");c&&(c.destroyBuildingsAbove(),c.disableMovement(!0));if(c=a.getEC("ECHealth"))c.disableRegen(),this.archetype.canBeDestroyed||
c.disableDeath();(c=a.getEC("ECResourceGenerator"))&&c.disableResourceGeneration();(c=a.getEC("ECResourceDestination"))&&c.disableResourceDespositing();(c=a.getEC("ECAgent"))&&c.setActive(!1);b&&(c=a.getEC("ECPhysicsCube"))&&c.setIgnoringCollision(!0);a!==this.entity&&(c=a.getEC("ECSelectable"))&&c.setValid(!1)},repairBuilding:function(){this.broken=!1;this.setToUpdate(!1);var a=this.archetype.disablePhysicsWhenBroken;this.applyRepairBehaviourToEntity(this.entity,a);var b=this.getEntityEC("ECSockets");
if(b){var c=this.applyRepairBehaviourToEntity.bind(this);b.applyToSocketedEntities(c,a)}this.removeDamageEntity();(a=this.getEntityEC("ECMesh"))&&a.loadMesh(a.archetype.path);(a=this.getEntityEC("ECSelectable"))&&a.refreshValidity();this.sendRepairMetric()},healBuilding:function(){var a=this.getEntityEC("ECHealth");a&&(a.resetHealth(),a.enableRegen(),a.enableDeath())},applyRepairBehaviourToEntity:function(a,b){var c=this.getEntityEC("ECBuilding");c&&c.disableMovement(!1);if(c=a.getEC("ECHealth"))c.resetHealth(),
c.enableRegen(),c.enableDeath();(c=a.getEC("ECResourceGenerator"))&&c.enableResourceGeneration();(c=a.getEC("ECResourceDestination"))&&c.enableResourceDespositing();(c=a.getEC("ECAgent"))&&c.setActive(!0);b&&(c=a.getEC("ECPhysicsCube"))&&c.setIgnoringCollision(!1);a!==this.entity&&(c=a.getEC("ECSelectable"))&&c.refreshValidity()},canEntityAffordRepair:function(a,b,c){var d=!1;a&&(a=a.getEC("ECPlayerData"))&&(d=a.getResource(E.LUMBER)>=b&&a.getResource(E.STONE)>=c);return d},purchaseRepair:function(a,
b,c){if(a=a.getEC("ECPlayerData"))a.adjustResource(E.LUMBER,-b),a.adjustResource(E.STONE,-c),this.isBroken()?this.repairBuilding():this.healBuilding(),this.updateBrokenStatus()},getPrimaryResourceRepairCostFromDamage:function(a){var b=this.archetype;return a*b.maxResourceRepairCost[0]+(1-a)*b.minResourceRepairCost[0]},getSecondaryResourceRepairCostFromDamage:function(a){var b=this.archetype;return a*b.maxResourceRepairCost[1]+(1-a)*b.minResourceRepairCost[1]},getPrimaryResourceRepairCost:function(){return this.getPrimaryResourceRepairCostFromDamage(this.getDamageFactor())},
getSecondaryResourceRepairCost:function(){return this.getSecondaryResourceRepairCostFromDamage(this.getDamageFactor())},getDamageFactor:function(){var a=1-this.getEntityEC("ECHealth").getHealthFactor();return a=this.globals.mathDevice.saturate(a)},getGuiArchetype:function(a){var b=this.getDamageFactor();return 0<this.getSecondaryResourceRepairCostFromDamage(b)?a?"repairStone":"repairInvalidStone":a?"repairLumber":"repairInvalidLumber"},doRadialRepairMenuButton:function(a,b,c){var d=this.getDamageFactor(),
f=this.getPrimaryResourceRepairCostFromDamage(d),d=this.getSecondaryResourceRepairCostFromDamage(d),e=this.canEntityAffordRepair(b,f,d),h=this.globals.currentLanguage.GAME_HUD_REPAIR,i=this.numberToCommaString(f),j=this.numberToCommaString(d),k=this.getGuiArchetype(e);e?a.doButton({id:"ecRadialMenu"+this.entity.getName()+"Repair",text1:h,text2:i,text3:j,text4:"",v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:k})&&this.purchaseRepair(b,f,d):a.doButton({id:"ecRadialMenu"+this.entity.getName()+
"Repair Unavailable",text1:h,text2:i,text3:j,text4:"",v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:k})&&this.openPurchaseRepairShop(b)},openPurchaseRepairShop:function(a){var b=this.gameManager,c=Wa.create(b,this.globals),d=this,f=this.getDamageFactor(),e=this.getPrimaryResourceRepairCostFromDamage(f),f=this.getSecondaryResourceRepairCostFromDamage(f);b.setGameState(c);c.setPurchaseFn(function(){d.purchaseRepair(a,0,0)});c.setRequiredResource(E.LUMBER,e);c.setRequiredResource(E.STONE,
f);c.setPurchaseReason("repair_"+this.entity.archetypeName);c.setButtonPanal("convert")},onToBeDestroyed:function(){this._super();this.removeDamageEntity()},draw:function(){var a=this.getEntityEC("ECSelectable"),b;a&&a.getValid()&&(a=this.gameManager.getGuiManager(),b=this.globals.mathDevice,b=b.v3Copy(this.getv3Location()),b[1]+=2,a.addDrawGui("alertRepair",{v3WorldLocation:b},"idRepairable"+this.entity.getName()))},drawDebug:function(){}});Le.create=function(a,b){return new Le(a,b)};F.prototype.eCCreationMap[Le.prototype.entityComponentName]=
Le;var Ih=F.extend({entityComponentName:"ECRepairer",updatePeriod:1.1,sortPriority:1,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!1,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{},init:function(a,b){this._super(a,b);this.repairingEnabled=!0;this.hasSetInvalid=!1},activate:function(){this._super()},update:function(){this._super();this.setRepairingEnabled(Ob.repairingEnabled)},setRepairingEnabled:function(a){a!==this.repairingEnabled&&(a?this.applyRepairingEnabledBehaviour():this.applyRepairingDisabledBehaviour(),
this.repairingEnabled=a)},applyRepairingEnabledBehaviour:function(){var a=this.getEntityEC("ECSelectable");this.hasSetInvalid&&(a.setPermanentValid(!0),this.hasSetInvalid=!1)},applyRepairingDisabledBehaviour:function(){this.getEntityEC("ECSelectable").setPermanentValid(!1);this.hasSetInvalid=!0},shouldRepair:function(a){var b=!0,c,d;if(this.archetype.owner&&(b=(b=this.entity.getEC("ECAttach"))?b.getParent():this.entity,b===a.entity))return!0;if(this.archetype.placedBuildings&&(b=(b=this.entity.getEC("ECAttach"))?
b.getParent():this.entity,b!==a.getBuildingParentEntity()))return!1;if(d=this.archetype.includeScaffoldTypes){b=!1;for(c=0;c<d.length;c+=1)if(a.archetype.scaffoldType===d[c]){b=!0;break}if(!1===b)return!1}if(d=this.archetype.excludeScaffoldTypes)for(c=0;c<d.length;c+=1)if(a.archetype.scaffoldType===d[c])return!1;if(d=this.archetype.includeBuildingTypes){b=!1;for(c=0;c<d.length;c+=1)if(a.archetype.buildingType===d[c]){b=!0;break}if(!1===b)return!1}if(d=this.archetype.excludeBuildingTypes)for(c=0;c<
d.length;c+=1)if(a.archetype.buildingType===d[c])return!1;return!0},getTotalRepairCost:function(){var a=this.gameManager.getBuildingManager().getBuildings(),b,c,d,f=0,e=0;if(a){b=a.length;for(c=0;c<b;c+=1)if((d=a[c].entity)&&!d.getEC("ECSelfDestruct")&&this.shouldRepair(a[c]))if((d=d.getEC("ECRepairable"))&&d.canBeToppedUp())f+=d.getPrimaryResourceRepairCost(),e+=d.getSecondaryResourceRepairCost()}return[f,e]},purchaseRepair:function(a,b,c){if(a=a.getEC("ECPlayerData")){a.adjustResource(E.LUMBER,
-b);a.adjustResource(E.STONE,-c);var b=this.globals.gameManager.getBuildingManager().getBuildings(),d;if(b){c=b.length;for(a=0;a<c;a+=1)if((d=b[a].entity)&&!d.getEC("ECSelfDestruct")&&this.shouldRepair(b[a]))if((d=d.getEC("ECRepairable"))&&d.canBeToppedUp())d.isBroken()?d.repairBuilding():d.healBuilding(),d.updateBrokenStatus()}}},doRadialMenuButton:function(a,b,c){var d=this.getTotalRepairCost(),f=0===d[E.LUMBER]+d[E.STONE],e=this.numberToCommaString(d[E.LUMBER]),h=this.numberToCommaString(d[E.STONE]);
if(f)f=this.globals.currentLanguage[this.archetype.nothingToRepairText],a.doButton({id:"ecRadialMenu"+this.entity.getName()+"Repair Invalid",text1:f,text2:e,text3:h,text4:"",v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:"repairInvalidLumberAndStone"});else{var i=Le.prototype.canEntityAffordRepair(b,d[E.LUMBER],d[E.STONE]),f=this.globals.currentLanguage[this.archetype.repairAllText];i?a.doButton({id:"ecRadialMenu"+this.entity.getName()+"Repair",text1:f,text2:e,text3:h,text4:"",v2ScreenLocation:c,
buttonType:aa.BUTTON_ROUND,guiArchetype:"repairLumberAndStone"})&&this.purchaseRepair(b,d[E.LUMBER],d[E.STONE]):a.doButton({id:"ecRadialMenu"+this.entity.getName()+"Repair Unavailable",text1:f,text2:e,text3:h,text4:"",v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:"repairWithAmberLumberAndStone"})&&this.openPurchaseRepairShop(b)}},openPurchaseRepairShop:function(a){var b=this.gameManager,c=this.getTotalRepairCost(),d=Wa.create(b,this.globals),f=this;b.setGameState(d);d.setPurchaseFn(function(){f.purchaseRepair(a,
0,0)});d.setRequiredResource(E.LUMBER,c[E.LUMBER]);d.setRequiredResource(E.STONE,c[E.STONE]);d.setPurchaseReason("multirepair");d.setButtonPanal("convert")},onToBeDestroyed:function(){this._super()},draw:function(){},drawDebug:function(){}});Ih.create=function(a,b){return new Ih(a,b)};F.prototype.eCCreationMap[Ih.prototype.entityComponentName]=Ih;var Me=F.extend({entityComponentName:"ECResourceDispenser",updatePeriod:10,sortPriority:4,shouldUpdate:!0,shouldAlwaysUpdate:!0,shouldDraw:!1,shouldSerialize:!0,
shouldDeltaSerialize:!1,shouldSave:!0,realTime:!0,parameters:{resourceType:void 0,maxResource:5,randMaxResource:0,growDuration:300,growDurationMax:320,resourcePerInteract:1,regrows:!0,chanceOfSoftCurrencyPerInteraction:0.01},physicsActivationScaleThreshold:0.1,init:function(a,b){this._super(a,b);this.growFactor=0.99;this.gatheringResource=this.claimedResource=this.resource=0;this.randomMaxFactor=Math.random();this.ignoringCollision=!1;this.refreshGrowDuration()},activate:function(){this._super();
var a=function(a){this.onInteract(a)}.bind(this),b=this.entity.getEC("ECInteractable");b&&b.setOnInteractCallback(a);a=this.getEntityEC("ECMesh");a.setRotationY(2*Math.random()*Math.PI);a.setRotationX(0.2*Math.random());(a=this.getEntityEC("ECSelectable"))&&a.setValid(!1);(a=this.gameManager.getResourceDispenserManager(this.getResourceType()))&&a.resourceDispenserAdded(this);!this.ignoringCollision&&this.growFactor<this.physicsActivationScaleThreshold&&this.setIgnoringCollision(!0)},getBigFactor:function(){var a=
this.archetype;return a.randMaxResource*this.randomMaxFactor/a.maxResource+1},getResourceType:function(){return this.archetype.resourceType},getResource:function(){return this.resource},getClaimedResource:function(){return this.claimedResource},getUnclaimedResource:function(){return Math.max(0,this.resource-this.claimedResource)},claimResource:function(a){this.claimedResource+=a},getMaxResource:function(){var a=this.archetype;return Math.round(a.randMaxResource*this.randomMaxFactor+a.maxResource)},
isGrowing:function(){return 0===this.resource},getResourcePerBlock:function(a){var b=1;(a=this.gameManager.getEntityFactory().getECArchetype(a,"ECPickup"))&&a.carriedResource&&(b=a.carriedResource[this.getResourceType()]);return b},dropResourceEntity:function(a,b){var c=1,d=this.gameManager.getEntityFactory().getECArchetype(a,"ECPickup");d&&d.carriedResource&&(c=d.carriedResource[this.getResourceType()]);d=b;c&&(d=Math.floor(b/c));this.dropXEntities(a,d);return d*c},dropXEntities:function(a,b){var c=
this.gameManager.getEntityFactory(),d=this.getv3Location(),f,e;for(e=0;e<b;e+=1)f=c.createActiveEntityInstance("dropped"+a,a,d),f.setGameSpace(this.entity.getGameSpace())},onInteract:function(a){var b,c=this.archetype,d,f=this.getEntityEC("ECMesh"),e=this.gameManager.eventManager;b=this.getResourceType();var h=Za[b];d=a.getEC("ECResourceCarrier");var i,j;this.gatheringResource+=d.getResourcePerInteract(b);d=d.getAddedBlocksPerChop();0<d&&(j=this.getResourcePerBlock(h.entityArchetype),0<j&&(i=Math.floor((this.resource-
this.gatheringResource-0.01)/j)+1,d=Math.min(d,i),this.gatheringResource+=d*j));d=this.dropResourceEntity(h.entityArchetype,this.gatheringResource);this.gatheringResource-=d;this.growFactor-=d/this.getMaxResource();this.resource-=d;d&&Math.random()<this.archetype.chanceOfSoftCurrencyPerInteraction&&this.dropXEntities("a_r_amber",1);this.playSound(h.interactSound);this.entity.shudder(0.5,0.25,0);0.1>=this.resource?(this.resource=0,this.growFactor=0.025,this.archetype.regrows?(f.loadMesh(c.growingMesh),
this.refreshGrowDuration(),this.setToUpdate(!0),this.updateGrowth(0),f.update()):this.entity.setToBeDestroyed(),this.getEntityEC("ECSelectable").setValid(!1),this.setIgnoringCollision(!0),a&&a.hasEC("ECHero")&&e.notify("ResourceDispsenserDepletedByHero",{resourceType:b})):(b=Math.floor(0.5+c.depletedMeshes.length*(1-this.growFactor)),b=Math.min(b,c.depletedMeshes.length-1),f.loadMesh(c.depletedMeshes[b]));e.notify("InteractWithResourceDispenser",{resourceDispenser:this.entity,interactor:a,amount:d});
return d},refreshGrowDuration:function(){this.growDuration=this.globals.mathDevice.randomInRange(this.archetype.growDuration,this.archetype.growDurationMax)},updateGrowth:function(a){this.growFactor+=a*(1/this.growDuration);a=this.getEntityEC("ECMesh");this.ignoringCollision&&this.growFactor>this.physicsActivationScaleThreshold&&(this.hasOverlappingPhysicsObjects()||this.setIgnoringCollision(!1));this.growFactor=Math.min(1,this.growFactor);var b=this.growFactor*this.getBigFactor();a.setScale(0.5);
a.setScaleY(b);var c=this.getEntityEC("ECAnimationPlayer");c&&c.setSpeed(b);1<=this.growFactor&&!this.ignoringCollision&&(this.growFactor=1,this.resource=this.getMaxResource(),this.claimedResource=0,this.setToUpdate(!1),this.getEntityEC("ECSelectable").setValid(!0),a.loadMesh(a.archetype.path),this.beginAppearAnim(a))},update:function(){this._super();var a=this.gameManager,b=this.getTimeSinceLastUpdate(),b=b+a.getAdditionalTimeFromSave();this.updateGrowth(b)},hasOverlappingPhysicsObjects:function(){var a=
this.gameManager,b=this.globals.mathDevice,c=this.entity,d=this.getEntityEC("ECPhysicsCube");if(d){d=d.getv3Scale();d=b.v3ScalarMul(d,0.5);d=b.aabbBuildFromCentreHalfExtents(this.getv3Location(),d);b=[];a.getOverlappingObjects(d,[],b);a=b.length;for(d=0;d<a;d+=1)if(b[d].entity!==c)return!0}return!1},setIgnoringCollision:function(a){this.ignoringCollision!==a&&(this.getEntityEC("ECPhysicsCube").setIgnoringCollision(a),this.ignoringCollision=a)},beginAppearAnim:function(a){G.Create({scale:0.5}).to({scale:1},
0.5).easing(G.Easing.Elastic.Out).onUpdate(function(){a.setScale(this.scale)}).start()},draw:function(){},drawDebug:function(){},manageLargeTimeStep:function(a){this._super(a);this.isGrowing()&&this.updateGrowth(a)},saveSerialize:function(){return{growFactor:this.growFactor}},serialize:function(a){this._super(a);a.growFactor=this.growFactor},serializeDelta:function(){},onToBeDestroyed:function(){this._super();this.gameManager.getResourceDispenserManager(this.getResourceType()).resourceDispenserRemoved(this)},
destroy:function(){this._super()}});Me.preloadComponent=function(a,b){var c=a.simpleSceneLoader,d,f,e=Sa.create({name:"temp",dynamic:!1,disabled:!0});b.growingMesh&&(c.isLoadingMesh(b.growingMesh)||c.load(b.growingMesh,void 0,void 0,e));if(f=b.depletedMeshes)for(d=0;d<f.length;d+=1)c.isLoadingMesh(f[d])||c.load(f[d],void 0,void 0,e)};Me.create=function(a,b){return new Me(a,b)};F.prototype.eCCreationMap[Me.prototype.entityComponentName]=Me;var Jh=F.extend({entityComponentName:"ECScaffold",updatePeriod:1,
sortPriority:4,shouldUpdate:!0,shouldAlwaysUpdate:!0,shouldDraw:!0,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!0,storeGlobalList:!0,realTime:!0,parameters:{delayBuildingUntilNothingOverlapsUs:!0,delayBuildingUntilBuilderPresent:!1,playTweenWhenBuildingFinished:!0,buildSpeed:1,scaffoldType:"normal"},init:function(a,b){this._super(a,b);this.startedBuilding=!1;this.buildComplete=0;this.additionalSearchRadius=2;this.minBuildSpeed=0;this.buildTime=99;this.extraBuildTimeThisFrame=0;this.canSpeedUpWithSoftCurrency=
!1;this.obeysScaffoldCap=!0;this.builderHasBeenClicked=this.waitingForClick=!1;this.temporaryResourceCaps=[0,0];this.temporaryBuildingData=null;this.hasOfflineBuilder=this.shouldInstantlyStart=!1;this.plannedFactionName=null;this.buildDelay=0;this.setScaffoldType(b.scaffoldType)},setScaffoldType:function(a){this.scaffoldType=a},getScaffoldType:function(){return this.scaffoldType},activate:function(){this._super();var a;a=this.gameManager;var b=this.obeysScaffoldCap;a&&(a=a.getBuildingManager())&&
a.scaffoldAdded(this,b);this.adjustResourceCap(E.LUMBER,this.temporaryResourceCaps[E.LUMBER]);this.adjustResourceCap(E.STONE,this.temporaryResourceCaps[E.STONE]);!this.shouldDelayBuildingUntilNothingOverlapsUs()&&!this.shouldDelayBuildingUntilBuilderPresent()?this.startBuilding():this.stopBuilding();this.startedBuilding&&this.setUpdatePeriod(0);this.createScaffoldMesh();this.isWaitingForClick()&&(b=this.getEntityEC("ECBuilding"))&&b.disableMovement(!0)},createScaffoldMesh:function(){if(!this.scaffoldMeshEntity){var a=
this.entity.getRadius(),a=a+0.25,b=this.gameManager.getEntityFactory().createActiveEntityInstance("ScaffoldMesh"+this.plannedObject,"a_b_scaffoldMesh",this.getv3Location(),0),c=this.globals.mathDevice,d=b.getEC("ECMesh");d.setScale(0.1);G.Create({scale:0.1,yOffset:-1}).to({scale:a/2,yOffset:0},0.5).easing(G.Easing.Elastic.Out).onUpdate(function(){d.setLocalOffset(c.v3Build(0,this.yOffset,0));d.setScale(this.scale)}).start();this.scaffoldMeshEntity=b}},destroyScaffoldMesh:function(){this.scaffoldMeshEntity&&
(this.scaffoldMeshEntity.shrinkDisappear(0.5),this.scaffoldMeshEntity=void 0)},setPlannedFactionName:function(a){this.plannedFactionName=a},setBuildTime:function(a){this.buildTime=a},setObeysScaffoldCap:function(a){this.obeysScaffoldCap=a},setTemporaryResourceCaps:function(a){this.clearTemporaryResourceCaps();a&&(this.temporaryResourceCaps=a)},clearTemporaryResourceCaps:function(){var a,b;if(this.temporaryResourceCaps){a=this.temporaryResourceCaps.length;for(b=0;b<a;b+=1)this.clearTemporaryResourceCap(b)}},
setTemporaryResourceCap:function(a,b){var c;b?(c=this.temporaryResourceCaps[a]?b-this.temporaryResourceCaps[a]:b,this.adjustResourceCap(a,c),this.temporaryResourceCaps[a]=b):this.clearTemporaryResourceCap(a)},clearTemporaryResourceCap:function(a){0<this.temporaryResourceCaps[a]&&this.adjustResourceCap(a,-this.temporaryResourceCaps[a]);this.temporaryResourceCaps[a]=0},adjustResourceCap:function(a,b){this.gameManager.playerData.adjustResourceCap(a,b)},getTemporaryBuildingData:function(){return this.temporaryBuildingData},
setTemporaryBuildingData:function(a){this.temporaryBuildingData=a},clearTemporaryBuildingData:function(){this.temporaryBuildingData=null},loadTemporaryScaffoldData:function(a){a&&(void 0!==a.buildComplete&&(this.buildComplete=a.buildComplete),void 0!==a.buildTime&&(this.buildTime=a.buildTime),void 0!==a.minBuildSpeed&&(this.minBuildSpeed=a.minBuildSpeed),void 0!==a.plannedFactionName&&(this.plannedFactionName=a.plannedFactionName),this.shouldInstantlyStart=a.shouldInstantlyStart,this.preUpgradeObject=
a.preUpgradeObject)},generateTemporaryScaffoldData:function(){return{buildComplete:this.buildComplete,preUpgradeObject:this.preUpgradeObject,buildTime:this.buildTime,minBuildSpeed:this.minBuildSpeed,shouldInstantlyStart:this.shouldInstantlyStart,plannedFactionName:this.plannedFactionName}},setPlannedObject:function(a,b,c,d,f){this.plannedObject=a;this.preUpgradeObject=b;this.isNewBuilding=f;a=this.gameManager.getEntityFactory().getECArchetype(a,"ECBuilding");this.canSpeedUpWithSoftCurrency=a.canSpeedUpWithSoftCurrency;
c?(this.buildTime=a.rebuildTime,this.setMinBuildSpeed(1)):this.buildTime=a.buildTime;c=this.globals.mathDevice;d&&(this.buildDelay=d,d=this.getEntityEC("ECMesh"),d.setScaleY(0.1),d.setLocalOffset(c.v3Build(0,-0.5,0)),d.setScale(0.75))},getPlannedObject:function(){return this.plannedObject},getPreUpgradeObject:function(){return this.preUpgradeObject},setPreUpgradeObject:function(a){this.preUpgradeObject=a},getMinBuildSpeed:function(){return this.minBuildSpeed},setMinBuildSpeed:function(a){this.minBuildSpeed=
a},getBuildSpeed:function(){return Math.max(this.archetype.buildSpeed,this.minBuildSpeed)},onToBeDestroyed:function(){var a;a=this.gameManager;var b=this.obeysScaffoldCap;this._super();this.clearTemporaryResourceCaps();a&&(a=a.getBuildingManager())&&a.scaffoldRemoved(this,b);this.destroyScaffoldMesh()},canEntityAffordInstantBuild:function(a){var a=a.getEC("ECPlayerData"),b=this.getCostToInstantlyBuild();return a&&a.getSoftCurrency()>=b?!0:!1},instantlyBuild:function(a){if(this.canEntityAffordInstantBuild(a)){var a=
a.getEC("ECPlayerData"),b=this.getCostToInstantlyBuild();a&&(a.adjustSoftCurrency(-b),this.buildComplete=1)}},update:function(){var a=this.globals.mathDevice,b;this._super();var c=this.getTimeSinceLastUpdate(),d=this.gameManager.getAdditionalTimeFromSave();this.updateBuildCompleteFraction(c+d);var c=this.getBuildCompleteFraction(),f=this.hasStartedBuilding(),e=!1;b=this.shouldInstantlyStartBuilding()||!this.shouldDelayBuildingUntilBuilderPresent()||this.getHasBuilder();f&&!b&&(this.stopBuilding(),
f=!1);if(!f&&b){if(this.shouldDelayBuildingUntilNothingOverlapsUs()&&(b=this.getEntityEC("ECPhysicsCube"))&&b.ignoringCollision)if(b=this.getObjectOverlappingPhysicsCube(b))if(e=!0,b.entity&&(b=b.entity.getEC("ECWildlingAgent")))b.onBlockingScaffold(this.entity);e||this.startBuilding()}if((e=this.getEntityEC("ECMesh"))&&a)e.setScaleY(a.lerp(0.5,1,c)),this.scratchpadLocalOffset=a.v3Build(0,-0.5,0,this.scratchpadLocalOffset),e.setLocalOffset(this.scratchpadLocalOffset),e.setScale(0.75);1<=c&&!this.isWaitingForClick()&&
(this.playSound("buildingReady"),0>=d&&10<=this.buildTime&&(this.getPreUpgradeObject()||this.showBuildingCompleteNewsFlash()),this.createPlannedObject(),this.entity.setToBeDestroyed(),this.willFinishOnClick&&(this.willFinishOnClick=!1,this.sendBuildingCompletedOfflineMetric(this.getPlannedObject(),this.extraBuildTimeThisFrame)));this.isWaitingForClick()?this.doWaitingForClickGUI():f&&this.doProgressBar()},showBuildingCompleteNewsFlash:function(){this.globals.cheats.grindless&&this.gameManager.getGuiManager().addGameMessage("ecScaffold"+
this.entity.getName()+"buildingComplete",this.getBuildingName(!1)+" Construction","Complete!",4,"newsflashBuildingComplete")},getBuildingName:function(a){var b=null,c=this.getEntityEC("ECBuilding"),d=0;c&&(b=c.getBuildingName(),a&&(d=c.getLevel(),0<d&&(b+=" Level "+d)));b||(b="Building");return b},doRadialMenuInstantBuildButton:function(a,b,c){var d=this.globals.currentLanguage.GAME_HUD_SPEED_UP,f=this.numberToCommaString(this.getCostToInstantlyBuild());this.canEntityAffordInstantBuild(b)?a.doButton({id:"ecRadialMenu"+
this.entity.getName()+"InstantBuild",text1:d,text2:f,v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:"speedup"})&&(this.sendBuildingSpeedupBought(this.getPlannedObject()),this.instantlyBuild(b)):(d=this.globals.currentLanguage.GUI_BUTTON_BUY_AMBER,a.doButton({id:"ecRadialMenu"+this.entity.getName()+"InstantBuild Unavailable",text1:d,text2:f,v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:"addAmber"})&&this.openShop())},openShop:function(){var a=this.gameManager,b;a&&(b=Wa.create(a,
this.globals),a.setGameState(b))},sendBuildingSpeedupBought:function(a){this.globals.metricsManager.sendGameMetric("buildingSpeedupBought_"+a,this.getCostToInstantlyBuild())},sendBuildingCompletedOfflineMetric:function(a,b){this.globals.metricsManager.sendGameMetric("buildingCompletedOffline_"+a,b)},instantlyStartBuilding:function(){this.shouldInstantlyStart=!0},shouldInstantlyStartBuilding:function(){return this.shouldInstantlyStart},hasStartedBuilding:function(){return this.startedBuilding},startBuilding:function(){var a=
this.getEntityEC("ECPhysicsCube");a&&a.setIgnoringCollision(!1);this.startedBuilding=!0;this.setUpdatePeriod(0)},stopBuilding:function(){var a=this.getEntityEC("ECPhysicsCube");a&&a.setIgnoringCollision(!0);this.startedBuilding=!1;this.setUpdatePeriod(1)},isUpgrading:function(){var a=!1;this.getPreUpgradeObject()&&(a=!0);return a},getBuildTimeRemaining:function(){return(1-this.buildComplete)*this.buildTime},reduceRemainingBuildTime:function(a){this.isWaitingForClick()&&(this.builderHasBeenClicked=
!0);0<a&&(this.extraBuildTimeThisFrame+=a)},finishBuildingWhenBuilderClicked:function(){var a;this.waitingForClick||(this.waitingForClick=!0,this.builderHasBeenClicked=!1,this.willFinishOnClick=!0,(a=this.getEntityEC("ECBuilding"))&&a.disableMovement(!0))},isWaitingForClick:function(){return this.waitingForClick},getCostToInstantlyBuild:function(){var a=this.getBuildTimeRemaining();return 60>=a?5:3600>=a?Math.ceil(100*(a/3600)):86400>=a?Math.ceil(1E3*(a/86400)):604800>=a?Math.ceil(2E3*(a/604800)):
Math.ceil(4E3*(a/1209600))},getObjectOverlappingPhysicsCube:function(a){var b=this.gameManager,c=this.globals.mathDevice,d=[],f=[],e=this.entity,h;a||(a=this.getEntityEC("ECPhysicsCube"));if(a&&(b&&c)&&(a=a.getv3Scale())){a=c.v3Build(0.5*a[0]-0.3,0.5*a[1]-0.3,0.5*a[2]-0.3);c=c.aabbBuildFromCentreHalfExtents(this.getv3Location(),a);b.getOverlappingObjects(c,d,f);d=f.length;for(b=0;b<d;b+=1)if((c=f[b])&&c.entity!==e){h=c;break}if(!h){d=f.length;for(b=0;b<d;b+=1)if((c=f[b])&&c.entity!==e){h=c;break}}}return h},
shouldDelayBuildingUntilNothingOverlapsUs:function(){return this.archetype.delayBuildingUntilNothingOverlapsUs},shouldDelayBuildingUntilBuilderPresent:function(){return this.archetype.delayBuildingUntilBuilderPresent},setHasBuilder:function(a){this.hasBuilder=a},getHasBuilder:function(){return this.hasBuilder},getHasOfflineBuilder:function(){return this.hasOfflineBuilder},setHasOfflineBuilder:function(a){this.hasOfflineBuilder=a},shouldPlayTweenWhenBuildingFinished:function(){return this.archetype.playTweenWhenBuildingFinished},
createPlannedObject:function(){var a=this.gameManager.getEntityFactory(),b=this.getEntityEC("ECPhysicsCube"),c=this.getEntityEC("ECPhysicsSphere");b&&b.setIgnoringCollision(!0);c&&c.setValid(!1);b=this.getRotationY();a&&(a=a.createInactiveEntityInstance("Placed"+this.plannedObject,this.plannedObject,this.getv3Location(),b),c=this.gameManager.getFactionManager(),b=a.getEC("ECFaction"),c=this.plannedFactionName?this.plannedFactionName:c.getHeroFactionName(),b&&b.setFaction(c),b=a.getEC("ECBuilding"),
c=this.getEntityEC("ECBuilding"),b&&(this.globals.gameManager.eventManager.notify("BuildingEvent",{reason:"completed",building:b.entity,scaffold:this.entity}),this.globals.gameManager.eventManager.notify("BuildingEvent",{reason:"levelup",building:b.entity,scaffold:this.entity}),this.isNewBuilding&&this.globals.gameManager.eventManager.notify("BuildingEvent",{reason:"firstBuild",building:b.entity,scaffold:this.entity}),c&&b.setBuildingParentEntity(c.getBuildingParentEntity()),b.applyTemporaryBuildingData(this.temporaryBuildingData),
this.clearTemporaryBuildingData()),a.hasEC("ECGameCritical")&&this.gameManager.eventManager.notify("HQUpgraded",{}),a.activate(),a.transferIdentity(this.entity),this.shouldPlayTweenWhenBuildingFinished())},beginAppearAnim:function(a){var b=this.globals.mathDevice;a&&b&&(a.setLocalOffset(b.v3Build(0,-0.25,0)),a.setScale(0.75),a.update(),a.setOnlySaveRotation(!0),G.Create({scale:0.75,yOffset:-0.25}).to({scale:1,yOffset:0},0.7).easing(G.Easing.Elastic.Out).onUpdate(function(){a.setLocalOffset(b.v3Build(0,
this.yOffset,0));a.setScale(this.scale)}).start())},updateBuildCompleteFraction:function(a){if(0<this.buildDelay)if(a>this.buildDelay)a-=this.buildDelay,this.buildDelay=0;else{this.buildDelay-=a;return}var b=this.buildTime,b=this.areAnyHeroesNearby()?1*b:b,c=this.getBuildSpeed();this.isWaitingForClick()?this.builderHasBeenClicked&&(this.waitingForClick=!1,this.buildComplete=1,(a=this.getEntityEC("ECBuilding"))&&a.disableMovement(!1)):this.hasStartedBuilding()&&1>this.buildComplete&&(0<=b&&(this.buildComplete=
0<b?this.buildComplete+(a*c+this.extraBuildTimeThisFrame)/b:1),this.buildComplete=Math.min(this.buildComplete,1));this.extraBuildTimeThisFrame=0},getBuildCompleteFraction:function(){return this.buildComplete},manageLargeTimeStep:function(a){this._super(a);this.updateBuildCompleteFraction(a)},areAnyHeroesNearby:function(){var a=this.gameManager,b=this.globals.mathDevice,c,d,f,e=this.getEntityEC("ECPhysicsCube"),h,i=!1;if(a&&(b&&e)&&(h=this.getv3Location(),e=e.getRadius()+this.getAdditionalSearchRadius(),
e*=e,a=a.getHeroList())){d=a.length;for(f=0;f<d;f+=1)if(c=a[f])if(c=c.getv3Location(),b.v3LengthSq(b.v3Sub(h,c))<=e){i=!0;break}}return i},getAdditionalSearchRadius:function(){return this.additionalSearchRadius},draw:function(){},doWaitingForClickGUI:function(){var a=this.globals.mathDevice.v3Copy(this.getv3Location());a[1]+=2;this.gameManager.getGuiManager().addDrawGui("buildingCompleteBar",{v3WorldLocation:a},"idBuildingCompleteGUI"+this.entity.getName())},doProgressBar:function(){var a=this.getBuildCompleteFraction();
if(!(0<this.buildDelay||0>=a)){var b=Math.floor(this.getBuildTimeRemaining()),b=this.formatTimeToString(b),c=this.globals.mathDevice.v3Copy(this.getv3Location());c[1]+=2;a={v3WorldLocation:c,text:b,completeFactor:a};this.gameManager.getGuiManager().addDrawGui("buildingProgressBar",a,"idBuildProgress"+this.entity.getName())}},drawDebug:function(){},saveSerialize:function(){return{plannedObject:this.plannedObject,preUpgradeObject:this.preUpgradeObject,isNewBuilding:this.isNewBuilding,startedBuilding:this.startedBuilding,
buildComplete:this.buildComplete,additionalSearchRadius:this.additionalSearchRadius,plannedFactionName:this.plannedFactionName,hasOfflineBuilder:this.hasOfflineBuilder,waitingForClick:this.waitingForClick,buildDelay:this.buildDelay,buildTime:this.buildTime,canSpeedUpWithSoftCurrency:this.canSpeedUpWithSoftCurrency,minBuildSpeed:this.minBuildSpeed,temporaryResourceCaps:this.temporaryResourceCaps,temporaryBuildingData:this.getSerializableTemporaryBuildingData()}},serialize:function(a){this._super(a);
a.plannedObject=this.plannedObject;a.preUpgradeObject=this.preUpgradeObject;a.startedBuilding=this.startedBuilding;a.buildComplete=this.buildComplete;a.additionalSearchRadius=this.additionalSearchRadius;a.plannedFactionName=this.plannedFactionName;a.hasOfflineBuilder=this.hasOfflineBuilder;a.waitingForClick=this.waitingForClick;a.buildDelay=this.buildDelay;a.buildTime=this.buildTime;a.canSpeedUpWithSoftCurrency=this.canSpeedUpWithSoftCurrency;a.minBuildSpeed=this.minBuildSpeed;a.temporaryResourceCaps=
this.temporaryResourceCaps;a.temporaryBuildingData=this.getSerializableTemporaryBuildingData()},getSerializableTemporaryBuildingData:function(){var a=this.temporaryBuildingData,b,c=null;if(a){c={};for(b in a)a.hasOwnProperty(b)&&(c[b]=a[b]);c.wildling&&(c.wildling=null);c.ecPlacedBuildingTrackerData&&(c.ecPlacedBuildingTrackerData=null);c.ecCapDispenserTrackerData&&(c.ecCapDispenserTrackerData=null)}return c},serializeDelta:function(){}});Jh.create=function(a,b){return new Jh(a,b)};F.prototype.eCCreationMap[Jh.prototype.entityComponentName]=
Jh;var Kh=F.extend({entityComponentName:"ECSignPost",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldDraw:!0,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{},Y_OFFSET:0.5,init:function(a,b){this._super(a,b);this.text1=b.text2;this.text2=b.text3;this.text3=b.text4;this.textSize=this.smoothAngle=0;this.randomOffset=2*Math.random()*Math.PI},activate:function(){this._super();var a=this.getEntityEC("ECMesh");a&&(a.disableDeltaSerialize=!0,a.setScale(0.75));var a=function(a){this.onImpact(a)}.bind(this),
b=this.entity.getEC("ECInteractable");b&&b.setOnInteractCallback(a)},onImpact:function(a){a.hasEC("ECHero")&&(this.active||(this.active=!0,this.beginActive(),this.read=!0),this.touchedMe=a)},update:function(){this._super();this.active?this.updateActive():this.updatePassive()},updateActive:function(){var a=this.globals.mathDevice,b=this.getEntityEC("ECMesh");this.smoothAngle+=0.2*a.diffAngles(this.smoothAngle,a.v3ToAngle(a.v3Sub(this.getv3Location(),this.touchedMe.getv3Location()))-0.5*Math.PI);this.smoothAngle=
a.boundAngle(this.smoothAngle);b.setRotationY(this.smoothAngle);9<a.v3DistanceSq(this.getv3Location(),this.touchedMe.getv3Location())&&(this.active=!1,this.beginPassive())},updatePassive:function(){var a=this.globals,b=a.mathDevice,c=this.getEntityEC("ECMesh");this.smoothAngle+=this.getTimeSinceLastUpdate()*(this.read?0.5:1.5);this.smoothAngle=b.boundAngle(this.smoothAngle);c.setRotationY(this.smoothAngle);c.setLocalOffset(b.v3Build(0,0.125*Math.sin(2*a.gameCurrentTime+this.randomOffset)+this.Y_OFFSET,
0))},beginActive:function(){var a=this.globals.mathDevice,b=this.getEntityEC("ECMesh"),c=this,d=G.Create({y:2+this.Y_OFFSET}).to({y:0+this.Y_OFFSET},1).easing(G.Easing.Bounce.Out).onUpdate(function(){b.setLocalOffset(a.v3Build(0,this.y,0))});G.Create({y:0+this.Y_OFFSET,scale:0.75,textSize:0}).to({y:2+this.Y_OFFSET,scale:1,textSize:1},0.25).easing(G.Easing.Elastic.Out).onUpdate(function(){b.setLocalOffset(a.v3Build(0,this.y,0));b.setScale(this.scale);c.textSize=this.textSize}).chain(d).start()},beginPassive:function(){var a=
this.getEntityEC("ECMesh"),b=this;G.Create({scale:1,textSize:1}).to({scale:0.75,textSize:0},0.5).easing(G.Easing.Circular.Out).onUpdate(function(){a.setScale(this.scale);b.textSize=this.textSize}).start()},draw:function(){var a=this.globals,b=a.mathDevice,c=a.simpleFontRenderer,a=a.camera.worldToScreen(b.v3Add(this.getv3Location(),b.v3Build(0,1.5,0)));void 0!==a&&0<this.textSize&&(b={x:a[0],y:a[1],pointSize:32,alignment:1,r:1,g:1,b:1},c.drawFontDouble(this.text1,b),b.y+=35,c.drawFontDouble(this.text2,
b),b.y+=35,c.drawFontDouble(this.text3,b));!this.read&&void 0!==a&&(b={x:a[0],y:a[1],scale:0.5*(1-this.textSize),alignment:1,r:1,g:1,b:1},c.drawFontDouble("Click Me!",b))},drawDebug:function(){},destroy:function(){this._super();this.setGameSpace(void 0)},serialize:function(a){this._super(a);a.text1=this.text1;a.text2=this.text2;a.text3=this.text3}});F.prototype.eCCreationMap[Kh.prototype.entityComponentName]=Kh;Kh.create=function(a,b){return new Kh(a,b)};var Lh=F.extend({entityComponentName:"ECSleeping",
updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldAlwaysUpdate:!1,shouldDraw:!1,shouldSerialize:!1,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,storeGlobalList:!1,parameters:{sleepOnCreation:!1,onWakeUpEffect:""},SLEEP_ROTATION_X:Math.PI/2,SLEEP_ROTATION_Y:-0.75*Math.PI,SLEEP_OFFSET_Y:-1,init:function(a,b){this._super(a,b)},activate:function(){this._super();this.archetype.sleepOnCreation&&this.setSleeping()},setSleeping:function(a){this.setToDraw(a);a?this.fallAsleep():this.wakeUp();this.sleeping=
a},fallAsleep:function(){var a=this.getEntityEC("ECMesh");a&&(a.setRotationX(this.SLEEP_ROTATION_X),a.setRotationY(this.SLEEP_ROTATION_Y));a=this.globals.mathDevice.v3Copy(this.getv3Location());a[1]+=this.SLEEP_OFFSET_Y;this.entity.setv3Location(a)},wakeUp:function(){this.gameManager.guiManager.addSpeechBubble(this.getv3Location(),"speechExclaim");this.playEffect(this.archetype.onWakeUpEffect);var a=this.globals.mathDevice.v3Copy(this.getv3Location());a[1]-=this.SLEEP_OFFSET_Y;this.entity.setv3Location(a);
if(a=this.getEntityEC("ECMesh"))a.setRotationY(-this.SLEEP_ROTATION_Y),a.setRotationX(-this.SLEEP_ROTATION_X)},update:function(){this._super()},draw:function(){this.drawStunned()},drawDebug:function(){},onToBeDestroyed:function(){this._super()},destroy:function(){this._super()}});Lh.create=function(a,b){return new Lh(a,b)};F.prototype.eCCreationMap[Lh.prototype.entityComponentName]=Lh;var Mh=F.extend({entityComponentName:"ECSockets",updatePeriod:0,sortPriority:0,shouldUpdate:!0,shouldAlwaysUpdate:!0,
shouldDraw:!1,shouldSerialize:!1,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{stationary:!0},init:function(a,b){this._super(a,b);this.socketedEntities=[]},update:function(){this._super();this.createSocketedEntities();this.setToUpdate(!1)},createSocketedEntities:function(){var a=this.getSockets(),b,c,d,f=this.isStationary(),e=this.createSocketedEntity;if(a){b=a.length;for(c=0;c<b;c+=1)(d=a[c])&&e.call(this,d.archetypeName,d.localOffset,f)}},beginAppearAnim:function(a,b){var c=this.globals.mathDevice,
d=this;a&&c&&(a.setScale(0.1),a.update(),b.setStationary(!1),G.Create({scale:0.5}).to({scale:1},0.7).easing(G.Easing.Elastic.Out).onUpdate(function(){a.setScale(this.scale)}).onComplete(function(){b.setStationary(d.isStationary())}).delay(0.4).start())},createSocketedEntity:function(a,b,c){var d=this.globals,f=d.mathDevice,e=this.gameManager.getEntityFactory(),h,i=this.entity,j;if(a&&(f&&e)&&(h=f.v3Copy(this.getv3Location()),b?(b=f.v3Build(b[0],b[1],b[2]),c&&(h=(j=i.getEC("ECMesh"))?f.m43TransformPoint(j.getm43Transform(),
b,h):f.v3Add(h,b,h))):b=f.v3BuildZero(),a=e.createInactiveEntityInstance("SocketedEntity",a,h)))a.setGameSpace(i.getGameSpace()),f=this.gameManager.getFactionManager(),h=f.getHeroFactionName(),e=a.getEC("ECFaction"),i&&(f=i.getEC("ECFaction"))&&(h=f.getFactionName()),e&&e.setFaction(h),d=F.createFromName("ECAttach",d),d.setParent(i),d.setStationary(c),d.setv3LocalOffset(b),a.addECToCustomEntity(d),a.shouldLevelSave=!1,a.shouldPlayerSave=!1,a.activate(),(c=a.getEC("ECMesh"))&&this.beginAppearAnim(c,
d),this.socketedEntities.push(a)},getSocketedEntities:function(){return this.socketedEntities},applyToSocketedEntities:function(a){var b=this.getSocketedEntities(),c,d,f;if(b&&a){d=b.length;for(c=0;c<d;c+=1)(f=b[c])&&a(f,Array.prototype.slice.call(arguments,1))}},isStationary:function(){return this.archetype.stationary},getSockets:function(){return this.archetype.sockets},draw:function(){},drawDebug:function(){},destroy:function(){this._super()}});F.prototype.eCCreationMap[Mh.prototype.entityComponentName]=
Mh;Mh.create=function(a,b){return new Mh(a,b)};var Nh=F.extend({entityComponentName:"ECSpawner",sortPriority:4,updatePeriod:0,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!0,shouldSave:!1,realTime:!1,init:function(a,b){this._super(a,b);this.roomID=this.safeCopy(b.roomID,-1);void 0===b.groupID?this.instant=!0:(this.groupID=b.groupID,this.outputNetworkID=this.buildIDArray(this.roomID,this.groupID));this.objectType=this.safeCopy(b.objectType,0);this.objectCount=this.safeCopy(b.objectCount,
1);this.enemySpawner="boulder"!==this.objectType&&"dart"!==this.objectType;this.v3Direction=this.v3SafeCopy(b.v3Direction);this.repeatTime=this.startRepeatTime=b.repeatTime;this.delayTime=b.delayTime;this.spawnRadius=this.safeCopy(b.spawnRadius,0);this.startTriggerCount=this.safeCopy(b.triggerCount+1,1);this.triggerCount=this.startTriggerCount=0>=this.startTriggerCount?void 0:Math.max(this.startTriggerCount-1,1)},activate:function(){this._super();this.enemySpawner&&void 0!==this.triggerCount&&this.entity.getGameSpace().addEnemy(this.triggerCount*
this.objectCount)},hasOutputNetworkID:function(a){return this.instant?!1:this.arrayContains(this.outputNetworkID,a)},update:function(){this._super();this.isManagedByThisMachine()&&(this.instant&&!this.triggered)&&(this.triggerOn(),this.triggered=!0);void 0!==this.triggerCount&&0>=this.triggerCount?this.repeatTime||this.entity.setToBeDestroyed():void 0!==this.repeatTimer&&(this.repeatTimer-=this.getTimeSinceLastUpdate(),0>=this.repeatTimer&&(this.reduceTriggerCount(),this.isValidToTrigger()&&(this.spawn(),
this.setTimer())))},draw:function(){},setTimer:function(){void 0!==this.repeatTime&&(this.repeatTimer=this.repeatTime)},getSpawnLocation:function(){if(0===this.spawnRadius)return this.getv3Location();var a=this.globals.mathDevice,a=a.v3Add(this.getv3Location(),a.v3BuildRandomCircle(this.spawnRadius));return a=this.gameManager.placeOnGround(a,0.5)},spawn:function(a){var b,c;if(this.isManagedByThisMachine()){var d;if("dart"===this.objectType)b=this.createDart();else{c=this.gameManager.getFactionManager();
c=c.getEnemyFactionName();for(d=0;d<this.objectCount;d+=1)b=this.createEnemy(this.objectType,this.getSpawnLocation(),a,c)}return b}},isValidToTrigger:function(){return void 0!==this.triggerCount&&0>=this.triggerCount?!1:!0},reduceTriggerCount:function(){void 0!==this.triggerCount&&(this.triggerCount-=1)},resetTriggerCount:function(){this.triggerCount=this.startTriggerCount},triggerOn:function(a){void 0!==this.repeatTime&&(this.setTimer(),this.resetTriggerCount());if(this.isValidToTrigger())return this.reduceTriggerCount(),
this.spawn(a)},triggerOff:function(a){if(void 0!==this.repeatTime)this.repeatTimer=void 0;else return this.triggerOn(a)},toggle:function(a){void 0!==this.repeatTime?void 0!==this.repeatTimer?this.triggerOff(a):this.triggerOn(a):this.triggerOn(a)},createEnemy:function(a,b,c,d){a=this.gameManager.getEntityFactory().createActiveEntityInstance(a,a,b,c);if(b=a.getEC("ECAgent"))b.setID(c),b.setDelayTime(this.delayTime);(c=a.getEC("ECFaction"))&&c.setFaction(d);return a},reset:function(){this.triggerCount=
this.startTriggerCount;this.repeatTime=this.startRepeatTime},createDart:function(){var a=this.globals.mathDevice;return this.gameManager.projectileFactory.createProjectile(this.entity,this.getv3Location(),a.v3Add(this.getv3Location(),this.v3Direction),"PROJECTILE_TYPE_DART")}});F.prototype.eCCreationMap[Nh.prototype.entityComponentName]=Nh;Nh.create=function(a,b){return new Nh(a,b)};var Ne=F.extend({entityComponentName:"ECSprite",sortPriority:7,updatePeriod:0,shouldUpdate:!1,shouldDraw:!0,shouldSerialize:!0,
shouldDeltaSerialize:!0,shouldSave:!1,realTime:!0,parameters:{color:{description:"The colour of the sprite",defaultValue:[1,1,1,1],minValue:0,maxValue:1,step:0.1},rotationSpeed:0,size:1},init:function(a,b){this._super(a,b);this.path=this.safeCopy(b.path,"models/cube.dae");this.size=this.safeCopy(b.scale,1);this.scale=1;this.visible=!0},update:function(){this._super()},setVisible:function(a){this.visible=a},isVisible:function(){return this.visible},draw:function(){var a=this.globals,b=a.simpleSpriteRenderer,
c=this.archetype,d=c.additive,a=a.gameCurrentTime*c.rotationSpeed,f=this.getv3Location(),e=this.getEntityEC("ECMesh");e&&(f=e.getTransformedv3Location());this.isVisible()&&b.addSprite({v3Location:f,size:this.scale*c.size,offsetX:c.offsetX,offsetY:c.offsetY,blendStyle:d?ua.prototype.blendStyle.ADD:ua.prototype.blendStyle.NORMAL,texture:this.path,v4color:c.color,angle:a})},setScale:function(a){this.scale=a},getScale:function(){return this.scale},setOffset:function(a,b){this.offsetX=a;this.offsetY=b},
serialize:function(a){this._super(a);a.path=this.path;a.scale=this.scale},serializeDelta:function(a){this.serialize(a)}});Ne.preloadComponent=function(a,b){a.textureManager.load(b.path)};Ne.create=function(a,b){return new Ne(a,b)};F.prototype.eCCreationMap[Ne.prototype.entityComponentName]=Ne;var Gc=F.extend({updatePeriod:0,entityComponentName:"ECPlayerBuilder",sortPriority:4,shouldUpdate:!0,shouldDraw:!0,parameters:{snapBuildingsToGrid:!1,usesBuildZones:!0,maxBuildHeight:2,canBuildOnEntities:!0,
playerBuildCloseness:1,maxPlayerBuildCloseness:3,needsDoubleClickWhenClose:!1},init:function(a,b){var c=this.globals.mathDevice;this._super(a,b);this.heldItemQuantity=0;this.buildingGuidelineTexture="textures/block.dds";this.shouldPayWhenPlacingBuildings=!1;this.throwing=0;c?(this.v4ValidBuildPositionTextureColor=c.v4Build(0.1,0.8,0.1,0.8),this.v4InvalidBuildPositionTextureColor=c.v4Build(1,0,0.1,0.8)):this.v4InvalidBuildPositionTextureColor=this.v4ValidBuildPositionTextureColor=void 0;this.lastBuildTime=
-100},setDestination:function(a){var b=this.globals.mathDevice;this.v3Destination||(this.v3Destination=b.v3BuildZero());this.v3Destination=b.v3Copy(a,this.v3Destination)},clearDestination:function(){this.v3Destination=null},isBuilding:function(){return void 0!==this.heldObjectName},getTimeSinceBuilding:function(){return this.isBuilding()?0:this.globals.gameCurrentTime-this.lastBuildTime},getHeldObjectName:function(){return this.heldObjectName},getHeldObjectScaffoldType:function(){var a=this.gameManager,
b;b=this.getHeldObjectName();var c;if(a&&b&&(a=a.getEntityFactory()))if(b=a.getECArchetype(b,"ECBuilding"))c=b.scaffoldType;return c},getHeldObjectBuildTime:function(){var a=this.gameManager,b;b=this.getHeldObjectName();var c=0;if(a&&b&&(a=a.getEntityFactory()))if(b=a.getECArchetype(b,"ECBuilding"))c=b.buildTime;return c},setShouldPayWhenPlacingBuildings:function(a){this.shouldPayWhenPlacingBuildings=a},getv3HeldObjectExtents:function(){return this.v3HeldObjectExtents},adjustResourceCap:function(a,
b){var c=this.gameManager,d=c.getHero();d&&!d.toBeDestroyed?(c=d.getEC("ECPlayerData"),c.adjustResourceCap(a,b)):c.resourceCap[a]+=b},isValidToBuildOnV3CursorLocation:function(a){a=this.getv3BuildLocation(a);return this.canBuildAtPosition(a)},getRequiredCloseness:function(){return this.archetype.playerBuildCloseness},getMaxRequiredCloseness:function(){return this.archetype.maxPlayerBuildCloseness},getHeldItemQuantity:function(){return this.heldItemQuantity},setHeldItemQuantity:function(a){this.heldItemQuantity=
a},getMaxBuildHeight:function(){return this.archetype.maxBuildHeight},getHeldEntityWeaponRange:function(){return this.heldEntityWeaponRange},isThrowing:function(){return 0<this.throwing},canBuildOnEntities:function(){return this.archetype.canBuildOnEntities&&this.heldEntityStackable},mustPlaceNearCreator:function(){return this.heldEntityMustPlaceNearCreator},shouldUseLinePlacement:function(){return 0<this.maxLinePlacementLength},canBuildAtPosition:function(a){var b=this.getv3HeldObjectExtents(),c=
this.canBuildOnEntities(),d=this.shouldUseLinePlacement();return this.isThrowing()?!1:this.canBuildAtPositionInternal(a,b,c,d,this.heldEntityBuildingType)},obeysBuildingPlacementRadiusEntities:function(a,b,c,d){for(var f=this.gameManager.getEntitiesWithEC("ECBuildingPlacementRadius"),e=f.length,h,i=d,d=0;d<e;d+=1)if(h=f[d],h=h.getEC("ECBuildingPlacementRadius"),!i&&h.isValid(a,b,c)&&(i=!0),h.isInvalid(a,b,c))return!1;return i},canBuildAtPositionInternal:function(a,b,c,d,f){var e=this.gameManager,
h=this.globals.mathDevice,i=!0,j=this.spBuildingParentEntity?this.spBuildingParentEntity.get():void 0,k=!1,l,m,q=this.getMoveFromEntity();if(!e.getGameSpace(a))return!1;var p=!1;if(e&&h&&b){l=h.v3Copy(a);m=0.5*b[1]+0.001;l=e.placeOnGround(l,m,q);if((e=e.getCollisionInfo(l,h.v3Add(l,h.v3Build(0,-2*m,0)),!1,q))&&e.collidedWorldCube&&(e.collidedWorldCube.buildZone||e.collidedWorldCube.entity))p=!0;p||(i=!1);i&&this.mustPlaceNearCreator()&&(j&&!j.toBeDestroyed&&(j=j.getEC("ECBuildingPlacementRadius"))&&
j.isv3LocationWithinBuildArea(a,this.heldEntityIsTrap)&&(k=!0),k||(i=!1));i&&!this.obeysBuildingPlacementRadiusEntities(a,this.heldEntityIsTrap,f,this.heldEntityCanPlaceAnywhere)&&(i=!1);i&&(this.doesLocationHaveRoomForHeldBuilding(l,b)||(i=!1));i&&d&&this.shouldUseLinePlacement()&&!this.canPlaceInLines(a,b,c,f)&&(i=!1)}return i},canPlaceInLines:function(a,b,c,d){if(!this.v3LastPlacedLocation)return!0;a=this.getLinePlacementLocations(a,this.v3LastPlacedLocation,b);if(!a)return!0;var f=a.length,e;
for(e=0;e<f;e+=1)if(!this.canBuildAtPositionInternal(a[e],b,c,!1,d))return!1;return!0},getLinePlacementLocations:function(a,b,c){var d=this.globals.mathDevice,f=c[0],c=c[2],a=d.v3Sub(a,this.v3LastPlacedLocation),f=Math.max(Math.abs(a[0]/f),Math.abs(a[2]/c)),c=this.getNumberThatCanBePlaced(this.heldObjectName);if(!(2>f||f>this.maxLinePlacementLength||f>c)){var c=[],f=Math.floor(f),a=d.v3ScalarMul(a,1/f),e,h;for(e=1;e<f;e+=1)h=d.v3AddScalarMul(b,a,e),c.push(this.getv3BuildLocation(h));return c}},doesLocationHaveRoomForHeldBuilding:function(a,
b){var c=this.gameManager,d=this.globals.mathDevice,f=this.entity,e=[],h=[],i,j,k=[],l=!1;i=this.getMoveFromEntity();if(a&&b&&c&&d){j=d.v3Build(0.5*b[0]-0.001,0.5*b[1]-0.001,0.5*b[2]-0.001);d=d.aabbBuildFromCentreHalfExtents(a,j);c.getOverlappingObjects(d,e,h);if(1<e.length)l=!0;else if(1===e.length&&(!e[0].entity||e[0].entity!==i))l=!0;if(!l){i=h.length;for(e=0;e<i;e+=1)if((j=h[e])&&j.entity!==f&&!j.entity.hasEC("ECAgent")&&!j.entity.hasEC("ECWildlingAgent")){l=!0;break}}if(!l&&(c=c.getBuildingManager()))this.getOverlappingBuildingFootprints(d,
k),0<k.length&&(l=!0)}return!l},getOverlappingBuildingFootprints:function(a,b){var c=this.globals.mathDevice,d,f,e,h,i,j=this.canBuildOnEntities(),k,l,m=this.getMoveFromEntity(),q=c.aabbCopy(a);q[1]-=1;q[4]+=1;if(q&&b&&(d=this.entity.getGameSpace()))f=c.aabbCopy(q),f[0]-=8,f[2]-=8,f[3]+=8,f[5]+=8,i=c.aabbBuildEmpty(),l=function(a){var d;if(a&&(q&&a!==m)&&(e=a.getEC("ECBuilding")))d=e.getAddedFootprintSize(),a.getAabbExtents(i),0<d&&(i[0]-=d,i[2]-=d,i[3]+=d,i[5]+=d),c.aabbOverlaps(q,i)&&(k=!1,j&&e.isStackable()&&
(h=a.getEC("ECRepairable"),k=!h||!h.isBroken()),k||b.push(a))},d.applyToEntitiesInGridCellsWithinExtents(f,l)},placeInHand:function(a,b,c,d,f,e){var h=this.gameManager;if(h&&(h=h.getEntityFactory(),0<b)){this.playSound("buildingPickup");this.heldObjectName&&this.heldObjectName!==a&&(this.shouldPayWhenPlacingBuildings&&!this.getMoveFromEntity()&&this.refundCost(),this.clearInHand());this.cannotCancel=!1;this.heldObjectName=a;this.instantBuildFlavour=c;this.isNewBuilding=e;this.infinitePlacement=d;
this.setHeldItemQuantity(this.getHeldItemQuantity()+b);this.setShouldPayWhenPlacingBuildings(d);this.heldObjectFootplateBuffer=h.getObjectBuildBuffer(a);this.v3HeldObjectExtents=h.getv3ObjectFootprintExtents(a);this.maxLinePlacementLength=h.getBuildingMaxLinePlacementLength(a);this.heldEntityIsTrap=this.heldEntityMustPlaceNearCreator=this.heldEntityCanPlaceAnywhere=this.heldEntityStackable=!1;this.heldEntityBuildingType=void 0;this.heldEntityWeaponRange=this.getEntityWeaponRange(a,!0);this.heldEntityWeaponMinRange=
this.getEntityWeaponRange(a,!1);this.spBuildingParentEntity=f?f.getSmartPointer():void 0;if(b=h.getECArchetype(a,"ECBuilding"))this.heldEntityStackable=b.stackable,this.heldEntityCanPlaceAnywhere=b.canPlaceAnywhere,this.heldEntityMustPlaceNearCreator=b.mustPlaceNearCreator,this.heldEntityIsTrap="Trap"===b.buildingType,this.heldEntityBuildingType=b.buildingType;this.createAndStoreHeldEntity(a,this.v3HeldObjectExtents,!0)}},setCannotCancel:function(a){this.cannotCancel=a},placeMoveScaffoldInHand:function(a,
b,c){var d=this.gameManager;if(d){d=d.getEntityFactory();this.playSound("buildingPickup");this.heldObjectName!==a&&this.clearInHand();this.cannotCancel=!1;this.spMoveFromEntity=b.getSmartPointer();this.heldObjectName=a;this.instantBuildFlavour=!0;this.infinitePlacement=this.isNewBuilding=!1;this.setHeldItemQuantity(this.getHeldItemQuantity()+1);this.setShouldPayWhenPlacingBuildings(!1);this.heldObjectFootplateBuffer=d.getObjectBuildBuffer(a);this.v3HeldObjectExtents=d.getv3ObjectFootprintExtents(a);
this.maxLinePlacementLength=d.getBuildingMaxLinePlacementLength(a);this.heldEntityIsTrap=this.heldEntityMustPlaceNearCreator=this.heldEntityCanPlaceAnywhere=this.heldEntityStackable=!1;this.heldEntityBuildingType=void 0;this.heldEntityWeaponRange=this.getEntityWeaponRange(a,!0);this.heldEntityWeaponMinRange=this.getEntityWeaponRange(a,!1);this.spBuildingParentEntity=c?c.getSmartPointer():void 0;if(b=d.getECArchetype(a,"ECBuilding"))this.heldEntityStackable=b.stackable,this.heldEntityCanPlaceAnywhere=
b.canPlaceAnywhere,this.heldEntityMustPlaceNearCreator=b.mustPlaceNearCreator,this.heldEntityIsTrap="Trap"===b.buildingType,this.heldEntityBuildingType=b.buildingType;this.createAndStoreHeldEntity(a,this.v3HeldObjectExtents,!0)}},getEntityWeaponRange:function(a,b){var c=0,d=this.gameManager.getEntityFactory(),f,e,h;if(a){if((f=d.getECArchetype(a,"ECFirearm"))&&f.drawWeaponRadius)if(f=f.weapon)(f=ba.archetypes[f])&&(c=b?f.maxRange:f.minRange);if(0>=c&&(d=d.getECArchetype(a,"ECSockets")))if(d=d.sockets){f=
d.length;for(e=0;e<f;e+=1)if(h=d[e])if(c=this.getEntityWeaponRange(h.archetypeName,b),void 0!==c)break}}return c},clearInHand:function(){this.setHeldItemQuantity(0);void 0!==this.heldObjectName&&(this.removeHeldEntity(),this.heldObjectName=this.spMoveFromEntity=void 0,this.maxLinePlacementLength=this.heldEntityWeaponMinRange=this.heldEntityWeaponRange=0,this.spBuildingParentEntity=this.v3LastPlacedLocation=void 0,this.lastBuildTime=this.globals.gameCurrentTime,this.globals.gameManager.eventManager.notify("EmptyHanded",
{entity:this.entity}))},increaseQuantityOfHeldObject:function(a){this.isBuilding()&&0<a&&this.setHeldItemQuantity(this.getHeldItemQuantity()+a)},removeHeldEntity:function(){this.heldEntity&&(this.heldEntity.setToBeDestroyed(),this.heldEntity=void 0)},shouldSnapBuildingsToGrid:function(){var a=!1,b=this.archetype;b&&(a=b.snapBuildingsToGrid);return a},getv3BuildLocation:function(a){var b=this.globals.mathDevice,c,d=this.getv3HeldObjectExtents(),f=this.entity.getGameSpace(),e=this.getMaxBuildHeight();
if(b&&(c=a?b.v3Copy(a):b.v3Copy(this.getv3Location()),f&&this.shouldSnapBuildingsToGrid()&&(a=f.snapPositionToGridLine(c,!1),c=f.snapPositionToGridSquare(c,!1),d))){if(1<d[0]%2||0===d[0]%2)c[0]=a[0];if(1<d[2]%2||0===d[2]%2)c[2]=a[2]}c&&(c[1]+=e);return c},attemptToPlaceBuilding:function(a){var b=!1,c=this.shouldPayWhenPlacingBuildings,a=this.getv3BuildLocation(a);if(this.canBuildAtPosition(a)&&this.canAffordToPlaceBuilding()&&(!this.shouldPayWhenPlacingBuildings||this.areBuildingPrerequisitesMet(this.heldObjectName)))this.placeAllBuildings(a,
c)&&(b=!0);return b},placeAllBuildings:function(a,b){var c=0;this.shouldUseLinePlacement()&&(c=this.placeBuildingsInLine(a,b));var d=this.getv3BuildLocation(a);this.placeBuilding(d,b,0.25*c,!0);this.isBuilding()&&(this.v3LastPlacedLocation?this.clearLastPlacedLocation():this.setLastPlacedLocation(d));return!0},placeBuildingsInLine:function(a,b){if(!this.v3LastPlacedLocation)return 0;var c=this.getv3HeldObjectExtents(),c=this.getLinePlacementLocations(a,this.v3LastPlacedLocation,c);if(!c)return 0;
var d=c.length,f;for(f=0;f<d;f+=1)this.isBuilding()&&this.placeBuilding(c[f],b,0.25*f);return d},canAffordToPlaceBuilding:function(){var a=!0,b,c,d,f;this.shouldPayWhenPlacingBuildings&&(b=this.getEntityEC("ECPlayerData"),c=this.getBuildingResourceCost(this.heldObjectName),d=this.getBuildingSecondaryResourceCost(this.heldObjectName),f=this.getBuildingSoftCurrencyCost(this.heldObjectName),a=!1,b&&b.getResource(E.LUMBER)>=c&&(b.getResource(E.STONE)>=d&&b.getSoftCurrency()>=f)&&(a=!0));return a},getBuildingResourceCost:function(a){var b=
this.gameManager,c=0;if(b&&(b=b.getEntityFactory()))if(a=b.getECArchetype(a,"ECBuilding"))c=a.resourceCost;return c},getBuildingSecondaryResourceCost:function(a){var b=this.gameManager,c=0;if(b&&(b=b.getEntityFactory()))if(a=b.getECArchetype(a,"ECBuilding"))c=a.secondaryResourceCost;return c},getBuildingSoftCurrencyCost:function(a){var b=this.gameManager,c=0;if(b&&(b=b.getEntityFactory()))if(a=b.getECArchetype(a,"ECBuilding"))c=a.softCurrencyCost;return c},throwHeldObjectToDestinationAndBuild:function(a,
b,c,d){if(this.heldEntity){var f=this.heldEntity,e=this.globals.mathDevice,h=f.getEC("ECAttach"),i=f.getEC("ECMesh"),j=0.01*Math.random()-0.02,k=0.01*Math.random()-0.02,l=this,m=i.getSummedScale(),q=m,p=this.gameManager.getEntityFactory(),s=this.getEntityEC("ECMesh");s&&(m*=s.getSummedScale());(p=p.getECArchetype(b,"ECMesh"))&&(q=0.75*p.scale);this.throwing+=1;var t=this.spBuildingParentEntity,u=this.spMoveFromEntity,p=G.Create({lerp:0}).to({lerp:1},0.35).easing(G.Easing.Linear.None).onFirstUpdate(function(){this.v3StartLocation=
e.v3Copy(f.getv3Location());h.clearParent();h.clearTransform();f.removeECFromCustomEntity("ECAttach");i.setLocalOffset(e.v3BuildZero())}).onUpdate(function(){var b=2.5*Math.sin(Math.PI*this.lerp);f.setv3Location(e.v3Add(e.v3Lerp(this.v3StartLocation,a,this.lerp),e.v3Build(0,b,0)));i.addRotationX(j);i.addRotationY(k);i.setScale(e.lerp(m,q,this.lerp))}).onComplete(function(){l.placeScaffold(a,b,t,u);f.setToBeDestroyed()});c&&p.delay(c);p.start();this.createAndStoreHeldEntity(this.heldObjectName,this.v3HeldObjectExtents,
d)}},getMoveFromEntity:function(){if(this.spMoveFromEntity)return this.spMoveFromEntity.get()},placeScaffold:function(a,b,c,d){var f=this.gameManager,e=this.globals.mathDevice;this.throwing-=1;if(f){var h=Math.PI;this.v3HeldObjectExtents[0]===this.v3HeldObjectExtents[2]&&(h=0.5*Math.PI);var i=e.v3ToAngle(e.v3Sub(this.getv3Location(),a)),i=e.clampAngleToNearest(i,h),h=f.getEntityFactory(),j=h.getECArchetype(b,"ECBuilding");j&&(j.randomRotate&&(i+=0.5*e.randomIntInRange(0,3)*Math.PI),j.noRotate&&(i=
0));var d=d?d.get():void 0,e=c?c.get():void 0,j=d?d.getArchetypeName():void 0,k=(c=d?d.getEC("ECResourceStorage"):null)?c.getTemporaryResourceCaps():[0,0],a=f.placeOnGround(a,0.5,d),i=h.createScaffold("HeldBuildObject",b,a,i,this.entity,j,!1,0,k,e,this.isNewBuilding);if(a=i.getEC("ECScaffold"))this.instantBuildFlavour&&(a.setBuildTime(0.5),a.setMinBuildSpeed(1),a.instantlyStartBuilding()),d&&(f=d.getEC("ECScaffold"),h=d.getEC("ECBuilding"),e=d.getEC("ECSelectable"),f?(a.loadTemporaryScaffoldData(f.generateTemporaryScaffoldData()),
a.setTemporaryBuildingData(f.getTemporaryBuildingData()),f.stopBuilding()):h&&a.setTemporaryBuildingData(h.generateTemporaryBuildingData(!0)),c&&c.removeResourceCap(),e&&e.setValid(!1));i.transferIdentity(d);a&&d&&d.shrinkDisappear(0.25);this.globals.gameManager.eventManager.notify("BuildingEvent",{reason:"placed",building:this.entity,scaffold:i,fromMove:d?!0:!1});d||this.sendBuildingInitiatedMetric(b);if(b=this.getEntityEC("ECWildlingLeader"))b.onScaffoldPlaced(i)}},setLastPlacedLocation:function(a){this.v3LastPlacedLocation=
this.globals.mathDevice.v3Copy(a,this.v3LastPlacedLocation)},clearLastPlacedLocation:function(){this.v3LastPlacedLocation=void 0},placeBuilding:function(a,b,c,d){if(this.isBuilding()){var f=this.getMoveFromEntity(),a=this.gameManager.placeOnGround(a,0.5,f);this.throwHeldObjectToDestinationAndBuild(a,this.heldObjectName,c,d);if(b){if(this.payCost(),!this.canAffordToPlaceBuilding()||!this.areBuildingPrerequisitesMet(this.heldObjectName))return this.clearInHand(),!1}else if(this.setHeldItemQuantity(this.getHeldItemQuantity()-
1),0>=this.getHeldItemQuantity())return this.clearInHand(),!1;return!0}},sendBuildingInitiatedMetric:function(a){this.globals.metricsManager.sendGameMetric("buildingInitiated_"+a)},areBuildingPrerequisitesMet:function(a){var b=this.gameManager,c,d,f=!1,e=this.spBuildingParentEntity?this.spBuildingParentEntity.get():void 0;if(b&&(c=b.getEntityFactory()))(d=c.getECArchetype(a,"ECBuilding"))?(a=d.prerequisites,c=d.buildingType,d=d.scaffoldType,(b=b.getBuildingManager())&&(f=b.canCreateBuilding(c,e,a,
!1,d))):f=!0;return f},getNumberThatCanBePlaced:function(a){var b=this.gameManager,c,d=this.spBuildingParentEntity?this.spBuildingParentEntity.get():void 0;if(b&&(c=b.getEntityFactory()))if(a=c.getECArchetype(a,"ECBuilding"))if(a=a.buildingType,b=b.getBuildingManager())return b.getRemainingBuildingsBeforeCap(a,d);return 0},payCost:function(){var a,b=this.getBuildingResourceCost(this.heldObjectName),c=this.getBuildingSecondaryResourceCost(this.heldObjectName),d=this.getBuildingSoftCurrencyCost(this.heldObjectName);
if(void 0!==b||void 0!==c||void 0!==d)if(a=this.getEntityEC("ECPlayerData"))a.adjustResource(E.LUMBER,-b),a.adjustResource(E.STONE,-c),a.adjustSoftCurrency(-d)},refundCost:function(){var a,b=this.getBuildingResourceCost(this.heldObjectName),c=this.getBuildingSecondaryResourceCost(this.heldObjectName),d=this.getBuildingSoftCurrencyCost(this.heldObjectName);this.gameManager.getAmberCrown()&&(d*=0.5);if(a=this.getEntityEC("ECPlayerData"))a.adjustResource(E.LUMBER,b),a.adjustResource(E.STONE,c),a.adjustSoftCurrency(d)},
createAndStoreHeldEntity:function(a,b,c){var d=this.gameManager.getEntityFactory(),b=this.globals.mathDevice;if(d.archetypes[a].ECMesh){a=Gc.toolboxMesh;d=Math.min(1,2);this.heldEntity=this.entity.createHeldEntity(a,b.v3Build(0,0.4,0.6),0.75/d,"CarriedBuilding");var f=this.heldEntity.getEC("ECMesh");f&&(c?(f.setScale(0),G.Create({scale:0}).to({scale:1},0.25).easing(G.Easing.Elastic.Out).onUpdate(function(){f.setScale(this.scale)}).start()):f.setScale(0.25))}},update:function(){this._super();var a=
this.gameManager,b=a.getEntityFactory(),a=a.getIMGui(),c=this.shouldPayWhenPlacingBuildings;if(this.isBuilding()&&(!("a_b_amberwell"===this.heldObjectName||"a_b_amberchest"===this.heldObjectName)||this.getMoveFromEntity())&&(!b.getECArchetype(this.heldObjectName,"ECGameCritical")||this.getMoveFromEntity())&&!this.cannotCancel)if(b=b.getECArchetype(this.heldObjectName,"ECBuilding"))if(b=this.getMoveFromEntity()?"Cancel Move":this.infinitePlacement?this.globals.currentLanguage.GAME_HUD_FINISH_BUILDING:
this.globals.currentLanguage.GAME_HUD_CANCEL_BUILDING,a.doButton({id:"ecPlayerBuilder Cancel",text:b,v2ScreenLocation:a.getv2ScreenBarLocation(),buttonType:aa.BUTTON_WIDE,guiArchetype:"buttonWide"})||c&&!this.areBuildingPrerequisitesMet(this.heldObjectName)){!this.getMoveFromEntity()&&!c&&this.refundCost();this.playSound("buildingCancel");if(a=this.getEntityEC("ECWildlingLeader"))a.onCancelBuilding(this.getHeldObjectScaffoldType());this.clearInHand()}},draw:function(){this.drawHeldItemQuantity()},
drawPlacementInfo:function(a,b){b&&this.drawMoveAndPlaceSpot(a);this.mustPlaceNearCreator()&&this.drawCreatorPlacementRadius(this.heldEntityIsTrap,this.heldEntityBuildingType);this.drawAllPlacementRadius(this.heldEntityIsTrap,this.heldEntityBuildingType,!this.mustPlaceNearCreator(),!0)},drawBuildingGuidelines:function(a){var b=this.getv3HeldObjectExtents(),c;this.isBuilding()&&b&&(a=this.getv3BuildLocation(a),c=(c=this.canBuildAtPosition(a))?this.getv4ValidBuildPositionTextureColor():this.getv4InvalidBuildPositionTextureColor(),
this.drawGuidelinesAtPosition(a,b[0],b[2],c))},isOnSameBuildSpot:function(a,b){var c=this.getv3BuildLocation(a),d=this.getv3BuildLocation(b);return 0.1>=this.globals.mathDevice.v3Distance2DSq(c,d)},isValidToBuildOnMoveAndPlaceSpot:function(a){a=this.getv3BuildLocation(a);if(!a)return!1;a=this.globals.mathDevice.v3Distance2D(this.getv3Location(),a);return a<this.getRequiredCloseness()-a||a>this.getMaxRequiredCloseness()+0?!1:!0},drawMoveAndPlaceSpot:function(a){var b=this.getv3HeldObjectExtents(),
c=this.getv3BuildLocation(a),d=!1;this.canBuildAtPosition(c)?this.isValidToBuildOnMoveAndPlaceSpot(a)?this.drawGuidelinesAtPosition(c,b[0],b[2],k.buildingConfirm):this.drawGuidelinesAtPosition(c,b[0],b[2],k.buildingNormal):this.drawGuidelinesAtPosition(c,b[0],b[2],k.buildingCantPlace);d=!0;this.drawLinePlacementGuidelines(c);d&&this.drawHeldItemWeaponRange(c)},drawLinePlacementGuidelines:function(a){if(!this.v3LastPlacedLocation||!this.shouldUseLinePlacement())return!0;var b=this.getv3HeldObjectExtents(),
c=this.canBuildOnEntities();if(a=this.getLinePlacementLocations(a,this.v3LastPlacedLocation,b)){var d=a.length,f;for(f=0;f<d;f+=1)this.canBuildAtPositionInternal(a[f],b,c,!1,this.heldEntityBuildingType)?this.drawGuidelinesAtPosition(a[f],b[0],b[2],k.buildingNormal):this.drawGuidelinesAtPosition(a[f],b[0],b[2],k.buildingCantPlace);return!0}},drawGuidelinesAtPosition:function(a,b,c,d){var f=this.globals,e=this.gameManager,h=f.mathDevice,f=f.simpleSpriteRenderer,d=h.v4Copy(d),i=d[3],j=this.getBuildingGuidelineTexture(),
k=this.getMoveFromEntity();f&&(j&&e&&h&&a&&0<=b&&0<=c)&&(a=h.v3Copy(a),a=e.placeOnGround(a,0.1,k),e=h.v3Build(0,1,0),h={v3Location:a,sizeX:0.5*b,sizeY:0.5*c,v4color:d,texture:j,out:e,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z},d[3]=0.5*i,f.addSprite(h),h={v3Location:a,sizeX:0.5*(b-this.heldObjectFootplateBuffer),sizeY:0.5*(c-this.heldObjectFootplateBuffer),v4color:d,texture:j,out:e,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z},d[3]=i,f.addSprite(h))},getBuildingGuidelineTexture:function(){return this.buildingGuidelineTexture},
getv4ValidBuildPositionTextureColor:function(){return this.v4ValidBuildPositionTextureColor},getv4InvalidBuildPositionTextureColor:function(){return this.v4InvalidBuildPositionTextureColor},getCreatorEntity:function(){return this.spBuildingParentEntity?this.spBuildingParentEntity.get():void 0},drawCreatorPlacementRadius:function(a,b){var c=this.getCreatorEntity();c&&!c.toBeDestroyed&&(c=c.getEC("ECBuildingPlacementRadius"))&&c.drawPlacementRadius(a,b)},drawAllPlacementRadius:function(a,b,c,d){var f=
this.gameManager.getEntitiesWithEC("ECBuildingPlacementRadius"),e=f.length,h,i;for(h=0;h<e;h+=1)i=f[h],i=i.getEC("ECBuildingPlacementRadius"),i.drawPlacementRadiusIfRelevant(a,b,c,d)},drawHeldItemQuantity:function(){var a=this.getHeldItemQuantity();1<a&&this.entity.drawWorldText(""+a,0)},drawHeldItemWeaponRange:function(a){var b=this.heldEntityWeaponRange,c=this.heldEntityWeaponMinRange,d,f=this.getMoveFromEntity();0<b&&(d=this.getEntityEC("ECFirearm"))&&d.drawWeaponRadius(this.gameManager.placeOnGround(a,
0.5,f),c,b)},drawDebug:function(){},onToBeDestroyed:function(){this._super()},serialize:function(a){this._super(a)},serializeDelta:function(){}});Gc.toolboxMesh="environment/models/e_b_toolbox.dae";Gc.preload=function(a){var a=a.simpleSceneLoader,b=Gc.toolboxMesh;if(!a.isLoadingMesh(b)){var c=Sa.create({name:"temp",dynamic:!1,disabled:!0});a.load(b,void 0,void 0,c)}};Gc.create=function(a,b){return new Gc(a,b)};F.prototype.eCCreationMap[Gc.prototype.entityComponentName]=Gc;var Oh=F.extend({entityComponentName:"ECResourceCarrier",
updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{maxResource:[100,100],resourcesPerBlock:[10,10],maxUnemcumberedResource:50,fractionLostPerHit:0.5,fractionDroppedPerHit:0.1,resourcePerInteract:[10,10]},init:function(a,b){this._super(a,b);this.resource=[0,0];this.inboundResource=[0,0];this.numFlyingResourceBlocks=0;this.flyingTweens=[];this.heldResourceEntityList=[[],[]];this.maxResource=this.archetype.maxResource;
this.resourcesPerBlock=this.archetype.resourcesPerBlock;this.maxUnemcumberedResource=this.archetype.maxUnemcumberedResource;this.encumberedSpeedFactor=1;this.addedBlocksPerChop=this.addedMaxBlocks=0},activate:function(){this._super()},adjustMaxBlocks:function(a){this.addedMaxBlocks=a},getAddedBlocksPerChop:function(){return this.addedBlocksPerChop},setAddedBlocksPerChop:function(a){this.addedBlocksPerChop=a},adjustResource:function(a,b){0<b&&this.playSound(Za[a].pickupSound);this.resource[a]+=b;this.resource[a]=
this.globals.mathDevice.clamp(this.resource[a],0,this.getResourceCap(a));this.setToUpdate(0<this.resource[0]||0<this.resource[1]);this.adjustResourceEntities(a)},getResource:function(a){return this.resource[a]},getInboundResource:function(a){return this.inboundResource[a]},hasAnyInboundResource:function(){var a,b=E.NUM_RESOURCES,c=!1;for(a=0;a<b;a+=1)if(0<this.inboundResource[a]){c=!0;break}return c},hasAnyFlyingResource:function(){var a=!1;0<this.numFlyingResourceBlocks&&(a=!0);return a},getResourceCap:function(a){return this.maxResource[a]+
this.addedMaxBlocks*this.resourcesPerBlock[a]},getEncumbered:function(){return this.resource[0]+this.resource[1]>this.maxUnemcumberedResource},getEncumberedSpeedFactor:function(){return this.encumberedSpeedFactor},setEncumberedSpeedFactor:function(a){this.encumberedSpeedFactor=a},getSpeedMod:function(){var a=this.globals.mathDevice,b;b=1;this.getEncumbered()&&(b=this.getEncumberedSpeedFactor(),b=a.remap(1,2,0.75,1,b));return b},getResourcePerInteract:function(a){return this.archetype.resourcePerInteract[a]},
simulateResourceGathering:function(a){var b,c;for(b=0;b<E.NUM_RESOURCES;b+=1)(c=this.resource[b])&&(this.resource[b]=a)},flyToResourceDepot:function(a){var b=this.globals.metricsManager;if(this.resource[0]||this.resource[1]){var c=a.getEC("ECResourceDestination");if(this.resource[0]&&c.canDepositResource(0)||this.resource[1]&&c.canDepositResource(1)){if(ea.useSimulatedResourceGathering){var d=this.getEntityEC("ECWildlingAgent");d&&d.simulateResourceGathering()}var f=this.entity,e=this.globals.mathDevice,
d=function(a,b,d,h,i,j){var l=a.getEC("ECAttach"),k=a.getEC("ECMesh"),n=e.v3Copy(b.getv3Location()),r=e.v3Neg(k.getBaseLocalOffset()),t=0.1*Math.random()-0.2,w=0.1*Math.random()-0.2;j.numFlyingResourceBlocks+=1;j.flyingTweens.push(G.Create({lerp:0}).to({lerp:1},0.75).easing(G.Easing.Linear.None).onFirstUpdate(function(){this.v3StartLocation=e.v3Copy(a.getv3Location());l.clearParent();l.clearTransform();a.removeECFromCustomEntity("ECAttach");f.playSound(Za[d].depositStartSound)}).onUpdate(function(){var b=
5*Math.sin(Math.PI*this.lerp);a.setv3Location(e.v3Add(e.v3Lerp(this.v3StartLocation,n,this.lerp),e.v3Build(0,b,0)));k.addRotationX(t);k.addRotationY(w);k.setLocalOffset(e.v3Lerp(e.v3BuildZero(),r,e.saturate(3*this.lerp)))}).onComplete(function(){0!==h&&c.depositResource(f,d,h);a.setToBeDestroyed();b.playSound(Za[d].depositEndSound);j.numFlyingResourceBlocks-=1;var e=j.flyingTweens.indexOf(this);0<=e&&j.flyingTweens.splice(e,1)}).delay(i).start())},h=0,i,j=!1;this.getEntityEC("ECHero")?b.sendGameMetric("resourceDeposited_hero",
this.resource):b.sendGameMetric("resourceDeposited_wildling",this.resource);for(b=0;b<E.NUM_RESOURCES;b+=1){var k=this.heldResourceEntityList[b],l=k.length;i=this.resource[b];if(c.canDepositResource(b)&&i){for(j=l-1;0<=j;j-=1)d(k[j],a,b,0<j?0:i,h,this),h+=e.lerp(0.05,0.125,Math.random());k.length=0;this.adjustResource(b,-i);j=!0}}for(b=0;b<E.NUM_RESOURCES;b+=1)i=this.resource[b],j&&i&&(this.adjustResource(b,-i),this.adjustResource(b,i))}}},update:function(){this._super();var a=this.getv3Location(),
b=this,c=function(c){c.getEC("ECResourceDestination")&&4>c.getDistanceUsingSize(a)&&b.flyToResourceDepot(c)},d=this.gameManager;d&&d.applyToEntitiesInGridCellsWithinRadius(this.getv3Location(),2,c)},onTakeDamage:function(){for(var a=this.archetype.fractionLostPerHit,b=this.archetype.fractionDroppedPerHit,c=0;c<E.NUM_RESOURCES;c+=1){var d=Math.ceil(this.resource[c]*a),f=Math.ceil(this.resource[c]*b);this.adjustResource(c,-d);this.dropResource(c,f)}},dropResource:function(a,b){if(!(1>b)){var c=Za[a].entityArchetype,
d=this.gameManager.getEntityFactory(),f=d.getECArchetype(c,"ECPickup");if(f)for(var e=b/f.carriedResource[a],h=this.getv3Location(),i=this.entity.getGameSpace(),j,f=0;f<e;f+=1)j=d.createActiveEntityInstance("dropped"+c,c,h),j.setGameSpace(i)}},draw:function(){},drawDebug:function(){var a=this.globals,b=a.mathDevice,c=a.simpleFontRenderer,d=a.camera.worldToScreen(b.v3Add(this.getv3Location(),b.v3Build(0,1.5,0))),a="Lumber : "+this.resource[E.LUMBER]+"/"+this.getResourceCap(E.LUMBER),b="Stone : "+this.resource[E.STONE]+
"/"+this.getResourceCap(E.STONE),f=[1,1,1];void 0!==d&&(d={x:d[0],y:d[1]+5,pointSize:16,alignment:1,r:f[0],g:f[1],b:f[2]},c.drawFontDouble(a,d),d.y+=16,c.drawFontDouble(b,d))},isFull:function(a){return this.resource[a]+this.inboundResource[a]>=this.getResourceCap(a)},getEmptySpace:function(a){return this.getResourceCap(a)-(this.resource[a]+this.inboundResource[a])},adjustInbound:function(a,b){this.inboundResource[a]+=b},buildOffset:function(a,b){var c=this.globals.mathDevice.v3Build(0,0.5,-0.35),
d=Math.floor(a),f=Math.floor(d/5),e=d%5,d=e%3,e=Math.floor(e/3);c[0]=2===d?c[0]-b:c[0]+d*b;1===e&&(c[0]-=0.5*b);c[1]+=f*b;c[2]-=e*b;return c},adjustResourceEntities:function(a){var b=this.heldResourceEntityList[a].length,c=Math.floor(this.resource[a]/this.archetype.resourcesPerBlock[a]),d=b+this.heldResourceEntityList[1-a].length;if(b>c){d=Math.min(b-c,b);for(c=1;c<=d;c+=1)this.removeResourceEntity(a,b-c)}else{b=Math.max(c-b,0);for(c=0;c<b;c+=1)this.createAndStoreCarriedResourceEntity(a,Za[a].pickupMesh,
d+c)}},createCarriedResourceEntity:function(a,b,c,d){var f,d=this.buildOffset(d,0.3);d[1]+=0.3*c;a=this.entity.createHeldEntity(a,d,b,"Carried Resource");if(f=a.getEC("ECMesh"))f.setScale(0),G.Create({scale:0}).to({scale:1},0.5).easing(G.Easing.Elastic.Out).onUpdate(function(){f.setScale(this.scale)}).start();return a},createAndStoreCarriedResourceEntity:function(a,b,c){this.heldResourceEntityList[a].push(this.createCarriedResourceEntity(b,0.3,0,c))},removeResourceEntity:function(a,b){this.heldResourceEntityList[a][b]&&
(this.heldResourceEntityList[a][b].setToBeDestroyed(),this.heldResourceEntityList[a].splice(b,1))},generateAndDepositResource:function(a,b){var c=this.gameManager.getFactionManager(),d;if(0<b&&(void 0!==a&&c)&&(c=c.getNearestFriendlyResourceDestination(this.entity,a)))this.flyToResourceDepot(c),this.maxResource[a]+=b,d=this.resourcesPerBlock[a],0<d&&(b<d?this.resourcesPerBlock[a]=b:20<b/d&&(this.resourcesPerBlock[a]=Math.ceil(b/20)),this.adjustResource(a,b),this.flyToResourceDepot(c),this.resourcesPerBlock[a]=
d,this.maxResource[a]-=b)},serialize:function(a){this._super(a);a.maxResource=this.maxResource;a.maxUnemcumberedResource=this.maxUnemcumberedResource},serializeDelta:function(){},onToBeDestroyed:function(){if(this.hasAnyFlyingResource()){var a=this.flyingTweens,b;for(b=a.length-1;0<=b;b-=1)a[b].complete()}this._super()},destroy:function(){this._super()}});Oh.create=function(a,b){return new Oh(a,b)};F.prototype.eCCreationMap[Oh.prototype.entityComponentName]=Oh;var Ph=F.extend({entityComponentName:"ECResourceDestination",
updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{canDepositResource:[!0,!0],validType:"selectTypeAlways"},init:function(a,b){this._super(a,b);this.resourceDepositingEnabled=!0},activate:function(){this._super()},arePlayFlagsValid:function(){var a=this.gameManager.getPlayFlags();return a?a.validSelectTypes[this.archetype.validType]:!0},canDepositResource:function(a){return this.archetype.canDepositResource[a]&&
this.isResourceDepositingEnabled()&&this.arePlayFlagsValid()},enableResourceDespositing:function(){this.resourceDepositingEnabled=!0},disableResourceDespositing:function(){this.resourceDepositingEnabled=!1},isResourceDepositingEnabled:function(){return this.resourceDepositingEnabled},depositResource:function(a,b,c){var d=this.gameManager,f=d.getFactionManager(),d=d.getHero(),e=d.getEC("ECPlayerData");if(c&&a){var h=this.gameManager.getGuiManager();if(a===d||f.areFriendly(a,d))h.addResourceBubble(this.getv3Location(),
c,b),e.adjustResource(b,c),this.globals.gameManager.eventManager.notify("ResourceDeposited",{entity:a,type:b,amount:c})}},update:function(){this._super()},draw:function(){},drawDebug:function(){},serialize:function(a){this._super(a)},serializeDelta:function(){},destroy:function(){this._super()}});Ph.create=function(a,b){return new Ph(a,b)};F.prototype.eCCreationMap[Ph.prototype.entityComponentName]=Ph;var Qh=F.extend({entityComponentName:"ECResourceGenerator",updatePeriod:5,sortPriority:4,shouldUpdate:!0,
shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{resourceType:E.LUMBER,resourcePerResourceGenerate:1,secondsPerResourceGenerate:10,offlineResourceGenerationPerMinute:1,convertCost:10,convertReturn:1E3},init:function(a,b){this._super(a,b);this.updateTimer=0;this.resourceGenerationEnabled=!0},getConvertCost:function(){return this.archetype.convertCost},getConvertReturn:function(){return this.archetype.convertReturn},getResourceType:function(){return this.archetype.resourceType},
convert:function(a){var b=this.archetype.resourceType;if((a=a.getEC("ECPlayerData"))&&a.getSoftCurrency()>=this.getConvertCost()&&a.getResource(b)<a.getResourceCap(b))a.adjustSoftCurrency(-this.getConvertCost()),this.giveResource(b,this.getConvertReturn())},canConvert:function(a){return(a=a.getEC("ECPlayerData"))&&a.getSoftCurrency()>=this.getConvertCost()},updateOffline:function(){var a,b=this.gameManager.getPureAdditionalTimeFromSave();0>=b||(b=Math.floor(b/60),0<b&&(a=this.archetype.resourceType,
a=Za[a].offlineResourceGenerationScale,this.giveResource(this.archetype.resourceType,b*this.archetype.offlineResourceGenerationPerMinute*a)))},giveResource:function(a,b){var c=this.gameManager.getHero().getEC("ECPlayerData"),b=Math.floor(b);c&&c.adjustResource(a,b)},enableResourceGeneration:function(){this.resourceGenerationEnabled=!0},disableResourceGeneration:function(){this.resourceGenerationEnabled=!1},isResourceGenerationEnabled:function(){return this.resourceGenerationEnabled},update:function(){this._super();
if(this.isResourceGenerationEnabled()){var a=this.gameManager.getPlayFlags();this.updateOffline();if(a.canGenerateResources){var b=this.getTimeSinceLastUpdate(),a=this.archetype;this.updateTimer+=b;b=0;this.updateTimer>a.secondsPerResourceGenerate&&(b=Math.floor(this.updateTimer/a.secondsPerResourceGenerate),this.updateTimer-=b*a.secondsPerResourceGenerate,this.giveResource(this.archetype.resourceType,b*a.resourcePerResourceGenerate))}}},doRadialMenuButton:function(a,b,c){var d=this.gameManager,f=
this.globals,e=Za[this.archetype.resourceType];this.canConvert(b)?a.doButton({id:"ecRadialMenu"+this.entity.getName()+"Craft",text1:"Go to\nResource Shop",v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:e.convertGUI})&&(a=Wa.create(d,f),d.setGameState(a),a.setButtonPanal("resource")):a.doButton({id:"ecRadialMenu"+this.entity.getName()+"Craft Unavailable",text1:"Go to\nResource Shop",v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:e.convertInvalidGUUI})},draw:function(){},drawDebug:function(){},
serialize:function(a){this._super(a)},serializeDelta:function(){},destroy:function(){this._super()}});Qh.create=function(a,b){return new Qh(a,b)};F.prototype.eCCreationMap[Qh.prototype.entityComponentName]=Qh;var Rh=F.extend({entityComponentName:"ECResourceStorage",updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{maxResource:[500,500],maxResourceToLose:[500,500]},MAX_ALLOWED_RESOURCE_JETTISON_AMOUNT:100,JETTISON_THRESHOLD_FRACTION:0.2,
JETTISON_FRACTION:0.2,maxResourceStoragePossible:[2E6,2E6],init:function(a,b){this._super(a,b);this.amountLostTracker=[];this.resourceAmountJettisonedTracker=[];var c;for(c=0;c<E.NUM_RESOURCES;c+=1)this.amountLostTracker[c]=0,this.resourceAmountJettisonedTracker[c]=0},activate:function(){this._super();this.adjustResourceCap(E.LUMBER,this.getMaxResource(E.LUMBER));this.adjustResourceCap(E.STONE,this.getMaxResource(E.STONE))},getTemporaryResourceCaps:function(){return[this.getMaxResource(0),this.getMaxResource(1)]},
getMaxResource:function(a){return this.archetype.maxResource[a]},getMaxResourceToLose:function(a){return this.archetype.maxResourceToLose[a]},adjustResourceCap:function(a,b){this.gameManager.playerData.adjustResourceCap(a,b)},onTakeDamage:function(a){var b=this.getEntityEC("ECHealth"),c=1;b&&(c=b.getMaxHealth());a/=c;for(b=0;b<E.NUM_RESOURCES;b+=1)c=this.getMaxResourceToLose(b)*a,this.loseResource(b,c),c*=this.JETTISON_FRACTION,this.jettisonResource(b,c)},loseResource:function(a,b){var c=b+this.amountLostTracker[a];
if(1>c)this.amountLostTracker[a]+=b;else{this.amountLostTracker[a]=0;var c=Math.floor(c),d=this.gameManager.getHero();d&&!d.toBeDestroyed&&(d=d.getEC("ECPlayerData"),c=Math.min(d.getResource(a),c),d.adjustResource(a,-c),d=this.gameManager.getGuiManager(),d.addResourceBubble(this.getv3Location(),-c,a),d=this.gameManager.eventManager,d.notify("ResourceLost",{entity:this.entity,type:a,amount:c}))}},jettisonResource:function(a,b){if(b){var b=b+this.resourceAmountJettisonedTracker[a],c=this.getMaxResource(a)*
this.JETTISON_FRACTION;if(b/c<this.JETTISON_THRESHOLD_FRACTION)this.resourceAmountJettisonedTracker[a]=b;else{this.resourceAmountJettisonedTracker[a]=0;var d=Math.min(b,this.MAX_ALLOWED_RESOURCE_JETTISON_AMOUNT),d=Math.floor(d),c=this.gameManager.getEntityFactory(),f=Za[a].entityArchetype,e=c.getECArchetype(f,"ECPickup");if(e){var d=d/e.carriedResource[a],d=Math.floor(d),e=this.getv3Location(),h=this.entity.getGameSpace(),i,j;for(i=0;i<d;i+=1)j=c.createActiveEntityInstance("stolen"+f,f,e),j.setGameSpace(h)}}}},
update:function(){this._super()},draw:function(){},drawDebug:function(){},serialize:function(a){this._super(a)},serializeDelta:function(){},onKilled:function(){},removeResourceCap:function(){if(!this.removedResourceCap){for(var a=0;a<E.NUM_RESOURCES;a+=1)this.adjustResourceCap(a,-this.getMaxResource(a));this.removedResourceCap=!0}},onToBeDestroyed:function(){this._super();this.removeResourceCap()},destroy:function(){this._super()}});Rh.create=function(a,b){return new Rh(a,b)};F.prototype.eCCreationMap[Rh.prototype.entityComponentName]=
Rh;var Hc=F.extend({entityComponentName:"ECSelectable",updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!0,storeGlobalList:!0,parameters:{radiusFactor:{description:"The radius factor for the target",type:"slider",defaultValue:0.9,minValue:0,maxValue:2.5},smart:!0,smartRadiusFactor:1,selectType:"selectTypeNormal",hideMeshWhenInvalid:!1},setRadiusFactor:function(a){this.radiusFactor=a},init:function(a,b){this._super(a,b);this.hotByFullyChargedShot=
this.hot=!1;this.hotTime=0;this.unHotTime=-100;this.smartValidTime=0;this.unSmartValidTime=-100;this.valid=this.safeCopy(b.valid,!0);this.randomRotation=2*Math.random()*Math.PI;this.permanentValid=!0;this.radiusFactor=this.archetype.radiusFactor},getSelectType:function(){return this.archetype.selectType},getRadiusFactor:function(){return this.radiusFactor},setValid:function(a){this.valid!==a&&this.archetype.hideMeshWhenInvalid&&(a?(this.entity.showMesh(),this.entity.showSprite()):(this.entity.hideMesh(),
this.entity.hideSprite()));this.valid=a},getValid:function(){return this.valid},setPermanentValid:function(a){this.permanentValid!==a&&(this.permanentValid=a,this.refreshValidity())},refreshValidity:function(){var a=this.gameManager.getPlayFlags();this.setValid(a.validSelectTypes[this.getSelectType()]&&this.permanentValid)},isSelectable:function(){return this.isSmart()&&!this.isSmartValid()?!1:this.entity.toBeDestroyed||this.entity.isDead()?!1:this.valid},getSmartRadiusFactor:function(){return this.archetype.smartRadiusFactor},
isSmart:function(){return this.archetype.smart},isSmartValid:function(){return this.smartValid},getsmartValidTime:function(){return this.globals.gameCurrentTime-this.smartValidTime},getunSmartValidTime:function(){return this.globals.gameCurrentTime-this.unSmartValidTime},setSmartValid:function(a){var b;this.smartValid!==a&&((this.smartValid=a)?this.smartValidTime=this.globals.gameCurrentTime:this.unSmartValidTime=this.globals.gameCurrentTime,(b=this.getEntityEC("ECRadialMenu"))&&b.setSmartValid(a))},
getSmartValidFactor:function(){var a=this.globals.mathDevice;return this.smartValid?a.saturate(16*this.getsmartValidTime()):a.saturate(1-8*this.getunSmartValidTime())},addTriggerer:function(a){var b,c;b=this.triggererList;b||(b=this.triggererList=[]);0>b.indexOf(a)&&(0===b.length&&(this.activateSelectable(),this.setSmartValid(!0)),b.push(a));var d=a.getEC("ECSmartSelectableTrigger");if(b=this.getEntityEC("ECSockets"))c=function(b){var c;b&&(c=b.getEC("ECSelectable"))&&d.isValidToTrigger(b)&&c.addTriggerer(a)},
b.applyToSocketedEntities(c)},hasParentSmartSelectable:function(){var a=this.getEntityEC("ECAttach");if(a&&(a=a.getParent()))if(a=a.getEC("ECSelectable"))return a.isSmart();return!1},validateTriggerers:function(){var a=this.triggererList;if(a){var b,c,d;for(b=a.length-1;0<=b;b-=1)d=!1,c=a[b],c.shouldBeDestroyed()&&(d=!0),d||(c=a[b].getEC("ECSmartSelectableTrigger"))&&(c.isValidToTrigger(this.entity)||(d=!0)),d&&a.splice(b,1);0===a.length&&(this.setSmartValid(!1),this.setActivated(!1))}},activateSelectable:function(){this.setToUpdate(!0);
this.setToDraw(!0)},deactivateSelectable:function(){this.setToUpdate(!1);this.setToDraw(!1)},update:function(){this._super();!this.isSmartValid()&&0>=this.getSmartValidFactor()&&!this.isHot()&&0>=this.getHotFactor()?this.deactivateSelectable():this.isSmartValid()&&this.validateTriggerers()},isActivated:function(){return this.activated},getActivatedTime:function(){return this.globals.gameCurrentTime-this.activatedTime},getUnactivatedTime:function(){return this.globals.gameCurrentTime-this.unActivatedTime},
setActivated:function(a){var b;this.activated!==a&&((this.activated=a)?this.activatedTime=this.globals.gameCurrentTime:this.unActivatedTime=this.globals.gameCurrentTime,(b=this.getEntityEC("ECRadialMenu"))&&b.setActivated(a),(b=this.getEntityEC("ECWorldText"))&&b.setActivated(a),(b=this.getEntityEC("ECWorldGui"))&&b.setActivated(a))},getActivatedFactor:function(){var a=this.globals.mathDevice;return this.activated?a.saturate(16*this.getActivatedTime()):a.saturate(1-8*this.getUnactivatedTime())},isHot:function(){return this.hot},
getHotTime:function(){return this.globals.gameCurrentTime-this.hotTime},getUnhotTime:function(){return this.globals.gameCurrentTime-this.unHotTime},setHot:function(a){var b;this.hot!==a&&((this.hot=a)?(this.hotTime=this.globals.gameCurrentTime,this.activateSelectable()):(this.unHotTime=this.globals.gameCurrentTime,this.hotByFullyChargedShot=!1),(b=this.getEntityEC("ECRadialMenu"))&&b.setHot(a),(b=this.getEntityEC("ECWorldText"))&&b.setHot(a),(b=this.getEntityEC("ECWorldGui"))&&b.setHot(a))},setSelectedByFullyChargedShot:function(a){a&&
this.setHot(!0);this.hotByFullyChargedShot=a},isHotByFullyChargedShot:function(){return this.hotByFullyChargedShot},getHotFactor:function(){var a=this.globals.mathDevice;return this.hot?a.saturate(16*this.getHotTime()):a.saturate(1-8*this.getUnhotTime())},draw:function(){var a=this.globals,b=a.simpleSpriteRenderer,a=a.camera,c=this.gameManager.getGameController(),d=c.selectionRadius,f=c.addedSelectionRadius,c=0;this.isHotByFullyChargedShot()?c=0:this.isSmart()?(c=this.getSmartValidFactor()*d,c+=this.getHotFactor()*
f):c=this.getHotFactor()*(d+f);f=this.globals.guiRenderer;c*=this.getRadiusFactor();0<c&&(d=this.entity.getCentreLocation(),a=a.screenRadiusToWorldRadius(d,c*f.getScaleFactor()),b.addSprite({v3Location:this.entity.getCentreLocation(),size:a,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:Hc.bigCircleButton,v4color:k.outlineSoft,angle:this.randomRotation}))},destroy:function(){this._super();this.setActivated(!1);this.setHot(!1)}});Hc.bigCircleButton="textures/bigcirclebutton.dds";Hc.preload=
function(a){a.textureManager.load(Hc.bigCircleButton)};F.prototype.eCCreationMap[Hc.prototype.entityComponentName]=Hc;Hc.create=function(a,b){return new Hc(a,b)};var Sh=F.extend({entityComponentName:"ECSmartSelectableTrigger",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{worldRadius:5.5},init:function(a,b){this._super(a,b)},update:function(){this._super();var a=this.globals.mathDevice,b=this.getv3Location(),
c=this.archetype.worldRadius,d=this.entity,f=this.getEntityEC("ECPlayerBuilder");if(!f||!f.isBuilding()){var f=function(f){var e=f.getEC("ECSelectable");if(e&&e.isSmart()&&e.getValid()){var g=f.getEC("ECAttach");if(g&&(g=g.getParent())&&!g.toBeDestroyed&&g.hasEC("ECSelectable")&&g.hasEC("ECSockets"))return;f=f.getv3Location();g=c*e.getSmartRadiusFactor();a.v3Distance2DSq(f,b)<g*g&&b[1]-0.5<=f[1]&&e.addTriggerer(d)}},e=this.gameManager;e&&e.applyToEntitiesInGridCellsWithinRadius(b,c,f)}},isValidToTrigger:function(a){var b,
c,d;if((b=this.getEntityEC("ECPlayerBuilder"))&&b.isBuilding())return!1;d=a.getEC("ECSelectable");if(!d||!d.isSmart()||!d.getValid())return!1;if(b=a.getEC("ECAttach"))if((b=b.getParent())&&b.hasEC("ECSelectable")&&b.hasEC("ECSockets"))return this.isValidToTrigger(b);b=this.globals.mathDevice;c=this.getv3Location();d=this.archetype.worldRadius*d.getSmartRadiusFactor()+1;d*=d;a=a.getv3Location();return b.v3Distance2DSq(a,c)<d&&c[1]-0.5<=a[1]?!0:!1},draw:function(){},drawDebug:function(){},serialize:function(a){this._super(a)},
serializeDelta:function(){},destroy:function(){this._super()}});Sh.create=function(a,b){return new Sh(a,b)};F.prototype.eCCreationMap[Sh.prototype.entityComponentName]=Sh;var Nd=F.extend({entityComponentName:"ECSuper",sortPriority:4,updatePeriod:0,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!0,shouldSave:!1,realTime:!0,parameters:{scorePerSuper:{description:"Score required per super move",type:"slider",defaultValue:5,minValue:0,maxValue:20},chargePerCoin:{description:"Charge Factor for coin pickups",
type:"slider",defaultValue:1,minValue:0,maxValue:5},chargePerXP:{description:"Charge Factor for XP pickups",type:"slider",defaultValue:0,minValue:0,maxValue:5},chargeRate:{description:"Base Charge rate (per s)",type:"slider",defaultValue:0,minValue:0,maxValue:5},invunDuration:{description:"Invunerable time after super has finished",type:"slider",defaultValue:1,minValue:0,maxValue:5}},init:function(a,b){this._super(a,b);this.specialSelf=this.specialEnemy=this.specialFriend=this.targetEntity=null;b.specialFriend&&
(this.specialFriend=nb.createFromName(b.specialFriend.name,this.globals,b.specialFriend.params));b.specialEnemy&&(this.specialEnemy=nb.createFromName(b.specialEnemy.name,this.globals,b.specialEnemy.params));b.specialSelf&&(this.specialSelf=nb.createFromName(b.specialSelf.name,this.globals,b.specialSelf.params));this.scorePerSuper=this.safeCopy(b.scorePerSuper,5);this.scoreChangeTime=this.score=0},activate:function(){this._super();this.specialFriend&&this.specialFriend.attach(gameEntity);this.specialEnemy&&
this.specialEnemy.attach(gameEntity);this.specialSelf&&this.specialSelf.attach(gameEntity)},update:function(){var a=this.globals.gameCurrentTime,b=this.archetype;this._super();0!==b.chargeRate&&this.addScore(b.chargeRate*this.getTimeSinceLastUpdate(),!0);this.activeSpecial?(this.activeSpecial.update(),this.activeSpecial.isFinished()&&(this.specialEndTime=a,this.activeSpecial.end(),this.activeSpecial=void 0)):this.specialEndTime&&a-this.specialEndTime>b.invunDuration&&(this.specialEndTime=null,a=this.targetEntity,
this.targetEntity=null,a.toBeDestroyed||(a=a.getEC("ECHealth"))&&a.setActive(!0))},drawSuper:function(a,b){if(this.hasFinishedCharging()&&b){var c=this.getSpecialFromChargeType(b);c&&c.drawReady(a)}},drawSuperUI:function(a,b,c,d){var f=this.globals,e=f.mathDevice,h=f.simpleSpriteRenderer,i=this.getEntityEC("ECHero");if(i){var j=1*b,k=0,c=(void 0!==c?c:0)*b,l;d&&(l=e.m43At(f.camera.matrix),l[1]=0,e.v3Normalize(l,l));var m,q,k=-2*b;q=this.getScore()/this.getScorePerSuper();q=Math.max(q,0.3);d=i.r;f=
i.g;m=i.b;this.canSuper()?(i=i.getPulse(),j*=1.5):i=0;h.addSprite({v3Location:a,size:1*(j+i*b),offsetX:k,offsetY:c,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:"textures/you.dds",v4color:e.v4Build(d,f,m,q),out:l})}},charge:function(){!this.chargeStartTime&&this.canSuper()&&(this.chargeStartTime=this.globals.gameCurrentTime)},canSuper:function(){return this.score>=this.scorePerSuper},getChargeFactor:function(){return this.globals.mathDevice.remap(0.2,1,0,1,(this.globals.gameCurrentTime-this.chargeStartTime)/
this.chargeDuration)},release:function(){this.chargeStartTime=void 0},isCharging:function(){return!this.chargeStartTime?!1:!0},hasFinishedCharging:function(){return this.globals.gameCurrentTime-this.chargeStartTime>=this.chargeDuration},activateSuper:function(a,b,c){var d=this.getEntityEC("ECPlayerLife");if(d.state===d.states.NORMAL&&void 0!==b&&(b=this.getSpecialFromChargeType(b))){this.activeSpecial=b;if(b=a.getEC("ECHealth")){if(0>=b.getHealth())return;b.setActive(!1)}this.activeSpecial.begin(a,
c);this.score=0;this.targetEntity=a}},getSpecialFromChargeType:function(a){switch(a){case la.interactTypes.FRIEND:return this.specialFriend;case la.interactTypes.ENEMY:case la.interactTypes.ENEMY_MELEE:case la.interactTypes.ENEMY_RANGED:return this.specialEnemy;case la.interactTypes.SELF:return this.specialSelf}},getScorePerSuper:function(){return this.scorePerSuper},getScore:function(){return this.score},addScore:function(a,b){0!==a&&this.score<this.scorePerSuper&&(this.score+=a,this.score>=this.scorePerSuper&&
(this.score=this.scorePerSuper,this.onFullyCharged()),b||(this.scoreChangeTime=this.globals.appCurrentTime))},onFullyCharged:function(){var a=this.gameManager.actionManager,b=this.globals.mathDevice;this.entity.playSound("chargeUp");a.addAction("VisualEffect",{archetype:"chargeUp",v3Location:b.v3Copy(this.getv3Location())})},addPickupCoinScore:function(a){this.addScore(a*this.archetype.chargePerCoin)},addPickupXPScore:function(a){this.addScore(a*this.archetype.chargePerXP)},getTimeSinceScoreChange:function(){return this.globals.appCurrentTime-
this.scoreChangeTime},serialize:function(a){this._super(a);a.scorePerSuper=this.scorePerSuper;a.score=this.score},serializeDelta:function(a){a.scorePerSuper=this.scorePerSuper;a.score=this.score}});Nd.prototype.chargeDuration=0.75;Nd.create=function(a,b){return new Nd(a,b)};F.prototype.eCCreationMap[Nd.prototype.entityComponentName]=Nd;var Th=Ke.extend({entityComponentName:"ECSuperPhysicsCube",sortPriority:4,updatePeriod:0,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,
realTime:!0,parameters:{bounce:{description:"Bounciness",defaultValue:0.5,minValue:0,maxValue:2},contactVelocityX:0,contactVelocityZ:0,launchHeight:0,launchSpan:0,frictionOverride:void 0,stationary:!1,scaleY:1},init:function(a,b){this._super(a,b);this.calculateLaunchVelocities();this.canLaunch=!0},activate:function(){this._super();var a=function(a){this.adjustSphereParams(a)}.bind(this);this.worldCube.setECPhysSphereAdjustCallback(a);a=function(a){this.onImpact(a)}.bind(this);this.setOnImpactCallback(a);
this.calculateContactVelocity()},calculateContactVelocity:function(){var a=this.globals.mathDevice,b=this.archetype;this.contactVelocity=a.v3Build(b.contactVelocityX,0,b.contactVelocityZ);a.m43TransformVector(this.entity.getGameSpace().getM43FullTransform(),this.contactVelocity,this.contactVelocity)},calculateLaunchVelocities:function(){var a=this.archetype;if(!(0===a.launchSpan&&0===a.launchHeight)){var b=Math.sqrt(2*qa.prototype.gravity*(a.launchHeight+2));this.launchVelY=b;var c=qa.prototype.gravity,
b=(-b-Math.sqrt(b*b-2*-c*-a.launchHeight))/-c;this.launchVelH=a.launchSpan/b}},adjustSphereParams:function(a){var b=this.archetype;a.setBounce(b.bounce);a.setFrictionOverride(b.frictionOverride);a.setVelocity(this.contactVelocity)},onImpact:function(a){var b=this.globals;if(this.canLaunch){this.canLaunch=!1;this.setIgnoringCollision(!0);var c=b.mathDevice,d=this.getEntityEC("ECMesh"),f=this,b=G.Create({y:1}).to({y:0},1).easing(G.Easing.Elastic.Out).onUpdate(function(){d.setLocalOffset(c.v3Build(0,
this.y,0))}).onComplete(function(){f.canLaunch=!0});G.Create({y:0}).to({y:1},0.35).easing(G.Easing.Elastic.Out).onUpdate(function(){d.setLocalOffset(c.v3Build(0,this.y,0))}).onComplete(function(){f.setIgnoringCollision(!1)}).chain(b).start();if(a=a.getEC("ECPhysicsSphere"))b=c.v3Copy(a.getv3Velocity()),b=c.angleToV3(c.v3ToAngle(b)),c.v3ScalarMul(b,this.launchVelH,b),c.v3SetY(this.launchVelY,b),a.setVelocity(b),a.clearAcceleration(),a.softForce=!1}},update:function(){this._super()},draw:function(){},
drawDebug:function(){var a=this.globals.debugDraw;a.drawDebugAxis(this.entity.v3Location,3);var b=this.getEntityEC("ECMesh");b&&a.drawDebugMatrix(b.m43Transform)},serialize:function(a){this._super(a)},serializeDelta:function(){}});Th.create=function(a,b){return new Th(a,b)};F.prototype.eCCreationMap[Th.prototype.entityComponentName]=Th;var Uh=F.extend({entityComponentName:"ECTarget",sortPriority:4,updatePeriod:0,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,
realTime:!0,parameters:{onlyTargetedByFriendlyUnits:!1},init:function(a,b){this._super(a,b);this.targeted=!1;this.targetedTime=0;this.valid=this.safeCopy(b.valid,!0)},setValid:function(a){this.valid=a},isValidTarget:function(a,b){var c=this.getEntityEC("ECHealth");return c&&0>=c.getHealth()||!this.valid?!1:(c=this.getEntityEC("ECAttackerLimit"))&&c.isFull(a)||!b&&this.canOnlyBeTargetedByFriendlyUnits()?!1:!0},canOnlyBeTargetedByFriendlyUnits:function(){return this.archetype.onlyTargetedByFriendlyUnits},
update:function(){this._super()},setTargeted:function(a){this.targeted!==a&&(this.targeted=a,this.targetedTime=this.globals.gameCurrentTime)},getTargetedFactor:function(){var a=this.globals.mathDevice;return this.targeted?a.saturate(32*(this.globals.gameCurrentTime-this.targetedTime)):a.saturate(1-16*(this.globals.gameCurrentTime-this.targetedTime))},onDeath:function(){this.setValid(!1)},draw:function(){}});F.prototype.eCCreationMap[Uh.prototype.entityComponentName]=Uh;Uh.create=function(a,b){return new Uh(a,
b)};var Vh=F.extend({entityComponentName:"ECTrap",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!0,shouldSave:!1,realTime:!1,SPEED:4,init:function(a,b){this._super(a,b);var c=a.mathDevice;this.outputNetworkID=this.buildIDArray(b.roomID,b.groupID);this.appearBlock=this.safeCopy(b.appearBlock,!1);var d=this.v3SafeCopy(b.v3Direction,c.v3Build(0,1,0));this.distance=this.safeCopy(b.distance,10);this.v3Move=c.v3ScalarMul(d,this.distance);this.desiredAppear=
this.currentAppear=!this.appearBlock},activate:function(){this._super();var a=this.globals.mathDevice,b=this.getv3Location(),c=this.getEntityEC("ECMesh");this.initialv3Location=a.v3Copy(b);this.appearBlock&&(a.v3Add(b,a.v3ScalarMul(this.v3Move,-1),b),c&&c.setScale(0))},hasOutputNetworkID:function(a){return this.arrayContains(this.outputNetworkID,a)},update:function(){this._super();this.isManagedByThisMachine()&&this.catchAnim()},triggerOn:function(){this.appearBlock?this.appear():this.disappear()},
triggerOff:function(){this.appearBlock?this.disappear():this.appear()},triggerToggle:function(){this.toggle()},catchAnim:function(){this.desiredAppear!==this.desiredAppearPrev&&this.clearTween();void 0===this.tween&&this.desiredAppear!==this.currentAppear&&(this.desiredAppear?this.animateAppear():this.animateDisappear());this.desiredAppearPrev=this.desiredAppear},animateAppear:function(){var a=this.globals.mathDevice,b=this.getv3Location(),c=this.initialv3Location,d=this,f=0.125*Math.random();this.clearTween();
this.currentAppear=void 0;var e=this.getEntityEC("ECMesh");e&&e.setScale(1);this.tween=G.Create({x:b[0],y:b[1],z:b[2]}).to({x:c[0],y:c[1],z:c[2]},this.distance/this.SPEED-f).easing(G.Easing.Quadratic.Out).onUpdate(function(){d.entity.setv3Location(a.v3Build(this.x,this.y,this.z))}).onComplete(function(){d.tween=void 0;d.currentAppear=!0}).delay(f).start()},animateDisappear:function(){var a=this.globals.mathDevice,b=this.getv3Location(),c=a.v3Sub(this.initialv3Location,this.v3Move),d=this,f=0.125*
Math.random();this.clearTween();this.currentAppear=void 0;this.tween=G.Create({x:b[0],y:b[1],z:b[2]}).to({x:c[0],y:c[1],z:c[2]},this.distance/this.SPEED-f).easing(G.Easing.Quadratic.Out).onUpdate(function(){d.entity.setv3Location(a.v3Build(this.x,this.y,this.z))}).onComplete(function(){d.tween=void 0;d.currentAppear=!1}).delay(f).start()},clearTween:function(){void 0!==this.tween&&(this.tween.stop(),this.tween=void 0)},appear:function(){this.desiredAppear=!0},disappear:function(){this.desiredAppear=
!1},toggle:function(){this.desiredAppear=!this.desiredAppear},draw:function(){},drawDebug:function(){this.globals.debugDraw.drawDebugHalfCube(this.entity.v3Location,1.3,1,0.5,0.5)},serialize:function(a){this._super(a);a.desiredAppear=this.desiredAppear;a.currentAppear=this.currentAppear;a.outputNetworkID=this.outputNetworkID},deserialize:function(a){this._super(a)},destroy:function(){this._super();this.clearTween()}});F.prototype.eCCreationMap[Vh.prototype.entityComponentName]=Vh;Vh.create=function(a,
b){return new Vh(a,b)};var hc=F.extend({entityComponentName:"ECTrigger",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!0,shouldSave:!1,realTime:!1,init:function(a,b){this._super(a,b);this.on=this.onImpactLastFrame=this.onImpactThisFrame=!1;this.roomID=b.roomID;this.groupID=b.groupID;this.triggerGroupID=b.triggerGroupID;this.triggerNetworkID=this.buildTwoNumberHash(this.roomID,this.triggerGroupID);this.outputNetworkID=this.buildIDArray(this.roomID,
this.groupID);this.button=this.safeCopy(b.button,!0);this.dead=this.safeCopy(b.dead,!1);this.deadWave=this.safeCopy(b.deadWave,!1);this.empty=this.safeCopy(b.empty,!1);this.hidden=this.safeCopy(b.hidden,!1);this.enter=this.safeCopy(b.enter,!1);this.multiEnter=this.safeCopy(b.multiEnter,!1);this.reenter=this.safeCopy(b.reenter,!1);this.waveNetworkID=this.buildIDArray(this.roomID,b.waveGroupID);this.inputNetworkID=this.buildIDArray(this.roomID,b.inputGroupID);this.inputAnd=this.safeCopy(b.and,!1);this.inputNot=
this.safeCopy(b.not,!1);this.inputXor=this.safeCopy(b.xor,!1);void 0!==this.inputNetworkID&&(this.gate=!0,this.buildGateRef());this.timeDelay=b.delay;void 0!==this.timeDelay&&(this.timeDelayFrameCounter=0);this.triggerCount=this.startTriggerCount=0<b.triggerCount?b.triggerCount:void 0;this.triggeredTime=0;this.initializeUpdateTriggerBehaviour()},activate:function(){this._super();var a=this.globals.mathDevice,b=this.entity.getEC("ECPhysicsCube"),c=this.entity.getEC("ECMesh"),d=function(a){this.onImpact(a)}.bind(this);
b&&b.setOnImpactCallback(d);c&&!this.hidden&&c.setLocalOffset(a.v3Build(0,0.2,0));if(a=this.getEntityEC("ECMesh"))a.disableDeltaSerialize=!0;this.triggerWeb=this.gameManager.triggerWeb},hasTriggerNetworkID:function(a){return this.triggerNetworkID===a},hasOutputNetworkID:function(a){return this.arrayContains(this.outputNetworkID,a)},hasInputNetworkID:function(a){return!this.gate?!1:this.arrayContains(this.inputNetworkID,a)},buildGateRef:function(){this.gateRef={};for(var a=this.inputNetworkID,b=0;b<
a.length;b+=1)this.gateRef[a[b]]=!1;this.gateRefCount=0},accumulateGateRefCount:function(){for(var a=this.inputNetworkID,b=this.gateRefCount=0;b<a.length;b+=1)this.gateRef[a[b]]&&(this.gateRefCount+=1)},onGateRef:function(a){this.gateRef[a]=!0;this.accumulateGateRefCount()},offGateRef:function(a){this.gateRef[a]=!1;this.accumulateGateRefCount()},toggleGateRef:function(a){this.gateRef[a]=!this.gateRef[a];this.accumulateGateRefCount()},hasOutputNetworkIDFromArray:function(a){var b;for(b=0;b<a.length;b+=
1)if(this.arrayContains(this.outputNetworkID,a[b]))return!0;return!1},groupIDContains:function(a){return this.arrayContains(this.groupID,a)},onImpact:function(){this.onImpactThisFrame=!0},reset:function(){this.triggerWeb.clear(this.triggerNetworkID);this.showOff();this.triggerCount=this.startTriggerCount;this.onImpactLastFrame=this.onImpactThisFrame=!1},updateTriggerDead:function(){this.entity.getGameSpace().getEnemyCleared()&&(this.shouldTriggerOn=!0,this.triggerCount=1)},updateTriggerEmpty:function(){0===
this.entity.getGameSpace().getPickupCount()&&(this.shouldTriggerOn=!0,this.triggerCount=1)},updateTriggerDeadAndEmpty:function(){var a=this.entity.getGameSpace();a.getEnemyCleared()&&0===a.getPickupCount()&&(this.shouldTriggerOn=!0,this.triggerCount=1)},updateTriggerDeadWave:function(){var a=this.entity.getGameSpace(),b;for(b=0;b<this.waveNetworkID.length;b+=1)a.getEnemyOfIDClearedTime(this.waveNetworkID[b])>this.triggeredTime&&(this.shouldTriggerOn=!0);this.deadWaveShouldTrigger&&(this.shouldTriggerOn=
!1,this.shouldTriggerOff=!0);this.deadWaveShouldTrigger=this.shouldTriggerOn},updateTriggerEnter:function(){var a=this.entity.getGameSpace();0<a.getDeepHeroCount()&&1===a.getHeroEntryCount()&&(this.shouldTriggerOn=!0,this.triggerCount=1)},updateTriggerMultiEnter:function(){this.entity.getGameSpace().getLiveHeroCount()===this.gameManager.getNumberOfHeroes()&&(this.shouldTriggerOn=!0,this.triggerCount=1)},updateTriggerReEnter:function(){var a=this.entity.getGameSpace();0<a.getDeepHeroCount()&&1<a.getHeroEntryCount()&&
(this.shouldTriggerOn=!0,this.triggerCount=1)},updateGate:function(){this.gateOn=this.gateRefCount>=(this.inputAnd?this.inputNetworkID.length:1);this.inputXor&&(this.gateOn=1===this.gateRefCount);this.gateOn!==this.prevGateOn&&(this.shouldTriggerOn=this.gateOn,this.inputNot&&(this.shouldTriggerOn=!this.shouldTriggerOn),this.shouldTriggerOff=!this.shouldTriggerOn&&0<this.triggeredTime);this.prevGateOn=this.gateOn},updateTimeDelay:function(){void 0!==this.timeDelay&&0<this.timeDelay&&(this.timeDelayFrameCounter+=
1,void 0===this.timeDelayedTriggersOn&&(this.timeDelayedTriggersOn=[],this.timeDelayedTriggersOff=[]),this.shouldTriggerOn&&this.timeDelayedTriggersOn.unshift(this.timeDelayFrameCounter+this.timeDelay*this.globals.appFPS),this.shouldTriggerOn=!1,0<this.timeDelayedTriggersOn.length&&this.timeDelayedTriggersOn[this.timeDelayedTriggersOn.length-1]<=this.timeDelayFrameCounter&&(this.shouldTriggerOn=!0,this.timeDelayedTriggersOn.pop()),this.shouldTriggerOff&&this.timeDelayedTriggersOff.unshift(this.timeDelayFrameCounter+
this.timeDelay*this.globals.appFPS),this.shouldTriggerOff=!1,0<this.timeDelayedTriggersOff.length&&this.timeDelayedTriggersOff[this.timeDelayedTriggersOff.length-1]<=this.timeDelayFrameCounter&&(this.shouldTriggerOff=!0,this.timeDelayedTriggersOff.pop()))},updateTriggerContact:function(){this.onImpactThisFrame!==this.onImpactLastFrame&&(this.shouldTriggerOn=this.onImpactThisFrame,this.shouldTriggerOff=!this.shouldTriggerOn);this.onImpactLastFrame=this.onImpactThisFrame;this.onImpactThisFrame=!1},
initializeUpdateTriggerBehaviour:function(){this.dead?(this.updateTrigger=this.updateTriggerDead,this.empty&&(this.updateTrigger=this.updateTriggerDeadAndEmpty)):this.updateTrigger=this.deadWave?this.updateTriggerDeadWave:this.empty?this.updateTriggerEmpty:this.enter?this.updateTriggerEnter:this.multiEnter?this.updateTriggerMultiEnter:this.reenter?this.updateTriggerReEnter:this.gate?this.updateGate:this.updateTriggerContact},update:function(){this._super();this.catchAnim();this.isManagedByThisMachine()&&
!(void 0!==this.triggerCount&&0>=this.triggerCount)&&(this.shouldTriggerOff=this.shouldTriggerOn=!1,this.updateTrigger(),this.updateTimeDelay(),this.shouldTriggerOn&&(this.setOn(),this.triggeredTime=this.globals.gameCurrentTime),this.shouldTriggerOff&&this.setOff())},setOn:function(){this.triggerWeb.addRef(this.triggerNetworkID,this.outputNetworkID)},setOff:function(){this.triggerWeb.removeRef(this.triggerNetworkID,this.outputNetworkID)},catchAnim:function(){void 0===this.tween&&(this.hidden&&(this.currentOn=
this.desiredOn=!1),this.currentOn!==this.desiredOn&&(this.desiredOn?this.animateOn():this.animateOff()))},animateOn:function(){var a=this.globals.mathDevice,b=this.getEntityEC("ECMesh");if(b){var c=this;void 0!==this.tween&&(this.tween.stop(),this.tween=void 0);this.tween=G.Create({x:0,y:0.2,z:0}).to({x:0,y:-0.2,z:0},0.5).easing(G.Easing.Quadratic.Out).onUpdate(function(){b.setLocalOffset(a.v3Build(this.x,this.y,this.z))}).onComplete(function(){c.tween=void 0;c.currentOn=!0}).delay(0.1*Math.random()).start()}},
animateOff:function(){var a=this.globals.mathDevice,b=this.getEntityEC("ECMesh");if(b){var c=this;void 0!==this.tween&&(this.tween.stop(),this.tween=void 0);this.tween=G.Create({x:0,y:-0.2,z:0}).to({x:0,y:0.2,z:0},1).easing(G.Easing.Bounce.Out).onUpdate(function(){b.setLocalOffset(a.v3Build(this.x,this.y,this.z))}).onComplete(function(){c.tween=void 0;c.currentOn=!1}).delay(0.5*Math.random()).start()}},showOn:function(){var a=this.desiredOn;this.desiredOn=this.button?!0:!this.desiredOn;this.desiredOn!==
a&&void 0!==this.triggerCount&&(this.triggerCount-=1);return this.button?this.triggerStates.ON:this.triggerStates.TOGGLE},showOff:function(){this.button&&(this.desiredOn=!1);!this.button&&void 0!==this.triggerCount&&(this.triggerCount-=1);return this.button?this.triggerStates.OFF:this.triggerStates.UNCHANGED},draw:function(){},drawDebug:function(){var a=this.globals,b=a.mathDevice,c=a.debugDraw,d,f,e=this;d=b.v3Copy(this.getv3Location());this.gate?this.gateOn?c.drawDebugSphere(d,1.5,1,1,0):c.drawDebugSphere(d,
1,0.5,0.5,0):this.desiredOn?c.drawDebugSphere(d,1.5,0,1,0):c.drawDebugSphere(d,1,0,0.5,0);b.v3Add(d,b.v3Build(0,3,0),d);f=b.v3Copy(d);for(var h=0,a=function(a){var i=a.getEC("ECTrigger");i&&i.hasOutputNetworkID(e.outputNetworkID[h])&&(d=b.v3Copy(a.v3Location),b.v3Add(d,b.v3Build(0,3,0),d),c.drawDebugLine(f,d,0,1,0),c.drawDebugLine(a.v3Location,d,0,1,0),f=b.v3Copy(d))},i=function(a){var b=a.getEC("ECTrigger");b&&b.hasInputNetworkID(e.outputNetworkID[h])&&c.drawDebugLine(f,a.v3Location,1,1,0)},j=function(a){var b=
a.getEC("ECTrap");b&&b.hasOutputNetworkID(e.outputNetworkID[h])&&c.drawDebugLine(f,a.v3Location,0,0,1)},k=function(a){var b=a.getEC("ECSpawner");b&&b.hasOutputNetworkID(e.outputNetworkID[h])&&c.drawDebugLine(f,a.v3Location,1,0,0)},h=0;h<this.outputNetworkID.length;h+=1)this.gameManager.applyToEntities(a),this.gameManager.applyToEntities(i),this.gameManager.applyToEntities(j),this.gameManager.applyToEntities(k)},serialize:function(a){this._super(a);a.button=this.button;a.dead=this.dead;a.empty=this.empty;
a.desiredOn=this.desiredOn;a.hidden=this.hidden;a.onImpactLastFrame=this.onImpactLastFrame;a.onImpactThisFrame=this.onImpactThisFrame;a.outputNetworkID=this.outputNetworkID;a.startTriggerCount=this.startTriggerCount;a.triggerCount=this.triggerCount},serializeDelta:function(a){a.desiredOn=this.desiredOn;a.onImpactLastFrame=this.onImpactLastFrame;a.onImpactThisFrame=this.onImpactThisFrame;a.startTriggerCount=this.startTriggerCount;a.triggerCount=this.triggerCount},destroy:function(){this._super()}});
hc.prototype.triggerStates={UNCHANGED:0,ON:1,OFF:2,TOGGLE:3};F.prototype.eCCreationMap[hc.prototype.entityComponentName]=hc;hc.create=function(a,b){return new hc(a,b)};var Oe=F.extend({entityComponentName:"ECUpgradable",updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,parameters:{upgradeName:"",upgradeArchetypeName:"",radialMenu:!0,upgradeInfo:"normal",maxNearbyEntitiesToUpgrade:1},init:function(a,b){this._super(a,b);var c=this.gameManager.getEntityFactory().getECArchetype(this.getUpgradeArchetypeName(),
"ECBuilding");this.resourceCost=c.resourceCost;void 0===this.resourceCost&&(this.resourceCost=0);this.secondaryResourceCost=c.secondaryResourceCost;void 0===this.secondaryResourceCost&&(this.secondaryResourceCost=0);this.softCurrencyCost=c.softCurrencyCost;void 0===this.softCurrencyCost&&(this.softCurrencyCost=0);this.buildTime=c.buildTime;this.prerequisites=this.safeCopy(c.prerequisites,[]);this.upgradeTime=c.buildTime;this.obeysScaffoldCap=c.obeysScaffoldCap;this.scaffoldType=c.scaffoldType},activate:function(){this._super()},
canEntityAffordUpgrade:function(a,b){var c=!1,d;d=void 0!==b?b:1;var f=this.getResourceCost()*d,e=this.getSecondaryResourceCost()*d;a&&(d=a.getEC("ECPlayerData"))&&(c=d.getResource(E.LUMBER)>=f&&d.getResource(E.STONE)>=e);return c},getUpgradeInfo:function(){return tk[this.archetype.upgradeInfo]},shouldShowUpgradeButton:function(){return this.archetype.radialMenu&&!this.isUpgrading()},shouldShowMultipleUpgradeButton:function(){return this.archetype.radialMenu&&!this.isUpgrading()&&1<this.archetype.maxNearbyEntitiesToUpgrade},
isRadialMenuButtonActive:function(a){return!this.isUpgrading()&&this.arePrerequisitesMet()&&this.canEntityAffordUpgrade(a)},getGuiArchetype:function(a,b){var c=this.getSecondaryResourceCost(),d=this.getSoftCurrencyCost();return 0<c?a?b?"upgradeStone":"upgradeInvalidStoneCantAfford":"upgradeInvalidStone":0<d?a?b?"upgradeAmber":"upgradeInvalidAmberCantAfford":"upgradeInvalidAmber":a?b?"upgradeLumber":"upgradeInvalidLumberCantAfford":"upgradeInvalidLumber"},getBatchGuiArchetype:function(a,b){var c=this.getSecondaryResourceCost(),
d=this.getSoftCurrencyCost();return 0<c?a?b?"upgradeBatchStone":"upgradeBatchInvalidStoneCantAfford":"upgradeBatchInvalidStone":0<d?a?b?"upgradeBatchAmber":"upgradeBatchInvalidAmberCantAfford":"upgradeBatchInvalidAmber":a?b?"upgradeBatchLumber":"upgradeBatchInvalidLumberCantAfford":"upgradeBatchInvalidLumber"},getNumberOfThingsThatCanBeUpgradedAroundMe:function(){if(1===this.archetype.maxNearbyEntitiesToUpgrade)return 1;var a=this.getListOfEntitiesThatICanUpgradeAroundMe();return Math.min(a.length,
this.archetype.maxNearbyEntitiesToUpgrade)},getListOfEntitiesThatICanUpgradeAroundMe:function(){var a=[];a.push(this.entity);var b=this.globals.mathDevice,c=this.entity,d=this.getv3Location();this.gameManager.applyToEntitiesInGridCellsWithinRadius(this.getv3Location(),5,function(f){if(f.getArchetypeName()===c.getArchetypeName()){var e=f.getEC("ECUpgrader");e&&!e.isUpgrading()&&(25<b.v3DistanceSq(f.getv3Location(),d)||f!==c&&a.push(f))}});return a},refineUpgradeList:function(a,b){var c=this.globals.mathDevice,
d=this.getv3Location();a.sort(function(a,b){return c.v3DistanceSq(a.getv3Location(),d)-c.v3DistanceSq(b.getv3Location(),d)});a.splice(b);return a},howManyCanPlayerAffordToUpgrade:function(a){var b=this.archetype.maxNearbyEntitiesToUpgrade;if(1===b)return b;var c=this.getResourceCost(),d=this.getSecondaryResourceCost();if(a=a.getEC("ECPlayerData"))c&&(b=Math.min(b,Math.floor(a.getResource(E.LUMBER)/c))),d&&(b=Math.min(b,Math.floor(a.getResource(E.STONE)/d)));return b=Math.max(b,1)},doRadialMenuButton:function(a,
b,c){var d,f=this.globals,e=this.gameManager,h=e.buildingManager,i=this.globals.currentLanguage.GAME_HUD_UPGRADE_TO+" "+this.getUpgradeName(),j=this.numberToCommaString(this.getResourceCost()),k=this.numberToCommaString(this.getSecondaryResourceCost()),l=this.numberToCommaString(this.getSoftCurrencyCost()),m=this.formatTimeToString(this.getBuildTime(),!0),q=this.canEntityAffordUpgrade(b),b=this.arePrerequisitesMet()&&!this.isUpgrading()&&!this.hasFailedScaffoldCap(),q=this.getGuiArchetype(b,q);b?
a.doButton({id:"ecRadialMenu"+this.entity.getName()+"Upgrade",text1:i,text2:j,text3:k,text4:l,text5:m,v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:q})&&(a=$d.create(e,f),a.setBuilding(this.entity),e.setGameState(a)):(this.arePrerequisitesMet()||(h&&(d=h.getPrerequisitesDescription(this.getPrerequisites())),d&&(i=i+"\n"+d+" "+this.globals.currentLanguage.GAME_HUD_REQUIRED)),this.hasFailedScaffoldCap()&&(i=this.globals.currentLanguage.GAME_HUD_CANT_UPGRADE),a.doButton({id:"ecRadialMenu"+
this.entity.getName()+"Upgrade Unavailable",text1:i,text2:j,text3:k,text4:l,text5:m,v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:q}))},doMultipleUpgradeRadialMenuButton:function(a,b,c){var d,f=this.globals,e=this.gameManager.buildingManager,h=this.getNumberOfThingsThatCanBeUpgradedAroundMe(),f=f.currentLanguage.GAME_HUD_BATCH_UPGRADE+f.currentLanguage.GAME_HUD_TO+" "+this.getUpgradeName()+" (x"+h+")",i=this.numberToCommaString(this.getResourceCost()*h),j=this.numberToCommaString(this.getSecondaryResourceCost()*
h),k=this.numberToCommaString(this.getSoftCurrencyCost()*h),l=this.formatTimeToString(this.getBuildTime(),!0),m=this.canEntityAffordUpgrade(b,h),q=this.arePrerequisitesMet()&&!this.isUpgrading()&&!this.hasFailedScaffoldCap(),m=this.getBatchGuiArchetype(q,m);q?a.doButton({id:"ecRadialMenu"+this.entity.getName()+"MultipleUpgrade",text1:f,text2:i,text3:j,text4:k,text5:l,v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:m})&&this.attemptToPurchaseMultipleUpgrade(b,h):(this.arePrerequisitesMet()||
(e&&(d=e.getPrerequisitesDescription(this.getPrerequisites())),d&&(f=f+"\n"+d+" "+this.globals.currentLanguage.GAME_HUD_REQUIRED)),this.hasFailedScaffoldCap()&&(f=this.globals.currentLanguage.GAME_HUD_CANT_UPGRADE),a.doButton({id:"ecRadialMenu"+this.entity.getName()+"MultipleUpgrade Unavailable",text1:f,text2:i,text3:j,text4:k,text5:l,v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:m}))},attemptToPurchaseMultipleUpgrade:function(a,b){var c=this.globals,d=this.gameManager,f=this;this.canEntityAffordUpgrade(a,
b)?(this.purchaseUpgrade(a,b),this.beginUpgradeMultipleBuildings(a,b),this.playEffect("sfx_upgrade_batch")):(c=Wa.create(d,c),d.setGameState(c),c.setPurchaseFn(function(){f.beginUpgradeMultipleBuildings(a,b);f.playEffect("sfx_upgrade_batch")}),c.setRequiredResource(E.LUMBER,this.getResourceCost()*b),c.setRequiredResource(E.STONE,this.getSecondaryResourceCost()*b),d="upgradeBuilding_"+this.getUpgradeArchetypeName(),c.setPurchaseReason(d),c.setButtonPanal("convert"))},attemptToPurchaseUpgrade:function(a,
b){var c=this.globals,d=this.gameManager,f=this;this.canEntityAffordUpgrade(a,b)?this.purchaseUpgrade(a,b):(c=Wa.create(d,c),d.setGameState(c),c.setPurchaseFn(function(){f.beginUpgrade(a)}),c.setRequiredResource(E.LUMBER,this.getResourceCost()),c.setRequiredResource(E.STONE,this.getSecondaryResourceCost()),d="upgradeBuilding_"+this.getUpgradeArchetypeName(),c.setPurchaseReason(d),c.setButtonPanal("convert"))},arePrerequisitesMet:function(){var a=!0,b=this.getPrerequisites(),c=this.gameManager,d=this.obeysScaffoldCap,
f=this.scaffoldType;b&&c&&(c=c.getBuildingManager())&&(a=c.canCreateBuilding(null,null,b,d,f));return a},hasFailedScaffoldCap:function(){var a=this.gameManager,b=this.obeysScaffoldCap;return a&&b&&(a=a.getBuildingManager())&&a.hasReachedScaffoldCap(this.scaffoldType)?!0:!1},purchaseUpgrade:function(a,b){var c,d=void 0!==b?b:1;if(this.entity&&!this.isUpgrading()){if(a&&(c=a.getEC("ECPlayerData")))c.adjustResource(E.LUMBER,-this.getResourceCost()*d),c.adjustResource(E.STONE,-this.getSecondaryResourceCost()*
d);this.beginUpgrade(a)}},beginUpgrade:function(a){var b=this.getEntityEC("ECUpgrader");b&&b.startUpgrading(this.getUpgradeArchetypeName(),this.getUpgradeTime(),this.scaffoldType,a);(a=this.getEntityEC("ECSelectable"))&&a.setActivated(!1)},beginUpgradeMultipleBuildings:function(a,b){var c=this.getListOfEntitiesThatICanUpgradeAroundMe(),c=this.refineUpgradeList(c,b),d=this.entity;c.forEach(function(b){var c=b.getEC("ECUpgradable");c&&c.beginUpgrade(a);c=b.getEC("ECUpgrader");b!==d&&c&&c.setNoMessage()})},
isUpgrading:function(){var a=!1,b=this.getEntityEC("ECUpgrader");b&&b.isUpgrading()&&(a=!0);return a},openShop:function(){var a=this.gameManager,b;a&&(b=Wa.create(a,this.globals),a.setGameState(b))},getUpgradeName:function(){return this.archetype.upgradeName},getUpgradeArchetypeName:function(){return this.archetype.upgradeArchetypeName},getResourceCost:function(){return this.resourceCost},getSecondaryResourceCost:function(){return this.secondaryResourceCost},getSoftCurrencyCost:function(){return this.softCurrencyCost},
getBuildTime:function(){return this.buildTime},getPrerequisites:function(){return this.prerequisites},getUpgradeTime:function(){return this.upgradeTime},update:function(){this._super()},draw:function(){},drawDebug:function(){},serialize:function(a){this._super(a)},serializeDelta:function(){}});Oe.create=function(a,b){return new Oe(a,b)};Oe.prototype.eCCreationMap[Oe.prototype.entityComponentName]=Oe;var Pe=F.extend({entityComponentName:"ECUpgrader",updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldAlwaysUpdate:!0,
shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!0,parameters:{upgradeSpeed:0},init:function(a,b){this._super(a,b);this.startedUpgrading=this.hasOfflineBuilder=this.hasBuilder=!1;this.upgradeTime=this.upgradeComplete=0;this.scaffoldType=this.upgradedArchetypeName=null;this.extraUpgradeTimeThisFrame=0;this.builderHasBeenClicked=this.waitingForClick=!1},activate:function(){this._super();var a=this.gameManager;this.isUpgrading()&&(a&&(a=a.getBuildingManager())&&a.upgraderAdded(this,
!0),this.setToUpdate(!0),this.setToDraw(!0),this.createScaffoldMesh());this.isWaitingForClick()&&(a=this.getEntityEC("ECBuilding"))&&a.disableMovement(!0)},getScaffoldType:function(){return this.scaffoldType},createScaffoldMesh:function(){if(!this.scaffoldMeshEntity){var a=this.entity.getRadius(),a=a+0.25,b=this.gameManager.getEntityFactory().createActiveEntityInstance("ScaffoldMesh"+this.plannedObject,"a_b_scaffoldMesh",this.getv3Location()),c=this.globals.mathDevice,d=b.getEC("ECMesh");d.setScale(0.1);
G.Create({scale:0.1,yOffset:-1}).to({scale:a/2,yOffset:0},0.5).easing(G.Easing.Elastic.Out).onUpdate(function(){d.setLocalOffset(c.v3Build(0,this.yOffset,0));d.setScale(this.scale)}).start();this.scaffoldMeshEntity=b}},destroyScaffoldMesh:function(){this.scaffoldMeshEntity&&(this.scaffoldMeshEntity.shrinkDisappear(0.5),this.scaffoldMeshEntity=void 0)},startUpgrading:function(a,b,c,d){var f=this.entity,e=this.gameManager;if(f&&(!this.isUpgrading()&&a&&c&&void 0!==b)&&(this.gameManager.eventManager.notify("BuildingEvent",
{reason:"upgradeStarted",building:f}),this.upgradeTime=b,this.upgradedArchetypeName=a,this.scaffoldType=c,this.startedUpgrading=!0,this.hasOfflineBuilder=!1,this.upgradeComplete=0,this.builderHasBeenClicked=this.waitingForClick=!1,e&&(a=e.getBuildingManager())&&a.upgraderAdded(this,!0),this.setToUpdate(!0),this.setToDraw(!0),d&&(d=d.getEC("ECWildlingLeader"))))d.onUpgradeStarted(f);this.createScaffoldMesh()},isUpgrading:function(){return this.startedUpgrading},setNoMessage:function(){this.nomessage=
!0},finishUpgrading:function(){var a=this.gameManager,b;this.isUpgrading()&&(a&&((b=a.getBuildingManager())&&b.upgraderRemoved(this,!0),!this.nomessage&&!this.globals.cheats.grindless&&(a=a.getGuiManager(),a.addGameMessage("ecUpgrader"+this.entity.getName()+"upgradeComplete",this.getUpgradedBuildingName(!0),"Upgraded!",4,"newsflashUpgradeComplete")),this.nomessage=!1),this.placeUpgradedScaffold(),this.setToUpdate(!1),this.setToDraw(!1),this.entity.setToBeDestroyed());this.destroyScaffoldMesh()},getUpgradedBuildingName:function(a){var b=
this.gameManager.entityFactory,c=this.upgradedArchetypeName,d=null,f=0;if(b&&c&&(b=b.getECArchetype(c,"ECBuilding")))d=b.buildingName||b.buildingType,a&&(f=b.level,0<f&&(d+=" Level "+f));d||(d="Building");return d},getUpgradeArchetypeName:function(){return this.upgradedArchetypeName},placeUpgradedScaffold:function(){var a=this.gameManager.placeOnGround(this.getv3Location(),0.5,this.entity),b=null,c=this.getEntityEC("ECBuilding");this.isUpgrading()&&(c&&(b=c.getBuildingParentEntity()),this.placeScaffold(a,
this.upgradedArchetypeName,b))},placeScaffold:function(a,b,c){var d=this.gameManager,f=this.entity,e=d.getEntityFactory(),h=this.getArchetypeName(),i=f.getEC("ECResourceStorage"),j=i?i.getTemporaryResourceCaps():[0,0],a=d.placeOnGround(a,0.5,f),c=e.createScaffold("UpgradeScaffold",b,a,this.getRotationY(),d.getHero(),h,!1,0,j,c);if(d=c.getEC("ECScaffold")){d.setBuildTime(0.5);d.setMinBuildSpeed(1);d.instantlyStartBuilding();if(e=f.getEC("ECBuilding"))e=e.generateTemporaryBuildingData(!0),e.ecUpgraderData=
void 0,d.setTemporaryBuildingData(e);i&&i.removeResourceCap()}c.transferIdentity(f);this.globals.gameManager.eventManager.notify("BuildingEvent",{reason:"upgradeScaffoldCreated",building:this.entity,scaffold:c});this.sendBuildingInitiatedMetric(b);d&&f.shrinkDisappear(0.25)},sendBuildingInitiatedMetric:function(a){this.globals.metricsManager.sendGameMetric("buildingInitiated_"+a)},cancelUpgrade:function(a){var b,c,d;d=this.gameManager;if(this.isUpgrading()){d&&(d=d.getBuildingManager())&&d.upgraderRemoved(this,
!0);this.startedUpgrading=!1;this.upgradeTime=this.upgradeComplete=0;this.scaffoldType=this.upgradedArchetypeName=null;this.extraUpgradeTimeThisFrame=0;this.hasOfflineBuilder=this.builderHasBeenClicked=this.waitingForClick=!1;this.globals.gameManager.eventManager.notify("BuildingEvent",{reason:"cancelled",building:this.entity});if(a){if(d=this.getEntityEC("ECUpgradable"))b=0.5*d.getResourceCost(),c=0.5*d.getSecondaryResourceCost();if(a=a.getEC("ECPlayerData"))a.adjustResource(E.LUMBER,b),a.adjustResource(E.STONE,
c)}this.destroyScaffoldMesh();this.setToUpdate(!1);this.setToDraw(!1)}},getUpgradeSpeed:function(){return this.archetype.upgradeSpeed},getUpgradeCompleteFraction:function(){return this.globals.mathDevice.saturate(this.upgradeComplete)},getUpgradeTimeRemaining:function(){return(1-this.getUpgradeCompleteFraction())*this.upgradeTime},update:function(){var a=this.getTimeSinceLastUpdate(),b=this.gameManager.getAdditionalTimeFromSave();this._super();this.updateUpgradingProgress(a+b,b);this.isWaitingForClick()?
this.doWaitingForClickGUI():1>this.upgradeComplete&&0<this.upgradeTime&&this.doProgressBar()},finishUpgradingWhenBuilderClicked:function(){var a;this.waitingForClick||(this.waitingForClick=!0,this.builderHasBeenClicked=!1,this.willFinishOnClick=!0,(a=this.getEntityEC("ECBuilding"))&&a.disableMovement(!0))},isWaitingForClick:function(){return this.waitingForClick},reduceRemainingUpgradeTime:function(a){this.isWaitingForClick()&&(this.builderHasBeenClicked=!0);0<a&&(this.extraUpgradeTimeThisFrame+=
a)},updateUpgradingProgress:function(a){var b=this.upgradeTime,c=this.getUpgradeSpeed();if(this.isUpgrading()&&(0<a&&(this.isWaitingForClick()?this.builderHasBeenClicked&&(this.waitingForClick=!1,this.upgradeComplete=1,(a=this.getEntityEC("ECBuilding"))&&a.disableMovement(!1)):(this.upgradeComplete+=(a*c+this.extraUpgradeTimeThisFrame)/b,this.extraUpgradeTimeThisFrame=0)),!this.isWaitingForClick()&&(1<=this.upgradeComplete||0>=b)))this.willFinishOnClick&&(this.willFinishOnClick=!1,this.sendUpgradeCompletedOfflineMetric(this.upgradedArchetypeName,
this.extraUpgradeTimeThisFrame)),this.finishUpgrading()},manageLargeTimeStep:function(a){this._super(a);this.updateUpgradingProgress(a)},doRadialMenuCancelUpgradeButton:function(a,b,c){var d=this.globals.currentLanguage.GAME_HUD_CANCEL_UPGRADE;a.doButton({id:"ecRadialMenu"+this.entity.getName()+"CancelUpgrade",text:d,v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:"cancelUpgrade"})&&this.cancelUpgrade(b)},doRadialMenuInstantUpgradeButton:function(a,b,c){var d=this.globals.currentLanguage.GAME_HUD_SPEED_UP,
f=this.getCostToInstantlyUpgrade().toString();this.canEntityAffordInstantUpgrade(b)?a.doButton({id:"ecRadialMenu"+this.entity.getName()+"InstantUpgrade",text1:d,text2:f,v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,guiArchetype:"speedup"})&&(this.sendUpgradeSpeedupBought(this.upgradedArchetypeName),this.instantlyUpgrade(b)):(d=this.globals.currentLanguage.GUI_BUTTON_BUY_AMBER,a.doButton({id:"ecRadialMenu"+this.entity.getName()+"InstantUpgrade Unavailable",text1:d,text2:f,v2ScreenLocation:c,buttonType:aa.BUTTON_ROUND,
guiArchetype:"addAmber"})&&this.openShop())},setHasBuilder:function(a){this.hasBuilder=a},getHasBuilder:function(){return this.hasBuilder},getHasOfflineBuilder:function(){return this.hasOfflineBuilder},setHasOfflineBuilder:function(a){this.hasOfflineBuilder=a},instantlyUpgrade:function(a){if(this.canEntityAffordInstantUpgrade(a)){var a=a.getEC("ECPlayerData"),b=this.getCostToInstantlyUpgrade();a&&(a.adjustSoftCurrency(-b),this.upgradeComplete=1)}},canEntityAffordInstantUpgrade:function(a){var a=a.getEC("ECPlayerData"),
b=this.getCostToInstantlyUpgrade();return a&&a.getSoftCurrency()>=b?!0:!1},getCostToInstantlyUpgrade:function(){var a=this.getUpgradeTimeRemaining();return 60>=a?5:3600>=a?Math.ceil(100*(a/3600)):86400>=a?Math.ceil(1E3*(a/86400)):604800>=a?Math.ceil(2E3*(a/604800)):Math.ceil(4E3*(a/1209600))},openShop:function(){var a=this.gameManager,b;a&&(b=Wa.create(a,this.globals),a.setGameState(b))},sendUpgradeSpeedupBought:function(a){this.globals.metricsManager.sendGameMetric("buildingSpeedupBought_"+a,this.getCostToInstantlyUpgrade())},
sendUpgradeCompletedOfflineMetric:function(a,b){this.globals.metricsManager.sendGameMetric("buildingCompletedOffline_"+a,b)},draw:function(){},doWaitingForClickGUI:function(){var a=this.globals.mathDevice.v3Copy(this.getv3Location());a[1]+=2;this.gameManager.getGuiManager().addDrawGui("upgradeCompleteBar",{v3WorldLocation:a},"idUpgradeCompleteGUI"+this.entity.getName())},doProgressBar:function(){var a=Math.floor(this.getUpgradeTimeRemaining()),b=this.globals.mathDevice.v3Copy(this.getv3Location());
b[1]+=2;this.gameManager.getGuiManager().addDrawGui("upgradeProgressBar",{v3WorldLocation:b,text:this.formatTimeToString(a),completeFactor:this.getUpgradeCompleteFraction()},"idUpgradeProgress"+this.entity.getName())},drawDebug:function(){},onToBeDestroyed:function(){this._super();this.isUpgrading()&&(this.gameManager.getBuildingManager().upgraderRemoved(this,!0),this.destroyScaffoldMesh())},createTempData:function(){return{startedUpgrading:this.startedUpgrading,upgradeComplete:this.upgradeComplete,
upgradeTime:this.upgradeTime,upgradedArchetypeName:this.upgradedArchetypeName,scaffoldType:this.scaffoldType}},applyTempData:function(a){var b=this.gameManager.getBuildingManager();a&&(this.isUpgrading()&&b.upgraderRemoved(this,!0),this.startedUpgrading=a.startedUpgrading,this.upgradeComplete=a.upgradeComplete,this.upgradeTime=a.upgradeTime,this.upgradedArchetypeName=a.upgradedArchetypeName,this.scaffoldType=a.scaffoldType,a=this.isUpgrading(),this.setToUpdate(a),this.setToDraw(a),a&&b.upgraderAdded(this,
!0))},saveSerialize:function(){return{startedUpgrading:this.startedUpgrading,upgradeComplete:this.upgradeComplete,upgradeTime:this.upgradeTime,upgradedArchetypeName:this.upgradedArchetypeName,hasOfflineBuilder:this.hasOfflineBuilder,waitingForClick:this.waitingForClick,scaffoldType:this.scaffoldType}},serialize:function(a){this._super(a);a.startedUpgrading=this.startedUpgrading;a.upgradeComplete=this.upgradeComplete;a.upgradeTime=this.upgradeTime;a.upgradedArchetypeName=this.upgradedArchetypeName;
a.hasOfflineBuilder=this.hasOfflineBuilder;a.waitingForClick=this.waitingForClick;a.scaffoldType=this.scaffoldType},serializeDelta:function(){}});Pe.create=function(a,b){return new Pe(a,b)};Pe.prototype.eCCreationMap[Pe.prototype.entityComponentName]=Pe;var Wh=F.extend({entityComponentName:"ECWarManager",updatePeriod:1,sortPriority:4,shouldUpdate:!0,shouldAlwaysUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!0,shouldLevelSave:!1,storeGlobalList:!0,realTime:!0,VERSION:1,
parameters:{},init:function(a,b){this._super(a,b);this.globals=a;this.gameManager=a.gameManager;this.onLocationMarkerCreatedBound=this.onLocationMarkerCreated.bind(this);this.onLocationMarkerDestroyedBound=this.onLocationMarkerDestroyed.bind(this);this.saveVersion=null;this.currentWarIndex=-1;this.campaignRegionInfoMap=null;this.campaignRegionMap={};this.warring=!1;this.activeCampaignRegionName=this.previousActiveCampaignArchetype=null;this.v3SpawnLocationMap={};this.v3CampaignStarterLocationMap=
{};this.campaignUIGroupId=null},activate:function(){this._super();var a=this.archetype.warTable.length-1;this.currentWarIndex>a&&(this.currentWarIndex=Math.min(this.currentWarIndex,a),this.campaignRegionInfoMap=null);a=this.gameManager.eventManager;a.subscribe("LocationMarkerCreated",this.onLocationMarkerCreatedBound);a.subscribe("LocationMarkerDestroyed",this.onLocationMarkerDestroyedBound);this.updateCampaignRegionSpawnLocations();this.saveVersion!==this.VERSION&&(this.currentWarIndex=-1,this.campaignRegionInfoMap=
null);this.initUI()},update:function(){if(this.hasNewHQIndex()||!this.isWarring()){this.endWar();var a=this.getHQIndex();this.beginWar(a,this.currentWarIndex===a)}},getHQIndex:function(){var a=this.gameManager,b=a.getFirstEntityWithEC("ECGameCritical"),c;if(b)c=b.getEC("ECBuilding").getLevel();else for(var b=a.getEntitiesWithEC("ECScaffold"),d=b.length,a=a.getEntityFactory(),f,e=0;e<d;e+=1)if(f=b[e],f=f.getEC("ECScaffold"),f=f.getPlannedObject(),f=a.getECArchetype(f,"ECBuilding"),"HQ"===f.buildingType){c=
f.level;break}return(c||1)-1},hasNewHQIndex:function(){return this.getHQIndex()!==this.currentWarIndex},initUI:function(){var a=this.globals.dynamicUI;if(a){var b=a.addGroup("Campaigns",null);this.campaignUIGroupId=b;this.addSelectWarUI(a,b);this.addSelectCampaignUI(a,b)}},addSelectWarUI:function(a,b){this.warArchetypeNameList=this.getOrderedListFromMap(Ua);a.watchVariable("Archetypes",this,"debugWarArchetypeName","select",b,{values:this.warArchetypeNameList});var c={value:"Set War",setValue:function(){if(this.debugWarArchetypeName){var a=
this.archetype.warTable.indexOf(this.debugWarArchetypeName);-1!==a&&(this.endWar(),this.beginWar(a))}}.bind(this)};a.watchVariable("",this,"debugWarArchetype","button",b,c)},addSelectCampaignUI:function(a,b){this.campaignArchetypeNameList=this.getOrderedListFromMap(ca);var c=function(){return Ua[this.archetype.warTable[this.currentWarIndex]].campaignList.map(function(a){return a.campaign})}.bind(this);a.watchVariable("Archetypes",this,"debugCampaignArchetypeName","select",b,{values:this.campaignArchetypeNameList,
getValue:c});c={value:"Set Campaign",setValue:function(){this.debugCampaignArchetypeName&&this.setAllCampaignRegions(this.debugCampaignArchetypeName)}.bind(this)};a.watchVariable("",this,"debugCampaignArchetype","button",b,c)},setAllCampaignRegions:function(a){this.endCampaignRegionBattles();var b=this.campaignRegionMap,c=this.v3SpawnLocationMap,d;for(d in b)b.hasOwnProperty(d)&&this.setCampaign(d,b,c[d],a)},getOrderedListFromMap:function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(c);b.sort();
return b},getCampaignArchetypeName:function(a){return this.campaignRegionMap[a].campaignArchetypeName},beginCampaign:function(a){var b=this.campaignRegionMap[a];this.activeCampaignRegionName=a;a=Na.getScoreInfo(b);b=this.gameManager.getScoreInfo();this.gameManager.eventManager.notify("CampaignStarted");b.onCampaignStarted(a)},getPreviousActiveCampaignArchetype:function(){return this.previousActiveCampaignArchetype},getActiveCampaignRegionName:function(){return this.activeCampaignRegionName},getActiveCampaignArchetypeName:function(){return this.getActiveCampaignRegionName()?
this.getCampaignArchetypeName(this.getActiveCampaignRegionName()):null},endCampaign:function(a,b){var c=this.getCampaignArchetypeName(a);this.previousActiveCampaignArchetype=ca[c];this.activeCampaignRegionName=null;var d=Ua[this.archetype.warTable[this.currentWarIndex]],c=d.campaignList,d=d.poolCampaignList,f=this.v3SpawnLocationMap[a],e;e=b?this.getNextCampaignInfo():this.campaignRegionInfoMap[a];var h=e.index;this.setCampaign(a,this.campaignRegionMap,f,e.fromPool?d[h].campaign:c[h].campaign);this.campaignRegionInfoMap[a]=
e;this.gameManager.eventManager.notify("CampaignEnded",b);this.gameManager.getScoreInfo().onCampaignEnded()},getNextCampaignInfo:function(){var a=this.campaignRegionInfoMap,b=Ua[this.archetype.warTable[this.currentWarIndex]],c=b.campaignList.length,b=b.poolCampaignList,d,f,e=0,h,i,j;for(j in a)if(a.hasOwnProperty(j))if(h=a[j],i=h.index,h=h.fromPool){d=!0;break}else e=Math.max(i+1,e);d||(e<c?(f=e,d=!1):d=!0);d&&(f=this.getRandomCampaignIndexFromPool(b,a),d=!0);return{index:f,fromPool:d}},getRandomCampaignIndexFromPool:function(a,
b){var c=a.length,d=[],f,e,h;for(h in b)b.hasOwnProperty(h)&&(f=b[h],e=f.index,(f=f.fromPool)&&-1===d.indexOf(e)&&d.push(e));return d.length===c?this.globals.mathDevice.randomIntInRange(0,c-1):this.getRandomIntInRangeButExclude(0,c-1,d)},getRandomIntInRangeButExclude:function(a,b,c){for(var d=[];a<b+1;a+=1)-1===c.indexOf(a)&&d.push(a);b=this.globals.mathDevice.randomIntInRange(0,d.length-1);return d[b]},isBattling:function(a){return Na.isBattling(this.campaignRegionMap[a])},isBossBattle:function(){var a=
this.activeCampaignRegionName,b=!1;a&&(a=this.campaignRegionMap[a])&&(b=Na.isBossBattle(a));return b},beginBattle:function(a){var b=this.gameManager;Na.beginBattle(this.campaignRegionMap[a]);b.eventManager.notify("InvasionStarted",{});b.invasionStart();this.globals.metricsManager.sendGameMetric("battleStarted_"+this.getBattleArchetypeName(a))},endBattle:function(a){var b=this.gameManager;Na.endBattle(this.campaignRegionMap[a]);b.invasionEnd()},getBattleArchetypeName:function(a){return this.campaignRegionMap[a].currentAttackWaveManager.archetypeName},
getActiveBattleArchetypeName:function(){return this.getBattleArchetypeName(this.getActiveCampaignRegionName())},isFirstBattle:function(a){return Na.isFirstBattle(this.campaignRegionMap[a])},setNextBattle:function(a){var b=this.campaignRegionMap[a];Na.endBattle(b);var c=this.globals.mathDevice,d=this.gameManager.getEntityFactory(),c=c.v3Copy(this.getv3Location());return Na.setNextBattle(b,this.v3SpawnLocationMap[a],c,d)},setCampaign:function(a,b,c,d){var f=this.gameManager.getEntityFactory();b[a]=
Na.createCampaignRegion(d,a,c,this.v3CampaignStarterLocationMap[a],f)},hasNextBattle:function(a){return Na.hasNextBattle(this.campaignRegionMap[a])},getCurrentBattleIndex:function(a){return Na.getCurrentBattleIndex(this.campaignRegionMap[a])},getNumberOfBattlesInCampaign:function(a){return Na.getNumberOfBattlesInCampaign(this.campaignRegionMap[a])},getNextBattleArchetypeQuantities:function(a){return Na.getNextBattleArchetypeQuantities(this.campaignRegionMap[a])},getNextBattleEnemyCount:function(a){return Na.getNextBattleEnemyCount(this.campaignRegionMap[a])},
getCurrentBattleKilledEnemyCount:function(a){return Na.getCurrentBattleKilledEnemyCount(this.campaignRegionMap[a])},isWarring:function(){return this.warring},endWar:function(){this.endCampaignRegionBattles()},endCampaignRegionBattles:function(){var a=this.campaignRegionMap,b,c;for(b in a)a.hasOwnProperty(b)&&(c=a[b],Na.endBattle(c))},beginWar:function(a,b){var c=Ua[this.archetype.warTable[a]];this.warring=!0;this.currentWarIndex=a;var d=c.campaignList,c=c.poolCampaignList;b||(this.campaignRegionInfoMap=
{});this.campaignRegionMap=this.initCampaignRegionMap(this.v3SpawnLocationMap,d,c,this.campaignRegionInfoMap)},initCampaignRegionMap:function(a,b,c,d){var f={},e;for(e in a)if(a.hasOwnProperty(e)){var h=a[e],i;i=d.hasOwnProperty(e)?d[e]:this.getNextCampaignInfo();var j=i.index;this.setCampaign(e,f,h,i.fromPool?c[j].campaign:b[j].campaign);d[e]=i}return f},updateCampaignRegionSpawnLocations:function(){var a=this.entity.getGameSpace().getEntitiesWithEC("ECLocationMarker"),b=a.length,c,d,f;for(f=0;f<
b;f+=1)if(c=a[f],d=c.getEC("ECLocationMarker")){c=d.getType();var e=d.getv3Location(),h=d.getLocationName();d=d.getGroupName();this.onLocationMarkerCreated(d,h,c,e)}},onLocationMarkerCreated:function(a,b,c,d){a===this.archetype.groupName&&("campaignStarter"===c?this.addV3CampaignStarterLocation(d,b):this.addV3SpawnLocation(d,b))},onLocationMarkerDestroyed:function(a,b,c,d){a===this.archetype.groupName&&("campaignStarter"===c?this.removeV3CampaignStarterLocation(d,b):this.removeV3SpawnLocation(d,b))},
addV3CampaignStarterLocation:function(a,b){this.v3CampaignStarterLocationMap[b]=this.globals.mathDevice.v3Copy(a)},removeV3CampaignStarterLocation:function(a,b){this.v3CampaignStarterLocationMap[b]=null},addV3SpawnLocation:function(a,b){var c=this.v3SpawnLocationMap,d=this.globals.mathDevice;c.hasOwnProperty(b)||(c[b]=[]);var c=c[b],f=c.length,e;for(e=0;e<f;e+=1)if(d.v3Equal(c[e],a))return;c.push(d.v3Copy(a))},removeV3SpawnLocation:function(a,b){var c=this.globals.mathDevice,d=this.v3SpawnLocationMap[b],
f=d.length,e;for(e=0;e<f;e+=1)if(c.v3Equal(d[e],a)){d.splice(e,1);break}},drawDebug:function(){var a=this.globals,b=a.debugDraw,c=[1,0,0],d=this.getv3Location();b.drawDebugPoint(d,c[0],c[1],c[2]);this.drawDebugSpawnPointLines([0.25,0,0]);this.drawDebugCampaignStarterLines([0.65,0,0]);var b=a.mathDevice,c=a.camera,f=b.v3Build(0,2,0),e=b.v3Build(0,1.5,0),d=b.v3Build(1,1,1),h=b.v3Build(1,1,0),f=c.worldToScreen(b.v3Add(this.getv3Location(),f)),e=c.worldToScreen(b.v3Add(this.getv3Location(),e)),i="WarManager : "+
this.entity.archetypeName,j="Current war: "+this.currentWarIndex.toString();if(f&&e){f={x:f[0],y:f[1],pointSize:16,alignment:1,r:d[0],g:d[1],b:d[2]};a=a.simpleFontRenderer;a.drawFontDouble(i,f);f.x=e[0];f.y=e[1];a.drawFontDouble(j,f);var k,e=this.campaignRegionMap,i=0.5;for(k in e)if(e.hasOwnProperty(k)){var l=e[k],j=l.currentBattleIndex,m=l.campaign.battleList.length;if(l=l.currentAttackWaveManager)if(j=k+": "+("invasion "+(j+1).toString()+"/"+m)+", "+("archetype: "+l.archetypeName),m=b.v3Build(0,
i,0),m=c.worldToScreen(b.v3Add(this.getv3Location(),m)))f.x=m[0],f.y=m[1],this.activeCampaignRegionName===k?(f.r=h[0],f.g=h[1],f.b=h[2]):(f.r=d[0],f.g=d[1],f.b=d[2]),a.drawFontDouble(j,f),i-=0.5}}},drawDebugSpawnPointLines:function(a){var b=this.v3SpawnLocationMap,c=this.getv3Location(),d;for(d in b)b.hasOwnProperty(d)&&this.debugDrawSpawnLocationList(c,b[d],a)},debugDrawSpawnLocationList:function(a,b,c){var d=this.globals.debugDraw,f=b.length,e;for(e=0;e<f;e+=1)d.drawDebugLine(a,b[e],c[0],c[1],c[2])},
drawDebugCampaignStarterLines:function(a){var b=this.globals.debugDraw,c=this.getv3Location(),d=this.v3CampaignStarterLocationMap,f;for(f in d)if(d.hasOwnProperty(f)){var e=d[f];e&&b.drawDebugLine(c,e,a[0],a[1],a[2])}},forceCampaignEnd:function(a){Na.forceEndCampaign(this.campaignRegionMap[a])},saveSerialize:function(a){return a?{}:{currentWarIndex:this.currentWarIndex,campaignRegionInfoMap:this.campaignRegionInfoMap,saveVersion:this.VERSION}},destroy:function(){this._super();var a=this.gameManager.eventManager;
a.unsubscribe("LocationMarkerCreated",this.onLocationMarkerCreatedBound);a.unsubscribe("LocationMarkerDestroyed",this.onLocationMarkerDestroyedBound);(a=this.globals.dynamicUI)&&a.destroy(this.campaignUIGroupId)}});Wh.create=function(a,b){return new Wh(a,b)};F.prototype.eCCreationMap[Wh.prototype.entityComponentName]=Wh;var ob=Ge.extend({entityComponentName:"ECWildlingAgent",updatePeriod:0.1,sortPriority:2,shouldUpdate:!0,shouldAlwaysUpdate:!0,shouldDraw:!0,shouldSerialize:!0,shouldDeltaSerialize:!1,
shouldSave:!1,parameters:{offlineResourcePerMinute:0,offlineBuildingAssistRate:0,offlineCanBuildMultipleBuildings:!1,offlineScaffoldType:"normal",canSleep:!0,offlineMinutesBeforeSleeping:480,offlineMinutesBeforeNeedingClick:1,onlineResourcePerMinute:10,buildingAssistRate:0,scaffoldHitEffect:"hitScaffold",scaffoldHitSpeechBubbleName:"speechScaffoldHit",orders:[],avoidanceForce:500,avoidanceForceDuration:0.5,recoveryDuration:{description:"Time (s) after attacking before agent is able to attack again",
type:"slider",minValue:0,maxValue:5},targetFocusDuration:{description:"Time (s) after being attacked before agent is able to switch targets",type:"slider",defaultValue:3,minValue:0,maxValue:60},priorityTargetType:"None",onlyAttackPriorityTargetType:!1,shouldAggroWhenAttacked:!0,maxAllyAggroDistance:3,maxNumberOfAlliesToAggroWhenAttacked:1,crashIntoSolidObjectStunDuration:0,growInitialize:!0,aggro:1,stunnable:!0},init:function(a,b){var c=a.mathDevice;this._super(a,b);this.scratchpad={};this.overlappingScaffold=
this.v3ResourceGatheringLocation=this.targetResourceDispenser=this.targetScaffold=this.targetOutpost=this.targetResourceDestination=null;this.rejectedScaffolds=[];this.rejectedScaffoldDuration=30;this.rejectedResourceDispensers=[];this.rejectedResourceDispenserDuration=60;this.leaderToFollow=null;this.waitingForClick=this.sleeping=!1;this.clickActionTarget=this.clickAction=null;this.clickActionSeconds=0;this.waitingForClickGUIArchetype=null;this.scaffoldAssistingRange=2.5;this.resourceDispenserActionRange=
2.82;this.wildlingHouse=this.scaffoldHitEffect=null;this.orders=this.createOrdersFromArchetype(this.archetype.orders);this.currentOrder=null;this.v3AvoidanceForce=c.v3BuildZero();this.avoidanceForceActive=!1;this.avoidanceForceDurationRemaining=0;this.resourceGatheringSetOffTime=this.globals.gameCurrentTime;this.hasGatheredResource=!1},createOrdersFromArchetype:function(a){var b=this.globals,c={},d=a.length,f,e;for(f=0;f<d;f+=1)(e=a[f])&&(c[e]=Ab.createFromName(e,b));return c},attach:function(a){var b=
this.gameManager.eventManager;this._super(a);this.combatStartedCallback=this.onCombatStart.bind(this);this.combatEndedCallback=this.onCombatEnd.bind(this);this.buildingUpgradeStartedCallback=this.onBuildingUpgradeStarted.bind(this);this.navGridUpdatedCallback=this.onNavGridUpdated.bind(this);b.subscribe("CombatStarted",this.combatStartedCallback);b.subscribe("CombatEnded",this.combatEndedCallback);b.subscribe("BuildingEvent",this.buildingUpgradeStartedCallback);b.subscribe("NavGridUpdated",this.navGridUpdatedCallback);
this.setInDanger(this.gameManager.isInCombat());this.attachOrders();(a=a.getEC("ECInteractable"))&&a.setOnInteractCallback(this.onInteract.bind(this))},attachOrders:function(){var a=this.orders,b;for(b in a)a.hasOwnProperty(b)&&a[b].attach(this)},canPerformOrder:function(a){var b=!1;this.orders[a]&&(b=!0);return b},canPerformOrderOnTarget:function(a,b){var c=!1,d=this.orders[a];d&&d.canDoOrder(b)&&(c=!0);return c},onToBeDestroyed:function(){var a=this.gameManager.eventManager;this._super();this.stopFollowingLeader();
a.unsubscribe("CombatStarted",this.combatStartedCallback);a.unsubscribe("CombatEnded",this.combatEndedCallback);a.unsubscribe("BuildingEvent",this.buildingUpgradeStartedCallback);a.unsubscribe("NavGridUpdated",this.navGridUpdatedCallback);this.wildlingHouse&&!this.wildlingHouse.toBeDestroyed&&this.wildlingHouse.getEC("ECWildlingHouse").setWildling(null)},destroy:function(){this.destroyOrders();this._super()},destroyOrders:function(){var a=this.orders,b=a.length,c,d;for(c=0;c<b;c+=1)(d=a[c])&&d.destroy();
a.length=0},update:function(){this.clearTargetResourceDestinationIfInvalid();this.clearTargetOutpostIfInvalid();this.clearTargetScaffoldIfInvalid();this.clearOverlappingScaffoldIfInvalid();this.clearTargetResourceDispenserIfInvalid();this.updateRejectedScaffolds();this.updateRejectedResourceDispensers();this._super();this.updateOrders();this.updateAvoidanceForce();this.applyLeanFactorToMesh()},updateActions:function(){this.isSleeping()||this.isWaitingForClick()?this.abortCurrentAction():this._super()},
chooseNewAction:function(a){return this.isSleeping()||this.isWaitingForClick()?void 0:this._super(a)},draw:function(){var a=this.gameManager;a.isPaused()||(this.isWaitingForClick()&&this.waitingForClickGUIArchetype&&this.canBeClicked()?(a=a.getGuiManager())&&a.addDrawGui(this.waitingForClickGUIArchetype,{v3WorldLocation:this.getv3Location(),layer:-2},"idECWildlingAgentWaitingForClick"+this.entity.getName()):this.isSleeping()&&this.entity.drawWorldText("Zzz...",0))},drawDebug:function(){var a=this.globals.debugDraw,
b=0,c=this.getLeaderToFollow();this._super();c&&!c.shouldBeDestroyed()&&a.drawDebugLine(this.getv3Location(),c.getv3Location(),1,0,1);this.entity.drawWorldText("Current Order: "+(this.currentOrder?this.currentOrder.orderName:"none"),b,1,1,1);b+=1;this.isSleeping()?(this.entity.drawWorldText("Current Status: Asleep",b,1,1,1),b+=1):this.isWaitingForClick()&&(this.entity.drawWorldText("Current Status: Waiting For Click",b,1,1,1),b+=1);this.isInDanger()&&this.entity.drawWorldText("In Danger!",b,1,1,1)},
updateOrders:function(){var a=this.getCurrentOrder();a&&a.update()&&this.endCurrentOrder()},updateAvoidanceForce:function(){this.isAvoidanceForceActive()&&(this.avoidanceForceDurationRemaining-=this.getTimeSinceLastUpdate(),0>=this.avoidanceForceDurationRemaining?this.stopAvoidanceForce():this.applyAvoidanceForce())},onImpact:function(a){var b=this.globals.mathDevice,c=this.scratchpad,d=this.getAvoidanceForceStrength(),f,e;this._super(a);a&&(a.hasEC("ECWildlingAgent")&&!this.isAvoidanceForceActive())&&
(f=this.getEntityEC("ECLocomotion"),e=a.getEC("ECLocomotion"),f&&e&&(f=f.getDesiredNormalizedDirection(),e=e.getDesiredNormalizedDirection(),-1E-4>b.v3Dot(f,e)&&(c.v3DirectionToOtherWildling=b.v3Sub(a.getv3Location(),this.getv3Location(),c.v3DirectionToOtherWildling),1E-4<b.v3Dot(f,c.v3DirectionToOtherWildling)&&(c.v3Right=b.v3Build(f[2],0,-f[0],c.v3Right),c.v3AvoidanceForce=0<b.v3Dot(c.v3Right,c.v3DirectionToOtherWildling)?b.v3ScalarMul(c.v3Right,-d,c.v3AvoidanceForce):b.v3ScalarMul(c.v3Right,d,
c.v3AvoidanceForce),this.startAvoidanceForce(c.v3AvoidanceForce)))))},onInteract:function(a){var b=Ob.wildlingHeroFollowingEnabled,c=!1;this.isSleeping()&&(b=!1,this.wakeUp(),this.gameManager.getEventManager().notify("WildlingWokenUp",{wokenEntity:this.entity}),c=!0);this.isWaitingForClick()&&this.canBeClicked()&&(b=!1,this.stopWaitingForClick(),c=!1);c&&this.gameManager.guiManager.addSpeechBubble(this.getv3Location(),"speechWakeUp");b&&(a&&a.hasEC("ECWildlingLeader"))&&(a===this.getLeaderToFollow()?
(this.stopFollowingLeader(),this.gameManager.guiManager.addSpeechBubble(this.getv3Location(),"speechStopFollowing")):this.startFollowingLeader(a))},getAvoidanceForceStrength:function(){return this.archetype.avoidanceForce},getAvoidanceForceDuration:function(){return this.archetype.avoidanceForceDuration},isAvoidanceForceActive:function(){return this.avoidanceForceActive},startAvoidanceForce:function(a){this.v3AvoidanceForce=this.globals.mathDevice.v3Copy(a);this.avoidanceForceActive=!0;this.avoidanceForceDurationRemaining=
this.getAvoidanceForceDuration()},stopAvoidanceForce:function(){this.avoidanceForceActive=!1;this.avoidanceForceDurationRemaining=0},applyAvoidanceForce:function(){var a=this.getEntityEC("ECPhysicsSphere");a&&a.applyForce(this.v3AvoidanceForce)},applyLeanFactorToMesh:function(a){var b=this.leanFactor;a&&!b&&(b=0);if(a||b)if(a=this.getEntityEC("ECLocomotion"))a.setAdditionalX(0.75*b),a.setAdditionalY(0.5*b)},beginHittingBuilding:function(){this.beginHittingSomething(this.hitTargetScaffold.bind(this))},
beginFakeHittingBuilding:function(){this.beginHittingSomething(this.fakeHitTargetScaffold.bind(this))},beginHittingSomething:function(a,b){var c=this;void 0===b&&(b=1);this.isHittingSomething()||(this.previousUpdatePeriod=this.updatePeriod,this.setUpdatePeriod(0),this.swingRecoverTween=G.Create({leanFactor:-1.5}).to({leanFactor:0},0.55*b).easing(G.Easing.Circular.InOut).onUpdate(function(){c.leanFactor=this.leanFactor}).onComplete(function(){c.swingRecoverTween=void 0;c.leanFactor=void 0;void 0!==
c.previousUpdatePeriod&&(c.setUpdatePeriod(c.previousUpdatePeriod),c.previousUpdatePeriod=void 0)}),this.swingForwardTween=G.Create({leanFactor:1}).to({leanFactor:-1.5},0.3*b).easing(G.Easing.Circular.InOut).onUpdate(function(){c.leanFactor=this.leanFactor}).onComplete(function(){c.swingForwardTween=void 0;a&&a()}).chain(this.swingRecoverTween),this.swingBackTween=G.Create({leanFactor:0}).to({leanFactor:1},0.15*b).easing(G.Easing.Circular.Out).onUpdate(function(){c.leanFactor=this.leanFactor}).onComplete(function(){c.swingBackTween=
void 0}).chain(this.swingForwardTween).start())},isHittingSomething:function(){var a=!1;if(this.swingBackTween||this.swingForwardTween||this.swingRecoverTween)a=!0;return a},stopHittingSomething:function(){this.swingBackTween&&(this.swingBackTween.stop(),this.swingBackTween=void 0);this.swingForwardTween&&(this.swingForwardTween.stop(),this.swingForwardTween=void 0);this.swingRecoverTween&&(this.swingRecoverTween.stop(),this.swingRecoverTween=void 0);void 0!==this.previousUpdatePeriod&&(this.setUpdatePeriod(this.previousUpdatePeriod),
this.previousUpdatePeriod=void 0);this.leanFactor=void 0;this.applyLeanFactorToMesh(!0)},getWildlingHouse:function(){return this.wildlingHouse},setWildlingHouse:function(a){this.wildlingHouse!==a&&(this.wildlingHouse=a)},clearWildlingHouse:function(){this.wildlingHouse=null},getWildlingHouseScaffold:function(){return this.wildlingHouseScaffold},clearTargetEntity:function(){this._super();this.clearTargetResourceDestination();this.clearTargetScaffold();this.clearTargetOutpost();this.clearTargetResourceDispenser();
this.stopFollowingLeader()},clearTargetResourceDestinationIfInvalid:function(){var a=this.targetResourceDestination;a&&(a.toBeDestroyed||!this.isCarryingResource(E.LUMBER)&&!this.isCarryingResource(E.STONE))&&this.clearTargetResourceDestination()},isCarryingResource:function(a){var b=!1,c;(c=this.getEntityEC("ECResourceCarrier"))&&0<c.getResource(a)+c.getInboundResource(a)&&(b=!0);return b},canCarryMoreResource:function(a){var b=this.entity,c=!1;b&&(b=b.getEC("ECResourceCarrier"))&&!b.isFull(a)&&
(c=!0);return c},hasHitResourceCap:function(a){var b=!1,c=this.gameManager.getPlayerData();c&&c.getResource(a)>=c.getResourceCap(a)&&(b=!0);return b},simulateResourceGathering:function(){var a,b,c,d;if(this.hasGatheredResource&&(b=this.getEntityEC("ECResourceCarrier")))a=this.globals.gameCurrentTime-this.resourceGatheringSetOffTime,d=this.archetype.onlineResourcePerMinute/60,c=Math.floor(d*a),a-=c/d,b.simulateResourceGathering(c),this.resourceGatheringSetOffTime=this.globals.gameCurrentTime-a,this.hasGatheredResource=
!1},clearTargetResourceDispenserIfInvalid:function(){this.getTargetResourceDispenser()&&!this.isTargetResourceDispenserValid()&&this.clearTargetResourceDispenser()},isTargetResourceDispenserValid:function(){var a=this.getTargetResourceDispenser(),b,c=!1;if(a){c=!0;if(a.shouldBeDestroyed())c=!1;else{b=a.getEC("ECResourceDispenser");if(!b||0>=b.getResource())c=!1;c&&this.hasHitResourceCap(b.getResourceType())&&(c=!1)}c&&(a=this.getEntityEC("ECResourceCarrier"))&&a.isFull(b.getResourceType())&&(c=!1)}return c},
rejectScaffold:function(a){this.rejectEntity(a,this.rejectedScaffolds)},rejectResourceDispenser:function(a){this.rejectEntity(a,this.rejectedResourceDispensers)},rejectEntity:function(a,b){this.isEntityRejected(a,b)||b.push({entity:a,timeRejected:this.globals.gameCurrentTime})},isScaffoldRejected:function(a){return this.isEntityRejected(a,this.rejectedScaffolds)},isResourceDispenserRejected:function(a){return this.isEntityRejected(a,this.rejectedResourceDispensers)},isEntityRejected:function(a,b){var c,
d=b.length,f=!1;if(a)for(c=0;c<d;c+=1)if(b[c].entity===a){f=!0;break}return f},updateRejectedScaffolds:function(){this.updateRejectedList(this.rejectedScaffolds,this.rejectedScaffoldDuration,this.isValidScaffold.bind(this))},updateRejectedResourceDispensers:function(){this.updateRejectedList(this.rejectedResourceDispensers,this.rejectedResourceDispenserDuration)},updateRejectedList:function(a,b,c){for(var d,f=this.globals.gameCurrentTime-b,b=0;b<a.length;)d=a[b],d.timeRejected<f||c&&!c(d.entity)?
a.splice(b,1):b+=1},clearRejectedScaffolds:function(){this.clearRejectedList(this.rejectedScaffolds)},clearRejectedResourceDispensers:function(){this.clearRejectedList(this.rejectedResourceDispensers)},clearRejectedList:function(a){a.length=0},onNavGridUpdated:function(){this.clearRejectedScaffolds();this.clearRejectedResourceDispensers()},clearTargetScaffoldIfInvalid:function(){var a=this.getTargetScaffold();a&&!this.isValidScaffold(a)&&this.clearTargetScaffold()},isValidScaffold:function(a){var b=
!1;a&&!a.shouldBeDestroyed()&&(b=!0,(a=a.getEC("ECUpgrader"))&&!a.isUpgrading()&&(b=!1));return b},clearOverlappingScaffoldIfInvalid:function(){var a=this.overlappingScaffold,b=!1;if(a&&!a.shouldBeDestroyed()&&(a=a.getEC("ECScaffold")))(a=a.getObjectOverlappingPhysicsCube())&&a.entity===this.entity&&(b=!0);b||(this.overlappingScaffold=null)},updateTargetResourceDestination:function(a){var b=this.gameManager.getFactionManager(),c=this.targetResourceDestination,d=this.entity;!c&&b&&(c=b.getNearestFriendlyResourceDestination(d,
a));return this.targetResourceDestination=c},getTargetResourceDestination:function(){return this.targetResourceDestination},clearTargetResourceDestination:function(){this.targetResourceDestination=null},updateTargetOutpost:function(){var a=this.gameManager,b=a.getFactionManager(),c=this.targetOutpost,a=a.getHero();!c&&(b&&a)&&(c=b.getNearestFriendlyOutpost(a));return this.targetOutpost=c},getTargetOutpost:function(){return this.targetOutpost},clearTargetOutpost:function(){this.targetOutpost=null},
clearTargetOutpostIfInvalid:function(){var a=this.getTargetOutpost();a&&a.toBeDestroyed&&this.clearTargetOutpost()},updateTargetScaffold:function(a){this.getTargetScaffold()||this.setTargetScaffold(this.getNearestValidScaffold(this.getv3Location(),a));return this.getTargetScaffold()},getNearestScaffoldToSpeedUp:function(a,b){var c=this.globals.mathDevice,d=this.gameManager.getBuildingManager(),f,e,h,i,j=null,k=null,l=Infinity,m;if(d&&a){f=d.getScaffolds(b);h=f.length;for(e=0;e<h;e+=1)if((i=f[e])&&
!i.getHasBuilder()&&0>=i.buildDelay&&0<i.getBuildTimeRemaining()-i.extraBuildTimeThisFrame&&!this.isScaffoldRejected(i.entity))m=c.v3DistanceSq(i.getv3Location(),a),m<l&&(j=i,l=m);d=d.getUpgraders(b);e=d.length;for(f=0;f<e;f+=1)if((h=d[f])&&h.isUpgrading()&&!h.getHasBuilder()&&0<h.getUpgradeTimeRemaining()-h.extraUpgradeTimeThisFrame&&!this.isScaffoldRejected(h.entity))m=c.v3DistanceSq(h.getv3Location(),a),m<l&&(k=h,l=m)}return k?k.entity:j?j.entity:null},getNearestValidScaffold:function(a,b,c){var d=
this.globals.mathDevice,f=this.gameManager.getBuildingManager(),e,h,i,j,k=null,l=null,m=Infinity,q;if(f&&a){e=f.getScaffolds(b);i=e.length;for(h=0;h<i;h+=1)if((j=e[h])&&!j.getHasBuilder()&&0>=j.buildDelay&&(!c||!j.getHasOfflineBuilder())&&(j.shouldDelayBuildingUntilBuilderPresent()||0<=j.getBuildTimeRemaining())&&!this.isScaffoldRejected(j.entity))q=d.v3DistanceSq(j.getv3Location(),a),q<m&&(k=j,m=q);b=f.getUpgraders(b);e=b.length;for(f=0;f<e;f+=1)if((h=b[f])&&h.isUpgrading()&&!h.getHasBuilder()&&
(!c||!h.getHasOfflineBuilder())&&0<=h.getUpgradeTimeRemaining()&&!this.isScaffoldRejected(h.entity))q=d.v3DistanceSq(h.getv3Location(),a),q<m&&(l=h,m=q)}return l?l.entity:k?k.entity:null},levelContainsBuildingsInProgress:function(a){var b=this.gameManager.getBuildingManager(),c=!1;if(a&&b&&(0<b.getNumScaffolds(a)||0<b.getNumUpgraders(a)))c=!0;return c},getTargetScaffold:function(){return this.targetScaffold},setTargetScaffold:function(a,b){var c;if(this.targetScaffold!==a&&(b||!a||this.isValidTargetScaffold(a))){if(this.targetScaffold&&
!this.targetScaffold.shouldBeDestroyed()){if(c=this.targetScaffold.getEC("ECScaffold"))c.setHasBuilder(!1),c.setHasOfflineBuilder(!1);if(c=this.targetScaffold.getEC("ECUpgrader"))c.setHasBuilder(!1),c.setHasOfflineBuilder(!1)}if((this.targetScaffold=a)&&!a.shouldBeDestroyed()){if(c=a.getEC("ECScaffold"))c.setHasBuilder(!0),c.setHasOfflineBuilder(!0);if(c=a.getEC("ECUpgrader"))c.setHasBuilder(!0),c.setHasOfflineBuilder(!0)}}},isValidTargetScaffold:function(a){var b,c=!1;a&&!a.shouldBeDestroyed()&&
((b=a.getEC("ECScaffold"))&&!b.getHasBuilder()?c=!0:(a=a.getEC("ECUpgrader"))&&!a.getHasBuilder()&&(c=!0));return c},clearTargetScaffold:function(){this.setTargetScaffold(null)},isWithinRangeOfTargetScaffold:function(){var a=this.getTargetScaffold(),b=this.entity,c=this.getScaffoldAssistingRange(),d=!1;a&&(!a.toBeDestroyed&&b&&!b.toBeDestroyed)&&(c+=a.getRadius(),d=b.getDistanceSqUsingSize(a.getv3Location())<c*c);return d},getScaffoldAssistingRange:function(){return this.scaffoldAssistingRange},fakeHitTargetScaffold:function(){this.hitTargetScaffold(0)},
hitTargetScaffold:function(a){var b=this.globals.mathDevice,c=this.gameManager.actionManager,d=this.getTargetScaffold(),f;void 0===a&&(a=this.getBuildingAssistRate());if(d&&!d.toBeDestroyed&&(f=d.getEC("ECScaffold"),d=d.getEC("ECUpgrader"),f||d))0<a&&(f&&f.reduceRemainingBuildTime(a),d&&d.reduceRemainingUpgradeTime(a)),c&&(a=this.getScaffoldHitEffect(),c.addAction("SpecialEffect",{archetype:a,v3Location:b.v3Copy(this.getv3Location())}))},reduceTargetScaffoldBuildTime:function(a){var b=this.getTargetScaffold(),
c;b&&(!b.toBeDestroyed&&0<a)&&((c=b.getEC("ECScaffold"))&&c.reduceRemainingBuildTime(a),(b=b.getEC("ECUpgrader"))&&b.reduceRemainingUpgradeTime(a))},showScaffoldHitSpeechBubble:function(a){var b=this.getScaffoldHitSpeechBubbleName(),a="-"+Math.max(Math.floor(a),1);b&&this.gameManager.guiManager.addSpeechBubble(this.getv3Location(),b,a)},getScaffoldHitSpeechBubbleName:function(){return this.archetype.scaffoldHitSpeechBubbleName},getScaffoldHitEffect:function(){return this.archetype.scaffoldHitEffect},
getBuildingAssistRate:function(){return this.archetype.buildingAssistRate},getOfflineActionData:function(a){var b=ob.offlineActions,c=b.none,d=null,f=0,e=this.getTargetScaffold(),h={};if(this.isWaitingForClick())c=this.clickAction,d=this.clickActionTarget,f=this.clickActionSeconds;else if(e||this.canBuildMultipleBuildingsOffline())c=b.assistWithBuilding,d=e;else if(a&&0<this.getOnlineResourcePerMinute()||!a&&0<this.getOfflineResourcePerMinute())c=b.generateResource,d=null;h.offlineAction=c;h.offlineActionTarget=
d;h.offlineActionAdditionalSeconds=f;return h},canSleep:function(){return this.archetype.canSleep},getOfflineMinutesBeforeSleeping:function(){return this.archetype.offlineMinutesBeforeSleeping},getOfflineMinutesBeforeNeedingClick:function(){return this.archetype.offlineMinutesBeforeNeedingClick},getOfflineBuildingAssistRate:function(){return this.archetype.offlineBuildingAssistRate},canBuildMultipleBuildingsOffline:function(){return this.archetype.offlineCanBuildMultipleBuildings},getOfflineScaffoldType:function(){return this.archetype.offlineScaffoldType},
getOfflineResourcePerMinute:function(){return this.archetype.offlineResourcePerMinute},getOnlineResourcePerMinute:function(){return this.archetype.onlineResourcePerMinute},beginOfflineAction:function(a,b,c){var d=ob.offlineActions,f=this.canSleep(),e=60*this.getOfflineMinutesBeforeSleeping(),h=60*this.getOfflineMinutesBeforeNeedingClick();if(a&&(a!==d.none&&0<c)&&(f&&c>=e&&(c=e,this.fallAsleep()),this.isOfflineActionValid(a,b,c)))switch(a){case d.generateResource:c>=h?this.startWaitingForClick(a,
b,c):this.generateOfflineResource(c,!1);break;case d.assistWithBuilding:b&&!b.shouldBeDestroyed()&&(this.canBuildMultipleBuildingsOffline()?this.speedUpOfflineScaffolds(this.getOfflineScaffoldType(),b,c):c>=h&&c>=this.getScaffoldTimeRemaining(b)?(this.startWaitingForClick(a,b,c),this.tellScaffoldToFinishWhenBuilderClicked(b)):this.speedUpOfflineScaffold(b,c),this.isSleeping()||(this.teleportNextToEntity(b),this.setTargetScaffold(b)))}},attemptOfflineBuilding:function(a,b){var c,d;a&&0<b&&(c=this.getNearestValidScaffold(this.getv3Location(),
a,!0));if(c&&!c.shouldBeDestroyed()){this.beginOfflineAction(ob.offlineActions.assistWithBuilding,c,b);if(d=c.getEC("ECScaffold"))d.setHasBuilder(!0),d.setHasOfflineBuilder(!0);if(c=c.getEC("ECUpgrader"))c.setHasBuilder(!0),c.setHasOfflineBuilder(!0)}},isOfflineActionValid:function(a,b,c){var d=ob.offlineActions,f=!1;if(a)switch(a){case d.generateResource:0<Math.floor(c*this.getOfflineResourcePerMinute()/60)&&(f=!0);break;case d.assistWithBuilding:b&&(!b.offlineActionTarget&&0<this.getOfflineBuildingAssistRate())&&
(b.hasEC("ECScaffold")?f=!0:(a=b.getEC("ECUpgrader"))&&a.isUpgrading()&&(f=!0))}return f},getScaffoldTimeRemaining:function(a){var b=0,c;a&&!a.shouldBeDestroyed()&&((c=a.getEC("ECScaffold"))?b=c.getBuildTimeRemaining():(a=a.getEC("ECUpgrader"))&&(b=a.getUpgradeTimeRemaining()));return b},tellScaffoldToFinishWhenBuilderClicked:function(a){var b;a&&!a.shouldBeDestroyed()&&((b=a.getEC("ECScaffold"))?b.finishBuildingWhenBuilderClicked():(a=a.getEC("ECUpgrader"))&&a.finishUpgradingWhenBuilderClicked());
return 0},manageLargeTimeStep:function(a){var b=ob.offlineActions,c=this.getOfflineActionData(!0),d=c.offlineAction,c=c.offlineActionTarget,f=this.canSleep(),e=60*this.getOfflineMinutesBeforeSleeping();if(d&&!this.isSleeping()&&!this.isWaitingForClick())switch(f&&a>=e&&(a=e,this.teleportHome(),this.fallAsleep()),d){case b.generateResource:this.generateOnlineResource(a,!1);break;case b.assistWithBuilding:this.speedUpOnlineScaffold(c,a)}},doOfflineClickAction:function(a,b,c){var d=ob.offlineActions;
switch(a){case d.generateResource:this.generateOfflineResource(c,!0);break;case d.assistWithBuilding:this.speedUpOfflineScaffold(b,c)}},getOfflineActionGUIArchetype:function(a,b){var c=ob.offlineActions,d=null;switch(a){case c.generateResource:c=this.getPrimaryResourceType();switch(c){case E.LUMBER:d="welcomeLumber";break;case E.STONE:d="welcomeStone"}break;case c.assistWithBuilding:switch(c=this.getScaffoldType(b),c){case "normal":d="welcomeBuilding";break;case "war":d="welcomeDefences"}}return d},
getPrimaryResourceType:function(){var a=this.getEntityEC("ECResourceCarrier"),b,c=null;a&&(b=a.getResourceCap(E.LUMBER),a=a.getResourceCap(E.STONE),b>a?c=E.LUMBER:0<a&&(c=E.STONE));return c},getScaffoldType:function(a){var b,c=null;a&&((b=a.getEC("ECScaffold"))&&(c=b.getScaffoldType()),c||(a=a.getEC("ECUpgrader"))&&(c=a.getScaffoldType()));return c},generateOnlineResource:function(a,b){this.generateResource(a,b,this.getOnlineResourcePerMinute(),!0)},generateOfflineResource:function(a,b){this.generateResource(a,
b,this.getOfflineResourcePerMinute())},generateResource:function(a,b,c,d){var f=this.gameManager,a=Math.floor(a/60*c),e,c=f.getGuiManager(),f=f.getPlayerData(),h=0,i,j;if(0<a&&f&&(j=this.getEntityEC("ECResourceCarrier"))){for(i=0;i<E.NUM_RESOURCES;i+=1)h+=j.getResourceCap(i);for(i=0;i<E.NUM_RESOURCES;i+=1)e=Za[i].offlineResourceGenerationScale,e=Math.floor(a*e*(j.getResourceCap(i)/h)),b?this.generateAndDepositResourcePickups(i,e):(f.adjustResource(i,e),!d&&(c&&e)&&c.addResourceBubble(this.getv3Location(),
e,i))}},generateAndDepositResourcePickups:function(a,b){var c;0<b&&(c=this.getEntityEC("ECResourceCarrier"))&&c.generateAndDepositResource(a,b)},speedUpOnlineScaffolds:function(a,b,c){this.speedUpScaffolds(a,b,c,this.getBuildingAssistRate())},speedUpOfflineScaffolds:function(a,b,c){this.speedUpScaffolds(a,b,c,this.getOfflineBuildingAssistRate())},speedUpScaffolds:function(a,b,c,d){var c=c*d,f,d=this.getv3Location(),e=0;a||(a="normal");b&&(!b.shouldBeDestroyed()&&0<c)&&(f=this.getScaffoldBuildTimeRemaining(b),
f=Math.min(f,c),0<f&&(this.speedUpScaffold(b,f,1),c-=f,e+=1));for(;0<c&&20>e;)if((b=this.getNearestScaffoldToSpeedUp(d,a))&&!b.shouldBeDestroyed())f=this.getScaffoldBuildTimeRemaining(b),f=Math.min(f,c),0<f&&(this.speedUpScaffold(b,f,1),c-=f,e+=1);else break},getScaffoldBuildTimeRemaining:function(a){var b=0,c;a&&!a.shouldBeDestroyed()&&((c=a.getEC("ECScaffold"))?b=c.getBuildTimeRemaining():(a=a.getEC("ECUpgrader"))&&(b=a.getUpgradeTimeRemaining()));return b},speedUpOnlineScaffold:function(a,b){this.speedUpScaffold(a,
b,this.getBuildingAssistRate())},speedUpOfflineScaffold:function(a,b){this.speedUpScaffold(a,b,this.getOfflineBuildingAssistRate())},speedUpScaffold:function(a,b,c){if(a&&!a.shouldBeDestroyed()&&(b=Math.floor(b*c),0<b)){if(c=a.getEC("ECScaffold"))c.hasStartedBuilding()||c.startBuilding(),c.reduceRemainingBuildTime(b);(a=a.getEC("ECUpgrader"))&&a.reduceRemainingUpgradeTime(b)}},teleportHome:function(){var a=this.getWildlingHouse();a||(a=this.getWildlingHouseScaffold());a&&this.teleportNextToEntity(a)},
teleportNextToEntity:function(a){var b=this.globals.mathDevice,c=this.entity,d;if(a&&(d=a.getv3Location(),d=b.v3Copy(d),d[2]-=a.getRadius()+c.getRadius()+0.1,d[1]+=1,a=b.v3BuildZero(),c.teleport(d,a),c=c.getEC("ECLocomotion")))c.clearDestination(),c.clearDestinationEntity()},updateTargetResourceDispenser:function(a){var b=this.gameManager.getResourceDispenserManager(a),c;this.getTargetResourceDispenser()||(this.hasHitResourceCap(a)||((a=this.getv3ResourceGatheringLocation())||(a=this.getv3Location()),
c=b.getNearestValidResourceDispenser(a,this.entity)),c?this.setTargetResourceDispenser(c.entity):this.clearTargetResourceDispenser());return this.getTargetResourceDispenser()},getTargetResourceDispenser:function(){return this.targetResourceDispenser},setTargetResourceDispenser:function(a){var b=this.gameManager,c,d;this.clearTargetResourceDispenser();if(a&&!a.shouldBeDestroyed()&&(c=a.getEC("ECResourceDispenser")))d=c.getResourceType(),this.targetResourceDispenser=a,c.claimResource(this.getResourcePerInteract(d)),
b=b.getResourceDispenserManager(d),b.claimResourceDispenser(a,this.entity)},clearTargetResourceDispenser:function(){var a=this.gameManager,b,c,d=this.targetResourceDispenser;if(d&&!d.shouldBeDestroyed()&&(b=d.getEC("ECResourceDispenser")))c=b.getResourceType(),b.claimResource(-this.getResourcePerInteract(c)),a=a.getResourceDispenserManager(c),a.unclaimResourceDispenser(d,this.entity);this.targetResourceDispenser=null},getResourceDispenserActionRange:function(){return this.resourceDispenserActionRange},
isWithinRangeOfTargetResourceDispenser:function(){var a=this.getTargetResourceDispenser(),b=this.entity,c=this.getResourceDispenserActionRange(),d=!1;a&&b&&(a=a.get2DDistanceUsingSize(b.getv3Location()),d=a<c);return d},getResourcePerInteract:function(){var a=0,b=this.getEntityEC("ECResourceDispenser");b&&(a=b.getResourcePerInteract());return a},interactWithTargetResourceDispenser:function(){var a=this.getTargetResourceDispenser(),b=0;if(a&&(a=a.getEC("ECResourceDispenser")))b=a.onInteract(this.entity),
this.hasGatheredResource=!0;return b},getv3ResourceGatheringLocation:function(){return this.v3ResourceGatheringLocation},setv3ResourceGatheringLocation:function(a){var b;a?(b=this.globals.mathDevice,this.v3ResourceGatheringLocation=this.v3ResourceGatheringLocation?b.v3Copy(a,this.v3ResourceGatheringLocation):b.v3Copy(a)):this.v3ResourceGatheringLocation=null},clearv3ResourceGatheringLocation:function(){this.v3ResourceGatheringLocation=null},startFollowingLeader:function(a){a!==this.leaderToFollow&&
(this.stopFollowingLeader(),a&&(this.gameManager.guiManager.addSpeechBubble(this.getv3Location(),"speechExclaim"),this.getCurrentOrder()?this.endCurrentOrder():(this.abortCurrentAction(),this.clearTargetEntity()),this.leaderToFollow=a,(a=a.getEC("ECWildlingLeader"))&&a.addFollower(this.entity)))},stopFollowingLeader:function(){var a;this.leaderToFollow&&(this.leaderToFollow.toBeDestroyed||(a=this.leaderToFollow.getEC("ECWildlingLeader"))&&a.removeFollower(this.entity),this.leaderToFollow=null)},getLeaderToFollow:function(){return this.leaderToFollow},
giveOrder:function(a,b){var c=this.orders[a],d;this.endCurrentOrder();c&&(this.currentOrder=c,this.abortCurrentAction(),this.clearTargetEntity(),(d=c.getSpeechBubbleName())&&this.gameManager.guiManager.addSpeechBubble(this.getv3Location(),d),c.begin(b))},getCurrentOrder:function(){return this.currentOrder},endCurrentOrder:function(){this.currentOrder&&(this.abortCurrentAction(),this.clearTargetEntity(),this.currentOrder.end());this.currentOrder=null},fallAsleep:function(){var a;if(!this.isSleeping()&&
this.canSleep()&&(this.sleeping=!0,this.clearTargetEntity(),a=this.getEntityEC("ECLocomotion")))a.clearDestination(),a.clearDestinationEntity(),a.setActive(!1),a.setAdditionalX(0.5*Math.PI)},wakeUp:function(){var a;if(this.isSleeping()&&(this.sleeping=!1,!this.isWaitingForClick()&&(a=this.getEntityEC("ECLocomotion"))))a.setActive(!0),a.setAdditionalX(0)},isSleeping:function(){return this.sleeping},startWaitingForClick:function(a,b,c){if(!this.isWaitingForClick()&&this.isOfflineActionValid(a,b,c)&&
(this.waitingForClick=!0,this.clearTargetEntity(),this.clickAction=a,this.clickActionTarget=b,this.clickActionSeconds=c,this.waitingForClickGUIArchetype=this.getOfflineActionGUIArchetype(a,b),a=this.getEntityEC("ECLocomotion")))a.clearDestination(),a.clearDestinationEntity(),a.setActive(!1)},stopWaitingForClick:function(){var a=this.gameManager.getGameSoundManager(),b;if(this.isWaitingForClick()){this.waitingForClick=!1;if(!this.isSleeping()&&(b=this.getEntityEC("ECLocomotion")))b.setActive(!0),b.setAdditionalX(0);
a&&a.play("speechWelcomeBack",this.getv3Location());this.doOfflineClickAction(this.clickAction,this.clickActionTarget,this.clickActionSeconds);this.clickActionTarget=this.clickAction=null;this.clickActionSeconds=0;this.waitingForClickGUIArchetype=null}},isWaitingForClick:function(){return this.waitingForClick},canBeClicked:function(){var a=!1;this.gameManager.getPlayFlags().wildlingsCanWork&&!this.isInDanger()&&(a=!0);return a},isInDanger:function(){return this.inDanger},setInDanger:function(a){if(a!==
this.inDanger&&(this.inDanger=a))this.abortCurrentAction(),this.clearTargetEntity()},onCombatStart:function(){this.setInDanger(!0);(this.isWaitingForClick()||this.isSleeping())&&this.hideInsideHouse()},onCombatEnd:function(){this.setInDanger(!1)},getOverlappingScaffold:function(){return this.overlappingScaffold},onBlockingScaffold:function(a){a&&(!a.shouldBeDestroyed()&&!this.overlappingScaffold)&&(this.overlappingScaffold=a,this.abortCurrentAction())},onBuildingUpgradeStarted:function(a){"upgradeStarted"===
a.reason&&(this.wildlingHouse&&a.building===this.wildlingHouse)&&(this.wildlingHouseScaffold=a.scaffold,this.abortCurrentAction(),this.clearTargetEntity())},hideInsideHouse:function(){var a=this.getWildlingHouse();a&&!a.shouldBeDestroyed()&&(a=a.getEC("ECWildlingHouse"))&&a.hideWildling(this.entity)},canGatherResource:function(a){var b,c=!0;b=this.gameManager.getPlayFlags();this.isInDanger()||!b.wildlingsCanWork?c=!1:(b=this.getCurrentOrder())&&!b.canGatherResource(a)&&(c=!1);return c},canAssistWithBuilding:function(){var a,
b=!0;a=this.gameManager.getPlayFlags();this.isInDanger()||!a.wildlingsCanWork?b=!1:(a=this.getCurrentOrder())&&!a.canAssistWithBuilding()&&(b=!1);return b}});ob.offlineActions={none:0,generateResource:1,assistWithBuilding:2};F.prototype.eCCreationMap[ob.prototype.entityComponentName]=ob;ob.create=function(a,b){return new ob(a,b)};var Xh=F.extend({entityComponentName:"ECWildlingHouse",updatePeriod:3,sortPriority:4,shouldAlwaysUpdate:!0,shouldDraw:!1,shouldSerialize:!1,shouldDeltaSerialize:!1,shouldSave:!0,
realTime:!1,parameters:{wildlingArchetype:"a_f_wildling"},init:function(a,b){this._super(a,b);this.wildling=null;this.offlineActionTargetName=this.offlineActionTarget=this.offlineAction=void 0;this.offlineActionAdditionalSeconds=0;this.wildlingWaitingForClick=this.wildlingSleeping=this.inCombat=!1;this.clickActionTarget=this.clickAction=null;this.clickActionSeconds=0},activate:function(){this._super();this.combatStartedCallback=this.onCombatStart.bind(this);this.combatEndedCallback=this.onCombatEnd.bind(this);
this.gameManager.eventManager.subscribe("CombatStarted",this.combatStartedCallback);this.gameManager.eventManager.subscribe("CombatEnded",this.combatEndedCallback);this.inCombat=this.gameManager.isInCombat();this.setToUpdate(!this.inCombat)},update:function(){this._super();(!this.wildling||this.wildling.shouldBeDestroyed())&&!this.inCombat&&this.spawnWildling();this.updateOffline()},onCombatStart:function(){this.inCombat=!0;this.setToUpdate(!1)},onCombatEnd:function(){this.inCombat=!1;this.setToUpdate(!0)},
spawnWildling:function(){var a=this.gameManager,b=a.getEntityFactory(),c=this.getWildlingArchetype(),d=null,f,e;if(!this.wildling&&(b&&c)&&(e=this.getEntityEC("ECFaction"),e=e.getFactionName(),f=a.getNavManager(),a=this.entity.getGameSpace(),f=f.getTraversableV2PerimeterLocationsFromWorldExtents(a,this.getEntityEC("ECPhysicsCube").getExtents(),e),f.length&&(d=a.getV3WorldLocationFromV2GridLocation(f[0]),d[1]+=1,d=b.createActiveEntityInstance("spawned_"+c,c,d))))b=d.getEC("ECFaction"),b.setFaction(e),
b=d.getEC("ECWildlingAgent"),this.setWildling(d),b&&(this.wildlingSleeping&&b.fallAsleep(),this.wildlingWaitingForClick&&b.startWaitingForClick(this.clickAction,this.clickActionTarget,this.clickActionSeconds)),this.wildlingWaitingForClick=this.wildlingSleeping=!1;this.wildling=d},hideWildling:function(a){var b;if(a&&!a.shouldBeDestroyed()&&a===this.wildling){if(b=a.getEC("ECWildlingAgent"))this.wildlingSleeping=b.isSleeping(),(this.wildlingWaitingForClick=b.isWaitingForClick())?(this.clickAction=
b.clickAction,this.clickActionTarget=b.clickActionTarget,this.clickActionSeconds=b.clickActionSeconds):(this.clickActionTarget=this.clickAction=null,this.clickActionSeconds=0);a.setToBeDestroyed();this.wildling=null}},updateOffline:function(){var a=this.gameManager.getAdditionalTimeFromSave()+this.offlineActionAdditionalSeconds,b=this.wildling,c=null,d=this.offlineAction;if(0<a&&(b&&!b.toBeDestroyed)&&(b=b.getEC("ECWildlingAgent")))d&&d!==ob.offlineActions.none?b.beginOfflineAction(d,this.offlineActionTarget,
a):b.canPerformOrder("Assist With Building")?c="normal":b.canPerformOrder("Assist With WarBuilding")&&(c="war"),c&&b.attemptOfflineBuilding(c,a),this.offlineActionTargetName=this.offlineActionTarget=this.offlineAction=void 0,this.offlineActionAdditionalSeconds=0},getWildlingArchetype:function(){return this.archetype.wildlingArchetype},getWildling:function(){return this.wildling},setWildling:function(a){var b;if(this.wildling!==a&&(this.wildling&&(b=this.wildling.getEC("ECWildlingAgent"))&&b.clearWildlingHouse(),
this.wildling=a))(b=a.getEC("ECWildlingAgent"))&&b.setWildlingHouse(this.entity)},onToBeDestroyed:function(){var a;this._super();this.gameManager.eventManager.unsubscribe("CombatStarted",this.combatStartedCallback);this.gameManager.eventManager.unsubscribe("CombatEnded",this.combatEndedCallback);this.wildling&&!this.wildling.shouldBeDestroyed()&&((a=this.wildling.getEC("ECWildlingAgent"))&&a.clearWildlingHouse(),this.wildling=null)},saveSerialize:function(){var a={},b=this.wildling,c,d,f;if(this.clickAction)d=
this.clickAction,f=this.clickActionTarget,c=this.clickActionSeconds;else if(b&&!b.toBeDestroyed&&(b=b.getEC("ECWildlingAgent")))c=b.getOfflineActionData(),d=c.offlineAction,f=c.offlineActionTarget,c=c.offlineActionAdditionalSeconds;d?(a.offlineAction=d,a.offlineActionAdditionalSeconds=c,f&&(a.offlineActionTarget=this.packGameEntity(f),a.offlineActionTargetName=f.getName())):a.offlineAction=ob.offlineActions.none;return a},serialize:function(a){var b=this.wildling,c,d,f;this._super(a);if(this.clickAction)d=
this.clickAction,f=this.clickActionTarget,c=this.clickActionSeconds;else if(b&&!b.toBeDestroyed&&(b=b.getEC("ECWildlingAgent")))c=b.getOfflineActionData(),d=c.offlineAction,f=c.offlineActionTarget,c=c.offlineActionAdditionalSeconds;d?(a.offlineAction=d,a.offlineActionAdditionalSeconds=c,f&&(a.offlineActionTarget=this.packGameEntity(f),a.offlineActionTargetName=f.getName())):a.offlineAction=ob.offlineActions.none},deserialize:function(a){this._super(a)}});Xh.create=function(a,b){return new Xh(a,b)};
F.prototype.eCCreationMap[Xh.prototype.entityComponentName]=Xh;var Yh=F.extend({entityComponentName:"ECWildlingLeader",updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldAlwaysUpdate:!1,shouldDraw:!1,shouldSerialize:!1,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{wildlingArchetype:"a_f_wildling"},init:function(a,b){this._super(a,b);this.followers=[]},attach:function(a){this._super(a);a=this.globals.gameManager.eventManager;this.onInteractWithResourceDispenserCallback=this.onInteractWithResourceDispenser.bind(this);
a.subscribe("InteractWithResourceDispenser",this.onInteractWithResourceDispenserCallback);this.onScaffoldClickedCallback=this.onScaffoldClicked.bind(this);a.subscribe("ScaffoldClicked",this.onScaffoldClickedCallback);this.onUpgraderClickedCallback=this.onUpgraderClicked.bind(this);a.subscribe("UpgraderClicked",this.onUpgraderClickedCallback)},onToBeDestroyed:function(){this._super();var a=this.globals.gameManager.eventManager;a.unsubscribe("InteractWithResourceDispenser",this.onInteractWithResourceDispenserCallback);
a.unsubscribe("ScaffoldClicked",this.onScaffoldClickedCallback);a.unsubscribe("UpgraderClicked",this.onUpgraderClickedCallback)},getFollowers:function(){return this.followers},clearFollowers:function(){this.followers.length=0},addFollower:function(a){var b=this.getFollowers();a&&(b&&0>b.indexOf(a))&&b.push(a)},removeFollower:function(a){var b=this.getFollowers();a&&b&&(a=b.indexOf(a),0<=a&&b.splice(a,1))},onInteractWithResourceDispenser:function(a){var b=a.resourceDispenser;b&&a.interactor===this.entity&&
(a=b.getEC("ECResourceDispenser"),a=Za[a.getResourceType()].wildlingOrder,this.giveOrderToFollowers(a,b))},onScaffoldPlaced:function(a){this.onInteractWithScaffold(a)},onUpgradeStarted:function(a){this.onInteractWithUpgrader(a)},onScaffoldClicked:function(a){if(a=a.scaffoldEntity)this.onInteractWithScaffold(a)},onUpgraderClicked:function(a){if(a=a.upgraderEntity)this.onInteractWithUpgrader(a)},onCancelBuilding:function(a){this.removeFollowersThatCanPerformOrder("war"===a?"Assist With WarBuilding":
"Assist With Building")},onInteractWithScaffold:function(a){var b;if(a&&(b=a.getEC("ECScaffold")))b="war"===b.getScaffoldType()?"Assist With WarBuilding":"Assist With Building",this.giveOrderToFollowers(b,a)},onInteractWithUpgrader:function(a){var b;if(a&&(b=a.getEC("ECUpgrader"))&&b.isUpgrading())b="war"===b.getScaffoldType()?"Assist With WarBuilding":"Assist With Building",this.giveOrderToFollowers(b,a)},giveOrderToFollowers:function(a,b,c){var d=this.getFollowers(),f,e;for(f=d.length-1;0<=f;f-=
1)if(e=d[f])if((e=e.getEC("ECWildlingAgent"))&&e.canPerformOrderOnTarget(a,b))e.giveOrder(a,b),c||e.stopFollowingLeader()},canAnyFollowersPerformOrder:function(a){var b=this.getFollowers(),c,d,f=!1;for(c=b.length-1;0<=c;c-=1)if(d=b[c])(d=d.getEC("ECWildlingAgent"))&&d.canPerformOrder(a)&&(f=!0);return f},removeFollowersThatCanPerformOrder:function(a){var b=this.getFollowers(),c,d;for(c=b.length-1;0<=c;c-=1)if(d=b[c])(d=d.getEC("ECWildlingAgent"))&&d.canPerformOrder(a)&&d.stopFollowingLeader()},serialize:function(a){this._super(a)},
deserialize:function(a){this._super(a)}});Yh.create=function(a,b){return new Yh(a,b)};F.prototype.eCCreationMap[Yh.prototype.entityComponentName]=Yh;var Zh=F.extend({entityComponentName:"ECWorldText",updatePeriod:0,sortPriority:4,shouldUpdate:!1,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,parameters:{text1:"",text2:"",text3:"",textSize:{description:"Size Of Text",type:"slider",defaultValue:0.75,minValue:0.5,maxValue:2},textWorldOffset:{description:"Height Of Text Above Entity",
type:"slider",defaultValue:2,minValue:-5,maxValue:5},r:1,g:1,b:1,active:!0,visibleOnActivated:!1,visibleOnHover:!1},init:function(a,b){this._super(a,b);this.scale=0;this.active=this.safeCopy(b.active,!0);this.activated=this.hot=!1},activate:function(){var a;this._super();this.active&&(this.active=!1,this.setActive(!0));if(a=this.getEntityEC("ECSelectable"))this.setActivated(a.isActivated()),this.setHot(a.isHot())},update:function(){this._super()},updateValidity:function(){var a=this.archetype,b=a.visibleOnActivated,
a=a.visibleOnHover,c;if(b||a)c=!0,a&&(c=this.isHot()),c&&b&&(c=this.isActivated()),this.setActive(c)},isActivated:function(){return this.activated},setActivated:function(a){a!==this.activated&&(this.activated=a,this.updateValidity())},isHot:function(){return this.hot},setHot:function(a){a!==this.hot&&(this.hot=a,this.updateValidity())},setText1:function(a){this.text1=a},setText2:function(a){this.text2=a},setText3:function(a){this.text3=a},draw:function(){if(!this.active&&!this.tweener)this.setToDraw(!1);
else if(0!==this.scale){var a=this.globals,b=a.mathDevice,c=a.simpleFontRenderer,d=this.archetype,f=a.camera.worldToScreen(b.v3Add(this.getv3Location(),b.v3Build(0,d.textWorldOffset,0))),a=void 0!==this.text1?this.text1:d.text1,b=void 0!==this.text2?this.text2:d.text2,e=void 0!==this.text3?this.text3:d.text3,h=d.r,i=d.g,d=d.b;void 0!==f&&(d={x:f[0],y:f[1],pointSize:32,specialScale:this.scale,alignment:1,r:h,g:i,b:d},c.drawFontDouble(a,d),d.y+=35,c.drawFontDouble(b,d),d.y+=35,c.drawFontDouble(e,d))}},
drawDebug:function(){},setActive:function(a){this.active!==a&&(this.active=a,this.tweener&&this.tweener.stop(),this.active?(this.beginActive(),this.setToDraw(!0)):this.beginPassive())},beginActive:function(){var a=this;this.tweener=G.Create({scale:this.scale}).to({scale:1},0.5).easing(G.Easing.Elastic.Out).onUpdate(function(){a.scale=this.scale}).onComplete(function(){a.tweener=void 0}).start()},beginPassive:function(){var a=this;this.tweener=G.Create({scale:this.scale}).to({scale:0},0.25).easing(G.Easing.Circular.In).onUpdate(function(){a.scale=
this.scale}).onComplete(function(){a.tweener=void 0}).start()},serialize:function(a){this._super(a);a.scale=this.scale},serializeDelta:function(){}});Zh.create=function(a,b){return new Zh(a,b)};F.prototype.eCCreationMap[Zh.prototype.entityComponentName]=Zh;var $h=F.extend({entityComponentName:"ECWorldGui",updatePeriod:0,sortPriority:4,shouldUpdate:!0,shouldDraw:!1,shouldSerialize:!0,shouldDeltaSerialize:!1,shouldSave:!1,realTime:!1,storeGlobalList:!1,parameters:{onScreenGuiArchetype:"none",offScreenGuiArchetype:"none",
text1:"",text2:"",visibleAlways:!0,visibleOnActivated:!1,visibleOnHover:!1},init:function(a,b){this._super(a,b);this.onScreenGuiArchetype=b.onScreenGuiArchetype;this.offScreenGuiArchetype=b.offScreenGuiArchetype},activate:function(){this._super();this.archetype.visibleAlways&&(this.setToUpdate(!0),this.setToAlwaysUpdate(this.shouldUpdateOffscreen()));var a;if(a=this.getEntityEC("ECSelectable"))this.setActivated(a.isActivated()),this.setHot(a.isHot())},update:function(){this._super();var a=this.gameManager.getGameCamera(),
b=this.onScreenGuiArchetype;a.isOnScreen(this.getv3Location())||(b=this.offScreenGuiArchetype);"none"!==b&&this.gameManager.getGuiManager().addDrawGui(b,{v3WorldLocation:this.getv3Location(),allowOffscreen:!0,text1:this.archetype.text1,text2:this.archetype.text2},"idECWorldGui"+this.entity.getName()+b)},shouldUpdateOffscreen:function(){return"none"!==this.archetype.offScreenGuiArchetype},updateValidity:function(){var a=this.archetype,b=a.visibleOnActivated,a=a.visibleOnHover,c;if(b||a)c=!0,a&&(c=
this.hot&&!this.activated),b&&(c=this.activated),this.setToUpdate(c),this.setToAlwaysUpdate(c&&this.shouldUpdateOffscreen())},setActivated:function(a){a!==this.activated&&(this.activated=a,this.updateValidity())},setHot:function(a){a!==this.hot&&(this.hot=a,this.updateValidity())},draw:function(){},drawDebug:function(){},serialize:function(a){this._super(a)},serializeDelta:function(){},onDeath:function(){},onToBeDestroyed:function(){this._super()},destroy:function(){this._super()}});$h.create=function(a,
b){return new $h(a,b)};F.prototype.eCCreationMap[$h.prototype.entityComponentName]=$h;O.prototype={createBlockInstance:function(a,b,c,d){var f=this.globals,e=O.archetypes[a];c||(c=f.mathDevice,c=e.v3CreationScale||c.v3BuildOne());d||(d=0);return rf.create(a,e,b,c,d,f)},getArchetype:function(a){return O.archetypes[a]},preload:function(){var a=O.archetypes,b=Sa.create({name:"temp",dynamic:!1,disabled:!0}),c,d;for(c in a)a.hasOwnProperty(c)&&(d=a[c],this.loadArchetypeAssets(d,b))},loadArchetypeAssets:function(a,
b){var c=this.globals.simpleSceneLoader,d=a.path;d&&(c.isLoadingMesh(d)||c.load(d,void 0,void 0,b))},getArchetypeList:function(){return this.archetypeList},createAlphabeticalArchetypeList:function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(c);b.sort();return b}};O.archetypes={};O.create=function(a,b){var c=new O;c.globals=a;c.gameManager=b;c.archetypeList=c.createAlphabeticalArchetypeList(O.archetypes);return c};Z.prototype={createVisualEffectInstance:function(a){return I.create(this.globals,
I.archetypes[a.archetype],a.v3Location,a.v3Direction)},createEffectInstance:function(a){var b=Z.archetypes[a.archetype],c=this.globals.mathDevice,d;b.visualEffectArchetype&&(d=I.archetypes[b.visualEffectArchetype],I.create(this.globals,d,a.v3Location,a.v3Direction,a.gameEntity));var f=b.visualEffectArchetypeList;if(f){var e=f.length,h;for(h=0;h<e;h+=1)d=I.archetypes[f[h]],I.create(this.globals,d,a.v3Location?c.v3Copy(a.v3Location):void 0,a.v3Direction?c.v3Copy(a.v3Direction):void 0,a.gameEntity,a.v2ScreenLocation?
c.v3Copy(a.v2ScreenLocation):void 0,a.scale,a.timeDilation)}b.soundEffectArchetype&&(c=this.gameManager.gameSoundManager,c.playInternal(b.soundEffectArchetype,a.v3Location,a.gameEntity));if(b.screenShakeArchetype&&(a=this.gameManager.getGameCamera(),c=this.globals.guiRenderer,b=Ic[b.screenShakeArchetype]))a.addShake(b.strength,b.duration),c.addShake(b.strength,0.5*b.duration)},slomo:function(a,b){var c=this.gameManager;G.Create({dilation:a}).to({dilation:1},b).easing(G.Easing.Linear.None).onUpdate(function(){c.setSlomo(this.dilation)}).setAppTimeBased().start()},
endEffectInstance:function(a){var b=Z.archetypes[a.archetype],c;b.soundEffectArchetype&&(c=this.gameManager.gameSoundManager,c.stopInternal(b.soundEffectArchetype,a.gameEntity,void 0!==a.fadeDuration?a.fadeDuration:0.5))},play:function(a,b,c,d,f,e,h){if(a){var i=this.globals.mathDevice,a={archetype:a,v3Location:b?i.v3Copy(b):void 0,gameEntity:c,v3Direction:d,v2ScreenLocation:f,scale:e,timeDilation:h};c&&c.isManagedByThisMachine()?(c=this.gameManager.getActionManager(),c.addAction("SpecialEffect",
a)):this.createEffectInstance(a)}},playPersistentEffect:function(a,b,c){var d=this.gameManager.getEntityFactory();c&&(b=c.getv3Location());a=d.createInactiveEntityInstance(a,a,b);b=a.name;c&&(d=F.createFromName("ECAttach",this.globals),d.setParent(c),a.addECToCustomEntity(d));a.activate();return b},stopPersistentEffect:function(a){this.gameManager.getGameEntityByName(a).setToBeDestroyed()},stop:function(a,b,c){a&&(a={archetype:a,gameEntity:b,fadeDuration:c},b&&b.isManagedByThisMachine()?(b=this.gameManager.actionManager,
b.addAction("EndSpecialEffect",a)):this.endEffectInstance(a))},preload:function(){var a=this.globals.textureManager,b=I.archetypes,c,d;for(c in b)b.hasOwnProperty(c)&&(d=b[c],a.load(d.texturePath))}};Z.archetypes={};Z.create=function(a,b){var c=new Z;c.globals=a;c.gameManager=b;return c};I.prototype={initialise:function(a){var b=this.buildKeyframeList(a);this.buildTweens(a,b)},buildKeyframeList:function(a){var b=a.lifetime;void 0!==this.timeDilation&&(b/=this.timeDilation);var c=0,d=void 0!==this.scale?
this.scale:1;void 0!==a.randomAddedScale&&(c=Math.random()*a.randomAddedScale);var f=[];if(a.keyFrames){var a=a.keyFrames,b=a.length,e,h;for(e=0;e<b;e+=1)h=a[e],f.push({scale:h.scale*d+c,r:h.colour[0],g:h.colour[1],b:h.colour[2],a:h.colour[3],life:h.life})}else f.push({scale:a.startScale*d+c,r:a.startColour[0],g:a.startColour[1],b:a.startColour[2],a:a.startColour[3],life:0}),f.push({scale:a.endScale*d+c,r:a.endColour[0],g:a.endColour[1],b:a.endColour[2],a:a.endColour[3],life:b});return f},buildTweens:function(a,
b){var c=this,d=this.globals,f=d.simpleSpriteRenderer,e=d.mathDevice,h=d.camera,i;switch(a.alignment){case "camera":break;case "horizontal":i=e.v3BuildYAxis();break;case "direction":this.v3Direction&&(i=e.v3Copy(this.v3Direction));break;case "vertical":d=h.matrix;i=e.m43At(d);i[0]*=-1;i[1]=0;i[2]*=-1;break;default:i=e.v3BuildYAxis()}var j;a.randomRotate&&(j=2*Math.PI*Math.random());i&&(1E-4>e.v3LengthSq(i)?i=void 0:e.v3Normalize(i,i));var k;a.follow&&(k=this.parentEntity);var l;a.v3Velocity&&(l=a.v3Velocity);
a.facingSpeed&&(l=e.v3ScalarMul(i,a.facingSpeed));var m=this.v2ScreenLocation,d=function(){var a;a=m?h.screenToWorld(m[0],m[1],1):k&&!k.shouldBeDestroyed()?k.getv3Location():c.v3Location;l&&(a=e.v3AddScalarMul(a,l,this.life));a={v3Location:a,size:this.scale,blendStyle:ua.prototype.blendStyle.NORMAL,texture:c.texturePath,v4color:e.v4Build(this.r,this.g,this.b,this.a),out:i,angle:j};f.addSprite(a)},q=G.Easing.Quadratic.Out,p=G.Easing.Quadratic.InOut,s=void 0!==a.delay?a.delay:0,t,u,w,B=b.length,y,v;
for(y=1;y<B;y+=1)t=b[y],v=b[y-1],t=G.Create(v).to(t,t.life-v.life).easing(1===y?q:p).onUpdate(d).delay(s),m&&t.setAppTimeBased(),1===y&&(w=t),u&&u.chain(t),u=t;w.start()}};I.archetypes={};I.create=function(a,b,c,d,f,e,h,i){var j=new I;j.globals=a;j.v3Location=c;j.v3Direction=d;j.texturePath=b.texturePath;j.parentEntity=f;j.v2ScreenLocation=e;j.scale=h;j.timeDilation=i;j.initialise(b);return j};ic.prototype={globals:void 0,fakeSphere:void 0,gameManager:void 0,stepHeight:0.6,stepDetectAngle:0.4*Math.PI,
stepAngle:0.45*Math.PI,debugExtentsColour:[0,1,1],drawDebug:function(){this.globals.debugDraw.drawDebugExtents(this.extents,this.debugExtentsColour[0],this.debugExtentsColour[1],this.debugExtentsColour[2])},setECPhysSphereAdjustCallback:function(a){this.ecPhysSphereAdjustCallback=a},teleport:function(a){var b,c=this.globals,d=c.scene,f=c.mathDevice;this.rootNode&&(b=this.rootNode.getLocalTransform(),d.removeRootNode(this.rootNode),f.m43SetPos(b,a),this.rootNode=c.simpleSceneLoader.load(this.path,
b,!0));this.setv3Location(a)},collisionCheck:function(a){return this.ignoringCollision?!1:this.globals.mathDevice.aabbSphereOverlaps(this.extents,a.getv3Location(),a.getRadius())},stepifyFakeSphere:function(a,b,c){var d=this.globals.mathDevice;if(b.getCanClimb()){var f=this.scratchpad,e=c.getv3Location(),h=f.v3offset=d.v3Sub(e,a,f.v3offset),f=f.v3hoffset=d.v3Copy(h,f.v3hoffset);d.v3SetY(0,f);var i=d.v3GetY(h),j=d.v3Length(f),i=Math.atan2(i,j);Math.abs(i)>this.stepDetectAngle||(i=this.extents[4],a[1]-
b.getRadius()<i-this.stepHeight||(d.v3Normalize(f,f),b=d.v3Length(h),i=Math.sin(-this.stepAngle)*b,j=Math.cos(this.stepAngle)*b,d.v3ScalarMul(f,j,h),d.v3SetY(i,h),e=d.v3Add(a,h,e),c.setBounce(0),c.entity.setv3Location(e),c.setFrictionType(qa.frictionType.GROUND)))}},collisionResolve:function(a){var b=this.globals.mathDevice,c,d,f;f=this.scratchpad;if(!this.ignoringCollision){c=a.getv3Location();d=f.fake_sphere_v3_location=b.aabbClampv3(this.extents,c,f.fake_sphere_v3_location);var e;0===b.v3DistanceSq(d,
c)&&(e=b.aabbSmallestPointOverlapDistance(this.extents,d),f.reducedExtents=b.aabbShrink(this.extents,e+0.5*a.getRadius(),f.reducedExtents),f.fake_sphere_v3_location=b.aabbClampv3(f.reducedExtents,c,f.fake_sphere_v3_location),0===b.v3DistanceSq(d,c)&&(d[1]-=0.5*a.getRadius()));b=this.getFakePhysSphere();f=b.getEC("ECPhysicsSphere");f.onImpactCallbackFn=this.onImpactCallbackFn;f.impactEntity=this.entity;b.setv3Location(d);c[1]<this.extents[4]?f.setFrictionType(qa.frictionType.WALL):f.setFrictionType(qa.frictionType.GROUND);
f.setBounce(0.25);f.clearVelocity();this.ecPhysSphereAdjustCallback&&this.ecPhysSphereAdjustCallback(f);this.stepifyFakeSphere(c,a,f);a.resolveCollision(f)}},setOnImpactCallback:function(a){this.onImpactCallbackFn=a},makeFakePhysSphere:function(){var a=this.gameManager.getEntityFactory(),b=this.globals,a=a.createCustomEntityInstance("FakePhysSphere","FakePhysSphere",b.mathDevice.v3BuildZero()),b=F.createFromName("ECPhysicsSphere",b,{radius:0,fixed:!0,frictionType:qa.frictionType.GROUND});a.addECToCustomEntity(b);
a.activate();a.setGameSpace(void 0);return a},getFakePhysSphere:function(){var a=qa.prototype.fakeSphere;void 0===a&&(a=this.makeFakePhysSphere(),qa.prototype.fakeSphere=a);return a},updateExtents:function(a,b){var c=this.globals.mathDevice;this.v3Location=c.v3Copy(a,this.v3Location);this.v3Scale=c.v3Copy(b,this.v3Scale);this.extents=c.aabbBuildFromCentreHalfExtents(a,c.v3ScalarMul(b,0.5),this.extents)},getNearestPointToPoint:function(a,b){return this.globals.mathDevice.aabbClampv3(this.extents,a,
b)},setv3Location:function(a){var b=this.globals.mathDevice;(void 0===this.v3Location||0.001<b.v3DistanceSq(this.v3Location,a))&&this.updateExtents(a,this.v3Scale)},getv3Location:function(){return this.v3Location},getExtents:function(){return this.extents},setv3Scale:function(a){var b=this.globals.mathDevice;(void 0===this.v3Scale||0.001<b.v3DistanceSq(this.v3Scale,a))&&this.updateExtents(this.v3Location,a)},getv3Scale:function(){return this.v3Scale},getPath:function(){return this.path},isBlock:function(){return this.block?
!0:!1},buildTransformMatrix:function(a,b){var c=this.globals.mathDevice,d=c.m43BuildIdentity(),f=this.v3Location,e=function(a,b){return a<b?0.5*(a/b):a>1-b?1-0.5*((1-a)/b):0.5},h=c.perlinNoise(0.735*f[0],0.735*f[1],0.735*f[2]),h=e(h,0.425),h=1;c.m43Scale(d,c.v3Build(h*this.v3Scale[0],h*this.v3Scale[1],h*this.v3Scale[2]),d);h=c.perlinNoise(0.735*f[0],0.735*f[1],0.735*f[2]+10);h=e(h,0.425);h=(h-0.5)*0*Math.PI;c.m43Mul(c.m43BuildRotationX(h),d,d);h=c.perlinNoise(0.735*f[0],0.735*f[1],0.735*f[2]+20);
h=e(h,0.425);h=(h-0.5)*0*Math.PI;b||(h+=0.5*Math.PI*Math.floor(4*a));c.m43Mul(c.m43BuildRotationY(h),d,d);h=c.perlinNoise(0.735*f[0],0.735*f[1],0.735*f[2]+30);h=e(h,0.425);h=(h-0.5)*0*Math.PI;c.m43Mul(c.m43BuildRotationZ(h),d,d);b&&(c.m43Mul(d,b,d),0<c.v3Dot(c.v3Cross(c.m43At(d),c.m43Up(d)),c.m43Right(d))&&(c.m43SetAt(d,c.v3ScalarMul(c.m43At(d),-1)),c.m43Mul(d,c.m43BuildRotationY(Math.PI),d)));c.m43SetPos(d,f);return d},destroy:function(){this.extents=this.v3Scale=null}};ic.create=function(a,b,c,
d){void 0===ic.prototype.globals&&(ic.prototype.globals=b);void 0===ic.prototype.gameManager&&(ic.prototype.gameManager=c);return new ic(a,d)};var k={normal:[0,162/255,167/255,1],textShadow:[0,0,0,0.4],startButton:[0,194/255,97/255,1],invalid:[129/255,193/255,194/255,1],outline:[1,1,1,1],black:[0,0,0,1],outline40pc:[1,1,1,0.4],normalSoft:[20/255,135/255,235/255,0.3],invalidSoft:[50/255,50/255,50/255,0.3],outlineSoft:[1,1,1,0.3],shadow:[0,0,0,0.5],lumber:[0,155/255,30/255,1],stone:[100/255,155/255,
200/255,1],amber:[250/255,124/255,23/255,1],healthFull:[40/255,220/255,8/255,1],healthMid:[1,0.8,0,1],healthLow:[240/255,13/255,40/255,1],aggroFull:[240/255,13/255,40/255,1],aggroEmpty:[240/255,13/255,40/255,0.5],dialog:[35/255,35/255,35/255,0.6],buttons:[20/255,135/255,235/255,1],darkBack:[0,0,0,0.5],modalBack:[0,27/255,28/255,0.7],white:[1,1,1,1],maxValText:[1,1,1,0.65],maxValTextShad:[0,0,0,0.55],darkGreen:[0,127/255,131/255,1],modalLight:[0.8,174/255,136/255,1],modalMedium:[147/255,117/255,79/
255,1],modalDark:[100/255,76/255,46/255,1],modalVDark:[80/255,61/255,37/255,1],modalButtonLight:[238/255,229/255,217/255,1],modalDark:[226/255,209/255,189/255,1],wonderstruck:[250/255,69/255,23/255,1],loadingGrey:[238/255,238/255,238/255,1],loadingBarBack:[210/255,210/255,210/255,1],loadingText:[30/255,30/255,30/255,1],buildingNormal:[20/255,235/255,20/255,0.5],buildingConfirm:[20/255,235/255,20/255,1],buildingCantPlace:[235/255,20/255,20/255,1],buildingInvalid:[200/255,200/255,200/255,0.5],fullyChargedShot:[250/
255,98/255,23/255,1],reviveRed:[215/255,11/255,23/255,1],heroxp:[175/255,47/255,164/255,1],orange:[250/255,69/255,23/255,1],infoPanelTextBoxBackground:[215/255,11/255,23/255,1],strings:{}};k.strings.green="rgba(72,207,48,1.0)";k.strings.shopGreen="rgba(49,183,25,1.0)";k.strings.red="rgba(255,0,0,1.0)";k.strings.crosshair="rgba(255,255,255,0.6)";k.strings.crosshairNo="rgba(255,0,0,0.4)";k.strings.outline="rgba(255,255,255, 1.0)";k.strings.outline40pc="rgba(255,255,255, 0.4)";k.strings.black20pc="rgba(0,0,0, 0.2)";
k.strings.whiteAlpha="rgba(255,255,255,0.4)";k.strings.darkBack="rgba(100,100,100,0.6)";k.strings.modalBack="rgba(100,100,100,0.8)";k.strings.charcoal="rgba(32,32,32,1.0)";k.strings.cursor="rgba(230,250,250,1.0)";k.strings.cursorshd="rgba(187,232,233,1.0)";k.strings.normal="rgba(0,162,167,1.0)";k.strings.shop="rgba(248,164,15,1.0)";k.strings.startButton="rgba(0,194,97,1.0)";k.strings.lumber="rgba(0,155,30,1.0)";k.strings.stone="rgba(100,155,200,1.0)";k.strings.amber="rgba(250,124,23,1.0)";k.strings.aggro=
"rgba(227,24,25,1.0)";k.strings.outlineFaint="rgba(255,255,255,0.5)";k.strings.outlineVFaint="rgba(255,255,255,0.15)";k.strings.twitter="rgba(0,184,250,1.0)";k.strings.facebook="rgba(59,89,152,1.0)";k.strings.invalid="rgba(129,193,194,1.0)";k.strings.clockday="rgba(0,190,194,1.0)";k.strings.clocknight="rgba(0,77,79,1.0)";k.strings.clockdaydark="rgba(1,174,179,1.0)";k.strings.clocknightlight="rgba(0,92,95,1.0)";k.strings.clockhand="rgba(250,5,6,1.0)";k.strings.white="rgba(255,255,255,1.0)";k.strings.warCompassInvasionBg=
"rgba(215,11,4,1.0)";k.strings.warCompassPrepareBg="rgba(0,162,167,1.0)";k.strings.reviveRed="rgba(215,11,4,1.0)";k.strings.daze="rgba(255,255,255,0.4)";k.strings.alert="rgba(215,11,4,1.0)";k.strings.orange="rgba(250,69,23,1.0)";k.strings.war="rgba(227,24,25,1.0)";k.strings.brightNormal="rgba(0,179,185,1.0)";k.strings.murkyGreen="rgba(0,60,62,1.0)";k.strings.purple="rgba(145,51,185,1.0)";k.strings.warning="rgba(245,173, 0, 1.0)";k.strings.xp="rgba(175,48,165,1.0)";k.strings.arrow="rgba(59,184,220, 1.0)";
k.strings.star="rgba(252,215,23,1.0)";k.strings.starDark="rgba(248,164,15,1.0)";k.strings.success="rgba(40,186,14,1.0)";k.strings.successDark="rgba(33,143,13,1.0)";k.strings.fail="rgba(227,24,25,1.0)";k.strings.failDark="rgba(181,21,21,1.0)";k.strings.highlight="rgba(255,255,255,0.2)";k.strings.lightLumber="rgba(0,155,30,0.45)";k.strings.lightStone="rgba(100,155,200,0.5)";k.strings.lightAggro="rgba(227,24,25,0.3)";k.strings.lightHeroxp="rgba(151,34,137,0.45)";k.strings.lightNormal="rgba(0,162,167,0.45)";
k.strings.lightOrange="rgba(250,69,23,0.45)";k.strings.lightPurple="rgba(145,51,185,0.45)";k.strings.lightAmber="rgba(250,124,23,0.35)";k.strings.darkGreen="rgba(0, 127, 131, 1.0)";k.strings.darkLumber="rgba(0, 136, 19, 1.0)";k.strings.darkStone="rgba(71, 136, 195, 1.0)";k.strings.darkAmber="rgba(250,92, 14, 1.0)";k.strings.darkHeroxp="rgba(151,34, 137, 1.0)";k.strings.darkNormal="rgba(1, 147, 152, 1.0)";k.strings.darkWar="rgba(206,23,24, 1.0)";k.strings.darkTwitter="rgba(0, 156,248, 1.0)";k.strings.darkFacebook=
"rgba(35,53, 111, 1.0)";k.strings.darkInvalid="rgba(97, 177, 179, 1.0)";k.strings.darkAggro="rgba(206,6,6, 1.0)";k.strings.darkOrange="rgba(185,50, 16, 1.0)";k.strings.darkPurple="rgba(96,40, 119, 1.0)";k.strings.darkWarning="rgba(211,149, 0, 1.0)";k.strings.darkProgOrangeBar="rgba(247,34,11,1.0)";k.strings.modalLight="rgba(204, 174, 136, 1.0)";k.strings.modalMedium="rgba(147, 117,79, 1.0)";k.strings.modalDark="rgba(100,76,46, 1.0)";k.strings.modalVDark="rgba(80,61,37, 1.0)";k.strings.normalButtonLight=
"rgba(0,181,185, 1.0)";k.strings.normalButtonDark="rgba(0,162, 167, 1.0)";k.strings.greenButtonLight="rgba(72,205,46, 1.0)";k.strings.greenButtonDark="rgba(59,187,38, 1.0)";k.strings.modalButtonLight="rgba(238,229,217, 1.0)";k.strings.modalButtonDark="rgba(226,209, 189, 1.0)";k.strings.toggleOff="rgba(150,203,205, 1.0)";k.strings.toggleOffDark="rgba(124, 190, 192, 1.0)";k.strings.closeRed="rgba(227,24,25, 1.0)";k.strings.closeRedDark="rgba(206,6,6, 1.0)";k.strings.whiteFaint="rgba(255,255,255,0.5)";
k.strings.blackFaint="rgba(0,0,0,0.4)";k.strings.blackvFaint="rgba(0,0,0,0.2)";k.strings.heroxp="rgba(175,47, 164, 1.0)";k.strings.invalidHeroxp="rgba(175,47, 164, 0.3)";k.strings.invalidDarkHeroxp="rgba(151,34, 137, 0.2)";k.strings.warBg="rgba(0,0,0,0.3)";k.strings.prepDark="rgba(37, 121, 113, 1.0)";k.strings.fightDark="rgba(159,0, 1, 1.0)";k.strings.enemyRed="rgba(212, 12,21, 1.0)";k.strings.enemyBlack="rgba(34,34,34, 1.0)";k.strings.enemyYellow="rgba(244, 178,0, 1.0)";k.strings.patternW="rgba(255,255,255,0.15)";
k.strings.patternB="rgba(0,0,0,0.15)";k.strings.pattern="rgba(255,255,255,0.3)";k.t_block="textures/block.dds";k.t_vignette="textures/vignette.dds";k.lineThickness=6;k.strings.tipNormal="rgba(0, 162, 167, 1.0)";k.strings.tipDarkNormal="rgba(1, 147, 152, 1.0)";k.strings.tipGreen="rgba(0, 144,22, 1.0)";k.strings.tipDarkGreen="rgba(0, 108, 16, 1.0)";k.strings.tipBlue="rgba(65, 143, 184, 1.0)";k.strings.tipDarkBlue="rgba(38, 112, 151, 1.0)";k.strings.tipOrange="rgba(225,73,0, 1.0)";k.strings.tipDarkOrange=
"rgba(172,57, 1, 1.0)";k.strings.tipYellow="rgba(240, 118, 18, 1.0)";k.strings.tipDarkYellow="rgba(192,95, 16, 1.0)";k.strings.tipPurple="rgba(145,51, 185, 1.0)";k.strings.tipDarkPurple="rgba(96,40, 119, 1.0)";k.strings.taskDark="rgba(0,110,114,1.0)";var kb,Oa,jd,kd,Qe,Re,Se,Te,Ue,Ve,Od,We,Qi,Ri,Xe,Jc,Pd,Si,Ye,Ze,$e,af,ld,md,nd,od,$j,ak;kb=[1,1,1,0.6];Oa=[1,1,1,0];jd=[0.6,0.6,0.6,0.6];kd=[0.8,0.8,0.8,0];Qe=[1,222/255,0,0.8];Re=[1,223/255,111/255,0];Se=[1,156/255,0,0.8];Te=[1,226/255,180/255,0];Ue=
[246/255,61/255,14/255,0.8];Ve=[242/255,158/255,137/255,0];Od=[212/255,12/255,21/255,0.8];We=[212/255,12/255,21/255,0.2];Qi=[62/255,55/255,32/255,0.25];Ri=[62/255,55/255,32/255,0.35];Xe=[62/255,55/255,32/255,0];Jc=[175/255,47/255,164/255,0.6];Pd=[175/255,47/255,164/255,0];Si=[214/255,167/255,210/255,0];Ye=[68/255,245/255,216/255,0.6];Ze=[68/255,245/255,216/255,0];$e=[1,105/255,181/255,0.6];af=[1,105/255,181/255,0];ld=[249/255,219/255,55/255,0.6];md=[249/255,219/255,55/255,0];nd=[99/255,1.39,197/255,
0.75];od=[99/255,1.39,197/255,0];$j=[250/255,124/255,23/255,0.75];ak=[250/255,124/255,23/255,0];var id={xpTable:[0,600,1121,2374,3839,5552,7555,9896,12635,15837,19581,23959,29078,35064,42063,50247,59817,71006,84091,99390,117280,138198,162658,191259,224702,263807,309532,362999,425518,498621,584100,684051,800924,937583,1097379,1284228,1502711,1758183,2056906,2406204,2814637],getLevelFromXP:function(a){var b=this.xpTable,c=b.length,d;for(d=0;d<c-1&&!(b[d+1]>a);d+=1);return d},getXPFromLevel:function(a){return a>=
this.xpTable.length?void 0:this.xpTable[a]}};xf.prototype={addControl:function(a,b){var c;1<arguments.length&&(c=Array.prototype.slice.call(arguments),c.shift(),c.shift(),c={context:b,controlFunction:a,id:c[0],params:c,visible:!0},this.controlInfoList[c.id]=c)},addDialog:function(a,b,c,d){var f=this.globals.gameManager.getIMGui();this.addControl(f.doDialog,f,a,b,c,d)},addVignette:function(a){this.vignetteAlpha=0;this.transitionOut=!1;this.addControl(this.updateVignette,this,"updateVignette");this.startFadeTween(0,
1,a)},startFadeTween:function(a,b,c){var d=this,f=TurbulenzEngine.time;G.Create({alpha:a}).to({alpha:b},c).easing(G.Easing.Exponential.In).onUpdate(function(){d.vignetteAlpha=this.alpha}).onComplete(function(){d.vignetteAlpha=b}).setAppTimeBased().start(1E3*f)},removeVignette:function(a){this.controlInfoList.hasOwnProperty("updateVignette")&&(this.transitionOut=!0,this.startFadeTween(this.vignetteAlpha,0,a))},updateVignette:function(a){var b=this.globals.gameManager.getIMGui();this.transitionOut&&
0>=this.vignetteAlpha?(this.removeControl(a),this.removeControl("vignette")):this.addControl(b.doVignette,b,"vignette",this.vignetteAlpha)},getUserInteraction:function(a){return this.controlInfoList[a].result},removeControl:function(a){this.controlInfoList.hasOwnProperty(a)&&delete this.controlInfoList[a]},reset:function(){this.controlInfoList=[]},showDialogOkButton:function(a){(a=this.controlInfoList[a])&&3<a.params.length&&(a.params[3]=!0)},addResourceBubble:function(a,b,c){this.addValueBubble(Za[c].bubbleArchetype,
a,b)},addSoftCurrencyBubble:function(a,b,c){this.addValueBubble("resourceAmber",a,b,c)},addXpBubble:function(a,b){this.addValueBubble("resourceXp",a,b)},addValueBubble:function(a,b,c,d){if(0!==c){var f=this.globals.gameManager.getGameSoundManager();f&&(0<c?f.play("bubblePositive",b):f.play("bubbleNegative",b));c=(0<c?"+":"")+c;void 0!==d&&1<d&&(c=c+" (x"+d+")");this.addBubble(b,a,c)}},addSpeechBubble:function(a,b,c){var d=this.globals.gameManager.getGameSoundManager();d&&d.play("speechExclaim",a);
this.addBubble(a,b,c)},addBubble:function(a,b,c){var d=this.globals.mathDevice,f=d.v3Copy(a),e=d.v3Add(a,d.v3BuildRandom(1)),a={x:e[0],y:e[1]+0,z:e[2],scale:0.2},e={scale:1,x:e[0],y:e[1]+1.5,z:e[2]},h="SpeechBubble"+this.uniqueIDForBubbles;this.uniqueIDForBubbles+=1;var i=this.globals.gameManager.getGuiManager(),j=G.Easing.Bounce.Out;this.activeScoreEventTween=G.Create(a).to(e,1.5).easing(j).onUpdate(function(){this.v3TweenLocation=d.v3Build(this.x,this.y,this.z,f);i.addDrawGui(b,{v3WorldLocation:this.v3TweenLocation,
text:c,scale:this.scale},h)}).start()},addScoreBubble:function(a,b,c){c=(0<=c?"+":"-")+Math.round(c).toString();this.addBubble(a,b,c)},addGameMessage:function(a,b,c,d,f){d=this.globals.appCurrentTime+(void 0!==d?d:1);this.gameMessages[a]?(this.gameMessages[a].text1=b,this.gameMessages[a].text2=c,this.gameMessages[a].endTime=d):this.gameMessages[a]={text1:b,text2:c,endTime:d,guiArchetype:f}},removeGameMessage:function(a){this.gameMessages[a]&&delete this.gameMessages[a]},updateGameMessages:function(){var a=
this.gameMessages,b,c;c=this.globals;var d=c.mathDevice,f=c.appCurrentTime,e=c.guiRenderer.getv2RenderLocation(0,100,"top");for(b in a)a.hasOwnProperty(b)&&(c=a[b],c.endTime>f||!c.drawn?(this.addDrawGui(c.guiArchetype?c.guiArchetype:"gameMessage",{text1:c.text1,text2:c.text2,v2ScreenLocation:d.v3Copy(e),layer:1},b),c.drawn=!0,e[1]+=200):delete a[b])},update:function(){this.updateGameMessages();var a=this.controlInfoList,b,c;for(b in a)a.hasOwnProperty(b)&&(c=a[b],c.hasOwnProperty("controlFunction")&&
(c.result=c.controlFunction.apply(c.context,c.params)))},addDrawGui:function(a,b,c){a={id:c,archetypeName:a,argumentObject:b,sortKey:0};a.sortKey=4096*this.getLayer(a)+this.drawList.length;this.drawList.push(a)},clearDrawList:function(){this.drawList.length=0},drawGui:function(a,b,c){var d=this.prevDrawGuiMap,f=this.drawGuiMap,e,h=this.globals.guiRenderer;c?d[c]?(e=d[c],b.scale=void 0!==b.scale?b.scale*e.scale:e.scale,e.argumentObject=b,d[c]=void 0,h.begin(),h.render(a,b),h.end(),f[c]=e):(e={archetypeName:a,
argumentObject:b,scale:0},f[c]=e,this.playStartSFX(e),this.fadeInTween(e)):(h.begin(),h.render(a,b),h.end())},playStartSFX:function(a){var b=this.globals,c=b.guiRenderer,d=b.mathDevice,f=c.getGuiInfo(a.archetypeName),e=b.gameManager.getEffectFactory(),h=a.argumentObject,i,j=f.beginSFX,k;j&&(k=void 0!==j.offsetX?j.offsetX*c.getScaleFactor():0,c=void 0!==j.offsetY?j.offsetY*c.getScaleFactor():0,h.v2ScreenLocation?i=h.v2ScreenLocation:void 0!==h.x&&void 0!==h.y?i=d.v2Build(h.x,h.y):h.v3WorldLocation&&
(i=b.camera.worldToScreen(h.v3WorldLocation)),f.getRenderLocationFn&&(i=f.getRenderLocationFn()),i&&(i[0]+=k,i[1]+=c),e.play(j.name,a.argumentObject.v3WorldLocation,void 0,void 0,i))},fadeInTween:function(a){var b=G.Create({scale:a.scale}).to({scale:1},0.05+0.3*Math.random()).easing(G.Easing.Circular.Out).onUpdate(function(){a.scale=this.scale}).setAppTimeBased().drawUpdate().start();a.tweener=b},fadeOutTween:function(a){a.tweener&&(a.tweener.stop(),a.tweener=void 0);var b=this.globals.guiRenderer,
c=a.argumentObject.scale;void 0===c&&(c=1);G.Create({scale:c}).to({scale:0},0.05+0.25*Math.random()).easing(G.Easing.Circular.In).onUpdate(function(){a.scale=this.scale;a.argumentObject.scale=this.scale;b.begin();b.render(a.archetypeName,a.argumentObject);b.end()}).setAppTimeBased().drawUpdate().start()},getLayer:function(a){var b=a.argumentObject.layer;if(void 0!==b)return b;b=i.archetypes[a.archetypeName].layer;return void 0!==b?b:0},sortCompare:function(a,b){return a.sortKey-b.sortKey},completeDraw:function(){var a=
this.prevDrawGuiMap,b,c,d=this.globals.guiRenderer;d.begin();c=this.drawList;var f=c.length,e,h,i=0,j=0;c.sort(this.sortCompare);for(e=0;e<f;e+=1)h=c[e],j=this.getLayer(h),j!==i&&(i=j,d.flush()),this.drawGui(h.archetypeName,h.argumentObject,h.id);for(b in a)a.hasOwnProperty(b)&&void 0!==a[b]&&(c=a[b],d.render(c.archetypeName,c.argumentObject),this.fadeOutTween(c));d.end();this.prevDrawGuiMap=this.drawGuiMap;this.drawGuiMap={}}};xf.create=function(a){var b=new xf;b.globals=a;b.controlInfoList=[];b.gameMessages=
{};b.uniqueIDForBubbles=0;b.drawList=[];b.prevDrawGuiMap={};b.drawGuiMap={};return b};aa.prototype={init:function(){this.drawList=[];this.drawBoxThickness=2},preload:function(){var a=this.globals.textureManager;a.load(k.t_block);a.load(k.t_vignette)},drawSmallScreen:function(){var a=this.globals.guiRenderer,b=a.getScaleFactor();this.drawDebugBox(a.v2ScreenCentre,a.SAFE_WIDTH*b,a.SAFE_HEIGHT*b,k.darkBack)},isActive:function(a){return this.activeID===a},isHot:function(a){return this.hotID===a},mouseWentUp:function(){return!this.controller.getGuiDown()&&
this.prevDown},mouseWentDown:function(){return this.controller.getGuiDown()&&!this.prevDown},isMouseDown:function(){return this.controller.getGuiDown()},setNotActive:function(a){this.activeID===a&&(this.activeID=void 0)},setActive:function(a){this.activeID=a},setHot:function(a){this.hotID=a},setNotHot:function(a){this.hotID===a&&(this.hotID=void 0)},validateHot:function(a){this.hotID===a&&(this.hotValidated=!0)},validateActive:function(a){this.activeID===a&&(this.activeValidated=!0)},gobbleCursor:function(){this.gobbled=
!0},gobbleCursorInRadius:function(a,b){var c=this.globals.mathDevice,d=this.controller.getv2ScreenCoord();c.v2DistanceSq(a,d)<b*b&&(this.gobbled=!0)},isMouseCursorFarFromRadius:function(a,b){var c=this.globals.mathDevice,d=this.controller.getv2ScreenCoord();return c.v2DistanceSq(a,d)<b*b?!1:!0},isMouseInside:function(a,b,c){var d=this.globals.mathDevice,c=d.v2Build(0.5*b+0,0.5*c+0),b=d.v2Sub(a,c),a=d.v2Add(a,c),d=this.controller.getv2ScreenCoord();return b[0]>d[0]||b[1]>d[1]||a[0]<d[0]||a[1]<d[1]?
!1:!0},getNormalizedLocationFromScreen:function(a,b){var c=this.globals;return c.camera.screenToNormalised(c.mathDevice.v2Build(a,b))},getScaleFactorFromV2:function(a){if(!a)return 0;var b=this.globals,c=b.graphicsDevice,d=c.width,c=c.height,f=100*this.globals.guiRenderer.getScaleFactor(),e=b.mathDevice,b=e.clamp(a[0],0,d),a=e.clamp(a[1],0,c),e=1;b<f&&(e*=b/f);a<f&&(e*=a/f);b>d-f&&(e*=(d-b)/f);a>c-f&&(e*=(c-a)/f);return e},getRadialScaleFactor:function(a){return 6>=a?1:1.65},getRadialSize:function(a){return 150*
this.globals.guiRenderer.getScaleFactor()*a},getRadialCentre:function(a,b){var c=this.globals,d=c.mathDevice,f=c.graphicsDevice,e=f.width,f=f.height;c.guiRenderer.getScaleFactor();c=this.getRadialSize(b);a[0]=d.clamp(a[0],1.5*c,e-1.5*c);a[1]=d.clamp(a[1],1.5*c,f-1.5*c);return a},addRadialOffset:function(a,b,c,d){var f=this.globals.mathDevice,d=this.getRadialSize(d),e=0;c&&1<c&&(e=2*Math.PI/c);b=f.angleToV2(-(e*(b?b:0)));b=f.v2ScalarMul(b,d,b);return f.v2Add(a,b)},getv2ScreenBarLocation:function(a,
b){var c=this.globals,d=c.mathDevice,c=c.graphicsDevice,f=c.width,e=c.height,c=d.v2Build(40,e-40),f=d.v2Build(f-40,e-40),e=0.5;b&&1<b&&(e=(a?a:0)/(b-1));return d.v2Lerp(c,f,e)},doButtonFromGuiArchetype:function(a,b,c){var d=b.buttonType||aa.BUTTON_NORMAL,f=d.round,e=this.globals.guiRenderer,d=e.getGuiInfo(a).buttonSize||[d.width,d.height],h=e.getScaleFactor(),e=d[0]*h,h=d[1]*h,d=!1,i=this.globals.mathDevice;this.isActive(c)?this.mouseWentUp()&&(this.gameManager.gameSoundManager.play("imguiUp"),d=
!0,this.setNotActive(c)):this.isHot(c)&&this.mouseWentDown()&&(this.gameManager.gameSoundManager.play("imguiDown"),this.setActive(c));var j=this.globals.mathDevice,j=b.v2ScreenLocation||j.v2Build(b.x,b.y);this.isMouseInside(j,e,h,f)?this.isMouseDown()||(this.isHot(c)||this.gameManager.gameSoundManager.play("imguiSelect"),this.setHot(c)):((this.isActive(c)||this.isHot(c))&&this.gameManager.gameSoundManager.play("imguiDeselect"),this.setNotHot(c),this.setNotActive(c));this.validateHot(c);this.validateActive(c);
f=this.gameManager.getGuiManager();b.scale=void 0!==b.scale?b.scale:1;this.isActive(c)?b.scale-=0.075:this.isHot(c)&&(b.scale+=0.075);f.addDrawGui(a,b,c);this.globals.debugDrawFlags.gui&&(a={id:c,width:e,height:h,v2ScreenLocation:i.v2Copy(j)},this.addButtonToDraw(a));return d},doButton:function(a){var b=a.id,c=a.buttonType?a.buttonType:aa.BUTTON_NORMAL,d=c.round,f,e;f=void 0!==a.buttonWidth?a.buttonWidth:c.width?c.width:d?aa.BUTTON_ROUND.width:aa.BUTTON_NORMAL.width;e=void 0!==a.buttonHeight?a.buttonHeight:
c.height?c.height:d?aa.BUTTON_ROUND.height:aa.BUTTON_NORMAL.height;var h=this.globals.guiRenderer,i;if(a.guiArchetype&&(i=h.getGuiInfo(a.guiArchetype))&&i.buttonSize)f=i.buttonSize[0],e=i.buttonSize[1];h=h.getScaleFactor();a.scaleFactor&&(h*=a.scaleFactor);f*=h;e*=h;var j=c.yOffset;i=h=!1;var k=this.globals.mathDevice;this.isActive(b)?(this.mouseWentUp()&&(this.gameManager.gameSoundManager.play("imguiUp"),h=!0,this.setNotActive(b)),i=!0):this.isHot(b)&&(this.mouseWentDown()&&(this.gameManager.gameSoundManager.play("imguiDown"),
this.setActive(b)),i=!0);this.isMouseInside(a.v2ScreenLocation,f,e,d)?this.isMouseDown()||(this.isHot(b)||this.gameManager.gameSoundManager.play("imguiSelect"),this.setHot(b)):((this.isActive(b)||this.isHot(b))&&this.gameManager.gameSoundManager.play("imguiDeselect"),this.setNotHot(b),this.setNotActive(b));this.validateHot(b);this.validateActive(b);var l=a.guiArchetype?a.guiArchetype:c.guiRendererArchetype,m=this.gameManager.getGuiManager();l?(d=1,a.scaleFactor&&(d*=a.scaleFactor),this.isActive(b)?
d-=0.075:this.isHot(b)&&(d+=0.075),c={v2ScreenLocation:k.v2Copy(a.v2ScreenLocation),scale:d,text:a.text,text1:a.text1,text2:a.text2,text3:a.text3,text4:a.text4,text5:a.text5,pointSize:c.pointSize,guiRendererArchetype:c.guiRendererArchetype},m.addDrawGui(l,c,b)):(c={id:b,text:a.text,text1:a.text1,text2:a.text2,text3:a.text3,text4:a.text4,text5:a.text5,v2ScreenLocation:k.v2Copy(a.v2ScreenLocation),width:f,height:e,round:d,guiArchetype:a.guiArchetype,yOffset:j,color:c.color,pointSize:c.pointSize,guiRendererArchetype:c.guiRendererArchetype},
this.addButtonToDraw(c));this.globals.debugDrawFlags.gui&&(c={id:b,width:f,height:e,v2ScreenLocation:k.v2Copy(a.v2ScreenLocation)},this.addButtonToDraw(c));return a.passive?i:h},addButtonToDraw:function(a){a.drawFunction=this.drawButton.bind(this);this.drawList.push(a)},drawButton:function(a){var b=1,c=a.id,d=a.v2ScreenLocation,f=void 0!==a.guiArchetype?a.guiArchetype:a.guiRendererArchetype,e=this.gameManager.getGuiManager();void 0!==f&&(this.isActive(c)?b-=0.075:this.isHot(c)&&(b+=0.075),e.drawGui(f,
{x:d[0],y:d[1],scale:b,text:a.text,text1:a.text1,text2:a.text2,text3:a.text3,text4:a.text4,text5:a.text5},c));this.globals.debugDrawFlags.gui&&this.drawDebugBox(d,a.width,a.height,k.darkBack)},doCustomDialog:function(a){a.custom=!0;this.addDialogToDraw(a)},doDialog:function(a,b,c,d){this.gobbleCursor();var f=this.globals,e=aa.DIALOG_BOX,h=e.width,e=e.height,a={id:a,text:b,v2ScreenLocation:f.mathDevice.v2Copy(c),width:h,height:e,fillColor:k.dialog,borderColor:k.outlineSoft};this.addDialogToDraw(a);
a=this.globals.guiRenderer.getScaleFactor();return d?(c=f.mathDevice.v2Build(c[0]+h/2*a,c[1]+(e/2+40)*a),this.doButton({id:"okButton",text:"Ok",v2ScreenLocation:c,buttonType:aa.DIALOG_OK})):!1},doPagedDialog:function(a,b,c){this.gobbleCursor();var d=this.globals,f=d.mathDevice,e=aa.DIALOG_BOX,h=e.width,i=e.height,e=this.globals.guiRenderer.getScaleFactor(),j=h/2,r=i/2+40,l=b.currentPage?b.currentPage:0,m=b.textArray,q=b.finalButtonText;if(!m||l>=m.length)return!1;var p=0>l-1?l:l-1,s=l+1>=m.length?
l:l+1,d=d.mathDevice,a={id:a,text:m[l],v2ScreenLocation:f.v2Copy(c),width:h,height:i,fillColor:k.dialog,borderColor:k.outlineSoft};this.addDialogToDraw(a);p!==l&&(a=d.v2Build(c[0]-j*e,c[1]+r*e),this.doButton({id:"Back",text:"Back",v2ScreenLocation:a,buttonType:aa.DIALOG_NEXT})&&(l-=1));a=d.v2Build(c[0]+j*e,c[1]+r*e);if(s!==l)this.doButton({id:"Next",text:"Next",v2ScreenLocation:a,buttonType:aa.DIALOG_BACK})&&(l+=1);else if(this.doButton({id:q,text:q,v2ScreenLocation:a,buttonType:aa.DIALOG_OK}))return!0;
b.currentPage=l;return!1},addDialogToDraw:function(a){this.gameManager.getGuiManager().addDrawGui("dialogBox",{x:a.v2ScreenLocation[0],y:a.v2ScreenLocation[1],text:a.text})},doText:function(a,b,c,d){this.addTextToDraw({string:a,x:b[0],y:b[1],alignment:void 0!==d?d:1,pointSize:c,color:k.words,font:"regular"})},doTitle:function(a){this.doText(a,this.globals.guiRenderer.getv2RenderLocation(0,-200),64)},doSubTitle:function(a){this.doText(a,this.globals.guiRenderer.getv2RenderLocation(0,-150),16)},addTextToDraw:function(a){a.drawFunction=
this.drawText.bind(this);this.drawList.push(a)},drawText:function(a){var b=this.globals.guiRenderer.getScaleFactor();a.specialScale=b;this.globals.simpleFontRenderer.drawFont(a.string,a)},doBackground:function(){this.addBackgroundToDraw();this.gobbleCursor()},addBackgroundToDraw:function(){var a={};a.drawFunction=this.drawBackground.bind(this);this.drawList.push(a)},drawBackground:function(){var a=this.globals,b=a.draw2D,c=a.graphicsDevice,d=c.width,c=c.height,f=aa.BACKGROUND.borderThickness;if(a=
a.textureManager.load(k.t_block))b.begin("alpha","texture"),b.draw({texture:a,destinationRectangle:[f,f,d-f,c-f],color:aa.BACKGROUND.color}),b.end()},drawDebugBox:function(a,b,c,d){var f=this.globals,e=f.draw2D;if(f=f.textureManager.load(k.t_block))e.begin("alpha","texture"),e.draw({texture:f,destinationRectangle:[a[0]-0.5*b,a[1]-0.5*c,a[0]+0.5*b,a[1]+0.5*c],color:d}),e.end()},doVignette:function(a,b){this.addVignetteToDraw({id:a,alpha:b})},addVignetteToDraw:function(a){a.drawFunction=this.drawVignette.bind(this);
this.drawList.unshift(a)},drawVignette:function(a){var b=this.globals,c=b.draw2D,d=b.graphicsDevice,f=d.width,d=d.height;if(b=b.textureManager.load(k.t_vignette))c.begin("alpha","texture"),c.draw({texture:b,destinationRectangle:[0,0,f,d],color:[1,1,1,a.alpha]}),c.end()},drawBox:function(a,b,c,d,f){var e=this.globals,h=e.draw2D,i=0.5*k.lineThickness,d=d?d:k.normal,f=f?f:k.outline;if(e=e.textureManager.load(k.t_block))h.begin("alpha","texture"),h.draw({texture:e,destinationRectangle:[a[0]-0.5*b-i,a[1]-
0.5*c-i,a[0]+0.5*b+i,a[1]+0.5*c+i],color:f}),h.draw({texture:e,destinationRectangle:[a[0]-0.5*b,a[1]-0.5*c,a[0]+0.5*b,a[1]+0.5*c],color:d}),h.end()},draw2D:function(){var a,b=this.deadDrawList,c=b.length,d;a=this.globals;var f=a.simpleFontRenderer;a.debugDrawFlags.gui&&this.drawSmallScreen();var e=a.guiRenderer;e.begin();for(a=0;a<c;a+=1)d=b[a],d.drawFunction(d);b=this.drawList;c=b.length;for(a=0;a<c;a+=1)d=b[a],d.drawFunction(d),f.render();e.end()},clearDrawList:function(){this.drawList.length=0},
clearValidation:function(){this.hotValidated||(this.hotID=void 0);this.activeValidated||(this.activeID=void 0);this.activeValidated=this.hotValidated=!1;this.prevGobbled=this.gobbled;this.gobbled=!1;this.prevDown=this.isMouseDown()},hasCapturedInput:function(){return this.hotID||this.activeID||this.prevGobbled?!0:!1}};aa.DIALOG_BOX={width:750,height:80};aa.DIALOG_OK={width:120,height:60,guiRendererArchetype:"dialogButtonOk"};aa.DIALOG_NEXT={width:120,height:60,guiRendererArchetype:"dialogButton"};
aa.DIALOG_BACK={width:120,height:60,guiRendererArchetype:"dialogButton"};aa.DIALOG_SMALL={width:850,height:150};aa.BUTTON_IN_GAME_TINY={width:55,height:55};aa.BUTTON_IN_GAME={width:110,height:55};aa.BUTTON_WIDE={width:555,height:85};aa.BUTTON_NORMAL={guiRendererArchetype:"button",width:370,height:85};aa.BUTTON_NORMAL_HALF={width:185,height:85};aa.BUTTON_ROUND={width:70,height:70,round:!0};aa.BACKGROUND={borderThickness:0,color:k.modalBack};aa.create=function(a,b,c){var d=new aa;d.globals=a;d.gameManager=
b;d.controller=c;d.deadDrawList=[];d.drawList=[];d.drawBoxThickness=2;d.drawMap={};d.prevDrawMap={};return d};var sa={doCampaignStartBookend:function(a,b,c,d){var f=b.currentLanguage,e=c.getEC("ECWarManager"),c=e.getCampaignArchetypeName(d),c=ca[c],h=c.nameTextId||"INFO_PANEL_CAMPAIGN_DUMMY_NAME",i=c.descriptionTextId||"INFO_PANEL_CAMPAIGN_DUMMY_DESC",j=f.INFO_PANEL_CAMPAIGN_LEVEL+" "+(void 0!==c.level?c.level:1),j=j.toUpperCase(),h=f[h].toUpperCase(),i=f[i].toUpperCase(),k=f.INFO_PANEL_START_CAMPAIGN_BUTTON.toUpperCase(),
l=e.getNumberOfBattlesInCampaign(d),m=1===l?f.INFO_PANEL_BATTLE:f.INFO_PANEL_BATTLES,m=m.toUpperCase(),l=l+" "+m.toString(),m=Math.round(c.maxResourceBonusList[0]).toString(),q=Math.round(c.maxResourceBonusList[1]).toString(),p=Math.round(c.maxXpBonus).toString(),d=e.getNextBattleArchetypeQuantities(d),d=sa.getEnemyQuantityInfo(a,f,d);return sa.doInfoPanel(a,b,{topBackgroundArea:"topBackgroundArea",middleBackgroundArea:"middleBackgroundArea",bottomBackgroundArea:"bottomBackgroundArea",closeButton:"closeButton",
upgradeButton:"upgradeButton",flag:"flag",contentList:["numberOfBattlesBar","enemyQuantities","maxRewardTitleBar","maxRewardBars"]},{titleText:h,subTitleText:j,descriptionText:i,buttonText:k,maxRewardsTitleBarText:f.INFO_PANEL_MAX_REWARD_TITLE,numberOfBattlesText:l,maxPrimaryResourceRewardText:m,maxSecondaryResourceRewardText:q,maxXpRewardText:p,enemyArchetypeSpritePathList:d.enemySpritePathList,enemyNameList:d.enemyDisplayNameList,flagGuiArchetype:bk[c.flag||"basic"]})},doCampaignEndBookend:function(a,
b,c,d){var f=b.currentLanguage,e=f[c.nameTextId||"INFO_PANEL_CAMPAIGN_DUMMY_NAME"],h=f.INFO_PANEL_END_CAMPAIGN_BUTTON.toUpperCase(),i=d.wasVictory,j;i?(j=f.INFO_PANEL_CAMPAIGN_END_VICTORY,e=f.INFO_PANEL_CAMPAIGN_END_VICTORY_DESCRIPTION+" "+e):(j=f.INFO_PANEL_CAMPAIGN_END_DEFEAT,e=f.INFO_PANEL_CAMPAIGN_END_DEFEAT_DESCRIPTION+" "+e);j=j.toUpperCase();var e=e.toUpperCase(),k=d.resourceBonusList,l=k[1],m=d.xpBonus,k=Math.round(k[0]).toString(),l=Math.round(l).toString(),m=Math.round(m).toString(),q=d.starStatusList,
p=q.length,d=d.grade,c=bk[c.flag||"basic"],f={titleText:j,descriptionText:e,buttonText:h,rewardsTitleBarText:f.INFO_PANEL_REWARD_TITLE.toUpperCase(),primaryResourceRewardText:k,secondaryResourceRewardText:l,xpRewardText:m,starStatusList:q,grade:d,maxGradePossible:p,flagGuiArchetype:c},h=["starAchievedBars"];i&&(h.push("starCountBar"),h.push("rewardTitleBar"),h.push("rewardBars"));return sa.doInfoPanel(a,b,{topBackgroundArea:"topBackgroundAreaCampaignEnd",middleBackgroundArea:"middleBackgroundArea",
bottomBackgroundArea:"bottomBackgroundArea",closeButton:"closeButton",upgradeButton:"upgradeButton",flag:"flag",contentList:h},f)},doUpgradeInfoPanel:function(a,b,c){var d=c.getEC("ECUpgradable"),c=c.archetypeName,f=d.getUpgradeArchetypeName(),e=a.getEntityFactory().getECArchetype(f,"ECBuilding").level,h=d.getUpgradeInfo(),i=b.currentLanguage,j=i[h.buildingNameTextId],e=Math.floor(e).toString(),k=i.INFO_PANEL_UPGRADE_BUTTON+" "+e,l=i.INFO_PANEL_TO_LEVEL,i={titleText:j,subTitleText:l+(" "+e),descriptionText:i[h.buildingDescriptionTextId],
buttonText:k},i=sa.addResourceCostInfo(c,f,a,b,i),i=sa.addResourceAvailableInfo(c,f,a,b,i),i=sa.addBuildDurationInfo(c,f,a,b,i),i=sa.addHealthBoostInfo(c,f,a,b,i),i=sa.addNewBuildOptionsInfo(c,f,a,b,i),i=sa.addResourceStorageBoostInfo(c,f,a,b,i),i=sa.addWildlingBoostInfo(c,f,a,b,i),c=h.contentsList.slice(),c=sa.removeZeroDifferenceUpgradeComponents(i,c);return(b=sa.doInfoPanel(a,b,{topBackgroundArea:"topBackgroundArea",middleBackgroundArea:"middleBackgroundArea",bottomBackgroundArea:"bottomBackgroundArea",
closeButton:"closeButton",upgradeButton:"upgradeButton",contentList:c},i))?("confirm"===b&&(a=a.getHero(),d.attemptToPurchaseUpgrade(a)),!0):!1},doTaskDescription:function(a,b,c){var d=b.currentLanguage,c={titleText:d[c.titleTextId],subTitleText:" ",descriptionText:" ",taskDescriptionText:d[c.descriptionTextId],buttonText:d.INFO_PANEL_TASK_DESCRIPTION_BUTTON,descriptionSpritePath:c.descriptionSpritePath},d={topBackgroundArea:"topBackgroundArea",middleBackgroundArea:"middleBackgroundArea",bottomBackgroundArea:"bottomBackgroundArea",
closeButton:"closeButton",upgradeButton:"upgradeButton",contentList:["taskDescriptionBox"].slice()};return sa.doInfoPanel(a,b,d,c)},doTaskComplete:function(a,b,c){var d=b.currentLanguage,c={titleText:d[c.titleTextId],subTitleText:" ",descriptionText:" ",taskCompletionText:d[c.completionTextId],buttonText:d.INFO_PANEL_TASK_COMPLETE_BUTTON,completeSpritePath:c.completeSpritePath},d={topBackgroundArea:"topBackgroundArea",middleBackgroundArea:"middleBackgroundArea",bottomBackgroundArea:"bottomBackgroundArea",
closeButton:"closeButton",upgradeButton:"upgradeButton",contentList:["taskCompleteBox"].slice()};return sa.doInfoPanel(a,b,d,c)},getArchetypesOfSameFamily:function(a,b){var c=a.getEntityFactory(),d=c.getEntityArchetype(b).familyName;return c.getArchetypesOfFamilyName(d)},getMaxECParamInArchetypeList:function(a,b,c){for(var d=a.length,f=0,e=0;e<d;e+=1){var h=a[e][b];h&&(f=Math.max(f,h[c]))}return f},addResourceCostInfo:function(a,b,c,d,f){a=d.currentLanguage;c=c.getEntityFactory();f.lumberText=a.INFO_PANEL_LUMBER;
f.stoneText=a.INFO_PANEL_STONE;b=c.getECArchetype(b,"ECBuilding");f.primaryResourceCost=b.resourceCost;f.secondaryResourceCost=b.secondaryResourceCost;return f},addResourceAvailableInfo:function(a,b,c,d,f){a=c.getHero().getEC("ECPlayerData");f.primaryResourceAvailable=a.getResource(E.LUMBER);f.secondaryResourceAvailable=a.getResource(E.STONE);return f},addBuildDurationInfo:function(a,b,c,d,f){a=d.currentLanguage;b=c.getEntityFactory().getECArchetype(b,"ECBuilding").buildTime;f.buildDurationText=sa.getBuildDurationText(b,
a);return f},addHealthBoostInfo:function(a,b,c,d,f){var e=d.currentLanguage,d=c.getEntityFactory();f.healthText=e.INFO_PANEL_HEALTH;b=d.getECArchetype(b,"ECHealth");d=d.getECArchetype(a,"ECHealth");a=sa.getArchetypesOfSameFamily(c,a);f.maxHealthPreUpgrade=d.health;f.maxHealthPostUpgrade=b.health;f.maxHealthPossible=sa.getMaxECParamInArchetypeList(a,"ECHealth","health");return f},addNewBuildOptionsInfo:function(a,b,c,d,f){d=d.currentLanguage;c=c.getEntityFactory();d=d.INFO_PANEL_NEW_BUILD_OPTIONS;
f.newBuildOptionsTitleText=d;a=sa.getNewBuildOptionsText(a,b,c);f.newBuildOptionsText=d+a;return f},addResourceStorageBoostInfo:function(a,b,c,d,f){var e=d.currentLanguage,d=c.getEntityFactory();f.lumberStorageText=e.INFO_PANEL_LUMBER_STORAGE;f.stoneStorageText=e.INFO_PANEL_STONE_STORAGE;e=d.getECArchetype(a,"ECResourceStorage");b=d.getECArchetype(b,"ECResourceStorage");if(e&&b){f.maxPrimaryResourceStoragePreUpgrade=e.maxResource[0];f.maxSecondaryResourceStoragePreUpgrade=e.maxResource[1];f.maxPrimaryResourceStoragePostUpgrade=
b.maxResource[0];f.maxSecondaryResourceStoragePostUpgrade=b.maxResource[1];d=b=0;a=sa.getArchetypesOfSameFamily(c,a);c=a.length;for(e=0;e<c;e+=1){var h=a[e].ECResourceStorage;h&&(b=Math.max(b,h.maxResource[0]),d=Math.max(d,h.maxResource[1]))}f.maxPrimaryResourceStoragePossible=b;f.maxSecondaryResourceStoragePossible=d}return f},addWildlingBoostInfo:function(a,b,c,d,f){var e=d.currentLanguage,d=c.getEntityFactory();f.wildlingPrimaryResourceCollectionText=e.INFO_PANEL_LUMBER_COLLECTION_RATE;f.wildlingSecondaryResourceCollectionText=
e.INFO_PANEL_STONE_COLLECTION_RATE;a=d.getECArchetype(a,"ECWildlingHouse");b=d.getECArchetype(b,"ECWildlingHouse");a&&b&&(a=a.wildlingArchetype,e=b.wildlingArchetype,b=d.getECArchetype(a,"ECWildlingAgent"),d=d.getECArchetype(e,"ECWildlingAgent"),c=sa.getArchetypesOfSameFamily(c,a),c=sa.getMaxECParamInArchetypeList(c,"ECWildlingAgent","onlineResourcePerMinute"),f.wildlingResourceCollectionRatePreUpgrade=60*b.onlineResourcePerMinute,f.wildlingResourceCollectionRatePostUpgrade=60*d.onlineResourcePerMinute,
f.wildlingResourceCollectionRateMaxPossible=60*c);return f},doInfoPanel:function(a,b,c,d){var f=b.mathDevice,e=f.v2Build(0.75,0.75),h=sa.componentDescMap,i=sa.getComponentListFromComponentNameList(c.contentList),j=sa.doInfoPanelBackground(a,b,c,d,i,e),f=f.v2Copy(j.v2CloseButtonLocation);if(sa.doComponent(a,b,h[c.closeButton],f,e,d))return"close";if(sa.doComponent(a,b,h[c.upgradeButton],j.v2ButtonLocation,e,d))return"confirm";sa.doComponentList(a,b,i,j.v2ContentAreaLocation,540,e,d);return""},doInfoPanelBackground:function(a,
b,c,d,f,e){var h=b.mathDevice,i=sa.componentDescMap,j=i[c.topBackgroundArea],k=sa.getComponentHeight(j,e,d),l=sa.calculateComponentListHeight(f,e,d),m=i[c.bottomBackgroundArea],q=sa.getComponentHeight(m,e,d),f=h.v2Build(0,78-(k+l+q)/2),p=k/2,k=h.v2Copy(f),s=i[c.middleBackgroundArea],t=sa.getComponentHeight(s,e,d),u=l/t,l=h.v2Build(1,u);h.v2Mul(e,l,l);u=t*u/2;t=h.v2Build(0,p+u);h.v2Add(k,t,t);sa.doComponent(a,b,s,t,l,d);sa.doComponent(a,b,j,f,e,d);c.flag&&sa.doComponent(a,b,i[c.flag],k,e,d);c=h.v2Build(0,
u+q/2);h.v2Add(t,c,c);sa.doComponent(a,b,m,c,e,d);a=h.v2Build(0,p);h.v2Add(k,a,a);return{v2CloseButtonLocation:f,v2ButtonLocation:c,v2ContentAreaLocation:a}},doComponentList:function(a,b,c,d,f,e,h){for(var i,j,k=c.length,l=b.mathDevice.v2Copy(d),m,d=0;d<k;d+=1){j=c[d];i=sa.getComponentRowHeight(j,e);i/=2;m=[];j.listElementComponent&&(m=h[j.dataListId],j.componentList=sa.generateComponentListFromComponent(j,m));m=j.componentList?sa.getComponentListFromComponentNameList(j.componentList):[j];j=j.numberOfComponentsPerRow||
1;for(var q=Math.ceil(m.length/j),p=0;p<q;p+=1){l[1]+=i;var s=p*j,s=m.slice(s,s+j);sa.doInnerComponentList(a,b,s,l,e,f,h,p*j);l[1]+=i}}},generateComponentListFromComponent:function(a,b){for(var c=b.length,d=a.listElementComponent,f=[],e=0;e<c;e+=1)f.push(d);return f},doInnerComponentList:function(a,b,c,d,f,e,h,i){for(var j=c.length,k,l,m=b.mathDevice,e=e*f[0],e=e/j,d=m.v2Build(d[0]+-((j-1)/2*e),d[1]),q=m.v2Build(e,0),e=0;e<j;e+=1)l=c[e],k=i+e,sa.doComponent(a,b,l,d,f,h,k),m.v2Add(q,d,d)},doComponent:function(a,
b,c,d,f,e,h){var i=b.mathDevice,j=b.guiRenderer,b=sa.componentMap,k=c.type;if(c.v2Offset){var l=i.v2Copy(c.v2Offset);i.v2Mul(f,l,l);d=i.v2Add(l,d)}d=j.getv2RenderLocation(d[0],d[1]);f||(f=i.v2BuildOne());return b[k](a,c,d,f,e,h)},calculateComponentListHeight:function(a,b,c){var d=a.length,f=0,e,h;for(e=0;e<d;e+=1)h=a[e],f+=sa.getComponentHeight(h,b,c);return f},getComponentRowHeight:function(a,b){return a.v2Size[1]*b[1]},getComponentHeight:function(a,b,c){var d=1,f=a.numberOfComponentsPerRow||1;a.dataListId?
d=c[a.dataListId].length:a.componentList&&(d=a.componentList.length);c=Math.ceil(d/f);return a.v2Size[1]*b[1]*c},getComponentListFromComponentNameList:function(a){var b=a.length,c=[],d,f;for(f=0;f<b;f+=1)d=a[f],d=sa.componentDescMap[d],c.push(d);return c},getBuildDurationText:function(a,b){var c=a%60,d=Math.floor(a/3600),f=Math.floor(a/60)-60*d,e="",h=1<d?b.INFO_PANEL_HOURS:b.INFO_PANEL_HOUR,i=1<f?b.INFO_PANEL_MINUTES:b.INFO_PANEL_MINUTE,j=1<c?b.INFO_PANEL_SECONDS:b.INFO_PANEL_SECOND;d&&(e+=d.toString()+
" "+h+" ");f&&(e+=f.toString()+" "+i+" ");if(!e||c)e+=c.toString()+" "+j;return e+=" "+b.INFO_PANEL_TO_BUILD},getNewBuildOptionsText:function(a,b,c){var d=c.getECArchetype(a,"ECBuilding"),f=c.getECArchetype(b,"ECBuilding"),a=c.getECArchetype(a,"ECPlacedBuildingTracker"),e=c.getECArchetype(b,"ECPlacedBuildingTracker"),c=[],b=[];d.globalCaps&&c.push.apply(c,d.globalCaps);f.globalCaps&&b.push.apply(b,f.globalCaps);a&&a.localCaps&&c.push.apply(c,a.localCaps);e&&e.localCaps&&b.push.apply(b,e.localCaps);
d="";f={};c.reduce(function(a,b){a[b.buildingType]=b.quantity;return a},f);a={};b.reduce(function(a,b){a[b.buildingType]=b.quantity;return a},a);for(var h in a)a.hasOwnProperty(h)&&(b=a[h]-(f[h]||0))&&(d+=h+" (+"+b.toString()+"), ");return d=d.slice(0,-2)},getEnemyQuantityInfo:function(a,b,c){var a=a.getEntityFactory(),d={},f=[],e=[],h;for(h in c)if(c.hasOwnProperty(h)){var i=a.getEntityArchetype(h).familyName;if(!d[i]&&"bannerling"!==i){d[i]=!0;var i=a.getECArchetype(h,"ECAgent"),j=i.iconSpritePath;
f.push(b[i.displayNameTextId]);e.push(j)}}return{enemyDisplayNameList:f,enemySpritePathList:e}},removeZeroDifferenceUpgradeComponents:function(a,b){if(a.newBuildOptionsText===a.newBuildOptionsTitleText){var c=b.indexOf("newBuildOptionsBox");-1!==c&&b.splice(c,1)}a.maxPrimaryResourceStoragePostUpgrade-a.maxPrimaryResourceStoragePreUpgrade||(c=b.indexOf("lumberStorageBoostBar"),-1!==c&&b.splice(c,1));a.maxSecondaryResourceStoragePostUpgrade-a.maxSecondaryResourceStoragePreUpgrade||(c=b.indexOf("stoneStorageBoostBar"),
-1!==c&&b.splice(c,1));return b},componentMap:{textBar:function(a,b,c,d,f,e){var h;h=b.textListId?f[b.textListId][e]:f[b.textId];var i=b.guiArchetype,j;b.spritePathListId&&(j=f[b.spritePathListId][e]);c={x:c[0],y:c[1],scaleX:d[0],scaleY:d[1],text1:h,sprite1:j};a.getGuiManager().addDrawGui(i,c,"idTextBar"+b.name+e)},progressBar:function(a,b,c,d,f,e){var h=f[b.progressBarTotalQuantityId],i=Math.floor(h).toString(),j=f[b.progressBarCurrentQuantityId]/h,j=Math.min(j,1),h=b.guiArchetype,c={x:c[0],y:c[1],
scaleX:d[0],scaleY:d[1],text1:i+" "+f[b.textId],scale1:j};a.getGuiManager().addDrawGui(h,c,"idProgressBar"+b.name+e)},statBoostBar:function(a,b,c,d,f,e){var h=f[b.preUpgradeStatId],i=f[b.postUpgradeStatId],j=f[b.maxPossibleStatId],k,l=i/j;k=Math.min(h/j,1);l=Math.min(l,1);j=b.guiArchetype;c={x:c[0],y:c[1],scaleX:d[0],scaleY:d[1],text1:Math.floor(h).toString()+" "+f[b.textId],text2:"+"+Math.floor(i-h).toString(),scale1:k,scale2:l};a.getGuiManager().addDrawGui(j,c,"idstatBoostBar"+b.name+e)},starBar:function(a,
b,c,d,f,e){var h=f[b.starStatusListId][e],f=sa.starGuiArchetypeMap[h.starName][h.achieved?0:1],c={x:c[0],y:c[1],scaleX:d[0],scaleY:d[1],text1:h.displayText,text2:h.value};a.getGuiManager().addDrawGui(f,c,"idStarBar"+b.name+e)},starCountBar:function(a,b,c,d,f){var e=a.getGuiManager(),h=a.globals.mathDevice,i=f.maxGradePossible,f=f.grade,j=b.horizontalStarSeparation,j=j*a.globals.guiRenderer.getScaleFactor()*d[0],a=c[0],k=c[1],a=a-Math.floor(i/2)*j,l=b.achievedStarGuiArchetype,m=b.unachievedStarGuiArchetype,
c={x:c[0],y:c[1],scaleX:d[0],scaleY:d[1]};e.addDrawGui(b.backgroundGuiArchetype,c);var q;for(q=0;q<i;q+=1)c=h.v2Build(a,k),b=q<f?l:m,c={x:c[0],y:c[1],scaleX:d[0],scaleY:d[1]},e.addDrawGui(b,c,"idStarStatic"+q),a+=j},flag:function(a,b,c,d,f,e){f=f.flagGuiArchetype;c={x:c[0],y:c[1],scaleX:d[0],scaleY:d[1]};a.getGuiManager().addDrawGui(f,c,"idFlag"+b.name+e)},graphic:function(a,b,c,d,f,e){var h=b.guiArchetype,c={x:c[0],y:c[1],scaleX:d[0],scaleY:d[1],text1:b.text1Id?f[b.text1Id]:void 0,text2:b.text2Id?
f[b.text2Id]:void 0,text3:b.text3Id?f[b.text3Id]:void 0,sprite1:b.spritePathId?f[b.spritePathId]:void 0};a.getGuiManager().addDrawGui(h,c,"idGraphic"+b.name+e)},button:function(a,b,c,d,f,e){var h=b.guiArchetype,e="idbutton"+h+e,f=b.textId?f[b.textId]:void 0,b=a.globals.mathDevice.v2Mul(b.v2Size,d),c={id:e,text1:f,v2ScreenLocation:c,buttonType:a.BUTTON_NORMAL,scaleFactor:d[0],buttonWidth:b[0],buttonHeight:b[1],guiArchetype:h};return a.getIMGui().doButton(c)},textBox:function(a,b,c,d,f){c={x:c[0],y:c[1],
scaleX:d[0],scaleY:d[1],text1:f[b.text1Id],text2:f[b.text2Id]};b=b.guiArchetype;a.getGuiManager().addDrawGui(b,c)}}};yf.prototype={draw2D:function(a,b){var c=this.globals,d=c.mathDevice,f=c.graphicsDevice.width;this.smallScaleFactor=aa.scaleFactor;void 0===this.smallScaleFactor&&(this.smallScaleFactor=1);var e=c.gameManager.getPlayFlags(),h=c.guiRenderer;h.begin();e.displayRank&&this.drawRanking(b);e.displayResource&&(this.drawResourceBar(b,E.LUMBER),this.drawResourceBar(b,E.STONE));e.displaySoftCurrency&&
this.drawSoftCurrency(b);e.displayHQHealth&&this.drawHQHealth(b,1);e.displayNextInvasionDescription&&(d=d.v2Build(225,-100),this.drawNextInvasionDescription(b,d));e.displayClock&&(d=h.getv2RenderLocation(100,-100,"bottomLeft",v2TempLocation),this.drawGameDayNightClock(d[0],d[1]));if(e.displayWarCompassPrepare||e.displayWarCompassInvasion)if(d=b.getGameSpace().getEntitiesWithEC("ECWarManager")[0].getEC("ECWarManager"))if(e.displayWarCompassPrepare)this.drawWarCompassPrepare(this.prepareTimeRemaining);
else{var i=d.getActiveCampaignRegionName(),e=d.getCurrentBattleKilledEnemyCount(i),d=d.getNextBattleEnemyCount(i);this.drawWarCompassInvasion(e,d)}h.end();this.globals.debugDrawFlags.gameTime&&this.drawGameTime(95,400,0);this.globals.debugDrawFlags.warInfo&&this.drawWarInfo(95,450,0);this.globals.debugDrawFlags.taskInfo&&this.drawTaskInfo(300,150,0,25);this.globals.debugDrawFlags.requestCount&&this.drawRequestCount(95,450);c.debugDrawFlags.defenceRating&&this.drawGameDefence(f/2,250,1)},setPrepareTimeRemaining:function(a){this.prepareTimeRemaining=
a},getFlashFactor:function(a){return 0<a?1+0.25*Math.max(1-1.5*a,0):1},drawSoftCurrency:function(a){var b=a.getEC("ECPlayerData"),c=this.getFlashFactor(b.getTimeSinceAddedSoftCurrency()),d=this.globals,a=d.gameManager.getGuiManager(),b={scale:c,text:d.simpleFontRenderer.numberToCommaString(b.getVisibleSoftCurrency()),completeFactor:0.65};a.addDrawGui("resourceAmberTotal",b,"idResourceAmber")},getPulse:function(a){return 1+Math.sin(10*this.globals.appCurrentTime)*a},drawTitleText:function(a,b,c,d){var f=
this.globals.simpleFontRenderer,e=this.smallScaleFactor,h=120*e;0===d&&(b-=0.5*h);2===d&&(b+=0.5*h);f.drawFontDouble(a,{x:b,y:c-50*e,alignment:d,pointSize:32*e,color:k.words})},drawRanking:function(a){if(a=a.getEC("ECPlayerData")){var b=a.getVisibleXP(),c=a.getVisibleRank(),d=a.getVisibleNextRankXP(),f=a.getVisibleCurrentRankXP();void 0!==d?(b-=f,d=b/(d-f),f=Math.round(b).toString()):(f="0",d=1);var f=f+" XP",b=Math.round(c).toString(),c=a.getTimeSinceAddedXP(),e=this.getFlashFactor(c),c=a.canUpgrade(),
e=e*this.getPulse(c?0.016:0),f={text1:b,text2:f,scale:e,scale1:d},b=c?"rankUpgrade":"rank",d=this.globals.gameManager.getGuiManager();d.addDrawGui(b,f,"idRanking");c&&(a=a.getLevel()-a.getUpgradedLevel(),d.addDrawGui("heroUpgradeNote",{text1:a+" HERO UPGRADE",text2:"GO TO A TOTEM!"},"idRankingUpgrade"))}},drawGameTime:function(a,b,c){var d=this.globals.gameCurrentTime,f=Math.floor(d/3600),d=d%3600,e=Math.floor(d/60),d=Math.floor(d%60);this.drawTitleText(f+":"+(10>e?"0":"")+e+":"+(10>d?"0":"")+d,a,
b,c)},drawWarInfo:function(a,b,c){var d=this.globals.gameManager,f=d.getFirstEntityWithEC("ECWarManager");if(f&&(f=f.getEC("ECWarManager"))){var e=f.getActiveCampaignArchetypeName(),f=this.warInfoData;if(e){f=this.warInfoData=this.warInfoData?this.warInfoData:{};f.activeCampaignArchetypeName=e;var h=d.getBuildingManager(),i=h.getBuildingByType("HQ"),j=0;i&&(j=i.getLevel());f.hqLevel=j;f.numberOfOutposts=h.getBuildingCount("Outpost");h=[0,0];i=d.getTotalRepairCost();f.totalRepairCost=i;h[0]-=i[0];
h[1]-=i[1];d=d.getScoreInfo();f.scoreInfoExists=!1;d&&(f.scoreInfoExists=!0,i=d.getResourceLost(),f.resourceLost=i,h[0]-=i[0],h[1]-=i[1],d=d.getTotalResourceCollected(),f.totalResourceCollected=d,h[0]+=d[0],h[1]+=d[1]);e=ca[e].maxResourceBonusList;f.reward=e;h[0]+=e[0];h[1]+=e[1];f.netResources=h}f&&(this.drawTitleText("Active Campaign : "+f.activeCampaignArchetypeName,a,b,c),b+=30,this.drawTitleText("HQ Level : "+f.hqLevel,a,b,c),b+=30,this.drawTitleText("Number Of Outposts : "+f.numberOfOutposts,
a,b,c),b+=30,this.drawTitleText("Repair Cost : ",a,b,c),this.drawTitleText(Math.round(f.totalRepairCost[E.LUMBER]).toString()+" lm ",a+300,b,c),this.drawTitleText(Math.round(f.totalRepairCost[E.STONE]).toString()+" st",a+500,b,c),b+=30,f.scoreInfoExists&&(this.drawTitleText("Resource Lost : ",a,b,c),this.drawTitleText(Math.round(f.resourceLost[E.LUMBER]).toString()+" lm ",a+300,b,c),this.drawTitleText(Math.round(f.resourceLost[E.STONE]).toString()+" st",a+500,b,c),b+=30,this.drawTitleText("Resource Collected : ",
a,b,c),this.drawTitleText(Math.round(f.totalResourceCollected[E.LUMBER]).toString()+" lm ",a+300,b,c),this.drawTitleText(Math.round(f.totalResourceCollected[E.STONE]).toString()+" st",a+500,b,c),b+=30),this.drawTitleText("Campaign Reward : ",a,b,c),this.drawTitleText(Math.round(f.reward[E.LUMBER]).toString()+" lm ",a+300,b,c),this.drawTitleText(Math.round(f.reward[E.STONE]).toString()+" st",a+500,b,c),b=b+30+30,this.drawTitleText("Net Gain : ",a,b,c),this.drawTitleText(Math.round(f.netResources[E.LUMBER]).toString()+
" lm ",a+300,b,c),this.drawTitleText(Math.round(f.netResources[E.STONE]).toString()+" st",a+500,b,c))}},drawTaskInfo:function(a,b,c,d){var f=this.globals.gameManager.getPlayerData().getTaskFlags(),e;for(e in f)if(f.hasOwnProperty(e)){var h=e+": ",h=h+(f[e]?"complete":"incomplete");this.drawTitleText(h,a,b,c);b+=d}},drawRequestCount:function(a,b){var c=La.NUMBER_OF_POST_REQUESTS,d="POST requests per second: "+(c/this.globals.gameCurrentTime).toFixed(2).toString(),c="Number of POST requests: "+c;this.drawTitleText(d,
a,b,0);this.drawTitleText(c,a,b+50,0)},drawWarCompassPrepare:function(a){var b=Math.floor(a/60),a=Math.round(a%60),b={text:b.toString()+":"+(10>a?"0"+a.toString():a.toString())};this.globals.gameManager.getGuiManager().addDrawGui("war_compass_prepare",b,"idWarCompassPrepare")},drawWarCompassInvasion:function(a,b){var c=this.globals.mathDevice,c=0<b?c.saturate(a/b):1,c={text:Math.floor(100*c).toString()+"%"};this.globals.gameManager.getGuiManager().addDrawGui("war_compass_invasion",c,"idWarCompassInvasion")},
drawGameDefence:function(a,b,c){var d=this.globals.gameManager.getBuildingManager(),f=d.getDefenceLevel(),d=d.getDefenceRating();this.drawTitleText("Defence Level = "+f+", Raw Defence Score = "+d,a,b,c)},drawResourceBar:function(a,b){var c=a.getEC("ECPlayerData");if(!c)return!1;var d=c.getVisibleResource(b),f=c.getResourceCap(b),e=0;0<f&&(e=d/f);var e=Math.min(e,1),c=c.getTimeSinceAddedResource(b),c=this.getFlashFactor(c),h=1<=e,c=c*this.getPulse(h?0.016:0),i=this.globals.simpleFontRenderer,d=i.numberToCommaString(Math.floor(d)),
f=i.numberToCommaString(Math.floor(f)),e={scale:c,completeFactor:e,text1:d,text2:f+" max"+(h?" (Full)":"")};this.globals.gameManager.getGuiManager().addDrawGui(Za[b].barGUI,e,"idResourcebar"+Za[b].string);return!0},drawHQHealth:function(a){var b=this.globals.gameManager,c;if(a&&b&&(a=a.getEC("ECFaction")))if(a=a.getFactionName(),b=b.getFactionManager())(b=b.getFactionByName(a))&&(c=b.getHQ());if(c&&(c=c.getEC("ECHealth")))b=c.getHealth(),a=c.getMaxHealth(),b=0<a?b/a:0,c=c.getTimeSinceHealthChange(),
c=this.getFlashFactor(c),c={scale:c,completeFactor:b},this.globals.gameManager.getGuiManager().addDrawGui("hqHealthBar",c,"idHQHealth")},drawNextInvasionDescription:function(a,b){var c=this.globals.guiRenderer,d=a.getGameSpace().getEntitiesWithEC("ECWarManager")[0].getEC("ECWarManager"),f=d.getActiveCampaignRegionName(),d=d.getNextBattleArchetypeQuantities(f),g,h;for(g in d)d.hasOwnProperty(g)&&(h=d[g],f=c.getv2RenderLocation(b[0],b[1],"bottomLeft"),f={x:f[0],y:f[1],text:""},f.text=h.toString(10),
h=(h=e.archetypes[g])&&h.familyName?h.familyName:g,this.globals.gameManager.getGuiManager().addDrawGui(h+"_quantity",f,"idNextInvasionInfo "+h),b[0]+=40)},drawSprite:function(a,b,c,d,f,e,h){var i=this.globals.draw2D;a.x=b;a.y=c;a.rotation=e;a.setColor(h);a.setScale([d,f]);i.drawSprite(a)},preload:function(){this.loadAndCreateSprite("textures/heart.dds","spriteHeart");this.loadAndCreateSprite("textures/block.dds","spriteBlock")},loadAndCreateSprite:function(a,b){var c=this;this.globals.textureManager.load(a,
!1,function(a){c[b]=Pa.create({texture:a,color:[1,1,1,1],width:1,height:1,x:0,y:0})})},reset:function(){}};yf.create=function(a,b){var c=new yf;c.globals=a;c.imgui=b;c.prepareTimeRemaining=0;c.reset();return c};zf.prototype={addGameEntity:function(a){this.entityList.push(a);this.refreshGameEntityLists(a);var b=a.getEC("ECPhysicsSphere"),c;b&&(c=this.globals.mathDevice,this.physSphereList.push(b),c.aabbEnclosesPoint(this.extents,a.getv3Location())&&(this.physPointList.push(b),this.physics||this.gameGrid.addGridSquareToPhysics(this),
this.physics=!0))},removeGameEntity:function(a){var b=this.entityList.indexOf(a);0<=b&&this.entityList.splice(b,1);this.removeEntityFromUpdateList(a);this.removeEntityFromDrawList(a);if(a=a.getEC("ECPhysicsSphere"))b=this.physSphereList.indexOf(a),0<=b&&this.physSphereList.splice(b,1),b=this.physPointList.indexOf(a),0<=b&&(this.physPointList.splice(b,1),(this.physics=0<this.physPointList.length)||this.gameGrid.removeGridSquareFromPhysics(this))},refreshGameEntityLists:function(a){a.shouldUpdate()?
this.addEntityToUpdateList(a):this.removeEntityFromUpdateList(a);a.shouldDraw()?this.addEntityToDrawList(a):this.removeEntityFromDrawList(a)},addEntityToUpdateList:function(a){a&&-1===this.entityUpdateList.indexOf(a)&&this.entityUpdateList.push(a)},removeEntityFromUpdateList:function(a){a&&(a=this.entityUpdateList.indexOf(a),0<=a&&this.entityUpdateList.splice(a,1))},addEntityToDrawList:function(a){a&&-1===this.entityDrawList.indexOf(a)&&this.entityDrawList.push(a)},removeEntityFromDrawList:function(a){a&&
(a=this.entityDrawList.indexOf(a),0<=a&&this.entityDrawList.splice(a,1))},hasEntities:function(){return 0<this.entityList.length},applyToGameEntities:function(a,b){var c,d=this.entityList,f=d.length,e;for(c=0;c<f;c+=1)e=d[c],b[e.name]||(a(e),b[e.name]=!0)},hasUpdatingEntities:function(){return 0<this.entityList.length},applyToUpdatingGameEntities:function(a,b){var c,d=this.entityUpdateList,f=d.length,e;for(c=0;c<f;c+=1)e=d[c],b[e.name]||(a(e),b[e.name]=!0)},applyToDrawnGameEntities:function(a,b){var c,
d=this.entityDrawList,f=d.length,e;for(c=0;c<f;c+=1)e=d[c],b[e.name]||(a(e),b[e.name]=!0)},applyToPhysicsSpheres:function(a,b){var c,d=this.physSphereList,f=d.length,e;for(c=0;c<f;c+=1)e=d[c],b[e.entity.name]||(a(e),b[e.entity.name]=!0)},debugDraw:function(){var a=this.globals,b=a.debugDraw,c=a.mathDevice,d=c.v3Copy(this.v3Location),a={};this.applyToUpdatingGameEntities(function(a){a=c.v3Copy(a.getv3Location());a[1]+=1;d[1]=a[1];b.drawDebugLine(d,a,1,0.25,0.25)},a);this.applyToGameEntities(function(a){a=
c.v3Copy(a.getv3Location());a[1]+=1;d[1]=a[1];b.drawDebugLine(d,a,0.25,0.25,1)},a)},resolvePhysicsSphereCollision:function(){var a=this.physPointList,b=a.length,c,d,f=this.physSphereList,e=f.length,h,i;for(c=0;c<b;c+=1){d=a[c];for(h=0;h<e;h+=1)i=f[h],i.uniqueCollisionIndex>d.uniqueCollisionIndex&&i.detectsCollision(d)&&i.resolveCollision(d)}}};zf.create=function(a,b,c,d){var f=new zf;f.entityList=[];f.entityUpdateList=[];f.entityDrawList=[];f.physPointList=[];f.physSphereList=[];f.globals=a;f.gameGrid=
b;a=a.mathDevice;f.extents=a.aabbBuildFromMinAndMax(c,d);f.v3Location=a.v3Copy(c);return f};Af.prototype={gridSize:4,scratchpad:{},initialize:function(a){var b=this.globals.mathDevice,c=b.aabbMin(a),d=b.aabbMax(a);this.aabbExtents=b.aabbCopy(a);this.v3Lower=c;this.v3Upper=d;a=this.scratchpad.v2UppderIndex=this.getGridIndexFromLocation(d,this.scratchpad.v2UppderIndex);a[0]+=1;a[1]+=1;c=Array(a[0]);for(b=0;b<a[0];b+=1)c[b]=Array(a[1]);this.physGrid=[];this.gridArray=c},getGridIndexFromLocation:function(a,
b){var c=this.globals.mathDevice,d=this.scratchpad;d.v3Vector=c.v3Sub(a,this.v3Lower,d.v3Vector);b=c.v2BuildFromv3(d.v3Vector,b);c.v2ScalarMul(b,1/this.gridSize,b);b[0]=Math.floor(b[0]);b[1]=Math.floor(b[1]);this.gridArray&&(b[0]=c.clamp(b[0],0,this.gridArray.length-1),b[1]=c.clamp(b[1],0,this.gridArray[0].length-1));return b},getGridIndexXFromLocationX:function(a){a=Math.floor((a-this.v3Lower[0])/this.gridSize);this.gridArray&&(a=0>a?0:a>this.gridArray.length-1?this.gridArray.length-1:a);return a},
getGridIndexYFromLocationZ:function(a){a=Math.floor((a-this.v3Lower[2])/this.gridSize);this.gridArray&&(a=0>a?0:a>this.gridArray[0].length-1?this.gridArray[0].length-1:a);return a},getLocationFromGridIndex:function(a,b,c){var d=this.globals.mathDevice,c=d.v3Build(a*this.gridSize,0,b*this.gridSize,c);d.v3Add(c,this.v3Lower,c);return c},getGridSquareFromIndex:function(a,b){var c=this.gridArray[a][b],d,f=this.scratchpad;c||(c=this.globals.mathDevice,d=this.getLocationFromGridIndex(a,b,f.v3Location),
d[1]=this.v3Lower[1]-10,f.v3Upper=c.v3Copy(d,f.v3Upper),f.v3Upper[0]+=this.gridSize,f.v3Upper[1]=this.v3Upper[1]+10,f.v3Upper[2]+=this.gridSize,c=this.gridArray[a][b]=zf.create(this.globals,this,d,f.v3Upper));return c},debugDraw:function(){this.applyToGridSquaresWithinExtents(this.aabbExtents,function(a){a.debugDraw()})},applyToGridSquaresWithinExtents:function(a,b){var c=this.getGridIndexXFromLocationX(a[0]),d=this.getGridIndexYFromLocationZ(a[2]),f=this.getGridIndexXFromLocationX(a[3]),e=this.getGridIndexYFromLocationZ(a[5]),
h,i;for(h=c;h<=f;h+=1)for(i=d;i<=e;i+=1)c=this.getGridSquareFromIndex(h,i),b(c)},applyToPhysicsSpheresWithinExtents:function(a,b){var c={};this.applyToGridSquaresWithinExtents(a,function(a){a.applyToPhysicsSpheres(b,c)})},applyToEntitiesWithinExtents:function(a,b,c){c||(c={});this.applyToGridSquaresWithinExtents(a,function(a){a.hasEntities()&&a.applyToGameEntities(b,c)})},applyToUpdatingEntitiesWithinExtents:function(a,b,c){c||(c={});this.applyToGridSquaresWithinExtents(a,function(a){a.hasUpdatingEntities()&&
a.applyToUpdatingGameEntities(b,c)})},applyToDrawnEntitiesWithinExtents:function(a,b,c){c||(c={});this.applyToGridSquaresWithinExtents(a,function(a){a.hasUpdatingEntities()&&a.applyToDrawnGameEntities(b,c)})},addEntityToGridSquaresWithinExtents:function(a,b){this.applyToGridSquaresWithinExtents(a,function(a){a.addGameEntity(b)})},removeEntityFromGridSquaresWithinExtents:function(a,b){this.applyToGridSquaresWithinExtents(a,function(a){a.removeGameEntity(b)})},addGridSquareToPhysics:function(a){this.physGrid.push(a)},
removeGridSquareFromPhysics:function(a){a=this.physGrid.indexOf(a);0<=a&&this.physGrid.splice(a,1)},resolvePhysicsSphereCollisions:function(){var a=this.physGrid,b=a.length,c;for(c=0;c<b;c+=1)a[c].resolvePhysicsSphereCollision()}};Af.create=function(a,b){var c=new Af;c.globals=a;c.initialize(b);return c};Bf.prototype={tick:function(a,b){var c=this.globals,d=c.appTimeStep,f=this.getTimeDilation(),c=c.appCurrentTime,e=c-this.prevEngineTime,h=d*this.globals.appMaxTimeSteps;e>h&&(e=h);this.remainingTime+=
e;this.prevEngineTime=c;c=this.remainingTime;e=d;a&&(e=c);e=Math.min(e,1/30);return c>=d||b&&0<c?(this.remainingTime-=e,this.isStopped||(this.timeStep=e*f,this.physTimeStep=e,1>=f&&(this.physTimeStep=e*f),this.currentTime+=this.timeStep),this.gameAppTimeStep=e,this.currentFrame+=1,!0):!1},getFrameIndex:function(){return this.currentFrame},getCurrentTime:function(){return this.currentTime},getGameAppTimeStep:function(){return this.gameAppTimeStep},start:function(){this.currentTime=0;this.prevEngineTime=
this.globals.appCurrentTime;this.remainingTime=0;this.isStopped=!1},stop:function(){this.isStopped=!0;this.physTimeStep=this.timeStep=0},pause:function(){this.isStopped=!0;this.physTimeStep=this.timeStep=0},resume:function(){this.isStopped=!1},setTimeDilation:function(a){this.timeDilation=a},getTimeDilation:function(){return this.timeDilation},getTimeStep:function(){return this.timeStep},getPhysTimeStep:function(){return this.physTimeStep}};Bf.create=function(a){var b=new Bf;b.currentFrame=0;b.currentTime=
null;b.startTime=null;b.timeStep=0;b.physTimeStep=0;b.gameAppTimeStep=0;b.isStopped=!0;b.timeDilation=1;b.globals=a;b.remainingTime=0;b.prevEngineTime=0;return b};rd.prototype={globals:void 0,reset:function(){var a=this.globals.mathDevice;this.desiredV3Focus=a.v3BuildZero();this.currentV3Focus=a.v3Copy(this.desiredV3Focus);this.desiredV3Position=a.v3Build(0,0,-1);this.currentV3Position=a.v3Copy(this.desiredV3Position);this.desiredv3Direction=a.v3Build(0,0,1);this.currentv3Direction=a.v3Copy(this.desiredv3Direction);
this.desiredV3Up=a.v3Build(0,1,0);this.currentV3Up=a.v3Copy(this.desiredV3Up);this.setDesiredFOV(60);this.currentFOV=this.desiredFOV;this.updateFunction=null;this.active=!0;this.sphereCentre=a.v3BuildZero();this.sphereRadius=5;this.baseAngle=0.25*-Math.PI;this.desiredBaseAngle=0.25*-Math.PI;this.startBaseAngle=0.25*-Math.PI;this.shakeAmount=this.destinationBlendOut=this.destinationBlendIn=0;this.scratchPad={}},getCameraValues:function(){var a=this.cameraValueLibrary,b=this.heroEntity,c;if(b){if((c=
b.getEC("ECPlayerLife"))&&c.isDead())return a.dead;if((b=b.getEC("ECPlayerBuilder"))&&3>b.getTimeSinceBuilding())return a.building}return(b=this.gameManager.getPlayFlags())&&void 0!==b.cameraMode&&void 0!==a[b.cameraMode]?a[b.cameraMode]:a.explore},init:function(){this.reset();var a=this.globals.dynamicUI,b=a?a.addGroup("Camera",null):null,c=function(c,d){var e=a.addGroup(d,b);a.watchVariable("Zoomer",c,"zoomerBlend","checkbox",e);a.watchVariable("Zoomer Blend Time",c,"zoomerBlendTime","slider",e,
{min:0.001,max:5,step:0.001});a.watchVariable("Blend Rate",c,"blendRate","slider",e,{min:0.001,max:1,step:0.001});a.watchVariable("Cage",c,"cage","checkbox",e);a.watchVariable("Min Radius",c,"minRadius","slider",e,{min:1,max:20,step:0.1});a.watchVariable("Max Radius",c,"maxRadius","slider",e,{min:1,max:20,step:0.1});a.watchVariable("Track Enemies",c,"trackEnemies","checkbox",e);a.watchVariable("Enemy Far InterestRange",e,"enemyFarInterestRange","slider",e,{min:0,max:100,step:1});a.watchVariable("Enemy Near InterestRange",
c,"enemyNearInterestRange","slider",e,{min:0,max:100,step:1});a.watchVariable("Track Movement Destination",c,"trackMovementDest","checkbox",e);a.watchVariable("Track Cursor",c,"trackCursor","checkbox",e);a.watchVariable("Vertical Angle",c,"verticalAngle","slider",e,{min:0,max:90,step:1});a.watchVariable("Use Pivot",c,"usePivot","checkbox",e);a.watchVariable("Pivot Distance",c,"pivotDistance","slider",e,{min:50,max:500,step:10});a.watchVariable("Focus Y Offset",c,"focusYOffset","slider",e,{min:-10,
max:10,step:0.1});a.watchVariable("Zoom Offset",c,"zoomOffset","slider",e,{min:-20,max:20,step:0.1});a.watchVariable("Pan Forwards",c,"pan","slider",e,{min:-2,max:1,step:0.1});a.watchVariable("String Length",c,"stringLength","slider",e,{min:-20,max:20,step:0.1})},d=this.cameraValueLibrary={};d.explore={zoomerBlend:!0,zoomerBlendTime:0.7,blendRate:0.08,cage:!0,minRadius:8,maxRadius:11.5,trackEnemies:!0,enemyFarInterestRange:30,enemyNearInterestRange:10,trackMovementDest:!0,verticalAngle:36,pivotDistance:120,
usePivot:!0,focusYOffset:-1.5,zoomOffset:-2.5,pan:1,stringLength:2.5};a&&c(d.explore,"Default");d.building={zoomerBlend:!0,zoomerBlendTime:0.7,blendRate:0.1,cage:!0,minRadius:10,maxRadius:10,trackEnemies:!1,enemyFarInterestRange:100,enemyNearInterestRange:5,trackMovementDest:!0,verticalAngle:55,pivotDistance:120,usePivot:!0,focusYOffset:-1.5,zoomOffset:0,pan:1,stringLength:0};a&&c(d.building,"Building");d.war={zoomerBlend:!0,zoomerBlendTime:0.7,blendRate:0.06,cage:!0,minRadius:7.5,maxRadius:10,trackEnemies:!0,
enemyFarInterestRange:30,enemyNearInterestRange:10,trackMovementDest:!0,verticalAngle:33,pivotDistance:120,usePivot:!0,focusYOffset:-1.5,zoomOffset:-2.5,pan:1,stringLength:2.5};a&&c(d.war,"War");d.dead={zoomerBlend:!0,zoomerBlendTime:0.7,blendRate:0.06,cage:!1,minRadius:3.5,maxRadius:3.5,trackEnemies:!1,enemyFarInterestRange:30,enemyNearInterestRange:10,trackMovementDest:!1,verticalAngle:33,pivotDistance:120,usePivot:!1,focusYOffset:-0,zoomOffset:-2.5,pan:1,stringLength:2.5};a&&c(d.war,"Dead")},setHero:function(a){var b=
this.globals.mathDevice,c;this.heroEntity!==a&&(this.heroEntity||(c=b.v3Add(a.getv3Location(),b.v3Build(0,-10,0)),this.setDesiredFocus(c),this.setDesiredPosition(b.v3Sub(a.getv3Location(),this.desiredv3Direction)),this.snap(),this.setShouldSnap()),this.heroEntity=a)},setShouldSnap:function(){this.shouldSnap=!0},blend:function(a){this.zoomerBlend||a.zoomerBlend?this.blendZoomer(a.zoomerBlendTime):this.blendLerp(this.getTimeAdjustedBlendFactor(a.blendRate))},blendLerp:function(a){var b=this.globals.mathDevice;
b.v3Lerp(this.currentv3Direction,this.desiredv3Direction,1,this.currentv3Direction);b.v3Normalize(this.currentv3Direction,this.currentv3Direction);b.v3Lerp(this.currentV3Focus,this.desiredV3Focus,a,this.currentV3Focus);b.v3Lerp(this.currentV3Position,this.desiredV3Position,a,this.currentV3Position);b.v3Lerp(this.currentV3Up,this.desiredV3Up,a,this.currentV3Up);this.currentFOV+=(this.desiredFOV-this.currentFOV)*a},getCurrentV3Direction:function(){return this.currentv3Direction},snap:function(){this.zoomerBlend?
this.snapZoomer():this.blendLerp(1)},apply:function(){var a=this.globals.mathDevice;this.camera.setFOV(this.currentFOV);var b=a.v3Copy(this.currentV3Position),c=a.v3Copy(this.currentV3Up),a=this.useDirection?a.v3Add(this.currentV3Position,this.currentv3Direction):a.v3Copy(this.currentV3Focus);0<this.gameManager.getGameClock().getTimeStep()&&(this.applyShake(b,1),this.applyShake(c,0.25),this.applyShake(a,1));this.camera.lookAt(a,c,b);this.shakeAmount=0;this.updateCameraMatrix()},addShake:function(a,
b){var c=this;G.Create({shake:a}).to({shake:0},b).easing(G.Easing.Linear.None).onUpdate(function(){c.shakeAmount=Math.max(this.shake,c.shakeAmount)}).start()},applyShake:function(a,b){var c=this.globals.mathDevice;0<this.shakeAmount&&c.v3Lerp(a,c.v3Add(a,c.v3BuildRandom(0.2*b*this.shakeAmount)),0.25,a)},buildSphereCentreAndExtents:function(){var a=this.globals.mathDevice,b=this.getCameraValues(),c=b.minRadius,d=b.maxRadius,f=this.globals.guiRenderer.getScaleFactor(),c=c*a.lerp(1,f,0.7),d=d*a.lerp(1,
f,0.7+0.1),e,h,i,j=[],f=this.globals.debugDrawFlags.camera,k=this.globals.debugDraw,l,m,q=function(b,c,d,f){var e=a.v3Copy(b);void 0!==l&&(d&&f)&&(d=a.getFactor(d,f,a.v3Distance(m,b)),d=a.saturate(d),e=a.v3Lerp(l,b,d),c=a.lerp(0.5,c,d));j.push({v3Location:e,radius:void 0!==c?c:2})},p=this.heroEntity.getEC("ECLocomotion");h=1;p&&(b.trackMovementDest&&p.getDestination())&&(p.getLookAhead(),a.v3DistanceSq(p.getDestination(),this.sphereCentre)>c*c&&(this.destinationBlendOut=2),h=a.remap(0,1,1,6,Math.min(this.destinationBlendIn,
this.destinationBlendOut)),h=a.lerp(h,3,p.getTimeHeld()),q(p.getLookAhead(),h));this.destinationBlendIn=0<this.destinationBlendOut?this.destinationBlendIn+this.globals.gameAppTimeStep:0;this.destinationBlendOut-=this.globals.gameAppTimeStep;l=m=this.heroEntity.getv3Location();q(this.heroEntity.v3Location,1,void 0,void 0);var s=b.enemyFarInterestRange,t=b.enemyNearInterestRange,p=function(a){a!==this.heroEntity&&q(a.v3Location,2,s,t)}.bind(this);h=this.gameManager.getFactionManager();b.trackEnemies&&
h.applyToEnemies(this.heroEntity,p);this.gameManager.applyToHeroEntities(p);var u,w;(b=b.cage)&&q(this.sphereCentre,c);for(p=0;p<j.length;p+=1)if(e=j[p],h=e.v3Location,i=e.radius,f&&k.drawDebugSphere(h,i,0,1,0),void 0===u)u=a.v3Copy(h),w=Math.min(i,d);else if(h=a.v3Sub(h,u),e=a.v3Length(h),a.v3Normalize(h,h),e+w<i)i=Math.min(i,d),e=Math.min(i-w,e),i>w&&(u=a.v3Add(u,a.v3ScalarMul(h,e)),w=i);else if(!(e+i<w)){i=0.5*(e+w+i);if(0<p||!b)i=Math.min(i,d);i>w&&(u=a.v3Add(u,a.v3ScalarMul(h,i-w)),w=i)}w=a.clamp(w,
c,d);f&&k.drawDebugSphere(u,w,1,1,0);this.currentGameSpace=this.gameManager.getCurrentGameSpace();void 0!==this.currentGameSpace&&(u=a.aabbClampSphere(this.currentGameSpace.extents,u,w,u));f&&k.drawDebugSphere(u,w,1,1,1);this.sphereRadius=w;this.sphereCentre=u},teleport:function(a,b){var c=this.globals.mathDevice;this.desiredV3Focus=c.v3Add(this.desiredV3Focus,b,this.desiredV3Focus);this.currentV3Focus=c.v3Add(this.currentV3Focus,b,this.currentV3Focus);this.desiredV3Position=c.v3Add(this.desiredV3Position,
b,this.desiredV3Position);this.currentV3Position=c.v3Add(this.currentV3Position,b,this.currentV3Position)},update:function(){this.updateFunction&&this.updateFunction();var a=this.getCameraValues();this.setZoomerBlend(a.zoomerBlend);this.active&&(this.shouldSnap?(this.snap(),this.shouldSnap=!1):this.blend(a),this.apply())},setZoomerBlend:function(a){this.zoomerBlend!==a&&(a&&this.startZoomer(),this.zoomerBlend=a)},snapZoomer:function(){this.zoomerFocus.setv3Position(this.desiredV3Focus);this.zoomerPosition.setv3Position(this.desiredV3Position);
this.zoomerUp.setv3Position(this.desiredV3Up);this.zoomerDirection.setv3Position(this.desiredv3Direction)},startZoomer:function(){this.zoomerFocus=Nc.create(this.globals);this.zoomerPosition=Nc.create(this.globals);this.zoomerUp=Nc.create(this.globals);this.zoomerDirection=Nc.create(this.globals);this.zoomerFocus.setv3Position(this.currentV3Focus);this.zoomerPosition.setv3Position(this.currentV3Position);this.zoomerUp.setv3Position(this.currentV3Up);this.zoomerDirection.setv3Position(this.currentv3Direction)},
zoomTo:function(a,b,c){this.zoomerPosition.setv3Destination(a,c);this.zoomerFocus.setv3Destination(b,c)},blendZoomer:function(a){var b=this.globals.gameAppTimeStep;this.continuousZoom||(this.zoomerFocus.setv3Destination(this.desiredV3Focus,a),this.zoomerPosition.setv3Destination(this.desiredV3Position,a),this.zoomerUp.setv3Destination(this.desiredV3Up,a),this.zoomerDirection.setv3Destination(this.desiredv3Direction,a));this.zoomerFocus.update(b);this.zoomerPosition.update(b);this.zoomerUp.update(b);
this.zoomerDirection.update(b);this.currentV3Focus=this.zoomerFocus.getv3Location();this.currentV3Position=this.zoomerPosition.getv3Location();this.currentV3Up=this.zoomerUp.getv3Location();this.currentv3Direction=this.zoomerDirection.getv3Location()},getTimeAdjustedBlendFactor:function(a){return 1-Math.pow(1-a,30*this.globals.gameAppTimeStep)},updateOrbitAndZoomScene:function(){var a=this.globals.mathDevice;this.updateRotation();var b=a.m33FromAxisRotation(this.currentV3Up,0.05*this.globals.gameAppTimeStep*
Math.PI);this.desiredv3Direction=a.m33Transform(b,this.desiredv3Direction);var b=this.getCameraValues(),c=this.getDistanceRequired(this.sphereRadius),c=c+b.zoomOffset,c=c+10*(1+Math.sin(0.1*this.globals.appCurrentTime));a.v3Copy(this.sphereCentre,this.desiredV3Focus);this.desiredV3Focus[1]+=b.focusYOffset;a.v3Sub(this.sphereCentre,a.v3ScalarMul(this.currentv3Direction,c),this.desiredV3Position)},updateViewScene:function(){var a=this.globals.mathDevice;this.updateRotation();this.adjustDesiredAngleBasedOnPanning();
this.buildSphereCentreAndExtents();var b=this.getCameraValues(),c=this.getDistanceRequired(this.sphereRadius),c=c+b.zoomOffset;a.v3Copy(this.sphereCentre,this.desiredV3Focus);this.desiredV3Focus[1]+=b.focusYOffset;a.v3Sub(this.sphereCentre,a.v3ScalarMul(this.currentv3Direction,c),this.desiredV3Position);this.useDirection=!1},updateStringAndCage:function(){var a=this.globals.mathDevice;this.adjustDesiredAngleBasedOnPanning();this.buildSphereCentreAndExtents();var b=this.getCameraValues(),c=this.getDistanceRequired(this.sphereRadius),
c=c+b.zoomOffset,d=c+b.stringLength,f=this.scratchPad;f.prevDesiredV3Focus=a.v3Copy(this.desiredV3Focus,f.prevDesiredV3Focus);a.v3Copy(this.sphereCentre,this.desiredV3Focus);this.desiredV3Focus[1]+=b.focusYOffset;f.v3DesiredFocusMovement=a.v3Sub(this.desiredV3Focus,f.prevDesiredV3Focus,f.v3DesiredFocusMovement);f.v3DesiredLocation=a.v3Copy(this.desiredV3Position,f.v3DesiredLocation);f.v3DesiredLocation=a.v3AddScalarMul(f.v3DesiredLocation,f.v3DesiredFocusMovement,b.pan);f.v3DesiredLocation[1]=this.sphereCentre[1];
a.v3Sub(f.v3DesiredLocation,this.sphereCentre,f.v3DesiredLocation);a.v3ClampLength(f.v3DesiredLocation,c,d,f.v3DesiredLocation);a.v3Add(f.v3DesiredLocation,this.sphereCentre,f.v3DesiredLocation);f.v3DesiredLocation[1]+=c*Math.tan(2*b.verticalAngle*Math.PI/360);a.v3Copy(f.v3DesiredLocation,this.desiredV3Position);a.v3Sub(this.desiredV3Focus,this.desiredV3Position,this.desiredv3Direction);a.v3Normalize(this.desiredv3Direction,this.desiredv3Direction);this.useDirection=!1},updateFreeMove:function(){this.cameraController.update();
this.updateCameraMatrix()},updatePanToEntity:function(){var a=this.globals.mathDevice;this.targetEntity&&(this.targetEntity.toBeDestroyed?this.targetEntity=null:(this.setDesiredFocus(this.targetEntity.v3Location),a.v3Add(this.targetEntity.v3Location,this.panOffset,this.desiredV3Position)))},updateCameraMatrix:function(){this.camera.updateViewMatrix();this.camera.updateViewProjectionMatrix();this.camera.updateFrustumPlanes()},getDistanceRequired:function(a,b){var c=void 0!==b?b:this.extractSmallestFOV(this.camera);
return a/Math.sin(0.5*c)},setDesiredDirection:function(a){var b=this.globals.mathDevice;this.desiredv3Direction=b.v3Copy(a);b.v3Normalize(this.desiredv3Direction,this.desiredv3Direction)},setDesiredFOV:function(a){this.desiredFOV=2*a*Math.PI/360},setDesiredPosition:function(a){this.desiredV3Position=this.globals.mathDevice.v3Copy(a,this.desiredV3Position)},setDesiredFocus:function(a){this.desiredV3Focus=this.globals.mathDevice.v3Copy(a,this.desiredV3Focus)},extractSmallestFOV:function(a){return a.extractSmallestFOV()},
setModeViewScene:function(){this.exitCurrentMode();var a=this.globals.mathDevice;this.updateFunction=this.updateViewScene;this.desiredv3Direction=a.v3Build(1,-1.5,1);this.desiredV3Up=a.v3Build(0,1,0)},setModeOrbitScene:function(){this.exitCurrentMode();var a=this.globals.mathDevice;this.updateFunction=this.updateOrbitAndZoomScene;this.desiredV3Up=a.v3Build(0,1,0)},setModeEditor:function(){this.exitCurrentMode();this.updateFunction=this.updateFreeMove;this.active=!1},exitModeEditor:function(){this.active=
!0},rotate:function(a){this.desiredBaseAngle=this.globals.mathDevice.boundAngle(this.desiredBaseAngle+a)},updateRotation:function(){var a=this.globals.mathDevice,b=this.baseAngle;this.baseAngle=a.lerpAngle(this.baseAngle,this.desiredBaseAngle,this.getTimeAdjustedBlendFactor(this.shouldSnap?1:0.15));b=a.diffAngles(b,this.baseAngle);if(!(0.001>Math.abs(b))){var c=this.scratchPad;c.rotationMatrix=a.m33BuildRotationY(b,c.rotationMatrix);this.desiredv3Direction=a.m33Transform(c.rotationMatrix,this.desiredv3Direction,
this.desiredv3Direction);c.focusToLocation=a.v3Sub(this.currentV3Position,this.currentV3Focus,c.focusToLocation);c.focusToLocation=a.m33Transform(c.rotationMatrix,c.focusToLocation,c.focusToLocation);this.zoomerBlend?(this.zoomerPosition.setv3Position(a.v3Add(this.currentV3Focus,c.focusToLocation,this.currentV3Position)),this.zoomerDirection.setv3Position(this.desiredv3Direction)):this.currentV3Position=a.v3Add(this.currentV3Focus,c.focusToLocation,this.currentV3Position);c.focusToLocation=a.v3Sub(this.desiredV3Position,
this.currentV3Focus,c.focusToLocation);c.focusToLocation=a.m33Transform(c.rotationMatrix,c.focusToLocation,c.focusToLocation);this.desiredV3Position=a.v3Add(this.currentV3Focus,c.focusToLocation,this.desiredV3Position)}},buildDesiredDirectionFromOffsets:function(a,b){var c=this.globals.mathDevice;void 0===a&&(a=0);void 0===b&&(b=0);var d=2*this.getCameraValues().verticalAngle*Math.PI/360,c=c.angleToV3(this.baseAngle+a);c[1]=-Math.tan(d+b);return c},adjustDesiredAngleBasedOnPanning:function(){var a=
this.getCameraValues();if(a.usePivot){var b=this.globals.mathDevice,c=this.gameManager.getCurrentGameSpace();if(c){var a=a.pivotDistance,d=c.getv3Location(),f=b.v3Sub(this.desiredV3Focus,d);f[1]=0;var c=this.buildDesiredDirectionFromOffsets(0,0),e=b.v3Copy(c);e[1]=0;f=b.v3Dot(f,e);a=b.v3Add(d,b.v3ScalarMul(e,-a+f));a=b.v3Sub(this.desiredV3Position,a);b=b.v3Normalize(a);b[1]=c[1];this.setDesiredDirection(b)}}else this.setDesiredDirection(this.buildDesiredDirectionFromOffsets(0,0))},exitCurrentMode:function(){void 0!==
this.exitModeFunction&&this.exitModeFunction();this.exitModeFunction=void 0},setModePanToEntity:function(a){this.exitCurrentMode();this.updateFunction=this.updatePanToEntity;this.targetEntity=a;this.panOffset=this.globals.mathDevice.v3Sub(this.desiredV3Position,this.desiredV3Focus,this.panOffset)},setModeFly:function(a,b,c){this.exitModeFunction!==this.exitFly&&this.exitCurrentMode();this.updateFunction!==this.updateFlyList&&(this.updateFunction=void 0);this.setZoomerBlend(!0);this.zoomTo(a,b,c);
this.continuousZoom=!0;this.exitModeFunction=this.exitFly},setModeFlyList:function(a){this.updateFunction=this.updateFlyList;this.flyList=a;this.flyListTime=0},updateFlyList:function(){var a=this.flyListTime,b=a+this.globals.gameAppTimeStep;this.flyListTime=b;var c=this.flyList,d=c.length,f,e;for(f=0;f<d;f+=1)if(e=c[f],e.time>=a&&e.time<b){this.setModeFly(e.v3Position,e.v3Focus,e.timeToArrive);break}},exitFly:function(){this.setZoomerBlend(!1);this.continuousZoom=!1},getCurrentV3Position:function(){return this.currentV3Position},
getCurrentV3Focus:function(){return this.currentV3Focus},getDesiredV3Focus:function(){return this.desiredV3Focus},intersectWithMyPlanes:function(a){if(this.currentV3Focus){var b=this.camera.frustumPlanes;if(b){var c=-1,d,f,e,h=this.scratchPad,i=this.globals.mathDevice,j=h.v3LineOrigin=i.v3Copy(this.currentV3Focus,h.v3LineOrigin);j[1]=a[1];var a=i.v3Sub(a,j),k=this.camera.getv3Location(),l;for(l=0;4>l;l+=1)if(d=b[l],h.v3Plane=i.v3Build(d[0],d[1],d[2],h.v3Plane),e=i.getRayPlanePositiveIntersection(k,
h.v3Plane,j,a))if(d=i.v3DistanceSq(e,j),d<c||!f)f=e,c=d;return f}}},isOnScreen:function(a){var b=this.camera.frustumPlanes;return!b?void 0:this.globals.mathDevice.isInsidePlanesPoint(a,b)},getv2ScreenLocationFromWorld:function(a,b){var c=this.globals,d=c.camera,f=c.graphicsDevice,c=f.width,f=f.height,e=d.worldToScreen(a);if(b&&(!e||0>e[0]||e[0]>c||0>e[1]||e[1]>f)){c=this.intersectWithMyPlanes(a);if(!c)return;e=d.worldToScreen(c)}return!e?void 0:e}};rd.create=function(a,b){void 0===rd.prototype.globals&&
(rd.prototype.globals=a);var c=new rd;c.gameManager=b;c.camera=a.camera;c.cameraController=nf.create(a.graphicsDevice,a.camera);c.init();return c};Cf.prototype={NUM_SAMPLES:60,SAMPLE_PERIOD:60,start:function(){var a=this.globals.gameManager.eventManager;this.onInteractWithResourceDispenserCallback=this.onInteractWithResourceDispenser.bind(this);a.subscribe("InteractWithResourceDispenser",this.onInteractWithResourceDispenserCallback);this.onResourceDepositedCallback=this.onResourceDeposited.bind(this);
a.subscribe("ResourceDeposited",this.onResourceDepositedCallback)},stop:function(){var a=this.globals.gameManager.eventManager;a.unsubscribe("InteractWithResourceDispenser",this.onInteractWithResourceDispenserCallback);a.unsubscribe("ResourceDeposited",this.onResourceDepositedCallback)},reset:function(){this.data={gathered:{hero:[0,0],wildlings:[0,0],history:[new Float32Array(this.NUM_SAMPLES),new Float32Array(this.NUM_SAMPLES)],lastHistoryTime:[0,0]},deposited:{hero:[0,0],wildlings:[0,0],history:[new Float32Array(this.NUM_SAMPLES),
new Float32Array(this.NUM_SAMPLES)],lastHistoryTime:[0,0]}}},getSampleIndex:function(a){return Math.floor(a/this.SAMPLE_PERIOD)%this.NUM_SAMPLES},getAverage:function(a,b){var c=this.globals.gameCurrentTime,d;c<this.NUM_SAMPLES*this.SAMPLE_PERIOD?d=this.getSampleIndex(c):(d=this.NUM_SAMPLES-1,c=this.NUM_SAMPLES*this.SAMPLE_PERIOD);var f=0,e,h=this.data[a].history[b];for(e=0;e<d+1;e+=1)f+=h[e];return f/(c/60)},getAverageGathered:function(a){return this.getAverage("gathered",a)},getAverageDeposited:function(a){return this.getAverage("deposited",
a)},onInteractWithResourceDispenser:function(a){var b=a.interactor.hasEC("ECHero"),c=this.data.gathered,d=b?c.hero:c.wildlings,f=a.resourceDispenser.getEC("ECResourceDispenser").getResourceType();d[f]+=a.amount;if(!b){var b=this.globals.gameCurrentTime,d=this.getSampleIndex(b),e=this.getSampleIndex(c.lastHistoryTime[f]);for(c.lastHistoryTime[f]=b;e!==d;)e+=1,e%=this.NUM_SAMPLES,c.history[f][e]=0;c.history[f][d]+=a.amount}},onResourceDeposited:function(a){var b=a.entity.hasEC("ECHero"),c=this.data.deposited,
d=a.type;(b?c.hero:c.wildlings)[d]+=a.amount;if(!b){var b=this.globals.gameCurrentTime,f=this.getSampleIndex(b),e=this.getSampleIndex(c.lastHistoryTime[d]);for(c.lastHistoryTime[d]=b;e!==f;)e+=1,e%=this.NUM_SAMPLES,c.history[d][e]=0;c.history[d][f]+=a.amount}}};Cf.create=function(a){var b=new Cf;b.globals=a;b.reset();return b};fa.prototype={activate:function(){this.getEntityList().map(function(a){a.activate()})},getv3Location:function(){return this.v3Centre},getV3RespawnLocation:function(){return this.v3RespawnLocation},
getM43FullTransform:function(){return this.m43FullTransform},getv3HalfExtents:function(){return this.v3HalfExtents},getExtents:function(){return this.extents},calculateExtents:function(){var a=this.cubeTree.getRootNode(),b=this.cubeTreeDynamic.getRootNode(),c=this.globals.mathDevice,a=a&&b?c.aabbUnion(a.extents,b.extents):a?c.aabbCopy(a.extents):b?c.aabbCopy(b.extents):c.aabbCopy(this.extents);a[1]-=20;a[4]+=20;for(var b=this.getExtents(),d=0;6>d;d+=1)c=a[d]-b[d],c=0<c?Math.ceil(c):Math.floor(c),
a[d]=b[d]+c;return a},teleport:function(a,b){var c=this.globals.mathDevice;this.v3Centre=c.v3Add(this.v3Centre,b,this.v3Centre);this.extents=c.aabbBuildFromCentreHalfExtents(this.v3Centre,this.v3HalfExtents);this.teleportEntities(a,b);this.teleportCubes(a,b);this.teleportDoors(a,b)},teleportEntities:function(a,b){var c=this.globals.mathDevice,d=function(a){a.teleport(c.v3Add(a.getv3Location(),b),b,this)}.bind(this);this.applyToEntities(d)},teleportCubes:function(a,b){var c=this.globals.mathDevice,
d,f,e=this.blockList,h=e.length;for(d=0;d<h;d+=1)if((f=e[d].getWorldCube())&&f.stationary)this.cubeTree.remove(f),f.teleport(c.v3Add(f.getv3Location(),b),b),this.cubeTree.add(f,f.extents);this.cubeTreeDirty=!0},teleportDoors:function(a,b){var c,d,f=this.globals.mathDevice;for(c=0;c<this.doorways.length;c+=1)d=this.doorways[c],d.v3Location=f.v3Add(d.v3Location,b,d.v3Location),d.aabbExtents=f.aabbBuildFromCentreHalfExtents(d.v3Location,d.v3HalfExtents,d.aabbExtents)},updateEntities:function(){var a=
this.getGameGrid(),b=this.gameManager.gameCamera;this.destroyDeadEntities();a&&b?this.updateActiveEntities(b.desiredV3Focus):this.updateAllEntities()},onEntityToBeDestroyed:function(a){this.toBeDestroyedEntityList.push(a)},destroyDeadEntities:function(){var a=this.toBeDestroyedEntityList,b=a.length,c,d;for(c=0;c<b;c+=1)(d=a[c])&&d.destroy();a.length=0},updateActiveEntities:function(a){var b={};ma.start("Update - On Screen Entities");a=this.getUpdatingEntitiesNearPosition(a,30);this.updateEntitiesInList(a,
!0,b);ma.stop("Update - On Screen Entities");ma.start("Update - Off Screen Entities");this.updateEntitiesInList(this.entityAlwaysUpdateList,!1,b);ma.stop("Update - Off Screen Entities")},drawOnScreenEntities:function(a){a=this.getDrawnEntitiesNearPosition(a,30);this.drawEntitiesInList(a,!0,{})},getUpdatingEntitiesNearPosition:function(a,b){var c=this.scratchpad;c.aabbExtents=this.globals.mathDevice.aabbBuildFromCentreRadius(a,b,c.aabbExtents);c.updatingEntityList||(c.updatingEntityList=[]);var d=
c.updatingEntityList;d.length=0;this.applyToUpdatingEntitiesInGridCellsWithinExtents(c.aabbExtents,function(a){a&&d.push(a)},{});return d},getEntitiesNearPosition:function(a,b){var c=this.scratchpad;c.aabbExtents=this.globals.mathDevice.aabbBuildFromCentreRadius(a,b,c.aabbExtents);c.entityList||(c.entityList=[]);var d=c.entityList;d.length=0;this.applyToEntitiesInGridCellsWithinExtents(c.aabbExtents,function(a){a&&d.push(a)},{});return d},getDrawnEntitiesNearPosition:function(a,b){var c=this.scratchpad;
c.aabbExtents=this.globals.mathDevice.aabbBuildFromCentreRadius(a,b,c.aabbExtents);c.drawnEntityList||(c.drawnEntityList=[]);var d=c.drawnEntityList;d.length=0;this.applyToDrawnEntitiesInGridCellsWithinExtents(c.aabbExtents,function(a){a&&d.push(a)},{});return d},updateAllEntities:function(){var a=this.globals.gameCurrentTime,b,c,d=this.entityUpdateList;for(c=0;c<d.length;c+=1)b=d[c],b.isTimeToUpdate(a)&&(b.shouldBeDestroyed()||b.update(!0))},updateEntitiesInList:function(a,b,c){var d,f,e=this.globals.gameCurrentTime;
if(a)for(f=0;f<a.length;f+=1)if((d=a[f])&&(!c||!c[d.name]))c&&(c[d.name]=!0),d.isTimeToUpdate(e)&&(d.shouldBeDestroyed()||d.update(b));return c},clearEntities:function(){for(var a=this.entityList,b;a.length;)b=a.length-1,a[b].setToBeDestroyed(),a[b].destroy();this.toBeDestroyedEntityList.length=0;this.entityUpdateList.length=0;this.entityAlwaysUpdateList.length=0;this.entityDrawList.length=0},getEntityList:function(){return this.entityList},addEntities:function(a){var b=a.length,c,d;for(c=0;c<b;c+=
1)d=a[c],this.addEntity(d)},addEntity:function(a){a.insideGameSpace=!0;a.setGameSpace(this);a.setGameSpaceDynamic(!1)},getEntitiesInRadius:function(a,b){var c=this.globals.mathDevice,d=this.scratchpad;d.aabbExtents=c.aabbBuildFromCentreRadius(a,b,d.aabbExtents);var f=[],e,h,i,j=b*b;this.applyToEntitiesInGridCellsWithinExtents(d.aabbExtents,function(d){d&&(e=d.getRadius(),0<e?(h=d.getDistanceUsingSize(a),i=h<b):i=c.v3DistanceSq(a,d.getv3Location())<j,i&&f.push(d))},{});return f},getEntitiesInRadius2D:function(a,
b,c){var d=this.globals.mathDevice,f=this.scratchpad;f.aabbExtents=d.aabbBuildFromCentreRadius(a,b,f.aabbExtents);var e=[],h,i,j,k=b*b;this.applyToEntitiesInGridCellsWithinExtents(f.aabbExtents,function(f){f&&f!==c&&(h=f.getRadius(),0<h?(i=f.get2DDistanceUsingSize(a),j=i<b):j=d.v3Distance2DSq(a,f.getv3Location())<k,j&&e.push(f))},{});return e},getEntitiesWithEC:function(a){var b=this.entityList,c=b.length,d=[],f,e;for(e=0;e<c;e+=1)f=b[e],f.hasEC(a)&&!f.toBeDestroyed&&d.push(f);return d},getEntitiesWithArcheType:function(a){var b=
this.entityList,c=b.length,d=[],f,e;for(e=0;e<c;e+=1)f=b[e],f.getArchetypeName()===a&&!f.toBeDestroyed&&d.push(f);return d},getEntitiesWithFamilyName:function(a){var b=this.entityList,c=b.length,d=[],f,e;for(e=0;e<c;e+=1)f=b[e],f.getFamilyName()===a&&!f.toBeDestroyed&&d.push(f);return d},getGameGrid:function(){return this.gameGrid},refreshEntityLists:function(a){a.shouldUpdate()?this.addEntityToUpdateList(a):this.removeEntityFromUpdateList(a);a.shouldAlwaysUpdate()?this.addEntityToAlwaysUpdateList(a):
this.removeEntityFromAlwaysUpdateList(a);a.shouldDraw()?this.addEntityToDrawList(a):this.removeEntityFromDrawList(a)},addGameEntity:function(a,b){a&&(this.entityList.push(a),b&&this.newEntityList.push(a),this.refreshEntityLists(a),this.entityMap[a.name]=a)},removeGameEntity:function(a,b){var c=this.entityList.indexOf(a);this.entityList.splice(c,1);this.entityMap[a.name]=void 0;this.removeEntityFromUpdateList(a);this.removeEntityFromAlwaysUpdateList(a);this.removeEntityFromDrawList(a);b&&this.deadEntityList.push(a.name)},
addEntityToUpdateList:function(a){a&&-1===this.entityUpdateList.indexOf(a)&&this.entityUpdateList.push(a)},removeEntityFromUpdateList:function(a){a&&(a=this.entityUpdateList.indexOf(a),0<=a&&this.entityUpdateList.splice(a,1))},addEntityToAlwaysUpdateList:function(a){a&&-1===this.entityAlwaysUpdateList.indexOf(a)&&this.entityAlwaysUpdateList.push(a)},removeEntityFromAlwaysUpdateList:function(a){a&&(a=this.entityAlwaysUpdateList.indexOf(a),0<=a&&this.entityAlwaysUpdateList.splice(a,1))},addEntityToDrawList:function(a){a&&
-1===this.entityDrawList.indexOf(a)&&this.entityDrawList.push(a)},removeEntityFromDrawList:function(a){a&&(a=this.entityDrawList.indexOf(a),0<=a&&this.entityDrawList.splice(a,1))},shuffleGameEntityToEnd:function(a){var b=this.entityList.indexOf(a);this.entityList.splice(b,1);this.entityList.push(a);b=this.entityUpdateList.indexOf(a);0<=b&&(this.entityUpdateList.splice(b,1),this.entityUpdateList.push(a));b=this.entityAlwaysUpdateList.indexOf(a);0<=b&&(this.entityAlwaysUpdateList.splice(b,1),this.entityAlwaysUpdateList.push(a));
b=this.entityDrawList.indexOf(a);0<=b&&(this.entityDrawList.splice(b,1),this.entityDrawList.push(a))},appendToNames:function(a){this.name+=a;this.applyToEntities(function(b){b.appendToName(a)});var b,c=this.entityMap;this.entityMap={};for(b in c)c.hasOwnProperty(b)&&(this.entityMap[b+a]=c[b])},applyToEntitiesInGridCellsWithinExtents:function(a,b,c){this.gameGrid.applyToEntitiesWithinExtents(a,b,c);return c},applyToUpdatingEntitiesInGridCellsWithinExtents:function(a,b,c){this.gameGrid.applyToUpdatingEntitiesWithinExtents(a,
b,c);return c},applyToDrawnEntitiesInGridCellsWithinExtents:function(a,b,c){this.gameGrid.applyToDrawnEntitiesWithinExtents(a,b,c);return c},applyToEntities:function(a){var b,c=this.entityList,d=c.length;for(b=0;b<d;b+=1)a(c[b])},getGameEntityByName:function(a){return this.entityMap[a]},updatePhysics:function(){var a=this.globals.mathDevice,b,c,d,f,e,h,i,j=this.physSphereList,k=j.length;this.finalizeIfNeeded();var l,m=[],q=[];q.push(this.cubeTree);q.push(this.cubeTreeDynamic);for(b=0;b<this.gsNeighbourList.length;b+=
1)if((d=this.gsNeighbourList[b])&&d.roomID>this.roomID)m.push(d.physSphereList),q.push(d.cubeTree),q.push(d.cubeTreeDynamic);var p=function(b,c){return a.aabbPointDistanceSq(b.extents,l)-a.aabbPointDistanceSq(c.extents,l)},s=this.gridSquarePhysics;s&&this.getGameGrid().resolvePhysicsSphereCollisions();for(d=0;d<k;d+=1){b=j[d];b.prePhysicsClear();l=b.getv3Location();if(!s){for(f=d+1;f<k;f+=1)c=j[f],c.detectsCollision(b)&&c.resolveCollision(b);for(e=0;e<m.length;e+=1){h=m[e];i=h.length;for(f=0;f<i;f+=
1)c=h[f],c.detectsCollision(b)&&c.resolveCollision(b)}}c=[];for(f=0;f<q.length;f+=1)q[f].getSphereOverlappingNodes(l,b.getRadius(),c);h=c.length;c.sort(p);for(e=0;e<h;e+=1)f=c[e],f.collisionCheck(b)&&f.collisionResolve(b)}},getCollisionInfoForSpheres:function(a,b,c){var d=this.globals.mathDevice,f=this.scratchpad,e=null,f=f.aabbExtents=d.aabbBuild(Math.min(a[0],b[0]),Math.min(a[1],b[1]),Math.min(a[2],b[2]),Math.max(a[0],b[0]),Math.max(a[1],b[1]),Math.max(a[2],b[2]),f.aabbExtents);this.getGameGrid().applyToPhysicsSpheresWithinExtents(f,
function(f){var i=f.getv3Location(),j=d.getLineIntersectSphereOrCapsule(a,b,i,f.getRadius(),f.getCapsuleHeight());if(j&&(j<c||void 0===c))c=j,e={v3Location:d.v3Copy(f.getv3Location(),e?e.v3Location:void 0),v3Normal:d.v3Normalize(d.v3Sub(a,i,e?e.v3Normal:void 0),e?e.v3Normal:void 0),distance:j,collidedEntity:f.entity}});return e},getOverlappingSpheres:function(a,b){var c=this.globals.mathDevice,d,f,e=this.physSphereList,h=e.length;void 0===b&&(b=[]);if(a&&c)for(f=0;f<h;f+=1)(d=e[f])&&c.aabbSphereOverlaps(a,
d.getv3Location(),d.getRadius())&&b.push(d);return b},addPhysicsSphere:function(a){this.physSphereList.push(a)},removePhysicsSphere:function(a){a=this.physSphereList.indexOf(a);this.physSphereList.splice(a,1)},addBlock:function(a){this.blockList.push(a)},addCube:function(a){this.cubeList.push(a);a.stationary?(this.cubeTree.add(a,a.extents),this.cubeTreeDirty=!0):(this.cubeTreeDynamic.add(a,a.extents),this.cubeTreeDynamicDirty=!0);a.ignoringCollision||(a.terrainType&&this.addCubeToNavGrids(a),a.isBlock()&&
(this.addCubeToHeightGrid(a),this.heightGridDirty=!0))},movedCube:function(a){this.cubeTreeDynamic.update(a,a.extents);this.cubeTreeDynamicDirty=!0},removeBlock:function(a){a=this.blockList.indexOf(a);this.blockList.splice(a,1)},removeCube:function(a){var b=this.cubeList.indexOf(a);this.cubeList.splice(b,1);a.stationary?(this.cubeTree.remove(a),this.cubeTreeDirty=!0):(this.cubeTreeDynamic.remove(a),this.cubeTreeDynamicDirty=!0);a.ignoringCollision||(a.terrainType&&this.removeCubeFromNavGrids(a),a.isBlock()&&
(this.removeCubeFromHeightGrid(a),this.heightGridDirty=!0))},finalizeIfNeeded:function(){if(this.navGridsDirty&&(this.navGridEnemyWeighted.finalise(),this.navGridHeroWeighted.finalise(),this.navGridsDirty=!1,this.gameManager))this.gameManager.onNavGridUpdated();this.cubeTreeDirty&&(this.cubeTree.finalize(),this.cubeTreeDirty=!1);this.cubeTreeDynamicDirty&&(this.cubeTreeDynamic.finalize(),this.cubeTreeDynamicDirty=!1);if(this.heightGridDirty){this.heightGridDirty=!1;var a=this.heightGridExtentsRequiringRecalcList;
this.heightGridExtentsRequiringRecalcList=[];var b=this.getHeightGrid(),c=this.globals.mathDevice,d=a.length,f;for(f=0;f<d;f+=1){var e=a[f],h=c.v2Build(e[0],e[1]),e=c.v2Build(e[2],e[3]);this.recalculateHeightGridArea(b,h,e)}}},clearBlocks:function(){for(var a=this.blockList,b;a.length;)b=a[0],b.removeFromGameSpace(this),b.destroy();a.length=0;this.blockList=null},addLight:function(a){this.lightList.push(a);this.getActive()&&a.getUnderground()&&a.triggerOn(!this.isAboveGround())},removeLight:function(a){a=
this.lightList.indexOf(a);0<=a&&this.lightList.splice(a,1)},fadeLights:function(a,b){var c,d=this.lightList,f=d.length,e;for(c=0;c<f;c+=1)if(e=d[c],e.getInstant()&&(!e.getUnderground()||!this.isAboveGround()))e.triggerOn(a),b&&e.update()},getNavGrid:function(a){return a===this.enemyFactionName?this.navGridEnemyWeighted:this.navGridHeroWeighted},getNavGridHeroWeighted:function(){return this.navGridHeroWeighted},getNavGridEnemyWeighted:function(){return this.navGridEnemyWeighted},getRefCountGrid:function(a){return a===
this.enemyFactionName?this.enemyRefCountGrid:this.heroRefCountGrid},getHeightGrid:function(){return this.heightGrid},getHeroRefCountGrid:function(){return this.heroRefCountGrid},getEnemyRefCountGrid:function(){return this.enemyRefCountGrid},getV3WorldLocationFromV2GridLocation:function(a){var b=this.globals.mathDevice,c=this.v3GridToWorldOffset,d=this.getHeightGrid(),f=b.v3Build(a[0],0,a[1]);b.v3Add(c,f,f);f[1]=d[a[0]][a[1]];return f},getV2GridLocationFromV3WorldLocation:function(a){var b=this.v3WorldToGridOffset;
return this.globals.mathDevice.v2Build(Math.floor(a[0]+b[0]),Math.floor(a[2]+b[2]))},v2GridLocationListToV3WorldLocationList:function(a){var b=a.length,c=this.globals.mathDevice,d=this.v3GridToWorldOffset,f=this.getHeightGrid(),e=[],h,i,j;for(h=0;h<b;h+=1)i=a[h],j=c.v3Build(i[0],0,i[1]),c.v3Add(d,j,j),j[1]=f[i[0]][i[1]],e.push(j);return e},addCubeToNavGrids:function(a){this.navGridsDirty=!0;var b=this.globals.mathDevice,c=a.extents,d=b.v3Build(c[0],c[1],c[2]),b=b.v3Build(c[3]-0.01,c[4],c[5]-0.01),
d=this.getV2GridLocationFromV3WorldLocation(d),b=this.getV2GridLocationFromV3WorldLocation(b),c=a.terrainType,a=fa.heroFactionTerrainTypes[c],c=fa.enemyFactionTerrainTypes[c],f=this.getNavGridHeroWeighted(),e=this.getNavGridEnemyWeighted(),h=this.getHeroRefCountGrid(),i=this.getEnemyRefCountGrid();a!==fa.terrainTypes.impass?this.addTerrainCostToNavGridArea(f,d,b,a):this.setNavGridArea(f,d,b,fa.terrainTypes.impass);c!==fa.terrainTypes.impass?this.addTerrainCostToNavGridArea(e,d,b,c):this.setNavGridArea(e,
d,b,fa.terrainTypes.impass);h.addToArea(d,b,1);i.addToArea(d,b,1)},addCubeToHeightGrid:function(a){var b=this.globals.mathDevice,c=a.extents,a=b.v3Build(c[0]+0.5,c[1],c[2]+0.5),b=b.v3Build(c[3]-0.5,c[4],c[5]-0.5),a=this.getV2GridLocationFromV3WorldLocation(a),c=this.getV2GridLocationFromV3WorldLocation(b),d=this.getHeightGrid();gc.setAreaToValueIfGreater(d,a,c,b[1])},removeCubeFromNavGrids:function(a){this.navGridsDirty=!0;var b=this.globals.mathDevice,c=a.extents,d=b.v3Build(c[0],c[1],c[2]),b=b.v3Build(c[3]-
0.01,c[4]-0.01,c[5]-0.01),d=this.getV2GridLocationFromV3WorldLocation(d),b=this.getV2GridLocationFromV3WorldLocation(b),a=a.terrainType,c=fa.heroFactionTerrainTypes[a],f=fa.enemyFactionTerrainTypes[a],e=this.getNavGridHeroWeighted(),a=this.getNavGridEnemyWeighted(),h=this.getHeroRefCountGrid(),i=this.getEnemyRefCountGrid();this.addTerrainCostToNavGridArea(e,d,b,-c);this.addTerrainCostToNavGridArea(a,d,b,-f);h.addToArea(d,b,-1);i.addToArea(d,b,-1);c=h.getGridArray();this.setNavGridAreaForReferenceCount(e,
c,d,b,fa.terrainTypes.pass,0);c=i.getGridArray();this.setNavGridAreaForReferenceCount(a,c,d,b,fa.terrainTypes.pass,0)},removeCubeFromHeightGrid:function(a){var b=this.globals.mathDevice,c=a.extents,a=b.v3Build(c[0],c[1],c[2]),c=b.v3Build(c[3]-0.01,c[4]-0.01,c[5]-0.01),a=this.getV2GridLocationFromV3WorldLocation(a),c=this.getV2GridLocationFromV3WorldLocation(c);this.heightGridDirty=!0;b=b.v4Build(a[0],a[1],c[0],c[1]);this.heightGridExtentsRequiringRecalcList.push(b)},recalculateHeightGridArea:function(a,
b,c){for(var d=this.globals.mathDevice,f=this.gameManager,e=this.getExtents(),h=d.v3Build(e[1],e[1],e[2]),e=d.v3Build(e[3],e[4],e[5])[1],h=h[1],i=this.v3GridToWorldOffset,j=a.length,k=a[0].length,l=Math.min(b[0],c[0]),m=Math.max(b[0],c[0])+1,q=Math.min(b[1],c[1]),b=Math.max(b[1],c[1])+1,l=d.clamp(l,0,j),m=d.clamp(m,0,j),q=d.clamp(q,0,k),b=d.clamp(b,0,k),c=l;c<m;c+=1)for(j=q;j<b;j+=1)k=d.v3Add(i,d.v3Build(c,0,j)),k[1]=e,l=d.v3Copy(k),l[1]=h,k=(k=f.getCollisionInfo(k,l,!1))?k.v3Location[1]:h,a[c][j]=
k},setNavGridArea:function(a,b,c,d){for(var f=this.globals.mathDevice,e=b[0],b=b[1],h=c[0]+1,c=c[1]+1,i=f.v2Build(0,0),j;e<h;e+=1)for(j=b;j<c;j+=1)f.v2Build(e,j,i),a.setElementValue(i,d)},addTerrainCostToNavGridArea:function(a,b,c,d){for(var f=this.globals.mathDevice,e=b[0],b=b[1],h=c[0]+1,c=c[1]+1,i=f.v2Build(0,0),j;e<h;e+=1)for(j=b;j<c;j+=1)f.v2Build(e,j,i),a.addElementValue(i,d)},setNavGridAreaForReferenceCount:function(a,b,c,d,f,e){for(var h=this.globals.mathDevice,i=c[0],c=c[1],j=d[0]+1,d=d[1]+
1,k=a.getGridSizeX(),l=a.getGridSizeY(),i=h.clamp(i,0,k),j=h.clamp(j,0,k),c=h.clamp(c,0,l),d=h.clamp(d,0,l),k=h.v2Build(0,0);i<j;i+=1)for(l=c;l<d;l+=1)b[i][l]===e&&(h.v2Build(i,l,k),a.setElementValue(k,f))},getTraversableLocationListInRadius:function(a,b,c){c=this.getRefCountGrid(c);a=this.getV2GridLocationFromV3WorldLocation(a);b=c.getV2TraversableLocationListWithinArea(a,b);return this.v2GridLocationListToV3WorldLocationList(b)},getActive:function(){var a=this.gameManager,b=!1,c=this.getLiveEnemyCount()?
!0:!1,a=a.getHeroList(),d=a.length,f=this.globals.mathDevice,e;if(c)for(e=0;e<d;e+=1)if(c=a[e],225>f.aabbPointDistanceSq(this.extents,c.getv3Location())){b=!0;break}return 0<this.getLiveHeroCount()||b||0===this.updateCount},update:function(){this.getActive()&&(this.updateFadeIn(),ma.start("Update - Physics"),this.updatePhysics(),ma.stop("Update - Physics"),ma.start("Update - Entities"),this.updateEntities(),ma.stop("Update - Entities"),this.updateCount+=1,this.gameManager.activeSpaceCount+=1)},draw:function(){ma.start("Draw - Entities");
this.drawEntities();ma.stop("Draw - Entities")},drawEntities:function(){var a=this.getGameGrid(),b=this.gameManager.gameCamera;a&&b?this.drawOnScreenEntities(b.desiredV3Focus):this.drawAllDrawnEntities()},drawAllDrawnEntities:function(){var a,b=this.entityDrawList;for(a=b.length-1;0<=a;a-=1)b[a].draw()},drawEntitiesInList:function(a){var b=a.length,c;for(c=0;c<b;c+=1)a[c].draw()},drawDebug:function(a){var b=this.entityList,c=b.length,d=this.globals,f=d.debugDraw,e=d.debugDrawFlags;if(this.getActive()){f.drawDebugExtents(this.extents,
1,1,1);for(f=0;f<c;f+=1)b[f].drawDebug(a);e.navGridHeroWeighted&&(a=this.getNavGridHeroWeighted(),a.debugDraw(this.navGridDebugDrawHeight));e.navGridEnemyWeighted&&(a=this.getNavGridEnemyWeighted(),a.debugDraw(this.navGridDebugDrawHeight));e.heroRefCountGrid&&(a=this.getEnemyRefCountGrid(),a.debugDraw(this.navGridDebugDrawHeight));e.enemyRefCountGrid&&(a=this.getEnemyRefCountGrid(),a.debugDraw(this.navGridDebugDrawHeight));e.gameGrid&&(a=this.getGameGrid(),a.debugDraw(this.navGridDebugDrawHeight));
e.heightGrid&&(a=this.getHeightGrid(),gc.debugDrawHeightArray2D(a,this.v3GridToWorldOffset,0.5,this.heightGridElementTexture,d.mathDevice,d.simpleSpriteRenderer,this.v4HeightGridCellColourDefault,this.v4HeightGridCellColourAlt));e.nonBuildZones&&this.getBlockList().filter(function(a){return!a.isBuildZone()}).forEach(function(a){a.drawDebug()})}else f.drawDebugExtents(this.extents,0.5,0.5,0.5);this.drawDoorways();this.getActive()&&this.drawContentCounts()},drawContentCounts:function(){var a=this.globals,
b=a.simpleFontRenderer,a={x:a.graphicsDevice.width/2,y:180,scale:0.5,alignment:1};b.drawFont("Enemy Count = "+this.getLiveEnemyCount(),a);a.y+=30;b.drawFont("Loot Count = "+this.getPickupCount(),a)},drawDebugPhysics:function(){var a,b=this.physSphereList,c=b.length,d=this.cubeList,f=d.length;for(a=0;a<c;a+=1)b[a].drawDebug();for(a=0;a<f;a+=1)d[a].drawDebug()},getShouldDeltaSerialize:function(){return this.getActive()},beginSerialize:function(a){var b;b=a[this.name];void 0===b&&(b=a[this.name]={},
b.name=this.name);return b},addEntityDataIfNeeded:function(a){var b=a.entityData;void 0===b&&(b=a.entityData={});return b},serialize:function(a,b){if(void 0===b[this.name]){var c=this.beginSerialize(b,!0);c.creationParameters=this.buildCreationParameters();this.serializeRemovedDoors(c);c=this.addEntityDataIfNeeded(c);this.serializeEntities(a,c)}},serializeDelta:function(a,b,c){void 0===b[this.name]&&(b=this.beginSerialize(b),this.serializeRemovedDoorsDelta(b),b=this.addEntityDataIfNeeded(b),c?this.serializeEntities(a,
b):this.serializeDeltaEntities(a,b))},deserialize:function(a){var b,c,d;void 0!==a[this.name]&&(a=a[this.name],a.creationParameters&&(b=this.gameManager,c=b.worldMap,d=a.creationParameters,c.insertRoomByIndex(b,d.roomIndex,this,{m43Transform:d.m43FullTransform,noEntities:!0}),this.updateCount=0),this.deserializeRemovedDoors(a),this.deserializeEntities(a.entityData))},serializeEntities:function(a,b){var c,d,f=b.newEntities={},e=this.entityList;for(d=0;d<e.length;d+=1)c=e[d],c.isManagedByThisMachine(a)&&
!c.shouldBeDestroyed()&&c.serialize(f)},serializeDeltaEntities:function(a,b){var c,d;b.deadList=this.deadEntityList.slice(0,this.deadEntityList.length);this.deadEntityList.length=0;var f=b.newEntities={},e=this.newEntityList;for(d=0;d<e.length;d+=1)c=e[d],c.isManagedByThisMachine(a)&&c.serialize(f);this.newEntityList.length=0;f=b.deltaEntities={};e=this.entityList;for(d=0;d<e.length;d+=1)c=e[d],c.isManagedByThisMachine(a)&&c.getShouldDeltaSerialize()&&c.serializeDelta(f)},deserializeEntities:function(a){var b,
c,d,f=a.deadList,e=a.newEntities,a=a.deltaEntities;if(void 0!==f)for(d=0;d<f.length;d+=1)b=this.entityMap[f[d]],void 0!==b&&b.destroy();for(c in e)e.hasOwnProperty(c)&&(b=this.entityMap[c],void 0===b&&(f=e[c].v3Location,b=db.create(c,this.globals,this.gameManager,f,entityParameters),b.activate(),b.setGameSpace(this)),b.deserialize(e));for(c in a)a.hasOwnProperty(c)&&(b=this.entityMap[c],void 0===b&&(b=this.gameManager.getGameEntityByName(c))&&b.setGameSpace(this),void 0!==b&&b.deserialize(a))},buildCreationParameters:function(){return{v3Centre:this.v3Centre,
v3RespawnLocation:this.v3RespawnLocation,v3HalfExtents:this.v3HalfExtents,extents:this.extents,roomID:this.roomID,roomIndex:this.roomIndex,m43FullTransform:this.m43FullTransform}},addDoorway:function(a,b,c,d){var f=this.globals.mathDevice,a={v3Location:f.v3Copy(a),v3Direction:f.v3Copy(b),v3HalfExtents:f.v3Copy(c),aabbExtents:f.aabbBuildFromCentreHalfExtents(a,c),ID:this.doorID,metal:d};this.doorways.push(a);this.doorID+=1;return a},removeDoorwayByID:function(a){var b,c=this.doorways,d=c.length;for(b=
0;b<d;b+=1)if(c[b].ID===a){this.doorways.splice(b,1);this.removedDoors.push(a);this.removedDoorsDelta.push(a);break}},serializeRemovedDoors:function(a){0!==this.removedDoors.length&&(a.removedDoors=this.removedDoors.slice(0,this.removedDoors.length))},serializeRemovedDoorsDelta:function(a){0!==this.removedDoorsDelta.length&&(a.removedDoors=this.removedDoorsDelta.slice(0,this.removedDoorsDelta.length),this.removedDoorsDelta.length=0)},deserializeRemovedDoors:function(a){if(void 0!==a.removedDoors){var b;
for(b=0;b<a.removedDoors.length;b+=1)this.removeDoorwayByID(a.removedDoors[b])}},drawDoorways:function(){var a,b=this.doorways,c=b.length,d=this.globals.debugDraw,f=this.globals.mathDevice;for(a=0;a<c;a+=1)d.drawDebugExtents(b[a].aabbExtents,0,0.5,0),d.drawDebugLine(b[a].v3Location,f.v3Add(b[a].v3Location,b[a].v3Direction),0,0.5,0)},setGridOffset:function(a){this.globals.mathDevice.v3Copy(a,this.v3GridOffset)},getGridOffset:function(){return this.v3GridOffset},snapPositionToGridSquare:function(a,
b){var c=this.globals.mathDevice,d=this.getGridOffset(),f;c&&a&&(f=c.v3Copy(a),d?(f[0]=Math.round(f[0]-d[0])+d[0],b&&(f[1]=Math.round(f[1]-d[1])+d[1]),f[2]=Math.round(f[2]-d[2])+d[2]):(f[0]=Math.round(f[0]),b&&(f[1]=Math.round(f[1])),f[2]=Math.round(f[2])));return f},snapPositionToGridLine:function(a,b){var c=this.globals.mathDevice,d=this.getGridOffset(),f;c&&a&&(f=c.v3Copy(a),d?(f[0]=Math.floor(f[0]-d[0])+d[0]+0.5,b&&(f[1]=Math.floor(f[1]-d[1])+d[1]+0.5),f[2]=Math.floor(f[2]-d[2])+d[2]+0.5):(f[0]=
Math.floor(f[0])+0.5,b&&(f[1]=Math.floor(f[1])+0.5),f[2]=Math.floor(f[2])+0.5));return f},removeEnteredHero:function(){this.playerDeepCount-=1},addHero:function(){this.playerCount+=1},removeHero:function(){this.playerCount-=1;if(0===this.playerCount)this.onRoomExit()},updateFadeIn:function(){this.toFadeUpLights&&(this.fadeLights(!0,!1),this.toFadeUpLights=void 0)},onRoomExit:function(){this.worldRoom&&this.worldRoom.addTransformedSpawners(this.gameManager,this.m43FullTransform,this,this.roomID,88);
this.applyToEntities(function(a){(a=a.getEC("ECTrigger"))&&a.groupIDContains(88)&&a.reset()});this.worldRoom&&this.worldRoom.text&&this.gameManager.removeGameMessage(this.worldRoom.text)},getLiveHeroCount:function(){return this.playerCount},getDeepHeroCount:function(){return this.playerDeepCount},getHeroEntryCount:function(){return this.playerEntryCount},addEnemy:function(a){this.enemyCount+=a;this.enemyCleared=!1},removeEnemy:function(a){this.enemyCount-=a;0===this.enemyCount&&(this.enemyCleared=
!0)},addEnemyOfID:function(a,b){void 0!==b&&(void 0===this.enemyIDCount[b]&&(this.enemyIDCount[b]=0),this.enemyIDCleared[b]=!1,this.enemyIDCount[b]+=a)},removeEnemyOfID:function(a,b){void 0!==b&&(void 0!==this.enemyIDCount[b]&&(this.enemyIDCount[b]-=a),0===this.enemyIDCount[b]&&(this.enemyIDCleared[b]=this.globals.gameCurrentTime))},getEnemyCount:function(){return this.enemyCount},getEnemyCleared:function(){return this.enemyCleared},getEnemyOfIDClearedTime:function(a){return this.enemyIDCleared[a]},
addLiveEnemy:function(a){this.liveEnemyCount+=a},removeLiveEnemy:function(a){this.liveEnemyCount-=a},getLiveEnemyCount:function(){return this.liveEnemyCount},addPickup:function(a){this.pickupCount+=a},removePickup:function(a){this.pickupCount-=a},getPickupCount:function(){return this.pickupCount},getRoomType:function(){return this.worldRoom?this.worldRoom.getRoomType():WorldRoom.roomTypes.NONE},getName:function(){return this.name},isAirLockRoom:function(){return this.getRoomType()===WorldRoom.roomTypes.AIRLOCK},
isAboveGround:function(){var a=this.getRoomType();return a===WorldRoom.roomTypes.CAMP||a===WorldRoom.roomTypes.PATH||a===WorldRoom.roomTypes.AIRLOCK},isOriginalSpace:function(){return this.originalSpace},getBlockList:function(){return this.blockList},onFilled:function(){this.gameManager.addPotentialEnemies(this.getEnemyCount())},resetSpawnersAndTriggers:function(){var a=this.entityList,b=a.length,c,d,f;for(f=0;f<b;f+=1)c=a[f],d=c.getEC("ECSpawner"),c=c.getEC("ECTrigger"),d?d.entity.setToBeDestroyed():
c&&c.reset();this.worldRoom&&this.worldRoom.addTransformedSpawners(this.gameManager,this.m43FullTransform,this,this.roomID)},destroy:function(){this.clearEntities();this.clearBlocks()}};fa.terrainTypes={impass:0,pass:1};fa.heroFactionTerrainTypes={pass:fa.terrainTypes.pass,impass:fa.terrainTypes.impass,building:fa.terrainTypes.impass,wall1:fa.terrainTypes.impass,wall2:fa.terrainTypes.impass,wall3:fa.terrainTypes.impass,wall4:fa.terrainTypes.impass,wall5:fa.terrainTypes.impass,wall6:fa.terrainTypes.impass,
wall7:fa.terrainTypes.impass,wall8:fa.terrainTypes.impass,wall9:fa.terrainTypes.impass,wall10:fa.terrainTypes.impass,gate1:fa.terrainTypes.pass,gate2:fa.terrainTypes.pass,gate3:fa.terrainTypes.pass,gate4:fa.terrainTypes.pass,gate5:fa.terrainTypes.pass,gate6:fa.terrainTypes.pass,gate7:fa.terrainTypes.pass,gate8:fa.terrainTypes.pass,gate9:fa.terrainTypes.pass,gate10:fa.terrainTypes.pass,barricade1:fa.terrainTypes.impass,barricade2:fa.terrainTypes.impass,barricade3:fa.terrainTypes.impass,barricade4:fa.terrainTypes.impass,
barricade5:fa.terrainTypes.impass,barricadeGate1:fa.terrainTypes.pass,barricadeGate2:fa.terrainTypes.pass,barricadeGate3:fa.terrainTypes.pass,barricadeGate4:fa.terrainTypes.pass,barricadeGate5:fa.terrainTypes.pass,tile:-0.9};fa.enemyFactionTerrainTypes={pass:fa.terrainTypes.pass,impass:fa.terrainTypes.impass,building:120,wall1:10,wall2:12,wall3:14,wall4:16,wall5:18,wall6:20,wall7:22,wall8:24,wall9:26,wall10:28,gate1:10,gate2:12,gate3:14,gate4:16,gate5:18,gate6:20,gate7:22,gate8:24,gate9:26,gate10:28,
barricade1:10,barricade2:12,barricade3:14,barricade4:16,barricade5:18,barricadeGate1:10,barricadeGate2:12,barricadeGate3:14,barricadeGate4:16,barricadeGate5:18,tile:fa.terrainTypes.pass};fa.create=function(a,b,c,d){var f=new fa,e=b.gameManager,h=b.mathDevice;void 0===fa.prototype.globals&&(fa.prototype.globals=b);f.gsNeighbourList=[];f.entityList=[];f.newEntityList=[];f.deadEntityList=[];f.entityMap={};f.entityUpdateList=[];f.entityAlwaysUpdateList=[];f.entityDrawList=[];f.toBeDestroyedEntityList=
[];f.doorways=[];f.removedDoors=[];f.removedDoorsDelta=[];f.doorID=0;f.blockList=[];f.cubeList=[];f.cubeTree=xa.create(!0);f.cubeTreeDynamic=xa.create(!1);f.cubeTreeList=[f.cubeTree,f.cubeTreeDynamic];f.enemyCount=0;f.enemyCleared=!1;f.enemyIDCount={};f.enemyIDCleared={};f.liveEnemyCount=0;f.pickupCount=0;f.playerCount=0;f.playerDeepCount=0;f.playerEntryCount=0;f.physSphereList=[];f.lightList=[];f.gameManager=e;var i=h.v3BuildZero(),j=h.v3BuildZero();h.aabbGetCenterAndHalf(c,i,j);f.v3Centre=i;f.v3HalfExtents=
j;f.extents=h.aabbCopy(c);f.m43FullTransform=h.m43Copy(d);var i=h.v3Build(c[0],c[1],c[2]),k=h.v3ScalarMul(i,-1),d=h.v3ScalarMul(k,-1);d[0]+=0.5;d[2]+=0.5;f.v3WorldToGridOffset=k;f.v3GridToWorldOffset=d;var l=2*j[0],j=2*j[2];f.navGridEnemyWeighted=Wd.create(b,l,j,d,k);f.enemyRefCountGrid=Xd.create(b,l,j,d,k);f.navGridHeroWeighted=Wd.create(b,l,j,d,k);f.heroRefCountGrid=Xd.create(b,l,j,d,k);f.navGridsDirty=!1;f.navGridDebugDrawHeight=0.51;f.heightGrid=gc.create(l,j,i[1]);f.heightGridExtentsRequiringRecalcList=
[];f.v4HeightGridCellColourDefault=[1,0,0,0.3];f.v4HeightGridCellColourAlt=[1,0,0,0.1];f.heightGridElementTexture="textures/block.dds";f.heightGridDirty=!1;e=e.getFactionManager();f.enemyFactionName=e.getEnemyFactionName();f.gameGrid=Af.create(b,c);f.name=a;f.updateCount=0;f.v3GridOffset=h.v3BuildZero();f.v3GridOffset[0]+=Math.abs(d[0])%1;f.v3GridOffset[2]+=Math.abs(d[2])%1;f.gridSquarePhysics=!0;f.scratchpad={};return f};Gb.prototype={blendRate:0.05,init:function(a,b){this.globals=a;this.gameManager=
b;if(a.renderer instanceof Ga||a.renderer instanceof ia)this.useMultipleLights=!0;var c=a.mathDevice;this.v3AmbientCurrent=c.v3BuildZero();this.v3AmbientDesired=c.v3Build(0.25,0.25,0.25);this.v3WorldLight1Current=c.v3BuildZero();this.worldLight1PitchCurrent=0.5*Math.PI;this.worldLight1YawCurrent=0;this.v3WorldLight2Desired=c.v3Build(0,0,0);this.worldLight2PitchDesired=0.25*-Math.PI;this.worldLight2YawDesired=Math.PI;this.v3WorldLight2Current=c.v3BuildZero();this.worldLight2PitchCurrent=0.5*-Math.PI;
this.worldLight2YawCurrent=0;this.v3WorldLight1Desired=c.v3Build(0.25,0.25,0.25);this.worldLight1PitchDesired=0.25*-Math.PI;this.worldLight1YawDesired=0;this.v3HeroLightCurrent=c.v3Build(0.25,0.25,0.25);this.heroLightRadiusCurrent=5;this.v3HeroLightDesired=c.v3Build(0.25,0.25,0.25);this.heroLightRadiusDesired=5;this.initializeGlobalLights();this.applyToGlobalLights();this.blendFactor=0;this.scratchpad={}},initUI:function(){var a=this.globals,b=a.dynamicUI;if(b){var c=b.addGroup("Lighting");if(this.useMultipleLights){b.watchVariable("DayNight",
a.gameManager,"gameDayTime","slider",c,{min:0,max:24,step:0.1});b.watchVariable("Override Day Time",a.gameManager,"overrideGameDayTime","checkbox",c);b.watchVariable("Shadows",this.globals.settings,"shadows","checkbox",c);a=b.addGroup("Ambient",c);b.watchVariable("Disabled",this.ambientLight,"disabled","checkbox",a);a=b.addGroup("worldLight1",c);b.watchVariable("Disabled",this.worldDirectionLight,"disabled","checkbox",a);b.watchVariable("Toon",this.worldDirectionLight.techniqueParameters,"toonShade",
"checkbox",a);a=b.addGroup("worldLight2",c);b.watchVariable("Disabled",this.worldDirectionLight2,"disabled","checkbox",a);b.watchVariable("Toon",this.worldDirectionLight2.techniqueParameters,"toonShade","checkbox",a);a=b.addGroup("heroLight",c);b.watchVariable("Disabled",this.heroLightNode,"disabled","checkbox",a);var d,f,e=Gb.keyframes;for(f in e)e.hasOwnProperty(f)&&(a=e[f],d=b.addGroup(f,c),this.addAmbientLightSliders(a,d),this.addDirectionLightSliders(a,"worldLight1",d),this.addDirectionLightSliders(a,
"worldLight2",d),this.addPointLightSliders(a,"heroLight",d))}}},setKeyFrames:function(a,b,c){this.blendFactor=a;this.lowerKeyframe=Gb.keyframes[b.keyframe];this.upperKeyframe=Gb.keyframes[c.keyframe]},snap:function(){this.shouldSnap=!0},addAmbientLightSliders:function(a,b){this.addColourSliders(a.ambient,"ambient",b)},addDirectionLightSliders:function(a,b,c){this.addColourSliders(a[b],b,c);this.addAngleSliders(a[b],b,c)},addPointLightSliders:function(a,b,c){this.addColourSliders(a[b],b,c);this.addRadiusSliders(a[b],
b,c)},addAngleSliders:function(a,b,c){var d=this.globals.dynamicUI,f={min:-Math.PI,max:Math.PI,step:2*Math.PI/360};d.watchVariable(b+" pitch",a,"pitch","slider",c,f);d.watchVariable(b+" yaw",a,"yaw","slider",c,f)},addRadiusSliders:function(a,b,c){this.globals.dynamicUI.watchVariable(b+" radius",a,"radius","slider",c,{min:0,max:100,step:0.1})},addColourSliders:function(a,b,c){var d=this.globals.dynamicUI,f={min:0,max:255,step:1};d.watchVariable(b+" Red",a,"r","slider",c,f);d.watchVariable(b+" Green",
a,"g","slider",c,f);d.watchVariable(b+" Blue",a,"b","slider",c,f);d.watchVariable(b+" Intensity",a,"intensity","slider",c,{min:0,max:2,step:0.05})},updateDesiredSetting:function(){var a=this.getDesiredSetting();this.setTargetSetting(a)},tendCurrentValues:function(){var a=this.globals.mathDevice,b=this.shouldSnap?1:0.05;this.shouldSnap=!1;this.v3AmbientCurrent=a.v3Lerp(this.v3AmbientCurrent,this.v3AmbientDesired,b);this.v3WorldLight1Current=a.v3Lerp(this.v3WorldLight1Current,this.v3WorldLight1Desired,
b);this.worldLight1PitchCurrent=a.lerpAngle(this.worldLight1PitchCurrent,this.worldLight1PitchDesired,b);this.worldLight1YawCurrent=a.lerpAngle(this.worldLight1YawCurrent,this.worldLight1YawDesired,b);this.v3WorldLight2Current=a.v3Lerp(this.v3WorldLight2Current,this.v3WorldLight2Desired,b);this.worldLight2PitchCurrent=a.lerpAngle(this.worldLight2PitchCurrent,this.worldLight2PitchDesired,b);this.worldLight2YawCurrent=a.lerpAngle(this.worldLight2YawCurrent,this.worldLight2YawDesired,b);this.v3HeroLightCurrent=
a.v3Lerp(this.v3HeroLightCurrent,this.v3HeroLightDesired,b);this.heroLightRadiusCurrent=a.lerp(this.heroLightRadiusCurrent,this.heroLightRadiusDesired,b)},getBlendedSetting:function(a,b,c,d){d||(d={ambient:{},worldLight1:{},worldLight2:{},heroLight:{}});this.getBlendedSettingLocation(a,b,c,d);this.getBlendedSettingColour(a,b,c,d);return d},getBlendedSettingLocation:function(a,b,c,d){var f=this.globals.mathDevice;d||(d={ambient:{},worldLight1:{},worldLight2:{},heroLight:{}});d.worldLight1.pitch=f.lerp(a.worldLight1.pitch,
b.worldLight1.pitch,c);d.worldLight1.yaw=f.lerp(a.worldLight1.yaw,b.worldLight1.yaw,c);d.worldLight2.pitch=f.lerp(a.worldLight2.pitch,b.worldLight2.pitch,c);d.worldLight2.yaw=f.lerp(a.worldLight2.yaw,b.worldLight2.yaw,c);d.heroLight.radius=f.lerp(a.heroLight.radius,b.heroLight.radius,c);return d},getBlendedSettingColour:function(a,b,c,d){var f=this.globals.mathDevice;d||(d={ambient:{},worldLight1:{},worldLight2:{},heroLight:{}});var e,h;e=a.ambient;h=b.ambient;d.ambient.r=f.lerp(e.r*e.intensity,h.r*
h.intensity,c);d.ambient.g=f.lerp(e.g*e.intensity,h.g*h.intensity,c);d.ambient.b=f.lerp(e.b*e.intensity,h.b*h.intensity,c);d.ambient.intensity=1;e=a.worldLight1;h=b.worldLight1;d.worldLight1.r=f.lerp(e.r*e.intensity,h.r*h.intensity,c);d.worldLight1.g=f.lerp(e.g*e.intensity,h.g*h.intensity,c);d.worldLight1.b=f.lerp(e.b*e.intensity,h.b*h.intensity,c);d.worldLight1.intensity=1;e=a.worldLight2;h=b.worldLight2;d.worldLight2.r=f.lerp(e.r*e.intensity,h.r*h.intensity,c);d.worldLight2.g=f.lerp(e.g*e.intensity,
h.g*h.intensity,c);d.worldLight2.b=f.lerp(e.b*e.intensity,h.b*h.intensity,c);d.worldLight2.intensity=1;e=a.heroLight;h=b.heroLight;d.heroLight.r=f.lerp(e.r*e.intensity,h.r*h.intensity,c);d.heroLight.g=f.lerp(e.g*e.intensity,h.g*h.intensity,c);d.heroLight.b=f.lerp(e.b*e.intensity,h.b*h.intensity,c);d.heroLight.intensity=1;return d},getBlockBlendFactor:function(a){return 0.4>a?0:0.6>a?(a-0.4)/(0.6-0.4):1},getDesiredSetting:function(){return this.blended=this.getBlendedSetting(this.lowerKeyframe,this.upperKeyframe,
this.blendFactor,this.blended)},setTargetSetting:function(a){var b=1/255;this.v3AmbientDesired[0]=a.ambient.r*b*a.ambient.intensity;this.v3AmbientDesired[1]=a.ambient.g*b*a.ambient.intensity;this.v3AmbientDesired[2]=a.ambient.b*b*a.ambient.intensity;this.v3WorldLight1Desired[0]=a.worldLight1.r*b*a.worldLight1.intensity;this.v3WorldLight1Desired[1]=a.worldLight1.g*b*a.worldLight1.intensity;this.v3WorldLight1Desired[2]=a.worldLight1.b*b*a.worldLight1.intensity;this.worldLight1PitchDesired=a.worldLight1.pitch;
this.worldLight1YawDesired=a.worldLight1.yaw;this.v3WorldLight2Desired[0]=a.worldLight2.r*b*a.worldLight2.intensity;this.v3WorldLight2Desired[1]=a.worldLight2.g*b*a.worldLight2.intensity;this.v3WorldLight2Desired[2]=a.worldLight2.b*b*a.worldLight2.intensity;this.worldLight2PitchDesired=a.worldLight2.pitch;this.worldLight2YawDesired=a.worldLight2.yaw;this.v3HeroLightDesired[0]=a.heroLight.r*b*a.heroLight.intensity;this.v3HeroLightDesired[1]=a.heroLight.g*b*a.heroLight.intensity;this.v3HeroLightDesired[2]=
a.heroLight.b*b*a.heroLight.intensity;this.heroLightRadiusDesired=a.heroLight.radius},update:function(){this.updateLightPosition();this.updateDesiredSetting();this.tendCurrentValues();this.applyToGlobalLights();this.heroLight.shadows=this.worldDirectionLight.shadows=this.globals.settings.shadows},initializeGlobalLights:function(){var a=this.globals,b=a.mathDevice,c=ad.create({name:"ambient1",ambient:!0,global:!0,color:b.v3BuildZero(),disabled:!1}),d={effect:"lambert",parameters:{lightfalloff:"textures/global_light.dds",
lightprojection:"textures/global_light.dds",toonShade:!0,shadowSize_depthTweak_blurSize_fadeScale:b.v4Build(0,0.0035,1.5,0.5)}};a.scene.loadMaterial(a.graphicsDevice,a.textureManager,a.effectManager,"worldLightMaterial",d);var f=a.scene.getMaterial("worldLightMaterial"),f=ad.create({name:"world1Directional",directional:!0,global:!1,color:b.v3BuildZero(),shadows:!0,halfExtents:b.v3Build(1,1,1),direction:b.v3Build(0,0,1),material:f,dynamic:!0,disabled:!1}),e=Sa.create({name:"world1Direction-node",local:b.m43BuildIdentity(),
dynamic:!0,disabled:!1});a.scene.addLight(c);a.scene.addLight(f);this.worldDirectionLightInstance=bd.create(f);this.worldDirectionLightInstance.slot=0;this.worldDirectionLightInstance.shadowQuality=1;e.addLightInstance(this.worldDirectionLightInstance);this.ambientLight=c;this.worldDirectionLight=f;this.worldDirectionLightNode=e;this.globals.scene.addRootNode(e);d.parameters.toonShade=!1;a.scene.loadMaterial(a.graphicsDevice,a.textureManager,a.effectManager,"worldLight2",d);c=a.scene.getMaterial("worldLight2");
c=ad.create({name:"world2Directional",directional:!0,global:!0,color:b.v3Build(0,0,1),shadows:!1,direction:b.v3Build(-0.707,-0.707,0),material:c,dynamic:!0,disabled:!1});a.scene.addLight(c);this.worldDirectionLight2=c;c.slot=1;a.scene.loadMaterial(a.graphicsDevice,a.textureManager,a.effectManager,"heroLightMaterial",{effect:"lambert",parameters:{lightfalloff2:"textures/torch_light_shape.dds",lightNoiseTexture2:"textures/lightnoise.dds",lightNoiseOffset2:0,lightNoiseScale2:0.1}});this.heroLightMaterial=
c=a.scene.getMaterial("heroLightMaterial");this.heroLight=ad.create({name:"heroLight",point:!0,color:b.v3Build(1,0,0),shadows:!1,radius:5.8,material:c,dynamic:!0,disabled:!1});a.scene.addLight(this.heroLight);this.heroLightNode=Sa.create({name:"heroLight-node",local:b.m43BuildIdentity(),dynamic:!0,disabled:!1});this.heroLightInstance=bd.create(this.heroLight);this.heroLightInstance.slot=2;this.heroLightInstance.shadowQuality=0;this.heroLightInstance.techniqueParameters=this.heroLightMaterial.techniqueParameters;
this.heroLightInstance.techniqueParameters.shadowSize_depthTweak_blurSize_fadeScale=b.v4Build(0,0.025,1.5,0.5);this.heroLightNode.addLightInstance(this.heroLightInstance);this.globals.scene.addRootNode(this.heroLightNode);this.upperKeyframe=this.lowerKeyframe=Gb.keyframes.midday},applyToGlobalLights:function(){var a=this.globals,b=a.renderer,a=a.mathDevice;this.useMultipleLights?(this.ambientLight.color=a.v3Copy(this.v3AmbientCurrent,this.ambientLight.color),this.worldDirectionLight.color=a.v3Copy(this.v3WorldLight1Current,
this.worldDirectionLight.color),this.worldDirectionLight2.color=a.v3Copy(this.v3WorldLight2Current,this.worldDirectionLight2.color),this.heroLight.color=a.v3Copy(this.v3HeroLightCurrent,this.heroLight.color),this.heroLight.radius=this.heroLightRadiusCurrent):(b.setAmbientColor(a.v3Copy(this.v3AmbientCurrent)),b.setGlobalLightColor(a.v3Copy(this.v3WorldLight1Current)))},updateLightPosition:function(){var a=this.globals,b=a.mathDevice,c=a.camera,d=a.gameManager,f=this.scratchpad.v3ZAxis=this.scratchpad.v3ZAxis||
b.v3Build(0,0,1),e=this.scratchpad.v3YAxis=this.scratchpad.v3YAxis||b.v3Build(0,1,0),h=this.scratchpad.v3Zero=this.scratchpad.v3Zero||b.v3Build(0,0,0),i=this.scratchpad.v3PullBack=b.v3ScalarMul(f,-0,this.scratchpad.v3PullBack),j=this.scratchpad.v3Direction=b.v3Build(this.worldLight1PitchCurrent,this.worldLight1YawCurrent,0,this.scratchpad.v3Direction),j=this.scratchpad.m43Transform=b.m43BuildRotationXZY(j,this.scratchpad.m43Transform),k=this.scratchpad.v3Location=b.m43TransformVector(j,i,this.scratchpad.v3Location),
l=this.scratchpad.worldExtents=b.aabbBuild(-160,-5,-165,3,20,0,this.scratchpad.worldExtents),a=a.scene.nearPlane,m=a[0],q=a[1],p=a[2],a=m*(0<m?l[3]:l[0])+q*(0<q?l[4]:l[1])+p*(0<p?l[5]:l[2])-a[3],m=c.getFrustumPoints(),p=b.v3Sub(m[4],m[0],m[4]),q=b.v3Sub(m[5],m[1],m[5]);b.v3Normalize(p,p);b.v3Normalize(q,q);p=w.getRayPlanePositiveIntersection(h,e,m[0],p);e=w.getRayPlanePositiveIntersection(h,e,m[1],q);p&&(a=Math.min(a,b.v3Distance(m[0],p)));e&&(a=Math.min(a,b.v3Distance(m[1],e)));e=this.scratchpad.extents=
b.aabbBuildEmpty(this.scratchpad.extents);c.getFrustumExtents(e,Math.floor(a));e[0]-=2;e[1]-=2;e[2]-=2;e[3]+=2;e[4]+=2;e[5]+=2;b.aabbIntercept(e,l,e);k[0]=0.5*(e[3]+e[0]);k[1]=0.5*(e[4]+e[1]);k[2]=0.5*(e[5]+e[2]);b.m43SetPos(j,k);b.m43At(j,this.worldDirectionLight.direction);j[0]=1;j[1]=0;j[2]=0;j[3]=0;j[4]=1;j[5]=0;j[6]=0;j[7]=0;j[8]=1;this.worldDirectionLightNode.setLocalTransform(j);this.worldDirectionLight.halfExtents[0]=Math.floor(0.5*(e[3]-e[0]));this.worldDirectionLight.halfExtents[1]=Math.floor(0.5*
(e[4]-e[1]));this.worldDirectionLight.halfExtents[2]=Math.floor(0.5*(e[5]-e[2]));this.worldDirectionLightNode.updateLocalExtents();this.worldDirectionLightInstance.getWorldExtents();j=this.scratchpad.v3Direction=b.v3Build(this.worldLight2PitchCurrent,this.worldLight2YawCurrent,0,this.scratchpad.v3Direction);j=this.scratchpad.m43Transform=b.m43BuildRotationXZY(j,this.scratchpad.m43Transform);b.m43TransformVector(j,f,this.worldDirectionLight2.direction);c=d.getFirstEntityWithEC("ECHeroTorch");f=!1;
c&&(d=c.getEC("ECHeroTorch"),d.getNight()&&(i[0]=0.3,i[1]=1.5,i[2]=0,b.v3RotateY(i,c.getRotationY()),b.v3Add(c.getv3Location(),i,k),c=this.heroLightNode.getLocalTransform(),i=b.m43Pos(c,i),c=this.heroLight.radius+2,this.heroLight.halfExtents[0]=c,this.heroLight.halfExtents[1]=c,this.heroLight.halfExtents[2]=c,b.v3DistanceSq(k,i)>0.05*0.05&&(b.m43SetPos(this.heroLightNode.getLocalTransform(),k),this.heroLightNode.setLocalTransform(this.heroLightNode.getLocalTransform())),this.heroLightNode.disabled=
b.v3Length(this.v3HeroLightCurrent)<1/256,f=!0));f||(this.heroLightNode.disabled=!0)},setLightPosition:function(a){var b=this.globals,c=b.mathDevice;this.useMultipleLights?this.worldLightNode&&this.worldLightNode.setLocalTransform(c.m43BuildTranslation(a)):b.renderer.setGlobalLightPosition(c.v3Copy(a))},getShadowsEnabled:function(){return this.globals.settings.shadows},setShadowsEnabled:function(a){this.globals.settings.shadows=a;this.worldDirectionLight.shadows=this.globals.settings.shadows},drawShadowMap:function(a){1===
a?(a=this.worldDirectionLightNode)&&a.hasLightInstances()&&this.drawLightNodeShadowMap(a):2===a&&!this.heroLightNode.disabled&&!this.heroLightNode.lightInstances[0].disabled&&this.drawLightNodeShadowMap(this.heroLightNode)},drawLightNodeShadowMap:function(a){if(a=a.lightInstances[0].shadowMap){a.texture.mipmaps=!0;a.texture.updateMipmaps();var b=this.globals.draw2D;b.begin("opaque","texture");b.draw({texture:a.texture,destinationRectangle:[0,0,256,256]});b.end()}}};Gb.create=function(a,b){var c=new Gb;
c.init(a,b);return c};A.prototype={damage:1,nearDamageFactor:void 0,farDamageFactor:void 0,nearRange:void 0,farRange:void 0,forceBack:0,forceLift:0,forceRadial:0,forceTangential:0,stunDuration:0,nearForceFactor:void 0,farForceFactor:void 0,radius:0,arcAngle:void 0,friendlyFire:1,buildingDamage:void 0,isExplosion:!1,applyToEntity:function(a,b,c,d,f,e,h){var i=this.globals,j=i.mathDevice,k;if(a&&!a.shouldBeDestroyed()){var l=this.damage;void 0!==h&&(l*=h);var m=a.getEC("ECHealth"),h=0;if(1!==this.friendlyFire&&
(k=this.gameManager.getFactionManager(),(!m||!m.takesFullDamageFromFriendlyFire())&&k.areFriendly(a,b,void 0,f)))l*=this.friendlyFire;if(a.isManagedByThisMachine()){f=a.getEC("ECPlayerLife");void 0!==this.buildingDamage&&a.hasEC("ECBuilding")&&(l=this.buildingDamage);e&&(h=this.getNormalisedDistanceTravelled(e,a.getv3Location()),l*=this.getDamageRangeFactor(h));if(m){if(m.getInvulnerable())return;0<l&&m.takeDamage(l,!0,b,!1,this.isExplosion);if(m.isRooted())return}f&&(f.playOuch(),f.onTakeDamage())}var e=
a.getEC("ECPhysicsSphere"),l=1/60/i.gameTimeStep,q,f=1;if(e&&(i=j.v3BuildZero(),b=d?j.v3Copy(d):b.getv3Location(),0<this.forceRadial&&(d=j.v3Sub(a.getv3Location(),b),j.v3Normalize(d,d),i=j.v3AddScalarMul(i,d,this.forceRadial,i)),0<this.forceBack&&(q=c?j.v3Copy(c):j.v3Sub(a.getv3Location(),b),j.v3Normalize(q,q),i=j.v3AddScalarMul(i,q,this.forceBack,i)),0!==this.forceTangential&&(c=j.angleToV3(j.v3ToAngle(q)+0.5*Math.PI),j.v3Normalize(c,c),i=j.v3AddScalarMul(i,c,this.forceTangential,i)),j.v3Add(i,j.v3Build(0,
this.forceLift,0),i),a.isDead()&&(f*=2),f*=this.getForceRangeFactor(h),j.v3ScalarMul(i,2E4*f*l,i),e.clearVelocity(),e.applyForce(i),j=a.getEC("ECLocomotion")))j.onApplyForce(i);0<this.stunDuration&&(a=a.getEC("ECAgent"))&&a.setStunned(this.stunDuration)}},getNormalisedDistanceTravelled:function(a,b){var c=this.nearRange,d=this.farRange,f,e;void 0!==c&&(void 0!==d&&a&&b)&&(f=this.globals.mathDevice,e=f.v3Distance(a,b),e=f.clamp(e,c,d),f=f.remap(c,d,0,1,e));return f},getDamageRangeFactor:function(a){var b=
this.nearDamageFactor,c=this.farDamageFactor,d=1;void 0!==b&&(void 0!==c&&void 0!==a)&&(d=b+a*(c-b));return d},getForceRangeFactor:function(a){var b=this.nearForceFactor,c=this.farForceFactor,d=1;void 0!==b&&(void 0!==c&&void 0!==a)&&(d=b+a*(c-b));return d},areFriendly:function(a,b){if(a.shouldBeDestroyed()||b.shouldBeDestroyed())return!1;var c=a.getEC("ECHero")?!0:!1,d=b.getEC("ECHero")?!0:!1;return c!==d?!1:!0},applyToArea:function(a,b,c,d,f,e,h){var i=!1,j=this.gameManager,k=j.actionManager;if(j=
j.getGameSpace(c)){var j=j.getEntitiesInRadius(c,this.radius,!0),l=j.length,m,q,p=!1,s;(m=a.getEC("ECFaction"))&&(s=m.getFactionName());for(q=0;q<l;q+=1)m=j[q],m!==a&&(m.hasEC("ECHealth")&&!(f&&0<=f.indexOf(m)))&&(d&&m===d&&(p=!0),f&&f.push(m),i=!0,k.addAction("ApplyDamageToEntity",{damageType:this.damageType,victim:m,aggressor:a,v3InputDirection:b,v3InputOrigin:c,v3ProjectileStartLocation:e,aggressorFactionName:s}));d&&!p&&(i=!0,k.addAction("ApplyDamageToEntity",{damageType:this.damageType,victim:d,
aggressor:a,v3InputDirection:b,v3InputOrigin:c,v3ProjectileStartLocation:e,aggressorFactionName:s,damageFactor:h}));return i}},applyToArc:function(a,b,c,d,f,e,h){void 0===f&&(f=this.arcAngle);void 0===d&&(d=this.radius);var i=this.gameManager,j=i.actionManager,d=i.getGameSpace(c).getEntitiesInRadius(c,d,!0),i=d.length,k,l,m;(k=a.getEC("ECFaction"))&&(m=k.getFactionName());for(l=0;l<i;l+=1)k=d[l],k!==a&&k.hasEC("ECHealth")&&this.isWithinArc(c,b,k.getv3Location(),f)&&j.addAction("ApplyDamageToEntity",
{damageType:this.damageType,victim:k,aggressor:a,v3InputDirection:b,v3InputOrigin:c,v3ProjectileStartLocation:e,aggressorFactionName:m,damageFactor:h})},isWithinArc:function(a,b,c,d){var f=this.globals.mathDevice,a=f.v3Sub(c,a),a=f.v3ToAngle(a),b=f.v3ToAngle(b);return Math.abs(f.diffAngles(b,a))<0.5*d?!0:!1},initUI:function(){var a=this.globals.dynamicUI;if(a){var b=A.prototype.damageGroup;void 0===b&&(A.prototype.damageGroup=a.addGroup("Damage"),b=A.prototype.damageGroup);b=a.addGroup(this.name,
b);a.watchVariable("Damage",this,"damage","slider",b,{min:0,max:10,step:0.1});a.watchVariable("Radius",this,"radius","slider",b,{min:0,max:5,step:0.1});a.watchVariable("ForceBack",this,"forceBack","slider",b,{min:0,max:2,step:0.1});a.watchVariable("ForceLift (upwards)",this,"forceLift","slider",b,{min:0,max:2,step:0.1});a.watchVariable("ForceRadial",this,"forceRadial","slider",b,{min:0,max:3,step:0.1});a.watchVariable("ForceTangential (around)",this,"forceTangential","slider",b,{min:-3,max:3,step:0.1});
a.watchVariable("Friendly Fire",this,"friendlyFire","checkbox",b);a.watchVariable("Stun Duration",this,"stunDuration","slider",b,{min:0,max:10,step:0.1})}}};A.setGlobals=function(a,b){void 0===A.prototype.globals&&(A.prototype.globals=a);void 0===A.prototype.gameManager&&(A.prototype.gameManager=b);var c,d=A.archetypes;for(c in d)d.hasOwnProperty(c)&&(d[c].initUI(),d[c].damageType=c)};A.archetypes={};A.create=function(a,b){var c=new A;c.name=a;c.damage=void 0!==b.damage?b.damage:c.damage;c.buildingDamage=
void 0!==b.buildingDamage?b.buildingDamage:c.buildingDamage;c.nearDamageFactor=void 0!==b.nearDamageFactor?b.nearDamageFactor:c.nearDamageFactor;c.farDamageFactor=void 0!==b.farDamageFactor?b.farDamageFactor:c.farDamageFactor;c.nearRange=void 0!==b.nearRange?b.nearRange:c.nearRange;c.farRange=void 0!==b.farRange?b.farRange:c.farRange;c.forceBack=void 0!==b.forceBack?b.forceBack:c.forceBack;c.forceLift=void 0!==b.forceLift?b.forceLift:c.forceLift;c.forceRadial=void 0!==b.forceRadial?b.forceRadial:
c.forceRadial;c.forceTangential=void 0!==b.forceTangential?b.forceTangential:c.forceTangential;c.nearForceFactor=void 0!==b.nearForceFactor?b.nearForceFactor:c.nearForceFactor;c.farForceFactor=void 0!==b.farForceFactor?b.farForceFactor:c.farForceFactor;c.radius=void 0!==b.radius?b.radius:c.radius;c.isExplosion=void 0!==b.isExplosion?b.isExplosion:c.isExplosion;c.arcAngle=void 0!==b.arcAngle?2*b.arcAngle*Math.PI/360:c.arcAngle;c.friendlyFire=void 0!==b.friendlyFire?b.friendlyFire:c.friendlyFire;c.stunDuration=
void 0!==b.stunDuration?b.stunDuration:c.stunDuration;return c};Df.prototype={update:function(){var a,b=this.actionList;this.actionList=this.otherActionList;var c=b.length,d,f=this.actionFunctionMap;for(a=0;a<c;a+=1)d=b[a],f[d.actionName](d.actionArguments);b.length=0;this.otherActionList=b},addAction:function(a,b){this.actionList.push({actionName:a,actionArguments:b})},serializeArguments:function(a){var b,c,d={};for(b in a)a.hasOwnProperty(b)&&(c=a[b],d[b]=c&&c.isGameEntity?{isGameEntityName:!0,
name:c.getName()}:c);return d},deserializeArguments:function(a){var b,c,d={};for(b in a)a.hasOwnProperty(b)&&(c=a[b],d[b]=c&&c.isGameEntityName?this.gameManager.getGameEntityByName(c.name):c);return d},serialize:function(a){var a=a.actionDataList=[],b,c=this.actionList,d=c.length,f;for(b=0;b<d;b+=1)f=c[b],a.push({actionName:f.actionName,actionArguments:this.serializeArguments(f.actionArguments)})},deserialize:function(a){if(a=a.actionDataList){var b,c=a.length,d;for(b=0;b<c;b+=1)d=a[b],this.addAction(d.actionName,
this.deserializeArguments(d.actionArguments))}},registerAction:function(a,b){this.actionFunctionMap[a]=b}};Df.create=function(a,b){var c=new Df;c.globals=a;c.gameManager=b;c.actionFunctionMap={};c.actionList=[];c.otherActionList=[];var d=function(a){this.gameManager.damager.archetypes[a.damageType].applyToEntity(a.victim,a.aggressor,a.v3InputDirection,a.v3InputOrigin,a.aggressorFactionName,a.v3ProjectileStartLocation,a.damageFactor)}.bind(c),f=function(a){this.gameManager.getEffectFactory().createVisualEffectInstance(a)}.bind(c),
e=function(a){this.gameManager.getEffectFactory().createEffectInstance(a)}.bind(c),h=function(a){this.gameManager.getEffectFactory().endEffectInstance(a)}.bind(c),i=function(a){this.gameManager.gameSoundManager.playInternal(a.soundName,a.v3Location,a.gameEntity)}.bind(c),j=function(a){this.gameManager.gameSoundManager.stopInternal(a.soundName,a.gameEntity,a.fadeTime)}.bind(c),k=function(a){var b=a.pickup,a=a.collector;b&&a&&(b=b.getEC("ECPickup"))&&b.giveToCollector(a)}.bind(c);c.registerAction("ApplyDamageToEntity",
d);c.registerAction("VisualEffect",f);c.registerAction("SpecialEffect",e);c.registerAction("EndSpecialEffect",h);c.registerAction("SoundEffect",i);c.registerAction("StopSoundEffect",j);c.registerAction("GivePickup",k);return c};Ef.prototype={purchaseItem:function(a){var b=this.globals,c=b.gameManager,d=b.storeManager;d&&a&&(d.emptyBasket(),d.addToBasket(a,1)&&(b.graphicsDevice.fullscreen=!1,c&&(a=c.getGameController())&&a.unlockMouse(),d.showConfirmPurchase()))},onStoreManagerLoaded:function(a){a&&
(a.onBasketUpdate=this.onBasketUpdate.bind(this),a.onSitePurchaseConfirmed=this.onSitePurchaseConfirmed.bind(this),a.onSitePurchaseRejected=this.onSitePurchaseRejected.bind(this))},onGameStarted:function(){this.setSpecialFlags();this.consumePurchasedSoftCurrency();this.consumeLegacySoftCurrencyPacks();this.createPlaceableBuildings()},onBasketUpdate:function(){},onSitePurchaseConfirmed:function(){this.setSpecialFlags();this.playPurchaseFX();this.consumePurchasedSoftCurrency();this.createPlaceableBuildings()},
onSitePurchaseRejected:function(){},consumePurchasedSoftCurrency:function(){this.consumeSoftCurrencyResource(this.softCurrencyResourceName,1)},consumeLegacySoftCurrencyPacks:function(){this.consumeSoftCurrencyResource(this.legacySoftCurrencyPackResourceName,this.legacySoftCurrencyPerPack)},consumeSoftCurrencyResource:function(a,b){var c=this.globals.storeManager,d,f;if(c&&0<b&&(d=c.getUserItems()))if(d=d[a])f=d.amount,0<f&&(d=function(a){a&&this.awardConsumedSoftCurrency(f*b)}.bind(this),c.consume(a,
f,d))},awardConsumedSoftCurrency:function(a){var b=this.globals.gameManager.getHero();if(b&&0<a&&(b=b.getEC("ECPlayerData")))b.consumeSoftCurrency(a),b.saveResource()},playPurchaseFX:function(){this.globals.gameManager.getGameSoundManager().play("aud_sting_success_2")},createPlaceableBuildings:function(){var a=this.globals.storeManager,b,c,d,f;if(a&&(b=a.getUserItems(),f=a.getResources(),b))for(var e in b)if(b.hasOwnProperty(e)&&(d=this.getBuildingArchetypeFromItemName(e)))if(c=b[e])if("own"===f[e].type)!this.hasBuildingInWorld(d)&&
this.canPlaceBuildingInHerosHand(d)&&this.giveBuildingToHero(d),this.owned[e]=!0;else if(c=c.amount,0<c)if(this.canPlaceBuildingInHerosHand(d)&&!this.consumeBuildingInProgress){if(this.consumeBuildingInProgress=!0,this.sendBuildingConsumeRequest(e,d,a),1<c){this.requestConsumeOnBuildingPlacement();break}}else{this.requestConsumeOnBuildingPlacement();break}},getOwned:function(a){return this.owned[a]},setSpecialFlags:function(){var a=this.globals,b=a.gameManager,a=a.storeManager,c;if(a&&(a=a.getUserItems()))for(var d in a)if(a.hasOwnProperty(d)&&
(c=this.getSpecialFlagFromItemName(d)))b.setSpecialFlag(c),this.owned[d]=!0},hasBuildingInWorld:function(a){var b=this.globals.gameManager,c=b.getBuildingManager();return(a=b.getEntityFactory().getECArchetype(a,"ECBuilding"))?0<c.getBuildingsAtMinLevel(a.buildingType,0,!0).length:!1},sendBuildingConsumeRequest:function(a,b,c){var d;c&&(d=function(a){a&&(this.consumeBuildingInProgress=!1,this.giveBuildingToHero(b))}.bind(this),c.consume(a,1,d))},removeConsumeOnBuildingPlacement:function(){this.globals.gameManager.eventManager.unsubscribe("EmptyHanded",
this.onEmptyHandedCallback);this.onEmptyHandedCallback=void 0},requestConsumeOnBuildingPlacement:function(){var a=this.globals.gameManager.eventManager;this.onEmptyHandedCallback=function(){this.removeConsumeOnBuildingPlacement();this.createPlaceableBuildings()}.bind(this);a.subscribe("EmptyHanded",this.onEmptyHandedCallback)},canPlaceBuildingInHerosHand:function(){var a=this.globals.gameManager.getHero();return!a?!1:(a=a.getEC("ECPlayerBuilder"))?!a.isBuilding():!1},getBuildingArchetypeFromItemName:function(a){switch(a){case "amber-well":return"a_b_amberwell";
case "amber-well-owned":return"a_b_amberwellOwned"}},getSpecialFlagFromItemName:function(a){if("amber-crown"===a)return"amberCrown"},giveBuildingToHero:function(a){var b=this.globals.gameManager.getHero(),c=b.getEC("ECPlayerBuilder"),b=b.getEC("ECLocomotion");c&&(c.placeInHand(a,1,!1,!1,void 0),b&&(b.clearDestination(),b.clearDestinationEntity()))}};Ef.create=function(a){var b=new Ef;b.globals=a;b.softCurrencyResourceName="amber";b.legacySoftCurrencyPackResourceName="mana-pack-standard";b.legacySoftCurrencyPerPack=
250;b.owned={};return b};M.prototype={depotSize:50,update:function(){var a,b,c=this.activeSoundSourceList;for(b=0;b<c.length;)a=c[b],this.updateSoundSource(a)?b+=1:this.removeActiveSoundByIndex(b);this.updateListener()},updateListener:function(){var a=this.globals.soundDevice,b=this.globals.mathDevice;this.listenerMatrix=b.m43Copy(this.globals.camera.matrix,this.listenerMatrix);this.listenerv3WorldLocation&&b.m43SetPos(this.listenerMatrix,this.listenerv3WorldLocation);a&&(a.listenerTransform=this.listenerMatrix)},
setListenerWorldLocation:function(a){this.listenerv3WorldLocation=this.globals.mathDevice.v3Copy(a)},initialize:function(){var a=this.globals.soundDevice,b=[];this.soundSourceDepot=b;this.soundExtension="";var c;if(a){for(c=0;c<this.depotSize;c+=1)b[c]=a.createSource({minDistance:1,maxDistance:30,rollOff:1});a.isSupported("FILEFORMAT_OGG")?this.soundExtension=".ogg":a.isSupported("FILEFORMAT_MP3")&&(this.soundExtension=".mp3");var a=M.archetypes,d;for(d in a)if(a.hasOwnProperty(d))if(b=a[d],b.sounds){var b=
b.sounds,f;for(f in b)b.hasOwnProperty(f)&&(c=b[f],c.path=c.path.replace(".ogg",""),c.path+=this.soundExtension)}else b.path=b.path.replace(".ogg",""),b.path+=this.soundExtension}this.activeSoundSourceList=[]},getSoundsEnabled:function(){return this.soundEnabled},setSoundsEnabled:function(a){this.soundEnabled=a;this.globals.settings.volume=this.soundEnabled?1:0},preload:function(){this.loadArchetypes(!1)},postload:function(){this.loadArchetypes(!0)},loadArchetypes:function(a){var b=M.archetypes,c;
if(this.globals.soundDevice)for(c in b)b.hasOwnProperty(c)&&this.loadArchetype(b[c],a)},loadArchetype:function(a,b){var c=this.soundManager;if(a.sounds){var c=a.sounds,d;for(d in c)c.hasOwnProperty(d)&&this.loadArchetype(c[d],b)}else b===(a.delayedLoad?a.delayedLoad:!1)&&c.load(a.path)},extractParametersToPlay:function(a){a=M.archetypes[a];if(a.random){var b=Math.random()*(a.sounds.length-0.1),b=Math.floor(b);return a.sounds[b]}return a},getSoundSource:function(){var a=this.soundSourceDepot;if(0<
a.length)return a.pop();var b=this.activeSoundSourceList,c=b.length,d,f,e;for(d=0;d<c;d+=1)if(!f||b.priority<f)f=b.priority,e=d;return void 0!==e?(this.removeActiveSoundByIndex(e),a.pop()):null},returnSoundSource:function(a){a&&this.soundSourceDepot.push(a)},removeActiveSoundByIndex:function(a){this.returnSoundSource(this.activeSoundSourceList[a].soundSource);this.activeSoundSourceList.splice(a,1)},playSoundOnSource:function(a,b,c,d,f,e){var h=this.soundManager,i=this.globals.mathDevice,j=this.globals.settings.volume;
return a&&(b&&h)&&(h.isSoundLoaded(b)&&!h.isSoundMissing(b))&&(a.gain=c*j,a.looping=d,a.relative=f,a.position=!a.relative&&e?e:i.v3BuildZero(),b=h.get(b))?(a.play(b),!0):!1},playInternal:function(a,b,c,d){var f=this.extractParametersToPlay(a),e=this.getSoundSource(f.priority),h=b||c?!1:!0,i;h||(i=b||c.getv3Location());if(this.playSoundOnSource(e,f.path,f.volume,f.loop,h,i))this.attachSource(e,b,c,a,f.volume,f.priority,d),e.soundName=a;else{if(f.preview)return this.playInternal(f.preview,b,c,a);this.returnSoundSource(e)}},
stopInternal:function(a,b,c){var b=b?b.getName():void 0,d,f,e=this.activeSoundSourceList;for(f=0;f<e.length;f+=1)if(d=e[f],d.soundName===a&&d.gameEntityName===b){0<c?(d.fadeTime=c,d.startFadeTime=c):(d.soundSource.stop(),this.removeActiveSoundByIndex(f));break}},setVolumeInternal:function(a,b,c,d){var b=b?b.getName():void 0,f,e,h=this.activeSoundSourceList;for(e=0;e<h.length;e+=1)f=h[e],f.soundName===a&&f.gameEntityName===b&&(f.oldVolumeFactor=f.currentVolumeFactor,f.newVolumeFactor=c,f.newVolumeFactorFadeTime=
d,f.newVolumeFactorStartFadeTime=d)},play:function(a,b,c){if(a)if(c&&c.isManagedByThisMachine()){var d=this.globals.mathDevice;this.gameManager.actionManager.addAction("SoundEffect",{soundName:a,v3Location:b?d.v3Copy(b):void 0,gameEntity:c})}else this.playInternal(a,b,c)},setVolume:function(a,b,c,d){a&&this.setVolumeInternal(a,b,c,d)},stop:function(a,b,c){a&&(b&&b.isManagedByThisMachine()?this.gameManager.actionManager.addAction("StopSoundEffect",{soundName:a,gameEntity:b,fadeTime:c}):this.stopInternal(a,
b,c))},attachSource:function(a,b,c,d,f,e,h){this.activeSoundSourceList.push({soundSource:a,v3Location:b,gameEntity:c,gameEntityName:c?c.getName():void 0,soundName:d,originalVolume:f,currentVolumeFactor:1,parentSoundName:h,priority:void 0!==e?e:0})},updateSoundSource:function(a){var b=this.globals.mathDevice,c=this.globals.soundManager,d,f=this.globals.settings.volume;if(!a.soundSource.playing)return!1;var e=a.currentVolumeFactor;if(void 0!==a.startFadeTime)a.fadeTime-=this.globals.gameTimeStep,0>=
a.fadeTime?a.soundSource.stop():e*=a.fadeTime/a.startFadeTime;else if(a.parentSoundName&&(d=this.extractParametersToPlay(a.parentSoundName))&&d.path&&c.isSoundLoaded(d.path)&&!c.isSoundMissing(d.path))a.startFadeTime=0.2,a.fadeTime=0.2,this.playInternal(a.parentSoundName,a.v3Location,a.gameEntity);void 0!==a.newVolumeFactor&&(a.newVolumeFactorFadeTime-=this.globals.gameTimeStep,0>=a.newVolumeFactorFadeTime?(e=a.newVolumeFactor,a.newVolumeFactor=void 0):(c=b.saturate(1-a.newVolumeFactorFadeTime/a.newVolumeFactorStartFadeTime),
e=b.lerp(a.oldVolumeFactor,a.newVolumeFactor,c)));a.currentVolumeFactor=e;a.soundSource.gain=e*a.originalVolume*f;if((f=a.gameEntity)&&f.shouldBeDestroyed())a.gameEntity=void 0;if(a.gameEntity&&!a.soundSource.relative&&(!a.v3Location||!b.v3Equal(a.gameEntity.getv3Location(),a.v3Location)))a.v3Location=b.v3Copy(a.gameEntity.getv3Location(),a.v3Location),a.soundSource.position=a.v3Location;return!0},playCameraSound:function(){},destroy:function(){var a,b,c=this.activeSoundSourceList;for(b=0;b<c.length;b+=
1)a=c[b],a.soundSource.stop();this.activeSoundSourceList.length=0;this.soundSourceDepot.length=0}};M.archetypes={};M.create=function(a,b){var c=new M;c.globals=a;c.gameManager=b;c.soundManager=a.soundManager;c.initialize();return c};Ff.prototype={NUMBER_EVENTS_PER_BATCH:10,update:function(){var a=this.constantMetricDataList,b=this.globals.gameCurrentTime;this.customMetricEventBatch.length()>=this.NUMBER_EVENTS_PER_BATCH&&this.sendBatchedMetrics();a[0]=b},sendBatchedMetrics:function(){var a=this.globals,
b=this.customMetricEventBatch;wa.sendCustomMetricEventBatch(b,a.requestHandler,a.gameSession,this.sendMetricErrorCallback.bind(this));b.clear()},sendGameMetric:function(a,b){void 0===b&&(b=1);this.sendMetric(a,b,!0)},sendMetric:function(a,b,c){var d=this.globals,f=d.requestHandler,d=d.gameSession;ea.saveMetrics&&(this.numberOfMetricsRequests+=1,c?this.customMetricEventBatch.push(a,b):wa.sendCustomMetricEvent(a,b,f,d,this.sendMetricErrorCallback.bind(this)))},isMetricValueValid:function(a){a instanceof
Array||(a=[a]);return a.filter(w.isNumber).length===a.length&&a.length},getNumberOfMetricsRequests:function(){return this.numberOfMetricsRequests},sendMetricErrorCallback:function(){}};Ff.create=function(a){var b=new Ff;b.globals=a;b.numberOfMetricsRequests=0;b.constantMetricDataList=[0];b.customMetricEventBatch=Id.create();return b};ab.prototype={awardBadge:function(a){var b=this.badgeManager;this.globals.gameManager.saveBadges&&(b&&!this.isAwarded(a))&&b.awardUserBadge(a,this.onAwardBadgeSuccess.bind(this),
this.onAwardBadgeError.bind(this))},updateBadgeProgress:function(a,b){if(!(0===b||this.isAwarded(a))){var c=this.badgeManager,d=this.progressBadgePendingScoresMap,f=d[a],e=this.progressBadgeCurrentScoresMap[a];if((void 0===e||b>e)&&(void 0===f||b>f))b=Math.min(this.progressBadgeTotalsMap[a],b),d[a]=b,c.updateUserBadgeProgress(a,b,this.onUpdateProgressBadgeSuccess.bind(this),this.onUpdateProgressBadgeError.bind(this))}},updateBadges:function(){var a=this.badgeManager,b=this.globals.gameManager,c=b.getPlayerData(),
d=b.getHero(),d=d?d.getEC("ECPlayerData"):null;if(b.saveBadges&&a&&this.hasLoadedBadges&&c.getHasLoadedGameStats()&&d){var a=c.getTotalTreesChopped(),b=c.getTotalEnemiesKilled(),f=c.getTotalRocksDestroyed(),d=d.getLevel(),e=c.getTotalWallsBuilt();c.getNumberOfCampaignsWon()&&this.awardBadge(ab.badges.winACampaign);this.updateBadgeProgress(ab.badges.heroLevel5,d);this.updateBadgeProgress(ab.badges.heroLevel15,d);this.updateBadgeProgress(ab.badges.heroLevel30,d);this.updateBadgeProgress(ab.badges.treesChopped10,
a);this.updateBadgeProgress(ab.badges.treesChopped100,a);this.updateBadgeProgress(ab.badges.treesChopped1000,a);this.updateBadgeProgress(ab.badges.enemiesKilled10,b);this.updateBadgeProgress(ab.badges.enemiesKilled100,b);this.updateBadgeProgress(ab.badges.enemiesKilled1000,b);this.updateBadgeProgress(ab.badges.wallsBuilt10,e);this.updateBadgeProgress(ab.badges.wallsBuilt100,e);this.updateBadgeProgress(ab.badges.rocksDestroyed10,f);this.updateBadgeProgress(ab.badges.rocksDestroyed100,f);this.updateBadgeProgress(ab.badges.rocksDestroyed1000,
f)}},getNumberOfBadgeRequests:function(){return this.numberOfBadgeRequests},init:function(a){a.listBadges(this.onListBadgesSuccess.bind(this),this.onListBadgesError.bind(this))},onListBadgesSuccess:function(a){var b=this.badgeManager,c=this.progressBadgeTotalsMap,d=this.progressBadgeCurrentScoresMap,f=a.length,e;for(e=0;e<f;e+=1){var h=a[e],i=h.key;null!==h.total&&(c[i]=h.total,d[i]=0)}b.listUserBadges(this.onListUserBadgesSuccess.bind(this),this.onListUserBadgesError.bind(this))},onListBadgesError:function(){},
onListUserBadgesSuccess:function(a){var b=a.length,c,d=this.badgeAwardStatusMap,f=this.progressBadgeCurrentScoresMap;for(c=0;c<b;c+=1){var e=a[c],h=e.badge_key;d[h]=e.achieved?!0:!1;null!==e.total&&(f[h]=e.current)}this.hasLoadedBadges=!0},onListUserBadgesError:function(){},onAwardBadgeSuccess:function(a){this.setAwarded(a.badge_key);this.numberOfBadgeRequests+=1},onAwardBadgeError:function(){this.numberOfBadgeRequests+=1},onUpdateProgressBadgeSuccess:function(a){var b=a.badge_key,c=a.current,d=this.progressBadgeCurrentScoresMap[b]||
0,f=a.total;this.progressBadgeCurrentScoresMap[b]=c;this.numberOfBadgeRequests+=1;c>=a.total||a.achieved?this.setAwarded(b):this.globals.gameManager.getEventManager().notify("badgeProgressUpdated",{badgeKey:b,currentScore:c,previousScore:d,total:f})},onUpdateProgressBadgeError:function(){this.numberOfBadgeRequests+=1},setAwarded:function(a){this.badgeAwardStatusMap[a]=!0;this.globals.gameManager.getEventManager().notify("badgeAwarded",{badgeKey:a,awarded:!0})},isAwarded:function(a){return this.badgeAwardStatusMap[a]}};
ab.badges={earlyAdopter:"early-adopter",winACampaign:"win-a-campaign",heroLevel5:"hero-level-5",heroLevel15:"hero-level-15",heroLevel30:"hero-level-30",treesChopped10:"10-trees-chopped",treesChopped100:"100-trees-chopped",treesChopped1000:"1000-trees-chopped",enemiesKilled10:"10-enemies-killed",enemiesKilled100:"100-enemies-killed",enemiesKilled1000:"1000-enemies-killed",wallsBuilt10:"walls-built-10",wallsBuilt100:"walls-built-100",rocksDestroyed10:"10-rocks-destroyed",rocksDestroyed100:"100-rocks-destroyed",
rocksDestroyed1000:"1000-rocks-destroyed"};ab.create=function(a,b){var c=new ab;c.globals=a;c.badgeManager=b;c.numberOfBadgeRequests=0;c.progressBadgeTotalsMap={};c.progressBadgePendingScoresMap={};c.progressBadgeCurrentScoresMap={};c.badgeAwardStatusMap={};c.hasLoadedBadges=!1;c.init(b);return c};Gf.prototype={MINIMUM_NOTIFICATION_TIME:600,TIME_TOLLERENCE:60,NEARLY_FULL_PERCENTAGE:0.9,PARTIALLY_FULL_PERCENTAGE:0.5,init:function(){var a=this.globals,b=this.onInitalizationSuccess.bind(this);this.notificationsManager=
wa.createNotificationsManager(a.requestHandler,a.gameSession,b);this.ready=!1;this.notifications={notPlayedForAWhile:{key:"not-played-for-a-while",text:"NOTIFICAITON_NOT_PLAYED_FOR_A_WHILE",delay:0,lastPromise:null,triggerTime:0},notPlayedForALongTime:{key:"not-played-for-a-long-time",text:"NOTIFICAITON_NOT_PLAYED_FOR_A_LONG_TIME",delay:0,lastPromise:null,triggerTime:0},buildingsCompleted:{key:"building-completed",text:"NOTIFICAITON_ACTIONS_COMPLETE",delay:0,lastPromise:null,triggerTime:0},researchCompleted:{key:"research-completed",
text:"NOTIFICAITON_RESEARCH_COMPLETE",delay:0,lastPromise:null,triggerTime:0},defencesCompleted:{key:"defenses-completed",text:"NOTIFICAITON_DEFENCES_COMPLETE",delay:0,lastPromise:null,triggerTime:0},resourcesFull:{key:"resources-full",text:"NOTIFICAITON_RESOURCES_FULL",delay:0,lastPromise:null,triggerTime:0}}},toSeconds:function(a,b,c,d){return d+60*(c+60*(b+24*a))},onInitalizationSuccess:function(){this.notificationsManager.cancelAllNotifications();this.ready=!0},calculateMaxUpgradeTime:function(){var a=
0,b,c=this.globals.gameManager.getGameSpaceList(),d,f,e;for(d=0;d<c.length;d+=1)if(b=c[d],b.getEntityList(),f=b.getEntityList())for(b=0;b<f.length;b+=1)(e=f[b].getEC("ECUpgrader"))&&(a=Math.max(a,e.getUpgradeTimeRemaining()));return a},calculateMaxBuildTime:function(a){var b=0,c,d=this.globals.gameManager.getGameSpaceList(),f,e,h;for(f=0;f<d.length;f+=1)if(c=d[f],c.getEntityList(),e=c.getEntityList())for(c=0;c<e.length;c+=1)(h=e[c].getEC("ECScaffold"))&&h.getScaffoldType()===a&&(b=Math.max(b,h.getBuildTimeRemaining()));
return b},calculateMaxResearchTime:function(){var a=0,b,c=this.globals.gameManager.getGameSpaceList(),d,f,e;for(d=0;d<c.length;d+=1)if(b=c[d],b.getEntityList(),f=b.getEntityList())for(b=0;b<f.length;b+=1)(e=f[b].getEC("ECCapDispenser"))&&(a=Math.max(a,e.getTimeToUnlock()));return a},calculateResourcesFullTime:function(){var a=this.globals.gameManager,b=0,c,d=a.getGameSpaceList(),f,e,h,b=a.getHero().getEC("ECPlayerData"),a=[b.getResourceCap(E.LUMBER),b.getResourceCap(E.STONE)],b=[b.getResource(E.LUMBER),
b.getResource(E.STONE)],i=[[],[]],j;for(f=0;f<d.length;f+=1)if(c=d[f],c.getEntityList(),e=c.getEntityList())for(c=0;c<e.length;c+=1)if(h=e[c].getEC("ECWildlingAgent"))j=h.getPrimaryResourceType(),null!==j&&i[j].push({bedTime:h.getOfflineMinutesBeforeSleeping(),resourcePerMinute:h.getOfflineResourcePerMinute()});d=function(a,b){return a.bedTime-b.bedTime};f=[Number.MAX_VALUE,Number.MAX_VALUE];e=[Number.MAX_VALUE,Number.MAX_VALUE];var k;for(j=0;j<E.NUM_RESOURCES;j+=1){h=i[j];h.sort(d);for(c=1;c<h.length;)h[c-
1].bedTime===h[c].bedTime?(h[c-1].resourcePerMinute+=h[c].resourcePerMinute,h.splice(c,1)):c+=1;for(c=0;c<h.length-1;c+=1)for(k=c+1;k<h.length;k+=1)h[c].resourcePerMinute+=h[k].resourcePerMinute;k=a[j]*this.PARTIALLY_FULL_PERCENTAGE;var l=a[j]*this.NEARLY_FULL_PERCENTAGE;k<=b[j]&&(e[j]=0);l<=b[j]&&(f[j]=0);var m=b[j],q=0,p;for(c=0;c<h.length;c+=1){var s=(h[c].bedTime-q)*h[c].resourcePerMinute;m+s>k&&(p=q+(k-m)/h[c].resourcePerMinute,0<p&&(e[j]=Math.min(e[j],p)));m+s>l&&(p=q+(l-m)/h[c].resourcePerMinute,
0<p&&(f[j]=Math.min(f[j],p)));q=h[c].bedTime;m+=s}}if(f[E.LUMBER]===Number.MAX_VALUE||f[E.STONE]===Number.MAX_VALUE||e[E.LUMBER]===Number.MAX_VALUE||e[E.STONE]===Number.MAX_VALUE)return 0;b=f[E.LUMBER]>f[E.STONE]?Math.max(e[E.LUMBER],f[E.STONE]):Math.max(e[E.STONE],f[E.LUMBER]);return 60*b},updateNotification:function(a,b){var c=b+TurbulenzEngine.time,d=b>this.MINIMUM_NOTIFICATION_TIME;a.triggerTime&&(Math.abs(c-a.triggerTime)>this.TIME_TOLLERENCE?(a.lastPromise.cancel(),a.lastPromise=null,a.triggerTime=
0):d=!1);d&&(a.delay=b,a.triggerTime=c,a.lastPromise=this.notificationsManager.sendDelayedNotification({key:a.key,msg:{text:this.globals.currentLanguage[a.text]},delay:a.delay}))},updateBuildingsCompletedMessage:function(){var a=this.notifications.buildingsCompleted,b=this.calculateMaxUpgradeTime(),c=this.calculateMaxBuildTime("normal"),d=Math.max(b,c);a.text=b&&c?"NOTIFICAITON_BUILDING_AND_UPGRADES_COMPLETE":b?"NOTIFICAITON_BUILDING_UPGRADES_COMPLETE":"NOTIFICAITON_BUILDING_COMPLETE";this.updateNotification(a,
d)},updateResearchCompletedMessage:function(){var a=this.calculateMaxResearchTime();this.updateNotification(this.notifications.researchCompleted,a)},updateDefencesCompletedMessage:function(){var a=this.calculateMaxBuildTime("war");this.updateNotification(this.notifications.defencesCompleted,a)},updateResourcesFullMessage:function(){var a=this.calculateResourcesFullTime();this.updateNotification(this.notifications.resourcesFull,a)},updateComebackMessages:function(){var a=0,b=0;this.notifications.buildingsCompleted.triggerTime&&
(b+=1);this.notifications.defencesCompleted.triggerTime&&(b+=1);this.notifications.researchCompleted.triggerTime&&(b+=1);this.notifications.resourcesFull.triggerTime&&(b+=1);a=2>b?this.toSeconds(7,0,0,0):0;this.updateNotification(this.notifications.notPlayedForAWhile,a);a=0===b?this.toSeconds(30,0,0,0):0;this.updateNotification(this.notifications.notPlayedForALongTime,a)},onSave:function(){this.ready&&(this.updateBuildingsCompletedMessage(),this.updateResearchCompletedMessage(),this.updateResourcesFullMessage(),
this.updateComebackMessages())}};Gf.create=function(a){var b=new Gf;b.globals=a;b.init();return b};Hf.prototype={dataKeyHeroUpgrades:"heroUpgrades",dataKeyResource:"resource",dataKeySoftCurrency:"softCurrency",dataKeyConsumedSoftCurrency:"consumedSoftCurrency",dataKeyProgress:"progress",dataKeyGameStats:"gameStats",dataKeySettings:"settings",dataKeyShared:"shareData",dataKeyNumberOfGamesPlayed:"numberOfGamesPlayed",dataKeyScriptFlags:"scriptFlags",dataKeyTaskFlags:"taskFlags",init:function(a){this.globals=
a;this.saving=this.loading=0;this.hasLoadedGameStats=!1;this.initHeroUpgrades();this.initResource();this.initResourceCap();this.initSoftCurrency();this.initConsumedSoftCurrency();this.initProgress();this.initGameStats();this.initSettings();this.initNumberOfGamesPlayed();this.initScriptFlags();this.initTaskFlags();this.initShareData()},initHeroUpgrades:function(){this.heroUpgrades={}},initResource:function(){this.resource=[0,0]},initResourceCap:function(){this.resourceCap=[0,0]},initSoftCurrency:function(){this.softCurrency=
0},initConsumedSoftCurrency:function(){this.consumedSoftCurrency=0},initProgress:function(){this.progress={xp:0}},initNumberOfGamesPlayed:function(){this.numberOfGamesPlayed={count:0}},initScriptFlags:function(){this.scriptFlags={}},initTaskFlags:function(){this.taskFlags={}},initShareData:function(){this.shareData={}},initGameStats:function(){this.gameStats={playerScore:0,totalCampaignsWon:0,totalWallsBuilt:0,totalTreesChopped:0,totalRocksDestroyed:0,totalEnemiesKilled:0,totalTimePlayed:0,softCurrencyFound:0}},
initSettings:function(){this.settings={shadows:!1,sounds:!0,music:!0}},loadInfoFromThisPlayer:function(){this.load()},attach:function(a){this._super(a)},getNumberOfGamesPlayed:function(){var a=0;this.numberOfGamesPlayed&&this.numberOfGamesPlayed.count&&(a=this.numberOfGamesPlayed.count);return a},clearScriptFlags:function(){for(var a in this.scriptFlags)this.scriptFlags.hasOwnProperty(a)&&(this.scriptFlags[a]=!1);this.saveScriptFlags()},getScriptFlags:function(){return this.scriptFlags},setScriptFlag:function(a,
b){this.scriptFlags[a]=b;this.saveScriptFlags()},addXP:function(a){this.progress.xp+=a},getXP:function(){return this.progress.xp},getHeroUpgrade:function(a){return void 0!==this.heroUpgrades[a]?this.heroUpgrades[a]:0},setHeroUpgrade:function(a,b){var c=this.getHeroUpgrade(a);this.heroUpgrades[a]=b;this.heroUpgrades.total||(this.heroUpgrades.total=0);this.heroUpgrades.total+=b-c;this.saveHeroUpgrades()},getResource:function(a){return this.globals.cheats.grindless?0:this.resource[a]},adjustResource:function(a,
b){b&&(this.resource[a]+=b,this.resource[a]=Math.min(this.resource[a],this.resourceCap[a]),this.resource[a]=Math.max(this.resource[a],0),this.resource[a]=Math.round(this.resource[a]),this.saveResource())},adjustResourceCap:function(a,b){b&&(this.resourceCap[a]+=b,this.resourceCap[a]=Math.max(this.resourceCap[a],0),this.resourceCap[a]=Math.round(this.resourceCap[a]),0>b&&this.resource[a]>this.resourceCap[a]&&this.adjustResource(a,this.resource[a]-this.resourceCap[a]))},getResourceCap:function(a){return this.globals.cheats.grindless?
0:this.resourceCap[a]},getSoftCurrency:function(){return this.globals.cheats.grindless?0:this.softCurrency},adjustSoftCurrency:function(a){a&&(this.softCurrency+=a,this.softCurrency=Math.max(this.softCurrency,0),this.saveSoftCurrency())},consumeSoftCurrency:function(a){0<a&&(this.adjustSoftCurrency(a),this.consumedSoftCurrency+=a,this.saveConsumedSoftCurrency())},getConsumedSoftCurrency:function(){return this.consumedSoftCurrency},setConsumedSoftCurrency:function(a){this.consumedSoftCurrency=a},getKey:function(a){return a},
load:function(){this.loadHeroUpgrades();this.loadResource();this.loadSoftCurrency();this.loadConsumedSoftCurrency();this.loadProgress();this.loadGameStats();this.loadSettings();this.loadShared();this.loadNumberOfGamesPlayed();this.loadScriptFlags();this.loadTaskFlags()},getLoading:function(){return 0<this.loading},loadNumberOfGamesPlayed:function(){this.loadData(this.dataKeyNumberOfGamesPlayed)},saveNumberOfGamesPlayed:function(){this.saveData(this.dataKeyNumberOfGamesPlayed,this.numberOfGamesPlayed)},
loadScriptFlags:function(){this.loadData(this.dataKeyScriptFlags)},saveScriptFlags:function(){var a=this.dataKeyScriptFlags,b=this.getScriptFlags();this.saveData(a,b)},loadTaskFlags:function(){this.loadData(this.dataKeyTaskFlags)},saveTaskFlags:function(){var a=this.dataKeyTaskFlags,b=this.getTaskFlags();this.saveData(a,b)},getTaskFlags:function(){return this.taskFlags},setTaskFlag:function(a,b,c){this.taskFlags[a]=b;c&&this.saveTaskFlags()},loadHeroUpgrades:function(){this.loadData(this.dataKeyHeroUpgrades)},
saveHeroUpgrades:function(){this.saveData(this.dataKeyHeroUpgrades,this.heroUpgrades)},loadResource:function(){this.loadData(this.dataKeyResource)},saveResource:function(){this.saveData(this.dataKeyResource,this.resource)},loadSoftCurrency:function(){this.loadData(this.dataKeySoftCurrency)},saveSoftCurrency:function(){var a=this.dataKeySoftCurrency,b=this.getSoftCurrency();this.saveData(a,b)},loadConsumedSoftCurrency:function(){this.loadData(this.dataKeyConsumedSoftCurrency)},saveConsumedSoftCurrency:function(){var a=
this.dataKeyConsumedSoftCurrency,b=this.getConsumedSoftCurrency();this.saveData(a,b)},loadConsumedSoftCurrencyBeforeReset:function(){var a=this;this.loadData(this.dataKeyConsumedSoftCurrency,function(b){a.initConsumedSoftCurrency();0<b?a.consumeSoftCurrency(b):a.saveConsumedSoftCurrency()},function(){a.initConsumedSoftCurrency();a.saveConsumedSoftCurrency()})},loadProgress:function(){this.loadData(this.dataKeyProgress)},saveProgress:function(){this.saveData(this.dataKeyProgress,this.progress)},getHasLoadedGameStats:function(){return this.hasLoadedGameStats},
loadGameStats:function(){var a=this.dataKeyGameStats,b=function(){this.hasLoadedGameStats=!0}.bind(this);this.loadData(a,b)},saveGameStats:function(){this.saveData(this.dataKeyGameStats,this.gameStats)},loadSettings:function(){var a=this.dataKeySettings,b=function(){void 0===this.settings.sounds&&(this.settings.sounds=!0);void 0===this.settings.music&&(this.settings.music=!0)}.bind(this);this.loadData(a,b)},saveSettings:function(){this.saveData(this.dataKeySettings,this.settings)},loadShared:function(){this.loadData(this.dataKeyShared)},
saveShared:function(){this.saveData(this.dataKeyShared,this.shareData)},loadData:function(a,b,c){var d=this.globals.userDataManager,f=this.getKey(a);this.loading+=1;var e=function(a,c){var d=JSON.parse(c);this.loading-=1;null!==d&&(this[a]=d);b&&b(d)}.bind(this),h=function(a,b){c?(this.loading-=1,c()):404!==b&&TurbulenzEngine.setTimeout(function(){d.get(f,e,h)},5E3)}.bind(this);d.get(f,e,h)},saveData:function(a,b){var c=this.globals.userDataManager,d=this.globals.gameManager,f=this.getKey(a),e=JSON.stringify(b);
if(d.getSavingEnabled()){this.saving+=1;this.numberOfRequests+=1;var d=function(){this.saving-=1}.bind(this),h=function(){this.saving-=1}.bind(this);c.set(f,e,d,h)}},getNumberOfRequests:function(){return this.numberOfRequests},getSaving:function(){return 0<this.saving},increaseNumberOfGamesPlayed:function(){this.numberOfGamesPlayed&&(this.numberOfGamesPlayed.count||(this.numberOfGamesPlayed.count=0),this.numberOfGamesPlayed.count+=1);this.saveNumberOfGamesPlayed()},addPlayerScore:function(a){this.gameStats.playerScore+=
a},getPlayerScore:function(){return this.gameStats.playerScore},addKill:function(){this.gameStats.totalEnemiesKilled+=1},getTotalEnemiesKilled:function(){return this.gameStats.totalEnemiesKilled},getNumberOfCampaignsWon:function(){return this.gameStats.totalCampaignsWon},addCampaignsWon:function(a){this.gameStats.totalCampaignsWon||(this.gameStats.totalCampaignsWon=0);this.gameStats.totalCampaignsWon+=a},getTotalWallsBuilt:function(){return this.gameStats.totalWallsBuilt},addWallsBuilt:function(a){this.gameStats.totalWallsBuilt||
(this.gameStats.totalWallsBuilt=0);this.gameStats.totalWallsBuilt+=a},addTreeChopped:function(){this.gameStats.totalTreesChopped+=1},getTotalTreesChopped:function(){return this.gameStats.totalTreesChopped},addRockDestroyed:function(){this.gameStats.totalRocksDestroyed+=1},getTotalRocksDestroyed:function(){return this.gameStats.totalRocksDestroyed},addTimePlayed:function(a){this.gameStats.totalTimePlayed+=a},getTotalTimePlayed:function(){return this.gameStats.totalTimePlayed},addSoftCurrencyFound:function(a){this.gameStats.softCurrencyFound+=
a},getSoftCurrencyFound:function(){return this.gameStats.softCurrencyFound},getShadowsEnabled:function(){return this.settings.shadows},setShadowsEnabled:function(a){this.settings.shadows=a;this.saveSettings()},getSoundsEnabled:function(){return this.settings.sounds},setSoundsEnabled:function(a){this.settings.sounds=a;this.saveSettings()},getMusicEnabled:function(){return this.settings.music},setMusicEnabled:function(a){var b=this.globals.gameManager;a!==this.settings.music&&((this.settings.music=
a)?b.setMusicVolume(1,0):b.setMusicVolume(0,0),this.saveSettings())},getTimeShared:function(a){return this.shareData[a]},setShared:function(a){this.shareData[a]=this.globals.gameManager.getTimeInSecondsSince1970();this.saveShared()},fullSave:function(){this.saveNumberOfGamesPlayed();this.saveScriptFlags();this.saveTaskFlags();this.saveHeroUpgrades();this.saveResource();this.saveSoftCurrency();this.saveConsumedSoftCurrency();this.saveProgress();this.saveGameStats();this.saveSettings();this.saveShared()},
reset:function(){this.loadConsumedSoftCurrencyBeforeReset();this.initHeroUpgrades();this.initResource();this.initResourceCap();this.initSoftCurrency();this.initProgress();this.initGameStats();this.initNumberOfGamesPlayed();this.initScriptFlags();this.initTaskFlags();this.initShareData();this.globals.gameManager.getSavingEnabled()&&(this.saveNumberOfGamesPlayed(),this.saveScriptFlags(),this.saveTaskFlags(),this.saveHeroUpgrades(),this.saveResource(),this.saveProgress(),this.saveGameStats(),this.saveShared())},
resetForNewSaveVersion:function(){this.loadConsumedSoftCurrencyBeforeReset();this.initHeroUpgrades();this.initResource();this.initResourceCap();this.initProgress();this.initNumberOfGamesPlayed();this.initScriptFlags();this.initTaskFlags();this.initShareData();this.fullSave()}};Hf.create=function(a){var b=new Hf;b.init(a);return b};Hb.prototype={globals:void 0,MIN_TIME_BETWEEN_LEADERBOARD_UPDATES:15,MAX_TIME_BETWEEN_LEADERBOARD_UPDATES:20,MIN_TIME_BETWEEN_BADGE_UPDATES:3,MAX_TIME_BETWEEN_BADGE_UPDATES:20,
initialise:function(a,b){var c=this.globals;this.isHost=a;this.randomPlayerIndex=b%2+1;this.setUniqueSuffix("_"+b.toString()+"_");this.aiActionFactory=Da.create(c);this.projectileFactory=sf.create(c,this);this.damager=A;this.damager.setGlobals(c,this);this.actionManager=Df.create(c,this);this.factionManager=uf.create(c);var d=vf.create(c);d.initialise();this.buildingManager=d;d=Vd.create(c);d.initialise();var f=Vd.create(c);f.initialise();this.resourceDispenserManagers=[d,f];c.currentLanguage=uk;
this.gameScriptManager=Kg.create(c);this.gameScriptManager.initialise();this.useSplashScreens?this.setGameState(this.gamestateSplashScreens):(this.gamestateSplashScreens=void 0,c=td.create(this,c),c.setUsePlayerSaveData(this.autoLoad),this.setGameState(c));this.initUI();this.clockBasedDayTime&&this.initGameDayTime();this.gameMonitor.start();this.scratchpad={};this.evaluateGuest()},evaluateGuest:function(){this.globals.userProfile.guest&&(this.guest=!0);ea.forceGuest&&(this.guest=!0)},getGuest:function(){return this.guest},
preload:function(){var a=this.globals;this.gameScoresUI.preload();this.imgui.preload();this.gameSoundManager.preload();this.effectFactory.preload();this.entityFactory.preload();this.blockFactory.preload();ba.preload(a);this.gameController.preload();this.gamestateSplashScreens.preload();this.globals.guiRenderer.preload()},postload:function(){this.gameSoundManager.postload()},setProfileECs:function(a){this.profileECs=a},setSlomo:function(a){this.gameClock.setTimeDilation(a)},slowDown:function(){this.speedUpFactor=
Math.max(0.5*this.speedUpFactor,0.125);this.setSlomo(this.speedUpFactor)},speedUp:function(){this.speedUpFactor=Math.min(2*this.speedUpFactor,128);this.setSlomo(this.speedUpFactor)},speedReset:function(){this.speedUpFactor=1;this.setSlomo(this.speedUpFactor)},initUI:function(){var a=this.globals,b=a.dynamicUI;b&&(this.gameLighting.initUI(),b.watchVariable("God Mode",a.cheats,"godMode","checkbox"),b.watchVariable("Invisible",a.cheats,"invisibleMode","checkbox"),b.watchVariable("InfiniteAndInstant",
a.cheats,"grindless","checkbox"),this.initECMaskDebugDrawUI(),this.initECDebugDrawUI(),this.gameController.initUI(),a=b.addGroup("Physics"),b.watchVariable("Gravity",qa.prototype,"gravity","slider",a,{min:0,max:50,step:0.1}),b.watchVariable("Jump Speed",qa.prototype,"jumpForce","slider",a,{min:0,max:20,step:0.1}),a=b.addGroup("Supers"),b.watchVariable("ChargeDuration",Nd.prototype,"chargeDuration","slider",a,{min:0,max:3,step:0.1}),b.watchVariable("Pause Attacks",this,"pauseAttacks","checkbox"),b.watchVariable("Variable Step",
this,"variableStep","checkbox"))},initECMaskDebugDrawUI:function(){var a=this.globals,a=a.dynamicUI.addGroup("EC Debug Draw Masks",a.debugDrawFlagsUIGroup),b=Hb.ecDebugDrawMasks,c;for(c in b)b.hasOwnProperty(c)&&this.addDebugDrawMaskUI(b[c],a)},addDebugDrawMaskUI:function(a,b){var c=this.globals.dynamicUI,d={getValue:function(){return this.isActiveECDebugDrawMask(a)}.bind(this),setValue:function(b){b?this.addECDebugDrawMask(a):this.removeECDebugDrawMask(a)}.bind(this)};c.watchVariable(a.uiName,this,
a.uiName,"checkbox",b,d)},initECDebugDrawUI:function(){var a=this.ecDebugDrawFlags,b=this.globals,c=b.dynamicUI,b=c.addGroup("EC Debug Draw",b.debugDrawFlagsUIGroup),d=F.prototype.eCCreationMap,f;for(f in d)d.hasOwnProperty(f)&&(a[f]=!1,c.watchVariable(f,a,f,"checkbox",b))},getFreeHeroIndex:function(){return this.randomPlayerIndex},createHero:function(a,b,c){var d=this.globals.mathDevice,f=this.getEntityFactory(),e=this.getFactionManager(),c=c||d.v3Add(this.getHeroRespawnPosition(),d.v3Build(0,3,
0)),h=[{r:0,g:0.5,b:0},{r:0.5,g:0,b:0},{r:0,g:0,b:0.5},{r:0.5,g:0.5,b:0},{r:0,g:0.5,b:0.5},{r:0.5,g:0,b:0.5},{r:0,g:0,b:0}],i=this.getFreeHeroIndex(),h=h[(i-1)%h.length],a=f.createActiveEntityInstance(a,b,c,!0),b=a.getEC("ECHero");b.setHeroColour(h.r,h.g,h.b);b.setHeroNumber(i);e=e.getHeroFactionName();a.getEC("ECFaction").setFaction(e);this.amberCrown&&a.createHeldEntity("characters/models/ambercrown.dae",d.v3Build(0,1,0),1.25,"amberCrown");return a},startMusic:function(a){this.musicString!==a&&
(this.stopMusic(),this.gameSoundManager.play(a,null,null),this.musicString=a,this.getMusicEnabled()||this.setMusicVolume(0,0))},setMusicVolume:function(a,b){this.musicString&&(this.gameSoundManager.setVolume(this.musicString,void 0,a,0.25),void 0===b&&(b=0.25),this.gameSoundManager.setVolume(this.musicString,void 0,a,b))},getMusicEnabled:function(){return this.getPlayerData().getMusicEnabled()},stopMusic:function(){this.musicString&&(this.gameSoundManager.stop(this.musicString,null,1),this.musicString=
void 0)},startAmbientMusic:function(){this.combatMusic=!1;this.updateGameDayTimeMusic()},startCombatMusic:function(a){a?this.startMusic("aud_music_battle_boss"):this.startMusic("aud_music_battle");this.combatMusic=!0},updateGameDayTimeMusic:function(){this.combatMusic||(this.isNight()?this.startMusic("aud_music_night"):this.startMusic("aud_music_day"))},isNight:function(){return 20<this.gameDayTime||4>this.gameDayTime},calculateCurrentSpace:function(){if(this.heroEntity){var a=this.globals.mathDevice,
b=this.heroEntity.v3Location,c=this.heroEntity.getGameSpace(),d=this.getCurrentGameSpace();void 0!==c&&(void 0===d?(this.setCurrentGameSpace(c),this.enterRoom(c)):d!==c&&a.aabbPointDistance(c.extents,b)<a.aabbPointDistance(this.currentGameSpace.extents,b)-0.25&&(this.setCurrentGameSpace(c),this.enterRoom(c)))}},setCurrentGameSpace:function(a){this.currentGameSpace=a},getCurrentGameSpace:function(){return this.currentGameSpace},setHero:function(a){this.heroEntity=a;var b=this.heroEntity.getEC("ECPlayerData");
b&&(this.newSaveVersion||b.loadInfoFromThisPlayer());this.gameController.setHero(a);this.gameCamera.setHero(a)},getHeroRespawnPosition:function(){var a=this.globals.mathDevice,b,c;c=null;if(a&&(c=this.getFactionManager(),b=c.getHeroFactionName(),c&&(b=c.getFactionByName(b))))if(b=b.getHQ())return c=a.v3Copy(b.getv3Location()),c[1]+=0.5,c[2]-=2*b.getMinRadius(),c;a=this.getEntitiesWithEC("ECLocationMarker");b=a.length;var d;for(d=0;d<b;d+=1)if(c=a[d].getEC("ECLocationMarker"),"heroSpawnLocation"===
c.getType())return c.getv3Location();return this.v3Respawn},setHeroRespawnPosition:function(a){this.v3Respawn=this.globals.mathDevice.v3Copy(a,this.v3Respawn)},sendPerSessionMetrics:function(){var a=this.globals,b=a.metricsManager,c;this.minMsPerFrameInGame&&b.sendGameMetric("minMsPerFrameInGame",this.minMsPerFrameInGame);this.maxMsPerFrameInGame&&b.sendGameMetric("maxMsPerFrameInGame",this.maxMsPerFrameInGame);(c=this.cumulativeMsPerFrameInGame/this.numberOfFramesInGame)&&b.sendGameMetric("meanMsPerFrameInGame",
c);b.sendGameMetric("shadowsEnabled",this.getPlayerData().getShadowsEnabled()?1:0);a=a.graphicsDevice;b.sendGameMetric("windowSize",[a.width,a.height]);b.sendBatchedMetrics()},autoUpdateLeaderboards:function(){this.shouldUpdateLeaderboards=!0},autoUpdateBadges:function(){this.shouldUpdateBadges=!0},forceLeaderboardUpdate:function(){this.autoUpdateLeaderboards();this.lastLeaderboardsUpdateTime=0},updateLeaderboards:function(){var a=this.globals,b=a.leaderboardManager;if(this.saveLeaderboards&&b){var c=
this.heroEntity;if(c){var d=c.getEC("ECPlayerData"),c=Math.round(d.getLevel()),f=Math.round(d.getTotalTreesChopped()),e=Math.round(d.getTotalRocksDestroyed()),h=Math.round(d.getTotalEnemiesKilled()),i=Math.round(d.getTotalTimePlayed()),d=Math.round(d.getSoftCurrencyFound()),j,k;j=this.onLeaderboardSetSuccess.bind(this);k=this.onLeaderboardSetError.bind(this);this.shouldUpdateLeaderboards=!1;this.lastLeaderboardsUpdateTime=a.gameCurrentTime;c&&b.set("hero-level",c,j,k);f&&b.set("total-trees-chopped",
f,j,k);e&&b.set("total-rocks-destroyed",e,j,k);h&&b.set("total-enemies-killed",h,j,k);i&&b.set("total-time-played",i,j,k);d&&b.set("soft-currency-found",d,j,k)}}},onLeaderboardSetSuccess:function(){this.numberOfLeaderboardRequests+=1},onLeaderboardSetError:function(){this.numberOfLeaderboardRequests+=1},getNumberOfLeaderboardRequests:function(){return this.numberOfLeaderboardRequests},getSceneReadyToRender:function(){return this.hasLoadedLevel},draw:function(){this.activeGameState.draw();this.drawDebug();
this.drawSaveLoadStatus();this.drawSpeedUpStatus();this.drawShadowEvaluateStatus()},drawDebug:function(){var a=this.globals.debugDrawFlags;a.physics&&this.drawGameSpacesDebugPhysics();a.controller&&this.drawDebug();a.gameSpaces&&this.drawGameSpacesDebug();a.nav&&this.getNavManager().debugDraw()},drawSaveLoadStatus:function(){if(this.getLoading()||this.getSaving()){var a=this.globals,b=a.simpleFontRenderer,a=a.graphicsDevice,a={x:a.width/2,y:a.height-50,pointSize:16,alignment:1};this.getLoading()&&
b.drawFontDouble("Loading Level...",a);this.getSaving()&&b.drawFontDouble("Saving Level...",a)}},drawShadowEvaluateStatus:function(){if(this.shouldAutoUpdateShadows){var a=this.globals,b=a.graphicsDevice;a.simpleFontRenderer.drawFontDouble("Testing Shadows (can be toggled in pause menu)...",{x:b.width/2,y:b.height-50,pointSize:16,alignment:1})}},drawSpeedUpStatus:function(){if(1!==this.speedUpFactor){var a=this.globals,b=a.graphicsDevice;a.simpleFontRenderer.drawFontDouble(this.speedUpFactor.toString()+
" x Speedup.",{x:b.width/2,y:b.height-50,pointSize:32,alignment:1})}},drawTooManyAgentWarning:function(){var a=this.getFactionManager(),b=a.getEnemyFactionName();if(b&&(a=a.getFactionByName(b))&&!(20>a.getAgentRefCount())){var c=this.globals,b=c.simpleFontRenderer,d=c.graphicsDevice,c={x:d.width/2,y:d.height/3,pointSize:128,alignment:1,color:c.mathDevice.v4Build(1,0,0,1)};b.drawFont(""+a.getAgentRefCount()+" Enemies !!1one",c)}},drawGUI:function(){this.gameScoresUI.draw2D(this.heroList,this.heroEntity)},
enterRoom:function(a){a&&this.startAmbientMusic()},invasionStart:function(){this.onCombatStart();this.invasionRefCount+=1},invasionEnd:function(){this.onCombatEnd();this.invasionRefCount-=1},getInvasionCount:function(){return this.invasionRefCount},skirmishStart:function(){this.onCombatStart();this.skirmishRefCount+=1},skirmishEnd:function(){this.onCombatEnd();this.skirmishRefCount-=1},getSkirmishCount:function(){return this.skirmishRefCount},onCombatStart:function(){this.combatRefCount||(this.combatRefCount=
0,this.eventManager.notify("CombatStarted"));this.combatRefCount+=1},onCombatEnd:function(){(this.combatRefCount-=1)||this.eventManager.notify("CombatEnded")},getCombatCount:function(){return this.combatRefCount},isInCombat:function(){return 0<this.combatRefCount},addPotentialScore:function(a){this.potentialScore+=a},getPotentialScore:function(){return this.potentialScore},addPotentialEnemies:function(a){this.totalEnemies+=a},getPotentialEnemies:function(){return this.totalEnemies},onNavGridUpdated:function(){this.eventManager.notify("NavGridUpdated")},
loadPlayerInfo:function(){this.playerData.loadInfoFromThisPlayer()},saveLevel:function(a){if(this.hasLoadedLevel&&(a||this.getSavingEnabled())){var a=this.globals,b=ra.Serialize.serializePlayerSave(this),c=function(){var a;this.savingCount-=1;this.hasSavedThisSession||((a=this.getPlayerData())&&a.increaseNumberOfGamesPlayed(),this.hasSavedThisSession=!0)}.bind(this),d=function(){this.savingCount-=1}.bind(this);ra.SaveLoad.saveLevelToUserData("AdventureIncGameState",b,a.userDataManager,c,d);this.globals.gameNotificationsManager.onSave();
this.savingCount+=1;this.autoSaveRequested=!1;this.lastSaveTime=a.gameCurrentTime}},loadlLevelOnStartup:function(a){var b=this.globals,c=b.requestHandler,d=b.mappingTable,b=b.userDataManager,f=this.startUpLevelPath,e=this.defaultPlayerSavePath,h,i,j=function(a,b){this.loadingCount-=1;h=b;i&&this.parseAndSetLevel(h,i)}.bind(this),k=function(){this.loadingCount-=1}.bind(this),l=function(a,b){this.loadingCount-=1;if(b){var c=JSON.parse(b),d=parseFloat(c.saveVersionNumber),f=isNaN(d)||1>d;d!==this.saveVersionNumber&&
f?(this.newSaveVersion=!0,q()):h?this.parseAndSetLevel(h,c):i=c}else q()}.bind(this),m=function(){this.loadingCount-=1;q()}.bind(this),q=function(){this.loadingCount+=1;ra.SaveLoad.loadLevelFromFile(e,c,d,p,s)}.bind(this),p=function(a,b){this.loadingCount-=1;i=b;h&&this.parseAndSetLevel(h,i)}.bind(this),s=function(){this.loadingCount-=1}.bind(this);a?(this.loadingCount+=1,ra.SaveLoad.loadLevelFromUserData("AdventureIncGameState",b,l,m)):(this.loadingCount+=1,ra.SaveLoad.loadLevelFromFile(e,c,d,p,
s));this.loadingCount+=1;ra.SaveLoad.loadLevelFromFile(f,c,d,j,k)},parseAndSetLevel:function(a,b){var c=this.getBlockFactory(),d=this.getEntityFactory(),c=ra.Parse.parseLevelDataFromLevelAndPlayerSave({levelSaveData:a,playerSaveData:b},c,d,this.globals);this.setCurrentLevel(c);Rg.enable(this.globals);this.onLevelLoaded()},getTimeInSecondsSince1970:function(){return 0.001*this.dateObject.getTime()},setCurrentLevel:function(a){var b=a.gameSpaceList,c=a.scriptData;this.resetGameState();var d=this.getTimeInSecondsSince1970(),
f=ea.extraOfflineSeconds;0<this.getPlayerData().getNumberOfGamesPlayed()?(this.timeSinceSave=d-a.timeStamp,void 0!==f&&(this.timeSinceSave+=f),this.timeSinceSave=Math.max(this.timeSinceSave,0)):(this.timeSinceSave=0,this.shouldAutoUpdateShadows=!0);a.uniqueIndex&&(this.uniqueIndex=a.uniqueIndex);a.uniqueLevelIndex&&(this.uniqueLevelIndex=a.uniqueLevelIndex);b.forEach(this.addGameSpaceAndActivate.bind(this));c&&this.gameScriptManager.deserialize(c);a=this.createHero("HeroDude",this.getHeroArchetype());
this.setHero(a)},refreshHeroEntity:function(){this.heroEntity.setToBeDestroyed();var a=this.createHero("HeroDude",this.getHeroArchetype(),this.heroEntity.getv3Location());this.setHero(a)},getHeroArchetype:function(){var a=this.getPlayerData(),a=id.getLevelFromXP(a.getXP()),a=Math.min(ea.heroArchetype.length-1,a);return ea.heroArchetype[a]},resetGameState:function(){var a=this.globals,b=this.getGameClock();this.clearGameSpaces();this.reset();b.start();a.gameCurrentTime=b.getCurrentTime();a.gameTimeStep=
b.getTimeStep();this.startPaused();this.getFactionManager().reset();this.gameScriptManager.reset()},getAdditionalTimeFromSave:function(){return this.timeSinceSave*this.outOfGameTimeFactor},getPureAdditionalTimeFromSave:function(){return this.timeSinceSave},onLevelLoaded:function(){this.lastSaveTime=this.globals.gameCurrentTime;this.hasLoadedLevel=!0},autoSaveLevel:function(){this.autoSave&&(this.autoSaveRequested=!0)},forceLevelSave:function(){this.autoSaveLevel();this.lastSaveTime=0},setSavingEnabled:function(a){this.savingEnabled=
a},getSavingEnabled:function(){return this.savingEnabled},clearUserData:function(){this.playerData.reset()},getPlayerData:function(){return this.playerData},getLoading:function(){return 0<this.loadingCount||this.playerData.getLoading()},getSaving:function(){return 0<this.savingCount||this.playerData.getSaving()},destroy:function(){this.setSavingEnabled(!1);this.clearGameSpaces()},addHeroEntity:function(a){this.heroList.push(a)},removeHeroEntity:function(a){a=this.heroList.indexOf(a);0<=a&&this.heroList.splice(a,
1)},restart:function(a){this.gameCamera.reset();var b=td.create(this,this.globals);b.setUsePlayerSaveData(a);this.setPlayState(null);this.setGameState(b)},getGameEntityByName:function(a){var b,c,d=this.gameSpaceList;if(a)for(c=0;c<d.length;c+=1)if(b=d[c],b=b.getGameEntityByName(a))return b},getNearestGameEntityByFamilyName:function(a,b){var c,d=this.gameSpaceList,f=[];for(c=0;c<d.length;c+=1)f.push.apply(f,d[c].getEntitiesWithFamilyName(a));return this.getNearestEntityFromList(b,f)},getGameEntitiesByFamilyName:function(a){var b,
c=this.gameSpaceList,d=[];for(b=0;b<c.length;b+=1)d=d.concat(c[b].getEntitiesWithFamilyName(a));return d},getNearestScaffoldWithFamilyName:function(a,b){for(var c=this.getEntityFactory(),d=this.getGameEntitiesByFamilyName("scaffold"),f=d.length,e,h,i=[],j=0;j<f;j+=1)e=d[j],h=e.getEC("ECScaffold"),h=h.getPlannedObject(),h=c.getEntityArchetype(h),(h.familyName===a||c.hasSocketOfFamilyName(h,a))&&i.push(e);return this.getNearestEntityFromList(b,i)},getNearestGameEntityByArcheType:function(a,b){var c,
d=this.gameSpaceList,f=[];for(c=0;c<d.length;c+=1)f.push.apply(f,d[c].getEntitiesWithArcheType(a));return this.getNearestEntityFromList(b,f)},getGameEntitiesByArcheType:function(a){var b,c=this.gameSpaceList,d=[];for(b=0;b<c.length;b+=1)d=d.concat(c[b].getEntitiesWithArcheType(a));return d},getNearestEntityFromList:function(a,b,c){if(b){var d=this.globals.mathDevice,f,c=void 0!==c?c*c:Infinity,e,h;for(e=0;e<b.length;e+=1)h=d.v3DistanceSq(b[e].getv3Location(),a),h<c&&(f=b[e],c=h);return f}},getEntitiesWithEC:function(a){return F.getEntitiesWithEC(a)},
getFirstEntityWithEC:function(a){a=this.getEntitiesWithEC(a);if(0<a.length)return a[0]},getTotalRepairCost:function(){var a=this.getBuildingManager().getBuildings(),b,c,d,f=0,e=0;if(a){b=a.length;for(c=0;c<b;c+=1)if((d=a[c].entity)&&d.getEC("ECRepairable"))d=d.getEC("ECRepairable"),d.canBeToppedUp()&&(f+=d.getPrimaryResourceRepairCost(),e+=d.getSecondaryResourceRepairCost())}return[f,e]},requestNewGameSpace:function(a,b){this.gameSpaceMigrationRequests.push({gameEntity:a,newGameSpace:b})},setSpecialFlag:function(a){"amberCrown"===
a&&!this.amberCrown&&(this.amberCrown=!0,this.refreshHeroEntity())},getAmberCrown:function(){return this.amberCrown},updateMigrationRequests:function(){for(var a=0,b=this.gameSpaceMigrationRequests,c=b.length,d;a<c;a+=1)d=b[a],d.gameEntity&&!d.gameEntity.toBeDestroyed&&d.gameEntity.setGameSpace(d.newGameSpace);b.length=0},getHero:function(){return this.heroEntity},getV3HeroLocation:function(){return this.heroEntity?this.heroEntity.getv3Location():null},getHeroList:function(){return this.heroList},
getNumberOfHeroes:function(){return this.heroList.length},sweep:function(a,b,c,d){var d=this.getCollisionInfo(a,b,void 0,d),f=this.globals.mathDevice;if(d){a=f.v3Sub(b,a);if(0.01>f.v3LengthSq(a)||!c)return d.v3Location;f.v3Normalize(a,a);return f.v3Sub(d.v3Location,f.v3ScalarMul(a,c))}return b},placeOnGround:function(a,b,c){var d=this.globals.mathDevice,d=d.v3AddScalarMul(a,d.v3BuildYAxis(),-10),a=this.sweep(a,d,void 0,c);void 0!==b&&(a[1]+=b);return a},getTraversableLocationListInRadius:function(a,
b){var c=this.getGameSpace(a);return c?c.getTraversableLocationListInRadius(a,b):[]},getOverlappingObjects:function(a,b,c){var d=this.globals.mathDevice,f,e=[],h,i,j;if(a&&d){if(f=this.getGameSpace(d.v3Build(a[0],a[1],a[2])))e.push(f.cubeTree),e.push(f.cubeTreeDynamic);if((d=this.getGameSpace(d.v3Build(a[3],a[4],a[5])))&&d!==f)e.push(d.cubeTree),e.push(d.cubeTreeDynamic);i=e.length;for(h=0;h<i;h+=1)(j=e[h])&&j.getOverlappingNodes(a,b);e=b.length;for(e-=1;0<=e;e-=1)h=b[e],(!h||h.ignoringCollision)&&
b.splice(e,1);f&&f.getOverlappingSpheres(a,c);d&&d!==f&&d.getOverlappingSpheres(a,c)}},hasLOS:function(a,b){var c=a.getv3Location(),d=b.getv3Location(),c=this.getCollisionInfo(c,d);return!c||c.collidedEntity===b},getCollisionInfo:function(a,b,c,d){var f=this.globals.mathDevice,e=f.v3Sub(b,a),h,i,j;i={origin:a,direction:e,maxFactor:1};j=[];var k=this.getGameSpaceList(),l=k.length,m,q;for(m=0;m<l;m+=1)q=k[m],j.push(q.cubeTree),j.push(q.cubeTreeDynamic);m=xa.rayTest(j,i,function(a,b,c,f){return b.ignoringCollision||
d&&b.entity===d?null:{factor:f,externalNode:b}});null!==m&&1>m.factor&&(i=f.v3Add(a,f.v3ScalarMul(e,m.factor)),h=f.v3Copy(e),f.v3Normalize(h,h),h=f.v3Sub(i,f.v3ScalarMul(h,0.01)),j=f.aabbClampv3(m.externalNode.extents,h),h=f.v3Sub(h,j,h),f.v3Normalize(h,h),h={v3Location:i,v3Normal:h,distance:f.v3Length(e)*m.factor,collidedEntity:m.externalNode?m.externalNode.entity:void 0,collidedWorldCube:m.externalNode});if(c)for(m=0;m<l;m+=1)q=k[m],(c=q.getCollisionInfoForSpheres(a,b,void 0!==h?h.distance:void 0))&&
(h=c);return h},applyToEntities:function(a){var b,c,d=this.gameSpaceList;for(c=0;c<d.length;c+=1)b=d[c],b.applyToEntities(a)},applyToEntitiesInGridCellsWithinRadius:function(a,b,c){var d=this.scratchpad,a=d.aabbExtents=this.globals.mathDevice.aabbBuildFromCentreRadius(a,b,d.aabbExtents);this.applyToEntitiesInGridCellsWithinExtents(a,c)},applyToEntitiesInGridCellsWithinExtents:function(a,b){var c=[];this.gameSpaceTree.getOverlappingNodes(a,c);var d=c.length,f;for(f=0;f<d;f+=1)c[f].applyToEntitiesInGridCellsWithinExtents(a,
b)},applyToUpdatingEntitiesInGridCellsWithinExtents:function(a,b){var c=[];this.gameSpaceTree.getOverlappingNodes(a,c);var d=c.length,f;for(f=0;f<d;f+=1)c[f].applyToUpdatingEntitiesInGridCellsWithinExtents(a,b)},applyToHeroEntities:function(a){var b,c=this.heroList,d=c.length;for(b=0;b<d;b+=1)a(c[b])},uniqueifyString:function(a){a=a+"_"+this.uniqueIndex;this.uniqueSuffix&&(a+=this.uniqueSuffix);this.uniqueIndex+=1;return a},uniquifyLevelEntityName:function(a){var b=this.uniqueLevelIndex;this.uniqueLevelIndex+=
1;return a+"_"+b},wishesToJoinMultiplayer:function(){return this.crossedAirLock},destroyNonCamp:function(){var a,b,c=this.gameSpaceList;for(b=0;b<c.length;)a=c[b],a.isAboveGround()?b+=1:(this.removeGameSpace(a),a.destroy())},setUniqueSuffix:function(a){this.uniqueSuffix=a},appendToNames:function(a){this.applyFunctionToGameSpaces(fa.prototype.appendToNames,a);var b,c=this.gameSpaceMap;this.gameSpaceMap={};for(b in c)c.hasOwnProperty(b)&&(this.gameSpaceMap[b+a]=c[b])},teleportHeroAndSpaces:function(){var a=
this.getHero(),b=a.getv3Location(),c=a.getGameSpace(),d=c.getv3Location(),f=this.globals.mathDevice,e,h,i=this.gameSpaceList,j=i.length,k=0,l=0,m=null;for(h=0;h<j;h+=1)e=i[h],e.isAirLockRoom()&&!e.isOriginalSpace()&&(l=f.v3DistanceSq(d,e.getv3Location()),l>k&&(m=e,k=l));m&&(d=f.v3Sub(m.getv3Location(),d),b=f.v3Add(b,d),a.teleport(b,d,m),this.gameCamera.teleport(b,d),this.removeGameSpace(c),c.destroy(),this.setCurrentGameSpace(m),this.destroyOriginalSpaces())},destroyOriginalSpaces:function(){var a=
[],b,c,d=this.gameSpaceList;for(c=0;c<d.length;c+=1)b=d[c],b.isOriginalSpace()&&a.push(b);for(c=0;c<a.length;c+=1)b=a[c],this.removeGameSpace(b),b.destroy()},onJoin:function(a){this.destroyNonCamp();this.setUniqueSuffix("_"+a.toString()+"_");this.isHost=!1},onJoinPostDeserialize:function(){this.teleportHeroAndSpaces();this.needsFullSend=!0},needsToFullSerialize:function(){return this.needsFullSend},serialize:function(a,b){var c=b.gameData={},d=c.gameSpaceData={};this.serializeGameSpaces(a,d);a&&this.triggerWeb.serialize(c);
this.needsFullSend=!1},serializeDelta:function(a,b){var c=b.gameData={},d=c.gameSpaceData={};a&&(c.totalEnemies=this.totalEnemies);c.hostRestarted=this.hostRestarted;c.clientRestarted=this.clientRestarted;this.clientRestarted=this.hostRestarted=!1;this.serializeDeltaGameSpaces(a,d);this.actionManager.serialize(c);a&&this.triggerWeb.serialize(c);return!0},deserialize:function(){},serializeGameSpaces:function(a,b){var c,d,f=b.newGameSpaces={},e=b.deltaGameSpaces={},h=this.gameSpaceList;for(d=0;d<h.length;d+=
1)c=h[d],a||c.isOriginalSpace()?c.serialize(a,f):c.serializeDelta(a,e,!0)},serializeDeltaGameSpaces:function(a,b){var c,d,f;b.deadSpaceList=this.deadSpaceList.slice(0,this.deadSpaceList.length);this.deadSpaceList.length=0;var e=b.newGameSpaces={};if(a){f=this.newSpaceList;for(d=0;d<f.length;d+=1)c=f[d],c.serialize(a,e)}this.newSpaceList.length=0;e=b.deltaGameSpaces={};f=this.gameSpaceList;for(d=0;d<f.length;d+=1)c=f[d],c.getShouldDeltaSerialize()&&c.serializeDelta(a,e)},deserializeGameSpaces:function(a){var b,
c,d,f=a.deadSpaceList,e=a.newGameSpaces,a=a.deltaGameSpaces;if(void 0!==f)for(d=0;d<f.length;d+=1)b=this.gameSpaceMap[f[d]],void 0!==b&&(this.removeGameSpace(b),b.destroy());for(c in e)e.hasOwnProperty(c)&&(b=this.gameSpaceMap[c],void 0===b&&(f=e[c].creationParameters,b=fa.create(c,this.globals,this,f,!0),this.addGameSpace(b)),b.deserialize(e));for(c in a)a.hasOwnProperty(c)&&(b=this.gameSpaceMap[c],void 0!==b&&b.deserialize(a))},addGameSpace:function(a){this.gameSpaceList.push(a);this.newSpaceList.push(a);
this.gameSpaceTree.add(a,a.extents);this.gameSpaceTree.finalize();this.gameSpaceMap[a.name]=a;void 0===this.v3RespawnLocation&&this.setHeroRespawnPosition(a.v3Centre)},addGameSpaceAndActivate:function(a){this.addGameSpace(a);a.activate()},removeGameSpace:function(a){var b=this.gameSpaceList.indexOf(a);0<=b&&this.gameSpaceList.splice(b,1);this.gameSpaceTree.remove(a);this.gameSpaceTree.finalize();this.gameSpaceMap[a.name]=void 0;delete this.gameSpaceMap[a.name];this.deadSpaceList.push(a.name)},getGameSpace:function(a,
b){var c=this.globals.mathDevice,d=this.gameSpaceTree,f=[];d.getSphereOverlappingNodes(a,void 0!==b?b:0,f);f.sort(function(b,d){return c.aabbPointDistanceSq(b.extents,a)-c.aabbPointDistanceSq(d.extents,a)});return f[0]},getScoreInfo:function(){return this.scoreInfo},getAIActionFactory:function(){return this.aiActionFactory},getBlockFactory:function(){return this.blockFactory},getProjectileFactory:function(){return this.projectileFactory},getEntityFactory:function(){return this.entityFactory},getEffectFactory:function(){return this.effectFactory},
getActionManager:function(){return this.actionManager},getFactionManager:function(){return this.factionManager},getBuildingManager:function(){return this.buildingManager},getResourceDispenserManager:function(a){return this.resourceDispenserManagers[a]},getGameSoundManager:function(){return this.gameSoundManager},applyFunctionToGameSpaces:function(){var a=Array.prototype.slice.call(arguments),b=a.shift(),c,d,f=this.gameSpaceList,e=f.length;for(d=0;d<e;d+=1)c=f[d],b.apply(c,a)},updateGameSpaces:function(){this.applyFunctionToGameSpaces(fa.prototype.update)},
drawGameSpaces:function(){this.applyFunctionToGameSpaces(fa.prototype.draw)},drawGameSpacesDebug:function(){this.applyFunctionToGameSpaces(fa.prototype.drawDebug,this.ecDebugDrawFlags)},drawGameSpacesDebugPhysics:function(){this.getCurrentGameSpace()&&this.getCurrentGameSpace().drawDebugPhysics()},clearGameSpaces:function(){var a=this.getHero();a&&a.setToBeDestroyed();for(var b=this.gameSpaceList;0<b.length;)a=b[0],this.removeGameSpace(a),a.destroy();this.setCurrentGameSpace(void 0)},setTriggerRestart:function(a){this.triggerRestart=
a},getTriggerRestart:function(){return this.triggerRestart},getGameSpaceList:function(){return this.gameSpaceList},reset:function(){this.setTriggerRestart(!1);Rg.disable(this.globals);this.heroEntity=void 0;this.heroList=[];this.gameSpaceList=[];this.gameSpaceTree=xa.create(!0);this.gameSpaceMap={};this.newSpaceList=[];this.deadSpaceList=[];this.triggerWeb=Kf.create(this);this.activeSpaceCount=this.activeEntityCount=this.potentialScore=0;this.savingEnabled=this.autoSave;this.skirmishRefCount=this.invasionRefCount=
this.totalEnemies=0;this.gameScoresUI.reset();this.gameController.reset();this.guiManager.reset();this.gameScriptManager&&(this.setScriptLocked(!1),this.gameScriptManager.reset());this.globals.profiling&&this.globals.profilingData.reset();this.speedReset()},setGameState:function(a){var b=this.activeGameState;b&&b.exitState();this.activeGameState=a;a.enterState()},getActiveGameState:function(){return this.activeGameState},detectAndRecoverFromAbsence:function(){if(this.prevAppCurrentTime){var a=this.globals.appCurrentTime-
this.prevAppCurrentTime;3<a&&(this.fpsCounterStartGameTime=this.globals.gameCurrentTime);var b=ea.extraTabbedOutSeconds;10<a&&(void 0!==b&&(a+=b),this.applyToEntities(function(b){b.manageLargeTimeStep(a)}),this.updateGameDayTime(a,!0),this.updateGameDayTimeMusic())}this.prevAppCurrentTime=this.globals.appCurrentTime},updateAutoShadowEnabled:function(){if(this.shouldAutoUpdateShadows){this.startPerfMeasureTime||(this.startPerfMeasureTime=this.globals.appCurrentTime,this.shadowEvaluateCounter=this.perfCounter=
0);var a=this.globals.graphicsDevice;this.globals.appCurrentTime>this.startPerfMeasureTime+2&&(this.perfCounter=30<a.fps?this.perfCounter+1:this.perfCounter-1);30<Math.abs(this.perfCounter)&&(this.gameLighting.setShadowsEnabled(0<this.perfCounter),this.getPlayerData().setShadowsEnabled(0<this.perfCounter),this.shadowEvaluateCounter+=1,this.perfCounter=0,1<this.shadowEvaluateCounter&&(this.shouldAutoUpdateShadows=!1,this.startPerfMeasureTime=0))}},update:function(a){var b=this.gameClock,c=this.globals.appMaxTimeSteps,
d=this.globals;this.detectAndRecoverFromAbsence();if(wa.syncing&&"GamestateSyncing"!==this.activeGameState.name){var f=Wf.create(this,this.globals);this.setGameState(f)}for(;c&&b.tick(this.variableStep,c===this.globals.appMaxTimeSteps);){ma.start("Update - Game");c-=1;d.gameCurrentTime=b.getCurrentTime();d.gameTimeStep=b.getTimeStep();d.physTimeStep=b.getPhysTimeStep();d.gameAppTimeStep=b.getGameAppTimeStep();d.simpleFontRenderer.clearFontList();d.simpleSpriteRenderer.clearSpriteList();d.debugDraw.clearDebugLineList();
this.guiManager.clearDrawList();this.imgui.clearDrawList();this.imgui.clearValidation();d.guiRenderer.clearShakeAmount();this.isHost=a;this.activeGameState.update(a);G.update(1E3*this.globals.gameCurrentTime,1E3*this.globals.appCurrentTime);d.metricsManager.update();f=d.gameCurrentTime-this.lastSaveTime;this.autoSave&&(f>=this.maxTimeBetweenSaves||this.autoSaveRequested&&f>=this.minTimeBetweenSaves)&&this.saveLevel();f=d.gameCurrentTime-this.lastLeaderboardsUpdateTime;(this.heroEntity&&f>=this.MAX_TIME_BETWEEN_LEADERBOARD_UPDATES||
this.shouldUpdateLeaderboards&&f>=this.MIN_TIME_BETWEEN_LEADERBOARD_UPDATES)&&this.updateLeaderboards();f=d.gameCurrentTime-this.lastBadgeUpdateTime;if(f>=this.MAX_TIME_BETWEEN_BADGE_UPDATES||this.shouldUpdateBadges&&f>=this.MIN_TIME_BETWEEN_BADGE_UPDATES)d.gameBadgeManager.updateBadges(),this.lastBadgeUpdateTime=d.gameCurrentTime;ma.stop("Update - Game")}},getIMGui:function(){return this.imgui},initGameDayTime:function(){var a=(new Date).getHours();this.setGameDayTime(a,!0,!0)},updateGameDayTime:function(a,
b){var c=24/(60*this.minutesPerDayCycle),c=this.getGameDayTime()+a*c;this.setGameDayTime(c,b)},setGameDayTime:function(a,b){this.dayNightEnabled&&(this.overrideGameDayTime||(this.gameDayTime=a,24<this.gameDayTime&&(this.gameDayTime-=24)),this.applyDayNightTime(b))},getGameDayTime:function(){return this.gameDayTime},applyDayNightTime:function(a){var b=this.dayNightKeyframes,c=b.length,d,f=b[0],e=b[c-1];for(d=0;d<c;d+=1)if(b[d].hour>=this.gameDayTime){e=b[d];break}else f=b[d];b=this.globals.mathDevice;
b=f===e?1:b.getFactor(f.hour,e.hour,this.gameDayTime);this.gameLighting.setKeyFrames(b,f,e);a&&this.gameLighting.snap()},updateSoundListenerLocation:function(){var a=this.heroEntity;a&&this.gameSoundManager.setListenerWorldLocation(a.getv3Location())},updateGame:function(a){this.hasLoadedLevel&&(this.activeSpaceCount=this.activeEntityCount=0,this.catchRestart(a),this.calculateCurrentSpace(),this.gameController.update(),this.updateSoundListenerLocation(),this.gameSoundManager.update(),this.gameCamera.update(),
this.runScripts&&this.gameScriptManager.update(),this.gameClock.isStopped||(this.updateGameDayTime(this.gameClock.getTimeStep()),this.updateGameDayTimeMusic(),this.actionManager.update(),this.navManager.update(),this.updateGameSpaces(),this.updateAutoShadowEnabled()),this.updateMigrationRequests(),this.triggerWeb.update(),this.guiManager.update(),this.timeSinceSave=0)},updatePerformanceMetrics:function(){if(!(this.globals.gameCurrentTime<this.fpsCounterStartGameTime+3)){var a=this.globals.graphicsDevice.fps;
if(!(0>=a)){a=1E3/a;if(null===this.minMsPerFrameInGame||a<this.minMsPerFrameInGame)this.minMsPerFrameInGame=a;if(null===this.maxMsPerFrameInGame||a>this.maxMsPerFrameInGame)this.maxMsPerFrameInGame=a;this.numberOfFramesInGame+=1;this.cumulativeMsPerFrameInGame+=a}}},catchRestart:function(a){this.getTriggerRestart()&&(this.setTriggerRestart(!1),a?(this.restart(),a=this.createHero("HeroDude",this.getHeroArchetype()),this.setHero(a),this.hostRestarted=!0):this.clientRestarted=!0)},draw2D:function(){var a=
this.globals;this.imgui.draw2D();this.activeGameState.draw2D();G.drawUpdate(1E3*this.globals.gameCurrentTime,1E3*this.globals.appCurrentTime);this.getGuiManager().completeDraw();this.gameController.draw2D();a.simpleFontRenderer.render()},skipCurrentSplashScreen:function(){var a=this.gamestateSplashScreens;a&&a===this.activeGameState&&a.skipCurrentSplashScreen()},startPaused:function(){this.paused=!0;this.gameClock.pause()},exitPaused:function(){this.paused=!1;this.gameClock.resume()},isPaused:function(){return this.paused},
onEnterMenu:function(){var a=this.getGameController();ea.lockMouseInMenus?(a.setMouseLockable(!0),a.lockMouse()):(a.setMouseLockable(!1),a.unlockMouse())},onLeaveMenu:function(){var a=this.getGameController();ea.lockMouseInGame?(a.setMouseLockable(!0),a.lockMouse()):(a.setMouseLockable(!1),a.unlockMouse())},togglePause:function(){var a;a=this.paused?Va.create(this,this.globals):sd.create(this,this.globals);this.setGameState(a)},toggleDebugNav:function(){var a;a="GamestateDebugNav"===this.activeGameState.name?
Va.create(this,this.globals):Sf.create(this,this.globals);this.setGameState(a)},toggleEditor:function(){var a;a="GamestateEditor"===this.activeGameState.name?Va.create(this,this.globals):Tf.create(this,this.globals);this.setGameState(a)},toggleBuildingInfoPanelState:function(){var a;a="GamestateBuildingInfoPanel"===this.activeGameState.name?Va.create(this,this.globals):$d.create(this,this.globals);this.setGameState(a)},forceCampaignEnd:function(a){var b=this.getHero().getGameSpace().getEntitiesWithEC("ECWarManager")[0].getEC("ECWarManager"),
c=b.getActiveCampaignRegionName();c&&(a||this.gameManager.eventManager.notify("hqDeath"),b.forceCampaignEnd(c))},giveXpReward:function(a,b){this.giveReward("a_r_xp500 a_r_xp100 a_r_xp50 a_r_xp20 a_r_xp10 a_r_xp9 a_r_xp8 a_r_xp7 a_r_xp6 a_r_xp5 a_r_xp4 a_r_xp3 a_r_xp2 a_r_xp1".split(" "),"xp",a,b)},giveAmberReward:function(a,b){this.giveReward(["a_r_amber"],"softCurrency",a,b)},giveReward:function(a,b,c,d){b=this.getRewardAmountList(a,b);this.giveRewardQuantityList(a,b,c,d)},getRewardAmountList:function(a,
b){for(var c=this.getEntityFactory(),d=a.length,f=[],e,h=0;h<d;h+=1)e=a[h],e=c.getECArchetype(e,"ECPickup"),e=e[b]||0,f.push(e);return f},giveRewardQuantityList:function(a,b,c,d){for(var f=this.getEntityFactory(),e=a.length,b=this.getRewardQuantityList(b,c),h,i=0;i<e;i+=1){h=b[i];for(var c=a[i],j=0;j<h;j+=1)f.createActiveEntityInstance(c,c,d)}},getRewardQuantityList:function(a,b){for(var c=[],d=0;d<a.length;d+=1){var f=a[d],e=Math.floor(b/f),b=b-e*f;c.push(e)}return c},getTaskManager:function(){return this.taskManager},
getGameController:function(){return this.gameController},getGameCamera:function(){return this.gameCamera},getGameClock:function(){return this.gameClock},getNavManager:function(){return this.navManager},getGuiManager:function(){return this.guiManager},getEventManager:function(){return this.eventManager},addECDebugDrawMask:function(a){var b=this.ecDebugDrawFlags,c;this.activeECMasks[a.uiName]=!0;a.allECs&&(a=b);for(c in a)a.hasOwnProperty(c)&&"uiName"!==c&&(b[c]=!0)},removeECDebugDrawMask:function(a){var b=
this.ecDebugDrawFlags,c;this.activeECMasks[a.uiName]=!1;a.allECs&&(a=b);for(c in a)a.hasOwnProperty(c)&&"uiName"!==c&&(b[c]=!1)},isActiveECDebugDrawMask:function(a){return this.activeECMasks[a.uiName]},disableAttacks:function(){this.pauseAttacks=!0},enableAttacks:function(){this.pauseAttacks=!1},disableCampaignRegion:function(a){var b=this.disabledCampaignRegions;a&&!b[a]&&(b[a]=!0,this.eventManager.notify("CampaignRegionDisabled",a))},enableCampaignRegion:function(a){var b=this.disabledCampaignRegions;
a&&b[a]&&(b[a]=void 0,this.eventManager.notify("CampaignRegionEnabled",a))},isCampaignRegionEnabled:function(a){return a&&!this.disabledCampaignRegions[a]},healGameCriticalEntities:function(){var a=this.getEntitiesWithEC("ECGameCritical"),b,c;for(b=a.length-1;0<=b;b-=1)a[b]&&!a[b].shouldBeDestroyed()&&(c=a[b].getEC("ECHealth"))&&c.resetHealth()},refreshSelectableFlags:function(){var a=this.getEntitiesWithEC("ECSelectable"),b,c,d;for(b=a.length-1;0<=b;b-=1)a[b]&&!a[b].shouldBeDestroyed()&&(d=a[b],
(c=d.getEC("ECSelectable"))&&c.refreshValidity(),(c=d.getEC("ECInteractable"))&&c.refreshValidity())},setPlayFlags:function(a){this.playFlags&&this.playFlags.canHealGameCriticalEntitiesOnExit&&a.healGameCriticalEntities&&this.healGameCriticalEntities();this.playFlags=a;this.refreshSelectableFlags()},getPlayFlags:function(){return this.playFlags},setPlayState:function(a){this.playState=a},getPlayState:function(){return this.playState},getGuiScores:function(){return this.gameScoresUI},isScriptLocked:function(){return this.scriptsLocked},
setScriptLocked:function(a){this.scriptsLocked=a},getShareReward:function(){return 1},validToRewardShare:function(a){a=this.playerData.getTimeShared(a);return!a?!0:86400<this.getTimeInSecondsSince1970()-a},rewardForSharing:function(){var a=this.getGuiManager(),b=this.getHero().getv3Location();this.giveAmberReward(this.getShareReward(),b);a.addGameMessage("sharingfacebook","Thank You for Sharing!","",4,"newsflashThankyou")},facebook:function(){this.globals.graphicsDevice.fullscreen=!1;var a=this,b=
this.globals.metricsManager;window.FB?window.FB.ui({method:"feed",name:"Polycraft",link:"http://www.youtube.com/watch?v=Fwkjs6UpUrE",caption:"I\u2019m playing Polycraft, 3D action tower defence! Watch the trailer here.",description:"You\u2019ve been stranded on a mysterious island - what bad luck! Build a base and survive the island. Take the stand, hero!"},function(c){c&&c.post_id&&(b.sendGameMetric("share_facebook",1),a.validToRewardShare("facebook")&&(a.rewardForSharing(),a.playerData.setShared("facebook")))}):
(b.sendGameMetric("share_facebook",1),a.validToRewardShare("facebook")&&(a.rewardForSharing(),a.playerData.setShared("facebook")),window.open("http://www.facebook.com/sharer.php?u=polycraftgame.com&t=I%27m%20playing%20Polycraft,%203D%20action%20tower%20defence!%20Watch%20the%20trailer:%20http://www.youtube.com/watch?v=Fwkjs6UpUrE"))},twitter:function(){window.open("http://twitter.com/share?text=I%27m%20playing%20Polycraft,%203D%20action%20tower%20defence!%20Watch%20the%20trailer:%20http://www.youtube.com/watch?v=Fwkjs6UpUrE%20%23html5%20%23webgl");
this.validToRewardShare("twitter")&&(this.rewardForSharing(),this.playerData.setShared("twitter"));this.globals.metricsManager.sendGameMetric("share_twitter",1)},wonderstruck:function(){window.open("http://wonderstruckgames.com/")}};Hb.ecDebugDrawMasks={all:{uiName:"All",allECs:!0},debugNav:{uiName:"Pathfinding",ECNav:!0},combat:{uiName:"Combat",ECMelee:!0,ECAgent:!0},warmanager:{uiName:"War Manager and Campaigns",ECAttackSpawner:!0,ECLocationMarker:!0,ECWarManager:!0},editor:{uiName:"Editor",ECLocationMarker:!0}};
Hb.create=function(a){var b=a.globals;void 0===Hb.prototype.globals&&(Hb.prototype.globals=b);var c=new Hb;c.eventManager=wf.create();c.playerData=Hf.create(b);c.uniqueIndex=0;c.uniqueLevelIndex=0;c.gameCamera=rd.create(b,c);c.gameController=la.create(b,c);c.imgui=aa.create(b,c,c.gameController);c.guiManager=xf.create(b,c.gameController);c.gameScoresUI=yf.create(b,c.imgui);c.gameClock=Bf.create(b);c.scoreInfo=Jf.create(b);c.gameLighting=Gb.create(b,c);c.ecDebugDrawFlags={};c.activeECMasks={};c.drawGameTime=
ea.drawPlayDuration;c.drawWarInfo=ea.drawWarInfo;c.profileECs=!1;c.pauseAttacks=!1;c.disabledCampaignRegions={};c.reset();c.aiActionFactory=null;c.projectileFactory=null;c.buildingManager=null;c.actionManager=null;c.factionManager=null;c.resourceDispenserMaanger=null;c.gameSpaceMigrationRequests=[];c.gameSoundManager=M.create(b,c);c.entityFactory=e.create(b,c);c.blockFactory=O.create(b,c);c.effectFactory=Z.create(b,c);c.useSplashScreens=a.useSplashScreens;c.gamestateSplashScreens=Vf.create(c,b);c.useWarScoreGUI=
!0;c.usePrepareForWarScreenBetweenInvasions=!1;c.activeGameState=null;c.v3GridOffset=null;c.minMsPerFrameInGame=null;c.maxMsPerFrameInGame=null;c.numberOfFramesInGame=0;c.cumulativeMsPerFrameInGame=0;c.navManager=null;c.saveLeaderboards=a.saveLeaderboards;c.saveBadges=a.saveBadges;c.saveGameStats=a.saveGameStats;c.outOfGameTimeFactor=a.outOfGameTimeFactor;c.autoLoad=a.autoLoad;c.autoSave=a.autoSave;c.startUpLevelPath=a.startUpLevelPath;c.defaultPlayerSavePath=a.defaultPlayerSavePath;c.versionNumber=
a.versionNumber;c.saveVersionNumber=a.saveVersionNumber;c.versionMessage=a.versionMessage;c.autoSaveRequested=!1;c.lastSaveTime=b.gameCurrentTime;c.hasLoadedLevel=!1;c.hasSavedThisSession=!1;c.minTimeBetweenSaves=4.5;c.maxTimeBetweenSaves=60;c.shouldUpdateLeaderboards=!1;c.shouldUpdateBadges=!1;c.lastLeaderboardsUpdateTime=b.gameCurrentTime;c.lastBadgeUpdateTime=b.gameCurrentTime;c.loadingCount=0;c.savingCount=0;c.timeSinceSave=0;c.speedUpFactor=1;c.runScripts=a.runScripts;c.invasionRefCount=0;c.skirmishRefCount=
0;c.combatRefCount=0;c.numberOfLeaderboardRequests=0;c.variableStep=ea.variableStep;c.gameDayTime=7;c.dayNightKeyframes=Gb.dayNightKeyframes;c.minutesPerDayCycle=ea.minutesPerDayCycle;c.dayNightEnabled=ea.dayNightEnabled;c.clockBasedDayTime=ea.clockBasedDayTime;c.overrideGameDayTime=!1;c.playFlags=ck.normal;c.gameMonitor=Cf.create(b);c.scriptsLocked=!1;c.dateObject=new Date;c.fpsCounterStartGameTime=0;return c};If.prototype={STALE_TIME:5,networkIds:{joining:0,update:1,leaving:2},errorCallback:function(){},
initialise:function(a,b){this.globals=b;this.connecting=this.connected=!1;this.ownerApp=a;this.connectedPlayerIndex=this.playerIndex=void 0;this.others={};this.outgoingMessageLength=0;this.rejectedMultiplayerSessions=[]},destroy:function(){this.others=this.ownerApp=this.globals=null},getUniquePlayerNumber:function(){return this.uniquePlayerNumber},update:function(a,b){this.outgoingMessageLength=0;var c=this.multiplayerSession,d;a.wishesToJoinMultiplayer()&&!this.begunMultiJoin&&this.joinExistingSession();
this.connecting&&this.connectingStateLoop();this.connected&&this.checkOthers();d={frame:this.frameCounter};var f=!1;c&&0<this.validOthersCount&&(a.needsToFullSerialize()?(f=!0,a.serialize(b,d)):needToSend=a.serializeDelta(b,d));f&&(b&&(d.host=!0),Math.floor(this.globals.appCurrentTime/10)>Math.floor((this.globals.appCurrentTime-this.globals.appTimeStep)/10)&&(d.TEST_TRIGGER_STRING="Sent at "+Math.floor(this.globals.appCurrentTime),this.ownerApp.log(d.TEST_TRIGGER_STRING)),d=JSON.stringify(d),this.outgoingMessageLength+=
d.length,c.sendToAll(this.networkIds.update,d))},getOutgoingMessageLength:function(){return this.outgoingMessageLength},onRecieveMessage:function(){},sendMessageFn:function(){},exitSession:function(){var a=this.multiplayerSession;a&&(a.sendToAll(this.networkIds.leaving),a.destroy());this.begunMultiJoin=this.connecting=this.connected=!1},setMaxPlayers:function(a){this.maxPlayers=a},rejectMultiplayerSession:function(a){this.rejectedMultiplayerSessions.push(a)},hasRejectedThisSession:function(a){var b,
c=this.rejectedMultiplayerSessions,d=c.length;for(b=0;b<d;b+=1)if(c[b].sessionID===a.sessionID)return!0;return!1},purgeRejectedSessions:function(){var a,b=this.rejectedMultiplayerSessions,c=b.length;for(a=0;a<c;a+=1)b[a].destroy();b.length=0},acceptMultiplayerSession:function(a,b){var c=a.sessionId,d=function(){this.errorCallback("Connection lost!")}.bind(this);1===b?(this.globals.isHost=!0,this.connectedPlayerIndex=a.playerId,this.ownerApp.log("Created Session - I am the host. sessionId = "+c)):
(this.globals.isHost=!1,this.ownerApp.log("Joined existing Session - I will become a client. sessionId = "+c));this.playerIndex=a.playerId;this.multiplayerSession=a;a.onmessage=this.onMessage.bind(this);a.onclose=d;a.sendToAll(this.networkIds.joining);this.connectionTime=TurbulenzEngine.time;this.purgeRejectedSessions()},createEmptySession:function(a){var b=this.globals;this.exitSession();var c=function(b,c){1<c?(this.hasRejectedThisSession(b)||(this.uniquePlayerNumber+=c-1),this.rejectMultiplayerSession(b),
this.createEmptySession(a)):(this.acceptMultiplayerSession(b,c),a())}.bind(this),d=function(){this.multiplayerSession=null;this.globals.isHost=!0;a()}.bind(this);wa.createMultiplayerSession(this.maxPlayers,b.requestHandler,c,d);this.connected=!1;this.connecting=!0},joinExistingSession:function(){this.exitSession();this.requestLocalMultiplayerSessions();this.connected=!1;this.begunMultiJoin=this.connecting=!0},joinExistingSessionById:function(a){var b=this.globals;this.ownerApp.log("Joining session: id = "+
a);wa.joinMultiplayerSession(a,b.requestHandler,this.acceptMultiplayerSession.bind(this),this.onCreateMultiplayerSessionError.bind(this))},onCreateMultiplayerSessionError:function(){this.multiplayerSession=null;this.globals.isHost=!0},onJoinExistingSessionError:function(){this.multiplayerSession=null;this.globals.isHost=!0},requestLocalMultiplayerSessions:function(){this.ownerApp.log("Requesting local multiplayer sessions");var a={url:"/api/v1/multiplayer/session/list/crashmob",method:"POST",callback:this.onLocalMpSessionsReceived.bind(this)};
La.ajax(a)},onLocalMpSessionsReceived:function(a,b){var c;200!==b&&(this.ownerApp.log("Local mp sessions not received, trying hub.."),this.requestHubMultiplayerSessions());c=a.data;c.length?(this.ownerApp.log("Local mp sessions received, joining first session..."),c=c[0],c=c._id,this.joinExistingSessionById(c)):this.ownerApp.log("Local mp sessions received but no existing sessions. Starting single player...")},requestHubMultiplayerSessions:function(){this.ownerApp.log("Requesting hub multiplayer sessions");
var a={url:"/api/v1/multiplayer/session/list/adventure/1.0",method:"POST",callback:this.onHubMpSessionsReceived.bind(this)};La.ajax(a)},onHubMpSessionsReceived:function(a,b){var c;200!==b&&this.ownerApp.log("Hub mp sessions not received, starting singleplayer");c=a.data;c.length?(this.ownerApp.log("Hub mp sessions received, joining first session..."),c=c[0],c=c._id,this.joinExistingSessionById(c)):this.ownerApp.log("Hub mp sessions received but no existing sessions. Starting single player...")},connectingStateLoop:function(){void 0!==
this.connectedPlayerIndex?(this.ownerApp.log("Joined Game."),this.connected=!0,this.connecting=!1):this.multiplayerSession&&TurbulenzEngine.time>this.connectionTime+0.5*this.STALE_TIME&&this.multiplayerSession.sendToAll(this.networkIds.joining)},onMessage:function(a,b,c){var d=this.networkIds;switch(b){case d.joining:this.onJoiningMessage(a);break;case d.update:this.onUpdateMessage(a,c);break;case d.leaving:this.onLeavingMessage(a)}},onJoiningMessage:function(a){var b=this.multiplayerSession,c=b.playerId,
d=this.networkIds,f=this.others,e=this.globals.gameManager,h,i,j=TurbulenzEngine.time,k=[];if(void 0===f[a]&&this.globals.isHost){h={};h[c]=this.connectedPlayerIndex;this.ownerApp.log(a+" Joined.");f[a]={connectedPlayerIndex:a,heartbeat:j};h[a]=a;for(i in f)f.hasOwnProperty(i)&&(h[i]=f[i].connectedPlayerIndex,i!==a&&k.push(i));c={frame:this.frameCounter,others:h,host:!0};0<k.length&&(f=JSON.stringify(c),this.outgoingMessageLength+=f.length,b.sendToGroup(k,d.update,f));e.serialize(this.globals.isHost,
c);f=JSON.stringify(c);this.outgoingMessageLength+=f.length;b.sendTo(a,d.update,f)}},onUpdateMessage:function(a,b){var c=this.multiplayerSession,d=c.playerId,f=this.networkIds,e=this.others,h=e[a],i=this.ownerApp.protoGame,j,k,l,m=!1,q=TurbulenzEngine.time;void 0!==h&&(h.heartbeat=q);if(b&&(j=JSON.parse(b))){j.TEST_TRIGGER_STRING&&this.ownerApp.log("Received "+j.TEST_TRIGGER_STRING);k=j.others;if(void 0!==k){for(var p in k)if(k.hasOwnProperty(p))if(l=k[p],p===d)void 0===this.connectedPlayerIndex&&
(this.frameCounter=j.frame),this.connectedPlayerIndex=l,m=!0;else{var s=e[p];void 0===s&&(e[p]=s={},this.ownerApp.log(l+" Joined."));s.connectedPlayerIndex=l;s.heartbeat=q}void 0===h&&(h=e[a])}if(j.host){if(this.globals.isHost){d>a&&(this.globals.isHost=!1,this.connectedPlayerIndex=void 0,c.sendTo(a,f.leaving),c.sendTo(a,f.joining));return}void 0!==h&&(h.host||this.ownerApp.log(h.connectedPlayerIndex+" Is Host."),h.host=!0);this.hostFrameCounter=j.frame}if(m)i.onJoin(this.connectedPlayerIndex);i.deserialize(this.globals.isHost,
j);if(m)i.onJoinPostDeserialize()}},onLeavingMessage:function(a){var b=this.others,c=b[a];void 0!==c&&(this.ownerApp.log(c.connectedPlayerIndex+" Left."),this.globals.isHost?delete b[a]:c.host&&(c.host=!1,c.heartbeat=0))},migrateHost:function(){var a=this.multiplayerSession.playerId,b=this.others,c;for(c in b)if(b.hasOwnProperty(c)&&c<a)return;this.ownerApp.log("I am now the host.");this.globals.isHost=!0},checkOthers:function(){var a=TurbulenzEngine.time-this.STALE_TIME,b=this.others,c=!this.globals.isHost,
d,f;this.validOthersCount=0;for(f in b)b.hasOwnProperty(f)&&(this.validOthersCount+=1,d=b[f],d.heartbeat<a?(this.ownerApp.log(d.connectedPlayerIndex+" was lost"),delete b[f],this.validOthersCount-=1):d.host&&(c=!1));c&&this.migrateHost()}};If.create=function(a,b){var c=new If;c.initialise(a,b);c.uniquePlayerNumber=0;return c};Jf.prototype={getCampaignScoreInfo:function(){return{resourceBonusList:this.campaignResourceBonusList,maxResourceBonusList:this.campaignMaxResourceBonusList,xpBonus:this.campaignXpBonus,
maxXpBonus:this.campaignMaxXpBonus,starStatusList:this.campaignStarStatusList,grade:this.campaignGrade,wasVictory:this.campaignVictory}},onCampaignStarted:function(a){this.campaignActive=!0;this.campaignMaxResourceBonusList=a.maxResourceBonusList;this.campaignResourceBonusList=[];this.campaignMaxXpBonus=a.maxXpBonus;this.campaignXpBonus=0;this.campaignStarCriteriaList=a.starCriteriaList;this.campaignStats={hqHealthFactor:0,numberOfEnemiesKilled:0,numberOfEnemiesKilledByHero:0,numberOfHeroDeaths:0,
numberOfHQsDestroyed:0,resourceCollected:[0,0],resourceLost:[0,0]};this.campaignGrade=0;this.campaignStarStatusList=[];this.campaignVictory=!1;a=this.globals.gameManager.eventManager;a.subscribe("EnemyKilled",this.onCampaignEnemyDeathBound);a.subscribe("ResourceDeposited",this.onResourceDepositedBound);a.subscribe("ResourceLost",this.onResourceLostBound)},onCampaignEnded:function(){if(this.campaignActive){this.campaignActive=!1;var a=this.globals.gameManager.eventManager;a.unsubscribe("EnemyKilled",
this.onCampaignEnemyDeathBound);a.unsubscribe("ResourceDeposited",this.onResourceDepositedBound);a.unsubscribe("ResourceLost",this.onResourceLostBound);var b=this.campaignStarCriteriaList,c=this.starStatusEvaluationMap,d=this.starDisplayTextMap,a=this.campaignStats;a.hqHealthFactor=this.getHQHealthFactor();this.campaignStarStatusList=b=this.calculateCampaignStarStatus(b,c,d,a);(this.campaignVictory=a=0===a.numberOfHQsDestroyed)?(this.campaignGrade=a=this.getGradeFromStarStatusList(b),b=b.length,this.campaignResourceBonusList=
this.getResourceRewardsFromGrade(a,b,this.campaignMaxResourceBonusList),this.campaignXpBonus=this.getXpRewardFromGrade(a,b,this.campaignMaxXpBonus)):(this.campaignGrade=0,this.campaignResourceBonusList=[0,0],this.campaignXpBonus=0)}},getHQHealthFactor:function(){var a=this.globals.gameManager,b=a.getHero();if(b&&(b=b.getEC("ECFaction")))if(b=b.getFactionName(),a=a.getFactionManager().getFactionByName(b))if(a=a.getHQ())if(a=a.getEC("ECHealth"))return a.getHealthFactor();return 0},getGradeFromStarStatusList:function(a){var b=
a.length,c=0,d;for(d=0;d<b;d+=1)a[d].achieved&&(c+=1);return c},getResourceRewardsFromGrade:function(a,b,c){var d=a/b;return c.map(function(a){return Math.floor(a*d)})},getXpRewardFromGrade:function(a,b,c){return Math.floor(c*(a/b))},calculateCampaignStarStatus:function(a,b,c,d){var f=[],e=a.length,h;for(h=0;h<e;h+=1){var i=a[h],j=i.name,k=b[j](d,i),i=c[j](i);f.push({starName:j,displayText:i,achieved:k.achieved,value:k.value})}return f},onCampaignEnemyDeath:function(a){var b=a.v3Location,c=a.aggressor;
if(a=a.victim.getEC("ECAgent")){a=a.getXP();void 0===a&&(a=0);var d=this.campaignStats;d.numberOfEnemiesKilled+=1;c.getEC("ECHero")&&(d.numberOfEnemiesKilledByHero+=1);this.globals.gameManager.giveXpReward(a,b)}},onBuildingDestroyed:function(){},onWallDestroyed:function(){},onHQDestroyed:function(){this.campaignActive&&(this.campaignStats.numberOfHQsDestroyed+=1)},onHeroDeath:function(){this.campaignActive&&(this.campaignStats.numberOfHeroDeaths+=1)},onResourceDeposited:function(a){if(a){var b=a.type,
a=a.amount;if(this.campaignActive&&(b===E.LUMBER||b===E.STONE)&&void 0!==a)this.campaignStats.resourceCollected[b]+=a}},onResourceLost:function(a){if(a){var b=a.type,a=a.amount;if(this.campaignActive&&(b===E.LUMBER||b===E.STONE)&&void 0!==a)this.campaignStats.resourceLost[b]+=a}},getResourceLost:function(){var a=this.campaignStats;return a&&a.resourceLost?a.resourceLost:[0,0]},getTotalResourceCollected:function(){var a=this.campaignStats;return a&&a.resourceCollected?a.resourceCollected:[0,0]},starDisplayTextMap:{hqHealthFactor:function(a){return"Hq Health "+
(Math.round(100*a.minHealthFactorForSuccess).toString()+"%")},fewerThanNHeroDeaths:function(a){return"Fewer Than "+(a.maxNumberOfDeathsAllowedForSuccess+1).toString()+" Hero Deaths"},killNEnemies:function(a){return"Kill "+a.minNumberOfFeralsKilledForSuccess.toString()+" Ferals"},killNEnemiesWithHero:function(a){return"Kill "+a.minNumberOfFeralsKilledByHeroForSuccess.toString()+" Ferals With Hero"}},starStatusEvaluationMap:{hqHealthFactor:function(a,b){var c=a.hqHealthFactor>=b.minHealthFactorForSuccess,
d=Math.round(100*a.hqHealthFactor).toString()+"%";return{achieved:c,value:d}},fewerThanNHeroDeaths:function(a,b){return{achieved:a.numberOfHeroDeaths<=b.maxNumberOfDeathsAllowedForSuccess,value:a.numberOfHeroDeaths.toString()}},killNEnemies:function(a,b){return{achieved:a.numberOfEnemiesKilled>=b.minNumberOfFeralsKilledForSuccess,value:a.numberOfEnemiesKilled.toString()}},killNEnemiesWithHero:function(a,b){return{achieved:a.numberOfEnemiesKilledByHero>=b.minNumberOfFeralsKilledByHeroForSuccess,value:a.numberOfEnemiesKilledByHero.toString()}}}};
Jf.create=function(a){var b=new Jf;b.globals=a;b.campaignActive=!1;b.campaignResourceBonusList=[];b.campaignMaxResourceBonusList=[];b.campaignXpBonus=0;b.campaignMaxXpBonus=0;b.campaignStats={hqHealthFactor:0,numberOfEnemiesKilled:0,numberOfEnemiesKilledByHero:0,numberOfHeroDeaths:0,numberOfHQsDestroyed:0,resourceCollected:[0,0],resourceLost:[0,0]};b.campaignStarStatusList=[];b.campaignStarCriteriaList=[];b.campaignGrade=0;b.campaignVictory=!1;b.onCampaignEnemyDeathBound=b.onCampaignEnemyDeath.bind(b);
b.onResourceDepositedBound=b.onResourceDeposited.bind(b);b.onResourceLostBound=b.onResourceLost.bind(b);return b};Kf.prototype={triggerRefs:void 0,update:function(){var a=this.triggerRefs,b,c;for(b in a)a.hasOwnProperty(b)&&(c=a[b],0!==c.change&&(0===c.current&&0<c.change&&this.processDown(c.triggerNetworkID,c.outputNetworkID),c.current+=c.change,c.change=0,0===c.current&&(this.processUp(c.triggerNetworkID,c.outputNetworkID),delete a[b])))},clear:function(a){if((a=this.triggerRefs[a])&&!a.cleared)a.cleared=
!0,a.change=-a.current},addRef:function(a,b){void 0===this.triggerRefs[a]&&(this.triggerRefs[a]={current:0,change:0,triggerNetworkID:a,outputNetworkID:b});this.triggerRefs[a].change+=1},removeRef:function(a){this.triggerRefs[a].change-=1},playSwitchIfNeeded:function(){var a;this.playedSwitch||(this.playedSwitch=!0,a=this.gameManager.getHero(),a.playSound("switch"))},playRumbleIfNeeded:function(){var a;this.playedRock||(this.playedRock=!0,a=this.gameManager.getHero(),a.playSound("stoneDoor"))},clearSoundFlags:function(){this.playedSpawn=
this.playedRock=this.playedSwitch=!1},processDown:function(a,b){this.clearSoundFlags();this.sendOn(a,b)},processUp:function(a,b){this.clearSoundFlags();this.sendOff(a,b)},sendOn:function(a,b){var c=hc.prototype.triggerStates.UNCHANGED,d=function(d){var d=d.getEC("ECTrigger"),e,h;if(d){if((e=d.hasTriggerNetworkID(a))||d.hasOutputNetworkIDFromArray(b))h=d.showOn();e&&(c=h)}}.bind(this);this.gameManager.applyToEntities(d);this.sendMessageToEntities(c,b)},sendOff:function(a,b){var c=hc.prototype.triggerStates.UNCHANGED,
d=function(d){var d=d.getEC("ECTrigger"),e,h;if(d){if((e=d.hasTriggerNetworkID(a))||d.hasOutputNetworkIDFromArray(b))h=d.showOff();e&&(c=h)}}.bind(this);this.gameManager.applyToEntities(d);this.sendMessageToEntities(c,b)},sendMessageToEntities:function(a,b){switch(a){case hc.prototype.triggerStates.ON:this.sendOnEntities(b);break;case hc.prototype.triggerStates.OFF:this.sendOffEntities(b);break;case hc.prototype.triggerStates.TOGGLE:this.sendToggleEntities(b)}},sendOffEntity:function(a,b){var c=a.getEC("ECTrap"),
d=a.getEC("ECSpawner"),e=a.getEC("ECLight"),g=a.getEC("ECTrigger");c&&c.hasOutputNetworkID(b)&&(c.triggerOff(),this.playRumbleIfNeeded());d&&d.hasOutputNetworkID(b)&&d.triggerOff(b);e&&e.hasOutputNetworkID(b)&&e.triggerOn(!1);g&&g.hasInputNetworkID(b)&&g.offGateRef(b)},sendOnEntity:function(a,b){var c=a.getEC("ECTrap"),d=a.getEC("ECSpawner"),e=a.getEC("ECLight"),g=a.getEC("ECTrigger");c&&c.hasOutputNetworkID(b)&&(c.triggerOn(),this.playRumbleIfNeeded());d&&d.hasOutputNetworkID(b)&&d.triggerOn(b);
e&&e.hasOutputNetworkID(b)&&e.triggerOn(!0);if(g&&g.hasInputNetworkID(b))g.onGateRef(b)},sendToggleEntity:function(a,b){var c=a.getEC("ECTrap"),d=a.getEC("ECSpawner"),e=a.getEC("ECLight"),g=a.getEC("ECTrigger");c&&c.hasOutputNetworkID(b)&&(c.triggerToggle(),this.playRumbleIfNeeded());d&&d.hasOutputNetworkID(b)&&d.toggle(b);e&&e.hasOutputNetworkID(b)&&e.toggle();g&&g.hasInputNetworkID(b)&&g.toggleGateRef(b)},sendOnEntities:function(a){for(var b=0,c=function(c){this.sendOnEntity(c,a[b])}.bind(this),
b=0;b<a.length;b+=1)this.gameManager.applyToEntities(c)},sendOffEntities:function(a){for(var b=0,c=function(c){this.sendOffEntity(c,a[b])}.bind(this),b=0;b<a.length;b+=1)this.gameManager.applyToEntities(c)},sendToggleEntities:function(a){for(var b=0,c=function(c){this.sendToggleEntity(c,a[b])}.bind(this),b=0;b<a.length;b+=1)this.gameManager.applyToEntities(c)},serialize:function(a){var b=a.twData={},c=this.triggerRefs,d,e,a=this.liveTriggers,g,h=b.refData={};for(d in c)c.hasOwnProperty(d)&&(e=c[d],
h[d]={current:e.current,change:e.change,triggerNetworkID:e.triggerNetworkID,outputNetworkID:e.outputNetworkID,toBeDestroyed:e.toBeDestroyed});d=b.liveData={};for(g in a)a.hasOwnProperty(g)&&(d[g]=a[g])},deserialize:function(a){var b=a.twData;if(b){var c=this.triggerRefs,d,e,g,a=this.liveTriggers,h,i=b.refData;for(d in i)i.hasOwnProperty(d)&&(e=i[d],void 0===c[d]&&(c[d]={}),g=c[d],g.current=e.current,g.change=e.change,g.triggerNetworkID=e.triggerNetworkID,g.outputNetworkID=e.outputNetworkID,g.toBeDestroyed=
e.toBeDestroyed);d=b.liveData;for(h in d)d.hasOwnProperty(h)&&(a[h]=d[h])}},destroy:function(){this.liveTriggers=this.triggerRefs=void 0}};Kf.create=function(a){var b=new Kf;b.gameManager=a;b.triggerRefs={};b.liveTriggers={};return b};var Ti;if(!(Ti=G)){var Kc=[],Qd=[];Ti={REVISION:"6",getAll:function(){return Kc},removeAll:function(){Kc=[]},add:function(a){Kc.push(a)},remove:function(a){a=Kc.indexOf(a);-1!==a&&Kc.splice(a,1)},update:function(a,b){for(var c=0,d=Kc.length,e=void 0!==a?a:1E3*G.globals.gameCurrentTime,
g=void 0!==b?b:1E3*G.globals.appCurrentTime;c<d;)Kc[c].update(e,g)?c+=1:(Kc.splice(c,1),d-=1)},adddraw:function(a){Qd.push(a)},removedraw:function(a){a=Qd.indexOf(a);-1!==a&&Qd.splice(a,1)},drawUpdate:function(a,b){for(var c=0,d=Qd.length,e=void 0!==a?a:1E3*G.globals.gameCurrentTime,g=void 0!==b?b:1E3*G.globals.appCurrentTime;c<d;)Qd[c].update(e,g)?c+=1:(Qd.splice(c,1),d-=1)}}}var G=Ti;G.setGlobals=function(a){this.globals=a};G.Create=function(a){return new G.Tween(a)};G.Tween=function(a){var b={},
c={},d=1E3,e=0,g=null,h=!1,i=G.Easing.Linear.None,j=G.Interpolation.Linear,k=null,l=null,m=null,q=null,p=!1;this.to=function(a,b){null!==b&&(d=1E3*b);c=a;return this};this.setAppTimeBased=function(){h=!0;return this};this.drawUpdate=function(){p=!0;return this};this.start=function(d){p?G.adddraw(this):G.add(this);g=void 0!==d?d:1E3*G.globals.gameCurrentTime;h&&(g=1E3*G.globals.appCurrentTime);g+=e;for(var i in c)if(null!==a[i]){if(c[i]instanceof Array){if(0===c[i].length)continue;c[i]=[a[i]].concat(c[i])}b[i]=
a[i]}return this};this.complete=function(){null!==m&&m.call(a);this.stop()};this.stop=function(){p?G.removedraw(this):G.remove(this);return this};this.delay=function(a){e=1E3*a;return this};this.easing=function(a){i=a;return this};this.interpolation=function(a){j=a;return this};this.chain=function(a){k=a;return this};this.onFirstUpdate=function(a){q=a;return this};this.onUpdate=function(a){l=a;return this};this.onComplete=function(a){m=a;return this};this.hasStarted=function(a,b){var c=!1,d;d=h?b:
a;void 0===d&&(d=1E3*(h?G.globals.appCurrentTime:G.globals.gameCurrentTime));d>g&&(d=G.getAll())&&0<=d.indexOf(this)&&(c=!0);return c};this.update=function(e,f){var p=h?f:e;if(p<g)return!0;var p=(p-g)/d,p=1<p?1:p,t=i(p),w;for(w in b){var y=b[w],v=c[w];a[w]=v instanceof Array?j(v,t):y+(v-y)*t}null!==q&&(q.call(a,t),q=null);null!==l&&l.call(a,t);return 1===p?(null!==m&&m.call(a),null!==k&&k.start(),!1):!0}};G.Easing={Linear:{None:function(a){return a}},Quadratic:{In:function(a){return a*a},Out:function(a){return a*
(2-a)},InOut:function(a){return 1>(a*=2)?0.5*a*a:-0.5*(--a*(a-2)-1)}},Cubic:{In:function(a){return a*a*a},Out:function(a){return--a*a*a+1},InOut:function(a){return 1>(a*=2)?0.5*a*a*a:0.5*((a-=2)*a*a+2)}},Quartic:{In:function(a){return a*a*a*a},Out:function(a){return 1- --a*a*a*a},InOut:function(a){return 1>(a*=2)?0.5*a*a*a*a:-0.5*((a-=2)*a*a*a-2)}},Quintic:{In:function(a){return a*a*a*a*a},Out:function(a){return--a*a*a*a*a+1},InOut:function(a){return 1>(a*=2)?0.5*a*a*a*a*a:0.5*((a-=2)*a*a*a*a+2)}},
Sinusoidal:{In:function(a){return 1-Math.cos(a*Math.PI/2)},Out:function(a){return Math.sin(a*Math.PI/2)},InOut:function(a){return 0.5*(1-Math.cos(Math.PI*a))}},Exponential:{In:function(a){return 0===a?0:Math.pow(1024,a-1)},Out:function(a){return 1===a?1:1-Math.pow(2,-10*a)},InOut:function(a){return 0===a?0:1===a?1:1>(a*=2)?0.5*Math.pow(1024,a-1):0.5*(-Math.pow(2,-10*(a-1))+2)}},Circular:{In:function(a){return 1-Math.sqrt(1-a*a)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return 1>
(a*=2)?-0.5*(Math.sqrt(1-a*a)-1):0.5*(Math.sqrt(1-(a-=2)*a)+1)}},Elastic:{In:function(a){var b,c=0.1;if(0===a)return 0;if(1===a)return 1;!c||1>c?(c=1,b=0.1):b=0.4*Math.asin(1/c)/(2*Math.PI);return-(c*Math.pow(2,10*(a-=1))*Math.sin((a-b)*2*Math.PI/0.4))},Out:function(a){var b,c=0.1;if(0===a)return 0;if(1===a)return 1;!c||1>c?(c=1,b=0.1):b=0.4*Math.asin(1/c)/(2*Math.PI);return c*Math.pow(2,-10*a)*Math.sin((a-b)*2*Math.PI/0.4)+1},InOut:function(a){var b,c=0.1;if(0===a)return 0;if(1===a)return 1;!c||
1>c?(c=1,b=0.1):b=0.4*Math.asin(1/c)/(2*Math.PI);return 1>(a*=2)?-0.5*c*Math.pow(2,10*(a-=1))*Math.sin((a-b)*2*Math.PI/0.4):0.5*c*Math.pow(2,-10*(a-=1))*Math.sin((a-b)*2*Math.PI/0.4)+1}},Back:{In:function(a){return a*a*(2.70158*a-1.70158)},Out:function(a){return--a*a*(2.70158*a+1.70158)+1},InOut:function(a){return 1>(a*=2)?0.5*a*a*(3.5949095*a-2.5949095):0.5*((a-=2)*a*(3.5949095*a+2.5949095)+2)}},Bounce:{In:function(a){return 1-G.Easing.Bounce.Out(1-a)},Out:function(a){return a<1/2.75?7.5625*a*a:
a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},InOut:function(a){return 0.5>a?0.5*G.Easing.Bounce.In(2*a):0.5*G.Easing.Bounce.Out(2*a-1)+0.5}}};var Ui=[1];G.Interpolation={Linear:function(a,b){var c=a.length-1,d=c*b,e=Math.floor(d),g=G.Interpolation.Utils.Linear;return 0>b?g(a[0],a[1],d):1<b?g(a[c],a[c-1],c-d):g(a[e],a[e+1>c?c:e+1],d-e)},Bezier:function(a,b){var c=0,d=a.length-1,e=Math.pow,g=G.Interpolation.Utils.Bernstein,h;for(h=
0;h<=d;h++)c+=e(1-b,d-h)*e(b,h)*a[h]*g(d,h);return c},CatmullRom:function(a,b){var c=a.length-1,d=c*b,e=Math.floor(d),g=G.Interpolation.Utils.CatmullRom;return a[0]===a[c]?(0>b&&(e=Math.floor(d=c*(1+b))),g(a[(e-1+c)%c],a[e],a[(e+1)%c],a[(e+2)%c],d-e)):0>b?a[0]-(g(a[0],a[0],a[1],a[1],-d)-a[0]):1<b?a[c]-(g(a[c],a[c],a[c-1],a[c-1],d-c)-a[c]):g(a[e?e-1:0],a[e],a[c<e+1?c:e+1],a[c<e+2?c:e+2],d-e)},Utils:{Linear:function(a,b,c){return(b-a)*c+a},Bernstein:function(a,b){var c=G.Interpolation.Utils.Factorial;
return c(a)/c(b)/c(a-b)},Factorial:function(a){var b=1,c;if(Ui[a])return Ui[a];for(c=a;1<c;c--)b*=c;return Ui[a]=b},CatmullRom:function(a,b,c,d,e){var a=0.5*(c-a),d=0.5*(d-b),g=e*e;return(2*b-2*c+a+d)*e*g+(-3*b+3*c-2*a-d)*g+a*e+b}}};xb.prototype.clone=function(a){var a=xb.create(a),b,c;c=this.textureInstances;for(b in c)c.hasOwnProperty(b)&&a.setTextureInstance(b,c[b]);var d=this.techniqueParameters;for(b in d)d.hasOwnProperty(b)&&(c=d[b],"object"===typeof c&&"slice"in c&&(c=c.slice()),a.techniqueParameters[b]=
c);c=this.meta;for(b in c)c.hasOwnProperty(b)&&(a.meta[b]=c[b]);a.effect=this.effect;return a};Sa.prototype.forAll=function(a){a(this);if(this.children)for(var b=0;b<this.children.length;b+=1)this.children[b].forAll(a)};W.prototype.renameRootNode=function(a,b){La.assert(b,"Root nodes must be named");La.assert(a.scene,"Root node not already in a scene");La.assert(!this.rootNodesMap[b],"Root node with the same new name exits in the scene");delete this.rootNodesMap[a.name];a.name=b;this.rootNodesMap[b]=
a};Lf.prototype={___toggleDebugDrawFlag:function(a){this.globals.debugDrawFlags[a]=!this.globals.debugDrawFlags[a];return"Debug Draw Flag "+(this.globals.debugDrawFlags[a]?"on.":"off.")},___god:function(){this.globals.cheats.godMode=!this.globals.cheats.godMode;return"God Mode "+(this.globals.cheats.godMode?"on.":"off.")},___invisible:function(){this.globals.cheats.invisibleMode=!this.globals.cheats.invisibleMode;return"Invisible Mode "+(this.globals.cheats.invisibleMode?"on.":"off.")},___setSpeedPlayer:function(a){Md.prototype.playerSpeedFactor=
a;return"Player Speed Factor set to "+a+"."},___setSpeedEnemy:function(a){Md.prototype.enemySpeedFactor=a;return"Enemy Speed Factor set to "+a+"."},___setDamageCombat:function(a){hd.prototype.attackDamage=a;return"Combat Damage set to "+a+"."},___setDamageFalling:function(a){hd.prototype.fallingDamage=a;return"Falling Damage set to "+a+"."},___setDamageShooting:function(a){hd.prototype.shootingDamage=a;return"Shooting Damage set to "+a+"."},___kill:function(){this.globals.cheats.kill=!0;return"Murderer!"},
___resetCurrentGameSpace:function(){this.globals.gameManager.heroEntity.currentGameSpace.resetSpawnersAndTriggers();return"Reset current gamespace's spawns and triggers."},___restart:function(){this.globals.gameManager.triggerRestart=!0;return"Restarting game!"}};Lf.create=function(a){var b=new Lf;b.globals=a;return b};var dk=0;Mf.prototype={_newId:function(){return dk+=1},_addUI:function(a,b,c,d,e,g){var h=this._newId();oa.emit("dynamicui.add-item",JSON.stringify({id:h,type:a,title:b,groupId:e||
null,options:g||{}}));this._setters[h]=d;this._getters[h]=c;return h},_watchStashedObject:function(a){var a=JSON.parse(a),b=a.id;this.watchVariable(a.title||b,this._objects[b],a.property,a.ui,a.groupId||this._watchGroup,a.options||{})},addSlider:function(a,b,c,d,e){return this._addUI("slider",a,b,c,d,e)},addCheckbox:function(a,b,c,d,e){return this._addUI("checkbox",a,b,c,d,e)},addSelect:function(a,b,c,d,e){return this._addUI("select",a,b,c,d,e)},addButton:function(a,b,c,d,e){return this._addUI("button",
a,b,c,d,e)},addTextBox:function(a,b,c,d,e){return this._addUI("text",a,b,c,d,e)},addWatch:function(a,b,c,d,e){return this._addUI("watch",a,b,c,d,e)},addRadioButton:function(a,b,c,d,e){return this._addUI("radio",a,b,c,d,e)},destroy:function(a){oa.emit("dynamicui.destroy",JSON.stringify({id:a}))},pushValue:function(a,b){oa.emit("dynamicui.pushvalue",JSON.stringify({id:a,value:b}))},addGroup:function(a,b){var c=this._newId();oa.emit("dynamicui.group-create",JSON.stringify({id:c,title:a,groupId:b||null}));
return c},addToGroup:function(a,b){oa.emit("dynamicui.group-add",JSON.stringify({id:a,groupId:b}))},removeFromGroup:function(a,b){oa.emit("dynamicui.group-remove",JSON.stringify({id:a,groupId:b}))},watchVariable:function(a,b,c,d,e,g){var e=e||null,h=-1,i=function(){return c?b[c]:b},j=function(a){b[c]=a};g&&(g.getValue&&(i=g.getValue),g.setValue&&(j=g.setValue));switch(d||"watch"){case "slider":h=this.addSlider(a,i,j,e,g);break;case "checkbox":h=this.addCheckbox(a,i,j,e,g);break;case "radio":h=this.addRadioButton(a,
i,j,e,g);break;case "select":h=this.addSelect(a,i,j,e,g);break;case "button":h=this.addButton(a,i,j,e,g);break;case "text":h=this.addTextBox(a,i,j,e,g);break;case "watch":h=this.addWatch(a,i,j,e,g)}return h},showObject:function(a,b,c,d){var a=this.addGroup(a,d),e;for(e in b)b.hasOwnProperty(e)&&(d=b[e],"object"===typeof d?this.showObject(e,d,c,a):this.watchVariable(e,b,e,"watch",a));return a},stashObject:function(a,b){var c=this._newId();this._objects[c]=a;oa.emit("dynamicui.stash-add",c+":"+b);return c}};
Mf.create=function(){var a=new Mf;a._objects={};a._setters={};a._getters={};a._watchGroup=a.addGroup("watches");oa.setListener("dynamicui.stash-watch",function(b){a.watchStashedObject(b)});oa.setListener("dynamicui.changevalue",function(b){var b=JSON.parse(b),c=a._setters[b.id];c&&c(b.value)});oa.setListener("dynamicui.requestvalue",function(b){var b=JSON.parse(b),c=a._getters[b.id];c&&oa.emit("dynamicui.pushvalue",JSON.stringify({id:b.id,value:c()}))});return a};Nf.prototype={_get:function(){return this.object[this.property][this.index]},
_set:function(a){this.object[this.property][this.index]=a}};Nf.create=function(a,b,c){var d=new Nf;d.object=a;d.property=b;d.index=c;d.get=d._get.bind(d);d.set=d._set.bind(d);return d};var Na={getScoreInfo:function(a){a=a.campaign;return{maxResourceBonusList:a.maxResourceBonusList,maxXpBonus:a.maxXpBonus,starCriteriaList:a.starCriteriaList}},beginBattle:function(a){var b=a.currentAttackWaveManager;b&&(b.activate(),(b=b.getEC("ECAttackWavesManager"))&&b.setCritical(!0));(b=a.currentTrickleManager)&&
b.activate();a.campaignStarterEntity&&(a.campaignStarterEntity.setToBeDestroyed(),a.campaignStarterEntity=null)},isBattling:function(a){var b=a.currentAttackWaveManager,c=b.getEC("ECAttackWavesManager").isComplete();return b.active&&!c&&!a.endedForcibly},endBattle:function(a){var b=a.currentAttackWaveManager;b&&(b.setToBeDestroyed(),a.currentAttackWaveManager=null);if(b=a.currentTrickleManager)b.setToBeDestroyed(),a.currentTrickleManager=null;if(b=a.campaignStarterEntity)b.setToBeDestroyed(),a.campaignStarterEntity=
null},setNextBattle:function(a,b,c,d){var e=a.currentBattleIndex+1,g=a.campaign;a.currentAttackWaveManager=Na.getCampaignRegionAttackWavesManager(g.battleList,e,b,c,d);a.currentTrickleManager=Na.getCampaignRegionAttackWavesManager(g.trickleList,e,b,c,d);a.currentBattleIndex=e},isFirstBattle:function(a){return 0===a.currentBattleIndex},isBossBattle:function(a){return a.campaign.isBossCampaign},hasNextBattle:function(a){return a.campaign.battleList.length-1>a.currentBattleIndex&&!a.endedForcibly},getCurrentBattleIndex:function(a){return a.currentBattleIndex},
getNumberOfBattlesInCampaign:function(a){return a.campaign.battleList.length},getNextBattleArchetypeQuantities:function(a){return a.currentAttackWaveManager.getEC("ECAttackWavesManager").getTotalArchetypeQuantities()},getCurrentBattleKilledEnemyCount:function(a){return(a=a.currentAttackWaveManager)?a.getEC("ECAttackWavesManager").getEnemiesKilled():0},getNextBattleEnemyCount:function(a){return(a=a.currentAttackWaveManager)?a.getEC("ECAttackWavesManager").getTotalEnemyCount():0},getCampaignRegionAttackWavesManager:function(a,
b,c,d,e){if(!a||a.length<=b)return null;a=a[b];b=a.battle;a=a.level;d=e.createInactiveEntityInstance(b,b,d);e=d.getEC("ECAttackWavesManager");e.setSpawnLocationList(c);e.setLevel(a);return d},forceEndCampaign:function(a){a.endedForcibly=!0},createCampaignRegion:function(a,b,c,d,e){var g=ca[a],h=Na.getCampaignRegionAttackWavesManager(g.battleList,0,c,d,e),c=Na.getCampaignRegionAttackWavesManager(g.trickleList,0,c,d,e),i=g.campaignStarterArchetype,d=e.createActiveEntityInstance(i,i,d);d.getEC("ECCampaignStarter").setCampaignRegionName(b);
return{campaignArchetypeName:a,campaign:g,currentBattleIndex:0,currentAttackWaveManager:h,currentTrickleManager:c,campaignStarterEntity:d,endedForcibly:!1}}};Of.prototype={instanceGeometry:function(a,b){var c=a.geometry;c.instance||(c.instance=this.createInstance(c,b),c.type="rigidInstanced")},instanceSceneNode:function(a,b){if(b){var c=this;a.forAll(function(a){var e;if(a.renderables)for(e=0;e<a.renderables.length;e+=1)c.instanceGeometry(a.renderables[e],b)})}},createInstance:function(a,b){var c=
{geometry:a,techniqueStateStride:4*Math.floor(6),shadowMappingTechniqueStateStride:4*Math.floor(3.75),update:this.updateRenderable,updateShadowMapping:this.shadowMappingUpdateRenderable,instanceManager:this,numInstanceSlots:b,surfaceInstancings:[]};a.geometryInstancing=c;var d=a.vertexBufferManager,e=a.indexBufferManager,g=a.vertexBufferAllocation.length,h=g*b,i=a.vertexBufferAllocation.vertexBuffer.stride,j,k=this.graphicsDevice,l,m,q,p=[],s=a.semantics,t,u,w;for(q=0;q<s.length;q+=1)switch(s[q]){case k.SEMANTIC_POSITION:w=
4;p.push("SHORT4");break;case k.SEMANTIC_NORMAL:case k.SEMANTIC_TANGENT:case k.SEMANTIC_TANGENT0:case k.SEMANTIC_BINORMAL:case k.SEMANTIC_BINORMAL0:t=4;p.push("BYTE4N");break;case k.SEMANTIC_TEXCOORD0:case k.SEMANTIC_TEXCOORD1:case k.SEMANTIC_TEXCOORD2:case k.SEMANTIC_TEXCOORD3:case k.SEMANTIC_TEXCOORD4:case k.SEMANTIC_TEXCOORD5:case k.SEMANTIC_TEXCOORD6:case k.SEMANTIC_TEXCOORD7:u=2,p.push("SHORT2")}w*=2;t*=1;u*=2;var d=d.allocate(h,p),p=d.baseIndex,B=d.vertexBuffer,y=B.stride,v;a.indexBufferAllocation&&
a.indexBufferManager.free(a.indexBufferAllocation);var x=0;for(m in a.surfaces)a.surfaces.hasOwnProperty(m)&&(q=a.surfaces[m],x=q.numIndices?x+q.numIndices:x+q.numVertices);x*=b;a.indexBufferAllocation=e.allocate(x,k.INDEXFORMAT_USHORT);var A=a.indexBufferAllocation.indexBuffer,C=new Uint16Array(x),E=0;for(m in a.surfaces)if(a.surfaces.hasOwnProperty(m)){q=a.surfaces[m];v=q.vertexData;e={indexBufferOffset:E,drawParametersArray:[],shadowDrawParametersArray:[],shadowMappingDrawParametersArray:[],nextDrawParameterArrayIndex:-1,
shadowMappingNextDrawParameterArrayIndex:-1,nextInstanceSlot:b,shadowMappingNextInstanceSlot:b,update:this.updateRenderable,updateShadowMapping:this.shadowMappingUpdateRenderable,id:this.nextID,changeCount:-1};this.nextID+=1;q.surfaceInstancing=e;c.surfaceInstancings.push(e);var H,G;if(q.numIndices){G=q.numIndices;for(e=0;e<b;e+=1){j=e*g+p;H=e*G+E;for(l=0;l<G;l+=1)C[H+l]=q.indexData[l]+j}E+=G*b}else{for(e=0;e<b;e+=1){j=e*g+p+(q.first-a.vertexBufferAllocation.baseIndex);H=e*q.numVertices+E;for(l=0;l<
q.numVertices;l+=3)C[H+l]=l+j,C[H+l+1]=l+1+j,C[H+l+2]=l+2+j}j=q.first-a.vertexBufferAllocation.baseIndex;q.indexData=new Uint16Array(q.numVertices);for(l=0;l<q.numVertices;l+=3)q.indexData[l]=l+j,q.indexData[l+1]=l+1+j,q.indexData[l+2]=l+2+j;delete q.first;q.numIndices=q.numVertices;E+=q.numVertices*b}q.indexBuffer=A}A.setData(C,a.indexBufferAllocation.baseIndex,x);var F;m=w+t+u;x=new ArrayBuffer(m*h);A=new Int8Array(x);C=new Int16Array(x);E=new Float32Array(x);for(e=0;e<b;e+=1)for(q=H=j=0;q<s.length;q+=
1)switch(s[q]){case k.SEMANTIC_POSITION:F=(e*g*m+H)/2;l=Math.max(Math.abs(a.center[0]+a.halfExtents[0]),Math.abs(a.center[0]-a.halfExtents[0]),Math.abs(a.center[1]+a.halfExtents[1]),Math.abs(a.center[1]-a.halfExtents[1]),Math.abs(a.center[2]+a.halfExtents[2]),Math.abs(a.center[2]-a.halfExtents[2]));l*=1.01;var I=32767/l;c.positionScale=I;for(l=0;l<g;l+=1)G=l*i+j,C[F]=v[G]*I|0,C[F+1]=v[G+1]*I|0,C[F+2]=v[G+2]*I|0,C[F+3]=e,F+=m/2;j+=3;H+=w;break;case k.SEMANTIC_NORMAL:case k.SEMANTIC_TANGENT:case k.SEMANTIC_TANGENT0:case k.SEMANTIC_BINORMAL:case k.SEMANTIC_BINORMAL0:F=
(e*g*m+H)/1;for(l=0;l<g;l+=1)G=l*i+j,A[F]=127*v[G]|0,A[F+1]=127*v[G+1]|0,A[F+2]=127*v[G+2]|0,F+=m/1;j+=3;H+=t;break;case k.SEMANTIC_TEXCOORD0:case k.SEMANTIC_TEXCOORD1:case k.SEMANTIC_TEXCOORD2:case k.SEMANTIC_TEXCOORD3:case k.SEMANTIC_TEXCOORD4:case k.SEMANTIC_TEXCOORD5:case k.SEMANTIC_TEXCOORD6:case k.SEMANTIC_TEXCOORD7:F=(e*g*m+H)/2;for(l=0;l<g;l+=1)G=l*i+j,C[F]=2048*v[G]|0,C[F+1]=2048*v[G+1]|0,F+=m/2;j+=2;H+=u;break;case k.SEMANTIC_COLOR:case k.SEMANTIC_COLOR0:case k.SEMANTIC_COLOR1:case k.SEMANTIC_SPECULAR:for(l=
0;l<g;l+=1)G=l*i+j,E[F]=v[G],E[F+1]=v[G+1],E[F+2]=v[G+2],E[F+3]=v[G+3],F+=y;j+=4;H+=4}B.setData(x,p,h);a.vertexBufferManager.free(a.vertexBufferAllocation);a.vertexBuffer=B;a.vertexBufferAllocation=d;this.instances.push(c);return c},queueSceneNode:function(a,b){this.sceneNodesToInstance.push({sceneNode:a,numInstances:b})},flushQueuedSceneNodes:function(){for(var a=0;a<this.sceneNodesToInstance.length;a+=1)this.instanceSceneNode(this.sceneNodesToInstance[a].sceneNode,this.sceneNodesToInstance[a].numInstances);
this.sceneNodesToInstance.length=0},updateRenderable:function(a,b,c){var d=a.surface.surfaceInstancing,e=a.geometry.geometryInstancing;a.originalDrawParameters||(a.originalDrawParameters=a.drawParameters[0],a.originalShadowDrawParameters=a.shadowDrawParameters[0],a.originalShadowDrawParameters===a.originalDrawParameters&&(d.shadowDrawParametersArray=d.drawParametersArray),d.stateChange=-1);d.changeCount!==c&&(d.changeCount=c,d.nextDrawParameterArrayIndex=-1,d.nextInstanceSlot=e.numInstanceSlots);
var g=b?d.shadowDrawParametersArray:d.drawParametersArray;if(d.nextInstanceSlot===e.numInstanceSlots){d.nextDrawParameterArrayIndex+=1;if(d.nextDrawParameterArrayIndex===g.length){var h=a.geometry.vertexBufferAllocation,i=a.geometry.indexBufferAllocation,j=this.instanceManager.graphicsDevice,c=j.createDrawParameters();g.push(c);var k=b?a.originalShadowDrawParameters:a.originalDrawParameters;c.technique=k.technique;c.setVertexBuffer(0,h.vertexBuffer);c.setSemantics(0,k.getSemantics(0));c.indexBuffer=
i.indexBuffer;c.firstIndex=d.indexBufferOffset+i.baseIndex;c.count=0;c.sortKey=$a(Bc(c.technique),a.sharedMaterial.meta.materialIndex,d.id);c.primitive=a.surface.primitive;c.setTechniqueParameters(0,k.getTechniqueParameters(0));h=j.createTechniqueParameters();j=j.createTechniqueParameterBuffer({numFloats:e.techniqueStateStride*e.numInstanceSlots,dynamic:!0});h.objectState=j;e.positionScale&&(h.positionScale=1/e.positionScale);c.setTechniqueParameters(1,h);c.userData={passIndex:k.userData.passIndex}}d.nextInstanceSlot=
0}c=g[d.nextDrawParameterArrayIndex];e=c.getTechniqueParameters(1).objectState;c.count=(d.nextInstanceSlot+1)*a.surface.numIndices;if(g=a.objectState!==e||a.instanceSlot!==d.nextInstanceSlot)a.objectState=e,0===d.nextInstanceSlot?b?a.shadowDrawParameters[0]=c:a.drawParameters[0]=c:b?a.shadowDrawParameters.length=0:a.drawParameters.length=0,a.instanceSlot=d.nextInstanceSlot;d.nextInstanceSlot+=1;return g},shadowMappingUpdateRenderable:function(a,b){var c,d=a.surface.surfaceInstancing,e=a.geometry.geometryInstancing,
g=d.shadowMappingDrawParametersArray;a.shadowMappingOriginalDrawParameters||(a.shadowMappingOriginalDrawParameters=a.shadowMappingDrawParameters[0],a.shadowMappingStateChange=-1);d.changeCount!==b&&(d.changeCount=b,d.shadowMappingNextDrawParameterArrayIndex=-1,d.shadowMappingNextInstanceSlot=e.numInstanceSlots);if(d.shadowMappingNextInstanceSlot===e.numInstanceSlots){d.shadowMappingNextDrawParameterArrayIndex+=1;if(d.shadowMappingNextDrawParameterArrayIndex===g.length){var h=a.geometry.vertexBufferAllocation,
i=a.geometry.indexBufferAllocation,j=this.instanceManager.graphicsDevice;c=j.createDrawParameters();g.push(c);var k=a.shadowMappingOriginalDrawParameters;c.technique=k.technique;c.setVertexBuffer(0,h.vertexBuffer);c.setSemantics(0,k.getSemantics(0));c.indexBuffer=i.indexBuffer;c.firstIndex=d.indexBufferOffset+i.baseIndex;c.count=i.count;c.sortKey=$a(Bc(c.technique),d.id);c.primitive=a.surface.primitive;h=j.createTechniqueParameters();j=j.createTechniqueParameterBuffer({numFloats:e.shadowMappingTechniqueStateStride*
e.numInstanceSlots,dynamic:!0});h.objectState=j;e.positionScale&&(h.positionScale=1/e.positionScale);c.setTechniqueParameters(0,h);c.userData={passIndex:k.userData.passIndex}}d.shadowMappingNextInstanceSlot=0}c=g[d.shadowMappingNextDrawParameterArrayIndex];e=c.getTechniqueParameters(0).objectState;c.count=(d.shadowMappingNextInstanceSlot+1)*a.surface.numIndices;if(g=a.shadowMappingObjectState!==e||a.shadowMappingInstanceSlot!==d.shadowMappingNextInstanceSlot)a.shadowMappingObjectState=e,0===d.shadowMappingNextInstanceSlot?
a.shadowMappingDrawParameters[0]=c:a.shadowMappingDrawParameters.length=0,a.shadowMappingInstanceSlot=d.shadowMappingNextInstanceSlot;d.shadowMappingNextInstanceSlot+=1;return g}};Of.create=function(a){var b=new Of;b.graphicsDevice=a;b.instances=[];b.sceneNodesToInstance=[];b.nextID=0;return b};Pf.prototype={patchMaterials:function(){var a=this.globals.scene.materials,b=this.globals.effectManager,c,d=this.globals.mathDevice,e=d.v4BuildOne(),g=d.v4Build(0,0,0,1),h={},i,j;for(j in b.effects)if(b.effects.hasOwnProperty(j)){var k=
j.split("_").sort().join("_");h[k]=b.effects[j]}this.identityUVTransform=new Float32Array([1,0,0,1,0,0]);for(c in a)if(a.hasOwnProperty(c)){var k=a[c],l=k.techniqueParameters;-1===c.indexOf("light")&&-1===c.indexOf("Light")&&(l.uvTransform=this.identityUVTransform);k.effectName&&b.get(k.effectName).prepareMaterial(k);j=k.effect.name;if("phong"===j||"blinn"===j||"default"===j||"lambert"===j||"constant"===j||"blend"===j||"glowmap"===j||"lightmap"===j){var m=!1,q;j=c.split("_");j.shift();j.sort();q=
j;-1!==q.indexOf("uvtransform")&&(l.uvTransform=new Float32Array([1,0,0,1,0,0]),q.splice(q.indexOf("uvtransform"),1));-1!==q.indexOf("noshadows")&&(k.meta.noshadows=!0,q.splice(q.indexOf("noshadows"),1));-1!==c.indexOf("skywind")&&(q.splice(q.indexOf("blend"),1),q.push("skywind"),l.clampedDiffuse=l.diffuse);-1!==c.indexOf("smoke_")&&(q=["alpha","alphatest","nocull","smoke"],l.smokeMinY=0,l.smokeMaxY=15);j=q.join("_");if(h[j])k.effect=h[j];else if(-1===c.indexOf("Light"))if(-1!==q.indexOf("shiny"))k.effect=
b.get("shiny"),m=!0;else{j="default";for(i=0;i<q.length;i+=1)if(b.effects[q[i]]){j=q[i];break}k.effect=b.get(j)}l.ambient&&("monstercolour"!==c&&"monstercolour_default"!==c&&(!d.v4Equal(l.ambient,e)&&!d.v4Equal(l.ambient,g))&&(l.materialColor=d.v4Copy(l.ambient)),l.materialColor||(l.materialColor=e),delete l.ambient);-1!==q.indexOf("alphatest")&&(l.alphaRef=-1!==q.indexOf("alpha")?1/255:128/255);if(-1!==q.indexOf("alphatest")||-1!==q.indexOf("alpha"))k.meta.transparent=!0;-1!==q.indexOf("alpha")&&
(k.meta.noshadows=!0);l.light_map&&(l.glow_map=l.light_map,delete l.light_map);if(-1!==q.indexOf("glowmap")||-1!==q.indexOf("emissive"))l.emission?l.glow_map=l.emission.length?l.transparent:l.emission:l.glow_map||(l.glow_map=l.diffuse),delete l.diffuse,k.meta.shadows=!1,l.materialColor=e;l.emission&&delete l.emission;if(l.transparent){if(-1!==q.indexOf("alpha")||-1!==q.indexOf("alphatest"))l.glow_map||(l.alpha_map=k.techniqueParameters.transparent),-1!==q.indexOf("alpha")&&(k.meta.transparent=!0);
delete l.transparent}l.diffuse&&l.diffuse.length&&delete l.diffuse;delete l.reflective;delete l.reflectivity;delete l.specular;delete l.index_of_refraction;m||delete l.shininess}else La.log("Unsupported effect used by Material "+c+" uses Effect "+k.effect.name)}a.grass01_default&&(a.grass01_default.meta.materialIndex+=1024);a.fire_alphatest_uvtransform_emissive_nocull&&(a.fire_alphatest_uvtransform_emissive_nocull.meta.noshadows=!0);a.smokefire_alphatest_uvtransform_emissive_nocull&&(a.smokefire_alphatest_uvtransform_emissive_nocull.meta.noshadows=
!0);a.torchfire_alphatest_uvtransform_emissive_nocull&&(a.torchfire_alphatest_uvtransform_emissive_nocull.meta.noshadows=!0)},setUVTransform:function(a,b){var c=Math.cos(a),d=Math.sin(a);b[0]=c;b[1]=d;b[2]=-d;b[3]=c;b[4]=-0.5*(c-d)+0.5;b[5]=-0.5*(d+c)+0.5},updateFX:function(){var a=this.globals.appCurrentTime,b,c=this.globals.scene.materials;c.sawblade_matt_alphatest_uvtransform&&(b=a*(10/(100/24)),b-=Math.floor(b),b*=2*Math.PI,this.setUVTransform(b,c.sawblade_matt_alphatest_uvtransform.techniqueParameters.uvTransform));
c.smoke_matt_alphatest_uvtransform_noshadows_vcolour_nocull&&(b=3*a/5,b-=Math.floor(b),c.smoke_matt_alphatest_uvtransform_noshadows_vcolour_nocull.techniqueParameters.uvTransform[4]=b);c.smokefire_alphatest_uvtransform_emissive_nocull&&(b=1*a,b-=Math.floor(b),c.smokefire_alphatest_uvtransform_emissive_nocull.techniqueParameters.uvTransform[4]=b);c.fire_alphatest_uvtransform_emissive_nocull&&(b=2*a,b-=Math.floor(b),c.fire_alphatest_uvtransform_emissive_nocull.techniqueParameters.uvTransform[4]=b);
c.flag_matt_alphatest_uvtransform_noshadows_nocull&&(b=0.1*a,b-=Math.floor(b),c.flag_matt_alphatest_uvtransform_noshadows_nocull.techniqueParameters.uvTransform[4]=b);c.sail_matt_alphatest_uvtransform_noshadows_nocull&&(b=0.1*a,b-=Math.floor(b),c.sail_matt_alphatest_uvtransform_noshadows_nocull.techniqueParameters.uvTransform[4]=b);c.torchfire_alphatest_uvtransform_emissive_nocull&&(b=2*a,b-=Math.floor(b),c.torchfire_alphatest_uvtransform_emissive_nocull.techniqueParameters.uvTransform[4]=b);c.haloglow_emissive_alphatest_uvtransform_alpha_nocull&&
(b=0.1*a,b-=Math.floor(b),c.haloglow_emissive_alphatest_uvtransform_alpha_nocull.techniqueParameters.uvTransform[4]=b);c.skywind_blend_alpha_noshadows_uvtransform&&(b=3,a%(5+b)<b&&(b=a*(1/b),b=2*(b-Math.floor(b))-1,c.skywind_blend_alpha_noshadows_uvtransform.techniqueParameters.uvTransform[4]=b));c.skywind2_blend_alpha_noshadows_uvtransform&&(b=3,a%(7+b)<b&&(b=a*(1/b),b=2*(b-Math.floor(b))-1,c.skywind2_blend_alpha_noshadows_uvtransform.techniqueParameters.uvTransform[4]=b));c.wateredge_matt_alphatest_uvtransform_noshadows&&
(b=a-Math.floor(a),c.wateredge_matt_alphatest_uvtransform_noshadows.techniqueParameters.uvTransform[4]=b);c.wateredge_matt_alphatest_uvtransform_noshadows_nocull&&(b=a-Math.floor(a),c.wateredge_matt_alphatest_uvtransform_noshadows_nocull.techniqueParameters.uvTransform[4]=b);c.water02_matt_alphatest_uvtransform_noshadows&&(b=8*a/5,b-=Math.floor(b),c.water02_matt_alphatest_uvtransform_noshadows.techniqueParameters.uvTransform[5]=b);c.butterfly_matt_alphatest_uvtransform_noshadows&&(b=4*a/5,b-=Math.floor(b),
c.butterfly_matt_alphatest_uvtransform_noshadows.techniqueParameters.uvTransform[4]=b);c.heroLightMaterial&&(b=5*a/10,b-=Math.floor(b),c.heroLightMaterial.techniqueParameters.lightNoiseOffset2=b,c.heroLightMaterial.techniqueParameters.lightNoiseScale2=0.0390625)},registerEffects:function(){function a(a){var b=this;a.load(this.shaderName,function(a){b.shader=a;b.technique=a.getTechnique(b.techniqueName);b.techniqueIndex=Bc(b.techniqueName)});e.shadowMaps&&(this.shadowMappingTechniqueName&&a.load(this.shadowMappingShaderName,
function(a){b.shadowMappingShader=a;b.shadowMappingTechnique=a.getTechnique(b.shadowMappingTechniqueName);b.shadowMappingTechniqueIndex=Bc(b.shadowMappingTechniqueName)}),this.shadowTechniqueName&&a.load(this.shadowShaderName,function(a){b.shadowShader=a;b.shadowTechnique=a.getTechnique(b.shadowTechniqueName);b.shadowTechniqueIndex=Bc(b.shadowTechniqueName)}))}var b=this,c=this.globals.effectManager,d=this.globals.shaderManager,e=this.globals.renderer;this.shaderFile=(this.usingForwardRenderer=this.globals.renderer instanceof
Ga)?"shaders/polycraftrendering_fr.cgfx":"shaders/polycraft_nl.cgfx";d.load(this.shaderFile);var g,h,i=e.defaultPrepareFn,j=e.defaultUpdateFn,k=e.defaultSkinnedUpdateFn,l=e.defaultInstancedUpdateFn,m=e.defaultShadowMappingUpdateFn,q=e.defaultShadowMappingSkinnedUpdateFn,p=e.defaultShadowMappingInstancedUpdateFn,s=function(a){i.call(this,a)},t=function(a){i.call(this,a);var c,d,g;if(b.usingForwardRenderer)for(c=0;c<a.drawParameters.length;c+=1)if(g=a.drawParameters[c],g.userData.passIndex===e.passIndex.fillZ)d=
g.getTechniqueParameters(0),d.alpha_map=a.sharedMaterial.techniqueParameters.glow_map,g.setTechniqueParameters(d);else{if(g.userData.passIndex===e.passIndex.ambient||g.userData.passIndex===e.passIndex.glow)g.technique=a.sharedMaterial.effect.geometryType.rigid.technique}else for(c=0;c<a.drawParameters.length;c+=1)g=a.drawParameters[c],g.technique=a.sharedMaterial.effect.geometryType[a.geometryType].technique};c.remove("default");g=Y.create("default");c.add(g);h={prepare:s,shaderName:this.shaderFile,
techniqueName:"default_",update:j,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:m,shadowShaderName:this.shaderFile,shadowTechniqueName:"default_shadows",loadTechniques:a};h.loadTechniques(d);g.add("rigid",h);h={prepare:i,shaderName:this.shaderFile,techniqueName:"default_instanced",update:l,shadowMappingShaderName:"shaders/nlightrenderingshadowmapping.cgfx",shadowMappingTechniqueName:"rigid_instanced",shadowMappingUpdate:p,shadowShaderName:this.shaderFile,
shadowTechniqueName:"default_instanced_shadows",loadTechniques:a};h.loadTechniques(d);g.add("rigidInstanced",h);h={prepare:s,shaderName:this.shaderFile,techniqueName:"default_skinned",update:k,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"skinned",shadowMappingUpdate:q,shadowShaderName:this.shaderFile,shadowTechniqueName:"default_skinned_shadows",loadTechniques:a};h.loadTechniques(d);g.add("skinned",h);g=Y.create("default_alpha");c.add(g);h={prepare:s,shaderName:this.shaderFile,
techniqueName:"default_alpha",update:j,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:m,shadowShaderName:this.shaderFile,shadowTechniqueName:"default_alpha_shadows",loadTechniques:a};h.loadTechniques(d);g.add("rigid",h);h={prepare:s,shaderName:this.shaderFile,techniqueName:"default_alpha_instanced",update:l,shadowMappingShaderName:"shaders/nlightrenderingshadowmapping.cgfx",shadowMappingTechniqueName:"rigid_instanced",shadowMappingUpdate:p,
shadowShaderName:this.shaderFile,shadowTechniqueName:"default_alpha_instanced_shadows",loadTechniques:a};h.loadTechniques(d);g.add("rigidInstanced",h);c.map("default_alphatest","default_alpha");g=Y.create("shiny");c.add(g);h={prepare:s,shaderName:this.shaderFile,techniqueName:"shiny",update:j,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:m,shadowShaderName:this.shaderFile,shadowTechniqueName:"shiny_shadows",loadTechniques:a};h.loadTechniques(d);
g.add("rigid",h);h={prepare:i,shaderName:this.shaderFile,techniqueName:"shiny_instanced",update:l,shadowMappingShaderName:"shaders/nlightrenderingshadowmapping.cgfx",shadowMappingTechniqueName:"rigid_instanced",shadowMappingUpdate:p,shadowShaderName:this.shaderFile,shadowTechniqueName:"shiny_instanced_shadows",loadTechniques:a};h.loadTechniques(d);g.add("rigidInstanced",h);h={prepare:s,shaderName:this.shaderFile,techniqueName:"shiny_skinned",update:k,shadowMappingShaderName:"shaders/shadowmapping.cgfx",
shadowMappingTechniqueName:"skinned",shadowMappingUpdate:q,shadowShaderName:this.shaderFile,shadowTechniqueName:"shiny_skinned_shadows",loadTechniques:a};h.loadTechniques(d);g.add("skinned",h);g=Y.create("matt");c.add(g);h={prepare:s,shaderName:this.shaderFile,techniqueName:"matt",update:j,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:m,shadowShaderName:this.shaderFile,shadowTechniqueName:"matt_shadows",loadTechniques:a};h.loadTechniques(d);
g.add("rigid",h);h={prepare:s,shaderName:this.shaderFile,techniqueName:"matt_instanced",update:l,shadowMappingShaderName:"shaders/nlightrenderingshadowmapping.cgfx",shadowMappingTechniqueName:"rigid_instanced",shadowMappingUpdate:p,shadowShaderName:this.shaderFile,shadowTechniqueName:"matt_instanced_shadows",loadTechniques:a};h.loadTechniques(d);g.add("rigidInstanced",h);h={prepare:s,shaderName:this.shaderFile,techniqueName:"matt_skinned",update:k,shadowMappingShaderName:"shaders/shadowmapping.cgfx",
shadowMappingTechniqueName:"skinned",shadowMappingUpdate:q,shadowShaderName:this.shaderFile,shadowTechniqueName:"matt_skinned_shadows",loadTechniques:a};h.loadTechniques(d);g.add("skinned",h);g=Y.create("matt_nocull");c.add(g);h={prepare:s,shaderName:this.shaderFile,techniqueName:"matt_nocull",update:j,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:m,shadowShaderName:this.shaderFile,shadowTechniqueName:"matt_nocull_shadows",loadTechniques:a};
h.loadTechniques(d);g.add("rigid",h);h={prepare:s,shaderName:this.shaderFile,techniqueName:"matt_nocull_instanced",update:l,shadowMappingShaderName:"shaders/nlightrenderingshadowmapping.cgfx",shadowMappingTechniqueName:"rigid_instanced",shadowMappingUpdate:p,shadowShaderName:this.shaderFile,shadowTechniqueName:"matt_nocull_instanced_shadows",loadTechniques:a};h.loadTechniques(d);g.add("rigidInstanced",h);g=Y.create("matt_alphatest");c.add(g);h={prepare:s,shaderName:this.shaderFile,techniqueName:"matt_alphatest",
update:j,shadowMappingShaderName:"shaders/nlightrenderingshadowmapping.cgfx",shadowMappingTechniqueName:"rigid_alpha",shadowMappingUpdate:m,shadowShaderName:this.shaderFile,shadowTechniqueName:"matt_alphatest_shadows",loadTechniques:a};h.loadTechniques(d);g.add("rigid",h);h={prepare:s,shaderName:this.shaderFile,techniqueName:"matt_alphatest_instanced",update:l,shadowMappingShaderName:"shaders/nlightrenderingshadowmapping.cgfx",shadowMappingTechniqueName:"rigid_instanced",shadowMappingUpdate:p,shadowShaderName:this.shaderFile,
shadowTechniqueName:"matt_alphatest_instanced_shadows",loadTechniques:a};h.loadTechniques(d);g.add("rigidInstanced",h);g=Y.create("matt_alphatest_nocull");c.add(g);h={prepare:s,shaderName:this.shaderFile,techniqueName:"matt_alphatest_nocull",update:j,shadowMappingShaderName:"shaders/nlightrenderingshadowmapping.cgfx",shadowMappingTechniqueName:"rigid_alpha",shadowMappingUpdate:m,shadowShaderName:this.shaderFile,shadowTechniqueName:"matt_alphatest_nocull_shadows",loadTechniques:a};h.loadTechniques(d);
g.add("rigid",h);h={prepare:s,shaderName:this.shaderFile,techniqueName:"matt_alphatest_nocull_instanced",update:l,shadowMappingShaderName:"shaders/nlightrenderingshadowmapping.cgfx",shadowMappingTechniqueName:"rigid_instanced",shadowMappingUpdate:p,shadowShaderName:this.shaderFile,shadowTechniqueName:"matt_alphatest_nocull_instanced_shadows",loadTechniques:a};h.loadTechniques(d);g.add("rigidInstanced",h);g=Y.create("alphatest_emissive");c.add(g);h={prepare:t,shaderName:this.shaderFile,techniqueName:"emissive_alphatest",
update:j,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:m,loadTechniques:a};h.loadTechniques(d);g.add("rigid",h);h={prepare:t,shaderName:this.shaderFile,techniqueName:"emissive_alphatest_instanced",update:l,shadowMappingShaderName:"shaders/nlightrenderingshadowmapping.cgfx",shadowMappingTechniqueName:"rigid_instanced",shadowMappingUpdate:p,loadTechniques:a};h.loadTechniques(d);g.add("rigidInstanced",h);c.map("emissive","alphatest_emissive");
g=Y.create("alphatest_emissive_nocull");c.add(g);h={prepare:t,shaderName:this.shaderFile,techniqueName:"emissive_alphatest_nocull",update:j,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:m,loadTechniques:a};h.loadTechniques(d);g.add("rigid",h);h={prepare:t,shaderName:this.shaderFile,techniqueName:"emissive_alphatest_nocull_instanced",update:l,shadowMappingShaderName:"shaders/nlightrenderingshadowmapping.cgfx",shadowMappingTechniqueName:"rigid_instanced",
shadowMappingUpdate:p,loadTechniques:a};h.loadTechniques(d);g.add("rigidInstanced",h);g=Y.create("alpha_alphatest_emissive");c.add(g);h={prepare:t,shaderName:this.shaderFile,techniqueName:"emissive_alpha_alphatest",update:j,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:m,loadTechniques:a};h.loadTechniques(d);g.add("rigid",h);h={prepare:t,shaderName:this.shaderFile,techniqueName:"emissive_alpha_alphatest_instanced",update:l,shadowMappingShaderName:"shaders/nlightrenderingshadowmapping.cgfx",
shadowMappingTechniqueName:"rigid_instanced",shadowMappingUpdate:p,loadTechniques:a};h.loadTechniques(d);g.add("rigidInstanced",h);g=Y.create("alpha_alphatest_emissive_nocull");c.add(g);h={prepare:t,shaderName:this.shaderFile,techniqueName:"emissive_alpha_alphatest_nocull",update:j,shadowMappingShaderName:"shaders/shadowmapping.cgfx",shadowMappingTechniqueName:"rigid",shadowMappingUpdate:m,loadTechniques:a};h.loadTechniques(d);g.add("rigid",h);h={prepare:t,shaderName:this.shaderFile,techniqueName:"emissive_alpha_alphatest_nocull_instanced",
update:l,shadowMappingShaderName:"shaders/nlightrenderingshadowmapping.cgfx",shadowMappingTechniqueName:"rigid_instanced",shadowMappingUpdate:p,loadTechniques:a};h.loadTechniques(d);g.add("rigidInstanced",h);g=Y.create("skywind_alpha");c.add(g);h={prepare:s,shaderName:this.shaderFile,techniqueName:"skywind",update:j,loadTechniques:a};h.loadTechniques(d);g.add("rigid",h);g=Y.create("smoke_alpha_alphatest_nocull");c.add(g);h={prepare:s,shaderName:this.shaderFile,techniqueName:"smoke",update:j,shadowMappingUpdate:m,
shadowShaderName:this.shaderFile,shadowTechniqueName:"smoke_shadows",loadTechniques:a};h.loadTechniques(d);g.add("rigid",h)},dumpDrawParameter:function(a){La.log("Pass "+a.userData.passIndex+" Technique "+a.technique.name)},dumpShaders:function(a){this.dumppedShaders||(this.dumppedShaders={});var b=a.sharedMaterial.name;if(!this.dumppedShaders[b]){this.dumppedShaders[b]=!0;La.log("Material "+a.sharedMaterial.name);for(b=0;b<a.drawParameters.length;b+=1)this.dumpDrawParameter(a.drawParameters[b]);
if(a.diffuseDrawParameters)for(b=0;b<a.diffuseDrawParameters.length;b+=1)this.dumpDrawParameter(a.diffuseDrawParameters[b])}}};Pf.create=function(a){var b=new Pf;b.globals=a;b.registerEffects();Eb.setDefaultBufferSize(a.renderer.getDefaultSkinBufferSize());return b};Zd.prototype={optimize:function(a){this.params=a;a.scene.update();var b=this.createCells(a),c,d;for(c in b)b.hasOwnProperty(c)&&(d=b[c],this.merge(d));a.scene.update()},createCells:function(a){var b=a.scene,c=a.dx,d=a.dy,e=a.dz,g=this.mathDevice,
h;b.update();var i={},j=function(a){if(!a.dynamic){h=g.m43Pos(a.getWorldTransform(),h);var b=Math.floor(h[0]/c),k=Math.floor(h[1]/d),q=Math.floor(h[2]/e),p=b.toString()+"_"+k+"_"+q,s=i[p];s||(s=i[p]={key:p,position:[b,k,q],sceneNodes:[]});s.sceneNodes.push(a);a.children&&a.children.forEach(j)}};b.rootNodes.forEach(j);return i},createMaterialMap:function(a){var b,c={},d,e,g,h,i,j;for(i=0;i<a.length;i+=1)if(e=a[i].renderables)for(h=0;h<e.length;h+=1){g=e[h];b=g.getMaterial();d=g.geometry.semantics;
b=b.getName()+" semantics=[";for(j=0;j<d.length;j+=1)b+=d[j]+",";b+="]";(d=c[b])||(d=c[b]=[]);d.push(g)}return c},merge:function(a){var b=this.createMaterialMap(a.sceneNodes),a=Sa.create({name:"MergeNode_"+a.key}),c,d;for(d in b)if(b.hasOwnProperty(d)){var e=b[d];c=this.createRenderable(e);a.addRenderable(c);this.oldRenderables+=e.length;this.newRenderables+=1}this.params.scene.addRootNode(a)},createRenderable:function(a){var b=this.params.keepVertexData,c=this.mathDevice,d=this.graphicsDevice,e=
this.params.scene,g=[],h,i,j,k,l,m=0,q=this.scratchpad.v3Temp,p=this.scratchpad.v3Temp,s,t=a[0],u=t.geometry.semantics,w=t.geometry.vertexBuffer.stride,A,y,v=0,x,E,C=!0,G=[],H=[],F=c.aabbBuildEmpty(this.scratchpad.aabbTemp),I=0;for(h=0;h<a.length;h+=1)s=a[h],I+=s.surface.numIndices?s.surface.numIndices:s.surface.numVertices;I*w>this.vertexData.length&&(this.vertexData=new Float32Array(1024*(1+Math.floor(I/1024))*w));I=this.vertexData;for(h=0;h<a.length;h+=1){s=a[h];x=s.node.getWorldTransform();E=
c.m33InverseTranspose(x,this.scratchpad.m33Temp);for(j=0;j<s.geometry.vertexBuffer.attributes.length;j+=1);A=s.surface;if(l=A.indexData){C=0;H.length=0;G.length=0;i=m;for(j=0;j<l.length;j+=1)k=l[j],v=H[k],void 0===v&&(H[k]=v=C,G[C]=l[j],C+=1),g.push(i+v);k=0;l=C-1;C=!1}else{k=A.first-s.geometry.vertexBufferAllocation.baseIndex;l=k+A.numVertices-1;G.length=0;i=m;for(j=0;j<A.numVertices;j+=1)g.push(i+j),G[j]=j+k}i=l-k+1;A=A.vertexData;l=0;var K;for(k=0;k<u.length;k+=1)switch(v=m*w+l,u[k]){case d.SEMANTIC_POSITION:K=
l;for(j=0;j<i;j+=1)y=G[j]*w+l,c.v3Build(A[y],A[y+1],A[y+2],q),c.m43TransformPoint(x,q,q),q[0]=Math.floor(1E3*q[0]+0.5)/1E3,q[1]=Math.floor(1E3*q[1]+0.5)/1E3,q[2]=Math.floor(1E3*q[2]+0.5)/1E3,I[v]=q[0],I[v+1]=q[1],I[v+2]=q[2],F[0]>q[0]&&(F[0]=q[0]),F[3]<q[0]&&(F[3]=q[0]),F[1]>q[1]&&(F[1]=q[1]),F[4]<q[1]&&(F[4]=q[1]),F[2]>q[2]&&(F[2]=q[2]),F[5]<q[2]&&(F[5]=q[2]),v+=w;l+=3;break;case d.SEMANTIC_NORMAL:case d.SEMANTIC_TANGENT:case d.SEMANTIC_TANGENT0:case d.SEMANTIC_BINORMAL:case d.SEMANTIC_BINORMAL0:for(j=
0;j<i;j+=1)y=G[j]*w+l,c.v3Build(A[y],A[y+1],A[y+2],p),c.m33Transform(E,p,p),c.v3Normalize(p,p),I[v]=p[0],I[v+1]=p[1],I[v+2]=p[2],v+=w;l+=3;break;case d.SEMANTIC_TEXCOORD0:case d.SEMANTIC_TEXCOORD1:case d.SEMANTIC_TEXCOORD2:case d.SEMANTIC_TEXCOORD3:case d.SEMANTIC_TEXCOORD4:case d.SEMANTIC_TEXCOORD5:case d.SEMANTIC_TEXCOORD6:case d.SEMANTIC_TEXCOORD7:if(-1!==s.sharedMaterial.getName().indexOf("_worlduv")){y=this.params.worldUVScale;var L,N,M=Math.floor(F[0]*y)/y,O=Math.floor(F[2]*y)/y;for(j=0;j<i;j+=
1)L=I[v-(l-K)]-M,N=I[v-(l-K)+2]-O,L*=y,N*=y,I[v]=L,I[v+1]=N,v+=w}else for(j=0;j<i;j+=1)y=G[j]*w+l,I[v]=A[y],I[v+1]=A[y+1],v+=w;l+=2;break;case d.SEMANTIC_COLOR:case d.SEMANTIC_COLOR0:case d.SEMANTIC_COLOR1:case d.SEMANTIC_SPECULAR:for(j=0;j<i;j+=1)y=G[j]*w+l,I[v]=A[y],I[v+1]=A[y+1],I[v+2]=A[y+2],I[v+3]=A[y+3],v+=w;l+=4}m+=i}h=t.sharedMaterial;a=$c.create();a.semantics=t.geometry.semantics;a.type=t.geometry.type;this.newVertexCount+=m;j=e.vertexBufferManager.allocate(m,t.geometry.vertexBuffer.attributes);
a.vertexBuffer=j.vertexBuffer;a.vertexBufferAllocation=j;a.vertexBufferManager=e.vertexBufferManager;i=j.baseIndex;a.vertexBuffer.setData(I,i,m);j=e.indexBufferManager;e=a.surfaces[h.name]={};t=Ja.create(a,e,h);h=g.length;e.numVertices=m;e.primitive=d.PRIMITIVE_TRIANGLES;l=i+m-1;d=g.length;if(C)e.first=i+g[0];else{C=j.allocate(h,65536>l?"USHORT":"UINT");q=C.indexBuffer;if(!q)return;t.indexBufferManager=j;t.indexBufferAllocation=C;p=65536>l?new Uint16Array(g):new Uint32Array(g);if(i)for(j=0;j<g.length;j+=
1)p[j]=g[j]+i;j=C.baseIndex;e.indexBuffer=C.indexBuffer;e.numIndices=d;e.first=j;b&&(e.indexData=65536>l?new Uint16Array(g):new Uint32Array(g));q.setData(p,j,h)}b&&(e.vertexData=I.slice(0,m*w));t.center=a.center=c.v3Build(0.5*(F[0]+F[3]),0.5*(F[1]+F[4]),0.5*(F[2]+F[5]));t.halfExtents=a.halfExtents=c.v3Build(0.5*(F[3]-F[0]),0.5*(F[4]-F[1]),0.5*(F[5]-F[2]));return t},removeMergeNodes:function(a){var b=[],c;for(c=0;c<a.rootNodes.length;c+=1)-1!==a.rootNodes[c].getName().indexOf("MergeNode_")&&b.push(a.rootNodes[c]);
for(c=0;c<b.length;c+=1)a.removeRootNode(b[c]),b[c].destroy()}};Zd.create=function(a){var b=new Zd;b.mathDevice=a.mathDevice;b.graphicsDevice=a.graphicsDevice;b.scratchpad={v3Temp:a.mathDevice.v3BuildZero(),m33Temp:a.mathDevice.m33BuildIdentity(),aabbTemp:a.mathDevice.aabbBuildEmpty()};b.newRenderables=0;b.oldRenderables=0;b.newVertexCount=0;b.oldVertexCount=0;b.vertexData=new Float32Array(16384);return b};var Rg={enable:function(a){ea.mergeStaticMeshes&&(Zd.create({mathDevice:a.mathDevice,graphicsDevice:a.graphicsDevice}).optimize({scene:a.scene,
dx:20,dy:999,dz:20,worldUVScale:0.1,keepVertexData:ea.debugEnableWireframe}),a=a.gameManager.gameSpaceList[0].getBlockList(),ea.cheats?a.forEach(function(a){a.disableMeshNode()}):a.forEach(function(a){a.destroyMeshNode()}))},disable:function(a){if(ea.mergeStaticMeshes&&(Zd.prototype.removeMergeNodes(a.scene),a=a.gameManager))(a=a.gameSpaceList[0])&&a.getBlockList().forEach(function(a){a.enableMeshNode()})}},ck={playFlagsNormal:{canGenerateResources:!0,wildlingsCanWork:!0,healGameCriticalEntities:!0,
validSelectTypes:{selectTypeNormal:!0,selectTypePrepare:!0,selectTypeWar:!0,selectTypeAlways:!0,selectTypeCampaign:!1},cameraMode:"explore",displayResource:!0,displaySoftCurrency:!0,displayHQHealth:!1,displayWarCompassPrepare:!1,displayWarCompassInvasion:!1,offsetTasks:!1,displayNextInvasionDescription:!1,displayRank:!0,displayFightButton:!1,displaySkipPrepareButton:!1,showTasks:!0},playFlagsPrepareForWar:{canGenerateResources:!0,wildlingsCanWork:!1,validSelectTypes:{selectTypeNormal:!1,selectTypePrepare:!0,
selectTypeWar:!0,selectTypeAlways:!0,selectTypeCampaign:!0},cameraMode:"explore",displayResource:!0,displaySoftCurrency:!0,displayHQHealth:!0,displayWarCompassPrepare:!0,displayWarCompassInvasion:!1,offsetTasks:!0,displayNextInvasionDescription:!1,displayRank:!0,displayFightButton:!1,displaySkipPrepareButton:!0,showTasks:!1},playFlagsWar:{canGenerateResources:!1,wildlingsCanWork:!1,healGameCriticalEntities:!1,canHealGameCriticalEntitiesOnExit:!0,validSelectTypes:{selectTypeNormal:!1,selectTypePrepare:!1,
selectTypeWar:!0,selectTypeAlways:!0,selectTypeCampaign:!0},cameraMode:"war",displayResource:!0,displaySoftCurrency:!0,displayHQHealth:!0,displayWarCompassPrepare:!1,displayWarCompassInvasion:!0,offsetTasks:!0,displayNextInvasionDescription:!1,displayRank:!0,displayFightButton:!1,displaySkipPrepareButton:!1,showTasks:!1}},Rb=fd.extend({playStateName:"No Play State",playStateCreationMap:[],playFlagName:"playFlagsNormal",init:function(a,b){this.gameStatePlayingOwner=a;this.gameManager=a.getGameManager();
this.globals=b;this.applyFlags(ck[this.playFlagName]);this.gameManager.setPlayState(this)},deInit:function(){},applyFlags:function(a){this.gameManager.setPlayFlags(a)},update:function(){},draw2D:function(){}});Rb.create=function(a,b,c){return new Rb(a,b,c)};Rb.createFromName=function(a,b,c,d){return Rb.prototype.playStateCreationMap[a].create(b,c,d)};var ai=Rb.extend({playStateName:"PlayStateBattle",playStateCreationMap:[],playFlagName:"playFlagsWar",BATTLE_NEWSFLASH_DURATION:3,END_OF_BATTLE_DELAY_DURATION:2,
init:function(a,b,c){this._super(a,b,c);a=this.gameManager.getHero().getGameSpace().getEntitiesWithEC("ECWarManager");1===a.length&&(a=a[0].getEC("ECWarManager"),b=a.getActiveCampaignRegionName(),a.beginBattle(b),this.ecWarManager=a,this.gameManager.getGameSoundManager().play("combatWaveApproaching",null,null),this.endOfBattleTime=null,this.hqDeathOccurred=!1,b=this.gameManager.eventManager,this.onHqDeathBound=c=this.onHqDeath.bind(this),b.subscribe("hqDeath",c),this.gameManager.startCombatMusic(a.isBossBattle()),
this.displayBattleStartNewsFlash())},deInit:function(){this._super();this.gameManager.eventManager.unsubscribe("hqDeath",this.onHqDeathBound)},onHqDeath:function(){this.hqDeathOccurred=!0},displayBattleStartNewsFlash:function(){var a=this.globals.currentLanguage,b=a.CAMPAIGN_BATTLE_BEGIN_NEWFLASH,a=a.CAMPAIGN_BATTLE_COUNT_NEWSFLASH,c=this.ecWarManager,d=c.getActiveCampaignRegionName(),e=c.getNumberOfBattlesInCampaign(d),c=c.getCurrentBattleIndex(d)+1;this.gameManager.getGuiManager().addGameMessage("idPlayStateBattleStarted",
b,a+" "+(c+"/"+e),this.BATTLE_NEWSFLASH_DURATION,"newsflashBattleStarted")},displayBattleEndNewsFlash:function(){var a=this.globals.currentLanguage,b=a.CAMPAIGN_BATTLE_END_NEWFLASH,a=a.CAMPAIGN_BATTLE_COUNT_NEWSFLASH,c=this.ecWarManager,d=c.getActiveCampaignRegionName(),e=c.getNumberOfBattlesInCampaign(d),c=c.getCurrentBattleIndex(d)+1;this.gameManager.getGuiManager().addGameMessage("idPlayStateBattleEnded",b,a+" "+(c+"/"+e),this.BATTLE_NEWSFLASH_DURATION,"newsflashBattleEnded")},update:function(){this._super();
var a=this.gameManager,b,c;b=this.globals.gameCurrentTime;c=this.ecWarManager.getActiveCampaignRegionName();var d=this.ecWarManager.getCampaignArchetypeName(c);if(null!==this.endOfBattleTime){if(b-this.endOfBattleTime>this.END_OF_BATTLE_DELAY_DURATION)if(!this.ecWarManager.hasNextBattle(c)||this.hqDeathOccurred){var e=!this.hqDeathOccurred;a.useWarScoreGUI&&(a.gameSoundManager.play(e?"aud_sting_success_battle":"aud_sting_fail_battle",null,null),b=Qf.create(a,this.globals),a.setGameState(b));this.ecWarManager.endCampaign(c,
e);this.sendEndCampaignMetric(d);this.gameStatePlayingOwner.setPlayState("PlayStateNormal")}else this.displayBattleEndNewsFlash(),this.ecWarManager.setNextBattle(c),a.usePrepareForWarScreenBetweenInvasions?(c=Uf.create(a,this.globals),a.setGameState(c)):this.gameStatePlayingOwner.setPlayState("PlayStatePrepareForBattle")}else if(this.hqDeathOccurred||!this.ecWarManager.isBattling(c))this.endOfBattleTime=b,this.sendBattleEndMetric(),this.ecWarManager.endBattle(c)},sendBattleEndMetric:function(){this.globals.metricsManager.sendGameMetric("battleFinished_"+
this.ecWarManager.getActiveBattleArchetypeName())},sendEndCampaignMetric:function(a){var b=this.globals.metricsManager,c=this.gameManager.getScoreInfo().getCampaignScoreInfo(),d=c.resourceBonusList;b.sendGameMetric("campaignEnded_"+a,[c.wasVictory?1:0,c.grade,d[E.LUMBER],d[E.STONE]])}});ai.create=function(a,b,c){return new ai(a,b,c)};Rb.prototype.playStateCreationMap[ai.prototype.playStateName]=ai;var bi=Rb.extend({playStateName:"PlayStateNormal",playStateCreationMap:[],playFlagName:"playFlagsNormal",
init:function(a,b,c){this._super(a,b,c);this.gameManager.startAmbientMusic();a=this.gameManager.eventManager;this.onCampaignStarterInteractBound=this.onCampaignStarterInteract.bind(this);a.subscribe("CampaignStarterInteract",this.onCampaignStarterInteractBound)},onCampaignStarterInteract:function(a){var b=this.gameManager;if(0<b.getGameEntitiesByFamilyName("outpost").length&&Ob.campaignsEnabled){var c=sc.create(b,this.globals);c.setCampaignRegionName(a);b.setGameState(c)}},deInit:function(){this._super();
this.gameManager.eventManager.unsubscribe("CampaignStarterInteract",this.onCampaignStarterInteractBound)},update:function(){this._super()}});bi.create=function(a,b,c){return new bi(a,b,c)};Rb.prototype.playStateCreationMap[bi.prototype.playStateName]=bi;var ci=Rb.extend({playStateName:"PlayStatePrepareForBattle",playStateCreationMap:[],playFlagName:"playFlagsPrepareForWar",FIRST_PREPARE_TIME:5,PREPARE_TIME:60,COUNTDOWN_MAX_THRESHOLD:3,COUNTDOWN_MIN_THRESHOLD:0.2,init:function(a,b,c){this._super(a,
b,c);this.prepareStartTime=b.gameCurrentTime;a=this.gameManager.getHero().getGameSpace().getEntitiesWithEC("ECWarManager");1===a.length&&(this.ecWarManager=a=a[0].getEC("ECWarManager"))&&this.setPrepareTime(a)},setPrepareTime:function(a){var b=a.getActiveCampaignRegionName();this.prepareTime=a.isFirstBattle(b)?this.FIRST_PREPARE_TIME:this.PREPARE_TIME},deInit:function(){this._super()},update:function(){this._super();var a=this.globals.gameCurrentTime,b=Math.round(this.prepareTime-(a-this.prepareStartTime));
a-this.prepareStartTime>this.prepareTime&&this.gameStatePlayingOwner.setPlayState("PlayStateBattle");a=this.gameManager;a.getGuiScores()&&a.getGuiScores().setPrepareTimeRemaining(b);b<=this.COUNTDOWN_MAX_THRESHOLD&&b>=this.COUNTDOWN_MIN_THRESHOLD&&this.displayBattleCountdown(b)},displayBattleCountdown:function(a){var b=this.globals.currentLanguage.CAMPAIGN_COUNTDOWN_NEWSFLASH_TITLE.toUpperCase(),a=Math.ceil(a)+" s";this.gameManager.getGuiManager().addGameMessage("idPlayStateBattleBegun",b,a,0.1,"newsflashBattleCountdown")},
draw2D:function(){}});ci.create=function(a,b,c){return new ci(a,b,c)};Rb.prototype.playStateCreationMap[ci.prototype.playStateName]=ci;$d.prototype={name:"GamestateBuildingInfoPanel",enterState:function(){var a=this.gameManager,b=a.getGameController();b.setActive(!0);b.setModeMenuScreen();a.onEnterMenu();a.startPaused()},exitState:function(){this.gameManager.exitPaused()},setBuilding:function(a){this.buildingEntity=a},update:function(){var a=this.gameManager,b=a.getGameCamera();a.getGameController().update();
a.gameLighting.update();b.update();var b=a.getIMGui(),c=this.globals,d=c.guiRenderer;b.doBackground();a.getGuiManager().addDrawGui("bgPattern",{v2ScreenLocation:d.getv2RenderLocation(0,0)},"idBackgroundPatternImage");sa.doUpgradeInfoPanel(a,c,this.buildingEntity)&&a.getActiveGameState()===this&&a.toggleBuildingInfoPanelState()},draw:function(){var a=this.gameManager,b=a.getGameController();a.drawGameSpaces();b.draw()},draw2D:function(){var a=this.gameManager,b=a.getGuiScores(),a=a.getHero(),c=this.globals.guiRenderer;
c.begin();b.drawResourceBar(a,E.LUMBER);b.drawResourceBar(a,E.STONE);b.drawSoftCurrency(a);c.end()}};$d.create=function(a,b){var c=new $d;c.gameManager=a;c.globals=b;c.buildingEntity=null;return c};Qf.prototype={name:"GamestateCampaignScore",enterState:function(){var a=this.gameManager,b=a.getGameController(),c=a.getGameCamera();b.setActive(!0);b.setModeMenuScreen();c.setModeOrbitScene();a.startPaused();this.warManager=this.gameManager.getHero().getGameSpace().getEntitiesWithEC("ECWarManager")[0]},
exitState:function(){var a=this.gameManager;a.exitPaused();a.getHero().getEC("ECPlayerData").sendResourceRegisterMetric();this.sendRepairCostMetric();a.eventManager.notify("CampaignScoreScreenExited")},update:function(){var a=this.gameManager,b=a.getGameCamera(),c=a.getGameController(),a=a.getGameSoundManager();c.update();b.update();a.update();this.updateMenu()},updateMenu:function(){var a=this.gameManager,b=a.getIMGui(),c=this.globals.guiRenderer;b.doBackground();a.getGuiManager().addDrawGui("bgPattern",
{v2ScreenLocation:c.getv2RenderLocation(0,0)},"idBackgroundPatternImage");b=a.getScoreInfo().getCampaignScoreInfo();c=this.warManager.getEC("ECWarManager").getPreviousActiveCampaignArchetype();sa.doCampaignEndBookend(a,this.globals,c,b)&&(c=Va.create(a,this.globals),c.setPlayState("PlayStateNormal"),a.setGameState(c),this.giveRewards(b.xpBonus,b.resourceBonusList))},giveRewards:function(a,b){var c=this.gameManager.getHero().getEC("ECPlayerData");c.adjustXP(a);c.adjustResource(E.LUMBER,b[E.LUMBER],
!0);c.adjustResource(E.STONE,b[E.STONE],!0)},sendRepairCostMetric:function(){var a=this.globals.metricsManager,b=this.gameManager.getTotalRepairCost();a.sendGameMetric("totalRepairCost",b)},draw:function(){var a=this.gameManager,b=a.getGameController();a.drawGameSpaces();b.draw()},draw2D:function(){}};Qf.create=function(a,b){var c=new Qf;c.gameManager=a;c.globals=b;return c};Rf.prototype={name:"GamestateCredits",enterState:function(){var a=this.gameManager,b=a.getGameController(),c=a.getGameCamera();
b.setActive(!0);b.setModeMenuScreen();a.onLeaveMenu();c.setModeOrbitScene();a.startPaused();this.creditsText=ea.creditsText},exitState:function(){this.gameManager.exitPaused()},update:function(){var a=this.gameManager,b=a.getGameCamera(),c=a.getGameController(),d=a.getGameSoundManager();c.update();a.gameLighting.update();b.update();d.update();this.updateMenu()},updateMenu:function(){var a=this.gameManager,b=a.getIMGui(),c=this.globals.guiRenderer;b.doBackground();var d=a.getGuiManager();d.addDrawGui("bgPattern",
{v2ScreenLocation:c.getv2RenderLocation(0,0)},"idBackgroundPatternImage");d.addDrawGui("polycraftLogo",{v2ScreenLocation:c.getv2RenderLocation(0,-260)},"idPolycraftTitle");d.addDrawGui("credits",{v2ScreenLocation:c.getv2RenderLocation(0,100),text:this.creditsText},"idCredits");b.doButton({id:"Tutorial Ok"+this.archetypeIndex,text:this.globals.currentLanguage.TXT_TUTORIAL_OKAY,v2ScreenLocation:c.getv2RenderLocation(-130,-50,"bottomRight"),buttonType:aa.DIALOG_OK,guiArchetype:"tutorialButtonOk"})&&
(b=sd.create(a,this.globals),a.setGameState(b))},draw:function(){var a=this.gameManager,b=a.getGameController();a.drawGameSpaces();b.draw()},draw2D:function(){}};Rf.create=function(a,b){var c=new Rf;c.gameManager=a;c.globals=b;return c};Sf.prototype={name:"GamestateDebugNav",enterState:function(){var a=this.gameManager,b=a.getGameController(),c=a.getGameCamera();b.setActive(!0);b.setModeDebugNav();c.setModeViewScene();a.addECDebugDrawMask(Hb.ecDebugDrawMasks.debugNav)},exitState:function(){},update:function(){this.gameManager.updateGame()},
draw:function(){var a=this.gameManager,b=a.getGameController();a.drawGameSpaces();b.draw()},draw2D:function(){this.gameManager.drawGUI()}};Sf.create=function(a,b){var c=new Sf;c.gameManager=a;c.globals=b;return c};Tf.prototype={name:"GamestateEditor",enterState:function(){var a=this.gameManager,b=a.getEntityFactory(),c=a.getBlockFactory(),d=a.getGameController(),e=a.getGameCamera();d.setActive(!1);t.Input.addEventHandlers(this.globals.inputDevice);e.setModeEditor();a.startPaused();var b=b.getArchetypeList(),
c=c.getArchetypeList(),g=this.globals,e=g.dynamicUI,g=g.mathDevice,d=d.getv2ScreenCoord();t.initState(t.Settings,b,c,d,g,e);d=t.Actions.createActionList(t.State.actionListOnEnterEditorMode,t.Actions.actionMap,{});t.Actions.executeActionList(d,this.globals,a)},exitState:function(){var a=this.gameManager,b=a.getGameController(),c=a.getGameCamera();a.exitPaused();t.Input.removeEventHandlers(this.globals.inputDevice);b.setActive(!0);c.exitModeEditor();b=t.Actions.createActionList(t.State.actionListOnExitEditorMode,
t.Actions.actionMap,{});t.Actions.executeActionList(b,this.globals,a)},update:function(){var a=this.globals,b=this.globals.inputDevice,c=this.gameManager;c.gameLighting.update();c.updateGame();var d=t.Input.getCurrentState(),e=t.Input.getPreviousState(),g=t.State.controlLists,h=t.Conditions.conditionMap,i=t.Actions.actionMap,j=t.UI.getUIState(),b=t.Controller.convertControlsIntoActions(g,h,i,d,e,j,b);t.Actions.executeActionList(b,a,c);t.UI.clearState();t.Input.updateState()},draw:function(){var a=
this.globals,b=this.gameManager,c=t.Controller.convertControlsIntoActions(t.State.drawControlLists,t.Conditions.conditionMap,t.Actions.actionMap);t.Actions.executeActionList(c,a,b)},draw2D:function(){var a=this.globals,b=this.gameManager,c=t.Controller.convertControlsIntoActions(t.State.draw2dControlLists,t.Conditions.conditionMap,t.Actions.actionMap);t.Actions.executeActionList(c,a,b)}};Tf.create=function(a,b){var c=new Tf;c.gameManager=a;c.globals=b;return c};sd.prototype={name:"GamestatePaused",
enterState:function(){var a=this.gameManager,b=a.getEventManager(),c=a.getGameController(),d=a.getGameCamera();c.setActive(!0);c.setModeMenuScreen();a.onEnterMenu();d.setModeOrbitScene();a.startPaused();c.setOnMouseDownCallback(this.handleClickEventBound);b.notify("PauseGame",{})},exitState:function(){var a=this.gameManager;a.getGameController().setOnMouseDownCallback(null);a.exitPaused()},update:function(){var a=this.gameManager,b=a.getGameCamera(),c=a.getGameController(),d=a.getGameSoundManager();
c.update();a.gameLighting.update();b.update();d.update();this.updateMenu()},updateMenu:function(){var a=this.gameManager,b=a.getIMGui(),c=this.globals.guiRenderer,d;b.doBackground();d=a.getGuiManager();d.addDrawGui("bgPattern",{v2ScreenLocation:c.getv2RenderLocation(0,0)},"idBackgroundPatternImage");d.addDrawGui("polycraftLogo",{v2ScreenLocation:c.getv2RenderLocation(0,-260)},"idPolycraftTitle");this.readyToUnpause=b.doButton({id:"Paused Resume",text:this.globals.currentLanguage.GUI_BUTTON_PLAY,v2ScreenLocation:c.getv2RenderLocation(-220,
-70),buttonType:aa.BUTTON_NORMAL,guiArchetype:"buttonStart",passive:!0});b.doButton({id:"Go to Shop Amber",text:this.globals.currentLanguage.GUI_BUTTON_GO_TO_SHOP,v2ScreenLocation:c.getv2RenderLocation(-220,50),buttonType:aa.BUTTON_NORMAL,guiArchetype:"buttonShop"})&&(d=Wa.create(a,this.globals),a.setGameState(d),d.setButtonPanal("amber"));b.doButton({id:"Paused Do tutorial",text:"How To Play",v2ScreenLocation:c.getv2RenderLocation(200,-70)})&&(d=tc.create(a,this.globals,!1),a.setGameState(d));b.doButton({id:"Paused Do Credits",
text:this.globals.currentLanguage.GUI_BUTTON_GO_TO_CREDITS,v2ScreenLocation:c.getv2RenderLocation(200,290)})&&(d=Rf.create(a,this.globals),a.setGameState(d));wa.offline||(this.readyToOpenWonderstruck=b.doButton({id:"Paused Go to Wonderstruck",v2ScreenLocation:c.getv2RenderLocation(-220,170),buttonType:aa.BUTTON_NORMAL,guiArchetype:"buttonWonderstruck",passive:!0}),this.readyToOpenTwitter=b.doButton({id:"Paused Twitter Share",text:"SHARE",text2:"Get "+this.gameManager.getShareReward()+" Amber!",v2ScreenLocation:c.getv2RenderLocation(-320,
290),buttonType:aa.BUTTON_NORMAL_HALF,guiArchetype:this.gameManager.validToRewardShare("twitter")?"buttonShareTwitterReward":"buttonShareTwitter",passive:!0}),this.readyToOpenFacebook=b.doButton({id:"Paused Facebook Share",text:"SHARE",text2:"Get "+this.gameManager.getShareReward()+" Amber!",v2ScreenLocation:c.getv2RenderLocation(-120,290),buttonType:aa.BUTTON_NORMAL_HALF,guiArchetype:this.gameManager.validToRewardShare("facebook")?"buttonShareFacebookReward":"buttonShareFacebook",passive:!0}));a.gameLighting.getShadowsEnabled()?
b.doButton({id:"Paused Disable Shadows",text:this.globals.currentLanguage.GUI_BUTTON_DISABLE_SHADOWS,v2ScreenLocation:c.getv2RenderLocation(200,50)})&&(a.gameLighting.setShadowsEnabled(!1),a.getPlayerData().setShadowsEnabled(!1)):b.doButton({id:"Paused Enable Shadows",text:this.globals.currentLanguage.GUI_BUTTON_ENABLE_SHADOWS,v2ScreenLocation:c.getv2RenderLocation(200,50)})&&(a.gameLighting.setShadowsEnabled(!0),a.getPlayerData().setShadowsEnabled(!0));a.getPlayerData().getMusicEnabled()?b.doButton({id:"Paused Disable Music",
text:this.globals.currentLanguage.GUI_BUTTON_DISABLE_MUSIC,v2ScreenLocation:c.getv2RenderLocation(100,170),buttonType:aa.BUTTON_NORMAL_HALF,guiArchetype:"buttonHalf"})&&a.getPlayerData().setMusicEnabled(!1):b.doButton({id:"Paused Enable Music",text:this.globals.currentLanguage.GUI_BUTTON_ENABLE_MUSIC,v2ScreenLocation:c.getv2RenderLocation(100,170),buttonType:aa.BUTTON_NORMAL_HALF,guiArchetype:"buttonHalf"})&&a.getPlayerData().setMusicEnabled(!0);a.gameSoundManager.getSoundsEnabled()?b.doButton({id:"Paused Disable Sound",
text:this.globals.currentLanguage.GUI_BUTTON_DISABLE_SOUNDS,v2ScreenLocation:c.getv2RenderLocation(300,170),buttonType:aa.BUTTON_NORMAL_HALF,guiArchetype:"buttonHalf"})&&(a.gameSoundManager.setSoundsEnabled(!1),a.getPlayerData().setSoundsEnabled(!1)):b.doButton({id:"Paused Enable Sound",text:this.globals.currentLanguage.GUI_BUTTON_ENABLE_SOUNDS,v2ScreenLocation:c.getv2RenderLocation(300,170),buttonType:aa.BUTTON_NORMAL_HALF,guiArchetype:"buttonHalf"})&&(a.gameSoundManager.setSoundsEnabled(!0),a.getPlayerData().setSoundsEnabled(!0))},
draw:function(){var a=this.gameManager,b=a.getGameController();a.drawGameSpaces();b.draw()},draw2D:function(){},handleClickEvent:function(){this.readyToUnpause&&this.gameManager.togglePause();this.readyToOpenWonderstruck&&this.gameManager.wonderstruck();this.readyToOpenTwitter&&(this.gameManager.twitter(),this.gameManager.togglePause());this.readyToOpenFacebook&&(this.gameManager.facebook(),this.gameManager.togglePause())}};sd.create=function(a,b){var c=new sd;c.gameManager=a;c.globals=b;c.readyToUnpause=
!1;c.readyToOpenWonderstruck=!1;c.readyToOpenTwitter=!1;c.readyToOpenFacebook=!1;c.handleClickEventBound=c.handleClickEvent.bind(c);return c};Va.prototype={name:"GamestatePlaying",enterState:function(){var a=this.gameManager,b=a.getGameController(),c=a.getGameCamera();b.setActive(!0);b.setModeCommand();a.onLeaveMenu();c.setModeViewScene();a=a.getPlayState();!this.currentPlayState&&a&&(a.gameStatePlayingOwner=this,this.setPlayState(void 0,a));this.currentPlayState||this.setPlayState("PlayStateNormal")},
exitState:function(){},update:function(){var a=this.gameManager;a.gameLighting.update();this.currentPlayState&&this.currentPlayState.update();a.updateGame();a.updatePerformanceMetrics();this.updateButtons();this.updateTasks()},updateButtons:function(){var a=this.gameManager,b=a.getIMGui(),c=this.globals,d=c.guiRenderer,e=c.appCurrentTime-a.gameController.appTimeFullscreenChanged;b.doButton({id:"Pause",text:"",v2ScreenLocation:d.getv2RenderLocation(116,52,"topLeft"),buttonType:aa.BUTTON_IN_GAME_TINY,
guiArchetype:"pause"})&&a.togglePause();0.5<e&&(c.graphicsDevice.fullscreen?b.doButton({id:"FullScreen",text:"",v2ScreenLocation:d.getv2RenderLocation(54,52,"topLeft"),buttonType:aa.BUTTON_IN_GAME_TINY,guiArchetype:"minimize",passive:!0})?a.gameController.setWantsToMinScreen(!0):a.gameController.setWantsToMinScreen(!1):b.doButton({id:"FullScreen",text:"",v2ScreenLocation:d.getv2RenderLocation(54,52,"topLeft"),buttonType:aa.BUTTON_IN_GAME_TINY,guiArchetype:"fullscreen",passive:!0})?a.gameController.setWantsToFullScreen(!0):
a.gameController.setWantsToFullScreen(!1));b.doButton({id:"Shop",text:void 0,v2ScreenLocation:d.getv2RenderLocation(85,113,"topLeft"),buttonType:aa.BUTTON_IN_GAME,guiArchetype:"shop"})&&(c=Wa.create(a,this.globals),a.setGameState(c));a.getGuest()&&(30<this.globals.gameCurrentTime&&ea.displayGuestAlert)&&b.doButton({id:"Register",text:void 0,v2ScreenLocation:d.getv2RenderLocation(0,52,"top"),buttonType:aa.BUTTON_IN_GAME,guiArchetype:"register"})&&(c=Xf.create(a,this.globals),a.setGameState(c));b.doButton({id:"AmberShop",
text:void 0,v2ScreenLocation:d.getv2RenderLocation(-135,-230,"bottomRight"),buttonType:aa.BUTTON_IN_GAME,guiArchetype:"shopAmberTopup"})&&(c=Wa.create(a,this.globals),a.setGameState(c));c=a.getPlayFlags();c.displayFightButton&&(b.doButton({id:"FIGHT N",text:void 0,v2ScreenLocation:d.getv2RenderLocation(85,174,"topLeft"),buttonType:aa.BUTTON_IN_GAME,guiArchetype:"fightN"})&&(ea.showTutorialScreens?e=tc.create(a,this.globals,!0):(e=sc.create(a,this.globals),e.setCampaignRegionName("N")),a.setGameState(e)),
b.doButton({id:"FIGHT E",text:void 0,v2ScreenLocation:d.getv2RenderLocation(85,235,"topLeft"),buttonType:aa.BUTTON_IN_GAME,guiArchetype:"fightE"})&&(ea.showTutorialScreens?e=tc.create(a,this.globals,!0):(e=sc.create(a,this.globals),e.setCampaignRegionName("E")),a.setGameState(e)),b.doButton({id:"FIGHT W",text:void 0,v2ScreenLocation:d.getv2RenderLocation(85,296,"topLeft"),buttonType:aa.BUTTON_IN_GAME,guiArchetype:"fightW"})&&(ea.showTutorialScreens?e=tc.create(a,this.globals,!0):(e=sc.create(a,this.globals),
e.setCampaignRegionName("W")),a.setGameState(e)));c.displaySkipPrepareButton&&b.doButton({id:"SKIP PREPARE",text:void 0,v2ScreenLocation:d.getv2RenderLocation(85,174,"topLeft"),buttonType:aa.BUTTON_IN_GAME,guiArchetype:"skipPrepare"})&&this.setPlayState("PlayStateBattle")},updateTasks:function(){var a=this.gameManager.getTaskManager();ea.runTasks&&a.update()},draw:function(){var a=this.gameManager,b=a.getGameController();a.drawGameSpaces();b.draw()},draw2D:function(){var a=this.gameManager,b=a.getGameController();
a.drawGUI();b.draw2D();this.currentPlayState&&this.currentPlayState.draw2D()},setPlayState:function(a,b){this.currentPlayState&&this.currentPlayState.deInit();b||(b=Rb.createFromName(a,this,this.globals,void 0));this.currentPlayState=b},getGameManager:function(){return this.gameManager}};Va.create=function(a,b){var c=new Va;c.gameManager=a;c.globals=b;return c};sc.prototype={name:"GamestatePrepareForCampaign",enterState:function(){var a=this.gameManager,b=a.getGameController();b.setActive(!0);b.setModeMenuScreen();
a.startPaused();a.onEnterMenu();this.warManager=this.gameManager.getHero().getGameSpace().getEntitiesWithEC("ECWarManager")[0];a.gameSoundManager.play("aud_sting_prepare_battle",null,null)},exitState:function(){var a=this.gameManager;a.exitPaused();a.eventManager.notify("CampaignPrepareScreenExited")},setCampaignRegionName:function(a){this.campaignRegionName=a},update:function(){var a=this.gameManager,b=a.getGameCamera();a.getGameController().update();b.update();var b=a.getIMGui(),c=this.globals.guiRenderer;
b.doBackground();a.getGuiManager().addDrawGui("bgPattern",{v2ScreenLocation:c.getv2RenderLocation(0,0)},"idBackgroundPatternImage");if(b=sa.doCampaignStartBookend(a,this.globals,this.warManager,this.campaignRegionName))"confirm"===b?(this.warManager.getEC("ECWarManager").beginCampaign(this.campaignRegionName),b=Va.create(a,this.globals),b.setPlayState("PlayStatePrepareForBattle"),a.setGameState(b),this.sendBeginCampaignMetric()):(b=Va.create(a,this.globals),b.setPlayState("PlayStateNormal"),a.setGameState(b))},
sendBeginCampaignMetric:function(){var a=this.globals.metricsManager,b=this.gameManager,c=this.warManager.getEC("ECWarManager").getCampaignArchetypeName(this.campaignRegionName),d=b.getHero().getEC("ECPlayerData"),e=d.getLevel(),g=b.getBuildingManager(),b=g.getBuildingCount("Outpost"),h=g.getBuildingCount("Barricade"),i=g.getBuildingCount("Turret"),g=g.getBuildingCount("Trap");a.sendGameMetric("campaignInitiated_"+c,[e,b,h,i,g]);d.sendResourceRegisterMetric()},draw:function(){var a=this.gameManager,
b=a.getGameController();a.drawGameSpaces();b.draw()},draw2D:function(){}};sc.create=function(a,b){var c=new sc;c.gameManager=a;c.globals=b;c.ecWarManager=null;return c};Uf.prototype={name:"GamestatePrepareForNextBattle",VERTICAL_ARCHETYPE_SEPARATION:40,TIME_BETWEEN_ARCHETYPES:0.5,enterState:function(){var a=this.gameManager,b=a.getGameController(),c=a.getGameCamera();b.setActive(!0);b.setModeMenuScreen();c.setModeOrbitScene();a.startPaused();this.ecWarManager=a=this.gameManager.getHero().getGameSpace().getEntitiesWithEC("ECWarManager")[0].getEC("ECWarManager");
b=a.getActiveCampaignRegionName();a.setNextBattle(b)},exitState:function(){this.gameManager.exitPaused()},update:function(){var a=this.gameManager,b=a.getGameCamera();a.getGameController().update();b.update();this.updateGui()},updateGui:function(){var a=this.globals.guiRenderer,b=this.gameManager,c=b.getIMGui();c.doBackground();c.doTitle("Get ready for the next wave!");c.doButton({id:"prepare_for_war_fight",text:this.globals.currentLanguage.GUI_BUTTON_PREPARE_FOR_WAR_CONTINUE,v2ScreenLocation:a.getv2RenderLocation(0,
300),buttonType:aa.BUTTON_NORMAL,guiArchetype:"buttonPrepareForWarContinue"})&&(a=Va.create(b,this.globals),a.setPlayState("PlayStatePrepareForBattle"),b.setGameState(a));b=this.ecWarManager.getActiveCampaignRegionName();b=this.ecWarManager.getNextBattleArchetypeQuantities(b);this.guiPrepareForWar.doArchetypeQuantities(b,-75)},draw:function(){var a=this.gameManager,b=a.getGameController();a.drawGameSpaces();b.draw()},draw2D:function(){}};Uf.create=function(a,b){var c=new Uf;c.gameManager=a;c.globals=
b;c.ecWarManager=null;return c};qi.prototype={name:"GamestateProfileGame",enterState:function(){var a=this.gameManager;a.clearGameSpaces();a.clearUserData();a.reset();this.startGame(a.isHost)},exitState:function(){this.globals.clearColor=[0,0.59375,0.609375,1]},goStraightToGame:function(){this.shouldGoStraightToGame=!0},update:function(){var a=this.gameManager,b=this.globals.gamePurchaseManager;if(!a.isHost||!a.getLoading()){if(b)b.onGameStarted();a.gameScriptManager.scriptManager.run("ProfilingScript");
this.shouldGoStraightToGame?(b=Va.create(a,this.globals),b.setPlayState("PlayStateNormal")):b=ae.create(a,this.globals);a.setGameState(b)}},draw:function(){},draw2D:function(){},startGame:function(a){var b=this.gameManager,c=this.globals,d=c.mathDevice,e=b.getGameClock(),g=b.getGameCamera();g.setDesiredPosition(d.v3Build(0,0,-1));g.setDesiredDirection(d.v3Build(1,-2.5,0));g.setDesiredFocus(d.v3Build(0,0,0));g.setDesiredFOV(60);g.snap();e.start();c.gameCurrentTime=e.getCurrentTime();c.gameTimeStep=
e.getTimeStep();a&&(a=b.getFactionManager(),a.reset(),a.setHeroFactionName("heroFaction"),a.setEnemyFactionName("enemyFaction"),a.createNewFaction("heroFaction"),a.createNewFaction("enemyFaction"),b.isHost=!0,b.loadPlayerInfo(),b.loadLevelOnStartUp());b.navManager=Yd.create(c,b)}};qi.create=function(a,b){var c=new qi;c.gameManager=a;c.globals=b;c.shouldGoStraightToGame=!0;return c};td.prototype={name:"GamestateResetGame",enterState:function(){var a=this.gameManager;a.clearGameSpaces();a.gameCamera.reset();
a.reset();this.startGame(a.isHost)},exitState:function(){this.globals.clearColor=[0,0,0,1]},setUsePlayerSaveData:function(a){this.usePlayerSave=a},update:function(){var a=this.gameManager,b=this.globals.gamePurchaseManager;if(!a.getPlayerData().getLoading()&&(this.hasToldGameManagerToLoad||(a.loadlLevelOnStartup(this.usePlayerSave),this.hasToldGameManagerToLoad=!0),!a.getLoading()))if(a.newSaveVersion&&a.playerData.resetForNewSaveVersion(),this.destroyTaskManager(),this.isPreviousTutorialInProgress())a.clearUserData(),
a.restart(!1);else{this.createTaskManager();a.gameCamera.setModeViewScene();a.gameLighting.setShadowsEnabled(a.getPlayerData().getShadowsEnabled());a.gameSoundManager.setSoundsEnabled(a.getPlayerData().getSoundsEnabled());if(b)b.onGameStarted();a.eventManager.notify("GameStarted");a.hasLoadedLevel&&(this.shouldGoStraightToGame?(b=Va.create(a,this.globals),b.setPlayState("PlayStateNormal")):b=ae.create(a,this.globals),a.setGameState(b))}},draw:function(){},draw2D:function(){},isPreviousTutorialInProgress:function(){var a=
this.gameManager.getPlayerData().getScriptFlags(),b=a.FirstCampaignTutorialScript;return a.WelcomeTutorialScript&&!b},createTaskManager:function(){var a=this.globals,b=this.gameManager,c=b.getPlayerData().getTaskFlags();b.taskManager=pf.create(a,b,c)},destroyTaskManager:function(){var a=this.gameManager.getTaskManager();a&&a.destroy()},startGame:function(a){var b=this.gameManager,c=this.globals,d=c.mathDevice,e=b.getGameClock(),g=b.getGameCamera();g.setDesiredPosition(d.v3Build(0,0,-1));g.setDesiredDirection(d.v3Build(1,
-2.5,0));g.setDesiredFocus(d.v3Build(0,0,0));g.setDesiredFOV(60);g.snap();e.start();c.gameCurrentTime=e.getCurrentTime();c.gameTimeStep=e.getTimeStep();b.loadPlayerInfo();b.getFactionManager().reset();b.navManager=Yd.create(c,b);a&&(b.isHost=!0)}};td.create=function(a,b){var c=new td;c.gameManager=a;c.globals=b;c.usePlayerSave=!0;return c};Wa.prototype={name:"GamestateShop",enterState:function(){var a=this.gameManager,b=a.gameController;b.setActive(!0);b.setModeMenuScreen();a.onEnterMenu();a.startPaused();
b.setOnMouseDownCallback(this.handleClickEventBound);this.setButtonPanal("amber");this.requiredResource=[E.NUM_RESOURCES];this.buttonFn=void 0},exitState:function(){var a=this.gameManager;a.gameController.setOnMouseDownCallback(null);a.exitPaused()},update:function(){var a=this.gameManager,b=a.gameController,a=a.getGameSoundManager();b.update();a.update();this.updateMenu()},setRequiredResource:function(a,b){this.requiredResource[a]=b;this.shortFall=this.calculateShortfall()},setGiveUserResource:function(a){this.giveUserResource=
a},setPurchaseFn:function(a){this.purchaseFn=a},sendPurchaseMetric:function(a){var b=this.globals.metricsManager;this.purchaseReason&&b.sendGameMetric("amberUsedTo_"+this.purchaseReason,a)},setPurchaseReason:function(a){this.purchaseReason=a},setButtonPanal:function(a){this.buttonList=[];this.tabList=[];var b=this;this.logo=void 0;"amber"===a&&(this.addTab({text1:"Amber Shop",guiArchetype:"shopTabAmberUp",action:function(){b.setButtonPanal("amber")}}),this.addTab({text1:"Craft Resource",guiArchetype:"shopTabCraftDown",
action:function(){b.setButtonPanal("resource")}}),this.addButton({text1:"3000 AMBER (+2000 BONUS)",text2:"AMBER HOARD (5000) \n$29.99",guiArchetype:"shopAmberHoard",action:function(){b.purchaseItem("amberpack5000Hoard")}}),this.addButton({text1:"1500 AMBER (+500 BONUS)",text2:"AMBER CHEST (2000) \n$14.99",guiArchetype:"shopAmberChest",action:function(){b.purchaseItem("amberpack2000Chest")}}),this.addButton({text1:"500 AMBER",text2:"AMBER CHUNK (500) \n$4.99",guiArchetype:"shopAmberChunk",action:function(){b.purchaseItem("amberpack500Chunk")}}),
this.addButton({showFn:function(){return!b.ownsItem("amber-crown")},text1:"DOUBLES AMBER COLLECTED",text2:"THE AMBER CROWN\n$0.99",guiArchetype:"shopItemAmbercrown",action:function(){b.purchaseItem("amberCrown")}}),this.addButton({showFn:function(){return!b.ownsItem("amber-well-owned")},text1:"100 AMBER EVERY DAY",text2:"THE AMBER WELL\n$4.99",guiArchetype:"shopItemAmberwell",action:function(){b.purchaseItem("amberWellOwned")}}));"resource"===a&&(this.addTab({text1:"Amber Shop",guiArchetype:"shopTabAmberDown",
action:function(){b.setButtonPanal("amber")}}),this.addTab({text1:"Craft Resource",guiArchetype:"shopTabCraftUp",action:function(){b.setButtonPanal("resource")}}),this.addButton({showFn:function(){return b.costAboveZeroAndNotUsed(E.STONE,0.1)},textFn:function(){return b.getFillFractionText(E.STONE,0.1)},guiArchetype:"shopStone",action:function(){b.fillFraction(E.STONE,0.1)}}),this.addButton({showFn:function(){return b.costAboveZeroAndNotUsed(E.STONE,0.5)},textFn:function(){return b.getFillFractionText(E.STONE,
0.5)},guiArchetype:"shopStone",action:function(){b.fillFraction(E.STONE,0.5)}}),this.addButton({showFn:function(){return b.costAboveZeroAndNotUsed(E.STONE,1)},textFn:function(){return b.getFillFractionText(E.STONE,1)},guiArchetype:"shopStone",action:function(){b.fillFraction(E.STONE,1)}}),this.addButton({showFn:function(){return b.costAboveZeroAndNotUsed(E.LUMBER,0.1)},textFn:function(){return b.getFillFractionText(E.LUMBER,0.1)},guiArchetype:"shopLumber",action:function(){b.fillFraction(E.LUMBER,
0.1)}}),this.addButton({showFn:function(){return b.costAboveZeroAndNotUsed(E.LUMBER,0.5)},textFn:function(){return b.getFillFractionText(E.LUMBER,0.5)},guiArchetype:"shopLumber",action:function(){b.fillFraction(E.LUMBER,0.5)}}),this.addButton({showFn:function(){return b.costAboveZeroAndNotUsed(E.LUMBER,1)},textFn:function(){return b.getFillFractionText(E.LUMBER,1)},guiArchetype:"shopLumber",action:function(){b.fillFraction(E.LUMBER,1)}}));"special"===a&&(this.addTab({text1:"Craft Resource",guiArchetype:"shopTabCraftDown",
action:function(){b.setButtonPanal("resource")}}),this.addTab({text1:"Amber Shop",guiArchetype:"shopTabAmberDown",action:function(){b.setButtonPanal("amber")}}),this.addTab({text1:"Item Shop",guiArchetype:"shopTabItemUp",action:function(){b.setButtonPanal("special")}}),this.addButton({text1:"100 AMBER EVERY DAY",text2:"AMBER WELL\n$4.99",guiArchetype:"shopItemAmberwell",action:function(){b.purchaseItem("amberWell","a_b_amberwell")}}));"convert"===a&&(this.addButton({textFn:function(){return b.getPurchasePriceText()},
guiArchetype:"modalMessageFrame"}),this.addButton({guiArchetype:"modalMessageBuy",action:function(){b.attemptPurchase()},x:0,y:0}));"purchase"===a&&(this.addButton({text1:"Not enough Amber\nGet more from the Shop!",guiArchetype:"modalMessageFrame"}),this.addButton({text1:"Purchase Amber",guiArchetype:"modalMessageBuyAmber",action:function(){b.setButtonPanal("amber")},x:0,y:0}))},ownsItem:function(a){return this.globals.gamePurchaseManager.getOwned(a)},getCostForResourceAmount:function(a){var b=this.globals.mathDevice;
return 1>a?0:50>=a?1:500>=a?Math.ceil(b.remap(50,500,1,5,a)):5E3>=a?Math.ceil(b.remap(500,5E3,5,25,a)):5E4>=a?Math.ceil(b.remap(5E3,5E4,25,125,a)):5E5>=a?Math.ceil(b.remap(5E4,5E5,125,600,a)):5E6>=a?Math.ceil(b.remap(5E5,5E6,600,3E3,a)):Math.ceil(6E-4*a)},calculateShortfall:function(){var a,b=this.gameManager.getHero();b&&(a=b.getEC("ECPlayerData"));var b=this.requiredResource,c=b.length,d,e=[];for(d=0;d<c;d+=1)void 0!==b[d]&&(e[d]=Math.max(b[d]-a.getResource(d),0));return e},getPurchasePriceText:function(){return{text1:"Not enough resource!\nBuild using "+
this.getCostForResourceAmount(this.shortFall[E.LUMBER]+this.shortFall[E.STONE]).toString()+" Amber?"}},attemptPurchase:function(){var a,b=this.gameManager.getHero();b&&(a=b.getEC("ECPlayerData"));b=this.getCostForResourceAmount(this.shortFall[E.LUMBER]+this.shortFall[E.STONE]);a.getSoftCurrency()<b?this.setButtonPanal("purchase"):(this.giveUserResource?(a.adjustResource(E.LUMBER,this.shortFall[E.LUMBER]),a.adjustResource(E.STONE,this.shortFall[E.STONE])):(a.adjustResource(E.LUMBER,-this.requiredResource[E.LUMBER]),
a.adjustResource(E.STONE,-this.requiredResource[E.STONE])),a.adjustSoftCurrency(-b),this.purchaseFn(),this.sendPurchaseMetric(b),this.exit())},getFillFractionText:function(a,b){var c,d=this.gameManager.getHero();d&&(c=d.getEC("ECPlayerData"));d=c.getResourceCap(a);c=c.getResource(a);c=Math.round(Math.min(b*d,d-c));c=this.getCostForResourceAmount(c);return{text1:"Fill by "+Math.floor(100*b).toString()+"% of total",text2:"Craft "+Za[a].string+"\n"+c.toString()+" AMBER",id:"Fill by "+Za[a].string+c.toString()}},
clearAmberCosts:function(){this.amberCosts=[];var a;for(a=0;a<E.NUM_RESOURCES;a+=1)this.amberCosts[a]=[]},costAboveZeroAndNotUsed:function(a,b){var c,d=this.gameManager.getHero();d&&(c=d.getEC("ECPlayerData"));d=c.getResourceCap(a);c=c.getResource(a);c=Math.round(Math.min(b*d,d-c));c=this.getCostForResourceAmount(c);if(this.amberCosts[a][c])return!1;this.amberCosts[a][c]=!0;return 0<c},fillFraction:function(a,b){var c,d=this.gameManager.getHero();d&&(c=d.getEC("ECPlayerData"));d=c.getResourceCap(a);
c=c.getResource(a);c=Math.round(Math.min(b*d,d-c));d=this.getCostForResourceAmount(c);this.convertAmberToResource(d,a,c)},addTab:function(a){this.tabList.push(a)},addButton:function(a){this.buttonList.push(a)},updateButton:function(a,b,c){var d=this.gameManager,e=d.getIMGui(),g=this.globals.guiRenderer,h=c.text1,i=c.text2,j=c.text3,k;if(!c.showFn||c.showFn())c.textFn&&(k=c.textFn(),h=k.text1,i=k.text2,j=k.text3,k=k.id),k||(k=h),a=g.getv2RenderLocation(a,b),void 0!==c.x&&void 0!==c.y&&(a=g.getv2RenderLocation(c.x,
c.y)),d=d.getGuiManager(),c.action?e.doButton({id:"shop"+k,text1:h,text2:i,text3:j,v2ScreenLocation:a,guiArchetype:c.guiArchetype,passive:!0})&&(this.buttonFn=c.action):d.addDrawGui(c.guiArchetype,{v2ScreenLocation:a,text1:h,text2:i}," idShop"+h)},convertAmberToResource:function(a,b,c){var d,e=this.gameManager.getHero();e&&(d=e.getEC("ECPlayerData"));d&&(d.getSoftCurrency()>=a&&d.getResource(b)<d.getResourceCap(b))&&(d.adjustSoftCurrency(-a),d.adjustResource(b,c),this.globals.metricsManager.sendGameMetric(Za[b].convertMetricName,
a))},updateMenu:function(){var a=this.gameManager,b=a.getIMGui(),c=this.globals.guiRenderer,d=a.getHero();b.doBackground();this.clearAmberCosts();a=a.getGuiManager();a.addDrawGui("bgPattern",{v2ScreenLocation:c.getv2RenderLocation(0,0)},"idBackgroundPatternImage");this.logo&&a.addDrawGui(this.logo,{v2ScreenLocation:c.getv2RenderLocation(0,-330)},"idPolycraftTitle");a=-270;this.buttonFn=void 0;b.doButton({id:"Shop Resume",text:this.globals.currentLanguage.GUI_BUTTON_PLAY,v2ScreenLocation:c.getv2RenderLocation(-100,
100,"topRight"),buttonType:aa.BUTTON_NORMAL,guiArchetype:"shopClose",passive:!0})&&(this.buttonFn=this.exit);d&&d.getEC("ECPlayerData");b=this.tabList;c=b.length;for(d=0;d<c;d+=1)this.updateButton(-143.5+277*(d/(c-1)),a+260*Math.floor(d/c),b[d]);a+=225;b=this.buttonList;c=b.length;for(d=0;d<c;d+=1)this.updateButton(-310+320*(d%3),a+260*Math.floor(d/3),b[d])},purchaseItem:function(a){var b=this.globals.gamePurchaseManager;b&&a&&b.purchaseItem(a)},draw:function(){var a=this.gameManager;a.drawGameSpaces();
a.gameController.draw()},draw2D:function(){var a=this.gameManager,b=a.getGuiScores(),a=a.getHero(),c=this.globals.guiRenderer;c.begin();b.drawResourceBar(a,E.LUMBER);b.drawResourceBar(a,E.STONE);b.drawSoftCurrency(a);c.end()},exit:function(){this.gameManager.togglePause()},handleClickEvent:function(){this.buttonFn&&this.buttonFn()}};Wa.create=function(a,b){var c=new Wa;c.gameManager=a;c.globals=b;c.readyToPlay=!1;c.handleClickEventBound=c.handleClickEvent.bind(c);return c};Vf.prototype={name:"GamestateSplashScreens",
preload:function(){var a=this.globals.textureManager,b=this.splashScreens,c,d,e=this.getSplashScreenTexturePath;if(a){b=b.length;for(c=0;c<b;c+=1)(d=e.call(this,c))&&a.load(d)}},enterState:function(){var a=TurbulenzEngine.time,b=this.gameManager.getGameController();b.setActive(!0);b.setModeSplashScreen();G.update(1E3*a);this.currentBrightness=0;this.startFadeInTween()},exitState:function(){},getCurrentSplashScreenTexturePath:function(){return this.getSplashScreenTexturePath(this.currentSplashScreenIndex)},
getSplashScreenTexturePath:function(a){var a=this.getSplashScreen(a),b;a&&(b=a.texturePath);return b},getCurrentSplashScreenDuration:function(){return this.getSplashScreenDuration(this.currentSplashScreenIndex)},getSplashScreenDuration:function(a){var a=this.getSplashScreen(a),b=0;a&&(b=a.duration);return b},getCurrentSplashScreenBrightness:function(){return this.currentBrightness},getSplashScreen:function(a){var b=this.splashScreens,c;b&&(c=b[a]);return c},getNumSplashScreens:function(){var a=0,
b=this.splashScreens;b&&(a=b.length);return a},update:function(){var a=TurbulenzEngine.time,b=this.gameManager.getGameController();b&&b.update();G.update(1E3*a)},skipCurrentSplashScreen:function(){var a=TurbulenzEngine.time,b=!1;this.fadeInTween&&this.fadeInTween.stop();this.fadeOutTween&&(this.fadeOutTween.hasStarted(1E3*a)?b=!0:this.fadeOutTween.stop());b||this.startFadeOutTween(0)},onSplashScreenFinishedFadingIn:function(){var a=this.getCurrentSplashScreenDuration();this.fadeInTween=null;this.currentBrightness=
1;this.startFadeOutTween(a)},onSplashScreenFinishedFadingOut:function(){var a=this.currentSplashScreenIndex;this.fadeOutTween=null;this.currentBrightness=0;a>=this.getNumSplashScreens()-1?this.goToStartScreen():this.startNextSplashScreen()},goToStartScreen:function(){var a=this.gameManager,b;a&&(b=td.create(a,this.globals),a.setGameState(b))},startNextSplashScreen:function(){this.currentSplashScreenIndex+=1;this.startFadeInTween()},startFadeInTween:function(){var a=this,b=TurbulenzEngine.time,c=this.splashScreenFadeInTime;
this.fadeInTween=G.Create({brightness:0}).to({brightness:1},c).easing(G.Easing.Quadratic.InOut).onUpdate(function(){a.currentBrightness=this.brightness}).onComplete(function(){a.onSplashScreenFinishedFadingIn()}).start(1E3*b)},startFadeOutTween:function(a){var b=this,c=TurbulenzEngine.time,d=this.currentBrightness,e=this.splashScreenFadeOutTime*d;this.fadeOutTween=G.Create({brightness:d}).to({brightness:0},e).easing(G.Easing.Quadratic.InOut).delay(a).onUpdate(function(){b.currentBrightness=this.brightness}).onComplete(function(){b.onSplashScreenFinishedFadingOut()}).start(1E3*
c)},draw:function(){},draw2D:function(){var a=this.globals,b=a.draw2D,c=a.graphicsDevice,d=a.textureManager,e,g,h,i;b&&(c&&d)&&(a=c.width,g=c.height,c=0.5*a,a=0.5*g,d=d.get(this.getCurrentSplashScreenTexturePath()),e=this.getCurrentSplashScreenBrightness(),d&&(h=d.width,i=d.height,0<h&&0<i&&(g*=0.5,h=g*(h/i),b.begin("alpha","texture"),b.draw({texture:d,destinationRectangle:[c-h,a-g,c+h,a+g],color:[e,e,e,1]}),b.end())))}};Vf.create=function(a,b){var c=new Vf;c.gameManager=a;c.globals=b;c.splashScreens=
[{texturePath:"textures/wonderstruck_splash_screen.jpg",duration:1},{texturePath:"textures/polycraft_splash_screen.jpg",duration:1.5}];c.currentSplashScreenIndex=0;c.currentBrightness=0;c.splashScreenFadeInTime=0.15;c.splashScreenFadeOutTime=0.15;c.fadeInTween=null;c.fadeOutTween=null;return c};ae.prototype={name:"GamestateStartScreen",enterState:function(){var a=this.gameManager,b=a.getGameController();b.setActive(!0);b.setModeMenuScreen();a.onEnterMenu();this.globals.metricsManager.sendMetric("startScreen",
1,!1);a.startPaused();b.setOnMouseDownCallback(this.handleClickEventBound);this.newsText=ea.newsText},exitState:function(){var a=this.gameManager;a.getGameController().setOnMouseDownCallback(null);a.exitPaused()},update:function(){var a=this.gameManager,b=a.getGameController(),c=a.getGameCamera();a.gameLighting.update();b.update();c.update();this.updateMenu()},updateMenu:function(){var a=this.gameManager,b=a.getIMGui(),c=this.globals.guiRenderer,d;b.doBackground();var e=a.getGuiManager();e.addDrawGui("bgPattern",
{v2ScreenLocation:c.getv2RenderLocation(0,0)},"idBackgroundPatternImage");e.addDrawGui("polycraftLogo",{v2ScreenLocation:c.getv2RenderLocation(0,-260)},"idPolycraftTitle");this.readyToPlay=b.doButton({id:"Play",text:this.globals.currentLanguage.GUI_BUTTON_PLAY,v2ScreenLocation:c.getv2RenderLocation(-220,-70),buttonType:aa.BUTTON_NORMAL,guiArchetype:"buttonStart",passive:!0});b.doButton({id:"Go to Shop Amber",text:this.globals.currentLanguage.GUI_BUTTON_GO_TO_SHOP,v2ScreenLocation:c.getv2RenderLocation(-220,
50),buttonType:aa.BUTTON_NORMAL,guiArchetype:"buttonShop"})&&(d=Wa.create(a,this.globals),a.setGameState(d),d.setButtonPanal("amber"));this.readyToOpenWonderstruck=b.doButton({id:"Go to Wonderstruck",text:"WONDERSTRUCK",v2ScreenLocation:c.getv2RenderLocation(-220,170),buttonType:aa.BUTTON_NORMAL,guiArchetype:"buttonWonderstruck",passive:!0});wa.offline||(this.readyToOpenTwitter=b.doButton({id:"Paused Twitter Share",text:"SHARE",text2:"Get "+this.gameManager.getShareReward()+" Amber!",v2ScreenLocation:c.getv2RenderLocation(-320,
290),buttonType:aa.BUTTON_NORMAL_HALF,guiArchetype:this.gameManager.validToRewardShare("twitter")?"buttonShareTwitterReward":"buttonShareTwitter",passive:!0}),this.readyToOpenFacebook=b.doButton({id:"Paused Facebook Share",text:"SHARE",text2:"Get "+this.gameManager.getShareReward()+" Amber!",v2ScreenLocation:c.getv2RenderLocation(-120,290),buttonType:aa.BUTTON_NORMAL_HALF,guiArchetype:this.gameManager.validToRewardShare("facebook")?"buttonShareFacebookReward":"buttonShareFacebook",passive:!0}));e.addDrawGui("newsBox",
{v2ScreenLocation:c.getv2RenderLocation(220,100),text:this.newsText},"idNews")},draw:function(){var a=this.gameManager,b=a.getGameController();a.drawGameSpaces();b.draw()},draw2D:function(){},handleClickEvent:function(){var a=this.gameManager,b;this.readyToPlay&&(ea.showTutorialScreens?(b=tc.create(a,this.globals,!1),a.setGameState(b)):this.gameManager.togglePause());this.readyToOpenWonderstruck&&this.gameManager.wonderstruck();this.readyToOpenTwitter&&(this.gameManager.twitter(),this.gameManager.togglePause());
this.readyToOpenFacebook&&(this.gameManager.facebook(),this.gameManager.togglePause())}};ae.create=function(a,b){var c=new ae;c.gameManager=a;c.globals=b;c.readyToPlay=!1;c.readyToOpenWonderstruck=!1;c.readyToOpenTwitter=!1;c.readyToOpenFacebook=!1;c.handleClickEventBound=c.handleClickEvent.bind(c);return c};Wf.prototype={name:"GamestateSyncing",MIN_POST_SYNC_DELAY:1,enterState:function(){var a=this.gameManager,b=a.getGameController(),c=a.getGameCamera();b.setActive(!0);b.setModeMenuScreen();a.onEnterMenu();
c.setModeOrbitScene();a.startPaused()},exitState:function(){this.gameManager.exitPaused()},update:function(){var a=this.gameManager,b=a.getGameCamera(),c=a.getGameController(),d=a.getGameSoundManager();c.update();a.gameLighting.update();b.update();d.update();b=a.getIMGui();c=this.globals;d=c.guiRenderer;b.doBackground();a.getGuiManager().addDrawGui("bgPattern",{v2ScreenLocation:d.getv2RenderLocation(0,0)},"idBackgroundPatternImage");b.doText("Syncing with Turbulenz servers...",d.getv2RenderLocation(0,
0),32,1);b=c.appCurrentTime;null!==this.endOfSyncTime?b-this.endOfSyncTime>=this.MIN_POST_SYNC_DELAY&&(b=sd.create(a,this.globals),a.setGameState(b)):wa.syncing||(this.endOfSyncTime=b)},draw:function(){var a=this.gameManager,b=a.getGameController();a.drawGameSpaces();b.draw()},draw2D:function(){}};Wf.create=function(a,b){var c=new Wf;c.gameManager=a;c.globals=b;c.endOfSyncTime=null;return c};ri.prototype={name:"GamestateTaskComplete",enterState:function(){var a=this.gameManager,b=a.getGameController(),
c=a.getGameCamera();b.setActive(!0);b.setModeMenuScreen();a.onEnterMenu();c.setModeOrbitScene();a.startPaused()},exitState:function(){this.gameManager.exitPaused()},update:function(){var a=this.gameManager,b=a.getGameCamera();a.getGameController().update();b.update();this.updateMenu()},updateMenu:function(){var a=this.gameManager,b=a.getIMGui(),c=this.globals,d=c.guiRenderer;b.doBackground();b=a.getGuiManager();d={v2ScreenLocation:d.getv2RenderLocation(0,0)};b.addDrawGui("bgPattern",d,"idBackgroundPatternImage");
sa.doTaskComplete(a,c,this.taskArchetype)&&(c=Va.create(a,this.globals),a.setGameState(c))},setTaskArchetype:function(a){this.taskArchetype=a},draw:function(){var a=this.gameManager,b=a.getGameController();a.drawGameSpaces();b.draw()},draw2D:function(){}};ri.create=function(a,b){var c=new ri;c.gameManager=a;c.globals=b;return c};si.prototype={name:"GamestateTaskDescription",enterState:function(){var a=this.gameManager,b=a.getGameController(),c=a.getGameCamera();b.setActive(!0);b.setModeMenuScreen();
a.onEnterMenu();c.setModeOrbitScene();a.startPaused()},exitState:function(){this.gameManager.exitPaused()},update:function(){var a=this.gameManager,b=a.getGameCamera();a.getGameController().update();b.update();this.updateMenu()},updateMenu:function(){var a=this.gameManager,b=a.getIMGui(),c=this.globals,d=c.guiRenderer;b.doBackground();b=a.getGuiManager();d={v2ScreenLocation:d.getv2RenderLocation(0,0)};b.addDrawGui("bgPattern",d,"idBackgroundPatternImage");sa.doTaskDescription(a,c,this.taskArchetype)&&
(c=Va.create(a,this.globals),a.setGameState(c))},setTaskArchetype:function(a){this.taskArchetype=a},draw:function(){var a=this.gameManager,b=a.getGameController();a.drawGameSpaces();b.draw()},draw2D:function(){}};si.create=function(a,b){var c=new si;c.gameManager=a;c.globals=b;return c};Xf.prototype={name:"GamestateRegister",enterState:function(){var a=this.gameManager,b=a.getGameController(),c=a.getGameCamera();b.setActive(!0);b.setModeMenuScreen();a.onEnterMenu();c.setModeOrbitScene();a.startPaused();
b.setOnMouseDownCallback(this.handleClickEventBound)},exitState:function(){var a=this.gameManager;a.getGameController().setOnMouseDownCallback(null);a.exitPaused()},update:function(){var a=this.gameManager,b=a.getGameCamera(),c=a.getGameController(),d=a.getGameSoundManager();c.update();a.gameLighting.update();b.update();d.update();this.updateMenu()},updateMenu:function(){var a=this.gameManager,b=a.getIMGui(),c=this.globals.guiRenderer;b.doBackground();a=a.getGuiManager();a.addDrawGui("bgPattern",
{v2ScreenLocation:c.getv2RenderLocation(0,0)},"idBackgroundPatternImage");TurbulenzEngine.canvas?(a.addDrawGui("registerConfirmation",{v2ScreenLocation:c.getv2RenderLocation(0,0)},"idRegisterConfirmation"),this.readyToQuitAndRegister=b.doButton({id:"idRegisterOK",text:"REGISTER!",v2ScreenLocation:c.getv2RenderLocation(0,150,"centre"),buttonType:aa.DIALOG_OK,guiArchetype:"registerOK",passive:!0})):a.addDrawGui("registerInstruction",{v2ScreenLocation:c.getv2RenderLocation(0,0)},"idRegisterInstruction");
this.readyToUnpause=b.doButton({id:"Register Resume",text:this.globals.currentLanguage.GUI_BUTTON_PLAY,v2ScreenLocation:c.getv2RenderLocation(-100,100,"topRight"),buttonType:aa.BUTTON_NORMAL,guiArchetype:"shopClose",passive:!0})},draw:function(){var a=this.gameManager,b=a.getGameController();a.drawGameSpaces();b.draw()},draw2D:function(){},handleClickEvent:function(){this.readyToUnpause&&this.gameManager.togglePause();this.readyToQuitAndRegister&&TurbulenzEngine.canvas&&window.app.currentUser.checkGuest()}};
Xf.create=function(a,b){var c=new Xf;c.gameManager=a;c.globals=b;c.readyToUnpause=!1;c.handleClickEventBound=c.handleClickEvent.bind(c);return c};tc.prototype={name:"GamestateTutorial",enterState:function(){var a=this.gameManager,b=a.getGameController(),c=a.getGameCamera();b.setActive(!0);b.setModeMenuScreen();a.onLeaveMenu();c.setModeOrbitScene();a.startPaused();this.archetypeIndex=0},exitState:function(){this.gameManager.exitPaused()},update:function(){var a=this.gameManager,b=a.getGameCamera();
a.getGameController().update();a.gameLighting.update();b.update();this.updateMenu()},updateMenu:function(){var a=this.gameManager,b=a.getIMGui(),c=this.globals.guiRenderer;b.doBackground();a=a.getGuiManager();a.addDrawGui("bgPattern",{v2ScreenLocation:c.getv2RenderLocation(0,0)},"idBackgroundPatternImage");a.addDrawGui(this.archetypeList[this.archetypeIndex],{v2ScreenLocation:c.getv2RenderLocation(0,0)},"idTutorialScreen"+this.archetypeIndex);if(b.doButton({id:"Tutorial Ok"+this.archetypeIndex,text:this.archetypeIndex<
this.archetypeList.length-1?"Okay":"Let\u2019s play!",v2ScreenLocation:c.getv2RenderLocation(-130,-50,"bottomRight"),buttonType:aa.DIALOG_OK,guiArchetype:"tutorialButtonOk"}))this.archetypeIndex+=1,this.archetypeIndex>=this.archetypeList.length&&this.goToNextState()},goToNextState:function(){var a=this.gameManager;if(this.fightOnly){var b=sc.create(a,this.globals);a.setGameState(b)}else this.gameManager.togglePause()},draw:function(){var a=this.gameManager,b=a.getGameController();a.drawGameSpaces();
b.draw()},draw2D:function(){}};tc.create=function(a,b,c){var d=new tc;d.gameManager=a;d.globals=b;d.archetypeList=[];c?(d.archetypeList.push("tutorialFight"),d.fightOnly=!0):(d.archetypeList.push("tutorialBuild"),d.archetypeList.push("tutorialFight"));return d};var nb=fd.extend({specialCreationMap:[],specialName:"SpecialBase",init:function(a){void 0===nb.prototype.globals&&(nb.prototype.globals=a)},attach:function(a){this.entity=a;void 0===nb.prototype.gameManager&&(nb.prototype.gameManager=a.gameManager)},
begin:function(){},update:function(){},end:function(){},isFinished:function(){return!0},draw:function(){},drawReady:function(){},drawRadius:function(a,b){var c=this.globals,d=c.mathDevice,e=c.simpleSpriteRenderer,g=Math.PI,h=d.clamp(7*b,5,30),h=Math.floor(h),i=2*g/h,j,c=0.125*c.gameCurrentTime,k=1,l=1,m=1,q=d.v3BuildYAxis();if(j=this.entity.getEC("ECHero"))k=2*j.r,l=2*j.g,m=2*j.b;for(j=0;j<h;j+=1)e.addSprite({v3Location:a,size:0.15,out:q,blendStyle:ua.prototype.blendStyle.NORMAL_NO_Z,texture:"textures/vertical.dds",
v4color:d.v4Build(k,l,m,1),angle:c+j*i+0.5*g,offsetAngle:c+j*i,offsetY:1*b})},drawDebug:function(){this.globals.debugDraw.drawDebugPoint(this.entity.v3Location,0,0,1)},getName:function(){return this.specialName},destroy:function(){}});nb.createFromName=function(a,b,c){return nb.prototype.specialCreationMap[a].create(b,c)};nb.create=function(a,b){return new nb(a,b)};var di=nb.extend({specialCreationMap:[],quickDraw:"QuickDraw",specialHeight:3,riseDuration:1,fallDuration:0.5,init:function(a,b){this._super(a,
b);this.previousTargetIndex=0},attach:function(a){this._super(a)},begin:function(){this._super();var a=this.entity,b=a.getEC("ECFirearm"),c=a.getEC("ECPhysicsSphere");(a=a.getEC("ECLocomotion"))&&a.setActive(!1);c.reset();c.setUseGravity(!1);this.originalAmmo=b.getAmmo();b.instantReload(20);b.setOverloadProjectile("PROJECTILE_TYPE_BULLET_SUPER");b.setAmmoVisible(!1);this.originalMaxRange=b.getMaxRange();b.setMaxRange(this.rangeMultiplier*this.originalMaxRange);this.originalRechamberDuration=b.getRechamberDuration();
b.setRechamberDuration(this.rechamberDurationMultiplier*this.originalRechamberDuration);this.startSpecial()},startSpecial:function(){var a=this.globals.mathDevice,b=this,c=this.entity,d=c.getEC("ECMesh"),e=a.v3Copy(c.getv3Location()),g={y:e[1]+this.specialHeight,ry:2.25*Math.PI},h=this.riseDuration;G.Create({y:e[1],ry:0}).to(g,h).easing(G.Easing.Circular.Out).onUpdate(function(){c.setv3Location(a.v3Build(e[0],this.y,e[2]));d.setRotationY(this.ry)}).onComplete(function(){b.isShootPhase=!0;b.raisedPosition=
a.v3Copy(c.getv3Location());b.findTargets()}).start()},endSpecial:function(){var a=this.globals.mathDevice,b=this,c=this.entity,d=a.v3Copy(c.getv3Location()),e=c.getEC("ECFirearm"),g={y:d[1],ry:2.25*-Math.PI},h={y:d[1]-this.specialHeight,ry:2.5*-Math.PI},i=this.fallDuration;this.isShootPhase=!1;e.setOverloadProjectile(void 0);G.Create(g).to(h,i).easing(G.Easing.Circular.In).onUpdate(function(){c.setv3Location(a.v3Build(d[0],this.y,d[2]))}).onComplete(function(){b.finished=!0}).start()},update:function(){this._super();
this.isShootPhase&&this.updateQuickDraw()},updateQuickDraw:function(){var a=this.entity.getEC("ECFirearm"),b=this.targetList.length,c,d,e=!1,g=0,h=!1;if(b){if(a.getCanFire())for(;!e;){if(g>=b){h=!0;break}c=this.getNextTarget();d=c.getv3Location();g+=1;if(!c.toBeDestroyed&&a.isWithinRange(d)&&(e=!0,a.attemptFire(c),0===a.getVisibleAmmoCount())){h=!0;break}}}else h=!0;(h||!b)&&this.endSpecial()},findTargets:function(){var a=this.gameManager,b=this.entity,c=b.getv3Location(),d=b.getEC("ECFirearm"),b=
d.getMaxRange(),a=a.getGameSpace(c).getEntitiesInRadius(c,b),c=a.length,e=this.targetList,g,h;for(h=e.length=0;h<c;h+=1)b=a[h],g=b.getv3Location(),b.hasEC("ECHealth")&&(!b.hasEC("ECHero")&&d.isWithinRange(g))&&e.push(b)},getNextTarget:function(){var a=this.targetList,b=this.previousTargetIndex+1;b>=this.targetList.length&&(b=0);this.previousTargetIndex=b;return a[b]},end:function(){this._super();var a=this.entity,b=a.getEC("ECFirearm"),c=a.getEC("ECPhysicsSphere");(a=a.getEC("ECLocomotion"))&&a.setActive(!0);
b.setMaxRange(this.originalMaxRange);b.setRechamberDuration(this.originalRechamberDuration);b.instantReload(this.originalAmmo);b.setAmmoVisible(!0);c.reset();c.setUseGravity(!0);this.targetList.length=0;this.finished=!1},isFinished:function(){return this.finished},draw:function(){},drawReady:function(a){this.originalMaxRange=this.entity.getEC("ECFirearm").getMaxRange();this.drawRadius(a.getv3Location(),this.rangeMultiplier*this.originalMaxRange)},drawDebug:function(){},destroy:function(){this._super()}});
di.create=function(a,b){var c=new di(a,b);c.rangeMultiplier=b.rangeMultiplier;c.rechamberDurationMultiplier=b.rechamberDurationMultiplier;c.originalMaxRange=null;c.originalRechamberDuration=null;c.originalAmmo=null;c.targetList=[];c.previousTargetIndex=null;c.finished=!1;c.raisedPosition=null;return c};nb.prototype.specialCreationMap[di.prototype.quickDraw]=di;var ei=nb.extend({specialCreationMap:[],specialStomp:"SpecialStomp",init:function(a,b){this._super(a,b);this.damageType="DAMAGE_TYPE_STOMP"},
attach:function(a){this._super(a)},begin:function(){this._super();var a=this.entity,b=a.getEC("ECLocomotion");b&&b.setActive(!1);var c=this.entity.getEC("ECMesh");c.setRotationX(0);c.setRotationZ(0);var d=this.globals.mathDevice,e=this,g=d.v3Copy(a.getv3Location());this.stompTween=G.Create({y:g[1]+3,rz:2.25*Math.PI}).to({y:g[1],rz:2.5*Math.PI},0.25).easing(G.Easing.Circular.In).onUpdate(function(){a.setv3Location(d.v3Build(g[0],this.y,g[2]));c.setRotationZ(this.rz)}).onComplete(function(){e.stompTween=
void 0});G.Create({y:g[1],rz:0.5*-Math.PI}).to({y:g[1]+3,rz:2.25*Math.PI},0.5).easing(G.Easing.Circular.Out).onUpdate(function(){a.setv3Location(d.v3Build(g[0],this.y,g[2]));c.setRotationZ(this.rz)}).chain(this.stompTween).start()},update:function(){this._super()},end:function(){this._super();var a=this.gameManager,b=a.damager,a=a.actionManager,c=this.globals.mathDevice.v3Copy(this.entity.getv3Location());b.archetypes[this.damageType].applyToArea(this.entity,null,c);b={archetype:"stomp",v3Location:c};
this.entity.isManagedByThisMachine()&&a.addAction("VisualEffect",b);(b=this.entity.getEC("ECLocomotion"))&&b.setActive(!0);this.entity.playSound("stomp")},isFinished:function(){return!this.stompTween},draw:function(){},drawReady:function(a){var b=this.gameManager.damager;this.drawRadius(a.getv3Location(),b.archetypes[this.damageType].radius)},drawDebug:function(){},destroy:function(){this._super()}});ei.create=function(a,b){return new ei(a,b)};nb.prototype.specialCreationMap[ei.prototype.specialStomp]=
ei;var zb=fd.extend({meleeAttackCreationMap:[],attackName:"MeleeAttackBase",init:function(a){this.globals=a;this.ecMelee=null;this.usesHardImpactWithSceneryCallback=!1},attach:function(a){this.ecMelee=a.getEC("ECMelee")},begin:function(){},update:function(){},end:function(){},isFinished:function(){return!0},draw:function(){},drawDebug:function(){},getEntity:function(){var a=this.ecMelee,b=null;a&&(b=a.entity);return b},getName:function(){return this.attackName},getSpeedMod:function(){return 1},onImpact:function(){},
onHardImpactWithScenery:function(){},destroy:function(){}});zb.createFromName=function(a,b,c){return zb.prototype.meleeAttackCreationMap[a].create(b,c)};zb.create=function(a,b){return new zb(a,b)};var fi=zb.extend({meleeAttackCreationMap:[],attackName:"MeleeCharge",init:function(a,b){this._super(a,b);this.usesHardImpactWithSceneryCallback=!0;this.chargeSpeedMod=b&&void 0!==b.chargeSpeedMod?b.chargeSpeedMod:3;this.leanDuration=b&&void 0!==b.leanDuration?b.leanDuration:1;this.recoveryDuration=b&&void 0!==
b.recoveryDuration?b.recoveryDuration:1;this.chargeDistance=b&&void 0!==b.chargeDistance?b.chargeDistance:1;this.chargingForwards=!1;this.minChargeTime=0.1;this.maxChargeTime=2;this.chargeTimeRemaining=0;this.recovering=!1;this.leanFactor=this.recoveryTimeRemaining=0;this.damageInterval=0.1;this.damageTimeRemaining=0;this.damagedEntities=[];this.v3ChargeDirection=this.v3TargetLocation=void 0},attach:function(a){this._super(a)},begin:function(){this._super();var a=this.globals.mathDevice,b=this.ecMelee,
c=this.getEntity(),d=this.chargeDistance;this.leanFactor=0;this.recovering=this.chargingForwards=!1;this.damagedEntities.length=0;if(b&&c){void 0===d&&(d=b.attackRange);b=b.targetEntity;this.v3TargetLocation=a.v3Copy(b.getv3Location(),this.v3TargetLocation);this.v3ChargeDirection=a.v3Sub(this.v3TargetLocation,c.getv3Location(),this.v3ChargeDirection);this.v3ChargeDirection[1]=0;a.v3Normalize(this.v3ChargeDirection,this.v3ChargeDirection);this.v3TargetLocation=a.v3AddScalarMul(c.getv3Location(),this.v3ChargeDirection,
d,this.v3TargetLocation);(a=c.getEC("ECNav"))&&a.endPath();if(a=c.getEC("ECLocomotion"))a.clearDestination(),a.clearDestinationEntity();if(a=c.getEC("ECPhysicsSphere"))a.clearAcceleration(),a.clearVelocity();c=c.getEC("ECMesh");c.setRotationX(0);c.setRotationZ(0);var e=this;this.leanForwardTween=G.Create({leanFactor:1}).to({leanFactor:0},0.1).easing(G.Easing.Circular.Out).onUpdate(function(){e.leanFactor=this.leanFactor}).onComplete(function(){e.leanForwardTween=void 0;e.startChargingForwards()});
this.leanBackTween=G.Create({leanFactor:this.leanFactor}).to({leanFactor:1},this.leanDuration).easing(G.Easing.Circular.Out).onUpdate(function(){e.leanFactor=this.leanFactor}).onComplete(function(){e.leanBackTween=void 0}).chain(this.leanForwardTween).start()}},update:function(){this._super();this.applyLeanFactorToMesh();this.chargingForwards?(this.updateChargeDamage(),this.updateChargingForwards()):this.recovering&&this.updateRecovery()},updateChargeDamage:function(){this.damageTimeRemaining-=this.globals.gameTimeStep;
0>=this.damageTimeRemaining&&(this.applyChargeDamage(),this.damageTimeRemaining=this.damageInterval)},applyChargeDamage:function(){var a=this.ecMelee,b=!1;a&&(b=a.dealRadialDamage(this.damagedEntities))&&a.playSound(a.attackImpactSound)},updateChargingForwards:function(){var a=this.globals,b=a.mathDevice,c=this.getEntity();this.chargeTimeRemaining-=a.gameTimeStep;0>=this.chargeTimeRemaining?this.stopChargingForwards():c&&(a=b.v3Distance2DSq(c.getv3Location(),this.v3TargetLocation),1.6>=a&&this.stopChargingForwards())},
startChargingForwards:function(){var a=this.getEntity();this.chargingForwards=!0;this.chargeTimeRemaining=this.maxChargeTime;this.damageTimeRemaining=this.damageInterval;a&&!a.toBeDestroyed&&(a=a.getEC("ECLocomotion"))&&a.setDestination(this.v3TargetLocation)},onImpact:function(a){var b=!1;a&&(a.hasEC("ECPhysicsCube")?b=!0:(a=a.getEC("ECPhysicsSphere"))&&a.isFixed()&&(b=!0));if(b)this.onHitSolidObject()},onHardImpactWithScenery:function(a){if(a&&Math.abs(0.5>a[1]))this.onHitSolidObject()},onHitSolidObject:function(){var a=
this.ecMelee;if(this.chargingForwards&&this.chargeTimeRemaining<=this.maxChargeTime-this.minChargeTime&&(this.applyChargeDamage(),this.stopChargingForwards(),a&&a.playSound(a.attackImpactSound),(a=this.getEntity())&&!a.shouldBeDestroyed()))if(a=a.getEC("ECAgent"))a.onCrashedIntoSolidObject()},getSpeedMod:function(){return this.chargingForwards?this.chargeSpeedMod:this._super()},stopChargingForwards:function(){var a=this.getEntity();this.chargingForwards&&(this.chargingForwards=!1,this.chargeTimeRemaining=
0,a&&(a=a.getEC("ECLocomotion"))&&a.clearDestination(),this.startRecovery())},startRecovery:function(){this.recovering||(this.recovering=!0,this.recoveryTimeRemaining=this.recoveryDuration)},updateRecovery:function(){this.recoveryTimeRemaining-=this.globals.gameTimeStep;0>=this.recoveryTimeRemaining&&this.endRecovery()},endRecovery:function(){this.recovering&&(this.recovering=!1,this.recoveryTimeRemaining=0)},applyLeanFactorToMesh:function(){var a=this.getEntity(),b=this.leanFactor;a&&b&&(a=a.getEC("ECLocomotion"))&&
a.setAdditionalX(0.75*b)},end:function(){var a=this.getEntity();this._super();this.leanFactor=0;this.applyLeanFactorToMesh();this.recovering=this.chargingForwards=!1;a&&(a=a.getEC("ECPhysicsSphere"))&&a.clearVelocity()},isFinished:function(){return!this.leanBackTween&&!this.leanForwardTween&&!this.chargingForwards&&!this.recovering},draw:function(){},drawDebug:function(){},destroy:function(){this._super()}});fi.create=function(a,b){return new fi(a,b)};zb.prototype.meleeAttackCreationMap[fi.prototype.attackName]=
fi;var gi=zb.extend({meleeAttackCreationMap:[],attackName:"MeleeExplode",init:function(a,b){this._super(a,b)},attach:function(a){this._super(a)},begin:function(){this._super();var a=this.getEntity().getEC("ECLocomotion");a&&a.setActive(!1)},update:function(){this._super()},end:function(){var a=this.getEntity(),b;this._super();a&&((b=a.getEC("ECLocomotion"))&&b.setActive(!0),(a=a.getEC("ECHealth"))&&a.killSelf())},isFinished:function(){return!0},draw:function(){},drawDebug:function(){},destroy:function(){this._super()}});
gi.create=function(a,b){return new gi(a,b)};zb.prototype.meleeAttackCreationMap[gi.prototype.attackName]=gi;var hi=zb.extend({meleeAttackCreationMap:[],attackName:"MeleeStomp",init:function(a,b){this._super(a,b)},attach:function(a){this._super(a)},begin:function(){this._super();var a=this.ecMelee,b=this.getEntity();if(a&&b){var a=a.attackDuration,c=b.getEC("ECLocomotion");c&&c.setActive(!1);(c=b.getEC("ECPhysicsSphere"))&&c.setUseGravity(!1);var d=b.getEC("ECMesh");d.setRotationX(0);d.setRotationZ(0);
var e=this.globals.mathDevice,g=this,h=e.v3Copy(b.getv3Location());this.stompTween=G.Create({y:h[1]+2,rz:2.25*Math.PI}).to({y:h[1],rz:2.5*Math.PI},0.25).easing(G.Easing.Circular.In).onUpdate(function(){b.setv3Location(e.v3Build(h[0],this.y,h[2]));d.setRotationX(this.rz)}).onComplete(function(){g.stompTween=void 0});G.Create({y:h[1],rz:0.5*-Math.PI}).to({y:h[1]+2,rz:2.25*Math.PI},a).easing(G.Easing.Circular.Out).onUpdate(function(){b.setv3Location(e.v3Build(h[0],this.y,h[2]));d.setRotationX(this.rz)}).chain(this.stompTween).start()}},
update:function(){this._super()},end:function(){var a=this.globals,b=a.mathDevice,c=a.gameManager.actionManager,a=this.getEntity(),d=this.ecMelee;this._super();d&&d.dealDamage();a&&(b&&c)&&(b=b.v3Copy(a.getv3Location()),a.isManagedByThisMachine()&&(b={archetype:"stomp",v3Location:b},c.addAction("VisualEffect",b)),(c=a.getEC("ECLocomotion"))&&c.setActive(!0),(c=a.getEC("ECPhysicsSphere"))&&c.setUseGravity(!0),(c=a.getEC("ECPhysicsSphere"))&&c.clearVelocity(),a.playSound("stomp"))},isFinished:function(){return!this.stompTween},
draw:function(){},drawDebug:function(){},destroy:function(){this._super()}});hi.create=function(a,b){return new hi(a,b)};zb.prototype.meleeAttackCreationMap[hi.prototype.attackName]=hi;var ii=zb.extend({meleeAttackCreationMap:[],attackName:"MeleeSwing",init:function(a,b){this._super(a,b);this.attackBackTween=this.attackInTween=this.attackOutTween=null;this.leanFactor=0},attach:function(a){this._super(a)},begin:function(){var a=this.ecMelee,b=this,c;this._super();a&&(c=a.attackDuration,this.attackBackTween=
G.Create({leanFactor:-1.5}).to({leanFactor:0},0.25*c).easing(G.Easing.Circular.InOut).onUpdate(function(){b.leanFactor=this.leanFactor}).onComplete(function(){b.attackBackTween=void 0;b.leanFactor=void 0}),this.attackInTween=G.Create({leanFactor:1}).to({leanFactor:-1.5},c).easing(G.Easing.Circular.InOut).onUpdate(function(){b.leanFactor=this.leanFactor}).onComplete(function(){b.attackInTween=void 0;a&&a.dealDamage()}).chain(this.attackBackTween),this.attackOutTween=G.Create({leanFactor:this.leanFactor}).to({leanFactor:1},
0.25*c).easing(G.Easing.Circular.Out).onUpdate(function(){b.leanFactor=this.leanFactor}).onComplete(function(){b.attackOutTween=void 0}).chain(this.attackInTween).start())},update:function(){this._super();this.applyLeanFactorToMesh()},applyLeanFactorToMesh:function(){var a=this.getEntity(),b=this.leanFactor;if(a&&b&&(a=a.getEC("ECLocomotion")))a.setAdditionalX(0.75*b),a.setAdditionalY(0.5*b)},end:function(){this._super()},isFinished:function(){return!this.attackBackTween},draw:function(){},drawDebug:function(){},
destroy:function(){this._super()}});ii.create=function(a,b){return new ii(a,b)};zb.prototype.meleeAttackCreationMap[ii.prototype.attackName]=ii;Da.prototype={getAIActionInstance:function(a,b,c){return Da.aiActions[a].create(this.globals,b,c)}};Da.aiActions={};Da.create=function(a){var b=new Da;b.globals=a;return b};Fa=fd.extend({actionName:"No Action Name",init:function(a,b){this.globals=a;this.owner=b},canDoAction:function(){},reset:function(){},deInit:function(){},update:function(){},abort:function(){}});
Fa.create=function(a,b,c){return new Fa(a,b,c)};var Vi=Fa.extend({actionName:"Choose Builder",init:function(a,b,c){this._super(a,b,c);this.scaffoldType=c.scaffoldType||"normal";this.minimumTimeBetweenChecks=1;this.normalOrderName="Assist With Building";this.warOrderName="Assist With WarBuilding";this.lastCheckTime=void 0},canDoAction:function(){var a=this.owner,b=!1;if(void 0===this.lastCheckTime||this.globals.gameCurrentTime-this.lastCheckTime>=this.minimumTimeBetweenChecks)a&&(a.canAssistWithBuilding()&&
!a.getTargetScaffold()&&this.isHeroBuilding())&&(b=!0);return b},getWildlingOrderName:function(){return"war"===this.scaffoldType?this.warOrderName:this.normalOrderName},getHero:function(){var a=this.owner,b=null;a&&(a=a.gameManager,(b=a.getHero())&&b.shouldBeDestroyed()&&(b=null));return b},isHeroBuilding:function(a){var b=!1;a||(a=this.getHero());a&&(a=a.getEC("ECPlayerBuilder"))&&(a.isBuilding()&&!a.instantBuildFlavour&&a.getHeldObjectScaffoldType()===this.scaffoldType&&0<a.getHeldObjectBuildTime())&&
(b=!0);return b},getHeroToFollow:function(){var a=this.getHero(),b,c;a&&this.isHeroBuilding(a)&&(b=a.getEC("ECWildlingLeader"))&&!b.canAnyFollowersPerformOrder(this.getWildlingOrderName())&&(c=a);return c},reset:function(){this.lastCheckTime=this.globals.gameCurrentTime},update:function(){var a=this.owner,b=this.getHeroToFollow();b&&a.startFollowingLeader(b);return!0}});Vi.create=function(a,b,c){return new Vi(a,b,c)};Da.aiActions.AIActionChooseBuilder=Vi;var Wi=Fa.extend({actionName:"Choose Melee Target",
init:function(a,b,c){this._super(a,b,c);this.maxRange=c.maxRange||Number.MAX_VALUE;this.ignorePathing=c.ignorePathing||!1},canDoAction:function(){return!0},reset:function(){},update:function(){return this.owner.updateMeleeTargetEntity(this.maxRange,this.ignorePathing)?!0:!1}});Wi.create=function(a,b,c){return new Wi(a,b,c)};Da.aiActions.AIActionChooseMeleeTarget=Wi;var Xi=Fa.extend({actionName:"Choose Ranged Target",init:function(a,b,c){this._super(a,b,c);this.maxRange=c.maxRange||Number.MAX_VALUE;
this.minRange=c.minRange||0;this.ignorePathing=c.ignorePathing||!1;this.nextRedirectTime=0;this.minTimeBetweenRedirects=0.75;this.maxTimeBetweenRedirects=2.5},canDoAction:function(){return!0},reset:function(){this.owner.clearTargetEntity()},update:function(){if(this.owner.updateRangedTargetEntity(this.minRange,this.maxRange,this.ignorePathing))return!0;this.randomRotate();return!1},randomRotate:function(){var a=this.globals,b=!1,c=a.mathDevice,d;a.gameCurrentTime>this.nextRedirectTime&&(b=!0);var e=
this.owner.gameManager.getHero();d=this.owner.getv3Location();9>c.v3Distance2DSq(e.getv3Location(),d)&&(d=this.owner.getEntityEC("ECOrientate"))&&d.setFacing(e.getv3Location());b&&(d=this.owner.getv3Location(),b=c.v3BuildRandomCircle(5),b=c.v3Add(b,d,b),(d=this.owner.getEntityEC("ECOrientate"))&&d.setFacing(b),c=c.randomInRange(this.minTimeBetweenRedirects,this.maxTimeBetweenRedirects),this.nextRedirectTime=a.gameCurrentTime+c)}});Xi.create=function(a,b,c){return new Xi(a,b,c)};Da.aiActions.AIActionChooseRangedTarget=
Xi;var Yi=Fa.extend({actionName:"Choose Player Attacked Target",init:function(a,b,c){this._super(a,b,c);a=this.globals.gameManager.eventManager;this.onPlayerAttackedCallback=this.onPlayerAttacked.bind(this);a.subscribe("PlayerAttackedTarget",this.onPlayerAttackedCallback)},canDoAction:function(){this.targetEntity&&this.targetEntity.toBeDestroyed&&(this.targetEntity=void 0);return this.targetEntity},onPlayerAttacked:function(a){a!==this.targetEntity&&(this.targetEntity=a)},reset:function(){},deInit:function(){this.globals.gameManager.eventManager.unsubscribe("PlayerAttackedTarget",
this.onPlayerAttackedCallback)},update:function(){this.targetEntity&&this.owner.setTargetEntity(this.targetEntity);return!0}});Yi.create=function(a,b,c){return new Yi(a,b,c)};Da.aiActions.AIActionChoosePlayerAttackedTarget=Yi;var ek=Fa.extend({actionName:"Choose Resource Destination",init:function(a,b,c){this._super(a,b,c)},canDoAction:function(){var a=this.owner,b=!1;a&&!a.getTargetResourceDestination()&&(b=a.isCarryingResource(this.resourceType));return b},reset:function(){},update:function(){var a=
this.owner;a.clearTargetEntity();a.updateTargetResourceDestination(this.resourceType);return!0}}),Zi=ek.extend({actionName:"Choose Lumber Destination",resourceType:E.LUMBER});Zi.create=function(a,b,c){return new Zi(a,b,c)};Da.aiActions.AIActionChooseLumberDestination=Zi;var $i=ek.extend({actionName:"Choose Stone Destination",resourceType:E.STONE});$i.create=function(a,b,c){return new $i(a,b,c)};Da.aiActions.AIActionChooseStoneDestination=$i;var fk=Fa.extend({actionName:"Choose ResourceDispenser",
init:function(a,b,c){this._super(a,b,c)},getResourceType:function(){return this.resourceType},canDoAction:function(){var a=this.owner,b=!1,c=this.getResourceType();a.canGatherResource(c)&&(a.canCarryMoreResource(c)&&!a.hasHitResourceCap(c)&&!a.getTargetResourceDispenser())&&(a=a.gameManager,(c=a.getResourceDispenserManager(c))&&c.validResourceDispenserExists()&&(b=!0));return b},reset:function(){},update:function(){var a=this.owner;a.clearTargetEntity();a.updateTargetResourceDispenser(this.getResourceType());
return!0}}),aj=fk.extend({actionName:"Choose Lumber",resourceType:E.LUMBER});aj.create=function(a,b,c){return new aj(a,b,c)};Da.aiActions.AIActionChooseTree=aj;var bj=fk.extend({actionName:"Choose Quarry",resourceType:E.STONE});bj.create=function(a,b,c){return new bj(a,b,c)};Da.aiActions.AIActionChooseQuarry=bj;var cj=Fa.extend({actionName:"Choose Outpost",init:function(a,b,c){this._super(a,b,c);this.minimumTimeBetweenChecks=1;this.outpostBuildingType="Outpost";this.lastCheckTime=void 0},canDoAction:function(){var a=
this.owner,b=!1;if(void 0===this.lastCheckTime||this.globals.gameCurrentTime-this.lastCheckTime>=this.minimumTimeBetweenChecks)a&&(a.canAssistWithBuilding()&&!a.getTargetOutpost()&&this.levelContainsOutposts())&&(b=!0);return b},levelContainsOutposts:function(){var a=this.owner,b=!1;a&&(a=a.gameManager,(a=a.getBuildingManager())&&0<a.getBuildingCount(this.outpostBuildingType)&&(b=!0));return b},reset:function(){this.lastCheckTime=this.globals.gameCurrentTime},update:function(){var a=this.owner;a.clearTargetEntity();
a.updateTargetOutpost();return!0}});cj.create=function(a,b,c){return new cj(a,b,c)};Da.aiActions.AIActionChooseOutpost=cj;var dj=Fa.extend({actionName:"Choose Scaffold",init:function(a,b,c){this._super(a,b,c);this.scaffoldType=c.scaffoldType||"normal";this.minimumTimeBetweenChecks=1;this.lastCheckTime=void 0},canDoAction:function(){var a=this.owner,b=!1;if(void 0===this.lastCheckTime||this.globals.gameCurrentTime-this.lastCheckTime>=this.minimumTimeBetweenChecks)a&&(a.canAssistWithBuilding()&&!a.getTargetScaffold()&&
a.levelContainsBuildingsInProgress(this.scaffoldType))&&(b=!0);return b},reset:function(){this.lastCheckTime=this.globals.gameCurrentTime},update:function(){var a=this.owner;a.clearTargetEntity();a.updateTargetScaffold(this.scaffoldType);return!0}});dj.create=function(a,b,c){return new dj(a,b,c)};Da.aiActions.AIActionChooseScaffold=dj;var gk=Fa.extend({actionName:"Interact With ResourceDispenser",init:function(a,b,c){this._super(a,b,c);this.timeBetweenInteractions=1.2;this.waitTimeAfterFinalInteraction=
1.3;this.waitStartTime=void 0;this.resourceRemaining=0;this.onInteractedCallback=this.onInteracted.bind(this)},getResourceType:function(){return this.resourceType},canDoAction:function(){var a=this.owner,b=!1;a&&(b=a.isWithinRangeOfTargetResourceDispenser());return b},reset:function(){var a=this.owner,b;if(a){a.stopMoving();if(b=a.getEntityEC("ECResourceCarrier"))this.resourceRemaining=b.getEmptySpace(this.getResourceType());b=a.getTargetResourceDispenser();a=a.getEntityEC("ECLocomotion");b&&(!b.shouldBeDestroyed()&&
a)&&a.setFacing(b.getv3Location())}this.resourceRemaining=0;this.waitStartTime=void 0},onInteracted:function(){var a=this.owner,b=a.interactWithTargetResourceDispenser();this.resourceRemaining-=b;0>=this.resourceRemaining&&(a.clearTargetEntity(),this.startWaiting())},update:function(){var a=this.owner,b=this.lastInteractionTime,c=this.globals.gameCurrentTime;if(void 0!==this.waitStartTime){if(this.globals.gameCurrentTime-this.waitStartTime>=this.waitTimeAfterFinalInteraction)return a.stopHittingSomething(),
(a=a.getEntityEC("ECLocomotion"))&&a.clearFacing(),!0}else{if(void 0!==b&&c-b<this.timeBetweenInteractions)return!1;a.isWithinRangeOfTargetResourceDispenser()&&a.isTargetResourceDispenserValid()?(a.beginHittingSomething(this.onInteractedCallback,this.timeBetweenInteractions),this.lastInteractionTime=c):this.startWaiting()}return!1},startWaiting:function(){this.waitStartTime=this.globals.gameCurrentTime},abort:function(){var a=this.owner;a&&a.isHittingSomething()&&(a.stopHittingSomething(),(a=a.getEntityEC("ECLocomotion"))&&
a.clearFacing())}}),ej=gk.extend({actionName:"Chop Tree",resourceType:E.LUMBER});ej.create=function(a,b,c){return new ej(a,b,c)};Da.aiActions.AIActionChopTree=ej;var fj=gk.extend({actionName:"Quarry Stone",resourceType:E.STONE});fj.create=function(a,b,c){return new fj(a,b,c)};Da.aiActions.AIActionQuarryStone=fj;var gj=Fa.extend({actionName:"Escape",init:function(a,b,c){this._super(a,b,c);this.timeSinceHealthChangeToEscape=2.5;this.timeSinceSpawnWithoutTakingDamageToEscape=12;this.escapeTween=null},
canDoAction:function(){return!0},reset:function(){this.escapeTween=null},update:function(){var a=this.owner,b;b=this.globals.gameCurrentTime;var c=!1;return this.escapeTween?!1:a&&!a.toBeDestroyed?(a.hasLostHealth()?(b=a.getEntityEC("ECHealth"))&&b.getTimeSinceHealthChange()>=this.timeSinceHealthChangeToEscape&&(c=!0):(b-=a.entity.creationTime,b>=this.timeSinceSpawnWithoutTakingDamageToEscape&&(c=!0)),c?this.startEscapeTween():a.randomWander(),!1):!0},abort:function(){var a=this.owner;a&&!a.toBeDestroyed&&
a.stopRandomWander()},startEscapeTween:function(){var a=this.owner,b,c,d=this;a&&!a.toBeDestroyed&&(a.stopRandomWander(),(b=a.getEntityEC("ECHealth"))&&b.setActive(!1),(b=a.getEntityEC("ECLocomotion"))&&b.setActive(!1),(b=a.getEntityEC("ECTarget"))&&b.setValid(!1),c=a.getEntityEC("ECMesh"),a=c.getScaleY(),this.escapeTween=G.Create({yScale:a}).to({yScale:0.001},0.5).easing(G.Easing.Quadratic.Out).onUpdate(function(){c.setScaleY(this.yScale)}).onComplete(function(){d.finishEscapeTween()}).start())},
finishEscapeTween:function(){var a=this.owner,b;if(a&&!a.toBeDestroyed){if(b=a.getEntityEC("ECLootDropper"))b.lootDroppingEnabled=!1;(b=a.getEntityEC("ECHealth"))?b.killSelf():a.entity.setToBeDestroyed()}}});gj.create=function(a,b,c){return new gj(a,b,c)};Da.aiActions.AIActionWanderAndEscape=gj;var hj=Fa.extend({actionName:"Follow Leader",init:function(a,b,c){this._super(a,b,c)},canDoAction:function(){var a=this.owner,b=a.getLeaderToFollow(),c=!1;a&&(b&&!b.toBeDestroyed)&&(c=!0);return c},reset:function(){},
update:function(){var a=this.owner,b=a.getLeaderToFollow();if(!b||b.toBeDestroyed||a.isInDanger())return a.clearTargetEntity(),a.stopMoving(),!0;4>a.entity.getDistanceSqUsingSize(b.getv3Location())?a.stopMoving():a.moveTowardsEntity(b);return!1}});hj.create=function(a,b,c){return new hj(a,b,c)};Da.aiActions.AIActionFollowLeader=hj;var ij=Fa.extend({actionName:"Go Home",minMoveDuration:5,maxMoveDuration:6,init:function(a,b,c){this._super(a,b,c);this.initiativeStartTime=null;this.initiativeDuration=
c.initiativeDuration;this.moveDuration=a.mathDevice.randomInRange(this.minMoveDuration,this.maxMoveDuration)},canDoAction:function(){var a=this.owner,b=a.getWildlingHouse(),c=!1;a&&(b&&!b.toBeDestroyed)&&(c=!0);return c},reset:function(){this.initiativeStartTime=null;this.startTime=this.globals.gameCurrentTime},update:function(){var a=this.owner,b=this.globals.gameCurrentTime,c=a.getWildlingHouse();if(!c||c.toBeDestroyed)return a.stopMoving(),!0;if(b-this.startTime>this.moveDuration)return a.clearTargetEntity(),
!0;if(2.25>a.entity.getDistanceSqUsingSize(c.getv3Location())){if(null===this.initiativeStartTime){if(this.shouldHideInsideHouse())return a.hideInsideHouse(),!0;this.initiativeStartTime=b;return!1}return b-this.initiativeStartTime>this.initiativeDuration?(a.stopMoving(),!0):!1}if(a.moveTowardsEntity(c))return this.initiativeStartTime=null,!1;a.stopMoving();return!0},shouldHideInsideHouse:function(){var a=this.owner,b=!1;a&&a.isInDanger()&&(b=!0);return b}});ij.create=function(a,b,c){return new ij(a,
b,c)};Da.aiActions.AIActionGoHome=ij;var jj=Fa.extend({actionName:"House Upgrading",init:function(a,b,c){this._super(a,b,c)},canDoAction:function(){var a=this.owner,b=a.getWildlingHouse(),c=!1;b&&!b.shouldBeDestroyed()&&(b=b.getEC("ECWildlingHouse"))&&b.getWildlingArchetype()!==a.entity.getArchetypeName()&&(c=!0);return c},reset:function(){this.initiativeStartTime=null;this.startTime=this.globals.gameCurrentTime},update:function(){var a=this.owner,b=a.getWildlingHouse(),c;!b||b.toBeDestroyed?this.destroySelfIfSafe():
(c=2.25>a.entity.getDistanceSqUsingSize(b.getv3Location()))?this.destroySelfIfSafe():a.moveTowardsEntity(b);return!1},destroySelfIfSafe:function(){this.isSafeToDestroySelf()&&this.owner.entity.setToBeDestroyed()},isSafeToDestroySelf:function(){var a=this.owner.getEntityEC("ECResourceCarrier"),b=!0;if(a&&(a.hasAnyInboundResource()||a.hasAnyFlyingResource()))b=!1;return b}});jj.create=function(a,b,c){return new jj(a,b,c)};Da.aiActions.AIActionHouseUpgrading=jj;var kj=Fa.extend({actionName:"Headless Charge",
init:function(a,b,c){this._super(a,b,c);this.expand=c.expand;this.timeLimit=c.timeLimit},canDoAction:function(){return this.owner.hasTakenDamage?!0:!1},reset:function(){this.startTime=this.owner.globals.gameCurrentTime},update:function(){var a=this.owner,b=a.getTargetEntity(),c,d,e;c=a.globals.gameCurrentTime;d=a.getEntityEC("ECLocomotion");b&&!b.toBeDestroyed&&(e=b.getv3Location());b=c-this.startTime>this.timeLimit;a.getEntityEC("ECMesh").setScale(1+(c-this.startTime)*this.expand);if(b)return a.entity.setToBeDestroyed(),
!0;e&&d.setDestination(e);return!1}});kj.create=function(a,b,c){return new kj(a,b,c)};Da.aiActions.AIActionHeadlessCharge=kj;var lj=Fa.extend({actionName:"Melee Attack",init:function(a,b,c){this._super(a,b,c);this.onlyAttackHeroes=c.onlyAttackHeroes;this.facingTarget=this.hasAttacked=!1;this.clearTargetAfterAttack=void 0!==c.clearTargetAfterAttack?c.clearTargetAfterAttack:!0},canDoAction:function(){var a=this.owner,b=a.getEntityEC("ECMelee"),a=a.getTargetEntity(),c;if(!a||a.toBeDestroyed)return!1;
c=(c=a.getEC("ECMeleeTarget"))?c.canAttack():!0;b=b.isWithinRange(a);return!c||!b?!1:!0},reset:function(){var a=this.owner,b;this.facingTarget=this.hasAttacked=!1;if(a&&(a.stopMoving(),(b=a.getTargetEntity())&&!b.shouldBeDestroyed()&&!this.canEntityMove(b)))a.setFacing(b.getv3Location()),this.facingTarget=!0},canEntityMove:function(a){var b=!1;a&&!a.shouldBeDestroyed()&&(a=a.getEC("ECPhysicsSphere"))&&!a.isFixed()&&(b=!0);return b},update:function(){var a=this.owner,b=a.globals.gameManager,c=a.getv3Location(),
d=a.getEntityEC("ECMelee"),e=a.getTargetEntity(),g;if(!e||e.toBeDestroyed||this.onlyAttackHeroes&&!e.hasEC("ECHero"))return a.clearTargetEntity(),this.stopFacingTarget(),!0;if(!d.isAttacking()){if(this.hasAttacked)return(b=e.getEC("ECMeleeTarget"))&&b.endAttack(a.entity.name),(this.clearTargetAfterAttack||!a.canKeepAttackingTarget(e))&&!a.isFocusingOnTargetEntity()&&a.clearTargetEntity(),this.stopFacingTarget(),!0;d.isCharging()?d.hasFinishedCharging()&&(this.facingTarget||a.clearFacing(),g=e.getv3Location(),
a=b.getCollisionInfo(c,g,!1)?!1:!0,this.hasAttacked=!0,d.attemptAttack(e,a)):(g=e.getv3Location(),(b=e.getEC("ECMeleeTarget"))&&b.startAttack(a.entity.name),a.setFacing(g),d.charge())}return!1},stopFacingTarget:function(){var a=this.owner;this.facingTarget&&(a&&a.clearFacing(),this.facingTarget=!1)},abort:function(){var a=this.owner,b;if(a&&(this.stopFacingTarget(),(b=a.getTargetEntity())&&!b.shouldBeDestroyed()&&(this.clearTargetAfterAttack||!a.canKeepAttackingTarget(b))&&!a.isFocusingOnTargetEntity()&&
a.clearTargetEntity(),b&&!b.shouldBeDestroyed()&&(b=b.getEC("ECMeleeTarget"))&&b.endAttack(a.entity.name),a=a.getEntityEC("ECMelee")))a.release(),a.endAttack()}});lj.create=function(a,b,c){return new lj(a,b,c)};Da.aiActions.AIActionMeleeAttack=lj;var mj=Fa.extend({actionName:"Move Away From Overlapping Scaffold",init:function(a,b,c){this._super(a,b,c);this.scratchpad={};this.initiativeStartTime=null;this.initiativeDuration=0.8},canDoAction:function(){var a=this.owner.getOverlappingScaffold(),b=!1;
a&&!a.shouldBeDestroyed()&&(b=!0);return b},reset:function(){this.owner.stopMoving();this.initiativeStartTime=null},update:function(){var a=this.scratchpad,b=this.owner,c=this.globals,d=c.gameCurrentTime,c=c.mathDevice,e=b.getOverlappingScaffold();if(e&&!e.shouldBeDestroyed()){if(this.initiativeStartTime=null,d=b.getEntityEC("ECLocomotion"))b=b.getv3Location(),e=e.getv3Location(),a.v3ScaffoldToAgent=c.v3Sub(b,e,a.v3ScaffoldToAgent),a.v3ScaffoldToAgent[1]=0,1E-6<c.v3LengthSq(a.v3ScaffoldToAgent)?c.v3Normalize(a.v3ScaffoldToAgent,
a.v3ScaffoldToAgent):c.v3BuildXAxis(a.v3ScaffoldToAgent),a.v3TargetLocation=c.v3AddScalarMul(e,a.v3ScaffoldToAgent,20,a.v3TargetLocation),d.setDestination(a.v3TargetLocation)}else if(null===this.initiativeStartTime)this.initiativeStartTime=d,b.stopMoving();else return d-this.initiativeStartTime>this.initiativeDuration?(b.clearTargetEntity(),!0):!1}});mj.create=function(a,b,c){return new mj(a,b,c)};Da.aiActions.AIActionMoveAwayFromOverlappingScaffold=mj;var nj=Fa.extend({actionName:"Move Into Firearm Range",
minMoveDuration:0.8,maxMoveDuration:1,init:function(a,b,c){this._super(a,b,c);this.initiativeStartTime=null;this.initiativeDuration=c.initiativeDuration;this.moveDuration=a.mathDevice.randomInRange(this.minMoveDuration,this.maxMoveDuration)},canDoAction:function(){var a=this.owner.getTargetEntity(),b=this.owner,c=!1;b&&a&&!a.toBeDestroyed&&(a=b.getEntityEC("ECFirearm"))&&(c=!0);return c},reset:function(){this.initiativeStartTime=null;this.startTime=this.globals.gameCurrentTime},update:function(){var a=
this.owner,b=this.globals.gameCurrentTime,c=a.getTargetEntity(),d;if(!c||c.toBeDestroyed)return a.stopMoving(),!0;d=(d=a.getEntityEC("ECFirearm"))?d.isWithinRange(c.getv3Location()):!0;if(b-this.startTime>this.moveDuration&&!a.isFocusingOnTargetEntity())return a.clearTargetEntity(),d&&a.stopMoving(),!0;if(d)if(null===this.initiativeStartTime)this.initiativeStartTime=b,a.stopMoving();else return b-this.initiativeStartTime>this.initiativeDuration?!0:!1;else return a.moveTowardsEntity(c),this.initiativeStartTime=
null,!1}});nj.create=function(a,b,c){return new nj(a,b,c)};Da.aiActions.AIActionMoveIntoFirearmRange=nj;var oj=Fa.extend({actionName:"Move Into Melee Range",minMoveDuration:0.8,maxMoveDuration:1,init:function(a,b,c){this._super(a,b,c);this.initiativeStartTime=null;this.initiativeDuration=c.initiativeDuration;this.overrideMeleeRange=c.overrideMeleeRange;this.moveDuration=a.mathDevice.randomInRange(this.minMoveDuration,this.maxMoveDuration)},canDoAction:function(){var a=this.owner.getTargetEntity(),
b=this.owner,c=!1;b&&a&&!a.toBeDestroyed&&(a=b.getEntityEC("ECMelee"))&&(c=!0);return c},reset:function(){this.initiativeStartTime=null;this.startTime=this.globals.gameCurrentTime},update:function(){var a=this.owner,b=this.globals.gameCurrentTime,c=a.getTargetEntity(),d;if(!c||c.toBeDestroyed)return!0;if(b-this.startTime>this.moveDuration&&!a.isFocusingOnTargetEntity())return a.clearTargetEntity(),!0;if((d=a.getEntityEC("ECMelee"))?d.isWithinRange(c,this.overrideMeleeRange):1)if(null===this.initiativeStartTime)this.initiativeStartTime=
b;else return b-this.initiativeStartTime>this.initiativeDuration?(a.stopMoving(),!0):!1;else return a.moveTowardsEntity(c),this.initiativeStartTime=null,!1}});oj.create=function(a,b,c){return new oj(a,b,c)};Da.aiActions.AIActionMoveIntoMeleeRange=oj;var pj=Fa.extend({actionName:"Move To Nearby Outpost",minMoveDuration:3,maxMoveDuration:4,init:function(a,b,c){this._super(a,b,c);this.initiativeStartTime=null;this.initiativeDuration=c.initiativeDuration;this.moveDuration=a.mathDevice.randomInRange(this.minMoveDuration,
this.maxMoveDuration)},canDoAction:function(){var a=this.owner,b=a.getTargetOutpost(),c=!1,d=a.gameManager.getPlayFlags();b&&(!b.toBeDestroyed&&d.wildlingsCanWork&&!a.isInDanger())&&(c=!0);return c},reset:function(){this.initiativeStartTime=null;this.startTime=this.globals.gameCurrentTime},update:function(){var a=this.owner,b=this.globals.gameCurrentTime,c=a.getTargetOutpost();if(!c||c.toBeDestroyed)return a.stopMoving(),!0;if(b-this.startTime>this.moveDuration)return a.clearTargetEntity(),!0;if(12.25>
a.entity.getDistanceSqUsingSize(c.getv3Location()))return null===this.initiativeStartTime?(this.initiativeStartTime=b,!1):b-this.initiativeStartTime>this.initiativeDuration?(a.stopMoving(),a.clearTargetEntity(),!0):!1;if(a.moveTowardsEntity(c))return this.initiativeStartTime=null,!1;a.stopMoving();a.clearTargetEntity();return!0}});pj.create=function(a,b,c){return new pj(a,b,c)};Da.aiActions.AIActionMoveToOutpost=pj;var hk=Fa.extend({actionName:"Move To Resource Destination",minMoveDuration:10,maxMoveDuration:12,
init:function(a,b,c){this._super(a,b,c);this.initiativeStartTime=null;this.initiativeDuration=c.initiativeDuration;this.moveDuration=a.mathDevice.randomInRange(this.minMoveDuration,this.maxMoveDuration)},canDoAction:function(){var a=this.owner,b=a.getTargetResourceDestination(),c=!1;a&&(b&&!b.toBeDestroyed)&&(c=!0);return c},reset:function(){this.initiativeStartTime=null;this.startTime=this.globals.gameCurrentTime},update:function(){var a=this.owner,b=this.globals.gameCurrentTime,c=a.getTargetResourceDestination();
if(!c||c.toBeDestroyed)return a.stopMoving(),!0;if(b-this.startTime>this.moveDuration)return a.clearTargetEntity(),!0;if(2.25>a.entity.getDistanceSqUsingSize(c.getv3Location()))return null===this.initiativeStartTime?(this.initiativeStartTime=b,!1):b-this.initiativeStartTime>this.initiativeDuration?(a.stopMoving(),!0):!1;a.moveTowardsEntity(c);this.initiativeStartTime=null;return!1}}),qj=hk.extend({actionName:"Move To Lumber Destination",resourceType:E.LUMBER});qj.create=function(a,b,c){return new qj(a,
b,c)};Da.aiActions.AIActionMoveToLumberDestination=qj;var rj=hk.extend({actionName:"Move To Stone Destination",resourceType:E.STONE});rj.create=function(a,b,c){return new rj(a,b,c)};Da.aiActions.AIActionMoveToStoneDestination=rj;var sj=Fa.extend({actionName:"Move To ResourceDispenser",minMoveDuration:30,maxMoveDuration:32,init:function(a,b,c){this._super(a,b,c);this.initiativeStartTime=null;this.initiativeDuration=c.initiativeDuration;this.moveDuration=a.mathDevice.randomInRange(this.minMoveDuration,
this.maxMoveDuration)},canDoAction:function(){var a=this.owner,b=a.getTargetResourceDispenser(),c=!1;a&&(b&&!b.toBeDestroyed)&&(c=!0);return c},reset:function(){this.initiativeStartTime=null;this.startTime=this.globals.gameCurrentTime},update:function(){var a=this.owner,b=this.globals.gameCurrentTime,c=a.getTargetResourceDispenser();if(!c||c.toBeDestroyed)return a.stopMoving(),!0;if(b-this.startTime>this.moveDuration)return a.clearTargetEntity(),!0;if(a.isWithinRangeOfTargetResourceDispenser())return null===
this.initiativeStartTime?(this.initiativeStartTime=b,!1):b-this.initiativeStartTime>this.initiativeDuration?(a.stopMoving(),!0):!1;if(!1===a.moveTowardsEntity(c))return a.rejectResourceDispenser(c),a.clearTargetEntity(),!0;this.initiativeStartTime=null;return!1}});sj.create=function(a,b,c){return new sj(a,b,c)};Da.aiActions.AIActionMoveToResourceDispenser=sj;var tj=Fa.extend({actionName:"Move To Scaffold",minMoveDuration:30,maxMoveDuration:32,init:function(a,b,c){this._super(a,b,c);this.initiativeStartTime=
null;this.initiativeDuration=c.initiativeDuration;this.moveDuration=a.mathDevice.randomInRange(this.minMoveDuration,this.maxMoveDuration)},canDoAction:function(){var a=this.owner,b=a.getTargetScaffold(),c=!1;a&&(b&&!b.toBeDestroyed)&&(c=!0);return c},reset:function(){this.initiativeStartTime=null;this.startTime=this.globals.gameCurrentTime},update:function(){var a=this.owner,b=this.globals.gameCurrentTime,c=a.getTargetScaffold(),d=a.getScaffoldAssistingRange()-0.1,e=!1;if(!c||c.toBeDestroyed)return a.stopMoving(),
!0;if(b-this.startTime>this.moveDuration)return a.clearTargetEntity(),!0;c&&(d+=c.getRadius(),e=a.entity.getDistanceSqUsingSize(c.getv3Location())<d*d);if(e)return null===this.initiativeStartTime?(this.initiativeStartTime=b,!1):b-this.initiativeStartTime>this.initiativeDuration?(a.stopMoving(),!0):!1;if(a.moveTowardsEntity(c))return this.initiativeStartTime=null,!1;a.rejectScaffold(c);a.clearTargetEntity();a.stopMoving();return!0}});tj.create=function(a,b,c){return new tj(a,b,c)};Da.aiActions.AIActionMoveToScaffold=
tj;var ik=Fa.extend({actionName:"Pick Up Nearby Resource",minMoveDuration:10,maxMoveDuration:12,init:function(a,b,c){this._super(a,b,c);this.searchRadius=5;this.searchExtents=a.mathDevice.aabbBuildEmpty();this.targetResource=null;this.rejectedResource=[];this.moveDuration=a.mathDevice.randomInRange(this.minMoveDuration,this.maxMoveDuration)},getResourceType:function(){return this.resourceType},canDoAction:function(){var a=this.owner,b=this.getResourceType(),c=!0,d=!1;!a||!a.canGatherResource(b)?c=
!1:a.canCarryMoreResource(b)&&(this.setTargetResource(this.getNearbyResource()),this.targetResource&&(d=!0));return c&&d},getNearbyResource:function(){var a=this,b=this.globals.mathDevice,c=this.searchRadius,d=this.owner,e,g,h=null;if(d&&0<c&&(d=d.entity,e=d.getGameSpace()))g=function(b){h||a.isValidResource(b)&&(h=b)},this.searchExtents=b.aabbBuildFromCentreRadius(d.getv3Location(),c,this.searchExtents),e.applyToEntitiesInGridCellsWithinExtents(this.searchExtents,g);return h},isValidResource:function(a){var b=
!1,c,d;if(a&&!a.toBeDestroyed&&(c=a.getEC("ECPickup"),d=this.getResourceType(),c&&0<c.getCarriedResource(d)&&(a===this.targetResource||!c.isClaimed())&&!c.hasBeenPickedUp()&&0>this.rejectedResource.indexOf(a)))b=!0;return b},reset:function(){this.startTime=this.globals.gameCurrentTime},update:function(){var a=this.owner,b=this.globals.gameCurrentTime,c=this.targetResource,d=this.getResourceType(),e=!1;if(b-this.startTime>this.moveDuration)return this.clearTarget(),!0;if(!a.canCarryMoreResource(d))return a.stopMoving(),
this.clearTarget(),!0;this.updateRejectedResourceList();if(this.isValidResource(c))if(b=0.09>a.entity.getDistanceSqUsingSize(c.getv3Location()))a.stopMoving();else{if(e=a.moveTowardsEntity(c))return!1;this.rejectTargetResource()}c=a.canGatherResource(d)?this.getNearbyResource():null;this.setTargetResource(c);if(this.isValidResource(c))return!1;a.stopMoving();this.clearTarget();return!0},rejectTargetResource:function(){var a=this.targetResource,b=this.rejectedResource;a&&0>b.indexOf(a)&&b.push(a);
this.setTargetResource(null)},updateRejectedResourceList:function(){var a=this.rejectedResource,b,c;for(c=0;c<a.length;)b=a[c],!b||b.toBeDestroyed?a.splice(c,1):c+=1},setTargetResource:function(a){this.targetResource&&!this.targetResource.toBeDestroyed&&this.targetResource.getEC("ECPickup").setClaimed(!1);a&&a.getEC("ECPickup").setClaimed(!0);this.targetResource=a},clearTarget:function(){var a=this.targetResource;a&&!a.toBeDestroyed&&a.getEC("ECPickup").setClaimed(!1);this.targetResource=null;this.owner.clearTargetEntity()},
abort:function(){this.clearTarget()}}),uj=ik.extend({actionName:"Pick Up Nearby Lumber",resourceType:E.LUMBER});uj.create=function(a,b,c){return new uj(a,b,c)};Da.aiActions.AIActionPickUpNearbyLumber=uj;var vj=ik.extend({actionName:"Pick Up Nearby Stone",resourceType:E.STONE});vj.create=function(a,b,c){return new vj(a,b,c)};Da.aiActions.AIActionPickUpNearbyStone=vj;var wj=Fa.extend({actionName:"Random Wander",init:function(a,b,c){this._super(a,b,c);this.wanderDuration=1;this.startTime=null},canDoAction:function(){return!0},
reset:function(){this.startTime=this.owner.globals.gameCurrentTime},update:function(){var a=this.owner,b=a.globals.gameCurrentTime;if(b-this.startTime>this.wanderDuration){if(a.updateTargetEntity())return a.stopRandomWander(),!0;this.startTime=b}a.randomWander();return!1}});wj.create=function(a,b,c){return new wj(a,b,c)};Da.aiActions.AIActionRandomWander=wj;var xj=Fa.extend({actionName:"Ranged Attack",init:function(a,b,c){this._super(a,b,c);this.projectilesFired=0;this.startTime=null;this.numberOfProjectiles=
c.numberOfProjectiles;this.aimDuration=c.aimDuration;this.fireIfNotInRange=c.fireIfNotInRange;this.leadTarget=c.leadTarget;this.firstShotPerfectAim=c.firstShotPerfectAim;this.clearTargetAfterAttack=void 0!==c.clearTargetAfterAttack?c.clearTargetAfterAttack:!0},canDoAction:function(){var a=this.owner.getTargetEntity(),b;if(!a||a.toBeDestroyed)return!1;b=this.owner;a=a.getv3Location();b=b.getEntityEC("ECFirearm");return this.fireIfNotInRange||b.isWithinRange(a)},reset:function(){var a=this.owner.globals.gameCurrentTime;
this.projectilesFired=0;this.startTime=a},update:function(){var a=this.owner,b=a.globals.gameCurrentTime,c=a.getEntityEC("ECFirearm"),d,e;d=a.getTargetEntity();if(!d||d.toBeDestroyed)return a.clearTargetEntity(),!0;e=d.getv3Location();a.setFacing(e);if(b-this.startTime>this.aimDuration){if(c.isWithinRange(e))c.getCanFire()&&(b=0===this.projectilesFired&&this.firstShotPerfectAim,c.attemptFire(d,!1,this.leadTarget,b),this.projectilesFired+=1);else if(this.fireIfNotInRange)c.getCanFire()&&(c.attemptFire(d,
!0,this.leadTarget),this.projectilesFired+=1);else return(this.clearTargetAfterAttack||!a.canKeepAttackingTarget(d))&&!a.isFocusingOnTargetEntity()&&a.clearTargetEntity(),!0;if(this.projectilesFired>=this.numberOfProjectiles)return a.clearFacing(),this.clearTargetAfterAttack&&!a.isFocusingOnTargetEntity()&&a.clearTargetEntity(),!0}return!1},abort:function(){var a=this.owner,b;a&&(b=a.getTargetEntity())&&!b.shouldBeDestroyed()&&(this.clearTargetAfterAttack||!a.canKeepAttackingTarget(b))&&!a.isFocusingOnTargetEntity()&&
a.clearTargetEntity()}});xj.create=function(a,b,c){return new xj(a,b,c)};Da.aiActions.AIActionRangedAttack=xj;var yj=Fa.extend({actionName:"Speed Up Scaffold",init:function(a,b,c){this._super(a,b,c);this.batchHits=!1;this.secondsSavedInCurrentBatch=this.hitsInCurrentBatch=0;this.minHitsPerBatch=5},canDoAction:function(){var a=this.owner,b=!1;a&&(b=a.isWithinRangeOfTargetScaffold());return b},reset:function(){var a=this.owner,b;this.secondsSavedInCurrentBatch=this.hitsInCurrentBatch=0;a&&!a.toBeDestroyed&&
(a.stopMoving(),b=a.getTargetScaffold(),a=a.getEntityEC("ECLocomotion"),b&&(!b.toBeDestroyed&&a)&&a.setFacing(b.getv3Location()))},update:function(){var a=this.owner,b=this.batchHits;if(a.isHittingSomething())return!1;var c=a.getTargetScaffold();if(!c||c.toBeDestroyed)return!0;if(a.isWithinRangeOfTargetScaffold()&&a.canAssistWithBuilding())return b?(a.beginFakeHittingBuilding(),this.updateBatchedHits()):a.beginHittingBuilding(),!1;a.clearTargetEntity();return!0},updateBatchedHits:function(){var a=
this.owner;a&&(this.hitsInCurrentBatch+=1,this.secondsSavedInCurrentBatch+=a.getBuildingAssistRate(),this.hitsInCurrentBatch>=this.minHitsPerBatch&&1<=this.secondsSavedInCurrentBatch&&(a.showScaffoldHitSpeechBubble(this.secondsSavedInCurrentBatch),a.reduceTargetScaffoldBuildTime(this.secondsSavedInCurrentBatch),this.secondsSavedInCurrentBatch=this.hitsInCurrentBatch=0))},abort:function(){var a=this.owner;a&&a.isHittingSomething()&&a.stopHittingSomething()}});yj.create=function(a,b,c){return new yj(a,
b,c)};Da.aiActions.AIActionSpeedUpScaffold=yj;var Ab=fd.extend({wildlingOrderCreationMap:[],orderName:"WildlingOrderBase",speechBubbleName:null,init:function(a){this.globals=a;this.ecWildlingAgent=null},attach:function(a){this.ecWildlingAgent=a},canDoOrder:function(){return!0},begin:function(){},end:function(){},update:function(){return!0},canGatherResource:function(){return!0},canAssistWithBuilding:function(){return!0},getEntity:function(){var a=this.ecWildlingAgent,b=null;a&&(b=a.entity);return b},
getName:function(){return this.orderName},getSpeechBubbleName:function(){return this.speechBubbleName},destroy:function(){this._super()}});Ab.createFromName=function(a,b,c){return Ab.prototype.wildlingOrderCreationMap[a].create(b,c)};Ab.create=function(a,b){return new Ab(a,b)};var ji=Ab.extend({orderName:"Assist With Building",speechBubbleName:"speechBuilding",init:function(a){this._super(a)},attach:function(a){this._super(a)},canDoOrder:function(a){var b=this.ecWildlingAgent,c=!1;b&&(a&&b.isValidTargetScaffold(a))&&
(c=!0);return c},begin:function(a){var b=this.ecWildlingAgent;this._super(a);a&&b.setTargetScaffold(a)},end:function(){this._super()},update:function(){var a=!1;!this.ecWildlingAgent.getTargetScaffold()&&!this.ecWildlingAgent.levelContainsBuildingsInProgress("normal")&&(a=!0);return a},isFinished:function(){return!1},canGatherResource:function(){return!1},canAssistWithBuilding:function(){return!0},destroy:function(){this._super()}});Ab.prototype.wildlingOrderCreationMap[ji.prototype.orderName]=ji;
ji.create=function(a,b){return new ji(a,b)};var ki=Ab.extend({orderName:"Assist With WarBuilding",speechBubbleName:"speechWarBuilding",init:function(a){this._super(a)},attach:function(a){this._super(a)},canDoOrder:function(a){var b=this.ecWildlingAgent,c=!1;b&&(a&&b.isValidTargetScaffold(a))&&(c=!0);return c},begin:function(a){var b=this.ecWildlingAgent;this._super(a);a&&b.setTargetScaffold(a)},end:function(){this._super()},update:function(){var a=!1;!this.ecWildlingAgent.getTargetScaffold()&&!this.ecWildlingAgent.levelContainsBuildingsInProgress("war")&&
(a=!0);return a},isFinished:function(){return!1},canGatherResource:function(){return!1},canAssistWithBuilding:function(){return!0},destroy:function(){this._super()}});Ab.prototype.wildlingOrderCreationMap[ki.prototype.orderName]=ki;ki.create=function(a,b){return new ki(a,b)};var li=Ab.extend({orderName:"Gather Lumber",speechBubbleName:"speechLumber",init:function(a){this._super(a)},attach:function(a){this._super(a)},begin:function(a){var b=this.ecWildlingAgent;this._super(a);a&&(b.setv3ResourceGatheringLocation(a.getv3Location()),
b.setTargetResourceDispenser(a))},end:function(){this._super();this.ecWildlingAgent.clearv3ResourceGatheringLocation()},update:function(){return!1},canGatherResource:function(a){return a===E.LUMBER},canAssistWithBuilding:function(){return!1},destroy:function(){this._super()}});Ab.prototype.wildlingOrderCreationMap[li.prototype.orderName]=li;li.create=function(a,b){return new li(a,b)};var mi=Ab.extend({orderName:"Gather Stone",speechBubbleName:"speechStone",init:function(a){this._super(a)},attach:function(a){this._super(a)},
begin:function(a){var b=this.ecWildlingAgent;this._super(a);a&&(b.setv3ResourceGatheringLocation(a.getv3Location()),b.setTargetResourceDispenser(a))},end:function(){this._super();this.ecWildlingAgent.clearv3ResourceGatheringLocation()},update:function(){return!1},canGatherResource:function(a){return a===E.STONE},canAssistWithBuilding:function(){return!1},destroy:function(){this._super()}});Ab.prototype.wildlingOrderCreationMap[mi.prototype.orderName]=mi;mi.create=function(a,b){return new mi(a,b)};
e.prototype={createActiveEntityInstance:function(a,b,c,d){a=this.createInactiveEntityInstance(a,b,c,d);a.activate();return a},createInactiveEntityInstance:function(a,b,c,d){var e=this.archetypes[b],a=this.createEntity(a,e.familyName,e,c,d);a.archetypeName=b;return a},createCustomEntityInstance:function(a,b,c,d){return this.createEntity(a,b,null,c,d)},createInactiveEditorObjectInstance:function(a,b,c,d){a=this.createCustomEntityInstance(a,a,c,d);b=F.createFromName("ECMesh",this.globals,b);a.addECToCustomEntity(b);
a.removeECFromCustomEntity("ECGameGridEntity");return a},createEntity:function(a,b,c,d,e){var g=this.globals,c=c||{},h,a=db.create(a,b,g,d,c.shouldLevelSave,c.shouldPlayerSave,e);for(h in c)c.hasOwnProperty(h)&&this.isValidECName(h)&&((b=c[h])||(b={}),b=F.createFromName(h,g,b),a.addEC(b));a.getEC("ECGameGridEntity")||a.addEC(F.createFromName("ECGameGridEntity",g,void 0));return a},getCurrentArchetype:function(){return this.currentArchetype},getEntityArchetype:function(a){return this.archetypes[a]},
getArchetypesOfFamilyName:function(a){var b=this.archetypes,c=[],d,e;for(e in b)b.hasOwnProperty(e)&&(d=b[e],d.familyName===a&&c.push(d));return c},getECArchetype:function(a,b){var c=this.getEntityArchetype(a);return!c?void 0:c[b]},createScaffold:function(a,b,c,d,e,g,h,i,j,k,l){var m=this.globals.mathDevice,a=this.getECArchetype(b,"ECBuilding"),q="war"===a.scaffoldType,p=this.getECArchetype(b,"ECPhysicsCube"),s=!0;p&&(s=2>m.v3Length(p.v3Scale));var t="a_b_scaffold";q?t=s?"a_b_scaffoldWarSmall":"a_b_scaffoldWar":
s&&(t="a_b_scaffoldSmall");c=this.createInactiveEntityInstance(t,t,c,d);d=c.getEC("ECPhysicsCube");if(p)d.setV3Scale(p.v3Scale),d.setOffsetY(p.offsetY);else if(p=this.getECArchetype(b,"ECPhysicsSphere"))p=p.radius,d.setV3Scale([p,p,p]);d.setShouldSaveSerialize(!0);p=this.getECArchetype(b,"ECMesh");d=c.getEC("ECMesh");m=p.localOffset?m.v3Copy(p.localOffset):m.v3BuildZero();m[1]+=p.offsetY;d.setLocalOffset(m);d.setScale(p.scale);d.setPath(p.path);m=c.getEC("ECScaffold");m.setObeysScaffoldCap(a.obeysScaffoldCap);
m.setTemporaryResourceCaps(j);m.setPlannedObject(b,g,h,i,l);var u;e&&!e.shouldBeDestroyed()&&(b=e.getEC("ECFaction"))&&(u=b.getFactionName());u&&m.setPlannedFactionName(u);u=c.getEC("ECBuilding");u.setBuildingName(a.buildingName);u.setBuildingType(a.buildingType);u.setBuildingParentEntity(k);u.setAddedFootprintSize(a.addedFootprintSize);h&&(u.setScaffoldCap(a.scaffoldCap),u.setScaffoldCapType(a.scaffoldCapType),u.setGlobalCaps(a.globalCaps),m.setScaffoldType("rebuilding"),m.setMinBuildSpeed(1),m.instantlyStartBuilding());
g=this.getECArchetype(g,"ECBuildingPlacementRadius");h=c.getEC("ECBuildingPlacementRadius");g&&h.copyParameters(g);c.activate();return c},getv3ObjectExtents:function(a){var b=this.globals.mathDevice,c,d,e=!1;if(this.gameManager&&b){if(a=this.getEntityArchetype(a)){c=this.getArchetypeComponentParameters(a,"ECPhysicsCube");if(!e&&c&&(c=c.v3Scale))d=b.v3Copy(c),e=!0;a=this.getArchetypeComponentParameters(a,"ECPhysicsSphere");!e&&a&&(a=a.radius,void 0!==a&&(a*=2,d=b.v3Build(a,a,a),e=!0))}e||(d=b.v3Build(1,
1,1))}return d},getObjectBuildBuffer:function(a){var a=this.getEntityArchetype(a),a=this.getArchetypeComponentParameters(a,"ECBuilding"),b=0;a&&void 0!==a.addedFootprintSize&&(b=2*a.addedFootprintSize);return b},getv3ObjectFootprintExtents:function(a){var b=this.getObjectBuildBuffer(a),a=this.getv3ObjectExtents(a);this.globals.mathDevice.v3ScalarAdd(a,b,a);return a},hasSocketOfFamilyName:function(a,b){var c=this.gameManager.getEntityFactory(),d=a.ECSockets,e;if(d)for(var d=d.sockets,g=d.length,h=
0;h<g;h+=1)if(e=d[h],e=e.archetypeName,e=c.getEntityArchetype(e),e=e.familyName,e===b)return!0;return!1},getBuildingMaxLinePlacementLength:function(a){a=this.getEntityArchetype(a);return(a=this.getArchetypeComponentParameters(a,"ECBuilding"))&&void 0!==a.maxLinePlacementLength?a.maxLinePlacementLength:!1},getArchetypeComponentParameters:function(a,b){return a[b]},initArchetypes:function(){var a=e.archetypes,b={},c=this.archetypes,d,f;for(d in a)a.hasOwnProperty(d)&&(f=a[d],f.name=d,f=f.parent?f:this.completeArchetypeDescription(f),
b[d]=f);for(d in b)b.hasOwnProperty(d)&&!c[d]&&(f=b[d],this.createAndStoreArchetypeFromDescription(f,b,c));this.archetypeList=this.createAlphabeticalArchetypeArray(c)},createAndStoreArchetypeFromDescription:function(a,b,c){var d={},e,g;if((e=a.parent)&&!c[e])g=b[e],this.createAndStoreArchetypeFromDescription(g,b,c);e&&(b=c[e],this.copyArchetypeProperties(b,d));this.copyArchetypeProperties(a,d);c[a.name]=d},copyArchetypeProperties:function(a,b){var c=e.EC_DEFAULT,d=e.EC_REMOVE,f,g,h,i,j=[];for(f in a)if(a.hasOwnProperty(f)&&
"parent"!==f)if(this.isValidECName(f))if(g=a[f],g===d)j.push(f);else{if(b.hasOwnProperty(f)||(b[f]={}),h=b[f],g!==c)for(i in g)g.hasOwnProperty(i)&&(h[i]=g[i])}else b[f]=a[f];c=j.length;for(d=0;d<c;d+=1)(f=j[d])&&delete b[f]},completeArchetypeDescription:function(a){var b,c;for(b in a)a.hasOwnProperty(b)&&this.isValidECName(b)&&(c=a[b],c||(c={},a[b]=c),F.completeParameters(b,c));return a},initUI:function(){var a=this.globals.dynamicUI;if(a){var b=this.getArchetypeList();this.addSelectArchetypeUI(b);
ea.addArchetypeSliders&&this.addArchetypesUI(a,b)}},createAlphabeticalArchetypeArray:function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(c);b.sort();return b},isValidECName:function(a){return"name"!==a&&"parent"!==a&&"shouldLevelSave"!==a&&"shouldPlayerSave"!==a&&"familyName"!==a},addArchetypesUI:function(a,b){var c=this.globals.dynamicUI.addGroup("Archetypes"),d=b.length,e;for(e=0;e<d;e+=1)this.addArchetypeUI(b[e],c)},addArchetypeUI:function(a,b){var c=this.globals.dynamicUI.addGroup(a,
b),d=this.archetypes[a],e;for(e in d)d.hasOwnProperty(e)&&this.isValidECName(e)&&this.addComponentUI(d,e,c)},addComponentUI:function(a,b,c){var d=this.globals.dynamicUI,e=F.getECPrototype(b).realTime,c=d.addGroup(b+(e?" (Real Time)":""),c),d=F.getECParameters(b),g,h;if(d)for(g in d)d.hasOwnProperty(g)&&(e=d[g],h=a[b],this.addComponentParameterUI(b,g,e,h,c))},addComponentParameterUI:function(a,b,c,d,e){if(!(null===d||void 0===c)){a=c.defaultValue;a="object"!==typeof c?c:c.defaultValue;if(void 0===
a&&(a=d[b],void 0===a))return;var g=typeof a;"number"===g?this.watchFloat(c,b,d,e):"boolean"===g?this.watchBool(c,b,d,e):"object"===g&&a.length&&this.watchArray(a,c,b,d,e)}},watchFloat:function(a,b,c,d){var e=this.globals.dynamicUI,a=this.getFloatSliderOptions(a);e.watchVariable(b,c,b,"slider",d,a)},watchBool:function(a,b,c,d){this.globals.dynamicUI.watchVariable(b,c,b,"checkbox",d)},watchArray:function(a,b,c,d,e){var g=this.globals.dynamicUI,e=g.addGroup(c,e),h,i,j;h=typeof a[0];if("number"===h)i=
this.getV3SliderOptions(b),j="slider";else if("boolean"===h)i={},j="checkbox";else return;for(b=0;b<a.length;b+=1)h=Nf.create(d,c,b),i.getValue=h.get,i.setValue=h.set,g.watchVariable(c+"["+b+"]",d,c,j,e,i)},getFloatSliderOptions:function(a){var b={},c;"object"===typeof a&&(b.min=a.minValue,b.max=a.maxValue,b.step=a.step,a=a.defaultValue);void 0===b.min&&(b.min=0);void 0===b.max&&(c=Math.abs(a),b.max=10>c?10:100>c?100:1E3,0>a&&(b.max*=-1));void 0===b.step&&(b.step=0.01*(b.max-b.min));return b},getV3SliderOptions:function(a){return a instanceof
Array?this.getFloatSliderOptions(a[0]):this.getFloatSliderOptions({minValue:a.minValue,maxValue:a.maxValue,step:a.step,defaultValue:a.defaultValue[0]})},addSelectArchetypeUI:function(a){this.globals.dynamicUI.watchVariable("Archetypes",this,"currentArchetype","select",null,{values:a})},preload:function(){var a=this.archetypes,b,c;for(b in a)a.hasOwnProperty(b)&&(c=a[b],this.loadArchetypeAssets(c));this.loadGameEntityAssets()},loadArchetypeAssets:function(a){var b=this.globals,c,d;for(d in a)a.hasOwnProperty(d)&&
this.isValidECName(d)&&(c=F.getECClass(d),c.preloadComponent&&c.preloadComponent(b,a[d]))},loadGameEntityAssets:function(){var a=this.globals,b=a.textureManager;F.forEachECClass(function(b){b.preload&&b.preload(a)});var c=db.progressBarTexturePath;b&&c&&b.load(c)},getArchetypeList:function(){return this.archetypeList}};e.archetypes={};e.EC_DEFAULT=0;e.EC_REMOVE=1;e.create=function(a,b){var c=new e;c.globals=a;c.gameManager=b;c.archetypes={};c.archetypeList=[];c.initArchetypes();c.initUI();return c};
WorkshopSettings={iconSize:1.15};e.balanceBuildings={a_b_hq:{health:1E3,buildTime:2,resourceCost:0,secondaryResourceCost:0,minResourceRepairCost:[0,50],maxResourceRepairCost:[0,100],resourceStorage:1E3,secondaryResourceStorage:1E3},a_b_hq_level_2:{health:1100,buildTime:300,resourceCost:0,secondaryResourceCost:1E3,minResourceRepairCost:[0,100],maxResourceRepairCost:[0,200],resourceStorage:1E3,secondaryResourceStorage:1E3},a_b_hq_level_3:{health:1200,buildTime:10800,resourceCost:0,secondaryResourceCost:2500,
minResourceRepairCost:[0,250],maxResourceRepairCost:[0,500],resourceStorage:1E3,secondaryResourceStorage:1E3},a_b_hq_level_4:{health:1400,buildTime:86400,resourceCost:0,secondaryResourceCost:1E4,minResourceRepairCost:[0,500],maxResourceRepairCost:[0,1E3],resourceStorage:1E3,secondaryResourceStorage:1E3},a_b_hq_level_5:{health:1600,buildTime:172800,resourceCost:0,secondaryResourceCost:5E4,minResourceRepairCost:[0,1E3],maxResourceRepairCost:[0,2E3],resourceStorage:1E3,secondaryResourceStorage:1E3},
a_b_hq_level_6:{health:1900,buildTime:345600,resourceCost:0,secondaryResourceCost:25E4,minResourceRepairCost:[0,2500],maxResourceRepairCost:[0,5E3],resourceStorage:1E3,secondaryResourceStorage:1E3},a_b_hq_level_7:{health:2200,buildTime:518400,resourceCost:0,secondaryResourceCost:5E5,minResourceRepairCost:[0,5E3],maxResourceRepairCost:[0,1E4],resourceStorage:1E3,secondaryResourceStorage:1E3},a_b_hq_level_8:{health:2600,buildTime:691200,resourceCost:0,secondaryResourceCost:1E6,minResourceRepairCost:[0,
1E4],maxResourceRepairCost:[0,2E4],resourceStorage:1E3,secondaryResourceStorage:1E3},a_b_hq_level_9:{health:3E3,buildTime:864E3,resourceCost:0,secondaryResourceCost:25E5,minResourceRepairCost:[0,25E3],maxResourceRepairCost:[0,5E4],resourceStorage:1E3,secondaryResourceStorage:1E3},a_b_hq_level_10:{health:3500,buildTime:1036800,resourceCost:0,secondaryResourceCost:5E6,minResourceRepairCost:[0,5E4],maxResourceRepairCost:[0,1E5],resourceStorage:1E3,secondaryResourceStorage:1E3},a_b_workshop:{health:500,
buildTime:600,resourceCost:0,secondaryResourceCost:250,minResourceRepairCost:[0,25],maxResourceRepairCost:[0,50]},a_b_workshop_level_2:{health:550,buildTime:600,resourceCost:0,secondaryResourceCost:500,minResourceRepairCost:[0,50],maxResourceRepairCost:[0,100]},a_b_workshop_level_3:{health:600,buildTime:600,resourceCost:0,secondaryResourceCost:1E3,minResourceRepairCost:[0,100],maxResourceRepairCost:[0,250]},a_b_workshop_level_4:{health:700,buildTime:600,resourceCost:0,secondaryResourceCost:2500,minResourceRepairCost:[0,
250],maxResourceRepairCost:[0,500]},a_b_workshop_level_5:{health:800,buildTime:600,resourceCost:0,secondaryResourceCost:5E3,minResourceRepairCost:[0,500],maxResourceRepairCost:[0,1E3]},a_b_workshop_level_6:{health:950,buildTime:14400,resourceCost:0,secondaryResourceCost:1E4,minResourceRepairCost:[0,1E3],maxResourceRepairCost:[0,2500]},a_b_workshop_level_7:{health:1100,buildTime:21600,resourceCost:0,secondaryResourceCost:25E3,minResourceRepairCost:[0,2500],maxResourceRepairCost:[0,5E3]},a_b_workshop_level_8:{health:1300,
buildTime:28800,resourceCost:0,secondaryResourceCost:5E4,minResourceRepairCost:[0,5E3],maxResourceRepairCost:[0,1E4]},a_b_workshop_level_9:{health:1500,buildTime:43200,resourceCost:0,secondaryResourceCost:1E5,minResourceRepairCost:[0,1E4],maxResourceRepairCost:[0,25E3]},a_b_workshop_level_10:{health:1750,buildTime:86400,resourceCost:0,secondaryResourceCost:25E4,minResourceRepairCost:[0,25E3],maxResourceRepairCost:[0,5E4]},a_b_marketplace:{health:500,buildTime:60,resourceCost:0,secondaryResourceCost:250,
minResourceRepairCost:[0,25],maxResourceRepairCost:[0,50]},a_b_lumbermill:{health:250,buildTime:2,resourceCost:10,secondaryResourceCost:0,minResourceRepairCost:[0,25],maxResourceRepairCost:[0,50]},a_b_lumbermill_level_2:{health:275,buildTime:300,resourceCost:0,secondaryResourceCost:250,minResourceRepairCost:[0,50],maxResourceRepairCost:[0,100]},a_b_lumbermill_level_3:{health:300,buildTime:900,resourceCost:0,secondaryResourceCost:500,minResourceRepairCost:[0,100],maxResourceRepairCost:[0,250]},a_b_lumbermill_level_4:{health:325,
buildTime:3600,resourceCost:0,secondaryResourceCost:1E3,minResourceRepairCost:[0,250],maxResourceRepairCost:[0,500]},a_b_lumbermill_level_5:{health:350,buildTime:14400,resourceCost:0,secondaryResourceCost:2500,minResourceRepairCost:[0,500],maxResourceRepairCost:[0,1E3]},a_b_lumbermill_level_6:{health:375,buildTime:43200,resourceCost:0,secondaryResourceCost:5E3,minResourceRepairCost:[0,1E3],maxResourceRepairCost:[0,2500]},a_b_lumbermill_level_7:{health:400,buildTime:86400,resourceCost:0,secondaryResourceCost:1E4,
minResourceRepairCost:[0,2500],maxResourceRepairCost:[0,5E3]},a_b_lumbermill_level_8:{health:425,buildTime:172800,resourceCost:0,secondaryResourceCost:25E3,minResourceRepairCost:[0,5E3],maxResourceRepairCost:[0,1E4]},a_b_lumbermill_level_9:{health:450,buildTime:259200,resourceCost:0,secondaryResourceCost:5E4,minResourceRepairCost:[0,1E4],maxResourceRepairCost:[0,25E3]},a_b_lumbermill_level_10:{health:475,buildTime:345600,resourceCost:0,secondaryResourceCost:1E5,minResourceRepairCost:[0,25E3],maxResourceRepairCost:[0,
5E4]},a_b_wildlinghouse_lumber:{health:250,buildTime:2,resourceCost:10,secondaryResourceCost:0,minResourceRepairCost:[0,25],maxResourceRepairCost:[0,50]},a_b_wildlinghouse_lumber_level_2:{health:275,buildTime:300,resourceCost:0,secondaryResourceCost:250,minResourceRepairCost:[0,50],maxResourceRepairCost:[0,100]},a_b_wildlinghouse_lumber_level_3:{health:300,buildTime:900,resourceCost:0,secondaryResourceCost:500,minResourceRepairCost:[0,100],maxResourceRepairCost:[0,250]},a_b_wildlinghouse_lumber_level_4:{health:325,
buildTime:3600,resourceCost:0,secondaryResourceCost:1E3,minResourceRepairCost:[0,250],maxResourceRepairCost:[0,500]},a_b_wildlinghouse_lumber_level_5:{health:350,buildTime:14400,resourceCost:0,secondaryResourceCost:2500,minResourceRepairCost:[0,500],maxResourceRepairCost:[0,1E3]},a_b_wildlinghouse_lumber_level_6:{health:375,buildTime:43200,resourceCost:0,secondaryResourceCost:5E3,minResourceRepairCost:[0,1E3],maxResourceRepairCost:[0,2500]},a_b_wildlinghouse_lumber_level_7:{health:400,buildTime:86400,
resourceCost:0,secondaryResourceCost:1E4,minResourceRepairCost:[0,2500],maxResourceRepairCost:[0,5E3]},a_b_wildlinghouse_lumber_level_8:{health:425,buildTime:172800,resourceCost:0,secondaryResourceCost:25E3,minResourceRepairCost:[0,5E3],maxResourceRepairCost:[0,1E4]},a_b_wildlinghouse_lumber_level_9:{health:450,buildTime:259200,resourceCost:0,secondaryResourceCost:5E4,minResourceRepairCost:[0,1E4],maxResourceRepairCost:[0,25E3]},a_b_wildlinghouse_lumber_level_10:{health:475,buildTime:345600,resourceCost:0,
secondaryResourceCost:1E5,minResourceRepairCost:[0,25E3],maxResourceRepairCost:[0,5E4]},a_b_lumberstorage:{health:250,buildTime:300,resourceCost:0,secondaryResourceCost:250,minResourceRepairCost:[0,25],maxResourceRepairCost:[0,50],resourceStorage:1E3},a_b_lumberstorage_level_2:{health:300,buildTime:1800,resourceCost:0,secondaryResourceCost:500,minResourceRepairCost:[0,50],maxResourceRepairCost:[0,100],resourceStorage:2500},a_b_lumberstorage_level_3:{health:350,buildTime:3600,resourceCost:0,secondaryResourceCost:1E3,
minResourceRepairCost:[0,100],maxResourceRepairCost:[0,250],resourceStorage:5E3},a_b_lumberstorage_level_4:{health:400,buildTime:7200,resourceCost:0,secondaryResourceCost:2500,minResourceRepairCost:[0,250],maxResourceRepairCost:[0,500],resourceStorage:25E3},a_b_lumberstorage_level_5:{health:450,buildTime:10800,resourceCost:0,secondaryResourceCost:5E3,minResourceRepairCost:[0,500],maxResourceRepairCost:[0,1E3],resourceStorage:125E3},a_b_lumberstorage_level_6:{health:500,buildTime:14400,resourceCost:0,
secondaryResourceCost:1E4,minResourceRepairCost:[0,1E3],maxResourceRepairCost:[0,2500],resourceStorage:2E5},a_b_lumberstorage_level_7:{health:550,buildTime:21600,resourceCost:0,secondaryResourceCost:25E3,minResourceRepairCost:[0,2500],maxResourceRepairCost:[0,5E3],resourceStorage:35E4},a_b_lumberstorage_level_8:{health:600,buildTime:28800,resourceCost:0,secondaryResourceCost:5E4,minResourceRepairCost:[0,5E3],maxResourceRepairCost:[0,1E4],resourceStorage:85E4},a_b_lumberstorage_level_9:{health:650,
buildTime:43200,resourceCost:0,secondaryResourceCost:1E5,minResourceRepairCost:[0,1E4],maxResourceRepairCost:[0,25E3],resourceStorage:125E4},a_b_lumberstorage_level_10:{health:700,buildTime:86400,resourceCost:0,secondaryResourceCost:25E4,minResourceRepairCost:[0,25E3],maxResourceRepairCost:[0,5E4],resourceStorage:2E6},a_b_stonemill:{health:250,buildTime:2,resourceCost:0,secondaryResourceCost:10,minResourceRepairCost:[25,0],maxResourceRepairCost:[50,0]},a_b_stonemill_level_2:{health:275,buildTime:300,
resourceCost:250,secondaryResourceCost:0,minResourceRepairCost:[50,0],maxResourceRepairCost:[100,0]},a_b_stonemill_level_3:{health:300,buildTime:900,resourceCost:500,secondaryResourceCost:0,minResourceRepairCost:[100,0],maxResourceRepairCost:[250,0]},a_b_stonemill_level_4:{health:325,buildTime:3600,resourceCost:1E3,secondaryResourceCost:0,minResourceRepairCost:[250,0],maxResourceRepairCost:[500,0]},a_b_stonemill_level_5:{health:350,buildTime:14400,resourceCost:2500,secondaryResourceCost:0,minResourceRepairCost:[500,
0],maxResourceRepairCost:[1E3,0]},a_b_stonemill_level_6:{health:375,buildTime:43200,resourceCost:5E3,secondaryResourceCost:0,minResourceRepairCost:[1E3,0],maxResourceRepairCost:[2500,0]},a_b_stonemill_level_7:{health:400,buildTime:86400,resourceCost:1E4,secondaryResourceCost:0,minResourceRepairCost:[2500,0],maxResourceRepairCost:[5E3,0]},a_b_stonemill_level_8:{health:425,buildTime:172800,resourceCost:25E3,secondaryResourceCost:0,minResourceRepairCost:[5E3,0],maxResourceRepairCost:[1E4,0]},a_b_stonemill_level_9:{health:450,
buildTime:259200,resourceCost:5E4,secondaryResourceCost:0,minResourceRepairCost:[1E4,0],maxResourceRepairCost:[25E3,0]},a_b_stonemill_level_10:{health:475,buildTime:345600,resourceCost:1E5,secondaryResourceCost:0,minResourceRepairCost:[25E3,0],maxResourceRepairCost:[5E4,0]},a_b_wildlinghouse_stone:{health:250,buildTime:2,resourceCost:0,secondaryResourceCost:10,minResourceRepairCost:[25,0],maxResourceRepairCost:[50,0]},a_b_wildlinghouse_stone_level_2:{health:275,buildTime:300,resourceCost:250,secondaryResourceCost:0,
minResourceRepairCost:[50,0],maxResourceRepairCost:[100,0]},a_b_wildlinghouse_stone_level_3:{health:300,buildTime:900,resourceCost:500,secondaryResourceCost:0,minResourceRepairCost:[100,0],maxResourceRepairCost:[250,0]},a_b_wildlinghouse_stone_level_4:{health:325,buildTime:3600,resourceCost:1E3,secondaryResourceCost:0,minResourceRepairCost:[250,0],maxResourceRepairCost:[500,0]},a_b_wildlinghouse_stone_level_5:{health:350,buildTime:14400,resourceCost:2500,secondaryResourceCost:0,minResourceRepairCost:[500,
0],maxResourceRepairCost:[1E3,0]},a_b_wildlinghouse_stone_level_6:{health:375,buildTime:43200,resourceCost:5E3,secondaryResourceCost:0,minResourceRepairCost:[1E3,0],maxResourceRepairCost:[2500,0]},a_b_wildlinghouse_stone_level_7:{health:400,buildTime:86400,resourceCost:1E4,secondaryResourceCost:0,minResourceRepairCost:[2500,0],maxResourceRepairCost:[5E3,0]},a_b_wildlinghouse_stone_level_8:{health:425,buildTime:172800,resourceCost:25E3,secondaryResourceCost:0,minResourceRepairCost:[5E3,0],maxResourceRepairCost:[1E4,
0]},a_b_wildlinghouse_stone_level_9:{health:450,buildTime:259200,resourceCost:5E4,secondaryResourceCost:0,minResourceRepairCost:[1E4,0],maxResourceRepairCost:[25E3,0]},a_b_wildlinghouse_stone_level_10:{health:475,buildTime:345600,resourceCost:1E5,secondaryResourceCost:0,minResourceRepairCost:[25E3,0],maxResourceRepairCost:[5E4,0]},a_b_stonestorage:{health:250,buildTime:300,resourceCost:250,secondaryResourceCost:0,minResourceRepairCost:[25,0],maxResourceRepairCost:[50,0],secondaryResourceStorage:1E3},
a_b_stonestorage_level_2:{health:300,buildTime:1800,resourceCost:500,secondaryResourceCost:0,minResourceRepairCost:[50,0],maxResourceRepairCost:[100,0],secondaryResourceStorage:2500},a_b_stonestorage_level_3:{health:350,buildTime:3600,resourceCost:1E3,secondaryResourceCost:0,minResourceRepairCost:[100,0],maxResourceRepairCost:[250,0],secondaryResourceStorage:5E3},a_b_stonestorage_level_4:{health:400,buildTime:7200,resourceCost:2500,secondaryResourceCost:0,minResourceRepairCost:[250,0],maxResourceRepairCost:[500,
0],secondaryResourceStorage:25E3},a_b_stonestorage_level_5:{health:450,buildTime:10800,resourceCost:5E3,secondaryResourceCost:0,minResourceRepairCost:[500,0],maxResourceRepairCost:[1E3,0],secondaryResourceStorage:125E3},a_b_stonestorage_level_6:{health:500,buildTime:14400,resourceCost:1E4,secondaryResourceCost:0,minResourceRepairCost:[1E3,0],maxResourceRepairCost:[2500,0],secondaryResourceStorage:2E5},a_b_stonestorage_level_7:{health:550,buildTime:21600,resourceCost:25E3,secondaryResourceCost:0,minResourceRepairCost:[2500,
0],maxResourceRepairCost:[5E3,0],secondaryResourceStorage:35E4},a_b_stonestorage_level_8:{health:600,buildTime:28800,resourceCost:5E4,secondaryResourceCost:0,minResourceRepairCost:[5E3,0],maxResourceRepairCost:[1E4,0],secondaryResourceStorage:85E4},a_b_stonestorage_level_9:{health:650,buildTime:43200,resourceCost:1E5,secondaryResourceCost:0,minResourceRepairCost:[1E4,0],maxResourceRepairCost:[25E3,0],secondaryResourceStorage:125E4},a_b_stonestorage_level_10:{health:700,buildTime:86400,resourceCost:25E4,
secondaryResourceCost:0,minResourceRepairCost:[25E3,0],maxResourceRepairCost:[5E4,0],secondaryResourceStorage:2E6},a_b_outpost:{health:250,buildTime:1800,resourceCost:100,secondaryResourceCost:0,minResourceRepairCost:[20,0],maxResourceRepairCost:[50,0]},a_b_outpost_level_2:{health:300,buildTime:900,resourceCost:500,secondaryResourceCost:0,minResourceRepairCost:[100,0],maxResourceRepairCost:[250,0]},a_b_outpost_level_3:{health:350,buildTime:7200,resourceCost:1E3,secondaryResourceCost:0,minResourceRepairCost:[200,
0],maxResourceRepairCost:[500,0]},a_b_outpost_level_4:{health:400,buildTime:14400,resourceCost:5E3,secondaryResourceCost:0,minResourceRepairCost:[500,0],maxResourceRepairCost:[1E3,0]},a_b_outpost_level_5:{health:450,buildTime:36E3,resourceCost:25E3,secondaryResourceCost:0,minResourceRepairCost:[1E3,0],maxResourceRepairCost:[2E3,0]},a_b_outpost_level_6:{health:500,buildTime:57600,resourceCost:5E4,secondaryResourceCost:0,minResourceRepairCost:[2500,0],maxResourceRepairCost:[5E3,0]},a_b_outpost_level_7:{health:550,
buildTime:86400,resourceCost:1E5,secondaryResourceCost:0,minResourceRepairCost:[5E3,0],maxResourceRepairCost:[1E4,0]},a_b_outpost_level_8:{health:600,buildTime:172800,resourceCost:1E6,secondaryResourceCost:0,minResourceRepairCost:[1E4,0],maxResourceRepairCost:[2E4,0]},a_b_outpost_level_9:{health:650,buildTime:345600,resourceCost:25E5,secondaryResourceCost:0,minResourceRepairCost:[25E3,0],maxResourceRepairCost:[5E4,0]},a_b_outpost_level_10:{health:700,buildTime:518400,resourceCost:5E6,secondaryResourceCost:0,
minResourceRepairCost:[5E4,0],maxResourceRepairCost:[1E5,0]},a_b_defencefactory:{health:250,buildTime:2,resourceCost:10,secondaryResourceCost:0,minResourceRepairCost:[50,0],maxResourceRepairCost:[100,0]},a_b_defencefactory_level_2:{health:300,buildTime:3600,resourceCost:2500,secondaryResourceCost:0,minResourceRepairCost:[100,0],maxResourceRepairCost:[200,0]},a_b_defencefactory_level_3:{health:350,buildTime:10800,resourceCost:1E4,secondaryResourceCost:0,minResourceRepairCost:[250,0],maxResourceRepairCost:[500,
0]},a_b_defencefactory_level_4:{health:400,buildTime:28800,resourceCost:25E3,secondaryResourceCost:0,minResourceRepairCost:[500,0],maxResourceRepairCost:[1E3,0]},a_b_defencefactory_level_5:{health:450,buildTime:86400,resourceCost:5E4,secondaryResourceCost:0,minResourceRepairCost:[1E3,0],maxResourceRepairCost:[2E3,0]},a_b_defencefactory_level_6:{health:500,buildTime:259200,resourceCost:1E5,secondaryResourceCost:0,minResourceRepairCost:[2500,0],maxResourceRepairCost:[5E3,0]},a_b_defencefactory_level_7:{health:550,
buildTime:345600,resourceCost:25E4,secondaryResourceCost:0,minResourceRepairCost:[5E3,0],maxResourceRepairCost:[1E4,0]},a_b_defencefactory_level_8:{health:600,buildTime:518400,resourceCost:5E5,secondaryResourceCost:0,minResourceRepairCost:[1E4,0],maxResourceRepairCost:[2E4,0]},a_b_defencefactory_level_9:{health:650,buildTime:691200,resourceCost:1E6,secondaryResourceCost:0,minResourceRepairCost:[25E3,0],maxResourceRepairCost:[5E4,0]},a_b_defencefactory_level_10:{health:700,buildTime:864E3,resourceCost:25E5,
secondaryResourceCost:0,minResourceRepairCost:[5E4,0],maxResourceRepairCost:[1E5,0]},a_b_wildlinghouse_war:{health:250,buildTime:2,resourceCost:10,secondaryResourceCost:0,minResourceRepairCost:[50,0],maxResourceRepairCost:[100,0]},a_b_wildlinghouse_war_level_2:{health:300,buildTime:3600,resourceCost:2500,secondaryResourceCost:0,minResourceRepairCost:[100,0],maxResourceRepairCost:[200,0]},a_b_wildlinghouse_war_level_3:{health:350,buildTime:10800,resourceCost:1E4,secondaryResourceCost:0,minResourceRepairCost:[250,
0],maxResourceRepairCost:[500,0]},a_b_wildlinghouse_war_level_4:{health:400,buildTime:28800,resourceCost:25E3,secondaryResourceCost:0,minResourceRepairCost:[500,0],maxResourceRepairCost:[1E3,0]},a_b_wildlinghouse_war_level_5:{health:450,buildTime:86400,resourceCost:5E4,secondaryResourceCost:0,minResourceRepairCost:[1E3,0],maxResourceRepairCost:[2E3,0]},a_b_wildlinghouse_war_level_6:{health:500,buildTime:259200,resourceCost:1E5,secondaryResourceCost:0,minResourceRepairCost:[2500,0],maxResourceRepairCost:[5E3,
0]},a_b_wildlinghouse_war_level_7:{health:550,buildTime:345600,resourceCost:25E4,secondaryResourceCost:0,minResourceRepairCost:[5E3,0],maxResourceRepairCost:[1E4,0]},a_b_wildlinghouse_war_level_8:{health:600,buildTime:518400,resourceCost:5E5,secondaryResourceCost:0,minResourceRepairCost:[1E4,0],maxResourceRepairCost:[2E4,0]},a_b_wildlinghouse_war_level_9:{health:650,buildTime:691200,resourceCost:1E6,secondaryResourceCost:0,minResourceRepairCost:[25E3,0],maxResourceRepairCost:[5E4,0]},a_b_wildlinghouse_war_level_10:{health:700,
buildTime:864E3,resourceCost:25E5,secondaryResourceCost:0,minResourceRepairCost:[5E4,0],maxResourceRepairCost:[1E5,0]},a_b_library:{health:250,buildTime:1800,resourceCost:1E4,secondaryResourceCost:0,minResourceRepairCost:[250,0],maxResourceRepairCost:[500,0]},a_b_library_level_2:{health:300,buildTime:18E3,resourceCost:25E3,secondaryResourceCost:0,minResourceRepairCost:[500,0],maxResourceRepairCost:[1E3,0]},a_b_library_level_3:{health:350,buildTime:43200,resourceCost:5E4,secondaryResourceCost:0,minResourceRepairCost:[1E3,
0],maxResourceRepairCost:[2E3,0]},a_b_library_level_4:{health:400,buildTime:86400,resourceCost:1E5,secondaryResourceCost:0,minResourceRepairCost:[2500,0],maxResourceRepairCost:[5E3,0]},a_b_library_level_5:{health:450,buildTime:172800,resourceCost:25E4,secondaryResourceCost:0,minResourceRepairCost:[5E3,0],maxResourceRepairCost:[1E4,0]},a_b_library_level_6:{health:500,buildTime:345600,resourceCost:1E6,secondaryResourceCost:0,minResourceRepairCost:[1E4,0],maxResourceRepairCost:[2E4,0]},a_b_library_level_7:{health:550,
buildTime:518400,resourceCost:25E5,secondaryResourceCost:0,minResourceRepairCost:[25E3,0],maxResourceRepairCost:[5E4,0]},a_b_library_level_8:{health:600,buildTime:691200,resourceCost:5E6,secondaryResourceCost:0,minResourceRepairCost:[5E4,0],maxResourceRepairCost:[1E5,0]},a_d_tower:{health:250,buildTime:60,resourceCost:0,secondaryResourceCost:100,minResourceRepairCost:[0,50],maxResourceRepairCost:[0,100]},a_d_tower_level_2:{health:300,buildTime:900,resourceCost:0,secondaryResourceCost:500,minResourceRepairCost:[0,
100],maxResourceRepairCost:[0,200]},a_d_tower_level_3:{health:350,buildTime:2700,resourceCost:0,secondaryResourceCost:2500,minResourceRepairCost:[0,250],maxResourceRepairCost:[0,500]},a_d_tower_level_4:{health:400,buildTime:7200,resourceCost:0,secondaryResourceCost:1E4,minResourceRepairCost:[0,500],maxResourceRepairCost:[0,1E3]},a_d_tower_level_5:{health:450,buildTime:21600,resourceCost:0,secondaryResourceCost:25E3,minResourceRepairCost:[0,1E3],maxResourceRepairCost:[0,2E3]},a_d_tower_level_6:{health:500,
buildTime:43200,resourceCost:0,secondaryResourceCost:5E4,minResourceRepairCost:[0,2500],maxResourceRepairCost:[0,5E3]},a_d_tower_level_7:{health:550,buildTime:86400,resourceCost:0,secondaryResourceCost:1E5,minResourceRepairCost:[0,5E3],maxResourceRepairCost:[0,1E4]},a_d_tower_level_8:{health:600,buildTime:172800,resourceCost:0,secondaryResourceCost:25E4,minResourceRepairCost:[0,1E4],maxResourceRepairCost:[0,2E4]},a_d_tower_level_9:{health:650,buildTime:259200,resourceCost:0,secondaryResourceCost:5E5,
minResourceRepairCost:[0,25E3],maxResourceRepairCost:[0,5E4]},a_d_tower_level_10:{health:700,buildTime:345600,resourceCost:0,secondaryResourceCost:1E6,minResourceRepairCost:[0,5E4],maxResourceRepairCost:[0,1E5]},a_d_wall:{health:50,buildTime:0,resourceCost:0,secondaryResourceCost:100,minResourceRepairCost:[0,25],maxResourceRepairCost:[0,50]},a_d_wall_level_2:{health:75,buildTime:0,resourceCost:0,secondaryResourceCost:500,minResourceRepairCost:[0,50],maxResourceRepairCost:[0,100]},a_d_wall_level_3:{health:100,
buildTime:0,resourceCost:0,secondaryResourceCost:2500,minResourceRepairCost:[0,100],maxResourceRepairCost:[0,250]},a_d_wall_level_4:{health:125,buildTime:0,resourceCost:0,secondaryResourceCost:5E3,minResourceRepairCost:[0,250],maxResourceRepairCost:[0,500]},a_d_wall_level_5:{health:250,buildTime:0,resourceCost:0,secondaryResourceCost:1E4,minResourceRepairCost:[0,500],maxResourceRepairCost:[0,1E3]},a_d_wall_level_6:{health:375,buildTime:0,resourceCost:0,secondaryResourceCost:25E3,minResourceRepairCost:[0,
1E3],maxResourceRepairCost:[0,2500]},a_d_wall_level_7:{health:500,buildTime:0,resourceCost:0,secondaryResourceCost:5E4,minResourceRepairCost:[0,2500],maxResourceRepairCost:[0,5E3]},a_d_wall_level_8:{health:750,buildTime:0,resourceCost:0,secondaryResourceCost:1E5,minResourceRepairCost:[0,5E3],maxResourceRepairCost:[0,1E4]},a_d_wall_level_9:{health:1E3,buildTime:0,resourceCost:0,secondaryResourceCost:25E4,minResourceRepairCost:[0,1E4],maxResourceRepairCost:[0,25E3]},a_d_wall_level_10:{health:1250,buildTime:0,
resourceCost:0,secondaryResourceCost:5E5,minResourceRepairCost:[0,25E3],maxResourceRepairCost:[0,5E4]},a_d_gate:{health:200,buildTime:0,resourceCost:0,secondaryResourceCost:250,minResourceRepairCost:[0,50],maxResourceRepairCost:[0,100]},a_d_gate_level_2:{health:300,buildTime:0,resourceCost:0,secondaryResourceCost:1E3,minResourceRepairCost:[0,100],maxResourceRepairCost:[0,200]},a_d_gate_level_3:{health:400,buildTime:0,resourceCost:0,secondaryResourceCost:5E3,minResourceRepairCost:[0,250],maxResourceRepairCost:[0,
500]},a_d_gate_level_4:{health:500,buildTime:0,resourceCost:0,secondaryResourceCost:1E4,minResourceRepairCost:[0,500],maxResourceRepairCost:[0,1E3]},a_d_gate_level_5:{health:1E3,buildTime:0,resourceCost:0,secondaryResourceCost:25E3,minResourceRepairCost:[0,1E3],maxResourceRepairCost:[0,2E3]},a_d_gate_level_6:{health:1500,buildTime:0,resourceCost:0,secondaryResourceCost:5E4,minResourceRepairCost:[0,2500],maxResourceRepairCost:[0,5E3]},a_d_gate_level_7:{health:2E3,buildTime:0,resourceCost:0,secondaryResourceCost:1E5,
minResourceRepairCost:[0,5E3],maxResourceRepairCost:[0,1E4]},a_d_gate_level_8:{health:3E3,buildTime:0,resourceCost:0,secondaryResourceCost:25E4,minResourceRepairCost:[0,1E4],maxResourceRepairCost:[0,2E4]},a_d_gate_level_9:{health:4E3,buildTime:0,resourceCost:0,secondaryResourceCost:5E5,minResourceRepairCost:[0,25E3],maxResourceRepairCost:[0,5E4]},a_d_gate_level_10:{health:5E3,buildTime:0,resourceCost:0,secondaryResourceCost:1E6,minResourceRepairCost:[0,5E4],maxResourceRepairCost:[0,1E5]}};e.balanceDefences=
{a_d_barrel:{resourceCost:50,buildTime:30,health:5,damage:400,buildingDamage:10,friendlyFire:0.5,radius:3.5,forceBack:0,forceLift:2,forceRadial:2},a_d_barrel_level_2:{resourceCost:100,buildTime:60,health:5,damage:800,buildingDamage:20,friendlyFire:0.5,radius:7,forceBack:0,forceLift:4,forceRadial:4},a_d_barrel_level_3:{resourceCost:250,buildTime:120,health:5,damage:1600,buildingDamage:20,friendlyFire:0.5,radius:7,forceBack:0,forceLift:4,forceRadial:4},a_d_barrel_level_4:{resourceCost:500,buildTime:240,
health:5,damage:3200,buildingDamage:20,friendlyFire:0.5,radius:7,forceBack:0,forceLift:4,forceRadial:4},a_d_barrel_level_5:{resourceCost:1E3,buildTime:480,health:5,damage:6400,buildingDamage:20,friendlyFire:0.5,radius:7,forceBack:0,forceLift:4,forceRadial:4},a_d_mine:{resourceCost:50,buildTime:30,health:1,triggeredByHeroTouch:!0,triggeredByEnemyTouch:!0,triggeredByWildlingTouch:!1,damage:200,stunDuration:3,buildingDamage:0,friendlyFire:0.2,radius:2,forceBack:0,forceLift:0.4,forceRadial:0.4},a_d_mine_level_2:{resourceCost:100,
buildTime:60,health:1,triggeredByHeroTouch:!0,triggeredByEnemyTouch:!0,triggeredByWildlingTouch:!1,damage:400,stunDuration:3,buildingDamage:0,friendlyFire:0.2,radius:2,forceBack:0,forceLift:0.4,forceRadial:0.4},a_d_mine_level_3:{resourceCost:250,buildTime:120,health:1,triggeredByHeroTouch:!0,triggeredByEnemyTouch:!0,triggeredByWildlingTouch:!1,damage:800,stunDuration:3,buildingDamage:0,friendlyFire:0.2,radius:2,forceBack:0,forceLift:0.4,forceRadial:0.4},a_d_mine_level_4:{resourceCost:500,buildTime:240,
health:1,triggeredByHeroTouch:!0,triggeredByEnemyTouch:!0,triggeredByWildlingTouch:!1,damage:1600,stunDuration:3,buildingDamage:0,friendlyFire:0.2,radius:2,forceBack:0,forceLift:0.4,forceRadial:0.4},a_d_mine_level_5:{resourceCost:1E3,buildTime:480,health:1,triggeredByHeroTouch:!0,triggeredByEnemyTouch:!0,triggeredByWildlingTouch:!1,damage:3200,stunDuration:3,buildingDamage:0,friendlyFire:0.2,radius:2,forceBack:0,forceLift:0.4,forceRadial:0.4},a_d_decoy:{resourceCost:100,buildTime:60,health:180,maxAttackers:2},
a_d_decoy_level_2:{resourceCost:250,buildTime:120,health:360,maxAttackers:2},a_d_decoy_level_3:{resourceCost:500,buildTime:240,health:720,maxAttackers:2},a_d_decoy_level_4:{resourceCost:1E3,buildTime:480,health:1440,maxAttackers:2},a_d_decoy_level_5:{resourceCost:2500,buildTime:960,health:2880,maxAttackers:2}};e.balanceEnemies={a_e_bannerling:{xp:5,health:10,speed:2.5,damage:8,buildingDamage:28,wallDamage:16,importantBuildingDamageLimit:1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},
a_e_berserker_level_1:{xp:20,health:300,speed:1.7,damage:40,buildingDamage:160,wallDamage:160,importantBuildingDamageLimit:-1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_berserker_level_2:{xp:24,health:600,speed:1.7,damage:80,buildingDamage:320,wallDamage:320,importantBuildingDamageLimit:-1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_berserker_level_3:{xp:29,health:900,speed:1.7,damage:120,buildingDamage:480,wallDamage:480,importantBuildingDamageLimit:-1,
drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_berserker_level_4:{xp:35,health:1200,speed:1.7,damage:160,buildingDamage:640,wallDamage:640,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_berserker_level_5:{xp:42,health:1500,speed:1.7,damage:200,buildingDamage:800,wallDamage:800,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_berserker_level_6:{xp:50,health:1800,speed:1.7,damage:240,
buildingDamage:960,wallDamage:960,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_berserker_level_7:{xp:59,health:2100,speed:1.7,damage:280,buildingDamage:1120,wallDamage:1120,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_berserker_level_8:{xp:69,health:2400,speed:1.7,damage:320,buildingDamage:1280,wallDamage:1280,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},
a_e_bombthrower_level_1:{xp:10,health:75,speed:5,damage:20,buildingDamage:25,wallDamage:25,importantBuildingDamageLimit:-1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_bombthrower_level_2:{xp:12,health:150,speed:5,damage:40,buildingDamage:50,wallDamage:50,importantBuildingDamageLimit:-1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_bombthrower_level_3:{xp:15,health:225,speed:5,damage:60,buildingDamage:75,wallDamage:75,importantBuildingDamageLimit:-1,drops:[{number:1,
likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_bombthrower_level_4:{xp:19,health:300,speed:5,damage:80,buildingDamage:100,wallDamage:100,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_bombthrower_level_5:{xp:24,health:375,speed:5,damage:100,buildingDamage:125,wallDamage:125,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_bombthrower_level_6:{xp:30,health:450,speed:5,damage:120,buildingDamage:150,
wallDamage:150,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_bombthrower_level_7:{xp:37,health:525,speed:5,damage:140,buildingDamage:175,wallDamage:175,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_bombthrower_level_8:{xp:45,health:600,speed:5,damage:160,buildingDamage:200,wallDamage:200,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_basicmelee_level_1:{xp:5,
health:100,speed:5,damage:12,buildingDamage:24,wallDamage:24,importantBuildingDamageLimit:-1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_basicmelee_level_2:{xp:6,health:200,speed:5,damage:24,buildingDamage:48,wallDamage:48,importantBuildingDamageLimit:-1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_basicmelee_level_3:{xp:8,health:300,speed:5,damage:36,buildingDamage:72,wallDamage:72,importantBuildingDamageLimit:-1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},
a_e_basicmelee_level_4:{xp:11,health:400,speed:5,damage:48,buildingDamage:96,wallDamage:96,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_basicmelee_level_5:{xp:15,health:500,speed:5,damage:60,buildingDamage:120,wallDamage:120,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_basicmelee_level_6:{xp:20,health:600,speed:5,damage:72,buildingDamage:144,wallDamage:144,importantBuildingDamageLimit:-1,drops:[{number:2,
likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_basicmelee_level_7:{xp:26,health:700,speed:5,damage:84,buildingDamage:168,wallDamage:168,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_basicmelee_level_8:{xp:33,health:800,speed:5,damage:96,buildingDamage:192,wallDamage:192,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_commando_level_1:{xp:5,health:50,speed:6,damage:8,buildingDamage:28,wallDamage:28,
importantBuildingDamageLimit:1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_commando_level_2:{xp:6,health:100,speed:6,damage:16,buildingDamage:56,wallDamage:56,importantBuildingDamageLimit:1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_commando_level_3:{xp:8,health:150,speed:6,damage:24,buildingDamage:84,wallDamage:84,importantBuildingDamageLimit:1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_commando_level_4:{xp:11,health:200,speed:6,
damage:32,buildingDamage:112,wallDamage:112,importantBuildingDamageLimit:1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_commando_level_5:{xp:15,health:250,speed:6,damage:40,buildingDamage:140,wallDamage:140,importantBuildingDamageLimit:1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_commando_level_6:{xp:20,health:300,speed:6,damage:48,buildingDamage:168,wallDamage:168,importantBuildingDamageLimit:1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},
a_e_commando_level_7:{xp:26,health:350,speed:6,damage:56,buildingDamage:196,wallDamage:196,importantBuildingDamageLimit:1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_commando_level_8:{xp:33,health:400,speed:6,damage:64,buildingDamage:224,wallDamage:224,importantBuildingDamageLimit:1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_thief_level_1:{xp:5,health:25,speed:7,damage:4,buildingDamage:14,wallDamage:14,importantBuildingDamageLimit:1,drops:[{number:1,
likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_thief_level_2:{xp:6,health:50,speed:7,damage:8,buildingDamage:28,wallDamage:28,importantBuildingDamageLimit:1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_thief_level_3:{xp:7,health:75,speed:7,damage:12,buildingDamage:42,wallDamage:42,importantBuildingDamageLimit:1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_thief_level_4:{xp:9,health:100,speed:7,damage:16,buildingDamage:56,wallDamage:56,importantBuildingDamageLimit:1,
drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_thief_level_5:{xp:11,health:125,speed:7,damage:20,buildingDamage:70,wallDamage:70,importantBuildingDamageLimit:1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_thief_level_6:{xp:11,health:150,speed:7,damage:24,buildingDamage:84,wallDamage:84,importantBuildingDamageLimit:1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_thief_level_7:{xp:11,health:175,speed:7,damage:28,buildingDamage:98,wallDamage:98,
importantBuildingDamageLimit:1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_thief_level_8:{xp:11,health:200,speed:7,damage:32,buildingDamage:112,wallDamage:112,importantBuildingDamageLimit:1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_charger_level_1:{xp:20,health:250,speed:5,damage:25,buildingDamage:5,wallDamage:5,importantBuildingDamageLimit:-1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_charger_level_2:{xp:24,health:500,speed:5,
damage:50,buildingDamage:10,wallDamage:10,importantBuildingDamageLimit:-1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_charger_level_3:{xp:29,health:750,speed:5,damage:75,buildingDamage:15,wallDamage:15,importantBuildingDamageLimit:-1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_charger_level_4:{xp:35,health:1E3,speed:5,damage:100,buildingDamage:20,wallDamage:20,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},
a_e_charger_level_5:{xp:42,health:1250,speed:5,damage:125,buildingDamage:25,wallDamage:25,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_charger_level_6:{xp:50,health:1500,speed:5,damage:150,buildingDamage:30,wallDamage:30,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_charger_level_7:{xp:59,health:1750,speed:5,damage:175,buildingDamage:35,wallDamage:35,importantBuildingDamageLimit:-1,drops:[{number:2,
likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_charger_level_8:{xp:69,health:2E3,speed:5,damage:200,buildingDamage:40,wallDamage:40,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_mini_charger_level_1:{xp:5,health:100,speed:5,damage:12,buildingDamage:4,wallDamage:4,importantBuildingDamageLimit:-1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_mini_charger_level_2:{xp:6,health:200,speed:5,damage:24,buildingDamage:8,wallDamage:8,
importantBuildingDamageLimit:-1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_mini_charger_level_3:{xp:8,health:300,speed:5,damage:36,buildingDamage:12,wallDamage:12,importantBuildingDamageLimit:-1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_mini_charger_level_4:{xp:11,health:400,speed:5,damage:48,buildingDamage:16,wallDamage:16,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_mini_charger_level_5:{xp:15,
health:500,speed:5,damage:60,buildingDamage:20,wallDamage:20,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_mini_charger_level_6:{xp:20,health:600,speed:5,damage:72,buildingDamage:24,wallDamage:24,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_mini_charger_level_7:{xp:26,health:700,speed:5,damage:84,buildingDamage:28,wallDamage:28,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,
archetype:"a_r_stone_large"}]},a_e_mini_charger_level_8:{xp:33,health:800,speed:5,damage:96,buildingDamage:32,wallDamage:32,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_charger_boss_level_1:{xp:50,health:800,speed:4,damage:50,buildingDamage:30,wallDamage:160,importantBuildingDamageLimit:-1,rangedDamage:20,drops:[{number:1,archetype:"a_r_stone_large"},{number:1,archetype:"a_r_amber"}]},a_e_charger_boss_level_2:{xp:60,health:1600,speed:4,damage:100,
buildingDamage:60,wallDamage:320,importantBuildingDamageLimit:-1,rangedDamage:40,drops:[{number:1,archetype:"a_r_stone_large"},{number:1,archetype:"a_r_amber"}]},a_e_charger_boss_level_3:{xp:72,health:2400,speed:4,damage:150,buildingDamage:90,wallDamage:480,importantBuildingDamageLimit:-1,rangedDamage:60,drops:[{number:1,archetype:"a_r_stone_large"},{number:1,archetype:"a_r_amber"}]},a_e_charger_boss_level_4:{xp:86,health:3200,speed:4,damage:200,buildingDamage:120,wallDamage:640,importantBuildingDamageLimit:-1,
rangedDamage:80,drops:[{number:1,archetype:"a_r_stone_large"},{number:1,archetype:"a_r_amber"}]},a_e_charger_boss_level_5:{xp:102,health:4E3,speed:4,damage:250,buildingDamage:150,wallDamage:800,importantBuildingDamageLimit:-1,rangedDamage:100,drops:[{number:2,archetype:"a_r_stone_large"},{number:1,archetype:"a_r_amber"}]},a_e_charger_boss_level_6:{xp:120,health:4800,speed:4,damage:300,buildingDamage:180,wallDamage:960,importantBuildingDamageLimit:-1,rangedDamage:100,drops:[{number:2,archetype:"a_r_stone_large"},
{number:1,archetype:"a_r_amber"}]},a_e_charger_boss_level_7:{xp:140,health:5600,speed:4,damage:350,buildingDamage:210,wallDamage:1120,importantBuildingDamageLimit:-1,rangedDamage:100,drops:[{number:2,archetype:"a_r_stone_large"},{number:1,archetype:"a_r_amber"}]},a_e_charger_boss_level_8:{xp:162,health:6400,speed:4,damage:400,buildingDamage:240,wallDamage:1280,importantBuildingDamageLimit:-1,rangedDamage:100,drops:[{number:2,archetype:"a_r_stone_large"},{number:1,archetype:"a_r_amber"}]},a_e_ranged_level_1:{xp:10,
health:75,speed:5,damage:12,buildingDamage:24,wallDamage:24,importantBuildingDamageLimit:-1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_ranged_level_2:{xp:12,health:150,speed:5,damage:24,buildingDamage:48,wallDamage:48,importantBuildingDamageLimit:-1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_ranged_level_3:{xp:15,health:225,speed:5,damage:36,buildingDamage:72,wallDamage:72,importantBuildingDamageLimit:-1,drops:[{number:1,likelihood:0.1,archetype:"a_r_stone_large"}]},
a_e_ranged_level_4:{xp:19,health:300,speed:5,damage:48,buildingDamage:96,wallDamage:96,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_ranged_level_5:{xp:24,health:375,speed:5,damage:60,buildingDamage:120,wallDamage:120,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_ranged_level_6:{xp:30,health:450,speed:5,damage:72,buildingDamage:144,wallDamage:144,importantBuildingDamageLimit:-1,drops:[{number:2,
likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_ranged_level_7:{xp:37,health:525,speed:5,damage:84,buildingDamage:168,wallDamage:168,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_ranged_level_8:{xp:45,health:600,speed:5,damage:96,buildingDamage:192,wallDamage:192,importantBuildingDamageLimit:-1,drops:[{number:2,likelihood:0.1,archetype:"a_r_stone_large"}]},a_e_death:{xp:50,health:600,speed:7,damage:9999,buildingDamage:0,wallDamage:0,importantBuildingDamageLimit:-1,
minDistanceFromTarget:15},a_e_treasuredropper_level_1:{xp:200,health:50,speed:10,damage:0,buildingDamage:0,wallDamage:0,importantBuildingDamageLimit:-1,drops:[{number:2,archetype:"a_r_stone_large"},{number:1,archetype:"a_r_amber"}],damageDrops:[{number:1,archetype:"a_r_stone"},{number:2,archetype:"a_r_xp5"}]},a_e_treasuredropper_level_2:{xp:200,health:100,speed:10,damage:0,buildingDamage:0,wallDamage:0,importantBuildingDamageLimit:-1,drops:[{number:2,archetype:"a_r_stone_large"},{number:1,archetype:"a_r_amber"}],
damageDrops:[{number:1,archetype:"a_r_stone"},{number:2,archetype:"a_r_xp5"}]},a_e_treasuredropper_level_3:{xp:200,health:150,speed:10,damage:0,buildingDamage:0,wallDamage:0,importantBuildingDamageLimit:-1,drops:[{number:2,archetype:"a_r_stone_large"},{number:1,archetype:"a_r_amber"}],damageDrops:[{number:1,archetype:"a_r_stone"},{number:2,archetype:"a_r_xp5"}]},a_e_treasuredropper_level_4:{xp:200,health:250,speed:10,damage:0,buildingDamage:0,wallDamage:0,importantBuildingDamageLimit:-1,drops:[{number:2,
archetype:"a_r_stone_large"},{number:1,archetype:"a_r_amber"}],damageDrops:[{number:1,archetype:"a_r_stone"},{number:2,archetype:"a_r_xp5"}]},a_e_treasuredropper_level_5:{xp:200,health:300,speed:10,damage:0,buildingDamage:0,wallDamage:0,importantBuildingDamageLimit:-1,drops:[{number:2,archetype:"a_r_stone_large"},{number:1,archetype:"a_r_amber"}],damageDrops:[{number:1,archetype:"a_r_stone"},{number:2,archetype:"a_r_xp5"}]},a_e_treasuredropper_level_6:{xp:200,health:350,speed:10,damage:0,buildingDamage:0,
wallDamage:0,importantBuildingDamageLimit:-1,drops:[{number:2,archetype:"a_r_stone_large"},{number:1,archetype:"a_r_amber"}],damageDrops:[{number:1,archetype:"a_r_stone"},{number:2,archetype:"a_r_xp5"}]},a_e_treasuredropper_level_7:{xp:200,health:400,speed:10,damage:0,buildingDamage:0,wallDamage:0,importantBuildingDamageLimit:-1,drops:[{number:2,archetype:"a_r_stone_large"},{number:1,archetype:"a_r_amber"}],damageDrops:[{number:1,archetype:"a_r_stone"},{number:2,archetype:"a_r_xp5"}]},a_e_treasuredropper_level_8:{xp:200,
health:450,speed:10,damage:0,buildingDamage:0,wallDamage:0,importantBuildingDamageLimit:-1,drops:[{number:2,archetype:"a_r_stone_large"},{number:1,archetype:"a_r_amber"}],damageDrops:[{number:1,archetype:"a_r_stone"},{number:2,archetype:"a_r_xp5"}]}};e.balanceTurrets={a_d_turret_level_1:{health:200,buildTime:900,resourceCost:200,minResourceRepairCost:[40,0],maxResourceRepairCost:[100,0],damage:20,reloadDuration:1,radius:1,forceBack:0.1,forceLift:0.1,forceRadial:0.1},a_d_turret_level_2:{health:260,
buildTime:900,resourceCost:400,minResourceRepairCost:[80,0],maxResourceRepairCost:[200,0],damage:25,reloadDuration:1,radius:1,forceBack:0.1,forceLift:0.1,forceRadial:0.1},a_d_turret_level_3:{health:390,buildTime:900,resourceCost:800,minResourceRepairCost:[200,0],maxResourceRepairCost:[600,0],damage:50,reloadDuration:1,radius:1,forceBack:0.2,forceLift:0.2,forceRadial:0.2},a_d_turret_level_4:{health:520,buildTime:900,resourceCost:1600,minResourceRepairCost:[400,0],maxResourceRepairCost:[1200,0],damage:75,
reloadDuration:1,radius:1,forceBack:0.2,forceLift:0.2,forceRadial:0.2},a_d_turret_level_5:{health:650,buildTime:900,resourceCost:3200,minResourceRepairCost:[800,0],maxResourceRepairCost:[2400,0],damage:250,reloadDuration:1,radius:1,forceBack:0.2,forceLift:0.2,forceRadial:0.2},a_d_turret_mortar_level_1:{health:200,buildTime:1800,resourceCost:400,minResourceRepairCost:[100,0],maxResourceRepairCost:[200,0],damage:25,reloadDuration:3,radius:3.5,forceBack:0,forceLift:0.4,forceRadial:0.4},a_d_turret_mortar_level_2:{health:260,
buildTime:1800,resourceCost:800,minResourceRepairCost:[200,0],maxResourceRepairCost:[600,0],damage:25,reloadDuration:3,radius:3.5,forceBack:0,forceLift:0.4,forceRadial:0.4},a_d_turret_mortar_level_3:{health:390,buildTime:1800,resourceCost:1600,minResourceRepairCost:[400,0],maxResourceRepairCost:[1200,0],damage:50,reloadDuration:3,radius:3.5,forceBack:0,forceLift:0.4,forceRadial:0.4},a_d_turret_mortar_level_4:{health:520,buildTime:1800,resourceCost:3200,minResourceRepairCost:[800,0],maxResourceRepairCost:[2400,
0],damage:75,reloadDuration:3,radius:3.5,forceBack:0,forceLift:0.4,forceRadial:0.4},a_d_turret_mortar_level_5:{health:650,buildTime:1800,resourceCost:6400,minResourceRepairCost:[1600,0],maxResourceRepairCost:[4800,0],damage:250,reloadDuration:3,radius:3.5,forceBack:0,forceLift:0.4,forceRadial:0.4},a_d_turret_thumper_level_1:{health:200,buildTime:1800,resourceCost:300,minResourceRepairCost:[75,0],maxResourceRepairCost:[150,0],damage:0,reloadDuration:6,radius:7,forceBack:0,forceLift:1,forceRadial:3,
stunDuration:2},a_d_turret_thumper_level_2:{health:260,buildTime:1800,resourceCost:600,minResourceRepairCost:[150,0],maxResourceRepairCost:[900,0],damage:0,reloadDuration:6,radius:7,forceBack:0,forceLift:1,forceRadial:3,stunDuration:2},a_d_turret_thumper_level_3:{health:390,buildTime:1800,resourceCost:1200,minResourceRepairCost:[300,0],maxResourceRepairCost:[1800,0],damage:0,reloadDuration:6,radius:7,forceBack:0,forceLift:1,forceRadial:3,stunDuration:2},a_d_turret_thumper_level_4:{health:520,buildTime:1800,
resourceCost:2400,minResourceRepairCost:[600,0],maxResourceRepairCost:[3600,0],damage:0,reloadDuration:6,radius:7,forceBack:0,forceLift:1,forceRadial:3,stunDuration:2},a_d_turret_thumper_level_5:{health:650,buildTime:1800,resourceCost:4800,minResourceRepairCost:[1200,0],maxResourceRepairCost:[7200,0],damage:0,reloadDuration:6,radius:7,forceBack:0,forceLift:1,forceRadial:3,stunDuration:2},a_d_turret_sniper:{health:400,buildTime:120,resourceCost:100,repairCost:[50,0],damage:80,reloadDuration:1,radius:1,
forceBack:0.4,forceLift:0.2,forceRadial:0.2}};e.balanceBarricades={a_d_barricadegate:{health:100,buildTime:10,resourceCost:50,minResourceRepairCost:[10,0],maxResourceRepairCost:[25,0]},a_d_barricadegate_level_2:{health:200,buildTime:10,resourceCost:100,minResourceRepairCost:[20,0],maxResourceRepairCost:[50,0]},a_d_barricadegate_level_3:{health:300,buildTime:10,resourceCost:250,minResourceRepairCost:[50,0],maxResourceRepairCost:[125,0]},a_d_barricadegate_level_4:{health:500,buildTime:10,resourceCost:500,
minResourceRepairCost:[75,0],maxResourceRepairCost:[250,0]},a_d_barricadegate_level_5:{health:1E3,buildTime:10,resourceCost:1E3,minResourceRepairCost:[150,0],maxResourceRepairCost:[500,0]},a_d_barricade:{health:100,buildTime:5,resourceCost:25,minResourceRepairCost:[5,0],maxResourceRepairCost:[10,0]},a_d_barricade_level_2:{health:200,buildTime:5,resourceCost:50,minResourceRepairCost:[10,0],maxResourceRepairCost:[25,0]},a_d_barricade_level_3:{health:300,buildTime:5,resourceCost:100,minResourceRepairCost:[20,
0],maxResourceRepairCost:[50,0]},a_d_barricade_level_4:{health:500,buildTime:5,resourceCost:250,minResourceRepairCost:[50,0],maxResourceRepairCost:[125,0]},a_d_barricade_level_5:{health:1E3,buildTime:5,resourceCost:500,minResourceRepairCost:[75,0],maxResourceRepairCost:[250,0]}};var ba={archetypes:{},preload:function(a){var a=a.simpleSceneLoader,b,c,d=Sa.create({name:"temp",dynamic:!1,disabled:!0});for(b in this.archetypes)this.archetypes.hasOwnProperty(b)&&(c=this.archetypes[b],c.meshPath&&(a.isLoadingMesh(c.meshPath)||
a.load(c.meshPath,void 0,void 0,d)))}};e.archetypes.a_wm_inv_01_1={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_basicmelee_level_1",min:1,max:1}]},{postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_1",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_1",min:1,max:1},{archetype:"a_e_bombthrower_level_1",min:1,max:1}]},{postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_1",
min:1,max:1},{archetype:"a_e_bombthrower_level_1",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_1",min:2,max:2},{archetype:"a_e_bombthrower_level_1",min:1,max:1}]},{postThresholdDelay:7,families:[{archetype:"a_e_bombthrower_level_1",min:1,max:1}]}]}};e.archetypes.a_wm_inv_01_2={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_bombthrower_level_1",min:1,max:1},{archetype:"a_e_treasuredropper_level_1",
min:1,max:1}]},{postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_1",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_bombthrower_level_1",min:3,max:3}]},{postThresholdDelay:5,families:[{archetype:"a_e_bombthrower_level_1",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_1",min:2,max:2},{archetype:"a_e_bombthrower_level_1",min:2,max:2}]},{postThresholdDelay:7,families:[{archetype:"a_e_basicmelee_level_1",
min:2,max:2},{archetype:"a_e_bombthrower_level_1",min:1,max:1}]}]}};e.archetypes.a_wm_inv_02_1={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_ranged_level_2",min:1,max:1}]},{postThresholdDelay:5,families:[{archetype:"a_e_ranged_level_2",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_ranged_level_2",min:1,max:1},{archetype:"a_e_basicmelee_level_2",min:1,max:1}]},{postThresholdDelay:5,families:[{archetype:"a_e_ranged_level_2",
min:1,max:1},{archetype:"a_e_basicmelee_level_2",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_ranged_level_2",min:2,max:2},{archetype:"a_e_basicmelee_level_2",min:1,max:1}]},{postThresholdDelay:7,families:[{archetype:"a_e_basicmelee_level_2",min:2,max:2}]}]}};e.archetypes.a_wm_inv_02_2={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_ranged_level_2",min:1,max:1},{archetype:"a_e_bombthrower_level_2",
min:1,max:1}]},{postThresholdDelay:5,families:[{archetype:"a_e_bombthrower_level_2",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_ranged_level_2",min:1,max:1},{archetype:"a_e_bombthrower_level_2",min:1,max:1},{archetype:"a_e_treasuredropper_level_2",min:1,max:1}]},{postThresholdDelay:5,families:[{archetype:"a_e_ranged_level_2",min:1,max:1},{archetype:"a_e_bombthrower_level_2",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_charger_level_2",
min:1,max:1},{archetype:"a_e_bombthrower_level_2",min:1,max:1}]},{postThresholdDelay:7,families:[{archetype:"a_e_ranged_level_2",min:1,max:1},{archetype:"a_e_bombthrower_level_2",min:1,max:1}]}]}};e.archetypes.a_wm_inv_03_1={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_bombthrower_level_3",min:2,max:2}]},{postThresholdDelay:4,families:[{archetype:"a_e_bombthrower_level_3",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_bombthrower_level_3",
min:1,max:1},{archetype:"a_e_ranged_level_3",min:1,max:1}]},{postThresholdDelay:3,families:[{archetype:"a_e_ranged_level_3",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_bombthrower_level_3",min:1,max:1},{archetype:"a_e_ranged_level_3",min:2,max:2}]},{postThresholdDelay:7,families:[{archetype:"a_e_bombthrower_level_3",min:1,max:1}]}]}};e.archetypes.a_wm_inv_03_2={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_basicmelee_level_3",
min:2,max:2}]},{postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_3",min:2,max:2},{archetype:"a_e_charger_level_3",min:2,max:2}]},{postThresholdDelay:8,families:[{archetype:"a_e_basicmelee_level_3",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_3",min:2,max:2}]},{postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_3",min:3,max:3},{archetype:"a_e_bombthrower_level_3",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_bombthrower_level_3",
min:2,max:2},{archetype:"a_e_charger_level_3",min:1,max:1},{archetype:"a_e_treasuredropper_level_1",min:1,max:1}]},{postThresholdDelay:5,families:[{archetype:"a_e_bombthrower_level_3",min:1,max:1},{archetype:"a_e_charger_level_3",min:1,max:1}]}]}};e.archetypes.a_wm_inv_03_3={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_bombthrower_level_3",min:2,max:2},{archetype:"a_e_ranged_level_3",min:2,max:2}]},{postThresholdDelay:5,families:[{archetype:"a_e_bombthrower_level_3",
min:1,max:1}]},{postThresholdDelay:5,families:[{archetype:"a_e_bombthrower_level_3",min:2,max:2},{archetype:"a_e_ranged_level_3",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_charger_boss_level_3",min:1,max:1}]},{postThresholdDelay:5,families:[{archetype:"a_e_bombthrower_level_3",min:2,max:2}]},{postThresholdDelay:10,families:[{archetype:"a_e_bombthrower_level_3",min:2,max:2}]}]}};e.archetypes.a_wm_inv_04_1={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,
postThresholdDelay:0,families:[{archetype:"a_e_berserker_level_4",min:1,max:1},{archetype:"a_e_basicmelee_level_4",min:1,max:1}]},{postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_4",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_berserker_level_4",min:1,max:1},{archetype:"a_e_basicmelee_level_4",min:2,max:2}]},{postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_4",min:3,max:3},{archetype:"a_e_bombthrower_level_4",min:1,max:1}]},{enemyThreshold:0,
postThresholdDelay:0,families:[{archetype:"a_e_bombthrower_level_4",min:2,max:2},{archetype:"a_e_berserker_level_4",min:1,max:1}]},{postThresholdDelay:5,families:[{archetype:"a_e_bombthrower_level_4",min:3,max:3}]}]}};e.archetypes.a_wm_inv_04_2={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_berserker_level_4",min:1,max:1},{archetype:"a_e_ranged_level_4",min:2,max:2}]},{postThresholdDelay:10,families:[{archetype:"a_e_ranged_level_4",
min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_ranged_level_4",min:2,max:2},{archetype:"a_e_basicmelee_level_4",min:2,max:2}]},{postThresholdDelay:8,families:[{archetype:"a_e_basicmelee_level_4",min:2,max:2},{archetype:"a_e_ranged_level_4",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_basicmelee_level_4",min:3,max:3},{archetype:"a_e_berserker_level_4",min:1,max:1}]},{postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_4",
min:3,max:3}]}]}};e.archetypes.a_wm_inv_04_3={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_berserker_level_4",min:1,max:1},{archetype:"a_e_basicmelee_level_4",min:2,max:2}]},{postThresholdDelay:5,families:[{archetype:"a_e_charger_level_2",min:1,max:1},{archetype:"a_e_basicmelee_level_4",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_berserker_level_4",min:1,max:1},{archetype:"a_e_charger_level_2",
min:2,max:2}]},{postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_4",min:3,max:3},{archetype:"a_e_treasuredropper_level_1",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_death",min:1,max:1}]},{postThresholdDelay:5,families:[{archetype:"a_e_bombthrower_level_4",min:2,max:2}]},{postThresholdDelay:5,families:[{archetype:"a_e_charger_level_2",min:2,max:2},{archetype:"a_e_bombthrower_level_4",min:2,max:2}]}]}};e.archetypes.a_wm_inv_05_1={shouldPlayerSave:!1,
ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_charger_level_5",min:2,max:2},{archetype:"a_e_basicmelee_level_5",min:2,max:2}]},{postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_5",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_5",min:5,max:5}]},{postThresholdDelay:5,families:[{archetype:"a_e_charger_level_5",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_charger_level_5",
min:3,max:3},{archetype:"a_e_basicmelee_level_5",min:2,max:2}]},{postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_5",min:3,max:3}]}]}};e.archetypes.a_wm_inv_05_2={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_charger_level_5",min:1,max:1},{archetype:"a_e_berserker_level_5",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_charger_level_5",min:3,max:3}]},{postThresholdDelay:7,families:[{archetype:"a_e_berserker_level_5",
min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_berserker_level_5",min:2,max:2}]},{postThresholdDelay:10,families:[{archetype:"a_e_berserker_level_5",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_charger_level_5",min:2,max:2},{archetype:"a_e_berserker_level_5",min:1,max:1}]},{postThresholdDelay:10,families:[{archetype:"a_e_charger_level_5",min:2,max:2}]}]}};e.archetypes.a_wm_inv_05_3={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,
postThresholdDelay:0,families:[{archetype:"a_e_bombthrower_level_5",min:4,max:4}]},{postThresholdDelay:7,families:[{archetype:"a_e_charger_level_5",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_charger_level_5",min:1,max:1},{archetype:"a_e_bombthrower_level_5",min:4,max:4}]},{postThresholdDelay:7,families:[{archetype:"a_e_charger_level_5",min:1,max:1},{archetype:"a_e_bombthrower_level_5",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{archetype:"a_e_charger_boss_level_5",
min:2,max:2}]}]}};e.archetypes.a_wm_inv_06={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:0,families:[{archetype:"a_e_basicmelee_level_6",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_6",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_6",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_6",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:5,
families:[{archetype:"a_e_basicmelee_level_6",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_6",min:1,max:1}]}]}};e.archetypes.a_wm_inv_r2_test_01={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:0,families:[{archetype:"a_e_basicmelee_level_3",min:2,max:2}]},{postThresholdDelay:3,families:[{archetype:"a_e_basicmelee_level_3",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_3",min:3,
max:3}]},{postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_3",min:3,max:3}]},{postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_3",min:2,max:2},{archetype:"a_e_bombthrower_level_3",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_bombthrower_level_3",min:3,max:3}]},{postThresholdDelay:5,families:[{archetype:"a_e_bombthrower_level_3",min:3,max:3},{archetype:"a_e_ranged_level_3",min:1,max:1},{archetype:"a_e_berserker_level_3",min:1,max:1}]},
{postThresholdDelay:8,families:[{archetype:"a_e_bombthrower_level_3",min:2,max:2}]}]}};e.archetypes.a_wm_inv_r2_test_02={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_3",min:1,max:1}]},{postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_3",min:3,max:3}]},{postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_3",min:1,max:1},{archetype:"a_e_bombthrower_level_3",min:2,max:2}]},{enemyThreshold:0,
postThresholdDelay:5,families:[{archetype:"a_e_charger_level_3",min:2,max:2}]},{postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_3",min:2,max:2}]},{postThresholdDelay:5,families:[{archetype:"a_e_charger_level_3",min:1,max:1},{archetype:"a_e_basicmelee_level_3",min:3,max:3}]}]}};e.archetypes.a_wm_inv_r2_test_03={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_3",min:1,max:1},{archetype:"a_e_ranged_level_3",
min:2,max:2}]},{postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_3",min:2,max:2}]},{postThresholdDelay:5,families:[{archetype:"a_e_ranged_level_3",min:1,max:1},{archetype:"a_e_bombthrower_level_3",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_3",min:3,max:3},{archetype:"a_e_death_level_3",min:1,max:1}]},{postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_3",min:1,max:1},{archetype:"a_e_bombthrower_level_3",min:1,max:1}]},
{postThresholdDelay:5,families:[{archetype:"a_e_basicmelee_level_3",min:2,max:2},{archetype:"a_e_bombthrower_level_3",min:2,max:2}]}]}};e.archetypes.a_wm_trickle_01={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:3,postThresholdDelay:0,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,
max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},
{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,
postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,
families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",
min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,
max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:10,families:[{archetype:"a_e_commando_level_1",min:1,max:1}]}]}};
e.archetypes.a_wm_trickle_02={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:3,postThresholdDelay:0,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,
families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",
min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},
{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,
postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,
families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_2",min:1,max:1}]}]}};e.archetypes.a_wm_trickle_03={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:3,postThresholdDelay:0,families:[{archetype:"a_e_commando_level_3",
min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},
{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,
postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,
families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",
min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},
{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,
postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,
families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",
min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_3",min:1,max:1}]}]}};e.archetypes.a_wm_trickle_04={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:3,postThresholdDelay:0,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,
postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,
families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",
min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},
{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,
postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,
families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",
min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},
{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,
postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,
families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",
min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_4",min:1,max:1}]}]}};e.archetypes.a_wm_trickle_05={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:3,postThresholdDelay:0,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,
postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,
families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",
min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},
{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,
postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,
families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",
min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},
{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,
postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,
families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",min:1,max:1}]},{enemyThreshold:3,postThresholdDelay:5,families:[{archetype:"a_e_commando_level_5",
min:1,max:1}]}]}};var tk={normal:{buildingNameTextId:"INFO_PANEL_DEFAULT_UPGRADE_TITLE",buildingDescriptionTextId:"INFO_PANEL_DEFAULT_BUILDING_DESCRIPTION",contentsList:["dualResourceProgressBars","buildDurationBar","resourceSep","healthBoostBar"]},workshop:{buildingNameTextId:"INFO_PANEL_WORKSHOP_UPGRADE_TITLE",buildingDescriptionTextId:"INFO_PANEL_WORKSHOP_BUILDING_DESCRIPTION",contentsList:["dualResourceProgressBars","buildDurationBar","resourceSep","healthBoostBar","newBuildOptionsBox"]},gate:{buildingNameTextId:"INFO_PANEL_GATE_UPGRADE_TITLE",
buildingDescriptionTextId:"INFO_PANEL_GATE_BUILDING_DESCRIPTION",contentsList:["dualResourceProgressBars","buildDurationBar","resourceSep","healthBoostBar"]},hq:{buildingNameTextId:"INFO_PANEL_HQ_UPGRADE_TITLE",buildingDescriptionTextId:"INFO_PANEL_HQ_BUILDING_DESCRIPTION",contentsList:"dualResourceProgressBars buildDurationBar resourceSep healthBoostBar lumberStorageBoostBar stoneStorageBoostBar newBuildOptionsBox".split(" ")},library:{buildingNameTextId:"INFO_PANEL_LIBRARY_UPGRADE_TITLE",buildingDescriptionTextId:"INFO_PANEL_LIBRARY_BUILDING_DESCRIPTION",
contentsList:["dualResourceProgressBars","buildDurationBar","resourceSep","healthBoostBar"]},lumbermill:{buildingNameTextId:"INFO_PANEL_LUMBERMILL_UPGRADE_TITLE",buildingDescriptionTextId:"INFO_PANEL_LUMBERMILL_BUILDING_DESCRIPTION",contentsList:["dualResourceProgressBars","buildDurationBar","resourceSep","healthBoostBar","newBuildOptionsBox"]},lumber_storage:{buildingNameTextId:"INFO_PANEL_LUMBER_STORAGE_UPGRADE_TITLE",buildingDescriptionTextId:"INFO_PANEL_LUMBER_STORAGE_BUILDING_DESCRIPTION",contentsList:["dualResourceProgressBars",
"buildDurationBar","resourceSep","healthBoostBar","lumberStorageBoostBar"]},outpost:{buildingNameTextId:"INFO_PANEL_OUTPOST_UPGRADE_TITLE",buildingDescriptionTextId:"INFO_PANEL_OUTPOST_BUILDING_DESCRIPTION",contentsList:["dualResourceProgressBars","buildDurationBar","resourceSep","healthBoostBar","newBuildOptionsBox"]},stonemill:{buildingNameTextId:"INFO_PANEL_STONEMILL_UPGRADE_TITLE",buildingDescriptionTextId:"INFO_PANEL_STONEMILL_BUILDING_DESCRIPTION",contentsList:["dualResourceProgressBars","buildDurationBar",
"resourceSep","healthBoostBar","newBuildOptionsBox"]},stone_storage:{buildingNameTextId:"INFO_PANEL_STONE_STORAGE_UPGRADE_TITLE",buildingDescriptionTextId:"INFO_PANEL_STONE_STORAGE_BUILDING_DESCRIPTION",contentsList:["dualResourceProgressBars","buildDurationBar","resourceSep","healthBoostBar","stoneStorageBoostBar"]},tower:{buildingNameTextId:"INFO_PANEL_TOWER_UPGRADE_TITLE",buildingDescriptionTextId:"INFO_PANEL_TOWER_BUILDING_DESCRIPTION",contentsList:["dualResourceProgressBars","buildDurationBar",
"resourceSep","healthBoostBar"]},wall:{buildingNameTextId:"INFO_PANEL_WALL_UPGRADE_TITLE",buildingDescriptionTextId:"INFO_PANEL_WALL_BUILDING_DESCRIPTION",contentsList:["dualResourceProgressBars","buildDurationBar","resourceSep","healthBoostBar"]},warfactory:{buildingNameTextId:"INFO_PANEL_WAR_FACTORY_UPGRADE_TITLE",buildingDescriptionTextId:"INFO_PANEL_WAR_FACTORY_BUILDING_DESCRIPTION",contentsList:["dualResourceProgressBars","buildDurationBar","resourceSep","healthBoostBar","newBuildOptionsBox"]},
wildlinghouse_lumber:{buildingNameTextId:"INFO_PANEL_WILDLINGHOUSE_LUMBER_UPGRADE_TITLE",buildingDescriptionTextId:"INFO_PANEL_WILDLINGHOUSE_LUMBER_BUILDING_DESCRIPTION",contentsList:["dualResourceProgressBars","buildDurationBar","resourceSep","healthBoostBar","wildlingPrimaryResourceCollectionBoostBar"]},wildlinghouse_stone:{buildingNameTextId:"INFO_PANEL_WILDLINGHOUSE_STONE_UPGRADE_TITLE",buildingDescriptionTextId:"INFO_PANEL_WILDLINGHOUSE_STONE_BUILDING_DESCRIPTION",contentsList:["dualResourceProgressBars",
"buildDurationBar","resourceSep","healthBoostBar","wildlingSecondaryResourceCollectionBoostBar"]},wildlinghouse_war:{buildingNameTextId:"INFO_PANEL_WILDLINGHOUSE_WAR_UPGRADE_TITLE",buildingDescriptionTextId:"INFO_PANEL_WILDLINGHOUSE_WAR_BUILDING_DESCRIPTION",contentsList:["dualResourceProgressBars","buildDurationBar","resourceSep","healthBoostBar"]}};e.archetypes.a_b_amberwell={shouldPlayerSave:!0,ECMesh:{scale:0.9,offsetY:-0.5,path:"environment/models/e_b_amberwell.dae",localOffset:[0,0,0]},ECPhysicsCube:{scaleMesh:!1,
stationary:!0,v3Scale:[2,2,2],offsetY:0.5,terrainType:"building"},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECBuilding:{resourceCost:0,secondaryResourceCost:100,buildingType:"Amber Well",autoRebuild:!0,buildTime:15,level:1,obeysScaffoldCap:!1,addedFootprintSize:1,importantBuildingForDamage:!1},ECEntityDispenser:{contents:[{archetype:"a_r_big_amber",quantity:10}],cooldownTime:82800,refillingGuiArchetype:"amberWellProgressBar",drawCooldown:!0,dispenseSFX:"none",useRadial:!1},ECRadialMenu:e.EC_DEFAULT};
e.archetypes.a_b_amberwellOwned={shouldPlayerSave:!0,ECMesh:{scale:0.9,offsetY:-0.5,path:"environment/models/e_b_amberwell.dae",localOffset:[0,0,0]},ECPhysicsCube:{scaleMesh:!1,stationary:!0,v3Scale:[2,2,2],offsetY:0.5,terrainType:"building"},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECBuilding:{resourceCost:0,secondaryResourceCost:100,buildingType:"Amber Well Owned",autoRebuild:!0,buildTime:15,level:1,obeysScaffoldCap:!1,addedFootprintSize:1,importantBuildingForDamage:!1},ECEntityDispenser:{contents:[{archetype:"a_r_big_amber",
quantity:10}],cooldownTime:82800,refillingGuiArchetype:"amberWellProgressBar",drawCooldown:!0,dispenseSFX:"none",useRadial:!1},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_amberchest={shouldPlayerSave:!0,familyName:"amberchest",ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_amberchest.dae",localOffset:[0,0,0]},ECPhysicsCube:{scaleMesh:!1,stationary:!0,v3Scale:[2,2,2],offsetY:0.5,terrainType:"building"},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECBuilding:{resourceCost:0,secondaryResourceCost:400,
buildingType:"Treasure Chest",autoRebuild:!0,buildTime:0,level:1,obeysScaffoldCap:!1,addedFootprintSize:1,importantBuildingForDamage:!1,prerequisites:[{buildingType:"Treasure Chest",minimumQuantity:0,maximumQuantity:1}]},ECEntityDispenser:{contents:[{archetype:"a_r_amber",quantity:5},{archetype:"a_r_amber",quantity:10},{archetype:"a_r_amber",quantity:15}],cooldownTime:82800,refillingGuiArchetype:"amberChestProgressBar",drawCooldown:!0,dispenseSFX:"none",useRadial:!1},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_defencefactory=
{shouldPlayerSave:!0,familyName:"Defence Factory",ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_warfactory.dae",localOffset:[0,0,0]},ECPhysicsCube:{stationary:!0,v3Scale:[4,3,4],offsetY:1,scaleMesh:!1,terrainType:"building"},ECHealth:{health:e.balanceBuildings.a_b_defencefactory.health,drawInWorldBarIfDamagedRecently:!0,drawOffScreenIconIfDamagedRecently:!0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECBuilding:{buildTime:e.balanceBuildings.a_b_defencefactory.buildTime,resourceCost:e.balanceBuildings.a_b_defencefactory.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_defencefactory.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Defence Factory",buildingName:"Defence Factory",level:1,addedFootprintSize:2,prerequisites:[{buildingType:"HQ",level:1}]},ECPlacedBuildingTracker:{canMoveIfBuildingsAlreadyPlaced:!0,localCaps:[{buildingType:"Defendling Hut",quantity:1}]},ECBuildingPlacementRadius:{buildingRadius:12},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_defencefactory.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_b_defencefactory.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 2",upgradeArchetypeName:"a_b_defencefactory_level_2",upgradeInfo:"warfactory"},ECUpgrader:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECTarget:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECDispenser:{contents:[]},ECSockets:{sockets:[{archetypeName:"a_b_defendlinghutworkshop",localOffset:[3*Math.cos(2*Math.PI/3),0.5,3*Math.sin(2*Math.PI/3)]},{archetypeName:"a_b_libraryworkshop",localOffset:[3*Math.cos(4*
Math.PI/3),0.5,3*Math.sin(4*Math.PI/3)]},{archetypeName:"a_b_outpostworkshop",localOffset:[3*Math.cos(6*Math.PI/3),0.5,3*Math.sin(6*Math.PI/3)]}]},ECEffectSpawner:{onCreateEffect:"sfx_crt_building",onDeathEffect:"sfx_dth_building"},ECWorldGui:{text1:"Defence Factory",text2:"Level 1",onScreenGuiArchetype:"tipDefenceFactory",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_b_defencefactory_level_2={shouldPlayerSave:!0,parent:"a_b_defencefactory",
ECMesh:{path:"environment/models/e_b_warfactory_level02.dae"},ECHealth:{health:e.balanceBuildings.a_b_defencefactory_level_2.health},ECBuilding:{buildTime:e.balanceBuildings.a_b_defencefactory_level_2.buildTime,resourceCost:e.balanceBuildings.a_b_defencefactory_level_2.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_defencefactory_level_2.secondaryResourceCost,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Defence Factory",level:2,prerequisites:[{buildingType:"HQ",level:2}]},
ECPlacedBuildingTracker:{localCaps:[{buildingType:"Defendling Hut",quantity:1}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_defencefactory_level_2.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_defencefactory_level_2.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 3",upgradeArchetypeName:"a_b_defencefactory_level_3"},ECWorldGui:{text2:"Level 2"}};e.archetypes.a_b_defencefactory_level_3={shouldPlayerSave:!0,parent:"a_b_defencefactory_level_2",ECMesh:{path:"environment/models/e_b_warfactory_level03.dae"},
ECHealth:{health:e.balanceBuildings.a_b_defencefactory_level_3.health},ECBuilding:{buildTime:e.balanceBuildings.a_b_defencefactory_level_3.buildTime,resourceCost:e.balanceBuildings.a_b_defencefactory_level_3.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_defencefactory_level_3.secondaryResourceCost,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Defence Factory",level:3,prerequisites:[{buildingType:"HQ",level:3}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Defendling Hut",
quantity:2}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_defencefactory_level_3.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_defencefactory_level_3.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 4",upgradeArchetypeName:"a_b_defencefactory_level_4"},ECWorldGui:{text2:"Level 3"}};e.archetypes.a_b_defencefactory_level_4={shouldPlayerSave:!0,parent:"a_b_defencefactory_level_3",ECMesh:{path:"environment/models/e_b_warfactory_level04.dae"},ECHealth:{health:e.balanceBuildings.a_b_defencefactory_level_4.health},
ECBuilding:{buildTime:e.balanceBuildings.a_b_defencefactory_level_4.buildTime,resourceCost:e.balanceBuildings.a_b_defencefactory_level_4.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_defencefactory_level_4.secondaryResourceCost,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Defence Factory",level:4,prerequisites:[{buildingType:"HQ",level:4}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Defendling Hut",quantity:2}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_defencefactory_level_4.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_b_defencefactory_level_4.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 5",upgradeArchetypeName:"a_b_defencefactory_level_5"},ECWorldGui:{text2:"Level 4"}};e.archetypes.a_b_defencefactory_level_5={shouldPlayerSave:!0,parent:"a_b_defencefactory_level_4",ECMesh:{path:"environment/models/e_b_warfactory_level05.dae"},ECHealth:{health:e.balanceBuildings.a_b_defencefactory_level_5.health},ECBuilding:{buildTime:e.balanceBuildings.a_b_defencefactory_level_5.buildTime,
resourceCost:e.balanceBuildings.a_b_defencefactory_level_5.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_defencefactory_level_5.secondaryResourceCost,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Defence Factory",level:5,prerequisites:[{buildingType:"HQ",level:5}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Defendling Hut",quantity:3}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_defencefactory_level_5.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_defencefactory_level_5.maxResourceRepairCost},
ECUpgradable:{upgradeName:"Level 6",upgradeArchetypeName:"a_b_defencefactory_level_6"},ECWorldGui:{text2:"Level 5"}};e.archetypes.a_b_defencefactory_level_6={shouldPlayerSave:!0,parent:"a_b_defencefactory_level_5",ECMesh:{path:"environment/models/e_b_warfactory_level06.dae"},ECHealth:{health:e.balanceBuildings.a_b_defencefactory_level_6.health},ECBuilding:{buildTime:e.balanceBuildings.a_b_defencefactory_level_6.buildTime,resourceCost:e.balanceBuildings.a_b_defencefactory_level_6.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_defencefactory_level_6.secondaryResourceCost,
obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Defence Factory",level:6,prerequisites:[{buildingType:"HQ",level:6}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Defendling Hut",quantity:3}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_defencefactory_level_6.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_defencefactory_level_6.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 7",upgradeArchetypeName:"a_b_defencefactory_level_7"},ECWorldGui:{text2:"Level 6"}};
e.archetypes.a_b_defencefactory_level_7={shouldPlayerSave:!0,parent:"a_b_defencefactory_level_6",ECMesh:{path:"environment/models/e_b_warfactory_level07.dae"},ECHealth:{health:e.balanceBuildings.a_b_defencefactory_level_7.health},ECBuilding:{buildTime:e.balanceBuildings.a_b_defencefactory_level_7.buildTime,resourceCost:e.balanceBuildings.a_b_defencefactory_level_7.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_defencefactory_level_7.secondaryResourceCost,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,
buildingType:"Defence Factory",level:7,prerequisites:[{buildingType:"HQ",level:7}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Defendling Hut",quantity:4}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_defencefactory_level_7.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_defencefactory_level_7.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 8",upgradeArchetypeName:"a_b_defencefactory_level_8"},ECWorldGui:{text2:"Level 7"}};e.archetypes.a_b_defendlinghutworkshop=
{shouldPlayerSave:!0,ECMesh:{scale:1.5*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/factory_wildling.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:0.75,offsetY:0.4,path:"textures/glowfull.dds",additive:!0,color:[1,54/255,0,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{contents:[{dispenseName:"Defendling Hut",dispensedArchetypeName:"a_b_wildlinghouse_war",stackableInHand:!1,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};
e.archetypes.a_b_defencefactory_level_8={shouldPlayerSave:!0,parent:"a_b_defencefactory_level_7",ECMesh:{path:"environment/models/e_b_warfactory_level08.dae"},ECHealth:{health:e.balanceBuildings.a_b_defencefactory_level_8.health},ECBuilding:{buildTime:e.balanceBuildings.a_b_defencefactory_level_8.buildTime,resourceCost:e.balanceBuildings.a_b_defencefactory_level_8.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_defencefactory_level_8.secondaryResourceCost,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,
buildingType:"Defence Factory",level:8,prerequisites:[{buildingType:"HQ",level:8}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Defendling Hut",quantity:4}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_defencefactory_level_7.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_defencefactory_level_7.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 9",upgradeArchetypeName:"a_b_defencefactory_level_9"},ECWorldGui:{text2:"Level 8"}};e.archetypes.a_b_defendlinghutworkshop=
{shouldPlayerSave:!0,ECMesh:{scale:1.5,offsetY:0,path:"environment/models/factory_wildling.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{contents:[{dispenseName:"Defendling Hut",dispensedArchetypeName:"a_b_wildlinghouse_war",stackableInHand:!1,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_defencefactory_level_9={shouldPlayerSave:!0,parent:"a_b_defencefactory_level_8",ECMesh:{path:"environment/models/e_b_warfactory_level09.dae"},
ECHealth:{health:e.balanceBuildings.a_b_defencefactory_level_9.health},ECBuilding:{buildTime:e.balanceBuildings.a_b_defencefactory_level_9.buildTime,resourceCost:e.balanceBuildings.a_b_defencefactory_level_9.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_defencefactory_level_9.secondaryResourceCost,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Defence Factory",level:9,prerequisites:[{buildingType:"HQ",level:9}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Defendling Hut",
quantity:4}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_defencefactory_level_7.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_defencefactory_level_7.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 10",upgradeArchetypeName:"a_b_defencefactory_level_10"},ECWorldGui:{text2:"Level 9"}};e.archetypes.a_b_defendlinghutworkshop={shouldPlayerSave:!0,ECMesh:{scale:1.5,offsetY:0,path:"environment/models/factory_wildling.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,
ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{contents:[{dispenseName:"Defendling Hut",dispensedArchetypeName:"a_b_wildlinghouse_war",stackableInHand:!1,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_defencefactory_level_10={shouldPlayerSave:!0,parent:"a_b_defencefactory_level_9",ECMesh:{path:"environment/models/e_b_warfactory_level010.dae"},ECHealth:{health:e.balanceBuildings.a_b_defencefactory_level_10.health},ECBuilding:{buildTime:e.balanceBuildings.a_b_defencefactory_level_10.buildTime,
resourceCost:e.balanceBuildings.a_b_defencefactory_level_10.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_defencefactory_level_10.secondaryResourceCost,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Defence Factory",level:10,prerequisites:[{buildingType:"HQ",level:10}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Defendling Hut",quantity:4}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_defencefactory_level_10.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_defencefactory_level_10.maxResourceRepairCost},
ECUpgradable:e.EC_REMOVE,ECWorldGui:{text2:"Level 10"}};e.archetypes.a_b_defendlinghutworkshop={shouldPlayerSave:!0,familyName:"defendlinghutworkshop",ECMesh:{scale:1.5*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/factory_wildling.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{meshWhenCapReached:"environment/models/factorywildlingshell.dae",contents:[{dispenseName:"Defendling Hut",dispensedArchetypeName:"a_b_wildlinghouse_war",
stackableInHand:!1,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_heroShrineOfAgility={shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"totemAgility",ECMesh:{scale:1,offsetY:0,path:"environment/models/e_i_shrineofagility.dae",localOffset:[0,0,0]},ECSockets:{sockets:[{archetypeName:"v_socket_glow_purple_small",localOffset:[0,1,1]},{archetypeName:"v_socket_glow_purple_medium",localOffset:[0,2.5,1]},{archetypeName:"v_socket_glow_purple_particulate",localOffset:[0,1.5,0]},{archetypeName:"v_socket_glow_purple_particulate_large",
localOffset:[0,1.5,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[2,2,2],offsetY:0.5,scaleMesh:!1,terrainType:"building"},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECHeroShrine:{svgPath:"gui/icon_totem_agility_n.svg",upgradeTypes:[{upgradeDisplayName:"Spirit of Speed (+ Speed)",upgradeType:"movementSpeed",minimumHeroLevel:0,prerequisiteText:"None",prerequisites:[],levels:[{levelText:"Base Level"},{levelText:"Faster Movement"},{levelText:"Faster Movement"},{levelText:"Faster Movement"},
{levelText:"Faster Movement"},{levelText:"Faster Movement"}]},{upgradeDisplayName:"Spirit of Labour (+ Carry Speed)",upgradeType:"carrySpeed",minimumHeroLevel:5,prerequisiteText:"Spirit of Speed",prerequisites:[{upgradeType:"movementSpeed",level:1}],levels:[{levelText:"Base Level"},{levelText:"Faster when carrying"},{levelText:"Faster when carrying"},{levelText:"Faster when carrying"},{levelText:"Faster when carrying"},{levelText:"Faster when carrying"}]}]},ECWorldGui:{text1:"Totem of",text2:"Agility",
onScreenGuiArchetype:"tipTotem",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_b_heroShrineOfPower={shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"totemPower",ECMesh:{scale:1,offsetY:0,path:"environment/models/e_i_shrineofpower.dae",localOffset:[0,0,0]},ECSockets:{sockets:[{archetypeName:"v_socket_glow_purple_small",localOffset:[0,1,1]},{archetypeName:"v_socket_glow_purple_medium",localOffset:[0,2.5,1]},{archetypeName:"v_socket_glow_purple_particulate",
localOffset:[0,1.5,0]},{archetypeName:"v_socket_glow_purple_particulate_large",localOffset:[0,1.5,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[2,2,2],offsetY:0.5,scaleMesh:!1,terrainType:"building"},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECHeroShrine:{svgPath:"gui/icon_totem_power_n.svg",upgradeTypes:[{upgradeDisplayName:"Spirit of Fire (+ Damage)",upgradeType:"shotgunDamage",minimumHeroLevel:0,prerequisiteText:"None",prerequisites:[],levels:[{levelText:"Base Level"},
{levelText:"Do more damage"},{levelText:"Do more damage"},{levelText:"Do more damage"},{levelText:"Do more damage"},{levelText:"Do more damage"}]},{upgradeDisplayName:"Spirit of Haste (+ Reload Speed)",upgradeType:"reloadSpeed",minimumHeroLevel:5,prerequisiteText:"Spirit of Fire",prerequisites:[{upgradeType:"shotgunDamage",level:1}],levels:[{levelText:"Base Level"},{levelText:"Reload faster"},{levelText:"Reload faster"},{levelText:"Reload faster"},{levelText:"Reload faster"},{levelText:"Reload faster"}]}]},
ECWorldGui:{text1:"Totem of",text2:"Power",onScreenGuiArchetype:"tipTotem",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_b_heroShrineOfProtection={shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"totemProtection",ECMesh:{scale:1,offsetY:0,path:"environment/models/e_i_shrineofprotection.dae",localOffset:[0,0,0]},ECSockets:{sockets:[{archetypeName:"v_socket_glow_purple_small",localOffset:[0,1,1]},{archetypeName:"v_socket_glow_purple_medium",
localOffset:[0,2.5,1.6]},{archetypeName:"v_socket_glow_purple_particulate",localOffset:[0,1.5,0]},{archetypeName:"v_socket_glow_purple_particulate_large",localOffset:[0,1.5,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[2,2,2],offsetY:0.5,scaleMesh:!1,terrainType:"building"},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECHeroShrine:{svgPath:"gui/icon_totem_protection_n.svg",upgradeTypes:[{upgradeDisplayName:"Spirit of Heart (+ Health)",upgradeType:"maxHealth",minimumHeroLevel:0,
prerequisiteText:"None",prerequisites:[],levels:[{levelText:"Base Level"},{levelText:"Health Increase"},{levelText:"Health Increase"},{levelText:"Health Increase"},{levelText:"Health Increase"},{levelText:"Health Increase"}]},{upgradeDisplayName:"Spirit of Fortitude (+ Damage Resistance)",upgradeType:"explosionDamage",minimumHeroLevel:5,prerequisiteText:"Spirit of Heart",prerequisites:[{levelText:"Base Level"},{upgradeType:"maxHealth",level:1}],levels:[{levelText:"Base Level"},{levelText:"Reduce damage taken"},
{levelText:"Reduce damage taken"},{levelText:"Reduce damage taken"},{levelText:"Reduce damage taken"},{levelText:"Reduce damage taken"}]}]},ECWorldGui:{text1:"Totem of",text2:"Protection",onScreenGuiArchetype:"tipTotem",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_b_heroShrineOfTechnology={shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"totemTechnology",ECMesh:{scale:1,offsetY:0,path:"environment/models/e_i_shrineoftechnology.dae",localOffset:[0,
0,0]},ECSockets:{sockets:[{archetypeName:"v_socket_glow_purple_small",localOffset:[0,1,1]},{archetypeName:"v_socket_glow_purple_medium",localOffset:[0,2.5,1]},{archetypeName:"v_socket_glow_purple_particulate",localOffset:[0,1.5,0]},{archetypeName:"v_socket_glow_purple_particulate_large",localOffset:[0,1.5,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[2,2,2],offsetY:0.5,scaleMesh:!1,terrainType:"building"},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECHeroShrine:{svgPath:"gui/icon_totem_tech_n.svg",
upgradeTypes:[{upgradeDisplayName:"Spirit of Strength (+ Carry Capacity)",upgradeType:"carryCapacity",minimumHeroLevel:0,prerequisiteText:"None",prerequisites:[],levels:[{levelText:"Base Level"},{levelText:"Carry more Stone or Lumber"},{levelText:"Carry more Stone or Lumber"},{levelText:"Carry more Stone or Lumber"},{levelText:"Carry more Stone or Lumber"},{levelText:"Carry more Stone or Lumber"}]},{upgradeDisplayName:"Spirit of Might (+ Chop Damage)",upgradeType:"chopEffectiveness",minimumHeroLevel:5,
prerequisiteText:"Spirit of Strength",prerequisites:[{upgradeType:"carryCapacity",level:1}],levels:[{levelText:"Base Level"},{levelText:"Mine or chop faster"},{levelText:"Mine or chop faster"},{levelText:"Mine or chop faster"},{levelText:"Mine or chop faster"},{levelText:"Mine or chop faster"}]}]},ECWorldGui:{text1:"Totem of",text2:"Technology",onScreenGuiArchetype:"tipTotem",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.v_socket_glow_purple_small=
{ECSprite:{size:1.5,offsetY:0,path:"textures/glowfull.dds",additive:!0,color:[175/255,47/255,164/255,0.2]}};e.archetypes.v_socket_glow_purple_medium={ECSprite:{size:8,offsetY:0,path:"textures/glowstumpy.dds",additive:!0,color:[175/255,47/255,164/255,0.4]}};e.archetypes.v_socket_glow_purple_particulate={ECSprite:{size:2,offsetY:0,path:"textures/particulate.dds",additive:!0,rotationSpeed:0.08,color:[175/255,47/255,164/255,0.8]}};e.archetypes.v_socket_glow_purple_particulate_large={ECSprite:{size:6,
offsetY:0,path:"textures/particulate.dds",additive:!0,rotationSpeed:-0.08,color:[175/255,47/255,164/255,0.4]}};A.archetypes.dg_b_hq_explode=A.create("Explosion",{damage:10,forceBack:0,forceLift:1.5,forceRadial:1,forceTangential:0,friendlyFire:0,radius:10,isExplosion:!0});e.archetypes.a_b_hq={shouldPlayerSave:!0,familyName:"hq",ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_headquarter.dae",localOffset:[0,0,0]},ECPhysicsCube:{scaleMesh:!1,stationary:!0,v3Scale:[3,3,3],offsetY:1,terrainType:"building"},
ECHealth:{health:e.balanceBuildings.a_b_hq.health,drawInWorldBarIfDamagedRecently:!0,drawOffScreenIconIfDamagedRecently:!0},ECHealthRegenerator:{radius:8},ECGameCritical:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECTarget:e.EC_DEFAULT,ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECBuilding:{resourceCost:e.balanceBuildings.a_b_hq.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_hq.secondaryResourceCost,buildingType:"HQ",autoRebuild:!0,buildTime:e.balanceBuildings.a_b_hq.buildTime,level:1,
obeysScaffoldCap:!0,defenceLevel:1,addedFootprintSize:3,globalCaps:[{buildingType:"Buildling Hut",quantity:5},{buildingType:"Tower",quantity:2},{buildingType:"Workshop",quantity:1},{buildingType:"Defence Factory",quantity:1},{buildingType:"Outpost",quantity:1},{buildingType:"Lumbermill",quantity:1},{buildingType:"Stonemill",quantity:1},{buildingType:"Wall",quantity:100},{buildingType:"Gate",quantity:10},{buildingType:"Lumber Storage",quantity:1},{buildingType:"Stone Storage",quantity:1},{buildingType:"Library",
quantity:1},{buildingType:"Treasure Chest",quantity:1},{buildingType:"Marketplace",quantity:1},{buildingType:"Amber Well",quantity:10}],importantBuildingForDamage:!0},ECUpgradable:{upgradeName:"Level 2",upgradeArchetypeName:"a_b_hq_level_2",upgradeInfo:"hq"},ECUpgrader:e.EC_DEFAULT,ECResourceDestination:{canDepositResource:[!0,!0]},ECResourceStorage:{maxResourceToLose:[100,100]},ECExplode:{damageType:"dg_b_hq_explode"},ECSockets:{sockets:[{archetypeName:"a_b_hq_smoke",localOffset:[0,0,0]}]},ECRadialMenu:e.EC_DEFAULT,
ECEffectSpawner:{onCreateEffect:"sfx_crt_building",onDeathEffect:"sfx_dth_building"},ECBuildingPlacementRadius:{buildingRadius:8,trapRadius:16},ECWorldGui:{text1:"Headquarters",text2:"Level 1",onScreenGuiArchetype:"tipHq",offScreenGuiArchetype:"tipHq",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_b_hq_level_2={shouldPlayerSave:!0,parent:"a_b_hq",ECMesh:{path:"environment/models/e_b_headquarter_level02.dae"},ECHealth:{health:e.balanceBuildings.a_b_hq_level_2.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_hq_level_2.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_hq_level_2.secondaryResourceCost,level:2,buildTime:e.balanceBuildings.a_b_hq_level_2.buildTime,defenceLevel:2,globalCaps:[{buildingType:"Buildling Hut",quantity:5},{buildingType:"Tower",quantity:2},{buildingType:"Defence Factory",quantity:1},{buildingType:"Workshop",quantity:1},{buildingType:"Outpost",quantity:1},{buildingType:"Lumbermill",quantity:1},{buildingType:"Stonemill",quantity:1},{buildingType:"Wall",quantity:100},{buildingType:"Gate",quantity:10},
{buildingType:"Lumber Storage",quantity:1},{buildingType:"Stone Storage",quantity:1},{buildingType:"Library",quantity:1},{buildingType:"Treasure Chest",quantity:1},{buildingType:"Marketplace",quantity:1},{buildingType:"Amber Well",quantity:10}],prerequisites:[{buildingType:"Outpost",level:1}]},ECSockets:{sockets:[{archetypeName:"a_b_hq_smoke_2",localOffset:[0,0,0]}]},ECUpgradable:{upgradeName:"Level 3",upgradeArchetypeName:"a_b_hq_level_3"},ECWorldGui:{text2:"Level 2"}};e.archetypes.a_b_hq_level_3=
{shouldPlayerSave:!0,parent:"a_b_hq_level_2",ECMesh:{path:"environment/models/e_b_headquarter_level03.dae"},ECHealth:{health:e.balanceBuildings.a_b_hq_level_3.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_hq_level_3.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_hq_level_3.secondaryResourceCost,level:3,buildTime:e.balanceBuildings.a_b_hq_level_3.buildTime,defenceLevel:3,globalCaps:[{buildingType:"Buildling Hut",quantity:5},{buildingType:"Tower",quantity:4},{buildingType:"Defence Factory",
quantity:1},{buildingType:"Workshop",quantity:1},{buildingType:"Outpost",quantity:2},{buildingType:"Lumbermill",quantity:1},{buildingType:"Stonemill",quantity:1},{buildingType:"Wall",quantity:150},{buildingType:"Gate",quantity:15},{buildingType:"Lumber Storage",quantity:2},{buildingType:"Stone Storage",quantity:2},{buildingType:"Library",quantity:1},{buildingType:"Treasure Chest",quantity:1},{buildingType:"Marketplace",quantity:1},{buildingType:"Amber Well",quantity:10}],prerequisites:[{buildingType:"Outpost",
level:2}]},ECSockets:{sockets:[{archetypeName:"a_b_hq_smoke_3",localOffset:[0,0,0]}]},ECUpgradable:{upgradeName:"Level 4",upgradeArchetypeName:"a_b_hq_level_4"},ECWorldGui:{text2:"Level 3"}};e.archetypes.a_b_hq_level_4={shouldPlayerSave:!0,parent:"a_b_hq_level_3",ECMesh:{path:"environment/models/e_b_headquarter_level04.dae"},ECHealth:{health:e.balanceBuildings.a_b_hq_level_4.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_hq_level_4.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_hq_level_4.secondaryResourceCost,
level:4,buildTime:e.balanceBuildings.a_b_hq_level_4.buildTime,defenceLevel:4,globalCaps:[{buildingType:"Buildling Hut",quantity:5},{buildingType:"Tower",quantity:4},{buildingType:"Defence Factory",quantity:1},{buildingType:"Workshop",quantity:1},{buildingType:"Outpost",quantity:2},{buildingType:"Lumbermill",quantity:1},{buildingType:"Stonemill",quantity:1},{buildingType:"Wall",quantity:150},{buildingType:"Gate",quantity:15},{buildingType:"Lumber Storage",quantity:2},{buildingType:"Stone Storage",
quantity:2},{buildingType:"Library",quantity:1},{buildingType:"Treasure Chest",quantity:1},{buildingType:"Marketplace",quantity:1},{buildingType:"Amber Well",quantity:10}],prerequisites:[{buildingType:"Outpost",level:3},{buildingType:"Library",level:1}]},ECSockets:{sockets:[{archetypeName:"a_b_hq_smoke_4",localOffset:[0,0,0]}]},ECUpgradable:{upgradeName:"Level 5",upgradeArchetypeName:"a_b_hq_level_5"},ECWorldGui:{text2:"Level 4"}};e.archetypes.a_b_hq_level_5={shouldPlayerSave:!0,parent:"a_b_hq_level_4",
ECMesh:{path:"environment/models/e_b_headquarter_level05.dae"},ECHealth:{health:e.balanceBuildings.a_b_hq_level_5.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_hq_level_5.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_hq_level_5.secondaryResourceCost,level:5,buildTime:e.balanceBuildings.a_b_hq_level_5.buildTime,defenceLevel:5,globalCaps:[{buildingType:"Buildling Hut",quantity:5},{buildingType:"Tower",quantity:6},{buildingType:"Defence Factory",quantity:1},{buildingType:"Workshop",
quantity:1},{buildingType:"Outpost",quantity:2},{buildingType:"Lumbermill",quantity:1},{buildingType:"Stonemill",quantity:1},{buildingType:"Wall",quantity:200},{buildingType:"Gate",quantity:20},{buildingType:"Lumber Storage",quantity:2},{buildingType:"Stone Storage",quantity:2},{buildingType:"Library",quantity:1},{buildingType:"Treasure Chest",quantity:1},{buildingType:"Marketplace",quantity:1},{buildingType:"Amber Well",quantity:10}],prerequisites:[{buildingType:"Outpost",level:4},{buildingType:"Library",
level:2}]},ECSockets:{sockets:[{archetypeName:"a_b_hq_smoke_5",localOffset:[0,0,0]}]},ECUpgradable:{upgradeName:"Level 6",upgradeArchetypeName:"a_b_hq_level_6"},ECWorldGui:{text2:"Level 5"}};e.archetypes.a_b_hq_level_6={shouldPlayerSave:!0,parent:"a_b_hq_level_5",ECMesh:{path:"environment/models/e_b_headquarter_level06.dae"},ECHealth:{health:e.balanceBuildings.a_b_hq_level_6.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_hq_level_6.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_hq_level_6.secondaryResourceCost,
level:6,buildTime:e.balanceBuildings.a_b_hq_level_6.buildTime,defenceLevel:6,globalCaps:[{buildingType:"Buildling Hut",quantity:5},{buildingType:"Tower",quantity:6},{buildingType:"Defence Factory",quantity:1},{buildingType:"Workshop",quantity:1},{buildingType:"Outpost",quantity:2},{buildingType:"Lumbermill",quantity:1},{buildingType:"Stonemill",quantity:1},{buildingType:"Wall",quantity:200},{buildingType:"Gate",quantity:20},{buildingType:"Lumber Storage",quantity:3},{buildingType:"Stone Storage",
quantity:3},{buildingType:"Library",quantity:1},{buildingType:"Treasure Chest",quantity:1},{buildingType:"Marketplace",quantity:1},{buildingType:"Amber Well",quantity:10}],prerequisites:[{buildingType:"Outpost",level:5},{buildingType:"Library",level:3}]},ECSockets:{sockets:[{archetypeName:"a_b_hq_smoke_6",localOffset:[0,0,0]}]},ECUpgradable:{upgradeName:"Level 7",upgradeArchetypeName:"a_b_hq_level_7"},ECWorldGui:{text2:"Level 6"}};e.archetypes.a_b_hq_level_7={shouldPlayerSave:!0,parent:"a_b_hq_level_6",
ECMesh:{path:"environment/models/e_b_headquarter_level07.dae"},ECHealth:{health:e.balanceBuildings.a_b_hq_level_7.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_hq_level_7.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_hq_level_7.secondaryResourceCost,level:7,buildTime:e.balanceBuildings.a_b_hq_level_7.buildTime,defenceLevel:7,globalCaps:[{buildingType:"Buildling Hut",quantity:5},{buildingType:"Tower",quantity:8},{buildingType:"Defence Factory",quantity:1},{buildingType:"Workshop",
quantity:1},{buildingType:"Outpost",quantity:2},{buildingType:"Lumbermill",quantity:1},{buildingType:"Stonemill",quantity:1},{buildingType:"Wall",quantity:250},{buildingType:"Gate",quantity:25},{buildingType:"Lumber Storage",quantity:3},{buildingType:"Stone Storage",quantity:3},{buildingType:"Library",quantity:1},{buildingType:"Treasure Chest",quantity:1},{buildingType:"Marketplace",quantity:1},{buildingType:"Amber Well",quantity:10}],prerequisites:[{buildingType:"Outpost",level:6},{buildingType:"Library",
level:4}]},ECSockets:{sockets:[{archetypeName:"a_b_hq_smoke_7",localOffset:[0,0,0]}]},ECUpgradable:{upgradeName:"Level 8",upgradeArchetypeName:"a_b_hq_level_8"},ECWorldGui:{text2:"Level 7"}};e.archetypes.a_b_hq_level_8={shouldPlayerSave:!0,parent:"a_b_hq_level_7",ECMesh:{path:"environment/models/e_b_headquarter_level08.dae"},ECHealth:{health:e.balanceBuildings.a_b_hq_level_8.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_hq_level_8.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_hq_level_8.secondaryResourceCost,
level:8,buildTime:e.balanceBuildings.a_b_hq_level_8.buildTime,defenceLevel:8,globalCaps:[{buildingType:"Buildling Hut",quantity:5},{buildingType:"Tower",quantity:8},{buildingType:"Defence Factory",quantity:1},{buildingType:"Workshop",quantity:1},{buildingType:"Outpost",quantity:2},{buildingType:"Lumbermill",quantity:1},{buildingType:"Stonemill",quantity:1},{buildingType:"Wall",quantity:250},{buildingType:"Gate",quantity:25},{buildingType:"Lumber Storage",quantity:3},{buildingType:"Stone Storage",
quantity:3},{buildingType:"Library",quantity:1},{buildingType:"Treasure Chest",quantity:1},{buildingType:"Marketplace",quantity:1},{buildingType:"Amber Well",quantity:10}],prerequisites:[{buildingType:"Outpost",level:7},{buildingType:"Library",level:5}]},ECSockets:{sockets:[{archetypeName:"a_b_hq_smoke_8",localOffset:[0,0,0]}]},ECUpgradable:{upgradeName:"Level 9",upgradeArchetypeName:"a_b_hq_level_9"},ECWorldGui:{text2:"Level 8"}};e.archetypes.a_b_hq_level_9={shouldPlayerSave:!0,parent:"a_b_hq_level_8",
ECMesh:{path:"environment/models/e_b_headquarter_level09.dae"},ECHealth:{health:e.balanceBuildings.a_b_hq_level_9.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_hq_level_9.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_hq_level_9.secondaryResourceCost,level:9,buildTime:e.balanceBuildings.a_b_hq_level_9.buildTime,defenceLevel:9,globalCaps:[{buildingType:"Buildling Hut",quantity:5},{buildingType:"Tower",quantity:10},{buildingType:"Defence Factory",quantity:1},{buildingType:"Workshop",
quantity:1},{buildingType:"Outpost",quantity:2},{buildingType:"Lumbermill",quantity:1},{buildingType:"Stonemill",quantity:1},{buildingType:"Wall",quantity:300},{buildingType:"Gate",quantity:30},{buildingType:"Lumber Storage",quantity:4},{buildingType:"Stone Storage",quantity:4},{buildingType:"Library",quantity:1},{buildingType:"Treasure Chest",quantity:1},{buildingType:"Marketplace",quantity:1},{buildingType:"Amber Well",quantity:10}],prerequisites:[{buildingType:"Outpost",level:8},{buildingType:"Library",
level:6}]},ECSockets:{sockets:[{archetypeName:"a_b_hq_smoke_9",localOffset:[0,0,0]}]},ECUpgradable:{upgradeName:"Level 10",upgradeArchetypeName:"a_b_hq_level_10"},ECWorldGui:{text2:"Level 9"}};e.archetypes.a_b_hq_level_10={shouldPlayerSave:!0,parent:"a_b_hq_level_9",ECMesh:{path:"environment/models/e_b_headquarter_level010.dae"},ECHealth:{health:e.balanceBuildings.a_b_hq_level_10.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_hq_level_10.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_hq_level_10.secondaryResourceCost,
level:10,buildTime:e.balanceBuildings.a_b_hq_level_10.buildTime,defenceLevel:10,globalCaps:[{buildingType:"Buildling Hut",quantity:5},{buildingType:"Tower",quantity:10},{buildingType:"Defence Factory",quantity:1},{buildingType:"Workshop",quantity:1},{buildingType:"Outpost",quantity:2},{buildingType:"Lumbermill",quantity:1},{buildingType:"Stonemill",quantity:1},{buildingType:"Wall",quantity:300},{buildingType:"Gate",quantity:30},{buildingType:"Lumber Storage",quantity:4},{buildingType:"Stone Storage",
quantity:4},{buildingType:"Library",quantity:1},{buildingType:"Treasure Chest",quantity:1},{buildingType:"Marketplace",quantity:1},{buildingType:"Amber Well",quantity:10}],prerequisites:[{buildingType:"Outpost",level:9},{buildingType:"Library",level:7}]},ECSockets:{sockets:[{archetypeName:"a_b_hq_smoke_10",localOffset:[0,0,0]}]},ECUpgradable:e.EC_REMOVE,ECWorldGui:{text2:"Level 10"}};e.archetypes.a_b_flag_level_1={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_levelflag_1.dae",rotationY:1*
-Math.PI}};e.archetypes.a_b_flag_level_2={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_levelflag_2.dae",rotationY:1*-Math.PI}};e.archetypes.a_b_flag_level_3={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_levelflag_3.dae",rotationY:1*-Math.PI}};e.archetypes.a_b_flag_level_4={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_levelflag_4.dae",rotationY:1*-Math.PI}};e.archetypes.a_b_flag_level_5={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_levelflag_5.dae",
rotationY:1*-Math.PI}};e.archetypes.a_b_flag_level_6={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_levelflag_6.dae",rotationY:1*-Math.PI}};e.archetypes.a_b_flag_level_7={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_levelflag_7.dae",rotationY:1*-Math.PI}};e.archetypes.a_b_flag_level_8={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_levelflag_8.dae",rotationY:1*-Math.PI}};e.archetypes.a_b_flag_level_9={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_levelflag_9.dae",
rotationY:1*-Math.PI}};e.archetypes.a_b_flag_level_10={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_levelflag_10.dae",rotationY:1*-Math.PI}};e.archetypes.a_b_hq_smoke={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_headquarter_smoke.dae"}};e.archetypes.a_b_hq_smoke_2={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_headquarter_smoke_level02.dae"}};e.archetypes.a_b_hq_smoke_3={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_headquarter_smoke_level03.dae"}};
e.archetypes.a_b_hq_smoke_4={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_headquarter_smoke_level04.dae"}};e.archetypes.a_b_hq_smoke_5={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_headquarter_smoke_level05.dae"}};e.archetypes.a_b_hq_smoke_6={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_headquarter_smoke_level06.dae"}};e.archetypes.a_b_hq_smoke_7={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_headquarter_smoke_level07.dae"}};
e.archetypes.a_b_hq_smoke_8={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_headquarter_smoke_level08.dae"}};e.archetypes.a_b_hq_smoke_9={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_headquarter_smoke_level09.dae"}};e.archetypes.a_b_hq_smoke_10={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_headquarter_smoke_level010.dae"}};e.archetypes.a_b_library={shouldPlayerSave:!0,familyName:"Library",ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_library.dae",
localOffset:[0,0,0]},ECPhysicsCube:{stationary:!0,v3Scale:[4,3,4],offsetY:1,scaleMesh:!1,terrainType:"building"},ECHealth:{health:e.balanceBuildings.a_b_library.health,drawInWorldBarIfDamagedRecently:!0,drawOffScreenIconIfDamagedRecently:!0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECBuilding:{buildTime:e.balanceBuildings.a_b_library.buildTime,resourceCost:e.balanceBuildings.a_b_library.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_library.secondaryResourceCost,autoRebuild:!0,
obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Library",level:1,addedFootprintSize:2,prerequisites:[{buildingType:"HQ",level:3}]},ECBuildingPlacementRadius:{buildingRadius:12},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_library.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_library.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 2",upgradeArchetypeName:"a_b_library_level_2",upgradeInfo:"library"},ECUpgrader:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,
ECTarget:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECCapDispenser:{upgradeLevels:[{buildingDisplayName:"Gatling",buildingType:"Turret Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1}]},{buildingDisplayName:"Decoy",buildingType:"Decoy Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,
softCurrencyCost:0,duration:43200,level:2}]},{buildingDisplayName:"Barricade",buildingType:"Barricade Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:2E4,secondaryResourceCost:0,softCurrencyCost:0,duration:21600,level:2}]},{buildingDisplayName:"Wooden Gate",buildingType:"Barricade Gate Unlock",prerequisites:[{buildingType:"Outpost",level:2}],levels:[{resourceCost:10,secondaryResourceCost:10,
softCurrencyCost:0,duration:10,level:1},{resourceCost:2E4,secondaryResourceCost:0,softCurrencyCost:0,duration:21600,level:2}]},{buildingDisplayName:"Mortarling",buildingType:"Mortar Unlock",prerequisites:[{buildingType:"Outpost",level:3}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1}]},{buildingDisplayName:"Explosive Barrel",buildingType:"Barrel Unlock",prerequisites:[{buildingType:"Outpost",level:3}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,
duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,softCurrencyCost:0,duration:43200,level:2}]}]},ECEffectSpawner:{onCreateEffect:"sfx_crt_building",onDeathEffect:"sfx_dth_building"},ECWorldGui:{text1:"Library",text2:"Level 1",onScreenGuiArchetype:"tipLibrary",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_b_library_level_2={parent:"a_b_library",ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_library_level02.dae",localOffset:[0,
0,0]},ECHealth:{health:e.balanceBuildings.a_b_library_level_2.health,drawInWorldBarIfDamagedRecently:!0},ECBuilding:{buildTime:e.balanceBuildings.a_b_library_level_2.buildTime,resourceCost:e.balanceBuildings.a_b_library_level_2.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_library_level_2.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Library",level:2,addedFootprintSize:2,prerequisites:[{buildingType:"HQ",level:4}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_library_level_2.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_b_library_level_2.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 3",upgradeArchetypeName:"a_b_library_level_3"},ECCapDispenser:{upgradeLevels:[{buildingDisplayName:"Gatling",buildingType:"Turret Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:5E4,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:2}]},{buildingDisplayName:"Decoy",
buildingType:"Decoy Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,softCurrencyCost:0,duration:43200,level:2}]},{buildingDisplayName:"Barricade",buildingType:"Barricade Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:2E4,secondaryResourceCost:0,
softCurrencyCost:0,duration:21600,level:2}]},{buildingDisplayName:"Wooden Gate",buildingType:"Barricade Gate Unlock",prerequisites:[{buildingType:"Outpost",level:2}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:2E4,secondaryResourceCost:0,softCurrencyCost:0,duration:21600,level:2}]},{buildingDisplayName:"Mortarling",buildingType:"Mortar Unlock",prerequisites:[{buildingType:"Outpost",level:3}],levels:[{resourceCost:10,secondaryResourceCost:10,
softCurrencyCost:0,duration:10,level:1},{resourceCost:75E3,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:2}]},{buildingDisplayName:"Explosive Barrel",buildingType:"Barrel Unlock",prerequisites:[{buildingType:"Outpost",level:3}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,softCurrencyCost:0,duration:43200,level:2}]},{buildingDisplayName:"Mine",buildingType:"Mine Unlock",prerequisites:[{buildingType:"Outpost",
level:4}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,softCurrencyCost:0,duration:43200,level:2}]}]},ECWorldGui:{text2:"Level 2"}};e.archetypes.a_b_library_level_3={parent:"a_b_library_level_2",ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_library_level03.dae",localOffset:[0,0,0]},ECHealth:{health:e.balanceBuildings.a_b_library_level_3.health,drawInWorldBarIfDamagedRecently:!0},ECBuilding:{buildTime:e.balanceBuildings.a_b_library_level_3.buildTime,
resourceCost:e.balanceBuildings.a_b_library_level_3.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_library_level_3.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Library",level:3,addedFootprintSize:2,prerequisites:[{buildingType:"HQ",level:5}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_library_level_3.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_library_level_3.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 4",
upgradeArchetypeName:"a_b_library_level_4"},ECCapDispenser:{upgradeLevels:[{buildingDisplayName:"Gatling",buildingType:"Turret Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:5E4,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:2}]},{buildingDisplayName:"Decoy",buildingType:"Decoy Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,
softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,softCurrencyCost:0,duration:43200,level:2},{resourceCost:1E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3}]},{buildingDisplayName:"Barricade",buildingType:"Barricade Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:2E4,secondaryResourceCost:0,softCurrencyCost:0,duration:21600,level:2},
{resourceCost:6E4,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:3}]},{buildingDisplayName:"Wooden Gate",buildingType:"Barricade Gate Unlock",prerequisites:[{buildingType:"Outpost",level:2}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:2E4,secondaryResourceCost:0,softCurrencyCost:0,duration:21600,level:2},{resourceCost:6E4,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:3}]},{buildingDisplayName:"Mortarling",
buildingType:"Mortar Unlock",prerequisites:[{buildingType:"Outpost",level:3}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:75E3,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:2}]},{buildingDisplayName:"Explosive Barrel",buildingType:"Barrel Unlock",prerequisites:[{buildingType:"Outpost",level:3}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,
softCurrencyCost:0,duration:43200,level:2},{resourceCost:1E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3}]},{buildingDisplayName:"Mine",buildingType:"Mine Unlock",prerequisites:[{buildingType:"Outpost",level:4}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,softCurrencyCost:0,duration:43200,level:2},{resourceCost:1E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3}]},{buildingDisplayName:"Stunling",
buildingType:"Thumper Unlock",prerequisites:[{buildingType:"Outpost",level:5}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:75E3,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:2}]}]},ECWorldGui:{text2:"Level 3"}};e.archetypes.a_b_library_level_4={parent:"a_b_library_level_3",ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_library_level04.dae",localOffset:[0,0,0]},ECHealth:{health:e.balanceBuildings.a_b_library_level_4.health,
drawInWorldBarIfDamagedRecently:!0},ECBuilding:{buildTime:e.balanceBuildings.a_b_library_level_4.buildTime,resourceCost:e.balanceBuildings.a_b_library_level_4.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_library_level_4.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Library",level:4,addedFootprintSize:2,prerequisites:[{buildingType:"HQ",level:6}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_library_level_4.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_b_library_level_4.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 5",upgradeArchetypeName:"a_b_library_level_5"},ECCapDispenser:{upgradeLevels:[{buildingDisplayName:"Gatling",buildingType:"Turret Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:5E4,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:2},{resourceCost:15E4,secondaryResourceCost:0,
softCurrencyCost:0,duration:172800,level:3}]},{buildingDisplayName:"Decoy",buildingType:"Decoy Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,softCurrencyCost:0,duration:43200,level:2},{resourceCost:1E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3}]},{buildingDisplayName:"Barricade",buildingType:"Barricade Unlock",prerequisites:[{buildingType:"Outpost",
level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:2E4,secondaryResourceCost:0,softCurrencyCost:0,duration:21600,level:2},{resourceCost:6E4,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:3}]},{buildingDisplayName:"Wooden Gate",buildingType:"Barricade Gate Unlock",prerequisites:[{buildingType:"Outpost",level:2}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:2E4,
secondaryResourceCost:0,softCurrencyCost:0,duration:21600,level:2},{resourceCost:6E4,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:3}]},{buildingDisplayName:"Mortarling",buildingType:"Mortar Unlock",prerequisites:[{buildingType:"Outpost",level:3}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:75E3,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:2},{resourceCost:2E5,secondaryResourceCost:0,softCurrencyCost:0,
duration:172800,level:3}]},{buildingDisplayName:"Explosive Barrel",buildingType:"Barrel Unlock",prerequisites:[{buildingType:"Outpost",level:3}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,softCurrencyCost:0,duration:43200,level:2},{resourceCost:1E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3}]},{buildingDisplayName:"Mine",buildingType:"Mine Unlock",prerequisites:[{buildingType:"Outpost",
level:4}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,softCurrencyCost:0,duration:43200,level:2},{resourceCost:1E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3}]},{buildingDisplayName:"Stunling",buildingType:"Thumper Unlock",prerequisites:[{buildingType:"Outpost",level:5}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:75E3,secondaryResourceCost:0,
softCurrencyCost:0,duration:86400,level:2},{resourceCost:2E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3}]}]},ECWorldGui:{text2:"Level 4"}};e.archetypes.a_b_library_level_5={parent:"a_b_library_level_4",ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_library_level05.dae",localOffset:[0,0,0]},ECHealth:{health:e.balanceBuildings.a_b_library_level_5.health,drawInWorldBarIfDamagedRecently:!0},ECBuilding:{buildTime:e.balanceBuildings.a_b_library_level_5.buildTime,resourceCost:e.balanceBuildings.a_b_library_level_5.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_library_level_5.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Library",level:5,addedFootprintSize:2,prerequisites:[{buildingType:"HQ",level:7}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_library_level_5.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_library_level_5.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 6",upgradeArchetypeName:"a_b_library_level_6"},
ECCapDispenser:{upgradeLevels:[{buildingDisplayName:"Gatling",buildingType:"Turret Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:5E4,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:2},{resourceCost:15E4,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:4E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4}]},{buildingDisplayName:"Decoy",
buildingType:"Decoy Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,softCurrencyCost:0,duration:43200,level:2},{resourceCost:1E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:3E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4}]},{buildingDisplayName:"Barricade",buildingType:"Barricade Unlock",prerequisites:[{buildingType:"Outpost",
level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:2E4,secondaryResourceCost:0,softCurrencyCost:0,duration:21600,level:2},{resourceCost:6E4,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:3},{resourceCost:2E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4}]},{buildingDisplayName:"Wooden Gate",buildingType:"Barricade Gate Unlock",prerequisites:[{buildingType:"Outpost",level:2}],levels:[{resourceCost:10,
secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:2E4,secondaryResourceCost:0,softCurrencyCost:0,duration:21600,level:2},{resourceCost:6E4,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:3},{resourceCost:2E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4}]},{buildingDisplayName:"Mortarling",buildingType:"Mortar Unlock",prerequisites:[{buildingType:"Outpost",level:3}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,
duration:10,level:1},{resourceCost:75E3,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:2},{resourceCost:2E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:7E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4}]},{buildingDisplayName:"Explosive Barrel",buildingType:"Barrel Unlock",prerequisites:[{buildingType:"Outpost",level:3}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,
secondaryResourceCost:0,softCurrencyCost:0,duration:43200,level:2},{resourceCost:1E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:3E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4}]},{buildingDisplayName:"Mine",buildingType:"Mine Unlock",prerequisites:[{buildingType:"Outpost",level:4}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,softCurrencyCost:0,duration:43200,
level:2},{resourceCost:1E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:3E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4}]},{buildingDisplayName:"Stunling",buildingType:"Thumper Unlock",prerequisites:[{buildingType:"Outpost",level:5}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:75E3,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:2},{resourceCost:2E5,secondaryResourceCost:0,
softCurrencyCost:0,duration:172800,level:3},{resourceCost:7E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4}]}]},ECWorldGui:{text2:"Level 5"}};e.archetypes.a_b_library_level_6={parent:"a_b_library_level_5",ECMesh:{path:"environment/models/e_b_library_level06.dae"},ECHealth:{health:e.balanceBuildings.a_b_library_level_6.health,drawInWorldBarIfDamagedRecently:!0},ECBuilding:{buildTime:e.balanceBuildings.a_b_library_level_6.buildTime,resourceCost:e.balanceBuildings.a_b_library_level_6.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_library_level_6.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Library",level:6,addedFootprintSize:2,prerequisites:[{buildingType:"HQ",level:8}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_library_level_6.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_library_level_6.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 7",upgradeArchetypeName:"a_b_library_level_7"},
ECCapDispenser:{upgradeLevels:[{buildingDisplayName:"Gatling",buildingType:"Turret Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:5E4,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:2},{resourceCost:15E4,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:4E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:1E6,
secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]},{buildingDisplayName:"Decoy",buildingType:"Decoy Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,softCurrencyCost:0,duration:43200,level:2},{resourceCost:1E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:3E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,
level:4},{resourceCost:1E6,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]},{buildingDisplayName:"Barricade",buildingType:"Barricade Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:2E4,secondaryResourceCost:0,softCurrencyCost:0,duration:21600,level:2},{resourceCost:6E4,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:3},{resourceCost:2E5,secondaryResourceCost:0,
softCurrencyCost:0,duration:259200,level:4},{resourceCost:6E5,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]},{buildingDisplayName:"Wooden Gate",buildingType:"Barricade Gate Unlock",prerequisites:[{buildingType:"Outpost",level:2}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:2E4,secondaryResourceCost:0,softCurrencyCost:0,duration:21600,level:2},{resourceCost:6E4,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,
level:3},{resourceCost:2E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:6E5,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]},{buildingDisplayName:"Mortarling",buildingType:"Mortar Unlock",prerequisites:[{buildingType:"Outpost",level:3}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:75E3,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:2},{resourceCost:2E5,secondaryResourceCost:0,
softCurrencyCost:0,duration:172800,level:3},{resourceCost:7E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:125E4,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]},{buildingDisplayName:"Explosive Barrel",buildingType:"Barrel Unlock",prerequisites:[{buildingType:"Outpost",level:3}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,softCurrencyCost:0,duration:43200,
level:2},{resourceCost:1E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:3E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:1E6,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]},{buildingDisplayName:"Mine",buildingType:"Mine Unlock",prerequisites:[{buildingType:"Outpost",level:4}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,
softCurrencyCost:0,duration:43200,level:2},{resourceCost:1E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:3E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:1E6,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]},{buildingDisplayName:"Stunling",buildingType:"Thumper Unlock",prerequisites:[{buildingType:"Outpost",level:5}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},
{resourceCost:75E3,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:2},{resourceCost:2E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:7E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:125E4,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]}]},ECWorldGui:{text2:"Level 6"}};e.archetypes.a_b_library_level_7={parent:"a_b_library_level_6",ECMesh:{path:"environment/models/e_b_library_level07.dae"},
ECHealth:{health:e.balanceBuildings.a_b_library_level_7.health,drawInWorldBarIfDamagedRecently:!0},ECBuilding:{buildTime:e.balanceBuildings.a_b_library_level_7.buildTime,resourceCost:e.balanceBuildings.a_b_library_level_7.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_library_level_7.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Library",level:7,addedFootprintSize:2,prerequisites:[{buildingType:"HQ",level:9}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_library_level_7.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_b_library_level_7.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 8",upgradeArchetypeName:"a_b_library_level_8"},ECCapDispenser:{upgradeLevels:[{buildingDisplayName:"Gatling",buildingType:"Turret Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:5E4,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:2},{resourceCost:15E4,secondaryResourceCost:0,
softCurrencyCost:0,duration:172800,level:3},{resourceCost:4E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:1E6,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]},{buildingDisplayName:"Decoy",buildingType:"Decoy Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,softCurrencyCost:0,duration:43200,level:2},{resourceCost:1E5,
secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:3E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:1E6,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]},{buildingDisplayName:"Barricade",buildingType:"Barricade Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:2E4,secondaryResourceCost:0,softCurrencyCost:0,
duration:21600,level:2},{resourceCost:6E4,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:3},{resourceCost:2E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:6E5,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]},{buildingDisplayName:"Wooden Gate",buildingType:"Barricade Gate Unlock",prerequisites:[{buildingType:"Outpost",level:2}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:2E4,
secondaryResourceCost:0,softCurrencyCost:0,duration:21600,level:2},{resourceCost:6E4,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:3},{resourceCost:2E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:6E5,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]},{buildingDisplayName:"Mortarling",buildingType:"Mortar Unlock",prerequisites:[{buildingType:"Outpost",level:3}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,
duration:10,level:1},{resourceCost:75E3,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:2},{resourceCost:2E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:7E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:125E4,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]},{buildingDisplayName:"Explosive Barrel",buildingType:"Barrel Unlock",prerequisites:[{buildingType:"Outpost",level:3}],levels:[{resourceCost:10,
secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,softCurrencyCost:0,duration:43200,level:2},{resourceCost:1E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:3E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:1E6,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]},{buildingDisplayName:"Mine",buildingType:"Mine Unlock",prerequisites:[{buildingType:"Outpost",
level:4}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,softCurrencyCost:0,duration:43200,level:2},{resourceCost:1E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:3E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:1E6,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]},{buildingDisplayName:"Stunling",buildingType:"Thumper Unlock",
prerequisites:[{buildingType:"Outpost",level:5}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:75E3,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:2},{resourceCost:2E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:7E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:125E4,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]}]},ECWorldGui:{text2:"Level 7"}};
e.archetypes.a_b_library_level_8={parent:"a_b_library_level_7",ECMesh:{path:"environment/models/e_b_library_level08.dae"},ECHealth:{health:e.balanceBuildings.a_b_library_level_8.health,drawInWorldBarIfDamagedRecently:!0},ECBuilding:{buildTime:e.balanceBuildings.a_b_library_level_8.buildTime,resourceCost:e.balanceBuildings.a_b_library_level_8.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_library_level_8.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,
buildingType:"Library",level:8,addedFootprintSize:2,prerequisites:[{buildingType:"HQ",level:10}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_library_level_8.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_library_level_8.maxResourceRepairCost},ECUpgradable:e.EC_REMOVE,ECCapDispenser:{upgradeLevels:[{buildingDisplayName:"Gatling",buildingType:"Turret Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,
duration:10,level:1},{resourceCost:5E4,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:2},{resourceCost:15E4,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:4E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:1E6,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]},{buildingDisplayName:"Decoy",buildingType:"Decoy Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,secondaryResourceCost:10,
softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,softCurrencyCost:0,duration:43200,level:2},{resourceCost:1E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:3E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:1E6,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]},{buildingDisplayName:"Barricade",buildingType:"Barricade Unlock",prerequisites:[{buildingType:"Outpost",level:1}],levels:[{resourceCost:10,
secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:2E4,secondaryResourceCost:0,softCurrencyCost:0,duration:21600,level:2},{resourceCost:6E4,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:3},{resourceCost:2E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:6E5,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]},{buildingDisplayName:"Wooden Gate",buildingType:"Barricade Gate Unlock",prerequisites:[{buildingType:"Outpost",
level:2}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:2E4,secondaryResourceCost:0,softCurrencyCost:0,duration:21600,level:2},{resourceCost:6E4,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:3},{resourceCost:2E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:6E5,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]},{buildingDisplayName:"Mortarling",buildingType:"Mortar Unlock",
prerequisites:[{buildingType:"Outpost",level:3}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:75E3,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:2},{resourceCost:2E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:7E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:125E4,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]},{buildingDisplayName:"Explosive Barrel",
buildingType:"Barrel Unlock",prerequisites:[{buildingType:"Outpost",level:3}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,softCurrencyCost:0,duration:43200,level:2},{resourceCost:1E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:3E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:1E6,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,
level:5}]},{buildingDisplayName:"Mine",buildingType:"Mine Unlock",prerequisites:[{buildingType:"Outpost",level:4}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:25E3,secondaryResourceCost:0,softCurrencyCost:0,duration:43200,level:2},{resourceCost:1E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:3E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},{resourceCost:1E6,secondaryResourceCost:0,
softCurrencyCost:0,duration:432E3,level:5}]},{buildingDisplayName:"Stunling",buildingType:"Thumper Unlock",prerequisites:[{buildingType:"Outpost",level:5}],levels:[{resourceCost:10,secondaryResourceCost:10,softCurrencyCost:0,duration:10,level:1},{resourceCost:75E3,secondaryResourceCost:0,softCurrencyCost:0,duration:86400,level:2},{resourceCost:2E5,secondaryResourceCost:0,softCurrencyCost:0,duration:172800,level:3},{resourceCost:7E5,secondaryResourceCost:0,softCurrencyCost:0,duration:259200,level:4},
{resourceCost:125E4,secondaryResourceCost:0,softCurrencyCost:0,duration:432E3,level:5}]}]},ECWorldGui:{text2:"Level 8"}};e.archetypes.a_b_lumbermill={shouldPlayerSave:!0,familyName:"lumbermill",ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_lumbermill.dae",localOffset:[0,0,0]},ECPhysicsCube:{stationary:!0,v3Scale:[3,2,3],offsetY:1,scaleMesh:!1,terrainType:"building"},ECHealth:{health:e.balanceBuildings.a_b_lumbermill.health,drawInWorldBarIfDamagedRecently:!0,drawOffScreenIconIfDamagedRecently:!0},
ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_lumbermill.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_lumbermill.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_lumbermill.buildTime,resourceCost:e.balanceBuildings.a_b_lumbermill.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_lumbermill.secondaryResourceCost,autoRebuild:!0,canSpeedUpWithSoftCurrency:!0,obeysScaffoldCap:!0,buildingType:"Lumbermill",
level:1,addedFootprintSize:2,prerequisites:[{buildingType:"HQ",level:1}]},ECPlacedBuildingTracker:{canMoveIfBuildingsAlreadyPlaced:!0,localCaps:[{buildingType:"Lumberling Hut",quantity:1}]},ECBuildingPlacementRadius:{buildingRadius:12},ECEffectSpawner:{onCreateEffect:"sfx_crt_building",onDeathEffect:"sfx_dth_building"},ECFaction:e.EC_DEFAULT,ECTarget:e.EC_DEFAULT,ECUpgradable:{upgradeName:"Level 2",upgradeArchetypeName:"a_b_lumbermill_level_2",upgradeInfo:"lumbermill"},ECUpgrader:e.EC_DEFAULT,ECDispenser:{contents:[]},
ECSockets:{sockets:[{archetypeName:"a_b_lumberlinghutworkshop",localOffset:[2,0.5,2]},{archetypeName:"a_b_lumberstorageworkshop",localOffset:[-2,0.5,-2]}]},ECResourceDestination:{canDepositResource:[!0,!1]},ECRadialMenu:e.EC_DEFAULT,ECWorldGui:{text1:"Lumbermill",text2:"Level 1",onScreenGuiArchetype:"tipLumbermill",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_b_lumbermill_level_2={shouldPlayerSave:!0,parent:"a_b_lumbermill",ECMesh:{path:"environment/models/e_b_lumbermill_level02.dae"},
ECHealth:{health:e.balanceBuildings.a_b_lumbermill_level_2.health},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Lumberling Hut",quantity:2}]},ECBuilding:{buildTime:e.balanceBuildings.a_b_lumbermill_level_2.buildTime,resourceCost:e.balanceBuildings.a_b_lumbermill_level_2.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_lumbermill_level_2.secondaryResourceCost,level:2,prerequisites:[{buildingType:"HQ",level:2}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_lumbermill_level_2.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_b_lumbermill_level_2.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 3",upgradeArchetypeName:"a_b_lumbermill_level_3"},ECWorldGui:{text2:"Level 2"}};e.archetypes.a_b_lumbermill_level_3={shouldPlayerSave:!0,parent:"a_b_lumbermill_level_2",ECMesh:{path:"environment/models/e_b_lumbermill_level03.dae"},ECHealth:{health:e.balanceBuildings.a_b_lumbermill_level_3.health},ECBuilding:{buildTime:e.balanceBuildings.a_b_lumbermill_level_3.buildTime,resourceCost:e.balanceBuildings.a_b_lumbermill_level_3.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_lumbermill_level_3.secondaryResourceCost,level:3,prerequisites:[{buildingType:"HQ",level:3}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Lumberling Hut",quantity:3}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_lumbermill_level_3.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_lumbermill_level_3.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 4",upgradeArchetypeName:"a_b_lumbermill_level_4"},ECWorldGui:{text2:"Level 3"}};
e.archetypes.a_b_lumbermill_level_4={shouldPlayerSave:!0,parent:"a_b_lumbermill_level_3",ECMesh:{path:"environment/models/e_b_lumbermill_level04.dae"},ECHealth:{health:e.balanceBuildings.a_b_lumbermill_level_4.health},ECBuilding:{buildTime:e.balanceBuildings.a_b_lumbermill_level_4.buildTime,resourceCost:e.balanceBuildings.a_b_lumbermill_level_4.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_lumbermill_level_4.secondaryResourceCost,level:4,prerequisites:[{buildingType:"HQ",level:4}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Lumberling Hut",
quantity:4}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_lumbermill_level_4.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_lumbermill_level_4.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 5",upgradeArchetypeName:"a_b_lumbermill_level_5"},ECWorldGui:{text2:"Level 4"}};e.archetypes.a_b_lumbermill_level_5={shouldPlayerSave:!0,parent:"a_b_lumbermill_level_4",ECMesh:{path:"environment/models/e_b_lumbermill_level05.dae"},ECHealth:{health:e.balanceBuildings.a_b_lumbermill_level_5.health},
ECBuilding:{buildTime:e.balanceBuildings.a_b_lumbermill_level_5.buildTime,resourceCost:e.balanceBuildings.a_b_lumbermill_level_5.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_lumbermill_level_5.secondaryResourceCost,level:5,prerequisites:[{buildingType:"HQ",level:5}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Lumberling Hut",quantity:5}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_lumbermill_level_5.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_lumbermill_level_5.maxResourceRepairCost},
ECUpgradable:{upgradeName:"Level 6",upgradeArchetypeName:"a_b_lumbermill_level_6"},ECWorldGui:{text2:"Level 5"}};e.archetypes.a_b_lumbermill_level_6={shouldPlayerSave:!0,parent:"a_b_lumbermill_level_5",ECMesh:{path:"environment/models/e_b_lumbermill_level06.dae"},ECHealth:{health:e.balanceBuildings.a_b_lumbermill_level_6.health},ECBuilding:{buildTime:e.balanceBuildings.a_b_lumbermill_level_6.buildTime,resourceCost:e.balanceBuildings.a_b_lumbermill_level_6.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_lumbermill_level_6.secondaryResourceCost,
level:6,prerequisites:[{buildingType:"HQ",level:6}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Lumberling Hut",quantity:6}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_lumbermill_level_6.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_lumbermill_level_6.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 7",upgradeArchetypeName:"a_b_lumbermill_level_7"},ECWorldGui:{text2:"Level 6"}};e.archetypes.a_b_lumbermill_level_7={shouldPlayerSave:!0,parent:"a_b_lumbermill_level_6",
ECMesh:{path:"environment/models/e_b_lumbermill_level07.dae"},ECHealth:{health:e.balanceBuildings.a_b_lumbermill_level_7.health},ECBuilding:{buildTime:e.balanceBuildings.a_b_lumbermill_level_7.buildTime,resourceCost:e.balanceBuildings.a_b_lumbermill_level_7.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_lumbermill_level_7.secondaryResourceCost,level:7,prerequisites:[{buildingType:"HQ",level:7}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Lumberling Hut",quantity:6}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_lumbermill_level_7.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_b_lumbermill_level_7.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 8",upgradeArchetypeName:"a_b_lumbermill_level_8"},ECWorldGui:{text2:"Level 7"}};e.archetypes.a_b_lumbermill_level_8={shouldPlayerSave:!0,parent:"a_b_lumbermill_level_7",ECMesh:{path:"environment/models/e_b_lumbermill_level08.dae"},ECHealth:{health:e.balanceBuildings.a_b_lumbermill_level_8.health},ECBuilding:{buildTime:e.balanceBuildings.a_b_lumbermill_level_8.buildTime,resourceCost:e.balanceBuildings.a_b_lumbermill_level_8.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_lumbermill_level_8.secondaryResourceCost,level:8,prerequisites:[{buildingType:"HQ",level:8}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Lumberling Hut",quantity:6}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_lumbermill_level_8.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_lumbermill_level_8.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 9",upgradeArchetypeName:"a_b_lumbermill_level_9"},ECWorldGui:{text2:"Level 8"}};
e.archetypes.a_b_lumbermill_level_9={shouldPlayerSave:!0,parent:"a_b_lumbermill_level_8",ECMesh:{path:"environment/models/e_b_lumbermill_level09.dae"},ECHealth:{health:e.balanceBuildings.a_b_lumbermill_level_9.health},ECBuilding:{buildTime:e.balanceBuildings.a_b_lumbermill_level_9.buildTime,resourceCost:e.balanceBuildings.a_b_lumbermill_level_9.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_lumbermill_level_9.secondaryResourceCost,level:9,prerequisites:[{buildingType:"HQ",level:9}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Lumberling Hut",
quantity:6}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_lumbermill_level_9.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_lumbermill_level_9.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 10",upgradeArchetypeName:"a_b_lumbermill_level_10"},ECWorldGui:{text2:"Level 9"}};e.archetypes.a_b_lumbermill_level_10={shouldPlayerSave:!0,parent:"a_b_lumbermill_level_9",ECMesh:{path:"environment/models/e_b_lumbermill_level10.dae"},ECHealth:{health:e.balanceBuildings.a_b_lumbermill_level_10.health},
ECBuilding:{buildTime:e.balanceBuildings.a_b_lumbermill_level_10.buildTime,resourceCost:e.balanceBuildings.a_b_lumbermill_level_10.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_lumbermill_level_10.secondaryResourceCost,level:10,prerequisites:[{buildingType:"HQ",level:10}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Lumberling Hut",quantity:6}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_lumbermill_level_10.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_lumbermill_level_10.maxResourceRepairCost},
ECUpgradable:e.EC_REMOVE,ECUpgrader:e.EC_REMOVE,ECWorldGui:{text2:"Level 10"}};e.archetypes.a_b_lumberlinghutworkshop={shouldPlayerSave:!0,familyName:"lumberlinghutworkshop",ECMesh:{scale:1.5*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/lumbermill_wildling.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:0.75,offsetY:0.4,path:"textures/glowfull.dds",additive:!0,color:[126/255,223/255,0,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{meshWhenCapReached:"environment/models/lumberwildlingshell.dae",
contents:[{dispenseName:"Lumberling Hut",dispensedArchetypeName:"a_b_wildlinghouse_lumber",stackableInHand:!1,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_lumberstorage={shouldPlayerSave:!0,familyName:"lumberstorage",ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_lumberstorage.dae",localOffset:[0,0,0]},ECPhysicsCube:{stationary:!0,v3Scale:[3,3,3],offsetY:1,scaleMesh:!1,terrainType:"building"},ECHealth:{health:e.balanceBuildings.a_b_lumberstorage.health,drawInWorldBarIfDamagedRecently:!0,
drawOffScreenIconIfDamagedRecently:!0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_lumberstorage.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_lumberstorage.maxResourceRepairCost},ECBuilding:{resourceCost:e.balanceBuildings.a_b_lumberstorage.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_lumberstorage.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_lumberstorage.buildTime,autoRebuild:!0,obeysScaffoldCap:!0,
canSpeedUpWithSoftCurrency:!0,buildingType:"Lumber Storage",level:1,addedFootprintSize:2,prerequisites:[{buildingType:"HQ",level:1}],importantBuildingForDamage:!0},ECUpgradable:{upgradeName:"Level 2",upgradeArchetypeName:"a_b_lumberstorage_level_2",upgradeInfo:"lumber_storage"},ECUpgrader:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECTarget:e.EC_DEFAULT,ECResourceStorage:{maxResource:[e.balanceBuildings.a_b_lumberstorage.resourceStorage,0],maxResourceToLose:[100,0]},ECRadialMenu:e.EC_DEFAULT,ECEffectSpawner:{onCreateEffect:"sfx_crt_building",
onDeathEffect:"sfx_dth_building"},ECWorldGui:{text1:"Lumber Storage",text2:"Level 1",onScreenGuiArchetype:"tipLumberStorage",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_b_lumberstorage_level_2={shouldPlayerSave:!0,parent:"a_b_lumberstorage",ECMesh:{path:"environment/models/e_b_lumberstorage_level02.dae"},ECHealth:{health:e.balanceBuildings.a_b_lumberstorage_level_2.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_lumberstorage_level_2.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_lumberstorage_level_2.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_lumberstorage_level_2.buildTime,level:2,prerequisites:[{buildingType:"HQ",level:2}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_lumberstorage_level_2.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_lumberstorage_level_2.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 3",upgradeArchetypeName:"a_b_lumberstorage_level_3"},ECResourceStorage:{maxResource:[e.balanceBuildings.a_b_lumberstorage_level_2.resourceStorage,
0],maxResourceToLose:[100,0]},ECWorldGui:{text2:"Level 2"}};e.archetypes.a_b_lumberstorage_level_3={shouldPlayerSave:!0,parent:"a_b_lumberstorage_level_2",ECMesh:{path:"environment/models/e_b_lumberstorage_level03.dae"},ECHealth:{health:e.balanceBuildings.a_b_lumberstorage_level_3.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_lumberstorage_level_3.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_lumberstorage_level_3.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_lumberstorage_level_3.buildTime,
level:3,prerequisites:[{buildingType:"HQ",level:3}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_lumberstorage_level_3.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_lumberstorage_level_3.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 4",upgradeArchetypeName:"a_b_lumberstorage_level_4"},ECResourceStorage:{maxResource:[e.balanceBuildings.a_b_lumberstorage_level_3.resourceStorage,0],maxResourceToLose:[100,0]},ECWorldGui:{text2:"Level 3"}};e.archetypes.a_b_lumberstorage_level_4=
{shouldPlayerSave:!0,parent:"a_b_lumberstorage_level_3",ECMesh:{path:"environment/models/e_b_lumberstorage_level04.dae"},ECHealth:{health:e.balanceBuildings.a_b_lumberstorage_level_4.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_lumberstorage_level_4.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_lumberstorage_level_4.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_lumberstorage_level_4.buildTime,level:4,prerequisites:[{buildingType:"HQ",level:4}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_lumberstorage_level_4.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_b_lumberstorage_level_4.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 5",upgradeArchetypeName:"a_b_lumberstorage_level_5"},ECResourceStorage:{maxResource:[e.balanceBuildings.a_b_lumberstorage_level_4.resourceStorage,0],maxResourceToLose:[500,0]},ECWorldGui:{text2:"Level 4"}};e.archetypes.a_b_lumberstorage_level_5={shouldPlayerSave:!0,parent:"a_b_lumberstorage_level_4",ECMesh:{path:"environment/models/e_b_lumberstorage_level05.dae"},ECHealth:{health:e.balanceBuildings.a_b_lumberstorage_level_5.health},
ECBuilding:{resourceCost:e.balanceBuildings.a_b_lumberstorage_level_5.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_lumberstorage_level_5.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_lumberstorage_level_5.buildTime,level:5,prerequisites:[{buildingType:"HQ",level:5}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_lumberstorage_level_5.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_lumberstorage_level_5.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 6",
upgradeArchetypeName:"a_b_lumberstorage_level_6"},ECResourceStorage:{maxResource:[e.balanceBuildings.a_b_lumberstorage_level_5.resourceStorage,0],maxResourceToLose:[500,0]},ECWorldGui:{text2:"Level 5"}};e.archetypes.a_b_lumberstorage_level_6={shouldPlayerSave:!0,parent:"a_b_lumberstorage_level_5",ECMesh:{path:"environment/models/e_b_lumberstorage_level06.dae"},ECHealth:{health:e.balanceBuildings.a_b_lumberstorage_level_6.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_lumberstorage_level_6.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_lumberstorage_level_6.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_lumberstorage_level_6.buildTime,level:6,prerequisites:[{buildingType:"HQ",level:6}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_lumberstorage_level_6.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_lumberstorage_level_6.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 7",upgradeArchetypeName:"a_b_lumberstorage_level_7"},ECResourceStorage:{maxResource:[e.balanceBuildings.a_b_lumberstorage_level_6.resourceStorage,
0],maxResourceToLose:[500,0]},ECWorldGui:{text2:"Level 6"}};e.archetypes.a_b_lumberstorage_level_7={shouldPlayerSave:!0,parent:"a_b_lumberstorage_level_6",ECMesh:{path:"environment/models/e_b_lumberstorage_level07.dae"},ECHealth:{health:e.balanceBuildings.a_b_lumberstorage_level_7.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_lumberstorage_level_7.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_lumberstorage_level_7.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_lumberstorage_level_7.buildTime,
level:7,prerequisites:[{buildingType:"HQ",level:7}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_lumberstorage_level_7.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_lumberstorage_level_7.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 8",upgradeArchetypeName:"a_b_lumberstorage_level_8"},ECResourceStorage:{maxResource:[e.balanceBuildings.a_b_lumberstorage_level_7.resourceStorage,0],maxResourceToLose:[1E3,0]},ECWorldGui:{text2:"Level 7"}};e.archetypes.a_b_lumberstorage_level_8=
{shouldPlayerSave:!0,parent:"a_b_lumberstorage_level_7",ECMesh:{path:"environment/models/e_b_lumberstorage_level08.dae"},ECHealth:{health:e.balanceBuildings.a_b_lumberstorage_level_8.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_lumberstorage_level_8.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_lumberstorage_level_8.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_lumberstorage_level_8.buildTime,level:8,prerequisites:[{buildingType:"HQ",level:8}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_lumberstorage_level_8.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_b_lumberstorage_level_8.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 9",upgradeArchetypeName:"a_b_lumberstorage_level_9"},ECResourceStorage:{maxResource:[e.balanceBuildings.a_b_lumberstorage_level_8.resourceStorage,0],maxResourceToLose:[1E3,0]},ECWorldGui:{text2:"Level 8"}};e.archetypes.a_b_lumberstorage_level_9={shouldPlayerSave:!0,parent:"a_b_lumberstorage_level_8",ECMesh:{path:"environment/models/e_b_lumberstorage_level09.dae"},ECHealth:{health:e.balanceBuildings.a_b_lumberstorage_level_9.health},
ECBuilding:{resourceCost:e.balanceBuildings.a_b_lumberstorage_level_9.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_lumberstorage_level_9.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_lumberstorage_level_9.buildTime,level:9,prerequisites:[{buildingType:"HQ",level:9}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_lumberstorage_level_9.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_lumberstorage_level_9.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 10",
upgradeArchetypeName:"a_b_lumberstorage_level_10"},ECResourceStorage:{maxResource:[e.balanceBuildings.a_b_lumberstorage_level_9.resourceStorage,0],maxResourceToLose:[1E3,0]},ECWorldGui:{text2:"Level 9"}};e.archetypes.a_b_lumberstorage_level_10={shouldPlayerSave:!0,parent:"a_b_lumberstorage_level_9",ECMesh:{path:"environment/models/e_b_lumberstorage_level010.dae"},ECHealth:{health:e.balanceBuildings.a_b_lumberstorage_level_10.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_lumberstorage_level_10.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_lumberstorage_level_10.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_lumberstorage_level_10.buildTime,level:10,prerequisites:[{buildingType:"HQ",level:10}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_lumberstorage_level_10.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_lumberstorage_level_10.maxResourceRepairCost},ECUpgradable:e.EC_REMOVE,ECUpgrader:e.EC_REMOVE,ECResourceStorage:{maxResource:[e.balanceBuildings.a_b_lumberstorage_level_10.resourceStorage,
0],maxResourceToLose:[1E3,0]},ECWorldGui:{text2:"Level 10"}};e.archetypes.a_b_scaffold={shouldPlayerSave:!0,familyName:"scaffold",ECMesh:e.EC_DEFAULT,ECPhysicsCube:{scaleMesh:!1,stationary:!0,terrainType:"building"},ECSelectable:e.EC_DEFAULT,ECScaffold:{scaffoldType:"normal",buildSpeed:0,delayBuildingUntilBuilderPresent:!1},ECInteractable:e.EC_DEFAULT,ECBuilding:{buildingType:"",buildTime:10,rebuildTime:30,level:1,obeysScaffoldCap:!0,defenceLevel:0,addedFootprintSize:0},ECRadialMenu:e.EC_DEFAULT,
ECEffectSpawner:{onCreateEffect:"placeBuilding"},ECBuildingPlacementRadius:{buildingRadius:0}};e.archetypes.a_b_scaffoldSmall={shouldPlayerSave:!0,familyName:"scaffold",ECMesh:e.EC_DEFAULT,ECPhysicsCube:{scaleMesh:!1,stationary:!0,terrainType:"building"},ECSelectable:e.EC_DEFAULT,ECScaffold:{scaffoldType:"normal",buildSpeed:0,delayBuildingUntilBuilderPresent:!1},ECInteractable:e.EC_DEFAULT,ECBuilding:{buildingType:"",buildTime:10,rebuildTime:30,level:1,obeysScaffoldCap:!0,defenceLevel:0,addedFootprintSize:0},
ECRadialMenu:e.EC_DEFAULT,ECEffectSpawner:{onCreateEffect:"placeSmallBuilding"},ECBuildingPlacementRadius:{buildingRadius:0}};e.archetypes.a_b_scaffoldWar={shouldPlayerSave:!0,familyName:"scaffold",ECMesh:e.EC_DEFAULT,ECPhysicsCube:{scaleMesh:!1,stationary:!0,terrainType:"building"},ECSelectable:e.EC_DEFAULT,ECScaffold:{scaffoldType:"war",buildSpeed:0,delayBuildingUntilBuilderPresent:!0},ECInteractable:e.EC_DEFAULT,ECBuilding:{buildingType:"",buildTime:10,rebuildTime:30,level:1,obeysScaffoldCap:!0,
defenceLevel:0,addedFootprintSize:0},ECRadialMenu:e.EC_DEFAULT,ECEffectSpawner:{onCreateEffect:"placeBuilding"},ECBuildingPlacementRadius:{buildingRadius:0}};e.archetypes.a_b_scaffoldWarSmall={shouldPlayerSave:!0,familyName:"scaffold",ECMesh:e.EC_DEFAULT,ECPhysicsCube:{scaleMesh:!1,stationary:!0,terrainType:"building"},ECSelectable:e.EC_DEFAULT,ECScaffold:{scaffoldType:"war",buildSpeed:0,delayBuildingUntilBuilderPresent:!0},ECInteractable:e.EC_DEFAULT,ECBuilding:{buildingType:"",buildTime:10,rebuildTime:30,
level:1,obeysScaffoldCap:!0,defenceLevel:0,addedFootprintSize:0},ECRadialMenu:e.EC_DEFAULT,ECEffectSpawner:{onCreateEffect:"placeSmallBuilding"},ECBuildingPlacementRadius:{buildingRadius:0}};e.archetypes.a_b_scaffoldMesh={familyName:"scaffoldMesh",ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_scaffolding.dae",localOffset:[0,0,0]},ECEffectSpawner:{ambientEffect:"sfx_construction"}};e.archetypes.a_b_shrinkDisappearMesh={familyName:"shrinkDisappearMesh",ECMesh:e.EC_DEFAULT};e.archetypes.a_b_stonemill=
{shouldPlayerSave:!0,familyName:"stonemill",ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_stonemill.dae",localOffset:[0,0,0]},ECPhysicsCube:{stationary:!0,v3Scale:[3,2,3],offsetY:1,scaleMesh:!1,terrainType:"building"},ECHealth:{health:e.balanceBuildings.a_b_stonemill.health,drawInWorldBarIfDamagedRecently:!0,drawOffScreenIconIfDamagedRecently:!0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_stonemill.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_b_stonemill.maxResourceRepairCost},ECBuilding:{resourceCost:e.balanceBuildings.a_b_stonemill.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_stonemill.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_stonemill.buildTime,autoRebuild:!0,canSpeedUpWithSoftCurrency:!0,obeysScaffoldCap:!0,buildingType:"Stonemill",level:1,addedFootprintSize:2,prerequisites:[{buildingType:"HQ",level:1}]},ECPlacedBuildingTracker:{canMoveIfBuildingsAlreadyPlaced:!0,
localCaps:[{buildingType:"Stoneling Hut",quantity:1}]},ECBuildingPlacementRadius:{buildingRadius:12},ECFaction:e.EC_DEFAULT,ECTarget:e.EC_DEFAULT,ECUpgradable:{upgradeName:"Level 2",upgradeArchetypeName:"a_b_stonemill_level_2",upgradeInfo:"stonemill"},ECUpgrader:e.EC_DEFAULT,ECResourceDestination:{canDepositResource:[!1,!0]},ECRadialMenu:e.EC_DEFAULT,ECDispenser:{contents:[]},ECSockets:{sockets:[{archetypeName:"a_b_stonelinghutworkshop",localOffset:[2,0.5,2]},{archetypeName:"a_b_stonestorageworkshop",
localOffset:[-2,0.5,-2]}]},ECEffectSpawner:{onCreateEffect:"sfx_crt_building",onDeathEffect:"sfx_dth_building"},ECWorldGui:{text1:"Stonemill",text2:"Level 1",onScreenGuiArchetype:"tipStonemill",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_b_stonemill_level_2={shouldPlayerSave:!0,parent:"a_b_stonemill",ECMesh:{path:"environment/models/e_b_stonemill_level02.dae"},ECHealth:{health:e.balanceBuildings.a_b_stonemill_level_2.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_stonemill_level_2.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_stonemill_level_2.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_stonemill_level_2.buildTime,level:2,prerequisites:[{buildingType:"HQ",level:2}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Stoneling Hut",quantity:2}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_stonemill_level_2.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_stonemill_level_2.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 3",upgradeArchetypeName:"a_b_stonemill_level_3"},
ECWorldGui:{text2:"Level 2"}};e.archetypes.a_b_stonemill_level_3={shouldPlayerSave:!0,parent:"a_b_stonemill_level_2",ECMesh:{path:"environment/models/e_b_stonemill_level03.dae"},ECHealth:{health:e.balanceBuildings.a_b_stonemill_level_3.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_stonemill_level_3.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_stonemill_level_3.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_stonemill_level_3.buildTime,level:3,prerequisites:[{buildingType:"HQ",
level:3}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Stoneling Hut",quantity:3}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_stonemill_level_3.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_stonemill_level_3.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 4",upgradeArchetypeName:"a_b_stonemill_level_4"},ECWorldGui:{text2:"Level 3"}};e.archetypes.a_b_stonemill_level_4={shouldPlayerSave:!0,parent:"a_b_stonemill_level_3",ECMesh:{path:"environment/models/e_b_stonemill_level04.dae"},
ECHealth:{health:e.balanceBuildings.a_b_stonemill_level_4.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_stonemill_level_4.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_stonemill_level_4.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_stonemill_level_4.buildTime,level:4,prerequisites:[{buildingType:"HQ",level:4}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Stoneling Hut",quantity:4}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_stonemill_level_4.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_b_stonemill_level_4.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 5",upgradeArchetypeName:"a_b_stonemill_level_5"},ECWorldGui:{text2:"Level 4"}};e.archetypes.a_b_stonemill_level_5={shouldPlayerSave:!0,parent:"a_b_stonemill_level_4",ECMesh:{path:"environment/models/e_b_stonemill_level05.dae"},ECHealth:{health:e.balanceBuildings.a_b_stonemill_level_5.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_stonemill_level_5.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_stonemill_level_5.secondaryResourceCost,
buildTime:e.balanceBuildings.a_b_stonemill_level_5.buildTime,level:5,prerequisites:[{buildingType:"HQ",level:5}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Stoneling Hut",quantity:5}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_stonemill_level_5.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_stonemill_level_5.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 6",upgradeArchetypeName:"a_b_stonemill_level_6"},ECWorldGui:{text2:"Level 5"}};e.archetypes.a_b_stonemill_level_6=
{shouldPlayerSave:!0,parent:"a_b_stonemill_level_5",ECMesh:{path:"environment/models/e_b_stonemill_level06.dae"},ECHealth:{health:e.balanceBuildings.a_b_stonemill_level_6.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_stonemill_level_6.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_stonemill_level_6.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_stonemill_level_6.buildTime,level:6,prerequisites:[{buildingType:"HQ",level:6}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Stoneling Hut",
quantity:6}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_stonemill_level_6.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_stonemill_level_6.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 7",upgradeArchetypeName:"a_b_stonemill_level_7"},ECWorldGui:{text2:"Level 6"}};e.archetypes.a_b_stonemill_level_7={shouldPlayerSave:!0,parent:"a_b_stonemill_level_6",ECMesh:{path:"environment/models/e_b_stonemill_level07.dae"},ECHealth:{health:e.balanceBuildings.a_b_stonemill_level_7.health},
ECBuilding:{resourceCost:e.balanceBuildings.a_b_stonemill_level_7.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_stonemill_level_7.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_stonemill_level_7.buildTime,level:7,prerequisites:[{buildingType:"HQ",level:7}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Stoneling Hut",quantity:6}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_stonemill_level_7.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_stonemill_level_7.maxResourceRepairCost},
ECUpgradable:{upgradeName:"Level 8",upgradeArchetypeName:"a_b_stonemill_level_8"},ECWorldGui:{text2:"Level 7"}};e.archetypes.a_b_stonemill_level_8={shouldPlayerSave:!0,parent:"a_b_stonemill_level_7",ECMesh:{path:"environment/models/e_b_stonemill_level08.dae"},ECHealth:{health:e.balanceBuildings.a_b_stonemill_level_8.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_stonemill_level_8.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_stonemill_level_8.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_stonemill_level_8.buildTime,
level:8,prerequisites:[{buildingType:"HQ",level:8}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Stoneling Hut",quantity:6}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_stonemill_level_8.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_stonemill_level_8.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 9",upgradeArchetypeName:"a_b_stonemill_level_9"},ECWorldGui:{text2:"Level 8"}};e.archetypes.a_b_stonemill_level_9={shouldPlayerSave:!0,parent:"a_b_stonemill_level_8",
ECMesh:{path:"environment/models/e_b_stonemill_level09.dae"},ECHealth:{health:e.balanceBuildings.a_b_stonemill_level_9.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_stonemill_level_9.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_stonemill_level_9.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_stonemill_level_9.buildTime,level:9,prerequisites:[{buildingType:"HQ",level:9}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Stoneling Hut",quantity:6}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_stonemill_level_9.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_b_stonemill_level_9.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 10",upgradeArchetypeName:"a_b_stonemill_level_10"},ECWorldGui:{text2:"Level 9"}};e.archetypes.a_b_stonemill_level_10={shouldPlayerSave:!0,parent:"a_b_stonemill_level_9",ECMesh:{path:"environment/models/e_b_stonemill_level010.dae"},ECHealth:{health:e.balanceBuildings.a_b_stonemill_level_10.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_stonemill_level_10.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_stonemill_level_10.secondaryResourceCost,
buildTime:e.balanceBuildings.a_b_stonemill_level_10.buildTime,level:10,prerequisites:[{buildingType:"HQ",level:10}]},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Stoneling Hut",quantity:6}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_stonemill_level_10.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_stonemill_level_10.maxResourceRepairCost},ECUpgradable:e.EC_REMOVE,ECUpgrader:e.EC_REMOVE,ECWorldGui:{text2:"Level 10"}};e.archetypes.a_b_stonelinghutworkshop=
{shouldPlayerSave:!0,familyName:"stonelinghutworkshop",ECMesh:{scale:1.5*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/stonemill_wildling.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:0.75,offsetY:0.4,path:"textures/glowfull.dds",additive:!0,color:[0,252/255,231/255,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{meshWhenCapReached:"environment/models/stonewildlingshell.dae",contents:[{dispenseName:"Stoneling Hut",dispensedArchetypeName:"a_b_wildlinghouse_stone",
stackableInHand:!1,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_stonestorage={shouldPlayerSave:!0,familyName:"stonestorage",ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_stonestorage.dae",localOffset:[0,0,0]},ECPhysicsCube:{stationary:!0,v3Scale:[3,3,3],offsetY:1,scaleMesh:!1,terrainType:"building"},ECHealth:{health:e.balanceBuildings.a_b_stonestorage.health,drawInWorldBarIfDamagedRecently:!0,drawOffScreenIconIfDamagedRecently:!0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,
ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_stonestorage.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_stonestorage.maxResourceRepairCost},ECBuilding:{resourceCost:e.balanceBuildings.a_b_stonestorage.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_stonestorage.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_stonestorage.buildTime,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Stone Storage",level:1,addedFootprintSize:2,
prerequisites:[{buildingType:"HQ",level:1}],importantBuildingForDamage:!0},ECUpgradable:{upgradeName:"Level 2",upgradeArchetypeName:"a_b_stonestorage_level_2",upgradeInfo:"stone_storage"},ECUpgrader:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECTarget:e.EC_DEFAULT,ECResourceStorage:{maxResource:[0,e.balanceBuildings.a_b_stonestorage.secondaryResourceStorage],maxResourceToLose:[0,100]},ECRadialMenu:e.EC_DEFAULT,ECEffectSpawner:{onCreateEffect:"sfx_crt_building",onDeathEffect:"sfx_dth_building"},ECWorldGui:{text1:"Stone Storage",
text2:"Level 1",onScreenGuiArchetype:"tipStoneStorage",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_b_stonestorage_level_2={shouldPlayerSave:!0,parent:"a_b_stonestorage",ECMesh:{path:"environment/models/e_b_stonestorage_level02.dae"},ECHealth:{health:e.balanceBuildings.a_b_stonestorage_level_2.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_stonestorage_level_2.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_stonestorage_level_2.secondaryResourceCost,
buildTime:e.balanceBuildings.a_b_stonestorage_level_2.buildTime,level:2,prerequisites:[{buildingType:"HQ",level:2}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_stonestorage_level_2.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_stonestorage_level_2.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 3",upgradeArchetypeName:"a_b_stonestorage_level_3"},ECResourceStorage:{maxResource:[0,e.balanceBuildings.a_b_stonestorage_level_2.secondaryResourceStorage],maxResourceToLose:[0,
100]},ECWorldGui:{text2:"Level 2"}};e.archetypes.a_b_stonestorage_level_3={shouldPlayerSave:!0,parent:"a_b_stonestorage_level_2",ECMesh:{path:"environment/models/e_b_stonestorage_level03.dae"},ECHealth:{health:e.balanceBuildings.a_b_stonestorage_level_3.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_stonestorage_level_3.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_stonestorage_level_3.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_stonestorage_level_3.buildTime,level:3,
prerequisites:[{buildingType:"HQ",level:3}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_stonestorage_level_3.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_stonestorage_level_3.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 4",upgradeArchetypeName:"a_b_stonestorage_level_4"},ECResourceStorage:{maxResource:[0,e.balanceBuildings.a_b_stonestorage_level_3.secondaryResourceStorage],maxResourceToLose:[0,100]},ECWorldGui:{text2:"Level 3"}};e.archetypes.a_b_stonestorage_level_4=
{shouldPlayerSave:!0,parent:"a_b_stonestorage_level_3",ECMesh:{path:"environment/models/e_b_stonestorage_level04.dae"},ECHealth:{health:e.balanceBuildings.a_b_stonestorage_level_4.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_stonestorage_level_4.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_stonestorage_level_4.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_stonestorage_level_4.buildTime,level:4,prerequisites:[{buildingType:"HQ",level:4}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_stonestorage_level_4.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_b_stonestorage_level_4.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 5",upgradeArchetypeName:"a_b_stonestorage_level_5"},ECResourceStorage:{maxResource:[0,e.balanceBuildings.a_b_stonestorage_level_4.secondaryResourceStorage],maxResourceToLose:[0,500]},ECWorldGui:{text2:"Level 4"}};e.archetypes.a_b_stonestorage_level_5={shouldPlayerSave:!0,parent:"a_b_stonestorage_level_4",ECMesh:{path:"environment/models/e_b_stonestorage_level05.dae"},ECHealth:{health:e.balanceBuildings.a_b_stonestorage_level_5.health},
ECBuilding:{resourceCost:e.balanceBuildings.a_b_stonestorage_level_5.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_stonestorage_level_5.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_stonestorage_level_5.buildTime,level:5,prerequisites:[{buildingType:"HQ",level:5}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_stonestorage_level_5.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_stonestorage_level_5.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 6",
upgradeArchetypeName:"a_b_stonestorage_level_6"},ECResourceStorage:{maxResource:[0,e.balanceBuildings.a_b_stonestorage_level_5.secondaryResourceStorage],maxResourceToLose:[0,500]},ECWorldGui:{text2:"Level 5"}};e.archetypes.a_b_stonestorage_level_6={shouldPlayerSave:!0,parent:"a_b_stonestorage_level_5",ECMesh:{path:"environment/models/e_b_stonestorage_level06.dae"},ECHealth:{health:e.balanceBuildings.a_b_stonestorage_level_6.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_stonestorage_level_6.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_stonestorage_level_6.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_stonestorage_level_6.buildTime,level:6,prerequisites:[{buildingType:"HQ",level:6}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_stonestorage_level_6.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_stonestorage_level_6.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 7",upgradeArchetypeName:"a_b_stonestorage_level_7"},ECResourceStorage:{maxResource:[0,
e.balanceBuildings.a_b_stonestorage_level_6.secondaryResourceStorage],maxResourceToLose:[0,500]},ECWorldGui:{text2:"Level 6"}};e.archetypes.a_b_stonestorage_level_7={shouldPlayerSave:!0,parent:"a_b_stonestorage_level_6",ECMesh:{path:"environment/models/e_b_stonestorage_level07.dae"},ECHealth:{health:e.balanceBuildings.a_b_stonestorage_level_7.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_stonestorage_level_7.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_stonestorage_level_7.secondaryResourceCost,
buildTime:e.balanceBuildings.a_b_stonestorage_level_7.buildTime,level:7,prerequisites:[{buildingType:"HQ",level:7}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_stonestorage_level_7.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_stonestorage_level_7.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 8",upgradeArchetypeName:"a_b_stonestorage_level_8"},ECResourceStorage:{maxResource:[0,e.balanceBuildings.a_b_stonestorage_level_7.secondaryResourceStorage],maxResourceToLose:[0,
1E3]},ECWorldGui:{text2:"Level 7"}};e.archetypes.a_b_stonestorage_level_8={shouldPlayerSave:!0,parent:"a_b_stonestorage_level_7",ECMesh:{path:"environment/models/e_b_stonestorage_level08.dae"},ECHealth:{health:e.balanceBuildings.a_b_stonestorage_level_8.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_stonestorage_level_8.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_stonestorage_level_8.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_stonestorage_level_8.buildTime,level:8,
prerequisites:[{buildingType:"HQ",level:8}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_stonestorage_level_8.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_stonestorage_level_8.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 9",upgradeArchetypeName:"a_b_stonestorage_level_9"},ECResourceStorage:{maxResource:[0,e.balanceBuildings.a_b_stonestorage_level_8.secondaryResourceStorage],maxResourceToLose:[0,1E3]},ECWorldGui:{text2:"Level 8"}};e.archetypes.a_b_stonestorage_level_9=
{shouldPlayerSave:!0,parent:"a_b_stonestorage_level_8",ECMesh:{path:"environment/models/e_b_stonestorage_level09.dae"},ECHealth:{health:e.balanceBuildings.a_b_stonestorage_level_9.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_stonestorage_level_9.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_stonestorage_level_9.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_stonestorage_level_9.buildTime,level:9,prerequisites:[{buildingType:"HQ",level:9}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_stonestorage_level_9.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_b_stonestorage_level_9.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 10",upgradeArchetypeName:"a_b_stonestorage_level_10"},ECResourceStorage:{maxResource:[0,e.balanceBuildings.a_b_stonestorage_level_9.secondaryResourceStorage],maxResourceToLose:[0,1E3]},ECWorldGui:{text2:"Level 9"}};e.archetypes.a_b_stonestorage_level_10={shouldPlayerSave:!0,parent:"a_b_stonestorage_level_9",ECMesh:{path:"environment/models/e_b_stonestorage_level010.dae"},ECHealth:{health:e.balanceBuildings.a_b_stonestorage_level_10.health},
ECBuilding:{resourceCost:e.balanceBuildings.a_b_stonestorage_level_10.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_stonestorage_level_10.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_stonestorage_level_10.buildTime,level:10,prerequisites:[{buildingType:"HQ",level:10}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_stonestorage_level_10.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_stonestorage_level_10.maxResourceRepairCost},ECUpgradable:e.EC_REMOVE,
ECUpgrader:e.EC_REMOVE,ECResourceStorage:{maxResource:[0,e.balanceBuildings.a_b_stonestorage_level_10.secondaryResourceStorage],maxResourceToLose:[0,1E3]},ECWorldGui:{text2:"Level 10"}};e.archetypes.a_b_wildlinghouse_smoke={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_wildlinghouse_smoke.dae"}};e.archetypes.a_b_wildlinghouse_lumber={shouldPlayerSave:!0,familyName:"wildlingHouseLumber",ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_lumberling_shack.dae"},ECPhysicsCube:{stationary:!1,
v3Scale:[1,1,1],offsetY:0,scaleMesh:!1,terrainType:"building"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_lumber.health,drawInWorldBarIfDamagedRecently:!0,drawOffScreenIconIfDamagedRecently:!0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRepairable:{damagedEntityArchetype:"a_s_damaged_small",minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_lumber.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_lumber.maxResourceRepairCost},
ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_lumber.buildTime,resourceCost:e.balanceBuildings.a_b_wildlinghouse_lumber.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_lumber.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,mustPlaceNearCreator:!1,buildingType:"Lumberling Hut",level:1,prerequisites:[{buildingType:"Lumbermill",level:1}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 2",upgradeArchetypeName:"a_b_wildlinghouse_lumber_level_2",
upgradeInfo:"wildlinghouse_lumber"},ECUpgrader:e.EC_DEFAULT,ECWildlingHouse:{wildlingArchetype:"a_f_lumberling"},ECWorldGui:{text1:"Lumberling Hut",text2:"Level 1",onScreenGuiArchetype:"tipLumberlingHut",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_b_wildlinghouse_lumber_level_2={shouldPlayerSave:!0,parent:"a_b_wildlinghouse_lumber",ECMesh:{path:"environment/models/e_b_lumberling_shack_level02.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_lumber_level_2.health},
ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_2.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_2.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_lumber_level_2.buildTime,resourceCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_2.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_2.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,
buildingType:"Lumberling Hut",level:2,prerequisites:[{buildingType:"Lumbermill",level:2}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 3",upgradeArchetypeName:"a_b_wildlinghouse_lumber_level_3",upgradeInfo:"wildlinghouse_lumber"},ECWildlingHouse:{wildlingArchetype:"a_f_lumberling_level_2"},ECWorldGui:{text2:"Level 2"}};e.archetypes.a_b_wildlinghouse_lumber_level_3={shouldPlayerSave:!0,parent:"a_b_wildlinghouse_lumber_level_2",ECMesh:{path:"environment/models/e_b_lumberling_shack_level03.dae"},
ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_lumber_level_3.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_3.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_3.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_lumber_level_3.buildTime,resourceCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_3.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_3.secondaryResourceCost,
autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Lumberling Hut",level:3,prerequisites:[{buildingType:"Lumbermill",level:3}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 4",upgradeArchetypeName:"a_b_wildlinghouse_lumber_level_4",upgradeInfo:"wildlinghouse_lumber"},ECWildlingHouse:{wildlingArchetype:"a_f_lumberling_level_3"},ECWorldGui:{text2:"Level 3"}};e.archetypes.a_b_wildlinghouse_lumber_level_4={shouldPlayerSave:!0,parent:"a_b_wildlinghouse_lumber_level_3",
ECMesh:{path:"environment/models/e_b_lumberling_shack_level04.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_lumber_level_4.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_4.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_4.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_lumber_level_4.buildTime,resourceCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_4.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_4.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Lumberling Hut",level:4,prerequisites:[{buildingType:"Lumbermill",level:4}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 5",upgradeArchetypeName:"a_b_wildlinghouse_lumber_level_5",upgradeInfo:"wildlinghouse_lumber"},ECWildlingHouse:{wildlingArchetype:"a_f_lumberling_level_4"},ECWorldGui:{text2:"Level 4"}};e.archetypes.a_b_wildlinghouse_lumber_level_5=
{shouldPlayerSave:!0,parent:"a_b_wildlinghouse_lumber_level_4",ECMesh:{path:"environment/models/e_b_lumberling_shack_level05.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_lumber_level_5.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_5.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_5.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_lumber_level_5.buildTime,resourceCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_5.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_5.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Lumberling Hut",level:5,prerequisites:[{buildingType:"Lumbermill",level:5}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 6",upgradeArchetypeName:"a_b_wildlinghouse_lumber_level_6",upgradeInfo:"wildlinghouse_lumber"},ECWildlingHouse:{wildlingArchetype:"a_f_lumberling_level_5"},ECWorldGui:{text2:"Level 5"}};e.archetypes.a_b_wildlinghouse_lumber_level_6=
{shouldPlayerSave:!0,parent:"a_b_wildlinghouse_lumber_level_5",ECMesh:{path:"environment/models/e_b_lumberling_shack_level06.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_lumber_level_6.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_6.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_6.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_lumber_level_6.buildTime,resourceCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_6.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_6.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Lumberling Hut",level:6,prerequisites:[{buildingType:"Lumbermill",level:6}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 7",upgradeArchetypeName:"a_b_wildlinghouse_lumber_level_7",upgradeInfo:"wildlinghouse_lumber"},ECWildlingHouse:{wildlingArchetype:"a_f_lumberling_level_6"},ECWorldGui:{text2:"Level 6"}};e.archetypes.a_b_wildlinghouse_lumber_level_7=
{shouldPlayerSave:!0,parent:"a_b_wildlinghouse_lumber_level_6",ECMesh:{path:"environment/models/e_b_lumberling_shack_level07.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_lumber_level_7.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_7.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_7.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_lumber_level_7.buildTime,resourceCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_7.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_7.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Lumberling Hut",level:7,prerequisites:[{buildingType:"Lumbermill",level:7}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 8",upgradeArchetypeName:"a_b_wildlinghouse_lumber_level_8",upgradeInfo:"wildlinghouse_lumber"},ECWildlingHouse:{wildlingArchetype:"a_f_lumberling_level_7"},ECWorldGui:{text2:"Level 7"}};e.archetypes.a_b_wildlinghouse_lumber_level_8=
{shouldPlayerSave:!0,parent:"a_b_wildlinghouse_lumber_level_7",ECMesh:{path:"environment/models/e_b_lumberling_shack_level08.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_lumber_level_8.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_8.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_8.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_lumber_level_8.buildTime,resourceCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_8.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_8.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Lumberling Hut",level:8,prerequisites:[{buildingType:"Lumbermill",level:8}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 9",upgradeArchetypeName:"a_b_wildlinghouse_lumber_level_9",upgradeInfo:"wildlinghouse_lumber"},ECWildlingHouse:{wildlingArchetype:"a_f_lumberling_level_8"},ECWorldGui:{text2:"Level 8"}};e.archetypes.a_b_wildlinghouse_lumber_level_9=
{shouldPlayerSave:!0,parent:"a_b_wildlinghouse_lumber_level_8",ECMesh:{path:"environment/models/e_b_lumberling_shack_level09.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_lumber_level_9.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_9.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_9.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_lumber_level_9.buildTime,resourceCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_9.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_9.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Lumberling Hut",level:9,prerequisites:[{buildingType:"Lumbermill",level:9}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 10",upgradeArchetypeName:"a_b_wildlinghouse_lumber_level_10",upgradeInfo:"wildlinghouse_lumber"},ECWildlingHouse:{wildlingArchetype:"a_f_lumberling_level_9"},ECWorldGui:{text2:"Level 9"}};e.archetypes.a_b_wildlinghouse_lumber_level_10=
{shouldPlayerSave:!0,parent:"a_b_wildlinghouse_lumber_level_9",ECMesh:{path:"environment/models/e_b_lumberling_shack_level010.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_lumber_level_10.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_10.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_10.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_lumber_level_10.buildTime,
resourceCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_10.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_lumber_level_10.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Lumberling Hut",level:10,prerequisites:[{buildingType:"Lumbermill",level:10}],addedFootprintSize:0},ECUpgradable:e.EC_REMOVE,ECUpgrader:e.EC_REMOVE,ECWildlingHouse:{wildlingArchetype:"a_f_lumberling_level_10"},ECWorldGui:{text2:"Level 10"}};e.archetypes.a_b_wildlinghouse_stone=
{shouldPlayerSave:!0,familyName:"wildlingHouseStone",ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_stoneling_shack.dae"},ECPhysicsCube:{stationary:!1,v3Scale:[1,1,1],offsetY:0,scaleMesh:!1,terrainType:"building"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_stone.health,drawInWorldBarIfDamagedRecently:!0,drawOffScreenIconIfDamagedRecently:!0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRepairable:{damagedEntityArchetype:"a_s_damaged_small",
minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_stone.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_stone.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_stone.buildTime,resourceCost:e.balanceBuildings.a_b_wildlinghouse_stone.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_stone.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,mustPlaceNearCreator:!1,buildingType:"Stoneling Hut",
level:1,prerequisites:[{buildingType:"Stonemill",level:1}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 2",upgradeArchetypeName:"a_b_wildlinghouse_stone_level_2",upgradeInfo:"wildlinghouse_stone"},ECUpgrader:e.EC_DEFAULT,ECWildlingHouse:{wildlingArchetype:"a_f_stoneling"},ECWorldGui:{text1:"Stoneling Hut",text2:"Level 1",onScreenGuiArchetype:"tipStonelingHut",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_b_wildlinghouse_stone_level_2=
{shouldPlayerSave:!0,parent:"a_b_wildlinghouse_stone",ECMesh:{path:"environment/models/e_b_stoneling_shack_level02.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_stone_level_2.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_2.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_2.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_stone_level_2.buildTime,resourceCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_2.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_2.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Stoneling Hut",level:2,prerequisites:[{buildingType:"Stonemill",level:2}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 3",upgradeArchetypeName:"a_b_wildlinghouse_stone_level_3",upgradeInfo:"wildlinghouse_stone"},ECWildlingHouse:{wildlingArchetype:"a_f_stoneling_level_2"},ECWorldGui:{text2:"Level 2"}};e.archetypes.a_b_wildlinghouse_stone_level_3=
{shouldPlayerSave:!0,parent:"a_b_wildlinghouse_stone_level_2",ECMesh:{path:"environment/models/e_b_stoneling_shack_level03.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_stone_level_3.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_3.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_3.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_stone_level_3.buildTime,resourceCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_3.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_3.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Stoneling Hut",level:3,prerequisites:[{buildingType:"Stonemill",level:3}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 4",upgradeArchetypeName:"a_b_wildlinghouse_stone_level_4",upgradeInfo:"wildlinghouse_stone"},ECWildlingHouse:{wildlingArchetype:"a_f_stoneling_level_3"},ECWorldGui:{text2:"Level 3"}};e.archetypes.a_b_wildlinghouse_stone_level_4=
{shouldPlayerSave:!0,parent:"a_b_wildlinghouse_stone_level_3",ECMesh:{path:"environment/models/e_b_stoneling_shack_level04.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_stone_level_4.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_4.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_4.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_stone_level_4.buildTime,resourceCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_4.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_4.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Stoneling Hut",level:4,prerequisites:[{buildingType:"Stonemill",level:4}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 5",upgradeArchetypeName:"a_b_wildlinghouse_stone_level_5",upgradeInfo:"wildlinghouse_stone"},ECWildlingHouse:{wildlingArchetype:"a_f_stoneling_level_4"},ECWorldGui:{text2:"Level 4"}};e.archetypes.a_b_wildlinghouse_stone_level_5=
{shouldPlayerSave:!0,parent:"a_b_wildlinghouse_stone_level_4",ECMesh:{path:"environment/models/e_b_stoneling_shack_level05.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_stone_level_5.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_5.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_5.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_stone_level_5.buildTime,resourceCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_5.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_5.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Stoneling Hut",level:5,prerequisites:[{buildingType:"Stonemill",level:5}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 6",upgradeArchetypeName:"a_b_wildlinghouse_stone_level_6",upgradeInfo:"wildlinghouse_stone"},ECWildlingHouse:{wildlingArchetype:"a_f_stoneling_level_5"},ECWorldGui:{text2:"Level 5"}};e.archetypes.a_b_wildlinghouse_stone_level_6=
{shouldPlayerSave:!0,parent:"a_b_wildlinghouse_stone_level_5",ECMesh:{path:"environment/models/e_b_stoneling_shack_level06.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_stone_level_6.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_6.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_6.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_stone_level_6.buildTime,resourceCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_6.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_6.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Stoneling Hut",level:6,prerequisites:[{buildingType:"Stonemill",level:6}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 7",upgradeArchetypeName:"a_b_wildlinghouse_stone_level_7",upgradeInfo:"wildlinghouse_stone"},ECWildlingHouse:{wildlingArchetype:"a_f_stoneling_level_6"},ECWorldGui:{text2:"Level 6"}};e.archetypes.a_b_wildlinghouse_stone_level_7=
{shouldPlayerSave:!0,parent:"a_b_wildlinghouse_stone_level_6",ECMesh:{path:"environment/models/e_b_stoneling_shack_level07.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_stone_level_7.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_7.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_7.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_stone_level_7.buildTime,resourceCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_7.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_7.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Stoneling Hut",level:7,prerequisites:[{buildingType:"Stonemill",level:7}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 8",upgradeArchetypeName:"a_b_wildlinghouse_stone_level_8",upgradeInfo:"wildlinghouse_stone"},ECWildlingHouse:{wildlingArchetype:"a_f_stoneling_level_7"},ECWorldGui:{text2:"Level 7"}};e.archetypes.a_b_wildlinghouse_stone_level_8=
{shouldPlayerSave:!0,parent:"a_b_wildlinghouse_stone_level_7",ECMesh:{path:"environment/models/e_b_stoneling_shack_level08.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_stone_level_8.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_8.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_8.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_stone_level_8.buildTime,resourceCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_8.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_8.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Stoneling Hut",level:8,prerequisites:[{buildingType:"Stonemill",level:8}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 9",upgradeArchetypeName:"a_b_wildlinghouse_stone_level_9",upgradeInfo:"wildlinghouse_stone"},ECWildlingHouse:{wildlingArchetype:"a_f_stoneling_level_8"},ECWorldGui:{text2:"Level 8"}};e.archetypes.a_b_wildlinghouse_stone_level_9=
{shouldPlayerSave:!0,parent:"a_b_wildlinghouse_stone_level_8",ECMesh:{path:"environment/models/e_b_stoneling_shack_level09.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_stone_level_9.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_9.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_9.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_stone_level_9.buildTime,resourceCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_9.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_9.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Stoneling Hut",level:9,prerequisites:[{buildingType:"Stonemill",level:9}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 10",upgradeArchetypeName:"a_b_wildlinghouse_stone_level_10",upgradeInfo:"wildlinghouse_stone"},ECWildlingHouse:{wildlingArchetype:"a_f_stoneling_level_9"},ECWorldGui:{text2:"Level 9"}};e.archetypes.a_b_wildlinghouse_stone_level_10=
{shouldPlayerSave:!0,parent:"a_b_wildlinghouse_stone_level_9",ECMesh:{path:"environment/models/e_b_stoneling_shack_level010.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_stone_level_10.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_10.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_10.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_stone_level_10.buildTime,resourceCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_10.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_stone_level_10.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Stoneling Hut",level:10,prerequisites:[{buildingType:"Stonemill",level:10}],addedFootprintSize:0},ECUpgradable:e.EC_REMOVE,ECUpgrader:e.EC_REMOVE,ECWildlingHouse:{wildlingArchetype:"a_f_stoneling_level_10"},ECWorldGui:{text2:"Level 10"}};e.archetypes.a_b_wildlinghouse_build={shouldPlayerSave:!0,ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_builderling_shack.dae"},
ECPhysicsCube:{stationary:!1,v3Scale:[1,1,1],offsetY:0,scaleMesh:!1,terrainType:"building"},ECHealth:{health:50,drawInWorldBarIfDamagedRecently:!0,drawOffScreenIconIfDamagedRecently:!0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECBuilding:{resourceCost:0,secondaryResourceCost:0,softCurrencyCost:100,buildTime:0,autoRebuild:!0,obeysScaffoldCap:!1,canSpeedUpWithSoftCurrency:!0,mustPlaceNearCreator:!1,scaffoldCap:0,buildingType:"Buildling Hut",
level:1,addedFootprintSize:0,prerequisites:[{buildingType:"Buildling Hut",minimumQuantity:0,maximumQuantity:1}]},ECWildlingHouse:{wildlingArchetype:"a_f_buildling"},ECWorldGui:{text1:"Buildling Hut",onScreenGuiArchetype:"tipBuildlingHut",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_b_wildlinghouse_build_2={shouldPlayerSave:!0,ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_builderling_shack.dae"},ECPhysicsCube:{stationary:!1,v3Scale:[1,
1,1],offsetY:0,scaleMesh:!1,terrainType:"building"},ECHealth:{health:50,drawInWorldBarIfDamagedRecently:!0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRepairable:{damagedEntityArchetype:"a_s_damaged_small",minResourceRepairCost:[8,0],maxResourceRepairCost:[16,0]},ECBuilding:{resourceCost:0,secondaryResourceCost:0,softCurrencyCost:250,buildTime:0,autoRebuild:!0,obeysScaffoldCap:!1,canSpeedUpWithSoftCurrency:!0,mustPlaceNearCreator:!1,scaffoldCap:1,
buildingType:"Buildling Hut",level:1,addedFootprintSize:0,prerequisites:[{buildingType:"Buildling Hut",minimumQuantity:1,maximumQuantity:2}]},ECWildlingHouse:{wildlingArchetype:"a_f_buildling"}};e.archetypes.a_b_wildlinghouse_build_3={shouldPlayerSave:!0,ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_builderling_shack.dae"},ECPhysicsCube:{stationary:!1,v3Scale:[1,1,1],offsetY:0,scaleMesh:!1,terrainType:"building"},ECHealth:{health:50,drawInWorldBarIfDamagedRecently:!0},ECSelectable:e.EC_DEFAULT,
ECInteractable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRepairable:{minResourceRepairCost:[8,0],maxResourceRepairCost:[16,0]},ECBuilding:{resourceCost:0,secondaryResourceCost:0,softCurrencyCost:500,buildTime:0,autoRebuild:!0,obeysScaffoldCap:!1,canSpeedUpWithSoftCurrency:!0,mustPlaceNearCreator:!1,scaffoldCap:1,buildingType:"Buildling Hut",level:1,addedFootprintSize:0,prerequisites:[{buildingType:"Buildling Hut",minimumQuantity:2,maximumQuantity:3}]},ECWildlingHouse:{wildlingArchetype:"a_f_buildling"}};
e.archetypes.a_b_wildlinghouse_build_4={shouldPlayerSave:!0,ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_builderling_shack.dae"},ECPhysicsCube:{stationary:!1,v3Scale:[1,1,1],offsetY:0,scaleMesh:!1,terrainType:"building"},ECHealth:{health:50,drawInWorldBarIfDamagedRecently:!0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRepairable:{minResourceRepairCost:[8,0],maxResourceRepairCost:[16,0]},ECBuilding:{resourceCost:0,secondaryResourceCost:0,
softCurrencyCost:1E3,buildTime:0,autoRebuild:!0,obeysScaffoldCap:!1,canSpeedUpWithSoftCurrency:!0,mustPlaceNearCreator:!1,scaffoldCap:1,buildingType:"Buildling Hut",level:1,addedFootprintSize:0,prerequisites:[{buildingType:"Buildling Hut",minimumQuantity:3,maximumQuantity:4}]},ECWildlingHouse:{wildlingArchetype:"a_f_buildling"}};e.archetypes.a_b_wildlinghouse_build_5={shouldPlayerSave:!0,ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_builderling_shack.dae"},ECPhysicsCube:{stationary:!1,
v3Scale:[1,1,1],offsetY:0,scaleMesh:!1,terrainType:"building"},ECHealth:{health:50,drawInWorldBarIfDamagedRecently:!0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRepairable:{minResourceRepairCost:[8,0],maxResourceRepairCost:[16,0]},ECBuilding:{resourceCost:0,secondaryResourceCost:0,softCurrencyCost:2E3,buildTime:0,autoRebuild:!0,obeysScaffoldCap:!1,canSpeedUpWithSoftCurrency:!0,mustPlaceNearCreator:!1,scaffoldCap:1,buildingType:"Buildling Hut",
level:1,addedFootprintSize:0,prerequisites:[{buildingType:"Buildling Hut",minimumQuantity:4}]},ECWildlingHouse:{wildlingArchetype:"a_f_buildling"}};e.archetypes.a_b_wildlinghouse_war={shouldPlayerSave:!0,familyName:"Defendling Hut",ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_warling_shack.dae"},ECPhysicsCube:{stationary:!1,v3Scale:[1,1,1],offsetY:0,scaleMesh:!1,terrainType:"building"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_war.health,drawOffScreenIconIfDamagedRecently:!0},
ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRepairable:{damagedEntityArchetype:"a_s_damaged_small",minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_war.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_war.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_war.buildTime,resourceCost:e.balanceBuildings.a_b_wildlinghouse_war.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_war.secondaryResourceCost,
autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,mustPlaceNearCreator:!1,buildingType:"Defendling Hut",level:1,prerequisites:[{buildingType:"Defence Factory",level:1}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 2",upgradeArchetypeName:"a_b_wildlinghouse_war_level_2",upgradeInfo:"wildlinghouse_war"},ECUpgrader:e.EC_DEFAULT,ECWildlingHouse:{wildlingArchetype:"a_f_warling"},ECWorldGui:{text1:"Defendling Hut",text2:"Level 1",onScreenGuiArchetype:"tipDefendlingHut",offScreenGuiArchetype:"none",
visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_b_wildlinghouse_war_level_2={shouldPlayerSave:!0,parent:"a_b_wildlinghouse_war",ECMesh:{path:"environment/models/e_b_warling_shack_level02.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_war_level_2.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_war_level_2.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_war_level_2.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_war_level_2.buildTime,
resourceCost:e.balanceBuildings.a_b_wildlinghouse_war_level_2.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_war_level_2.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Defendling Hut",level:2,prerequisites:[{buildingType:"Defence Factory",level:2}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 3",upgradeArchetypeName:"a_b_wildlinghouse_war_level_3",upgradeInfo:"wildlinghouse_war"},ECWildlingHouse:{wildlingArchetype:"a_f_warling_level_2"},
ECWorldGui:{text2:"Level 2"}};e.archetypes.a_b_wildlinghouse_war_level_3={shouldPlayerSave:!0,parent:"a_b_wildlinghouse_war_level_2",ECMesh:{path:"environment/models/e_b_warling_shack_level03.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_war_level_3.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_war_level_3.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_war_level_3.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_war_level_3.buildTime,
resourceCost:e.balanceBuildings.a_b_wildlinghouse_war_level_3.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_war_level_3.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Defendling Hut",level:3,prerequisites:[{buildingType:"Defence Factory",level:3}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 4",upgradeArchetypeName:"a_b_wildlinghouse_war_level_4",upgradeInfo:"wildlinghouse_war"},ECWildlingHouse:{wildlingArchetype:"a_f_warling_level_3"},
ECWorldGui:{text2:"Level 3"}};e.archetypes.a_b_wildlinghouse_war_level_4={shouldPlayerSave:!0,parent:"a_b_wildlinghouse_war_level_3",ECMesh:{path:"environment/models/e_b_warling_shack_level04.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_war_level_4.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_war_level_4.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_war_level_4.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_war_level_4.buildTime,
resourceCost:e.balanceBuildings.a_b_wildlinghouse_war_level_4.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_war_level_4.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Defendling Hut",level:4,prerequisites:[{buildingType:"Defence Factory",level:4}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 5",upgradeArchetypeName:"a_b_wildlinghouse_war_level_5",upgradeInfo:"wildlinghouse_war"},ECWildlingHouse:{wildlingArchetype:"a_f_warling_level_4"},
ECWorldGui:{text2:"Level 4"}};e.archetypes.a_b_wildlinghouse_war_level_5={shouldPlayerSave:!0,parent:"a_b_wildlinghouse_war_level_4",ECMesh:{path:"environment/models/e_b_warling_shack_level05.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_war_level_5.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_war_level_5.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_war_level_5.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_war_level_5.buildTime,
resourceCost:e.balanceBuildings.a_b_wildlinghouse_war_level_5.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_war_level_5.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Defendling Hut",level:5,prerequisites:[{buildingType:"Defence Factory",level:5}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 6",upgradeArchetypeName:"a_b_wildlinghouse_war_level_6",upgradeInfo:"wildlinghouse_war"},ECWildlingHouse:{wildlingArchetype:"a_f_warling_level_5"},
ECWorldGui:{text2:"Level 5"}};e.archetypes.a_b_wildlinghouse_war_level_6={shouldPlayerSave:!0,parent:"a_b_wildlinghouse_war_level_5",ECMesh:{path:"environment/models/e_b_warling_shack_level06.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_war_level_6.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_war_level_6.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_war_level_6.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_war_level_6.buildTime,
resourceCost:e.balanceBuildings.a_b_wildlinghouse_war_level_6.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_war_level_6.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Defendling Hut",level:6,prerequisites:[{buildingType:"Defence Factory",level:6}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 7",upgradeArchetypeName:"a_b_wildlinghouse_war_level_7",upgradeInfo:"wildlinghouse_war"},ECWildlingHouse:{wildlingArchetype:"a_f_warling_level_6"},
ECWorldGui:{text2:"Level 6"}};e.archetypes.a_b_wildlinghouse_war_level_7={shouldPlayerSave:!0,parent:"a_b_wildlinghouse_war_level_6",ECMesh:{path:"environment/models/e_b_warling_shack_level07.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_war_level_7.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_war_level_7.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_war_level_7.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_war_level_7.buildTime,
resourceCost:e.balanceBuildings.a_b_wildlinghouse_war_level_7.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_war_level_7.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Defendling Hut",level:7,prerequisites:[{buildingType:"Defence Factory",level:7}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 8",upgradeArchetypeName:"a_b_wildlinghouse_war_level_8",upgradeInfo:"wildlinghouse_war"},ECWildlingHouse:{wildlingArchetype:"a_f_warling_level_7"},
ECWorldGui:{text2:"Level 7"}};e.archetypes.a_b_wildlinghouse_war_level_8={shouldPlayerSave:!0,parent:"a_b_wildlinghouse_war_level_7",ECMesh:{path:"environment/models/e_b_warling_shack_level08.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_war_level_8.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_war_level_8.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_war_level_8.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_war_level_8.buildTime,
resourceCost:e.balanceBuildings.a_b_wildlinghouse_war_level_8.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_war_level_8.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Defendling Hut",level:8,prerequisites:[{buildingType:"Defence Factory",level:8}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 9",upgradeArchetypeName:"a_b_wildlinghouse_war_level_9",upgradeInfo:"wildlinghouse_war"},ECWildlingHouse:{wildlingArchetype:"a_f_warling_level_8"},
ECWorldGui:{text2:"Level 8"}};e.archetypes.a_b_wildlinghouse_war_level_9={shouldPlayerSave:!0,parent:"a_b_wildlinghouse_war_level_8",ECMesh:{path:"environment/models/e_b_warling_shack_level09.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_war_level_9.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_war_level_9.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_war_level_9.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_war_level_9.buildTime,
resourceCost:e.balanceBuildings.a_b_wildlinghouse_war_level_9.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_war_level_9.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Defendling Hut",level:9,prerequisites:[{buildingType:"Defence Factory",level:9}],addedFootprintSize:0},ECUpgradable:{upgradeName:"Level 10",upgradeArchetypeName:"a_b_wildlinghouse_war_level_10",upgradeInfo:"wildlinghouse_war"},ECWildlingHouse:{wildlingArchetype:"a_f_warling_level_9"},
ECWorldGui:{text2:"Level 9"}};e.archetypes.a_b_wildlinghouse_war_level_10={shouldPlayerSave:!0,parent:"a_b_wildlinghouse_war_level_6",ECMesh:{path:"environment/models/e_b_warling_shack_level010.dae"},ECHealth:{health:e.balanceBuildings.a_b_wildlinghouse_war_level_10.health},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_war_level_10.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_wildlinghouse_war_level_10.maxResourceRepairCost},ECBuilding:{buildTime:e.balanceBuildings.a_b_wildlinghouse_war_level_10.buildTime,
resourceCost:e.balanceBuildings.a_b_wildlinghouse_war_level_10.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_wildlinghouse_war_level_10.secondaryResourceCost,autoRebuild:!0,obeysScaffoldCap:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Defendling Hut",level:10,prerequisites:[{buildingType:"Defence Factory",level:10}],addedFootprintSize:0},ECUpgradable:e.EC_REMOVE,ECUpgrader:e.EC_REMOVE,ECWildlingHouse:{wildlingArchetype:"a_f_warling_level_10"},ECWorldGui:{text2:"Level 10"}};e.archetypes.a_b_workshop=
{shouldPlayerSave:!0,familyName:"workshop",ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_workshop.dae",localOffset:[0,0,0]},ECPhysicsCube:{stationary:!0,v3Scale:[3,3,3],offsetY:1,scaleMesh:!1,terrainType:"building"},ECHealth:{health:e.balanceBuildings.a_b_workshop.health,drawInWorldBarIfDamagedRecently:!0,drawOffScreenIconIfDamagedRecently:!0},ECSelectable:e.EC_DEFAULT,ECTarget:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_workshop.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_b_workshop.maxResourceRepairCost},ECBuilding:{resourceCost:e.balanceBuildings.a_b_workshop.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_workshop.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_workshop.buildTime,autoRebuild:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Workshop",level:1,addedFootprintSize:2,scaffoldCap:1,globalCaps:[{buildingType:"HQ",quantity:1}]},ECUpgradable:{upgradeName:"Level 2",upgradeArchetypeName:"a_b_workshop_level_2",
upgradeInfo:"workshop"},ECUpgrader:e.EC_DEFAULT,ECSockets:{sockets:[{archetypeName:"a_b_hqworkshop",localOffset:[3*Math.cos(2*Math.PI/6),0.5,3*Math.sin(2*Math.PI/6)]},{archetypeName:"a_b_lumbermillworkshop",localOffset:[3*Math.cos(2*Math.PI/6),0.5,3*Math.sin(2*Math.PI/6)]},{archetypeName:"a_b_stonemillworkshop",localOffset:[3*Math.cos(2*Math.PI/6),0.5,3*Math.sin(2*Math.PI/6)]},{archetypeName:"a_b_defencefactoryworkshop",localOffset:[3*Math.cos(2*Math.PI/6),0.5,3*Math.sin(2*Math.PI/6)]},{archetypeName:"a_b_amberchestworkshop",
localOffset:[3*Math.cos(2*Math.PI/6),0.5,3*Math.sin(2*Math.PI/6)]},{archetypeName:"a_b_workshopmarketplace",localOffset:[3*Math.cos(2*Math.PI/6),0.5,3*Math.sin(2*Math.PI/6)]},{archetypeName:"a_b_wallworkshop",localOffset:[3*Math.cos(4*Math.PI/6),0.5,3*Math.sin(4*Math.PI/6)]},{archetypeName:"a_b_gateworkshop",localOffset:[3*Math.cos(6*Math.PI/6),0.5,3*Math.sin(6*Math.PI/6)]},{archetypeName:"a_b_towerworkshop",localOffset:[3*Math.cos(8*Math.PI/6),0.5,3*Math.sin(8*Math.PI/6)]},{archetypeName:"a_b_workshoprepairer",
localOffset:[3*Math.cos(10*Math.PI/6),0.5,3*Math.sin(10*Math.PI/6)]},{archetypeName:"a_b_buildlinghutworkshop",localOffset:[3*Math.cos(12*Math.PI/6),0.5,3*Math.sin(12*Math.PI/6)]},{archetypeName:"a_b_workshop_smoke",localOffset:[0,0,0]}]},ECBuildingPlacementRadius:{buildingRadius:12},ECDispenser:{showUnavailableDueToPrerequisites:!1,contents:[]},ECEffectSpawner:{onCreateEffect:"sfx_crt_building",onDeathEffect:"sfx_dth_building"},ECRadialMenu:e.EC_DEFAULT,ECWorldGui:{text1:"Workshop",text2:"Level 1",
onScreenGuiArchetype:"tipWorkshop",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_b_workshop_level_2={shouldPlayerSave:!0,parent:"a_b_workshop",ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_workshop_level02.dae",localOffset:[0,0,0]},ECHealth:{health:e.balanceBuildings.a_b_workshop_level_2.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_workshop_level_2.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_workshop_level_2.secondaryResourceCost,
buildTime:e.balanceBuildings.a_b_workshop_level_2.buildTime,level:2,prerequisites:[{buildingType:"HQ",level:2}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_workshop_level_2.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_workshop_level_2.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 3",upgradeArchetypeName:"a_b_workshop_level_3"},ECWorldGui:{text2:"Level 2"}};e.archetypes.a_b_workshop_level_3={shouldPlayerSave:!0,parent:"a_b_workshop_level_2",ECMesh:{scale:1,
offsetY:-0.5,path:"environment/models/e_b_workshop_level03.dae",localOffset:[0,0,0]},ECHealth:{health:e.balanceBuildings.a_b_workshop_level_3.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_workshop_level_3.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_workshop_level_3.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_workshop_level_3.buildTime,level:3,prerequisites:[{buildingType:"HQ",level:3}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_workshop_level_3.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_b_workshop_level_3.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 4",upgradeArchetypeName:"a_b_workshop_level_4"},ECWorldGui:{text2:"Level 3"}};e.archetypes.a_b_workshop_level_4={shouldPlayerSave:!0,parent:"a_b_workshop_level_3",ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_workshop_level04.dae",localOffset:[0,0,0]},ECHealth:{health:e.balanceBuildings.a_b_workshop_level_4.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_workshop_level_4.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_b_workshop_level_4.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_workshop_level_4.buildTime,level:4,prerequisites:[{buildingType:"HQ",level:4}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_workshop_level_4.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_workshop_level_4.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 5",upgradeArchetypeName:"a_b_workshop_level_5"},ECWorldGui:{text2:"Level 4"}};e.archetypes.a_b_workshop_level_5=
{shouldPlayerSave:!0,parent:"a_b_workshop_level_4",ECMesh:{scale:1,offsetY:-0.5,path:"environment/models/e_b_workshop_level05.dae",localOffset:[0,0,0]},ECHealth:{health:e.balanceBuildings.a_b_workshop_level_5.health},ECBuilding:{resourceCost:e.balanceBuildings.a_b_workshop_level_5.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_workshop_level_5.secondaryResourceCost,buildTime:e.balanceBuildings.a_b_workshop_level_5.buildTime,level:5,prerequisites:[{buildingType:"HQ",level:5}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_workshop_level_5.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_b_workshop_level_5.maxResourceRepairCost},ECUpgradable:e.EC_REMOVE,ECUpgrader:e.EC_REMOVE,ECWorldGui:{text2:"Level 5"}};e.archetypes.a_b_lumbermillworkshop={shouldPlayerSave:!0,familyName:"lumbermillworkshop",ECMesh:{scale:1.9*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/workshop_mill.dae",localOffset:[0,0,0]},ECMeshAnimation:{v3RotationSpeed:[0,1.5,0],v3Offset:[0,0.0625,0],v3OffsetFrequency:[0,0.5,0],v3Oscillate:[0,0,0],v3OscillateFrequency:[0,
0,0]},ECSprite:{size:1.1,offsetY:0.4,path:"textures/glowfull.dds",additive:!0,color:[126/255,42/255,239/255,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{disableWhenCapReached:!0,contents:[{dispenseName:"Lumbermill",dispensedArchetypeName:"a_b_lumbermill",stackableInHand:!1,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_stonemillworkshop={shouldPlayerSave:!0,familyName:"stonemillworkshop",ECMesh:{scale:1.75*WorkshopSettings.iconSize,offsetY:0,
path:"environment/models/workshop_stonemill.dae",localOffset:[0,0,0]},ECMeshAnimation:{v3RotationSpeed:[0,1.5,0],v3Offset:[0,0.0625,0],v3OffsetFrequency:[0,0.5,0],v3Oscillate:[0,0,0],v3OscillateFrequency:[0,0,0]},ECSprite:{size:1.1,offsetY:0.4,path:"textures/glowfull.dds",additive:!0,color:[126/255,42/255,239/255,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{disableWhenCapReached:!0,contents:[{dispenseName:"Stonemill",dispensedArchetypeName:"a_b_stonemill",stackableInHand:!1,
quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_amberchestworkshop={shouldPlayerSave:!0,familyName:"amberchestworkshop",ECMesh:{scale:1.7*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/workshop_chest.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:1.1,offsetY:0.4,path:"textures/glowfull.dds",additive:!0,color:[126/255,42/255,239/255,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{disableWhenCapReached:!0,
contents:[{dispenseName:"Amber Chest",dispensedArchetypeName:"a_b_amberchest",stackableInHand:!1,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_defencefactoryworkshop={shouldPlayerSave:!0,familyName:"defencefactoryworkshop",ECMesh:{scale:1.8*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/workshop_warfactory.dae",localOffset:[0,0,0]},ECMeshAnimation:{v3RotationSpeed:[0,1.5,0],v3Offset:[0,0.0625,0],v3OffsetFrequency:[0,0.5,0],v3Oscillate:[0,0,0],v3OscillateFrequency:[0,
0,0]},ECSprite:{size:1.1,offsetY:0.4,path:"textures/glowfull.dds",additive:!0,color:[126/255,42/255,239/255,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{disableWhenCapReached:!0,contents:[{dispenseName:"Defence Factory",dispensedArchetypeName:"a_b_defencefactory",stackableInHand:!1,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_outpostworkshop={shouldPlayerSave:!0,familyName:"outpostworkshop",ECMesh:{scale:2*WorkshopSettings.iconSize,offsetY:0,
path:"environment/models/workshop_outpost.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:0.75,offsetY:0.4,path:"textures/glowfull.dds",additive:!0,color:[1,54/255,0,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{meshWhenCapReached:"environment/models/outpostshell.dae",contents:[{dispenseName:"Outpost",dispensedArchetypeName:"a_b_outpost",stackableInHand:!1,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_lumberstorageworkshop=
{shouldPlayerSave:!0,familyName:"lumberstorageworkshop",ECMesh:{scale:2*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/workshop_storage.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:0.75,offsetY:0.4,path:"textures/glowfull.dds",additive:!0,color:[126/255,223/255,0,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{meshWhenCapReached:"environment/models/lumberstorageshell.dae",contents:[{dispenseName:"Lumber Storage",dispensedArchetypeName:"a_b_lumberstorage",
stackableInHand:!1,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_stonestorageworkshop={shouldPlayerSave:!0,familyName:"stonestorageworkshop",ECMesh:{scale:2*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/workshop_stonestorage.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:0.75,offsetY:0.4,path:"textures/glowfull.dds",additive:!0,color:[0,252/255,231/255,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{meshWhenCapReached:"environment/models/stonestorageshell.dae",
contents:[{dispenseName:"Stone Storage",dispensedArchetypeName:"a_b_stonestorage",stackableInHand:!1,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_libraryworkshop={shouldPlayerSave:!0,familyName:"libraryworkshop",ECMesh:{scale:1.5*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/workshop_library.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:0.75,offsetY:0,path:"textures/glowfull.dds",additive:!0,color:[1,54/255,0,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},
ECInteractable:e.EC_DEFAULT,ECDispenser:{disableWhenCapReached:!0,contents:[{dispenseName:"Library",dispensedArchetypeName:"a_b_library",stackableInHand:!1,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_buildlinghutworkshop={shouldPlayerSave:!0,familyName:"buildlinghutworkshop",ECMesh:{scale:1.75*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/workshop_wildling.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:0.75,offsetY:0.4,path:"textures/glowfull.dds",
additive:!0,color:[126/255,42/255,239/255,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{disableWhenCapReached:!0,showUnavailableDueToPrerequisites:!1,contents:[{dispenseName:"Buildling Hut",dispensedArchetypeName:"a_b_wildlinghouse_build",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Buildling Hut",dispensedArchetypeName:"a_b_wildlinghouse_build_2",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Buildling Hut",dispensedArchetypeName:"a_b_wildlinghouse_build_3",
stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Buildling Hut",dispensedArchetypeName:"a_b_wildlinghouse_build_4",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Buildling Hut",dispensedArchetypeName:"a_b_wildlinghouse_build_5",stackableInHand:!1,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_workshoprepairer={shouldPlayerSave:!0,familyName:"workshoprepairer",ECMesh:{scale:1.3*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/workshop_spanner.dae",
localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:0.75,offsetY:0.2,path:"textures/glowfull.dds",additive:!0,color:[126/255,42/255,239/255,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECRepairer:{includeScaffoldTypes:["normal"],excludeBuildingTypes:["Outpost"],owner:!0,repairAllText:"GAME_HUD_REPAIR_ALL_WORKSHOP",nothingToRepairText:"GAME_HUD_REPAIR_NOTHING_TO_DO_WORKSHOP"},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_towerworkshop={shouldPlayerSave:!0,familyName:"towerworkshop",
ECMesh:{scale:1.5*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/workshop_tower.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:0.75,offsetY:0.4,path:"textures/glowfull.dds",additive:!0,color:[126/255,42/255,239/255,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{meshWhenCapReached:"environment/models/towershell.dae",contents:[{dispenseName:"Stone Tower",dispensedArchetypeName:"a_d_tower",stackableInHand:!1,quantityPerPurchase:1}]},
ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_workshopmarketplace={shouldPlayerSave:!0,familyName:"marketplaceworkshop",ECMesh:{scale:1.3*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/workshop_marketplace.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:0.75,offsetY:0.4,path:"textures/glowfull.dds",additive:!0,color:[126/255,42/255,239/255,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{meshWhenCapReached:"environment/models/marketplaceshell.dae",
contents:[{dispenseName:"Decoration Marketplace",dispensedArchetypeName:"a_b_marketplace",stackableInHand:!1,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_wallworkshop={shouldPlayerSave:!0,familyName:"wallworkshop",ECMesh:{scale:2*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/workshop_wall.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:0.75,offsetY:0.4,path:"textures/glowfull.dds",additive:!0,color:[126/255,42/255,239/255,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},
ECInteractable:e.EC_DEFAULT,ECDispenser:{meshWhenCapReached:"environment/models/wallshell.dae",contents:[{dispenseName:"Stone Wall",dispensedArchetypeName:"a_d_wall",stackableInHand:!0,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_hqworkshop={shouldPlayerSave:!0,familyName:"hqworkshop",ECMesh:{scale:1.1*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/workshop_hq.dae",localOffset:[0,0,0]},ECSprite:{size:0.75,offsetY:0.4,path:"textures/glowfull.dds",additive:!0,color:[126/
255,42/255,239/255,0.4]},ECMeshAnimation:{v3RotationSpeed:[0,1.5,0],v3Offset:[0,0.09375,0],v3OffsetFrequency:[0,0.5,0],v3Oscillate:[0,0,0],v3OscillateFrequency:[0,0,0]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{disableWhenCapReached:!0,contents:[{dispenseName:"Headquarters",dispensedArchetypeName:"a_b_hq",stackableInHand:!0,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_gateworkshop={shouldPlayerSave:!0,familyName:"gateworkshop",ECMesh:{scale:2*
WorkshopSettings.iconSize,offsetY:0,path:"environment/models/workshop_gate.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:0.75,offsetY:0.4,path:"textures/glowfull.dds",additive:!0,color:[126/255,42/255,239/255,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{meshWhenCapReached:"environment/models/gateshell.dae",contents:[{dispenseName:"Stone Gate",dispensedArchetypeName:"a_d_gate",stackableInHand:!0,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};
e.archetypes.a_b_workshop_smoke={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_workshop_smoke.dae"}};e.archetypes.a_b_marketplace={shouldPlayerSave:!0,familyName:"Marketplace",ECMesh:{scale:0.85,offsetY:-0.5,path:"environment/models/e_v_marketplace.dae",localOffset:[0,0,0]},ECPhysicsCube:{stationary:!0,v3Scale:[3,3,3],offsetY:1,scaleMesh:!1,terrainType:"building"},ECHealth:{health:e.balanceBuildings.a_b_marketplace.health,drawInWorldBarIfDamagedRecently:!0,drawOffScreenIconIfDamagedRecently:!0},
ECSelectable:e.EC_DEFAULT,ECTarget:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_marketplace.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_marketplace.maxResourceRepairCost},ECBuilding:{resourceCost:0,secondaryResourceCost:200,buildTime:e.balanceBuildings.a_b_marketplace.buildTime,autoRebuild:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Marketplace",level:1,addedFootprintSize:2,scaffoldCap:0,prerequisites:[{buildingType:"HQ",
level:1}],globalCaps:[{buildingType:"Light",quantity:50},{buildingType:"Flowerbed",quantity:20},{buildingType:"Statue",quantity:1},{buildingType:"Gong",quantity:1},{buildingType:"Bell",quantity:1},{buildingType:"Fountain",quantity:5},{buildingType:"Flag",quantity:50},{buildingType:"Tree Seed",quantity:5},{buildingType:"Stone Seed",quantity:5},{buildingType:"Tile",quantity:150}]},ECSockets:{sockets:[{archetypeName:"a_b_tilemarketplace",localOffset:[3*Math.cos(2*Math.PI/5),0.5,3*Math.sin(2*Math.PI/
5)]},{archetypeName:"a_b_flagmarketplace",localOffset:[3*Math.cos(4*Math.PI/5),0.5,3*Math.sin(4*Math.PI/5)]},{archetypeName:"a_b_lightmarketplace",localOffset:[3*Math.cos(6*Math.PI/5),0.5,3*Math.sin(6*Math.PI/5)]},{archetypeName:"a_b_monumentmarketplace",localOffset:[3*Math.cos(8*Math.PI/5),0.5,3*Math.sin(8*Math.PI/5)]},{archetypeName:"a_b_naturemarketplace",localOffset:[3*Math.cos(10*Math.PI/5),0.5,3*Math.sin(10*Math.PI/5)]},{archetypeName:"v_socket_glow",localOffset:[1.4,3.9,0]},{archetypeName:"v_socket_glow",
localOffset:[-1.4,3.9,0]}]},ECPlacedBuildingTracker:{canMoveIfBuildingsAlreadyPlaced:!0,localCaps:[{buildingType:"Buildling Hut",quantity:5}]},ECBuildingPlacementRadius:{buildingRadius:12},ECDispenser:{showUnavailableDueToPrerequisites:!1,contents:[]},ECEffectSpawner:{onCreateEffect:"sfx_crt_building",onDeathEffect:"sfx_dth_building"},ECRadialMenu:e.EC_DEFAULT,ECWorldGui:{text1:"Marketplace",text2:"Level 1",onScreenGuiArchetype:"tipMarketplace",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,
visibleOnHover:!0}};e.archetypes.a_b_tilemarketplace={shouldPlayerSave:!0,familyName:"tilemarketplace",ECMesh:{scale:2*WorkshopSettings.iconSize,offsetY:0.4,path:"environment/models/marketplace_tiles.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:0.75,offsetY:0,path:"textures/glowfull.dds",additive:!0,color:[1,174/255,0,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{meshWhenCapReached:"environment/models/tileshell.dae",contents:[{dispenseName:"Square Floor Tile",
dispensedArchetypeName:"v_tile_square",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Rounded Floor Tile",dispensedArchetypeName:"v_tile_rounded",stackableInHand:!1,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_flagmarketplace={shouldPlayerSave:!0,familyName:"flagmarketplace",ECMesh:{scale:1.75*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/marketplace_flags.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:0.75,offsetY:0.4,path:"textures/glowfull.dds",
additive:!0,color:[1,174/255,0,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{meshWhenCapReached:"environment/models/flagshell.dae",contents:[{dispenseName:"Decorative Flag",dispensedArchetypeName:"v_flag",stackableInHand:!1,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_lightmarketplace={shouldPlayerSave:!0,familyName:"lightmarketplace",ECMesh:{scale:1.7*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/marketplace_lights.dae",
localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:0.75,offsetY:0.4,path:"textures/glowfull.dds",additive:!0,color:[1,174/255,0,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{meshWhenCapReached:"environment/models/lightshell.dae",contents:[{dispenseName:"Light Crystal Stand",dispensedArchetypeName:"v_light_crystal_post",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Light Crystal",dispensedArchetypeName:"v_light_crystal",stackableInHand:!1,
quantityPerPurchase:1},{dispenseName:"Lantern",dispensedArchetypeName:"v_light_lantern_yellow",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Lantern Stand",dispensedArchetypeName:"v_light_lantern_stand_yellow",stackableInHand:!1,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_monumentmarketplace={shouldPlayerSave:!0,familyName:"monumentmarketplace",ECMesh:{scale:2*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/marketplace_monuments.dae",localOffset:[0,
0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:0.75,offsetY:0.4,path:"textures/glowfull.dds",additive:!0,color:[1,174/255,0,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{meshWhenCapReached:"environment/models/monumentshell.dae",contents:[{dispenseName:"Sageling Statue",dispensedArchetypeName:"v_statue_sage",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Town Bell",dispensedArchetypeName:"v_bell",quantityPerPurchase:1},{dispenseName:"Musical Gong",
dispensedArchetypeName:"v_gong",quantityPerPurchase:1},{dispenseName:"Fountain",dispensedArchetypeName:"v_fountain",quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_naturemarketplace={shouldPlayerSave:!0,familyName:"naturemarketplace",ECMesh:{scale:2.1*WorkshopSettings.iconSize,offsetY:0.1,path:"environment/models/marketplace_nature.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:0.75,offsetY:0.2,path:"textures/glowfull.dds",additive:!0,color:[1,174/255,0,
0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{meshWhenCapReached:"environment/models/natureshell.dae",contents:[{dispenseName:"Flower Bed",dispensedArchetypeName:"v_flowerbed",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Tree Seed",dispensedArchetypeName:"a_v_seed_tree",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Stone Seed",dispensedArchetypeName:"a_v_seed_rock",stackableInHand:!1,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT};
e.archetypes.v_socket_glow={ECSprite:{size:0.7,path:"textures/glowfull.dds",additive:!0,color:[1,174/255,0,0.2]}};e.archetypes.e_s_cloud_big={shouldLevelSave:!0,ECMesh:{scale:1,randomScale:0.2,offsetY:20,randomRotationY:0.1*Math.PI,path:"environment/models/e_s_cloudbig.dae"},ECCloud:{minSpeed:1,maxSpeed:1,minLife:400/3,maxLife:200}};e.archetypes.e_s_cloud_med={shouldLevelSave:!0,ECMesh:{scale:1,randomScale:0.2,offsetY:17.5,randomRotationY:0.1*Math.PI,path:"environment/models/e_s_cloudmed.dae"},ECCloud:{minSpeed:1,
maxSpeed:1,minLife:400/3,maxLife:200}};e.archetypes.e_s_cloud_small={shouldLevelSave:!0,ECMesh:{scale:1,randomScale:0.2,offsetY:15,randomRotationY:0.1*Math.PI,path:"environment/models/e_s_cloudsmall.dae"},ECCloud:{minSpeed:1,maxSpeed:1,minLife:400/3,maxLife:200}};e.archetypes.e_s_cloudSpawner={ECEntitySpawnManager:{minTimeBetweenAddingNewEntity:30,maxTimeBetweenAddingNewEntity:60,entityArchetypes:[{likelihood:1,archetype:"e_s_cloud_big"},{likelihood:1.5,archetype:"e_s_cloud_med"},{likelihood:2,archetype:"e_s_cloud_small"}],
maxEntities:24,randomGenerateRadius:60}};e.archetypes.e_s_torchpost={shouldLevelSave:!0,ECMesh:{scale:1,offsetY:0,path:"environment/models/e_s_torchpost.dae"},ECPhysicsCube:{stationary:!0,v3Scale:[0.5,1,0.5],offsetY:0,scaleMesh:!1},ECSockets:{sockets:[{archetypeName:"v_socket_glow_torch",localOffset:[0,1,0]}]}};e.archetypes.v_socket_glow_torch={ECSprite:{size:1,offsetY:0,path:"textures/glowfull.dds",additive:!0,color:[1,174/255,0,0.4]}};e.archetypes.e_s_floating_gun={shouldLevelSave:!1,shouldPlayerSave:!0,
familyName:"tutorialgun",ECMesh:{scale:1,offsetY:0,path:"characters/models/hero_gun.dae"},ECMeshAnimation:{v3RotationSpeed:[0,0.5,0],v3Offset:[0,0.15,0],v3OffsetFrequency:[0,1/3,0],v3Oscillate:[0.05,0,0.05],v3OscillateFrequency:[0.4,0,0.5]},ECSprite:{size:0.8,path:"textures/orb.dds",additive:!0,rotationSpeed:-0.2,color:[1,1,1,0.3]},ECPickup:{item:"wp_h_shotgun_cone01"}};e.archetypes.e_s_floating_crate={shouldLevelSave:!0,ECMesh:{scale:1,offsetY:0,path:"environment/models/e_s_floatingcrate.dae"},ECMeshAnimation:{v3RotationSpeed:[0,
0.01,0],v3Offset:[0,0.15,0],v3OffsetFrequency:[0,1/3,0],v3Oscillate:[0.05,0,0.05],v3OscillateFrequency:[0.4,0,0.5]}};e.archetypes.e_s_floating_plank={shouldLevelSave:!0,ECMesh:{scale:1,offsetY:0,path:"environment/models/e_s_floatingplank.dae"},ECMeshAnimation:{v3RotationSpeed:[0,0.01,0],v3Offset:[0,0.1,0],v3OffsetFrequency:[0,0.5,0],v3Oscillate:[0.05,0,0.05],v3OscillateFrequency:[0.4,0,0.5]}};e.archetypes.e_s_breakable_crate={shouldLevelSave:!1,shouldPlayerSave:!0,ECMesh:{scale:1,offsetY:0,path:"environment/models/e_s_crate.dae"},
ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],offsetY:1,scaleMesh:!1},ECTarget:null,ECHealth:{health:1,rooted:!0},ECLootDropper:{coinGroups:[{number:1,likelihood:1,archetype:"a_r_xp5"}],roomID:-1},ECSelectable:{radiusFactor:1,smart:!1},ECEffectSpawner:{onDestroyEffect:"sfx_dth_crate"}};e.archetypes.e_s_tutorial_crate={shouldLevelSave:!1,shouldPlayerSave:!0,familyName:"tutorialcrate",ECMesh:{scale:1,offsetY:0,path:"environment/models/e_s_crate.dae"},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],offsetY:1,
scaleMesh:!1},ECTarget:null,ECHealth:{health:1,rooted:!0},ECSelectable:{radiusFactor:1.5,smart:!1},ECEffectSpawner:{onDestroyEffect:"sfx_dth_crate"}};e.archetypes.e_s_firefly={shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"firefly",ECMesh:{scaleX:0.3,scaleY:0.2,scaleZ:0.2,randomScale:0.3,offsetY:2,path:"environment/models/e_i_amber.dae",numInstances:32},ECSprite:{size:0.2,offsetY:0,path:"textures/glowfull.dds",additive:!0,color:[248/255,164/255,15/255,0.15]},ECMeshAnimation:{v3RotationSpeed:[0,
0.5,0],v3Offset:[0.3125,0.125,0.3125],v3OffsetFrequency:[0.1875,0.3125,0.125],v3Oscillate:[0.125,0.5,0.125],v3OscillateFrequency:[0.125,0.025,0.07*1.25]}};e.archetypes.e_s_firefly_group={shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"fireflygroup",ECSockets:{sockets:[{archetypeName:"e_s_firefly",localOffset:[0,0,3.5]},{archetypeName:"e_s_firefly",localOffset:[-6.5,0,1.05]}]},ECEffectSpawner:{incidentalEffect:"sfx_amb_s_firefly",incidentalMinTime:30,incidentalMaxTime:60}};e.archetypes.e_s_firefly_two=
{shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"fireflygroup",ECSockets:{sockets:[{archetypeName:"e_s_firefly",localOffset:[-3.25,3.25,-1.75]}]}};e.archetypes.e_aud_drippingcave={shouldPlayerSave:!1,shouldLevelSave:!0,ECEffectSpawner:{ambientEffect:"sfx_amb_s_cave"},ECPhysicsSphere:{radius:0,usesGravity:!0,canClimb:!0,mass:1E3,height:0}};e.archetypes.e_aud_runningwater={shouldPlayerSave:!1,shouldLevelSave:!0,ECEffectSpawner:{ambientEffect:"sfx_amb_s_runningwater"},ECPhysicsSphere:{radius:0,usesGravity:!0,
canClimb:!0,mass:1E3,height:0}};e.archetypes.e_s_rockcliffwaterfall={shouldPlayerSave:!1,shouldLevelSave:!0,ECMesh:{scale:1,path:"environment/models/rockprop_01.dae"},ECEffectSpawner:{incidentalEffect:"sfx_amb_s_runningwater",incidentalMinTime:5,incidentalMaxTime:5}};e.archetypes.e_aud_waves={shouldPlayerSave:!1,shouldLevelSave:!0,ECEffectSpawner:{ambientEffect:"sfx_amb_s_waves"},ECPhysicsSphere:{radius:0,usesGravity:!0,canClimb:!0,mass:1E3,height:0}};e.archetypes.a_s_buildRadius={shouldPlayerSave:!1,
shouldLevelSave:!0,familyName:"buildRadius",ECBuildingPlacementRadius:{buildingRadius:32,trapRadius:32,validBuildingTypes:["all"],invalidBuildingTypes:["Barricade","Barricade Gate","Turret","Trap","Outpost"]}};e.archetypes.a_s_buildAntiRadius={shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"buildRadius",ECBuildingPlacementRadius:{buildingRadius:20,trapRadius:20,invalidBuildingTypes:["all"]}};e.archetypes.v_tile_square={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_floortiles01.dae",
scaleX:1.1,scaleY:1.6,offsetY:-0.5,numInstances:32},ECPhysicsCube:{stationary:!0,v3Scale:[1,0.01,1],offsetY:-0.495,scaleMesh:!1,terrainType:"tile"},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Tile",buildingName:"Square Floor Tiles",usesInfiniteBuildMode:!0,level:1,addedFootprintSize:0,randomRotate:!0,maxLinePlacementLength:5},ECSelectable:{smartRadiusFactor:0.2},ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,
ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_tile_rounded={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_floortiles02.dae",scaleX:1.1,scaleY:1.8,offsetY:-0.5,numInstances:32},ECPhysicsCube:{stationary:!0,v3Scale:[1,0.01,1],offsetY:-0.495,scaleMesh:!1,terrainType:"tile"},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Tile",buildingName:"Rounded Floor Tiles",usesInfiniteBuildMode:!0,level:1,addedFootprintSize:0,
randomRotate:!0,maxLinePlacementLength:5},ECSelectable:{smartRadiusFactor:0.2},ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_light_crystal_post={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_stand.dae",scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_light_crystal_yellow_top",localOffset:[0,1.65,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECDispenser:{destroySelfOnDispense:!0,
contents:[{dispenseName:"Red Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_red",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Pink Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_pink",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Green Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_green",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Blue Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_blue",stackableInHand:!1,
quantityPerPurchase:1},{dispenseName:"Purple Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_purple",stackableInHand:!1,quantityPerPurchase:1}]},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,randomRotate:!0,canPlaceAnywhere:!0,usesInfiniteBuildMode:!0,softCurrencyCost:10,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,
buildingType:"Light",buildingName:"Light Crystal Stand",level:1,stackable:!1,addedFootprintSize:0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_light_crystal_post_yellow={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_stand.dae",scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_light_crystal_yellow_top",localOffset:[0,1.65,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},
ECDispenser:{destroySelfOnDispense:!0,contents:[{dispenseName:"Red Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_red",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Pink Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_pink",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Green Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_green",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Blue Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_blue",
stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Purple Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_purple",stackableInHand:!1,quantityPerPurchase:1}]},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,randomRotate:!0,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Light",
buildingName:"Yellow Crystal Stand",level:1,stackable:!1,addedFootprintSize:0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_light_crystal_post_pink={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_stand.dae",scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_light_crystal_pink_top",localOffset:[0,1.65,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECDispenser:{destroySelfOnDispense:!0,
contents:[{dispenseName:"Red Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_red",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Yellow Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_yellow",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Green Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_green",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Blue Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_blue",stackableInHand:!1,
quantityPerPurchase:1},{dispenseName:"Purple Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_purple",stackableInHand:!1,quantityPerPurchase:1}]},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,randomRotate:!0,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Light",buildingName:"Yellow Crystal Stand",
level:1,stackable:!1,addedFootprintSize:0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_light_crystal_post_red={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_stand.dae",scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_light_crystal_red_top",localOffset:[0,1.65,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECDispenser:{destroySelfOnDispense:!0,contents:[{dispenseName:"Yellow Crystal\nStand",
dispensedArchetypeName:"v_light_crystal_post_yellow",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Green Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_green",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Pink Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_pink",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Blue Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_blue",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Purple Crystal\nStand",
dispensedArchetypeName:"v_light_crystal_post_purple",stackableInHand:!1,quantityPerPurchase:1}]},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,randomRotate:!0,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Light",buildingName:"Red Crystal Stand",level:1,stackable:!1,addedFootprintSize:0},
ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_light_crystal_post_blue={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_stand.dae",scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_light_crystal_blue_top",localOffset:[0,1.65,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECDispenser:{destroySelfOnDispense:!0,contents:[{dispenseName:"Red Crystal\nStand",
dispensedArchetypeName:"v_light_crystal_post_red",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Yellow Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_yellow",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Pink Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_pink",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Green Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_green",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Purple Crystal\nStand",
dispensedArchetypeName:"v_light_crystal_post_purple",stackableInHand:!1,quantityPerPurchase:1}]},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,randomRotate:!0,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Light",buildingName:"Blue Crystal Stand",level:1,stackable:!1,addedFootprintSize:0},
ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_light_crystal_post_green={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_stand.dae",scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_light_crystal_green_top",localOffset:[0,1.65,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECDispenser:{destroySelfOnDispense:!0,contents:[{dispenseName:"Red Crystal\nStand",
dispensedArchetypeName:"v_light_crystal_post_red",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Yellow Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_yellow",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Pink Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_pink",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Blue Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_blue",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Purple Crystal\nStand",
dispensedArchetypeName:"v_light_crystal_post_purple",stackableInHand:!1,quantityPerPurchase:1}]},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,randomRotate:!0,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Light",buildingName:"Green Crystal Stand",level:1,stackable:!1,addedFootprintSize:0},
ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_light_crystal_post_purple={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_stand.dae",scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_light_crystal_purple_top",localOffset:[0,1.65,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECDispenser:{destroySelfOnDispense:!0,contents:[{dispenseName:"Red Crystal\nStand",
dispensedArchetypeName:"v_light_crystal_post_red",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Yellow Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_yellow",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Green Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_green",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Pink Crystal\nStand",dispensedArchetypeName:"v_light_crystal_post_pink",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Blue Crystal\nStand",
dispensedArchetypeName:"v_light_crystal_post_blue",stackableInHand:!1,quantityPerPurchase:1}]},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,randomRotate:!0,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Light",buildingName:"Purple Crystal Stand",level:1,stackable:!1,addedFootprintSize:0},
ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_light_lantern_yellow={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_lantern.dae",scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_socket_glow_yellow_small",localOffset:[0,0.4,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,
10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,randomRotate:!0,usesInfiniteBuildMode:!0,canPlaceAnywhere:!0,softCurrencyCost:10,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Light",buildingName:"Lantern",level:1,stackable:!1,addedFootprintSize:0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_light_lantern_stand_yellow={shouldPlayerSave:!0,
ECMesh:{path:"environment/models/e_v_lightlantern.dae",scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_socket_glow_yellow",localOffset:[0,1.8,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,randomRotate:!0,usesInfiniteBuildMode:!0,
canPlaceAnywhere:!0,softCurrencyCost:10,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Light",buildingName:"Lantern Stand",level:1,stackable:!1,addedFootprintSize:0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_light_crystal={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_crystalplate.dae",scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_socket_glow_yellow_small",localOffset:[0,
0.5,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECDispenser:{destroySelfOnDispense:!0,contents:[{dispenseName:"Red Crystal",dispensedArchetypeName:"v_light_crystal_red",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Pink Crystal",dispensedArchetypeName:"v_light_crystal_pink",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Green Crystal",dispensedArchetypeName:"v_light_crystal_green",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Blue Crystal",
dispensedArchetypeName:"v_light_crystal_blue",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Purple Crystal",dispensedArchetypeName:"v_light_crystal_purple",stackableInHand:!1,quantityPerPurchase:1}]},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,randomRotate:!0,usesInfiniteBuildMode:!0,canPlaceAnywhere:!0,softCurrencyCost:10,
autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Light",buildingName:"Yellow Crystal",level:1,stackable:!1,addedFootprintSize:0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_light_crystal_yellow={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_crystalplate.dae",scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_socket_glow_yellow_small",localOffset:[0,0.5,0]}]},ECPhysicsCube:{stationary:!0,
v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECDispenser:{destroySelfOnDispense:!0,contents:[{dispenseName:"Red Crystal",dispensedArchetypeName:"v_light_crystal_red",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Pink Crystal",dispensedArchetypeName:"v_light_crystal_pink",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Green Crystal",dispensedArchetypeName:"v_light_crystal_green",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Blue Crystal",dispensedArchetypeName:"v_light_crystal_blue",
stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Purple Crystal",dispensedArchetypeName:"v_light_crystal_purple",stackableInHand:!1,quantityPerPurchase:1}]},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,randomRotate:!0,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Light",
buildingName:"Yellow Crystal",level:1,stackable:!1,addedFootprintSize:0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_light_crystal_pink={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_crystalplatepink.dae",scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_socket_glow_pink_small",localOffset:[0,0.5,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECDispenser:{destroySelfOnDispense:!0,
contents:[{dispenseName:"Red Crystal",dispensedArchetypeName:"v_light_crystal_red",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Pink Crystal",dispensedArchetypeName:"v_light_crystal_pink",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Green Crystal",dispensedArchetypeName:"v_light_crystal_green",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Blue Crystal",dispensedArchetypeName:"v_light_crystal_blue",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Purple Crystal",
dispensedArchetypeName:"v_light_crystal_purple",stackableInHand:!1,quantityPerPurchase:1}]},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,randomRotate:!0,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Light",buildingName:"Yellow Crystal",level:1,stackable:!1,addedFootprintSize:0},
ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_light_crystal_red={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_crystalplatered.dae",scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_socket_glow_red_small",localOffset:[0,0.5,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECDispenser:{destroySelfOnDispense:!0,contents:[{dispenseName:"Yellow Crystal",
dispensedArchetypeName:"v_light_crystal_yellow",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Pink Crystal",dispensedArchetypeName:"v_light_crystal_pink",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Green Crystal",dispensedArchetypeName:"v_light_crystal_green",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Blue Crystal",dispensedArchetypeName:"v_light_crystal_blue",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Purple Crystal",dispensedArchetypeName:"v_light_crystal_purple",
stackableInHand:!1,quantityPerPurchase:1}]},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,randomRotate:!0,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Light",buildingName:"Red Crystal",level:1,stackable:!1,addedFootprintSize:0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,
ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_light_crystal_blue={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_crystalplateblue.dae",scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_socket_glow_blue_small",localOffset:[0,0.5,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECDispenser:{destroySelfOnDispense:!0,contents:[{dispenseName:"Red Crystal",dispensedArchetypeName:"v_light_crystal_red",stackableInHand:!1,
quantityPerPurchase:1},{dispenseName:"Yellow Crystal",dispensedArchetypeName:"v_light_crystal_yellow",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Pink Crystal",dispensedArchetypeName:"v_light_crystal_pink",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Green Crystal",dispensedArchetypeName:"v_light_crystal_green",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Purple Crystal",dispensedArchetypeName:"v_light_crystal_purple",stackableInHand:!1,quantityPerPurchase:1}]},
ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,randomRotate:!0,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Light",buildingName:"Blue Crystal",level:1,stackable:!1,addedFootprintSize:0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};
e.archetypes.v_light_crystal_green={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_crystalplategreen.dae",scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_socket_glow_green_small",localOffset:[0,0.5,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECDispenser:{destroySelfOnDispense:!0,contents:[{dispenseName:"Red Crystal",dispensedArchetypeName:"v_light_crystal_red",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Yellow Crystal",
dispensedArchetypeName:"v_light_crystal_yellow",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Pink Crystal",dispensedArchetypeName:"v_light_crystal_pink",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Blue Crystal",dispensedArchetypeName:"v_light_crystal_blue",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Purple Crystal",dispensedArchetypeName:"v_light_crystal_purple",stackableInHand:!1,quantityPerPurchase:1}]},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,
10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,randomRotate:!0,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Light",buildingName:"Green Crystal",level:1,stackable:!1,addedFootprintSize:0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_light_crystal_purple={shouldPlayerSave:!0,
ECMesh:{path:"environment/models/e_v_crystalplatepurple.dae",scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_socket_glow_purple_small",localOffset:[0,0.5,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECDispenser:{destroySelfOnDispense:!0,contents:[{dispenseName:"Red Crystal",dispensedArchetypeName:"v_light_crystal_red",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Yellow Crystal",dispensedArchetypeName:"v_light_crystal_yellow",
stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Green Crystal",dispensedArchetypeName:"v_light_crystal_green",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Pink Crystal",dispensedArchetypeName:"v_light_crystal_pink",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Blue Crystal",dispensedArchetypeName:"v_light_crystal_blue",stackableInHand:!1,quantityPerPurchase:1}]},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",
disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,randomRotate:!0,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Light",buildingName:"Purple Crystal",level:1,stackable:!1,addedFootprintSize:0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_light_crystal_yellow_top={ECMesh:{path:"environment/models/e_v_crystalplate.dae",scale:1,offsetY:-0.5,numInstances:32},
ECSockets:{sockets:[{archetypeName:"v_socket_glow_yellow",localOffset:[0,1.65,0]}]}};e.archetypes.v_light_crystal_pink_top={ECMesh:{path:"environment/models/e_v_crystalplatepink.dae",scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_socket_glow_pink",localOffset:[0,1.65,0]}]}};e.archetypes.v_light_crystal_red_top={ECMesh:{path:"environment/models/e_v_crystalplatered.dae",scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_socket_glow_top_red",localOffset:[0,
1.65,0]}]}};e.archetypes.v_light_crystal_blue_top={ECMesh:{path:"environment/models/e_v_crystalplateblue.dae",scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_socket_glow_blue",localOffset:[0,1.65,0]}]}};e.archetypes.v_light_crystal_green_top={ECMesh:{path:"environment/models/e_v_crystalplategreen.dae",scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_socket_glow_top_green",localOffset:[0,1.65,0]}]}};e.archetypes.v_light_crystal_purple_top={ECMesh:{path:"environment/models/e_v_crystalplatepurple.dae",
scale:1,offsetY:-0.5,numInstances:32},ECSockets:{sockets:[{archetypeName:"v_socket_glow_top_purple",localOffset:[0,1.65,0]}]}};e.archetypes.v_socket_glow_sage={ECSprite:{size:1,path:"textures/glowfull.dds",additive:!0,color:[1,174/255,0,0.4]}};e.archetypes.v_socket_glow_yellow={ECSprite:{size:1.1,offsetY:0,path:"textures/glowfull.dds",additive:!0,color:[1,174/255,0,0.4]}};e.archetypes.v_socket_glow_yellow_small={ECSprite:{size:1.1,offsetY:0,path:"textures/glowstumpy.dds",additive:!0,color:[1,174/
255,0,0.4]}};e.archetypes.v_socket_glow_pink={ECSprite:{size:1.1,offsetY:0,path:"textures/glowfull.dds",additive:!0,color:[1,6/255,141/255,0.4]}};e.archetypes.v_socket_glow_pink_small={ECSprite:{size:1.1,offsetY:0,path:"textures/glowstumpy.dds",additive:!0,color:[1,6/255,141/255,0.4]}};e.archetypes.v_socket_glow_blue={ECSprite:{size:1.1,offsetY:0,path:"textures/glowfull.dds",additive:!0,color:[0,252/255,231/255,0.4]}};e.archetypes.v_socket_glow_blue_small={ECSprite:{size:1.1,offsetY:0,path:"textures/glowstumpy.dds",
additive:!0,color:[0,252/255,231/255,0.4]}};e.archetypes.v_socket_glow_red={ECSprite:{size:1.1,offsetY:0,path:"textures/glowfull.dds",additive:!0,color:[1,54/255,0,0.4]}};e.archetypes.v_socket_glow_top_red={ECSprite:{size:1.1,offsetY:0,path:"textures/glowfull.dds",additive:!0,color:[1,54/255,0,0.4]}};e.archetypes.v_socket_glow_red_small={ECSprite:{size:1.1,offsetY:0,path:"textures/glowstumpy.dds",additive:!0,color:[1,54/255,0,0.4]}};e.archetypes.v_socket_glow_top_green={ECSprite:{size:1.1,offsetY:0,
path:"textures/glowfull.dds",additive:!0,color:[126/255,223/255,0,0.4]}};e.archetypes.v_socket_glow_green_small={ECSprite:{size:1.1,offsetY:0,path:"textures/glowstumpy.dds",additive:!0,color:[126/255,223/255,0,0.4]}};e.archetypes.v_socket_glow_top_purple={ECSprite:{size:1.1,offsetY:0,path:"textures/glowfull.dds",additive:!0,color:[126/255,42/255,239/255,0.4]}};e.archetypes.v_socket_glow_purple_small={ECSprite:{size:1.1,offsetY:0,path:"textures/glowstumpy.dds",additive:!0,color:[126/255,42/255,239/
255,0.4]}};e.archetypes.v_statue_sage={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_statuesage.dae",scale:1,offsetY:-0.5},ECPhysicsCube:{stationary:!0,v3Scale:[2,2,2],scaleMesh:!1,terrainType:"building"},ECSockets:{sockets:[{archetypeName:"v_socket_glow_sage",localOffset:[1,3.85,0]}]},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10]},ECBuilding:{buildTime:3600,obeysScaffoldCap:!0,canPlaceAnywhere:!0,softCurrencyCost:200,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,
buildingType:"Statue",buildingName:"Sageling Statue",level:1,addedFootprintSize:1},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_bell={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_citybell.dae",scale:1,offsetY:-0.5},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",
disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,canPlaceAnywhere:!0,softCurrencyCost:30,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Bell",buildingName:"Town Bell",level:1,addedFootprintSize:0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_gong={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_citygong.dae",scale:1,offsetY:-0.5},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,
terrainType:"building"},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,canPlaceAnywhere:!0,softCurrencyCost:30,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Gong",buildingName:"Musical Gong",level:1,addedFootprintSize:0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};
e.archetypes.v_fountain={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_fountain01.dae",scale:1,offsetY:-0.5},ECPhysicsCube:{stationary:!0,v3Scale:[2,2,2],scaleMesh:!1,terrainType:"building"},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10]},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,canPlaceAnywhere:!0,softCurrencyCost:30,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Fountain",buildingName:"Fountain",level:1,addedFootprintSize:1},
ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_flowerbed={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_flowerpot.dae",scale:1.25,offsetY:-0.5,numInstances:32},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},
ECBuilding:{buildTime:0,obeysScaffoldCap:!1,usesInfiniteBuildMode:!0,canPlaceAnywhere:!0,softCurrencyCost:10,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Flowerbed",buildingName:"Flower Bed",level:1,addedFootprintSize:0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_v_seed_tree={shouldPlayerSave:!0,shouldLevelSave:!1,familyName:"vanitytree",ECMesh:{scale:1.4,randomScale:0.25,randomRotationY:Math.PI,offsetY:-0.5,
path:"environment/models/e_i_tree03.dae"},ECPhysicsCube:{stationary:!1,scaleMesh:!1,v3Scale:[0.5,5,0.5],offsetY:0,terrainType:"impass"},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,usesInfiniteBuildMode:!0,canPlaceAnywhere:!0,softCurrencyCost:100,buildingType:"Tree Seed",buildingName:"Tree Seed",addedFootprintSize:1},ECSelectable:{smart:!0,radiusFactor:1},ECInteractable:{requiresMovement:!1},ECResourceDispenser:{resourceType:E.LUMBER,growingMesh:"environment/models/e_i_treegrowing.dae",depletedMeshes:["environment/models/e_i_tree03trunk.dae",
"environment/models/e_i_tree03trunk02.dae","environment/models/e_i_tree03trunk03.dae","environment/models/e_i_tree03trunk04.dae"],maxResource:50,randMaxResource:0,growDuration:240,growDurationMax:480,resourcePerInteract:5,regrows:!0,chanceOfSoftCurrencyPerInteraction:0.005},ECAnimationPlayer:{animationSet:"tree02"}};e.archetypes.a_v_seed_rock={shouldPlayerSave:!0,shouldLevelSave:!1,familyName:"vanityrock",ECMesh:{scale:1,randomScale:0.1,randomRotationY:Math.PI,offsetY:-0.5,path:"environment/models/e_i_quarry01.dae"},
ECPhysicsCube:{stationary:!1,scaleMesh:!1,v3Scale:[1,1,1],offsetY:0,terrainType:"impass"},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,usesInfiniteBuildMode:!0,canPlaceAnywhere:!0,softCurrencyCost:100,buildingType:"Stone Seed",buildingName:"Stone Seed",addedFootprintSize:1},ECSelectable:{radiusFactor:1,smart:!0},ECInteractable:{requiresMovement:!1},ECResourceDispenser:{resourceType:E.STONE,growingMesh:"environment/models/e_i_quarry01.dae",depletedMeshes:["environment/models/e_i_quarry01.dae","environment/models/e_i_quarry02.dae",
"environment/models/e_i_quarry03.dae","environment/models/e_i_quarry04.dae","environment/models/e_i_quarry05.dae"],maxResource:35,randMaxResource:0,growDuration:120,growDurationMax:240,resourcePerInteract:5,regrows:!0,chanceOfSoftCurrencyPerInteraction:0.005}};e.archetypes.v_flag={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_flagpole.dae",scale:1,offsetY:-0.5},ECSockets:{sockets:[{archetypeName:"v_s_flag_red",localOffset:[0,0,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,
terrainType:"building"},ECDispenser:{destroySelfOnDispense:!0,contents:[{dispenseName:"Yellow Flag",dispensedArchetypeName:"v_flag_yellow",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Green Flag",dispensedArchetypeName:"v_flag_green",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Blue Flag",dispensedArchetypeName:"v_flag_blue",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Purple Flag",dispensedArchetypeName:"v_flag_purple",stackableInHand:!1,quantityPerPurchase:1},
{dispenseName:"White Flag",dispensedArchetypeName:"v_flag_white",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Black Flag",dispensedArchetypeName:"v_flag_black",stackableInHand:!1,quantityPerPurchase:1}]},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,usesInfiniteBuildMode:!0,canPlaceAnywhere:!0,softCurrencyCost:10,
autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Flag",buildingName:"Red Flag",level:1,stackable:!1,addedFootprintSize:0,noRotate:!0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_flag_red={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_flagpole.dae",scale:1,offsetY:-0.5},ECSockets:{sockets:[{archetypeName:"v_s_flag_red",localOffset:[0,0,0]}]},ECDispenser:{destroySelfOnDispense:!0,contents:[{dispenseName:"Yellow Flag",
dispensedArchetypeName:"v_flag_yellow",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Green Flag",dispensedArchetypeName:"v_flag_green",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Blue Flag",dispensedArchetypeName:"v_flag_blue",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Purple Flag",dispensedArchetypeName:"v_flag_purple",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"White Flag",dispensedArchetypeName:"v_flag_white",stackableInHand:!1,quantityPerPurchase:1},
{dispenseName:"Black Flag",dispensedArchetypeName:"v_flag_black",stackableInHand:!1,quantityPerPurchase:1}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Flag",
buildingName:"Yellow Flag",level:1,stackable:!1,addedFootprintSize:0,noRotate:!0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_s_flag_red={ECMesh:{path:"environment/models/flagred.dae",scale:0.8,offsetY:0.55,rotationY:1.8},ECMeshAnimation:{v3RotationSpeed:[0,0.01,0],v3Oscillate:[0,0.15,0],v3OscillateFrequency:[0,0.3,0],bobHeight:0.0375,bobPeriod:2}};e.archetypes.v_flag_yellow={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_flagpole.dae",
scale:1,offsetY:-0.5},ECSockets:{sockets:[{archetypeName:"v_s_flag_yellow",localOffset:[0,0,0]}]},ECDispenser:{destroySelfOnDispense:!0,contents:[{dispenseName:"Red Flag",dispensedArchetypeName:"v_flag_red",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Green Flag",dispensedArchetypeName:"v_flag_green",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Blue Flag",dispensedArchetypeName:"v_flag_blue",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Purple Flag",dispensedArchetypeName:"v_flag_purple",
stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"White Flag",dispensedArchetypeName:"v_flag_white",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Black Flag",dispensedArchetypeName:"v_flag_black",stackableInHand:!1,quantityPerPurchase:1}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},
ECBuilding:{buildTime:0,obeysScaffoldCap:!1,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Flag",buildingName:"Yellow Flag",level:1,stackable:!1,addedFootprintSize:0,noRotate:!0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_s_flag_yellow={ECMesh:{path:"environment/models/flagyellow.dae",scale:0.8,offsetY:0.55,rotationY:1.8},ECMeshAnimation:{v3RotationSpeed:[0,0.01,0],v3Oscillate:[0,
0.15,0],v3OscillateFrequency:[0,0.3,0],bobHeight:0.0375,bobPeriod:2.1}};e.archetypes.v_flag_blue={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_flagpole.dae",scale:1,offsetY:-0.5},ECSockets:{sockets:[{archetypeName:"v_s_flag_blue",localOffset:[0,0,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECDispenser:{destroySelfOnDispense:!0,contents:[{dispenseName:"Red Flag",dispensedArchetypeName:"v_flag_red",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Yellow Flag",
dispensedArchetypeName:"v_flag_yellow",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Green Flag",dispensedArchetypeName:"v_flag_green",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Purple Flag",dispensedArchetypeName:"v_flag_purple",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"White Flag",dispensedArchetypeName:"v_flag_white",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Black Flag",dispensedArchetypeName:"v_flag_black",stackableInHand:!1,quantityPerPurchase:1}]},
ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Flag",buildingName:"Blue Flag",level:1,stackable:!1,addedFootprintSize:0,noRotate:!0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};
e.archetypes.v_s_flag_blue={ECMesh:{path:"environment/models/flagblue.dae",scale:0.8,offsetY:0.55,rotationY:1.8},ECMeshAnimation:{v3RotationSpeed:[0,0.01,0],v3Oscillate:[0,0.15,0],v3OscillateFrequency:[0,0.3,0],bobHeight:0.0375,bobPeriod:2.2}};e.archetypes.v_flag_green={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_flagpole.dae",scale:1,offsetY:-0.5},ECSockets:{sockets:[{archetypeName:"v_s_flag_green",localOffset:[0,0,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},
ECDispenser:{destroySelfOnDispense:!0,contents:[{dispenseName:"Red Flag",dispensedArchetypeName:"v_flag_red",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Yellow Flag",dispensedArchetypeName:"v_flag_yellow",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Blue Flag",dispensedArchetypeName:"v_flag_blue",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Purple Flag",dispensedArchetypeName:"v_flag_purple",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"White Flag",
dispensedArchetypeName:"v_flag_white",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Black Flag",dispensedArchetypeName:"v_flag_black",stackableInHand:!1,quantityPerPurchase:1}]},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Flag",
buildingName:"Green Flag",level:1,stackable:!1,addedFootprintSize:0,noRotate:!0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_s_flag_green={ECMesh:{path:"environment/models/flaggreen.dae",scale:0.8,offsetY:0.55,rotationY:1.8},ECMeshAnimation:{v3RotationSpeed:[0,0.01,0],v3Oscillate:[0,0.15,0],v3OscillateFrequency:[0,0.3,0],bobHeight:0.0375,bobPeriod:2.3}};e.archetypes.v_flag_purple={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_flagpole.dae",
scale:1,offsetY:-0.5},ECSockets:{sockets:[{archetypeName:"v_s_flag_purple",localOffset:[0,0,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECDispenser:{destroySelfOnDispense:!0,contents:[{dispenseName:"Red Flag",dispensedArchetypeName:"v_flag_red",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Yellow Flag",dispensedArchetypeName:"v_flag_yellow",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Green Flag",dispensedArchetypeName:"v_flag_green",
stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Blue Flag",dispensedArchetypeName:"v_flag_blue",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"White Flag",dispensedArchetypeName:"v_flag_white",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Black Flag",dispensedArchetypeName:"v_flag_black",stackableInHand:!1,quantityPerPurchase:1}]},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",
disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Flag",buildingName:"Purple Flag",level:1,stackable:!1,addedFootprintSize:0,noRotate:!0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_s_flag_purple={ECMesh:{path:"environment/models/flagpurple.dae",scale:0.8,offsetY:0.55,rotationY:1.8},ECMeshAnimation:{v3RotationSpeed:[0,
0.01,0],v3Oscillate:[0,0.15,0],v3OscillateFrequency:[0,0.3,0],bobHeight:0.0375,bobPeriod:2.4}};e.archetypes.v_flag_white={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_flagpole.dae",scale:1,offsetY:-0.5},ECSockets:{sockets:[{archetypeName:"v_s_flag_white",localOffset:[0,0,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECDispenser:{destroySelfOnDispense:!0,contents:[{dispenseName:"Red Flag",dispensedArchetypeName:"v_flag_red",stackableInHand:!1,quantityPerPurchase:1},
{dispenseName:"Yellow Flag",dispensedArchetypeName:"v_flag_yellow",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Green Flag",dispensedArchetypeName:"v_flag_green",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Blue Flag",dispensedArchetypeName:"v_flag_blue",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Purple Flag",dispensedArchetypeName:"v_flag_purple",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Black Flag",dispensedArchetypeName:"v_flag_black",stackableInHand:!1,
quantityPerPurchase:1}]},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,buildingType:"Flag",buildingName:"White Flag",level:1,stackable:!1,addedFootprintSize:0,noRotate:!0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,
ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_s_flag_white={ECMesh:{path:"environment/models/flagwhite.dae",scale:0.8,offsetY:0.55,rotationY:1.8},ECMeshAnimation:{v3RotationSpeed:[0,0.01,0],v3Oscillate:[0,0.15,0],v3OscillateFrequency:[0,0.3,0],bobHeight:0.0375,bobPeriod:2.5}};e.archetypes.v_flag_black={shouldPlayerSave:!0,ECMesh:{path:"environment/models/e_v_flagpole.dae",scale:1,offsetY:-0.5},ECSockets:{sockets:[{archetypeName:"v_s_flag_black",localOffset:[0,0,0]}]},ECPhysicsCube:{stationary:!0,v3Scale:[1,
1,1],scaleMesh:!1,terrainType:"building"},ECDispenser:{destroySelfOnDispense:!0,contents:[{dispenseName:"Red Flag",dispensedArchetypeName:"v_flag_red",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Yellow Flag",dispensedArchetypeName:"v_flag_yellow",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Green Flag",dispensedArchetypeName:"v_flag_green",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"Blue Flag",dispensedArchetypeName:"v_flag_blue",stackableInHand:!1,quantityPerPurchase:1},
{dispenseName:"Purple Flag",dispensedArchetypeName:"v_flag_purple",stackableInHand:!1,quantityPerPurchase:1},{dispenseName:"White Flag",dispensedArchetypeName:"v_flag_white",stackableInHand:!1,quantityPerPurchase:1}]},ECHealth:{health:50},ECRepairable:{minResourceRepairCost:[10,10],maxResourceRepairCost:[10,10],damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECBuilding:{buildTime:0,obeysScaffoldCap:!1,canPlaceAnywhere:!0,softCurrencyCost:1,autoRebuild:!1,canSpeedUpWithSoftCurrency:!0,
buildingType:"Flag",buildingName:"Black Flag",level:1,stackable:!1,addedFootprintSize:0,noRotate:!0},ECSelectable:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT};e.archetypes.v_s_flag_black={ECMesh:{path:"environment/models/flagdark.dae",scale:0.8,offsetY:0.55,rotationY:1.8},ECMeshAnimation:{v3RotationSpeed:[0,0.01,0],v3Oscillate:[0,0.15,0],v3OscillateFrequency:[0,0.3,0],bobHeight:0.0375,bobPeriod:2.6}};e.archetypes.a_b_outpost={shouldPlayerSave:!0,familyName:"outpost",
ECMesh:{offsetY:-0.5,path:"environment/models/e_b_outpost.dae",localOffset:[0,0,0]},ECPhysicsCube:{stationary:!0,v3Scale:[2,2,2],offsetY:0.5,scaleMesh:!1,terrainType:"building"},ECHealth:{health:e.balanceBuildings.a_b_outpost.health,drawInWorldBarIfDamagedRecently:!0,drawOffScreenIconIfDamagedRecently:!0},ECHealthRegenerator:{radius:5},ECSelectable:{selectType:"selectTypePrepare"},ECTarget:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECResourceDestination:{validType:"selectTypeCampaign"},
ECPlacedBuildingTracker:{canMoveIfBuildingsAlreadyPlaced:!0,reduceHealthOfPlacedBuildingsWhenMove:!0,localCaps:[{buildingType:"Turret",quantity:2},{buildingType:"Trap",quantity:2},{buildingType:"Barricade",quantity:20},{buildingType:"Barricade Gate",quantity:2}]},ECBuilding:{buildTime:e.balanceBuildings.a_b_outpost.buildTime,resourceCost:e.balanceBuildings.a_b_outpost.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_outpost.secondaryResourceCost,canPlaceAnywhere:!0,autoRebuild:!0,canSpeedUpWithSoftCurrency:!0,
buildingType:"Outpost",level:1,defenceLevel:0,addedFootprintSize:2,prerequisites:[{buildingType:"Defendling Hut",level:1}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_outpost.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_outpost.maxResourceRepairCost},ECBuildingPlacementRadius:{buildingRadius:8,trapRadius:16,validBuildingTypes:["Barricade","Barricade Gate","Turret","Trap"]},ECUpgradable:{upgradeName:"Level 2",upgradeArchetypeName:"a_b_outpost_level_2",upgradeInfo:"outpost"},
ECUpgrader:e.EC_DEFAULT,ECSockets:{sockets:[{archetypeName:"a_b_turretworkshop",localOffset:[2.5*Math.cos(0*Math.PI/4),1,2.5*Math.sin(0*Math.PI/4)]},{archetypeName:"a_b_barricadeworkshop",localOffset:[2.5*Math.cos(2*Math.PI/4),1,2.5*Math.sin(2*Math.PI/4)]},{archetypeName:"a_b_trapworkshop",localOffset:[2.5*Math.cos(4*Math.PI/4),1,2.5*Math.sin(4*Math.PI/4)]},{archetypeName:"a_b_outpostrepairer",localOffset:[2.5*Math.cos(6*Math.PI/4),1,2.5*Math.sin(6*Math.PI/4)]}]},ECRadialMenu:e.EC_DEFAULT,ECEffectSpawner:{onCreateEffect:"sfx_crt_building",
onDeathEffect:"sfx_dth_building"},ECWorldGui:{text1:"Outpost",text2:"Level 1",onScreenGuiArchetype:"tipOutpost",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_b_outpost_level_2={shouldPlayerSave:!0,parent:"a_b_outpost",ECMesh:{path:"environment/models/e_b_outpost_level02.dae"},ECHealth:{health:e.balanceBuildings.a_b_outpost_level_2.health},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Turret",quantity:4},{buildingType:"Trap",quantity:2},
{buildingType:"Barricade",quantity:30},{buildingType:"Barricade Gate",quantity:4}]},ECBuilding:{buildTime:e.balanceBuildings.a_b_outpost_level_2.buildTime,resourceCost:e.balanceBuildings.a_b_outpost_level_2.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_outpost_level_2.secondaryResourceCost,canPlaceAnywhere:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Outpost",level:2,prerequisites:[{buildingType:"Defendling Hut",level:2}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_outpost_level_2.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_b_outpost_level_2.maxResourceRepairCost},ECBuildingPlacementRadius:{buildingRadius:12,trapRadius:20},ECUpgradable:{upgradeName:"Level 3",upgradeArchetypeName:"a_b_outpost_level_3",upgradeInfo:"outpost"},ECSockets:{sockets:[{archetypeName:"a_b_turretworkshop_level_2",localOffset:[2.5*Math.cos(0*Math.PI/4),1,2.5*Math.sin(0*Math.PI/4)]},{archetypeName:"a_b_barricadeworkshop_level_2",localOffset:[2.5*Math.cos(2*Math.PI/4),1,2.5*Math.sin(2*Math.PI/4)]},{archetypeName:"a_b_trapworkshop_level_2",
localOffset:[2.5*Math.cos(4*Math.PI/4),1,2.5*Math.sin(4*Math.PI/4)]},{archetypeName:"a_b_outpostrepairer",localOffset:[2.5*Math.cos(6*Math.PI/4),1,2.5*Math.sin(6*Math.PI/4)]}]},ECRadialMenu:e.EC_DEFAULT,ECWorldGui:{text2:"Level 2"}};e.archetypes.a_b_outpost_level_3={shouldPlayerSave:!0,parent:"a_b_outpost_level_2",ECMesh:{path:"environment/models/e_b_outpost_level03.dae"},ECHealth:{health:e.balanceBuildings.a_b_outpost_level_3.health},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Turret",quantity:6},
{buildingType:"Trap",quantity:4},{buildingType:"Barricade",quantity:40},{buildingType:"Barricade Gate",quantity:8}]},ECBuilding:{buildTime:e.balanceBuildings.a_b_outpost_level_3.buildTime,resourceCost:e.balanceBuildings.a_b_outpost_level_3.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_outpost_level_3.secondaryResourceCost,canPlaceAnywhere:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Outpost",level:3,prerequisites:[{buildingType:"Defendling Hut",level:3}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_outpost_level_3.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_b_outpost_level_3.maxResourceRepairCost},ECBuildingPlacementRadius:{buildingRadius:16,trapRadius:24},ECUpgradable:{upgradeName:"Level 4",upgradeArchetypeName:"a_b_outpost_level_4",upgradeInfo:"outpost"},ECSockets:{sockets:[{archetypeName:"a_b_turretworkshop_level_3",localOffset:[2.5*Math.cos(0*Math.PI/4),1,2.5*Math.sin(0*Math.PI/4)]},{archetypeName:"a_b_barricadeworkshop_level_3",localOffset:[2.5*Math.cos(2*Math.PI/4),1,2.5*Math.sin(2*Math.PI/4)]},{archetypeName:"a_b_trapworkshop_level_3",
localOffset:[2.5*Math.cos(4*Math.PI/4),1,2.5*Math.sin(4*Math.PI/4)]},{archetypeName:"a_b_outpostrepairer",localOffset:[2.5*Math.cos(6*Math.PI/4),1,2.5*Math.sin(6*Math.PI/4)]}]},ECRadialMenu:e.EC_DEFAULT,ECWorldGui:{text2:"Level 3"}};e.archetypes.a_b_outpost_level_4={shouldPlayerSave:!0,parent:"a_b_outpost_level_3",ECPhysicsCube:{v3Scale:[4,2,4]},ECMesh:{path:"environment/models/e_b_outpost_level04.dae"},ECHealth:{health:e.balanceBuildings.a_b_outpost_level_4.health},ECPlacedBuildingTracker:{localCaps:[{buildingType:"Turret",
quantity:6},{buildingType:"Trap",quantity:6},{buildingType:"Barricade",quantity:50},{buildingType:"Barricade Gate",quantity:10}]},ECBuilding:{buildTime:e.balanceBuildings.a_b_outpost_level_4.buildTime,resourceCost:e.balanceBuildings.a_b_outpost_level_4.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_outpost_level_4.secondaryResourceCost,canPlaceAnywhere:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Outpost",level:4,addedFootprintSize:1,prerequisites:[{buildingType:"Defendling Hut",level:4}]},
ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_outpost_level_4.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_outpost_level_4.maxResourceRepairCost},ECBuildingPlacementRadius:{buildingRadius:20,trapRadius:28},ECUpgradable:{upgradeName:"Level 5",upgradeArchetypeName:"a_b_outpost_level_5",upgradeInfo:"outpost"},ECSockets:{sockets:[{archetypeName:"a_b_turretworkshop_level_4",localOffset:[2.5*Math.cos(0*Math.PI/4),1,2.5*Math.sin(0*Math.PI/4)]},{archetypeName:"a_b_barricadeworkshop_level_4",
localOffset:[2.5*Math.cos(2*Math.PI/4),1,2.5*Math.sin(2*Math.PI/4)]},{archetypeName:"a_b_trapworkshop_level_4",localOffset:[2.5*Math.cos(4*Math.PI/4),1,2.5*Math.sin(4*Math.PI/4)]},{archetypeName:"a_b_outpostrepairer",localOffset:[2.5*Math.cos(6*Math.PI/4),1,2.5*Math.sin(6*Math.PI/4)]}]},ECRadialMenu:e.EC_DEFAULT,ECWorldGui:{text2:"Level 4"}};e.archetypes.a_b_outpost_level_5={shouldPlayerSave:!0,parent:"a_b_outpost_level_4",ECMesh:{path:"environment/models/e_b_outpost_level05.dae"},ECHealth:{health:e.balanceBuildings.a_b_outpost_level_5.health},
ECPlacedBuildingTracker:{localCaps:[{buildingType:"Turret",quantity:8},{buildingType:"Trap",quantity:6},{buildingType:"Barricade",quantity:60},{buildingType:"Barricade Gate",quantity:10}]},ECBuilding:{buildTime:e.balanceBuildings.a_b_outpost_level_5.buildTime,resourceCost:e.balanceBuildings.a_b_outpost_level_5.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_outpost_level_5.secondaryResourceCost,canPlaceAnywhere:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Outpost",level:5,prerequisites:[{buildingType:"Defendling Hut",
level:5}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_outpost_level_5.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_outpost_level_5.maxResourceRepairCost},ECBuildingPlacementRadius:{buildingRadius:24,trapRadius:32},ECUpgradable:{upgradeName:"Level 6",upgradeArchetypeName:"a_b_outpost_level_6",upgradeInfo:"outpost"},ECSockets:{sockets:[{archetypeName:"a_b_turretworkshop_level_5",localOffset:[2.5*Math.cos(0*Math.PI/4),1,2.5*Math.sin(0*Math.PI/4)]},{archetypeName:"a_b_barricadeworkshop_level_5",
localOffset:[2.5*Math.cos(2*Math.PI/4),1,2.5*Math.sin(2*Math.PI/4)]},{archetypeName:"a_b_trapworkshop_level_5",localOffset:[2.5*Math.cos(4*Math.PI/4),1,2.5*Math.sin(4*Math.PI/4)]},{archetypeName:"a_b_outpostrepairer",localOffset:[2.5*Math.cos(6*Math.PI/4),1,2.5*Math.sin(6*Math.PI/4)]}]},ECRadialMenu:e.EC_DEFAULT,ECWorldGui:{text2:"Level 5"}};e.archetypes.a_b_outpost_level_6={shouldPlayerSave:!0,parent:"a_b_outpost_level_5",ECMesh:{path:"environment/models/e_b_outpost_level06.dae"},ECHealth:{health:e.balanceBuildings.a_b_outpost_level_6.health},
ECPlacedBuildingTracker:{localCaps:[{buildingType:"Turret",quantity:8},{buildingType:"Trap",quantity:8},{buildingType:"Barricade",quantity:60},{buildingType:"Barricade Gate",quantity:12}]},ECBuilding:{buildTime:e.balanceBuildings.a_b_outpost_level_6.buildTime,resourceCost:e.balanceBuildings.a_b_outpost_level_6.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_outpost_level_6.secondaryResourceCost,canPlaceAnywhere:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Outpost",level:6,prerequisites:[{buildingType:"Defendling Hut",
level:6}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_outpost_level_6.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_outpost_level_6.maxResourceRepairCost},ECBuildingPlacementRadius:{buildingRadius:24,trapRadius:32},ECUpgradable:{upgradeName:"Level 7",upgradeArchetypeName:"a_b_outpost_level_7",upgradeInfo:"outpost"},ECSockets:{sockets:[{archetypeName:"a_b_turretworkshop_level_6",localOffset:[2.5*Math.cos(0*Math.PI/4),1,2.5*Math.sin(0*Math.PI/4)]},{archetypeName:"a_b_barricadeworkshop_level_6",
localOffset:[2.5*Math.cos(2*Math.PI/4),1,2.5*Math.sin(2*Math.PI/4)]},{archetypeName:"a_b_trapworkshop_level_6",localOffset:[2.5*Math.cos(4*Math.PI/4),1,2.5*Math.sin(4*Math.PI/4)]},{archetypeName:"a_b_outpostrepairer",localOffset:[2.5*Math.cos(6*Math.PI/4),1,2.5*Math.sin(6*Math.PI/4)]}]},ECRadialMenu:e.EC_DEFAULT,ECWorldGui:{text2:"Level 6"}};e.archetypes.a_b_outpost_level_7={shouldPlayerSave:!0,parent:"a_b_outpost_level_6",ECMesh:{path:"environment/models/e_b_outpost_level07.dae"},ECHealth:{health:e.balanceBuildings.a_b_outpost_level_7.health},
ECPlacedBuildingTracker:{localCaps:[{buildingType:"Turret",quantity:8},{buildingType:"Trap",quantity:8},{buildingType:"Barricade",quantity:60},{buildingType:"Barricade Gate",quantity:12}]},ECBuilding:{buildTime:e.balanceBuildings.a_b_outpost_level_7.buildTime,resourceCost:e.balanceBuildings.a_b_outpost_level_7.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_outpost_level_7.secondaryResourceCost,canPlaceAnywhere:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Outpost",level:7,prerequisites:[{buildingType:"Defendling Hut",
level:7}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_outpost_level_7.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_outpost_level_7.maxResourceRepairCost},ECBuildingPlacementRadius:{buildingRadius:24,trapRadius:32},ECUpgradable:{upgradeName:"Level 8",upgradeArchetypeName:"a_b_outpost_level_8",upgradeInfo:"outpost"},ECSockets:{sockets:[{archetypeName:"a_b_turretworkshop_level_7",localOffset:[2.5*Math.cos(0*Math.PI/4),1,2.5*Math.sin(0*Math.PI/4)]},{archetypeName:"a_b_barricadeworkshop_level_7",
localOffset:[2.5*Math.cos(2*Math.PI/4),1,2.5*Math.sin(2*Math.PI/4)]},{archetypeName:"a_b_trapworkshop_level_7",localOffset:[2.5*Math.cos(4*Math.PI/4),1,2.5*Math.sin(4*Math.PI/4)]},{archetypeName:"a_b_outpostrepairer",localOffset:[2.5*Math.cos(6*Math.PI/4),1,2.5*Math.sin(6*Math.PI/4)]}]},ECRadialMenu:e.EC_DEFAULT,ECWorldGui:{text2:"Level 7"}};e.archetypes.a_b_outpost_level_8={shouldPlayerSave:!0,parent:"a_b_outpost_level_7",ECMesh:{path:"environment/models/e_b_outpost_level08.dae"},ECHealth:{health:e.balanceBuildings.a_b_outpost_level_8.health},
ECPlacedBuildingTracker:{localCaps:[{buildingType:"Turret",quantity:8},{buildingType:"Trap",quantity:10},{buildingType:"Barricade",quantity:60},{buildingType:"Barricade Gate",quantity:12}]},ECBuilding:{buildTime:e.balanceBuildings.a_b_outpost_level_8.buildTime,resourceCost:e.balanceBuildings.a_b_outpost_level_8.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_outpost_level_8.secondaryResourceCost,canPlaceAnywhere:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Outpost",level:8,prerequisites:[{buildingType:"Defendling Hut",
level:8}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_outpost_level_8.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_outpost_level_8.maxResourceRepairCost},ECBuildingPlacementRadius:{buildingRadius:24,trapRadius:32},ECUpgradable:{upgradeName:"Level 9",upgradeArchetypeName:"a_b_outpost_level_9",upgradeInfo:"outpost"},ECSockets:{sockets:[{archetypeName:"a_b_turretworkshop_level_8",localOffset:[2.5*Math.cos(0*Math.PI/4),1,2.5*Math.sin(0*Math.PI/4)]},{archetypeName:"a_b_barricadeworkshop_level_8",
localOffset:[2.5*Math.cos(2*Math.PI/4),1,2.5*Math.sin(2*Math.PI/4)]},{archetypeName:"a_b_trapworkshop_level_8",localOffset:[2.5*Math.cos(4*Math.PI/4),1,2.5*Math.sin(4*Math.PI/4)]},{archetypeName:"a_b_outpostrepairer",localOffset:[2.5*Math.cos(6*Math.PI/4),1,2.5*Math.sin(6*Math.PI/4)]}]},ECRadialMenu:e.EC_DEFAULT,ECWorldGui:{text2:"Level 8"}};e.archetypes.a_b_outpost_level_9={shouldPlayerSave:!0,parent:"a_b_outpost_level_8",ECMesh:{path:"environment/models/e_b_outpost_level09.dae"},ECHealth:{health:e.balanceBuildings.a_b_outpost_level_9.health},
ECPlacedBuildingTracker:{localCaps:[{buildingType:"Turret",quantity:8},{buildingType:"Trap",quantity:10},{buildingType:"Barricade",quantity:60},{buildingType:"Barricade Gate",quantity:12}]},ECBuilding:{buildTime:e.balanceBuildings.a_b_outpost_level_9.buildTime,resourceCost:e.balanceBuildings.a_b_outpost_level_9.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_outpost_level_9.secondaryResourceCost,canPlaceAnywhere:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Outpost",level:9,prerequisites:[{buildingType:"Defendling Hut",
level:9}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_outpost_level_9.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_outpost_level_9.maxResourceRepairCost},ECBuildingPlacementRadius:{buildingRadius:24,trapRadius:32},ECUpgradable:{upgradeName:"Level 10",upgradeArchetypeName:"a_b_outpost_level_10",upgradeInfo:"outpost"},ECSockets:{sockets:[{archetypeName:"a_b_turretworkshop_level_9",localOffset:[2.5*Math.cos(0*Math.PI/4),1,2.5*Math.sin(0*Math.PI/4)]},{archetypeName:"a_b_barricadeworkshop_level_9",
localOffset:[2.5*Math.cos(2*Math.PI/4),1,2.5*Math.sin(2*Math.PI/4)]},{archetypeName:"a_b_trapworkshop_level_9",localOffset:[2.5*Math.cos(4*Math.PI/4),1,2.5*Math.sin(4*Math.PI/4)]},{archetypeName:"a_b_outpostrepairer",localOffset:[2.5*Math.cos(6*Math.PI/4),1,2.5*Math.sin(6*Math.PI/4)]}]},ECRadialMenu:e.EC_DEFAULT,ECWorldGui:{text2:"Level 9"}};e.archetypes.a_b_outpost_level_10={shouldPlayerSave:!0,parent:"a_b_outpost_level_9",ECMesh:{path:"environment/models/e_b_outpost_level010.dae"},ECHealth:{health:e.balanceBuildings.a_b_outpost_level_10.health},
ECPlacedBuildingTracker:{localCaps:[{buildingType:"Turret",quantity:8},{buildingType:"Trap",quantity:12},{buildingType:"Barricade",quantity:60},{buildingType:"Barricade Gate",quantity:14}]},ECBuilding:{buildTime:e.balanceBuildings.a_b_outpost_level_10.buildTime,resourceCost:e.balanceBuildings.a_b_outpost_level_10.resourceCost,secondaryResourceCost:e.balanceBuildings.a_b_outpost_level_10.secondaryResourceCost,canPlaceAnywhere:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Outpost",level:10,prerequisites:[{buildingType:"Defendling Hut",
level:10}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_b_outpost_level_10.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_b_outpost_level_10.maxResourceRepairCost},ECBuildingPlacementRadius:{buildingRadius:24,trapRadius:32},ECUpgradable:e.EC_REMOVE,ECUpgrader:e.EC_REMOVE,ECSockets:{sockets:[{archetypeName:"a_b_turretworkshop_level_10",localOffset:[2.5*Math.cos(0*Math.PI/4),1,2.5*Math.sin(0*Math.PI/4)]},{archetypeName:"a_b_barricadeworkshop_level_10",localOffset:[2.5*
Math.cos(2*Math.PI/4),1,2.5*Math.sin(2*Math.PI/4)]},{archetypeName:"a_b_trapworkshop_level_10",localOffset:[2.5*Math.cos(4*Math.PI/4),1,2.5*Math.sin(4*Math.PI/4)]},{archetypeName:"a_b_outpostrepairer",localOffset:[2.5*Math.cos(6*Math.PI/4),1,2.5*Math.sin(6*Math.PI/4)]}]},ECRadialMenu:e.EC_DEFAULT,ECWorldGui:{text2:"Level 10"}};e.archetypes.a_b_outpostrepairer={shouldPlayerSave:!0,ECMesh:{scale:1.3*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/outpost_spanner.dae",localOffset:[0,0,0]},
ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:1,offsetY:0.2,path:"textures/glowfull.dds",additive:!0,color:[1,54/255,0,0.3]},ECSelectable:{hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECRepairer:{placedBuildings:!0,owner:!0,repairAllText:"GAME_HUD_REPAIR_ALL_OUTPOST",nothingToRepairText:"GAME_HUD_REPAIR_NOTHING_TO_DO_OUTPOST"},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_b_barricadeworkshop={shouldPlayerSave:!0,familyName:"barricadeworkshop",ECMesh:{scale:2*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/outpost_barricade.dae",
localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:1,offsetY:0.4,path:"textures/glowfull.dds",additive:!0,color:[1,54/255,0,0.3]},ECSelectable:{selectType:"selectTypeNormal",hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{showUnavailableDueToPrerequisites:!1,meshWhenCapReached:"environment/models/barricadeshell.dae",contents:[{dispenseName:"Wooden Gate",dispensedArchetypeName:"a_d_barricadegate",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Wooden Gate",dispensedArchetypeName:"a_d_barricadegate_level_2",
stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Wooden Gate",dispensedArchetypeName:"a_d_barricadegate_level_3",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Wooden Gate",dispensedArchetypeName:"a_d_barricadegate_level_4",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Wooden Gate",dispensedArchetypeName:"a_d_barricadegate_level_5",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Barricade",dispensedArchetypeName:"a_d_barricade",stackableInHand:!0,quantityPerPurchase:1},
{dispenseName:"Barricade",dispensedArchetypeName:"a_d_barricade_level_2",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Barricade",dispensedArchetypeName:"a_d_barricade_level_3",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Barricade",dispensedArchetypeName:"a_d_barricade_level_4",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Barricade",dispensedArchetypeName:"a_d_barricade_level_5",stackableInHand:!0,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT,ECWorldGui:{text1:"Barricades",
onScreenGuiArchetype:"tipIconBarricades",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_b_barricadeworkshop_level_2={shouldPlayerSave:!0,parent:"a_b_barricadeworkshop",ECDispenser:{showUnavailableDueToPrerequisites:!1,contents:[{dispenseName:"Wooden Gate",dispensedArchetypeName:"a_d_barricadegate",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Wooden Gate",dispensedArchetypeName:"a_d_barricadegate_level_2",stackableInHand:!0,quantityPerPurchase:1},
{dispenseName:"Wooden Gate",dispensedArchetypeName:"a_d_barricadegate_level_3",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Wooden Gate",dispensedArchetypeName:"a_d_barricadegate_level_4",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Wooden Gate",dispensedArchetypeName:"a_d_barricadegate_level_5",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Barricade",dispensedArchetypeName:"a_d_barricade",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Barricade",dispensedArchetypeName:"a_d_barricade_level_2",
stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Barricade",dispensedArchetypeName:"a_d_barricade_level_3",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Barricade",dispensedArchetypeName:"a_d_barricade_level_4",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Barricade",dispensedArchetypeName:"a_d_barricade_level_5",stackableInHand:!0,quantityPerPurchase:1}]}};e.archetypes.a_b_barricadeworkshop_level_3={shouldPlayerSave:!0,parent:"a_b_barricadeworkshop_level_2"};e.archetypes.a_b_barricadeworkshop_level_4=
{shouldPlayerSave:!0,parent:"a_b_barricadeworkshop_level_3"};e.archetypes.a_b_barricadeworkshop_level_5={shouldPlayerSave:!0,parent:"a_b_barricadeworkshop_level_4"};e.archetypes.a_b_barricadeworkshop_level_6={shouldPlayerSave:!0,parent:"a_b_barricadeworkshop_level_5"};e.archetypes.a_b_barricadeworkshop_level_7={shouldPlayerSave:!0,parent:"a_b_barricadeworkshop_level_6"};e.archetypes.a_b_barricadeworkshop_level_8={shouldPlayerSave:!0,parent:"a_b_barricadeworkshop_level_7"};e.archetypes.a_b_barricadeworkshop_level_9=
{shouldPlayerSave:!0,parent:"a_b_barricadeworkshop_level_8"};e.archetypes.a_b_barricadeworkshop_level_10={shouldPlayerSave:!0,parent:"a_b_barricadeworkshop_level_9"};e.archetypes.a_b_turretworkshop={shouldPlayerSave:!0,familyName:"turretworkshop",ECMesh:{scale:1.75*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/outpost_turrets.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:1,offsetY:0.4,path:"textures/glowfull.dds",additive:!0,color:[1,54/255,0,0.3]},ECSelectable:{selectType:"selectTypeNormal",
hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{showUnavailableDueToPrerequisites:!1,meshWhenCapReached:"environment/models/turretshell.dae",contents:[{dispenseName:"Gatling",dispensedArchetypeName:"a_d_turret_level_1",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Gatling",dispensedArchetypeName:"a_d_turret_level_2",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Gatling",dispensedArchetypeName:"a_d_turret_level_3",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Gatling",
dispensedArchetypeName:"a_d_turret_level_4",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Gatling",dispensedArchetypeName:"a_d_turret_level_5",stackableInHand:!0,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT,ECWorldGui:{text1:"Towers",onScreenGuiArchetype:"tipIconTowers",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_b_turretworkshop_level_2={shouldPlayerSave:!0,parent:"a_b_turretworkshop"};e.archetypes.a_b_turretworkshop_level_3=
{shouldPlayerSave:!0,parent:"a_b_turretworkshop_level_2",ECDispenser:{showUnavailableDueToPrerequisites:!1,contents:[{dispenseName:"Gatling",dispensedArchetypeName:"a_d_turret_level_1",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Gatling",dispensedArchetypeName:"a_d_turret_level_2",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Gatling",dispensedArchetypeName:"a_d_turret_level_3",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Gatling",dispensedArchetypeName:"a_d_turret_level_4",
stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Gatling",dispensedArchetypeName:"a_d_turret_level_5",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Mortarling",dispensedArchetypeName:"a_d_turret_mortar_level_1",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Mortarling",dispensedArchetypeName:"a_d_turret_mortar_level_2",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Mortarling",dispensedArchetypeName:"a_d_turret_mortar_level_3",stackableInHand:!0,quantityPerPurchase:1},
{dispenseName:"Mortarling",dispensedArchetypeName:"a_d_turret_mortar_level_4",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Mortarling",dispensedArchetypeName:"a_d_turret_mortar_level_5",stackableInHand:!0,quantityPerPurchase:1}]}};e.archetypes.a_b_turretworkshop_level_4={shouldPlayerSave:!0,parent:"a_b_turretworkshop_level_3"};e.archetypes.a_b_turretworkshop_level_5={shouldPlayerSave:!0,parent:"a_b_turretworkshop_level_4",ECDispenser:{showUnavailableDueToPrerequisites:!1,contents:[{dispenseName:"Gatling",
dispensedArchetypeName:"a_d_turret_level_1",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Gatling",dispensedArchetypeName:"a_d_turret_level_2",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Gatling",dispensedArchetypeName:"a_d_turret_level_3",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Gatling",dispensedArchetypeName:"a_d_turret_level_4",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Gatling",dispensedArchetypeName:"a_d_turret_level_5",stackableInHand:!0,
quantityPerPurchase:1},{dispenseName:"Mortarling",dispensedArchetypeName:"a_d_turret_mortar_level_1",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Mortarling",dispensedArchetypeName:"a_d_turret_mortar_level_2",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Mortarling",dispensedArchetypeName:"a_d_turret_mortar_level_3",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Mortarling",dispensedArchetypeName:"a_d_turret_mortar_level_4",stackableInHand:!0,quantityPerPurchase:1},
{dispenseName:"Mortarling",dispensedArchetypeName:"a_d_turret_mortar_level_5",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Stunling",dispensedArchetypeName:"a_d_turret_thumper_level_1",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Stunling",dispensedArchetypeName:"a_d_turret_thumper_level_2",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Stunling",dispensedArchetypeName:"a_d_turret_thumper_level_3",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Stunling",
dispensedArchetypeName:"a_d_turret_thumper_level_4",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Stunling",dispensedArchetypeName:"a_d_turret_thumper_level_5",stackableInHand:!0,quantityPerPurchase:1}]}};e.archetypes.a_b_turretworkshop_level_6={shouldPlayerSave:!0,parent:"a_b_turretworkshop_level_5"};e.archetypes.a_b_turretworkshop_level_7={shouldPlayerSave:!0,parent:"a_b_turretworkshop_level_6"};e.archetypes.a_b_turretworkshop_level_8={shouldPlayerSave:!0,parent:"a_b_turretworkshop_level_7"};
e.archetypes.a_b_turretworkshop_level_9={shouldPlayerSave:!0,parent:"a_b_turretworkshop_level_8"};e.archetypes.a_b_turretworkshop_level_10={shouldPlayerSave:!0,parent:"a_b_turretworkshop_level_9"};e.archetypes.a_b_trapworkshop={shouldPlayerSave:!0,familyName:"trapworkshop",ECMesh:{scale:2*WorkshopSettings.iconSize,offsetY:0,path:"environment/models/outpost_explosive.dae",localOffset:[0,0,0]},ECMeshAnimation:e.EC_DEFAULT,ECSprite:{size:1,offsetY:0.4,path:"textures/glowfull.dds",additive:!0,color:[1,
54/255,0,0.3]},ECSelectable:{selectType:"selectTypeNormal",hideMeshWhenInvalid:!0},ECInteractable:e.EC_DEFAULT,ECDispenser:{showUnavailableDueToPrerequisites:!1,meshWhenCapReached:"environment/models/explosiveshell.dae",contents:[{dispenseName:"Decoy",dispensedArchetypeName:"a_d_decoy",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Decoy",dispensedArchetypeName:"a_d_decoy_level_2",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Decoy",dispensedArchetypeName:"a_d_decoy_level_3",
stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Decoy",dispensedArchetypeName:"a_d_decoy_level_4",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Decoy",dispensedArchetypeName:"a_d_decoy_level_5",stackableInHand:!0,quantityPerPurchase:1}]},ECRadialMenu:e.EC_DEFAULT,ECWorldGui:{text1:"Traps",onScreenGuiArchetype:"tipIconTraps",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_b_trapworkshop_level_2={shouldPlayerSave:!0,parent:"a_b_trapworkshop"};
e.archetypes.a_b_trapworkshop_level_3={shouldPlayerSave:!0,parent:"a_b_trapworkshop_level_2",ECDispenser:{contents:[{dispenseName:"Decoy",dispensedArchetypeName:"a_d_decoy",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Decoy",dispensedArchetypeName:"a_d_decoy_level_2",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Decoy",dispensedArchetypeName:"a_d_decoy_level_3",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Decoy",dispensedArchetypeName:"a_d_decoy_level_4",stackableInHand:!0,
quantityPerPurchase:1},{dispenseName:"Decoy",dispensedArchetypeName:"a_d_decoy_level_5",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Explosive Barrel",dispensedArchetypeName:"a_d_barrel",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Explosive Barrel",dispensedArchetypeName:"a_d_barrel_level_2",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Explosive Barrel",dispensedArchetypeName:"a_d_barrel_level_3",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Explosive Barrel",
dispensedArchetypeName:"a_d_barrel_level_4",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Explosive Barrel",dispensedArchetypeName:"a_d_barrel_level_5",stackableInHand:!0,quantityPerPurchase:1}]}};e.archetypes.a_b_trapworkshop_level_4={shouldPlayerSave:!0,parent:"a_b_trapworkshop_level_3",ECDispenser:{contents:[{dispenseName:"Decoy",dispensedArchetypeName:"a_d_decoy",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Decoy",dispensedArchetypeName:"a_d_decoy_level_2",stackableInHand:!0,
quantityPerPurchase:1},{dispenseName:"Decoy",dispensedArchetypeName:"a_d_decoy_level_3",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Decoy",dispensedArchetypeName:"a_d_decoy_level_4",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Decoy",dispensedArchetypeName:"a_d_decoy_level_5",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Explosive Barrel",dispensedArchetypeName:"a_d_barrel",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Explosive Barrel",dispensedArchetypeName:"a_d_barrel_level_2",
stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Explosive Barrel",dispensedArchetypeName:"a_d_barrel_level_3",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Explosive Barrel",dispensedArchetypeName:"a_d_barrel_level_4",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Explosive Barrel",dispensedArchetypeName:"a_d_barrel_level_5",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Mine",dispensedArchetypeName:"a_d_mine",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Mine",
dispensedArchetypeName:"a_d_mine_level_2",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Mine",dispensedArchetypeName:"a_d_mine_level_3",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Mine",dispensedArchetypeName:"a_d_mine_level_4",stackableInHand:!0,quantityPerPurchase:1},{dispenseName:"Mine",dispensedArchetypeName:"a_d_mine_level_5",stackableInHand:!0,quantityPerPurchase:1}]}};e.archetypes.a_b_trapworkshop_level_5={shouldPlayerSave:!0,parent:"a_b_trapworkshop_level_4"};e.archetypes.a_b_trapworkshop_level_6=
{shouldPlayerSave:!0,parent:"a_b_trapworkshop_level_5"};e.archetypes.a_b_trapworkshop_level_7={shouldPlayerSave:!0,parent:"a_b_trapworkshop_level_6"};e.archetypes.a_b_trapworkshop_level_8={shouldPlayerSave:!0,parent:"a_b_trapworkshop_level_7"};e.archetypes.a_b_trapworkshop_level_9={shouldPlayerSave:!0,parent:"a_b_trapworkshop_level_8"};e.archetypes.a_b_trapworkshop_level_10={shouldPlayerSave:!0,parent:"a_b_trapworkshop_level_9"};e.archetypes.a_d_turret_tutorial={shouldPlayerSave:!0,familyName:"turret_tutorial",
parent:"a_d_turret_level_1",ECBuilding:{buildingType:"Turret Tutorial"},ECSelectable:e.EC_REMOVE,ECWorldGui:e.EC_REMOVE};e.archetypes.a_d_turret_level_1={shouldPlayerSave:!0,familyName:"Turret",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_towersniper.dae",offsetY:-0.5},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],offsetY:0.5,scaleMesh:!1,terrainType:"building"},ECHealth:{health:e.balanceTurrets.a_d_turret_level_1.health,drawInWorldBarIfDamagedRecently:!0},ECFaction:e.EC_DEFAULT,
ECSelectable:{selectType:"selectTypePrepare"},ECTarget:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECBuilding:{resourceCost:e.balanceTurrets.a_d_turret_level_1.resourceCost,secondaryResourceCost:0,buildTime:e.balanceTurrets.a_d_turret_level_1.buildTime,canSpeedUpWithSoftCurrency:!0,buildingType:"Turret",buildingName:"Gatling",obeysScaffoldCap:!1,mustPlaceNearCreator:!0,scaffoldType:"war",usesInfiniteBuildMode:!0,level:1,addedFootprintSize:1,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Turret Unlock",
level:2,minimumQuantity:0,maximumQuantity:1}]},ECSockets:{sockets:[{archetypeName:"a_d_turret_top_level_1",localOffset:[0,4,0]}]},ECAttackerLimit:{maxAttackers:1},ECRadialMenu:e.EC_DEFAULT,ECEffectSpawner:{onDeathEffect:"sfx_dth_building"},ECRepairable:{damagedEntityArchetype:"a_s_damaged_small",minResourceRepairCost:e.balanceTurrets.a_d_turret_level_1.minResourceRepairCost,maxResourceRepairCost:e.balanceTurrets.a_d_turret_level_1.maxResourceRepairCost,canBeDestroyed:!0},ECWorldGui:{text1:"Gatling",
text2:"Level 1",onScreenGuiArchetype:"tipGatling",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_d_turret_level_2={parent:"a_d_turret_level_1",shouldPlayerSave:!0,familyName:"Turret",ECMesh:{path:"environment/models/e_b_towersniper_level02.dae"},ECHealth:{health:e.balanceTurrets.a_d_turret_level_2.health},ECBuilding:{resourceCost:e.balanceTurrets.a_d_turret_level_2.resourceCost,buildTime:e.balanceTurrets.a_d_turret_level_2.buildTime,prerequisites:[{buildingType:"Defence Factory",
level:1},{buildingType:"Turret Unlock",level:2,minimumQuantity:1},{buildingType:"Turret Unlock",level:3,minimumQuantity:0,maximumQuantity:1}]},ECSockets:{sockets:[{archetypeName:"a_d_turret_top_level_2",localOffset:[0,4,0]}]},ECRepairable:{minResourceRepairCost:e.balanceTurrets.a_d_turret_level_2.minResourceRepairCost,maxResourceRepairCost:e.balanceTurrets.a_d_turret_level_2.maxResourceRepairCost},ECWorldGui:{text2:"Level 2"}};e.archetypes.a_d_turret_level_3={parent:"a_d_turret_level_2",shouldPlayerSave:!0,
familyName:"Turret",ECMesh:{path:"environment/models/e_b_towersniper_level03.dae"},ECHealth:{health:e.balanceTurrets.a_d_turret_level_3.health},ECBuilding:{resourceCost:e.balanceTurrets.a_d_turret_level_3.resourceCost,buildTime:e.balanceTurrets.a_d_turret_level_3.buildTime,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Turret Unlock",level:3,minimumQuantity:1},{buildingType:"Turret Unlock",level:4,minimumQuantity:0,maximumQuantity:1}]},ECSockets:{sockets:[{archetypeName:"a_d_turret_top_level_3",
localOffset:[0,4,0]}]},ECRepairable:{minResourceRepairCost:e.balanceTurrets.a_d_turret_level_3.minResourceRepairCost,maxResourceRepairCost:e.balanceTurrets.a_d_turret_level_3.maxResourceRepairCost},ECWorldGui:{text2:"Level 3"}};e.archetypes.a_d_turret_level_4={parent:"a_d_turret_level_3",shouldPlayerSave:!0,familyName:"Turret",ECMesh:{path:"environment/models/e_b_towersniper_level04.dae"},ECHealth:{health:e.balanceTurrets.a_d_turret_level_4.health},ECBuilding:{resourceCost:e.balanceTurrets.a_d_turret_level_4.resourceCost,
buildTime:e.balanceTurrets.a_d_turret_level_4.buildTime,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Turret Unlock",level:4,minimumQuantity:1},{buildingType:"Turret Unlock",level:5,minimumQuantity:0,maximumQuantity:1}]},ECSockets:{sockets:[{archetypeName:"a_d_turret_top_level_4",localOffset:[0,4,0]}]},ECRepairable:{minResourceRepairCost:e.balanceTurrets.a_d_turret_level_4.minResourceRepairCost,maxResourceRepairCost:e.balanceTurrets.a_d_turret_level_4.maxResourceRepairCost},
ECWorldGui:{text2:"Level 4"}};e.archetypes.a_d_turret_level_5={parent:"a_d_turret_level_4",shouldPlayerSave:!0,familyName:"Turret",ECMesh:{path:"environment/models/e_b_towersniper_level05.dae"},ECHealth:{health:e.balanceTurrets.a_d_turret_level_5.health},ECBuilding:{resourceCost:e.balanceTurrets.a_d_turret_level_5.resourceCost,buildTime:e.balanceTurrets.a_d_turret_level_5.buildTime,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Turret Unlock",level:5,minimumQuantity:1},{buildingType:"Turret Unlock",
level:6,minimumQuantity:0,maximumQuantity:1}]},ECSockets:{sockets:[{archetypeName:"a_d_turret_top_level_5",localOffset:[0,4,0]}]},ECRepairable:{minResourceRepairCost:e.balanceTurrets.a_d_turret_level_5.minResourceRepairCost,maxResourceRepairCost:e.balanceTurrets.a_d_turret_level_5.maxResourceRepairCost},ECWorldGui:{text2:"Level 5"}};e.archetypes.a_d_turret_top_level_1={shouldPlayerSave:!1,ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_towersniper_top.dae",localOffset:[0,-4,0]},ECOrientate:{angleLerpFactor:0.05},
ECFirearm:{shootOffset:[0,-2.7,0],drawWeaponRadius:!0,weapon:"wp_d_turret_gun01"},ECAgent:{growInitialize:!1,actions:[{name:"AIActionRangedAttack",clearTargetAfterAttack:!0,numberOfProjectiles:1,aimDuration:0},{name:"AIActionChooseRangedTarget",maxRange:15,ignorePathing:!0}]},ECFaction:e.EC_DEFAULT};e.archetypes.a_d_turret_top_level_2={parent:"a_d_turret_top_level_1",shouldPlayerSave:!1,ECMesh:{path:"environment/models/e_b_towersniper_top_level02.dae"},ECFirearm:{weapon:"wp_d_turret_gun02"}};e.archetypes.a_d_turret_top_level_3=
{parent:"a_d_turret_top_level_2",shouldPlayerSave:!1,ECMesh:{path:"environment/models/e_b_towersniper_top_level03.dae"},ECFirearm:{weapon:"wp_d_turret_gun03"}};e.archetypes.a_d_turret_top_level_4={parent:"a_d_turret_top_level_3",shouldPlayerSave:!1,ECMesh:{path:"environment/models/e_b_towersniper_top_level04.dae"},ECFirearm:{weapon:"wp_d_turret_gun04"}};e.archetypes.a_d_turret_top_level_5={parent:"a_d_turret_top_level_4",shouldPlayerSave:!1,ECMesh:{path:"environment/models/e_b_towersniper_top_level05.dae"},
ECFirearm:{weapon:"wp_d_turret_gun05"}};ba.archetypes.wp_d_turret_gun01={projectileType:"pj_d_turret_gun01",fireSound:"arrowshot",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:e.balanceTurrets.a_d_turret_level_1.reloadDuration,minRange:0,maxRange:15,clipSize:1,rechamberDuration:0,randomSpreadAngle:0};ba.archetypes.wp_d_turret_gun02={projectileType:"pj_d_turret_gun02",fireSound:"arrowshot",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",
reloadDuration:e.balanceTurrets.a_d_turret_level_2.reloadDuration,minRange:0,maxRange:15,clipSize:1,rechamberDuration:0,randomSpreadAngle:0};ba.archetypes.wp_d_turret_gun03={projectileType:"pj_d_turret_gun03",fireSound:"arrowshot",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:e.balanceTurrets.a_d_turret_level_3.reloadDuration,minRange:0,maxRange:15,clipSize:1,rechamberDuration:0,randomSpreadAngle:0};ba.archetypes.wp_d_turret_gun04={projectileType:"pj_d_turret_gun04",
fireSound:"arrowshot",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:e.balanceTurrets.a_d_turret_level_4.reloadDuration,minRange:0,maxRange:15,clipSize:1,rechamberDuration:0,randomSpreadAngle:0};ba.archetypes.wp_d_turret_gun05={projectileType:"pj_d_turret_gun05",fireSound:"arrowshot",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:e.balanceTurrets.a_d_turret_level_5.reloadDuration,minRange:0,maxRange:15,clipSize:1,
rechamberDuration:0,randomSpreadAngle:0};e.archetypes.pj_d_turret_gun01={shouldPlayerSave:!1,ECMesh:{path:"environment/models/e_b_towerbullet.dae",scale:0.4},ECProjectile:{speed:60,damageType:"dg_d_turret_gun01",hitSound:"dartHit",hurtSound:"dartHitFlesh",ignoresAllies:!0}};e.archetypes.pj_d_turret_gun02={parent:"pj_d_turret_gun01",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_d_turret_gun02"}};e.archetypes.pj_d_turret_gun03={parent:"pj_d_turret_gun02",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_d_turret_gun03"}};
e.archetypes.pj_d_turret_gun04={parent:"pj_d_turret_gun03",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_d_turret_gun04"}};e.archetypes.pj_d_turret_gun05={parent:"pj_d_turret_gun04",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_d_turret_gun05"}};A.archetypes.dg_d_turret_gun01=A.create("dg_d_turret_gun01",{radius:e.balanceTurrets.a_d_turret_level_1.radius,friendlyFire:0,damage:e.balanceTurrets.a_d_turret_level_1.damage,forceBack:e.balanceTurrets.a_d_turret_level_1.forceBack,forceLift:e.balanceTurrets.a_d_turret_level_1.forceLift,
forceRadial:e.balanceTurrets.a_d_turret_level_1.forceRadial,forceTangential:0});A.archetypes.dg_d_turret_gun02=A.create("dg_d_turret_gun02",{radius:e.balanceTurrets.a_d_turret_level_2.radius,friendlyFire:0,damage:e.balanceTurrets.a_d_turret_level_2.damage,forceBack:e.balanceTurrets.a_d_turret_level_2.forceBack,forceLift:e.balanceTurrets.a_d_turret_level_2.forceLift,forceRadial:e.balanceTurrets.a_d_turret_level_2.forceRadial,forceTangential:0});A.archetypes.dg_d_turret_gun03=A.create("dg_d_turret_gun03",
{radius:e.balanceTurrets.a_d_turret_level_3.radius,friendlyFire:0,damage:e.balanceTurrets.a_d_turret_level_3.damage,forceBack:e.balanceTurrets.a_d_turret_level_3.forceBack,forceLift:e.balanceTurrets.a_d_turret_level_3.forceLift,forceRadial:e.balanceTurrets.a_d_turret_level_3.forceRadial,forceTangential:0});A.archetypes.dg_d_turret_gun04=A.create("dg_d_turret_gun04",{radius:e.balanceTurrets.a_d_turret_level_4.radius,friendlyFire:0,damage:e.balanceTurrets.a_d_turret_level_4.damage,forceBack:e.balanceTurrets.a_d_turret_level_4.forceBack,
forceLift:e.balanceTurrets.a_d_turret_level_4.forceLift,forceRadial:e.balanceTurrets.a_d_turret_level_4.forceRadial,forceTangential:0});A.archetypes.dg_d_turret_gun05=A.create("dg_d_turret_gun05",{radius:e.balanceTurrets.a_d_turret_level_5.radius,friendlyFire:0,damage:e.balanceTurrets.a_d_turret_level_5.damage,forceBack:e.balanceTurrets.a_d_turret_level_5.forceBack,forceLift:e.balanceTurrets.a_d_turret_level_5.forceLift,forceRadial:e.balanceTurrets.a_d_turret_level_5.forceRadial,forceTangential:0});
e.archetypes.a_d_turret_mortar_level_1={shouldPlayerSave:!0,familyName:"Turret",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_towermortar.dae",offsetY:-0.5},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],offsetY:0.5,scaleMesh:!1,terrainType:"building"},ECHealth:{health:e.balanceTurrets.a_d_turret_mortar_level_1.health,drawInWorldBarIfDamagedRecently:!0},ECFaction:e.EC_DEFAULT,ECSelectable:{selectType:"selectTypePrepare"},ECTarget:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECBuilding:{resourceCost:e.balanceTurrets.a_d_turret_mortar_level_1.resourceCost,
secondaryResourceCost:0,buildTime:e.balanceTurrets.a_d_turret_mortar_level_1.buildTime,canSpeedUpWithSoftCurrency:!0,mustPlaceNearCreator:!0,buildingType:"Turret",buildingName:"Mortarling",obeysScaffoldCap:!1,scaffoldType:"war",usesInfiniteBuildMode:!0,level:1,addedFootprintSize:1,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Mortar Unlock",level:2,minimumQuantity:0,maximumQuantity:1}]},ECSockets:{sockets:[{archetypeName:"a_d_turret_mortar_top_level_1",localOffset:[0,1,0]}]},
ECAttackerLimit:{maxAttackers:1},ECRadialMenu:e.EC_DEFAULT,ECRepairable:{damagedEntityArchetype:"a_s_damaged_small",minResourceRepairCost:e.balanceTurrets.a_d_turret_mortar_level_1.minResourceRepairCost,maxResourceRepairCost:e.balanceTurrets.a_d_turret_mortar_level_1.maxResourceRepairCost,canBeDestroyed:!0},ECWorldGui:{text1:"Mortarling",text2:"Level 1",onScreenGuiArchetype:"tipMortarling",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_d_turret_mortar_level_2=
{parent:"a_d_turret_mortar_level_1",shouldPlayerSave:!0,familyName:"Turret",ECMesh:{path:"environment/models/e_b_towermortar_level02.dae"},ECHealth:{health:e.balanceTurrets.a_d_turret_mortar_level_2.health},ECBuilding:{resourceCost:e.balanceTurrets.a_d_turret_mortar_level_2.resourceCost,buildTime:e.balanceTurrets.a_d_turret_mortar_level_2.buildTime,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Mortar Unlock",level:2,minimumQuantity:1},{buildingType:"Mortar Unlock",level:3,
minimumQuantity:0,maximumQuantity:1}]},ECSockets:{sockets:[{archetypeName:"a_d_turret_mortar_top_level_2",localOffset:[0,1,0]}]},ECRepairable:{minResourceRepairCost:e.balanceTurrets.a_d_turret_mortar_level_2.minResourceRepairCost,maxResourceRepairCost:e.balanceTurrets.a_d_turret_mortar_level_2.maxResourceRepairCost},ECWorldGui:{text2:"Level 2"}};e.archetypes.a_d_turret_mortar_level_3={parent:"a_d_turret_mortar_level_2",shouldPlayerSave:!0,familyName:"Turret",ECMesh:{path:"environment/models/e_b_towermortar_level03.dae"},
ECHealth:{health:e.balanceTurrets.a_d_turret_mortar_level_3.health},ECBuilding:{resourceCost:e.balanceTurrets.a_d_turret_mortar_level_3.resourceCost,buildTime:e.balanceTurrets.a_d_turret_mortar_level_3.buildTime,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Mortar Unlock",level:3,minimumQuantity:1},{buildingType:"Mortar Unlock",level:4,minimumQuantity:0,maximumQuantity:1}]},ECSockets:{sockets:[{archetypeName:"a_d_turret_mortar_top_level_3",localOffset:[0,1,0]}]},ECRepairable:{minResourceRepairCost:e.balanceTurrets.a_d_turret_mortar_level_3.minResourceRepairCost,
maxResourceRepairCost:e.balanceTurrets.a_d_turret_mortar_level_3.maxResourceRepairCost},ECWorldGui:{text2:"Level 3"}};e.archetypes.a_d_turret_mortar_level_4={parent:"a_d_turret_mortar_level_3",shouldPlayerSave:!0,familyName:"Turret",ECMesh:{path:"environment/models/e_b_towermortar_level04.dae"},ECHealth:{health:e.balanceTurrets.a_d_turret_mortar_level_4.health},ECBuilding:{resourceCost:e.balanceTurrets.a_d_turret_mortar_level_4.resourceCost,buildTime:e.balanceTurrets.a_d_turret_mortar_level_4.buildTime,
prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Mortar Unlock",level:4,minimumQuantity:1},{buildingType:"Mortar Unlock",level:5,minimumQuantity:0,maximumQuantity:1}]},ECSockets:{sockets:[{archetypeName:"a_d_turret_mortar_top_level_4",localOffset:[0,1,0]}]},ECRepairable:{minResourceRepairCost:e.balanceTurrets.a_d_turret_mortar_level_4.minResourceRepairCost,maxResourceRepairCost:e.balanceTurrets.a_d_turret_mortar_level_4.maxResourceRepairCost},ECWorldGui:{text2:"Level 4"}};e.archetypes.a_d_turret_mortar_level_5=
{parent:"a_d_turret_mortar_level_4",shouldPlayerSave:!0,familyName:"Turret",ECMesh:{path:"environment/models/e_b_towermortar_level05.dae"},ECHealth:{health:e.balanceTurrets.a_d_turret_mortar_level_5.health},ECBuilding:{resourceCost:e.balanceTurrets.a_d_turret_mortar_level_5.resourceCost,buildTime:e.balanceTurrets.a_d_turret_mortar_level_5.buildTime,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Mortar Unlock",level:5,minimumQuantity:1},{buildingType:"Mortar Unlock",level:6,
minimumQuantity:0,maximumQuantity:1}]},ECSockets:{sockets:[{archetypeName:"a_d_turret_mortar_top_level_5",localOffset:[0,1,0]}]},ECRepairable:{minResourceRepairCost:e.balanceTurrets.a_d_turret_mortar_level_5.minResourceRepairCost,maxResourceRepairCost:e.balanceTurrets.a_d_turret_mortar_level_5.maxResourceRepairCost},ECWorldGui:{text2:"Level 5"}};e.archetypes.a_d_turret_mortar_top_level_1={shouldPlayerSave:!1,ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_towermortar_top.dae",localOffset:[0,
-1,0]},ECOrientate:{angleLerpFactor:0.05},ECFirearm:{drawWeaponRadius:!0,weapon:"wp_d_turret_mortar_gun01"},ECAgent:{growInitialize:!1,actions:[{name:"AIActionRangedAttack",clearTargetAfterAttack:!0,numberOfProjectiles:1,aimDuration:0,fireIfNotInRange:!0,leadTarget:!0},{name:"AIActionChooseRangedTarget",maxRange:15,minRange:0,ignorePathing:!0}]},ECFaction:e.EC_DEFAULT};e.archetypes.a_d_turret_mortar_top_level_2={parent:"a_d_turret_mortar_top_level_1",shouldPlayerSave:!1,ECMesh:{path:"environment/models/e_b_towermortar_top_level02.dae"},
ECFirearm:{weapon:"wp_d_turret_mortar_gun02"}};e.archetypes.a_d_turret_mortar_top_level_3={parent:"a_d_turret_mortar_top_level_2",shouldPlayerSave:!1,ECMesh:{path:"environment/models/e_b_towermortar_top_level03.dae"},ECFirearm:{weapon:"wp_d_turret_mortar_gun03"}};e.archetypes.a_d_turret_mortar_top_level_4={parent:"a_d_turret_mortar_top_level_3",shouldPlayerSave:!1,ECMesh:{path:"environment/models/e_b_towermortar_top_level04.dae"},ECFirearm:{weapon:"wp_d_turret_mortar_gun04"}};e.archetypes.a_d_turret_mortar_top_level_5=
{parent:"a_d_turret_mortar_top_level_4",shouldPlayerSave:!1,ECMesh:{path:"environment/models/e_b_towermortar_top_level05.dae"},ECFirearm:{weapon:"wp_d_turret_mortar_gun05"}};ba.archetypes.wp_d_turret_mortar_gun01={projectileType:"pj_d_mortar_gun01",fireSound:"mortar",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:e.balanceTurrets.a_d_turret_mortar_level_1.reloadDuration,minRange:5,maxRange:15,clipSize:1,rechamberDuration:0,randomSpreadAngle:0};ba.archetypes.wp_d_turret_mortar_gun02=
{projectileType:"pj_d_mortar_gun02",fireSound:"mortar",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:e.balanceTurrets.a_d_turret_mortar_level_2.reloadDuration,minRange:5,maxRange:15,clipSize:1,rechamberDuration:0,randomSpreadAngle:0};ba.archetypes.wp_d_turret_mortar_gun03={projectileType:"pj_d_mortar_gun03",fireSound:"mortar",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:e.balanceTurrets.a_d_turret_mortar_level_3.reloadDuration,
minRange:5,maxRange:15,clipSize:1,rechamberDuration:0,randomSpreadAngle:0};ba.archetypes.wp_d_turret_mortar_gun04={projectileType:"pj_d_mortar_gun04",fireSound:"mortar",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:e.balanceTurrets.a_d_turret_mortar_level_4.reloadDuration,minRange:5,maxRange:15,clipSize:1,rechamberDuration:0,randomSpreadAngle:0};ba.archetypes.wp_d_turret_mortar_gun05={projectileType:"pj_d_mortar_gun05",fireSound:"mortar",cockSound:"pistolcock",
reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:e.balanceTurrets.a_d_turret_mortar_level_5.reloadDuration,minRange:5,maxRange:15,clipSize:1,rechamberDuration:0,randomSpreadAngle:0};e.archetypes.pj_d_mortar_gun01={shouldPlayerSave:!1,ECMesh:{path:"environment/models/e_b_mortar_bullet.dae",scale:1},ECProjectile:{speed:13,usesGravity:!0,damageType:"dg_d_mortar_explode01",hitEffect:"sfx_explosion_dc",hurtEffect:"sfx_explosion",ignoresAllies:!0}};e.archetypes.pj_d_mortar_gun02={parent:"pj_d_mortar_gun01",
shouldPlayerSave:!1,ECProjectile:{damageType:"dg_d_mortar_explode02"}};e.archetypes.pj_d_mortar_gun03={parent:"pj_d_mortar_gun02",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_d_mortar_explode03"}};e.archetypes.pj_d_mortar_gun04={parent:"pj_d_mortar_gun03",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_d_mortar_explode04"}};e.archetypes.pj_d_mortar_gun05={parent:"pj_d_mortar_gun04",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_d_mortar_explode05"}};A.archetypes.dg_d_mortar_explode01=A.create("Mortar",
{radius:e.balanceTurrets.a_d_turret_mortar_level_1.radius,isExplosion:!0,friendlyFire:0,damage:e.balanceTurrets.a_d_turret_mortar_level_1.damage,buildingDamage:0,forceBack:e.balanceTurrets.a_d_turret_mortar_level_1.forceBack,forceLift:e.balanceTurrets.a_d_turret_mortar_level_1.forceLift,forceRadial:e.balanceTurrets.a_d_turret_mortar_level_1.forceRadial,forceTangential:0});A.archetypes.dg_d_mortar_explode02=A.create("Mortar",{radius:e.balanceTurrets.a_d_turret_mortar_level_2.radius,isExplosion:!0,
friendlyFire:0,damage:e.balanceTurrets.a_d_turret_mortar_level_2.damage,buildingDamage:0,forceBack:e.balanceTurrets.a_d_turret_mortar_level_2.forceBack,forceLift:e.balanceTurrets.a_d_turret_mortar_level_2.forceLift,forceRadial:e.balanceTurrets.a_d_turret_mortar_level_2.forceRadial,forceTangential:0});A.archetypes.dg_d_mortar_explode03=A.create("Mortar",{radius:e.balanceTurrets.a_d_turret_mortar_level_3.radius,isExplosion:!0,friendlyFire:0,damage:e.balanceTurrets.a_d_turret_mortar_level_3.damage,buildingDamage:0,
forceBack:e.balanceTurrets.a_d_turret_mortar_level_3.forceBack,forceLift:e.balanceTurrets.a_d_turret_mortar_level_3.forceLift,forceRadial:e.balanceTurrets.a_d_turret_mortar_level_3.forceRadial,forceTangential:0});A.archetypes.dg_d_mortar_explode04=A.create("Mortar",{radius:e.balanceTurrets.a_d_turret_mortar_level_4.radius,isExplosion:!0,friendlyFire:0,damage:e.balanceTurrets.a_d_turret_mortar_level_4.damage,buildingDamage:0,forceBack:e.balanceTurrets.a_d_turret_mortar_level_4.forceBack,forceLift:e.balanceTurrets.a_d_turret_mortar_level_4.forceLift,
forceRadial:e.balanceTurrets.a_d_turret_mortar_level_4.forceRadial,forceTangential:0});A.archetypes.dg_d_mortar_explode05=A.create("Mortar",{radius:e.balanceTurrets.a_d_turret_mortar_level_5.radius,isExplosion:!0,friendlyFire:0,damage:e.balanceTurrets.a_d_turret_mortar_level_5.damage,buildingDamage:0,forceBack:e.balanceTurrets.a_d_turret_mortar_level_5.forceBack,forceLift:e.balanceTurrets.a_d_turret_mortar_level_5.forceLift,forceRadial:e.balanceTurrets.a_d_turret_mortar_level_5.forceRadial,forceTangential:0});
e.archetypes.a_d_turret_thumper_level_1={shouldPlayerSave:!0,familyName:"defence",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,offsetY:-0.5,path:"environment/models/e_b_towerthumper.dae"},ECPhysicsCube:{stationary:!0,offsetY:0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECHealth:{health:e.balanceTurrets.a_d_turret_thumper_level_1.health,drawInWorldBarIfDamagedRecently:!0},ECSelectable:{selectType:"selectTypePrepare"},ECFaction:e.EC_DEFAULT,ECTarget:e.EC_DEFAULT,ECBuilding:{resourceCost:e.balanceTurrets.a_d_turret_thumper_level_1.resourceCost,
secondaryResourceCost:0,buildTime:e.balanceTurrets.a_d_turret_thumper_level_1.buildTime,canSpeedUpWithSoftCurrency:!0,mustPlaceNearCreator:!0,buildingType:"Turret",buildingName:"Stunling",obeysScaffoldCap:!1,scaffoldType:"war",usesInfiniteBuildMode:!0,level:1,addedFootprintSize:1,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Thumper Unlock",level:2,minimumQuantity:0,maximumQuantity:1}]},ECSockets:{sockets:[{archetypeName:"a_d_turret_thumper_top_level_1",localOffset:[0,4,0]}]},
ECRadialMenu:e.EC_DEFAULT,ECRepairable:{damagedEntityArchetype:"a_s_damaged_small",minResourceRepairCost:e.balanceTurrets.a_d_turret_thumper_level_1.minResourceRepairCost,maxResourceRepairCost:e.balanceTurrets.a_d_turret_thumper_level_1.maxResourceRepairCost,canBeDestroyed:!0},ECWorldGui:{text1:"Stunling",text2:"Level 1",onScreenGuiArchetype:"tipStunling",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_d_turret_thumper_level_2={parent:"a_d_turret_thumper_level_1",
shouldPlayerSave:!0,familyName:"defence",ECMesh:{path:"environment/models/e_b_towerthumper_level02.dae"},ECHealth:{health:e.balanceTurrets.a_d_turret_thumper_level_2.health},ECBuilding:{resourceCost:e.balanceTurrets.a_d_turret_thumper_level_2.resourceCost,buildTime:e.balanceTurrets.a_d_turret_thumper_level_2.buildTime,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Thumper Unlock",level:2,minimumQuantity:1},{buildingType:"Thumper Unlock",level:3,minimumQuantity:0,maximumQuantity:1}]},
ECSockets:{sockets:[{archetypeName:"a_d_turret_thumper_top_level_2",localOffset:[0,4,0]}]},ECRepairable:{minResourceRepairCost:e.balanceTurrets.a_d_turret_thumper_level_2.minResourceRepairCost,maxResourceRepairCost:e.balanceTurrets.a_d_turret_thumper_level_2.maxResourceRepairCost},ECWorldGui:{text2:"Level 2"}};e.archetypes.a_d_turret_thumper_level_3={parent:"a_d_turret_thumper_level_2",shouldPlayerSave:!0,familyName:"defence",ECMesh:{path:"environment/models/e_b_towerthumper_level03.dae"},ECHealth:{health:e.balanceTurrets.a_d_turret_thumper_level_3.health},
ECBuilding:{resourceCost:e.balanceTurrets.a_d_turret_thumper_level_3.resourceCost,buildTime:e.balanceTurrets.a_d_turret_thumper_level_3.buildTime,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Thumper Unlock",level:3,minimumQuantity:1},{buildingType:"Thumper Unlock",level:4,minimumQuantity:0,maximumQuantity:1}]},ECSockets:{sockets:[{archetypeName:"a_d_turret_thumper_top_level_3",localOffset:[0,4,0]}]},ECRepairable:{minResourceRepairCost:e.balanceTurrets.a_d_turret_thumper_level_3.minResourceRepairCost,
maxResourceRepairCost:e.balanceTurrets.a_d_turret_thumper_level_3.maxResourceRepairCost},ECWorldGui:{text2:"Level 3"}};e.archetypes.a_d_turret_thumper_level_4={parent:"a_d_turret_thumper_level_3",shouldPlayerSave:!0,familyName:"defence",ECMesh:{path:"environment/models/e_b_towerthumper_level04.dae"},ECHealth:{health:e.balanceTurrets.a_d_turret_thumper_level_4.health},ECBuilding:{resourceCost:e.balanceTurrets.a_d_turret_thumper_level_4.resourceCost,buildTime:e.balanceTurrets.a_d_turret_thumper_level_4.buildTime,
prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Thumper Unlock",level:4,minimumQuantity:1},{buildingType:"Thumper Unlock",level:5,minimumQuantity:0,maximumQuantity:1}]},ECSockets:{sockets:[{archetypeName:"a_d_turret_thumper_top_level_4",localOffset:[0,4,0]}]},ECRepairable:{minResourceRepairCost:e.balanceTurrets.a_d_turret_thumper_level_4.minResourceRepairCost,maxResourceRepairCost:e.balanceTurrets.a_d_turret_thumper_level_4.maxResourceRepairCost},ECWorldGui:{text2:"Level 4"}};
e.archetypes.a_d_turret_thumper_level_5={parent:"a_d_turret_thumper_level_4",shouldPlayerSave:!0,familyName:"defence",ECMesh:{path:"environment/models/e_b_towerthumper_level05.dae"},ECHealth:{health:e.balanceTurrets.a_d_turret_thumper_level_5.health},ECBuilding:{resourceCost:e.balanceTurrets.a_d_turret_thumper_level_5.resourceCost,buildTime:e.balanceTurrets.a_d_turret_thumper_level_5.buildTime,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Thumper Unlock",level:5,minimumQuantity:1},
{buildingType:"Thumper Unlock",level:6,minimumQuantity:0,maximumQuantity:1}]},ECSockets:{sockets:[{archetypeName:"a_d_turret_thumper_top_level_5",localOffset:[0,4,0]}]},ECRepairable:{minResourceRepairCost:e.balanceTurrets.a_d_turret_thumper_level_5.minResourceRepairCost,maxResourceRepairCost:e.balanceTurrets.a_d_turret_thumper_level_5.maxResourceRepairCost},ECWorldGui:{text2:"Level 5"}};e.archetypes.a_d_turret_thumper_top_level_1={shouldPlayerSave:!1,ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_towerthumper_top.dae",
localOffset:[0,-4,0]},ECOrientate:{angleLerpFactor:0.05},ECFirearm:{drawWeaponRadius:!0,weapon:"wp_d_turret_thumper_gun01",shootOffset:[0,-4,0]},ECAgent:{growInitialize:!1,actions:[{name:"AIActionRangedAttack",clearTargetAfterAttack:!0,numberOfProjectiles:1,aimDuration:0.2},{name:"AIActionChooseRangedTarget",maxRange:Math.max(e.balanceTurrets.a_d_turret_thumper_level_1.radius-2,1),minRange:0,ignorePathing:!0}]},ECFaction:e.EC_DEFAULT};e.archetypes.a_d_turret_thumper_top_level_2={parent:"a_d_turret_thumper_top_level_1",
shouldPlayerSave:!1,ECMesh:{path:"environment/models/e_b_towerthumper_top_level02.dae"},ECFirearm:{weapon:"wp_d_turret_thumper_gun02"},ECAgent:{actions:[{name:"AIActionRangedAttack",clearTargetAfterAttack:!0,numberOfProjectiles:1,aimDuration:0.2},{name:"AIActionChooseRangedTarget",maxRange:Math.max(e.balanceTurrets.a_d_turret_thumper_level_2.radius-2,1),minRange:0,ignorePathing:!0}]}};e.archetypes.a_d_turret_thumper_top_level_3={parent:"a_d_turret_thumper_top_level_2",shouldPlayerSave:!1,ECMesh:{path:"environment/models/e_b_towerthumper_top_level03.dae"},
ECFirearm:{weapon:"wp_d_turret_thumper_gun03"},ECAgent:{actions:[{name:"AIActionRangedAttack",clearTargetAfterAttack:!0,numberOfProjectiles:1,aimDuration:0.2},{name:"AIActionChooseRangedTarget",maxRange:Math.max(e.balanceTurrets.a_d_turret_thumper_level_3.radius-2,1),minRange:0,ignorePathing:!0}]}};e.archetypes.a_d_turret_thumper_top_level_4={parent:"a_d_turret_thumper_top_level_3",shouldPlayerSave:!1,ECMesh:{path:"environment/models/e_b_towerthumper_top_level04.dae"},ECFirearm:{weapon:"wp_d_turret_thumper_gun04"},
ECAgent:{actions:[{name:"AIActionRangedAttack",clearTargetAfterAttack:!0,numberOfProjectiles:1,aimDuration:0.2},{name:"AIActionChooseRangedTarget",maxRange:Math.max(e.balanceTurrets.a_d_turret_thumper_level_4.radius-2,1),minRange:0,ignorePathing:!0}]}};e.archetypes.a_d_turret_thumper_top_level_5={parent:"a_d_turret_thumper_top_level_4",shouldPlayerSave:!1,ECMesh:{path:"environment/models/e_b_towerthumper_top_level05.dae"},ECFirearm:{weapon:"wp_d_turret_thumper_gun05"},ECAgent:{actions:[{name:"AIActionRangedAttack",
clearTargetAfterAttack:!0,numberOfProjectiles:1,aimDuration:0.2},{name:"AIActionChooseRangedTarget",maxRange:Math.max(e.balanceTurrets.a_d_turret_thumper_level_5.radius-2,1),minRange:0,ignorePathing:!0}]}};ba.archetypes.wp_d_turret_thumper_gun01={projectileType:"pj_d_thumper_bullet01",fireSound:"horn",fireEffect:"thumper",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:e.balanceTurrets.a_d_turret_thumper_level_1.reloadDuration,minRange:0,maxRange:Math.max(e.balanceTurrets.a_d_turret_thumper_level_1.radius-
2,1),clipSize:1,rechamberDuration:0,randomSpreadAngle:0};ba.archetypes.wp_d_turret_thumper_gun02={projectileType:"pj_d_thumper_bullet02",fireSound:"horn",fireEffect:"thumper",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:e.balanceTurrets.a_d_turret_thumper_level_2.reloadDuration,minRange:0,maxRange:Math.max(e.balanceTurrets.a_d_turret_thumper_level_2.radius-2,1),clipSize:1,rechamberDuration:0,randomSpreadAngle:0};ba.archetypes.wp_d_turret_thumper_gun03=
{projectileType:"pj_d_thumper_bullet03",fireSound:"horn",fireEffect:"thumper",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:e.balanceTurrets.a_d_turret_thumper_level_3.reloadDuration,minRange:0,maxRange:Math.max(e.balanceTurrets.a_d_turret_thumper_level_3.radius-2,1),clipSize:1,rechamberDuration:0,randomSpreadAngle:0};ba.archetypes.wp_d_turret_thumper_gun04={projectileType:"pj_d_thumper_bullet04",fireSound:"horn",fireEffect:"thumper",cockSound:"pistolcock",
reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:e.balanceTurrets.a_d_turret_thumper_level_4.reloadDuration,minRange:0,maxRange:Math.max(e.balanceTurrets.a_d_turret_thumper_level_4.radius-2,1),clipSize:1,rechamberDuration:0,randomSpreadAngle:0};ba.archetypes.wp_d_turret_thumper_gun05={projectileType:"pj_d_thumper_bullet05",fireSound:"horn",fireEffect:"thumper",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:e.balanceTurrets.a_d_turret_thumper_level_5.reloadDuration,
minRange:0,maxRange:Math.max(e.balanceTurrets.a_d_turret_thumper_level_5.radius-2,1),clipSize:1,rechamberDuration:0,randomSpreadAngle:0};e.archetypes.pj_d_thumper_bullet01={shouldPlayerSave:!1,ECMesh:{path:"environment/models/e_b_towerbullet.dae",scale:0.8},ECProjectile:{explodeInstantly:!0,damageType:"dg_d_thump01",ignoresAllies:!0}};e.archetypes.pj_d_thumper_bullet02={parent:"pj_d_thumper_bullet01",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_d_thump02"}};e.archetypes.pj_d_thumper_bullet03=
{parent:"pj_d_thumper_bullet02",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_d_thump03"}};e.archetypes.pj_d_thumper_bullet04={parent:"pj_d_thumper_bullet03",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_d_thump04"}};e.archetypes.pj_d_thumper_bullet05={parent:"pj_d_thumper_bullet04",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_d_thump05"}};A.archetypes.dg_d_thump01=A.create("Thump",{radius:e.balanceTurrets.a_d_turret_thumper_level_1.radius,friendlyFire:1,damage:e.balanceTurrets.a_d_turret_thumper_level_1.damage,
buildingDamage:0,forceBack:e.balanceTurrets.a_d_turret_thumper_level_1.forceBack,forceLift:e.balanceTurrets.a_d_turret_thumper_level_1.forceLift,forceRadial:e.balanceTurrets.a_d_turret_thumper_level_1.forceRadial,forceTangential:0,stunDuration:e.balanceTurrets.a_d_turret_thumper_level_1.stunDuration,arcAngle:60});A.archetypes.dg_d_thump02=A.create("Thump",{radius:e.balanceTurrets.a_d_turret_thumper_level_2.radius,friendlyFire:1,damage:e.balanceTurrets.a_d_turret_thumper_level_2.damage,buildingDamage:0,
forceBack:e.balanceTurrets.a_d_turret_thumper_level_2.forceBack,forceLift:e.balanceTurrets.a_d_turret_thumper_level_2.forceLift,forceRadial:e.balanceTurrets.a_d_turret_thumper_level_2.forceRadial,forceTangential:0,stunDuration:e.balanceTurrets.a_d_turret_thumper_level_2.stunDuration,arcAngle:60});A.archetypes.dg_d_thump03=A.create("Thump",{radius:e.balanceTurrets.a_d_turret_thumper_level_3.radius,friendlyFire:1,damage:e.balanceTurrets.a_d_turret_thumper_level_3.damage,buildingDamage:0,forceBack:e.balanceTurrets.a_d_turret_thumper_level_3.forceBack,
forceLift:e.balanceTurrets.a_d_turret_thumper_level_3.forceLift,forceRadial:e.balanceTurrets.a_d_turret_thumper_level_3.forceRadial,forceTangential:0,stunDuration:e.balanceTurrets.a_d_turret_thumper_level_3.stunDuration,arcAngle:60});A.archetypes.dg_d_thump04=A.create("Thump",{radius:e.balanceTurrets.a_d_turret_thumper_level_4.radius,friendlyFire:1,damage:e.balanceTurrets.a_d_turret_thumper_level_4.damage,buildingDamage:0,forceBack:e.balanceTurrets.a_d_turret_thumper_level_4.forceBack,forceLift:e.balanceTurrets.a_d_turret_thumper_level_4.forceLift,
forceRadial:e.balanceTurrets.a_d_turret_thumper_level_4.forceRadial,forceTangential:0,stunDuration:e.balanceTurrets.a_d_turret_thumper_level_4.stunDuration,arcAngle:60});A.archetypes.dg_d_thump05=A.create("Thump",{radius:e.balanceTurrets.a_d_turret_thumper_level_5.radius,friendlyFire:1,damage:e.balanceTurrets.a_d_turret_thumper_level_5.damage,buildingDamage:0,forceBack:e.balanceTurrets.a_d_turret_thumper_level_5.forceBack,forceLift:e.balanceTurrets.a_d_turret_thumper_level_5.forceLift,forceRadial:e.balanceTurrets.a_d_turret_thumper_level_5.forceRadial,
forceTangential:0,stunDuration:e.balanceTurrets.a_d_turret_thumper_level_5.stunDuration,arcAngle:60});A.archetypes.dg_d_sniper_gun01=A.create("Sniper",{radius:e.balanceTurrets.a_d_turret_sniper.radius,friendlyFire:0,damage:e.balanceTurrets.a_d_turret_sniper.damage,forceBack:e.balanceTurrets.a_d_turret_sniper.forceBack,forceLift:e.balanceTurrets.a_d_turret_sniper.forceLift,forceRadial:e.balanceTurrets.a_d_turret_sniper.forceRadial,forceTangential:0});e.archetypes.pj_d_sniper_bullet01={ECMesh:{path:"environment/models/e_b_towerbullet.dae",
scale:0.8},ECProjectile:{speed:60,damageType:"dg_d_sniper_gun01",hitSound:"dartHit",hurtSound:"dartHitFlesh",ignoresAllies:!0}};ba.archetypes.wp_d_turret_sniper_gun01={projectileType:"pj_d_sniper_bullet01",fireSound:"pistolshot",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:0,minRange:15,maxRange:25,clipSize:100,rechamberDuration:3,randomSpreadAngle:0};e.archetypes.a_d_turret_sniper={shouldPlayerSave:!0,familyName:"Turret",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,
path:"environment/models/e_b_towersniper.dae",offsetY:-0.5},ECPhysicsCube:{stationary:!0,v3Scale:[1,1,1],offsetY:0.5,scaleMesh:!1,terrainType:"building"},ECHealth:{health:e.balanceTurrets.a_d_turret_sniper.health,drawInWorldBarIfDamagedRecently:!0},ECFaction:e.EC_DEFAULT,ECSelectable:{selectType:"selectTypePrepare"},ECTarget:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECBuilding:{resourceCost:e.balanceTurrets.a_d_turret_sniper.resourceCost,secondaryResourceCost:0,buildTime:e.balanceTurrets.a_d_turret_sniper.buildTime,
canSpeedUpWithSoftCurrency:!0,mustPlaceNearCreator:!0,buildingType:"Turret",obeysScaffoldCap:!1,scaffoldType:"war",usesInfiniteBuildMode:!0,level:1,addedFootprintSize:1,prerequisites:[{buildingType:"Defence Factory",level:1}]},ECSockets:{sockets:[{archetypeName:"a_d_turret_sniper_top",localOffset:[0,4,0]}]},ECAttackerLimit:{maxAttackers:1},ECRadialMenu:e.EC_DEFAULT,ECRepairable:{damagedEntityArchetype:"a_s_damaged_small",minResourceRepairCost:e.balanceTurrets.a_d_turret_sniper.repairCost,maxResourceRepairCost:e.balanceTurrets.a_d_turret_sniper.repairCost,
canBeDestroyed:!0}};e.archetypes.a_d_turret_sniper_top={shouldPlayerSave:!1,ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_towersniper_top.dae",localOffset:[0,-2.65,0]},ECOrientate:{angleLerpFactor:0.05},ECFirearm:{drawWeaponRadius:!0,weapon:"wp_d_turret_sniper_gun01"},ECAgent:{growInitialize:!1,actions:[{name:"AIActionRangedAttack",clearTargetAfterAttack:!0,numberOfProjectiles:1,aimDuration:1.5},{name:"AIActionChooseRangedTarget",maxRange:25,minRange:10,ignorePathing:!0}]},ECFaction:e.EC_DEFAULT};
e.archetypes.a_d_barricadegate_tutorial={shouldPlayerSave:!0,familyName:"barricadegate_tutorial",parent:"a_d_barricadegate_level_3",ECBuilding:{buildingType:"Barricade Gate Tutorial"},ECSelectable:e.EC_REMOVE,ECWorldGui:e.EC_REMOVE,ECRepairable:e.EC_REMOVE};e.archetypes.a_d_barricadegate={shouldPlayerSave:!0,familyName:"barricade gate",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_barricadegate.dae",offsetY:-0.5,numInstances:16},ECPhysicsCube:{stationary:!1,scaleMesh:!1,terrainType:"barricadeGate1"},
ECHealth:{health:e.balanceBarricades.a_d_barricadegate.health},ECFaction:e.EC_DEFAULT,ECSelectable:{smartRadiusFactor:0.3,selectType:"selectTypePrepare"},ECGate:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECBuilding:{resourceCost:e.balanceBarricades.a_d_barricadegate.resourceCost,secondaryResourceCost:0,autoRebuild:!1,buildTime:e.balanceBarricades.a_d_barricadegate.buildTime,rebuildTime:0,canSpeedUpWithSoftCurrency:!0,buildingType:"Barricade Gate",buildingName:"Wooden Gate",level:1,addedFootprintSize:0,
obeysScaffoldCap:!1,mustPlaceNearCreator:!0,scaffoldType:"war",usesInfiniteBuildMode:!0,stackable:!1,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Barricade Gate Unlock",level:2,minimumQuantity:0,maximumQuantity:1}],randomRotate:!0,maxLinePlacementLength:5},ECRepairable:{minResourceRepairCost:e.balanceBarricades.a_d_barricadegate.minResourceRepairCost,maxResourceRepairCost:e.balanceBarricades.a_d_barricadegate.maxResourceRepairCost,damagedEntityArchetype:null,canBeDestroyed:!0},
ECSockets:{sockets:[{archetypeName:"a_b_barricadegatebase_level_1",localOffset:[0,0,0]}]},ECRadialMenu:e.EC_DEFAULT,ECWorldGui:{text1:"Wooden Gate",text2:"Level 1",onScreenGuiArchetype:"tipWoodenGate",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_d_barricadegate_level_2={shouldPlayerSave:!0,parent:"a_d_barricadegate",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_barricadegate_level02.dae",offsetY:-0.5},ECPhysicsCube:{stationary:!1,
scaleMesh:!1,terrainType:"barricadeGate2"},ECHealth:{health:e.balanceBarricades.a_d_barricadegate_level_2.health},ECBuilding:{resourceCost:e.balanceBarricades.a_d_barricadegate_level_2.resourceCost,secondaryResourceCost:0,level:2,addedFootprintSize:0,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Barricade Gate Unlock",level:2,minimumQuantity:1},{buildingType:"Barricade Gate Unlock",level:3,minimumQuantity:0,maximumQuantity:1}]},ECRepairable:{minResourceRepairCost:e.balanceBarricades.a_d_barricadegate_level_2.minResourceRepairCost,
maxResourceRepairCost:e.balanceBarricades.a_d_barricadegate_level_2.maxResourceRepairCost},ECSockets:{sockets:[{archetypeName:"a_b_barricadegatebase_level_2",localOffset:[0,0,0]}]},ECWorldGui:{text2:"Level 2"}};e.archetypes.a_d_barricadegate_level_3={shouldPlayerSave:!0,parent:"a_d_barricadegate_level_2",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_barricadegate_level03.dae",offsetY:-0.5},ECPhysicsCube:{stationary:!1,scaleMesh:!1,terrainType:"barricadeGate3"},ECHealth:{health:e.balanceBarricades.a_d_barricadegate_level_3.health},
ECBuilding:{resourceCost:e.balanceBarricades.a_d_barricadegate_level_3.resourceCost,secondaryResourceCost:0,level:3,addedFootprintSize:0,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Barricade Gate Unlock",level:3,minimumQuantity:1},{buildingType:"Barricade Gate Unlock",level:4,minimumQuantity:0,maximumQuantity:1}]},ECRepairable:{minResourceRepairCost:e.balanceBarricades.a_d_barricadegate_level_3.minResourceRepairCost,maxResourceRepairCost:e.balanceBarricades.a_d_barricadegate_level_3.maxResourceRepairCost},
ECSockets:{sockets:[{archetypeName:"a_b_barricadegatebase_level_3",localOffset:[0,0,0]}]},ECWorldGui:{text2:"Level 3"}};e.archetypes.a_d_barricadegate_level_4={shouldPlayerSave:!0,parent:"a_d_barricadegate_level_3",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_barricadegate_level04.dae",offsetY:-0.5},ECPhysicsCube:{stationary:!1,scaleMesh:!1,terrainType:"barricadeGate4"},ECHealth:{health:e.balanceBarricades.a_d_barricadegate_level_4.health},ECBuilding:{resourceCost:e.balanceBarricades.a_d_barricadegate_level_4.resourceCost,
secondaryResourceCost:0,level:4,addedFootprintSize:0,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Barricade Gate Unlock",level:4,minimumQuantity:1},{buildingType:"Barricade Gate Unlock",level:5,minimumQuantity:0,maximumQuantity:1}]},ECRepairable:{minResourceRepairCost:e.balanceBarricades.a_d_barricadegate_level_4.minResourceRepairCost,maxResourceRepairCost:e.balanceBarricades.a_d_barricadegate_level_4.maxResourceRepairCost},ECSockets:{sockets:[{archetypeName:"a_b_barricadegatebase_level_4",
localOffset:[0,0,0]}]},ECWorldGui:{text2:"Level 4"}};e.archetypes.a_d_barricadegate_level_5={shouldPlayerSave:!0,parent:"a_d_barricadegate_level_4",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_barricadegate_level05.dae",offsetY:-0.5},ECPhysicsCube:{stationary:!1,scaleMesh:!1,terrainType:"barricadeGate5"},ECHealth:{health:e.balanceBarricades.a_d_barricadegate_level_5.health},ECBuilding:{resourceCost:e.balanceBarricades.a_d_barricadegate_level_5.resourceCost,secondaryResourceCost:0,
level:5,addedFootprintSize:0,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Barricade Gate Unlock",level:5,minimumQuantity:1},{buildingType:"Barricade Gate Unlock",level:6,minimumQuantity:0,maximumQuantity:1}]},ECRepairable:{minResourceRepairCost:e.balanceBarricades.a_d_barricadegate_level_5.minResourceRepairCost,maxResourceRepairCost:e.balanceBarricades.a_d_barricadegate_level_5.maxResourceRepairCost},ECSockets:{sockets:[{archetypeName:"a_b_barricadegatebase_level_5",localOffset:[0,
0,0]}]},ECWorldGui:{text2:"Level 5"}};e.archetypes.a_d_barricade_tutorial={shouldPlayerSave:!0,familyName:"barricade_tutorial",parent:"a_d_barricade_level_3",ECBuilding:{buildingType:"Barricade Tutorial"},ECSelectable:e.EC_REMOVE,ECWorldGui:e.EC_REMOVE,ECRepairable:e.EC_REMOVE};e.archetypes.a_d_barricade={shouldPlayerSave:!0,familyName:"barricade",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,offsetY:-0.5,path:"environment/models/e_b_barricade.dae",numInstances:32},ECHealth:{health:e.balanceBarricades.a_d_barricade.health,
shrinkMeshWhenLowHealth:!0},ECPhysicsCube:{stationary:!0,terrainType:"barricade1"},ECFaction:e.EC_DEFAULT,ECSelectable:{smartRadiusFactor:0.3,selectType:"selectTypePrepare"},ECInteractable:e.EC_DEFAULT,ECBuilding:{resourceCost:e.balanceBarricades.a_d_barricade.resourceCost,secondaryResourceCost:0,autoRebuild:!1,buildTime:e.balanceBarricades.a_d_barricade.buildTime,rebuildTime:0,canSpeedUpWithSoftCurrency:!0,buildingType:"Barricade",buildingName:"Barricade",level:1,addedFootprintSize:0,obeysScaffoldCap:!1,
mustPlaceNearCreator:!0,scaffoldType:"war",usesInfiniteBuildMode:!0,stackable:!1,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Barricade Unlock",level:2,minimumQuantity:0,maximumQuantity:1}],randomRotate:!0,maxLinePlacementLength:10},ECRepairable:{minResourceRepairCost:e.balanceBarricades.a_d_barricade.minResourceRepairCost,maxResourceRepairCost:e.balanceBarricades.a_d_barricade.maxResourceRepairCost,damagedEntityArchetype:null,canBeDestroyed:!0},ECWorldGui:{text1:"Barricade",
text2:"Level 1",onScreenGuiArchetype:"tipWoodenBarricade",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_d_barricade_level_2={shouldPlayerSave:!0,parent:"a_d_barricade",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,offsetY:-0.5,path:"environment/models/e_b_barricade_level02.dae"},ECPhysicsCube:{stationary:!0,terrainType:"barricade2"},ECHealth:{health:e.balanceBarricades.a_d_barricade_level_2.health,shrinkMeshWhenLowHealth:!0},
ECBuilding:{resourceCost:e.balanceBarricades.a_d_barricade_level_2.resourceCost,secondaryResourceCost:0,level:2,addedFootprintSize:0,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Barricade Unlock",level:2,minimumQuantity:1},{buildingType:"Barricade Unlock",level:3,minimumQuantity:0,maximumQuantity:1}]},ECRepairable:{minResourceRepairCost:e.balanceBarricades.a_d_barricade_level_2.minResourceRepairCost,maxResourceRepairCost:e.balanceBarricades.a_d_barricade_level_2.maxResourceRepairCost},
ECWorldGui:{text2:"Level 2"}};e.archetypes.a_d_barricade_level_3={shouldPlayerSave:!0,parent:"a_d_barricade_level_2",ECHealth:{health:e.balanceBarricades.a_d_barricade_level_3.health,shrinkMeshWhenLowHealth:!0},ECPhysicsCube:{stationary:!0,terrainType:"barricade3"},ECMesh:{scaleX:1,scaleY:1,scaleZ:1,offsetY:-0.5,path:"environment/models/e_b_barricade_level03.dae"},ECBuilding:{resourceCost:e.balanceBarricades.a_d_barricade_level_3.resourceCost,secondaryResourceCost:0,level:3,addedFootprintSize:0,prerequisites:[{buildingType:"Defence Factory",
level:1},{buildingType:"Barricade Unlock",level:3,minimumQuantity:1},{buildingType:"Barricade Unlock",level:4,minimumQuantity:0,maximumQuantity:1}]},ECRepairable:{minResourceRepairCost:e.balanceBarricades.a_d_barricade_level_3.minResourceRepairCost,maxResourceRepairCost:e.balanceBarricades.a_d_barricade_level_3.maxResourceRepairCost},ECWorldGui:{text2:"Level 3"}};e.archetypes.a_d_barricade_level_4={shouldPlayerSave:!0,parent:"a_d_barricade_level_3",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,offsetY:-0.5,
path:"environment/models/e_b_barricade_level04.dae"},ECPhysicsCube:{stationary:!0,terrainType:"barricade4"},ECHealth:{health:e.balanceBarricades.a_d_barricade_level_4.health,shrinkMeshWhenLowHealth:!0},ECBuilding:{resourceCost:e.balanceBarricades.a_d_barricade_level_4.resourceCost,secondaryResourceCost:0,level:4,addedFootprintSize:0,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Barricade Unlock",level:4,minimumQuantity:1},{buildingType:"Barricade Unlock",level:5,minimumQuantity:0,
maximumQuantity:1}]},ECRepairable:{minResourceRepairCost:e.balanceBarricades.a_d_barricade_level_4.minResourceRepairCost,maxResourceRepairCost:e.balanceBarricades.a_d_barricade_level_4.maxResourceRepairCost},ECWorldGui:{text2:"Level 4"}};e.archetypes.a_d_barricade_level_5={shouldPlayerSave:!0,parent:"a_d_barricade_level_4",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,offsetY:-0.5,path:"environment/models/e_b_barricade_level05.dae"},ECPhysicsCube:{stationary:!0,terrainType:"barricade5"},ECHealth:{health:e.balanceBarricades.a_d_barricade_level_5.health,
shrinkMeshWhenLowHealth:!0},ECBuilding:{resourceCost:e.balanceBarricades.a_d_barricade_level_5.resourceCost,secondaryResourceCost:0,level:5,addedFootprintSize:0,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Barricade Unlock",level:5,minimumQuantity:1},{buildingType:"Barricade Unlock",level:6,minimumQuantity:0,maximumQuantity:1}]},ECRepairable:{minResourceRepairCost:e.balanceBarricades.a_d_barricade_level_5.minResourceRepairCost,maxResourceRepairCost:e.balanceBarricades.a_d_barricade_level_5.maxResourceRepairCost},
ECWorldGui:{text2:"Level 5"}};e.archetypes.a_b_barricadegatebase_level_1={shouldPlayerSave:!1,ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_barricadegate_base.dae"}};e.archetypes.a_b_barricadegatebase_level_2={shouldPlayerSave:!1,ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_barricadegate_base_level02.dae"}};e.archetypes.a_b_barricadegatebase_level_3={shouldPlayerSave:!1,ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_barricadegate_base_level03.dae"}};
e.archetypes.a_b_barricadegatebase_level_4={shouldPlayerSave:!1,ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_barricadegate_base_level04.dae"}};e.archetypes.a_b_barricadegatebase_level_5={shouldPlayerSave:!1,ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_barricadegate_base_level05.dae"}};A.archetypes.dg_d_tower_gun01=A.create("dg_d_tower_gun01",{radius:1,friendlyFire:0,damage:20,forceBack:0.2,forceLift:0.2,forceRadial:0.2,forceTangential:0});A.archetypes.dg_d_tower_gun02=
A.create("dg_d_tower_gun02",{radius:1,friendlyFire:0,damage:25,forceBack:0.2,forceLift:0.2,forceRadial:0.2,forceTangential:0});A.archetypes.dg_d_tower_gun03=A.create("dg_d_tower_gun03",{radius:1,friendlyFire:0,damage:30,forceBack:0.2,forceLift:0.2,forceRadial:0.2,forceTangential:0});A.archetypes.dg_d_tower_gun04=A.create("dg_d_tower_gun04",{radius:1,friendlyFire:0,damage:35,forceBack:0.2,forceLift:0.2,forceRadial:0.2,forceTangential:0});A.archetypes.dg_d_tower_gun05=A.create("dg_d_tower_gun05",{radius:1,
friendlyFire:0,damage:40,forceBack:0.2,forceLift:0.2,forceRadial:0.2,forceTangential:0});A.archetypes.dg_d_tower_gun06=A.create("dg_d_tower_gun06",{radius:1,friendlyFire:0,damage:50,forceBack:0.2,forceLift:0.2,forceRadial:0.2,forceTangential:0});A.archetypes.dg_d_tower_gun07=A.create("dg_d_tower_gun07",{radius:1,friendlyFire:0,damage:60,forceBack:0.2,forceLift:0.2,forceRadial:0.2,forceTangential:0});A.archetypes.dg_d_tower_gun08=A.create("dg_d_tower_gun08",{radius:1,friendlyFire:0,damage:70,forceBack:0.2,
forceLift:0.2,forceRadial:0.2,forceTangential:0});A.archetypes.dg_d_tower_gun09=A.create("dg_d_tower_gun09",{radius:1,friendlyFire:0,damage:80,forceBack:0.2,forceLift:0.2,forceRadial:0.2,forceTangential:0});A.archetypes.dg_d_tower_gun10=A.create("dg_d_tower_gun10",{radius:1,friendlyFire:0,damage:90,forceBack:0.2,forceLift:0.2,forceRadial:0.2,forceTangential:0});e.archetypes.pj_d_tower_gun01={ECMesh:{path:"environment/models/e_b_towerbullet.dae",scale:1},ECProjectile:{speed:60,damageType:"dg_d_tower_gun01",
hitSound:"dartHit",hurtSound:"dartHitFlesh",ignoresAllies:!0}};e.archetypes.pj_d_tower_gun02={ECMesh:{path:"environment/models/e_b_towerbullet.dae",scale:1},ECProjectile:{speed:60,damageType:"dg_d_tower_gun02",hitSound:"dartHit",hurtSound:"dartHitFlesh",ignoresAllies:!0}};e.archetypes.pj_d_tower_gun03={ECMesh:{path:"environment/models/e_b_towerbullet.dae",scale:1},ECProjectile:{speed:60,damageType:"dg_d_tower_gun03",hitSound:"dartHit",hurtSound:"dartHitFlesh",ignoresAllies:!0}};e.archetypes.pj_d_tower_gun04=
{ECMesh:{path:"environment/models/e_b_towerbullet.dae",scale:1},ECProjectile:{speed:60,damageType:"dg_d_tower_gun04",hitSound:"dartHit",hurtSound:"dartHitFlesh",ignoresAllies:!0}};e.archetypes.pj_d_tower_gun05={ECMesh:{path:"environment/models/e_b_towerbullet.dae",scale:1},ECProjectile:{speed:60,damageType:"dg_d_tower_gun05",hitSound:"dartHit",hurtSound:"dartHitFlesh",ignoresAllies:!0}};e.archetypes.pj_d_tower_gun06={ECMesh:{path:"environment/models/e_b_towerbullet.dae",scale:1},ECProjectile:{speed:60,
damageType:"dg_d_tower_gun06",hitSound:"dartHit",hurtSound:"dartHitFlesh",ignoresAllies:!0}};e.archetypes.pj_d_tower_gun07={ECMesh:{path:"environment/models/e_b_towerbullet.dae",scale:1},ECProjectile:{speed:60,damageType:"dg_d_tower_gun07",hitSound:"dartHit",hurtSound:"dartHitFlesh",ignoresAllies:!0}};e.archetypes.pj_d_tower_gun08={ECMesh:{path:"environment/models/e_b_towerbullet.dae",scale:1},ECProjectile:{speed:60,damageType:"dg_d_tower_gun08",hitSound:"dartHit",hurtSound:"dartHitFlesh",ignoresAllies:!0}};
e.archetypes.pj_d_tower_gun09={ECMesh:{path:"environment/models/e_b_towerbullet.dae",scale:1},ECProjectile:{speed:60,damageType:"dg_d_tower_gun09",hitSound:"dartHit",hurtSound:"dartHitFlesh",ignoresAllies:!0}};e.archetypes.pj_d_tower_gun10={ECMesh:{path:"environment/models/e_b_towerbullet.dae",scale:1},ECProjectile:{speed:60,damageType:"dg_d_tower_gun10",hitSound:"dartHit",hurtSound:"dartHitFlesh",ignoresAllies:!0}};ba.archetypes.wp_d_tower_gun01={projectileType:"pj_d_tower_gun01",fireSound:"pistolshot",
cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:1,minRange:0,maxRange:15,clipSize:1,rechamberDuration:0,randomSpreadAngle:1};ba.archetypes.wp_d_tower_gun02={projectileType:"pj_d_tower_gun02",fireSound:"pistolshot",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:1,minRange:0,maxRange:15,clipSize:1,rechamberDuration:0,randomSpreadAngle:1};ba.archetypes.wp_d_tower_gun03={projectileType:"pj_d_tower_gun03",fireSound:"pistolshot",
cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:1,minRange:0,maxRange:15,clipSize:1,rechamberDuration:0,randomSpreadAngle:1};ba.archetypes.wp_d_tower_gun04={projectileType:"pj_d_tower_gun04",fireSound:"pistolshot",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:1,minRange:0,maxRange:15,clipSize:1,rechamberDuration:0,randomSpreadAngle:1};ba.archetypes.wp_d_tower_gun05={projectileType:"pj_d_tower_gun05",fireSound:"pistolshot",
cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:1,minRange:0,maxRange:15,clipSize:1,rechamberDuration:0,randomSpreadAngle:1};ba.archetypes.wp_d_tower_gun06={projectileType:"pj_d_tower_gun06",fireSound:"pistolshot",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:1,minRange:0,maxRange:15,clipSize:1,rechamberDuration:0,randomSpreadAngle:1};ba.archetypes.wp_d_tower_gun07={projectileType:"pj_d_tower_gun07",fireSound:"pistolshot",
cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:1,minRange:0,maxRange:15,clipSize:1,rechamberDuration:0,randomSpreadAngle:1};ba.archetypes.wp_d_tower_gun08={projectileType:"pj_d_tower_gun08",fireSound:"pistolshot",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:1,minRange:0,maxRange:15,clipSize:1,rechamberDuration:0,randomSpreadAngle:1};ba.archetypes.wp_d_tower_gun09={projectileType:"pj_d_tower_gun09",fireSound:"pistolshot",
cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:1,minRange:0,maxRange:15,clipSize:1,rechamberDuration:0,randomSpreadAngle:1};ba.archetypes.wp_d_tower_gun10={projectileType:"pj_d_tower_gun10",fireSound:"pistolshot",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:1,minRange:0,maxRange:15,clipSize:1,rechamberDuration:0,randomSpreadAngle:1};e.archetypes.a_d_tower={shouldPlayerSave:!0,familyName:"tower",ECMesh:{scale:1,
path:"environment/models/e_b_tower_level_1.dae",offsetY:-0.5},ECPhysicsCube:{stationary:!0,v3Scale:[1,2,1],offsetY:0.5,scaleMesh:!1,terrainType:"building"},ECHealth:{health:e.balanceBuildings.a_d_tower.health,drawInWorldBarIfDamagedRecently:!0,drawOffScreenIconIfDamagedRecently:!0},ECFaction:e.EC_DEFAULT,ECSelectable:{selectType:"selectTypeNormal"},ECInteractable:e.EC_DEFAULT,ECUpgradable:{upgradeName:"Level 2",upgradeArchetypeName:"a_d_tower_level_2",upgradeInfo:"tower"},ECUpgrader:e.EC_DEFAULT,
ECBuilding:{buildTime:e.balanceBuildings.a_d_tower.buildTime,resourceCost:e.balanceBuildings.a_d_tower.resourceCost,secondaryResourceCost:e.balanceBuildings.a_d_tower.secondaryResourceCost,autoRebuild:!0,canSpeedUpWithSoftCurrency:!0,buildingType:"Tower",buildingName:"Stone Tower",obeysScaffoldCap:!0,level:1,addedFootprintSize:0,prerequisites:[{buildingType:"HQ",level:1}],defenceLevel:0},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_tower.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_tower.maxResourceRepairCost},
ECSockets:{sockets:[{archetypeName:"a_d_tower_top",localOffset:[0,3,0]}]},ECRadialMenu:e.EC_DEFAULT,ECWorldGui:{text1:"Stone Tower",text2:"Level 1",onScreenGuiArchetype:"tipStoneTower",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_d_tower_level_2={shouldPlayerSave:!0,parent:"a_d_tower",ECMesh:{scale:1,path:"environment/models/e_b_tower_level_2.dae",offsetY:-0.5},ECHealth:{health:e.balanceBuildings.a_d_tower_level_2.health},ECUpgradable:{upgradeName:"Level 3",
upgradeArchetypeName:"a_d_tower_level_3",upgradeInfo:"tower"},ECBuilding:{buildTime:e.balanceBuildings.a_d_tower_level_2.buildTime,resourceCost:e.balanceBuildings.a_d_tower_level_2.resourceCost,secondaryResourceCost:e.balanceBuildings.a_d_tower_level_2.secondaryResourceCost,level:2,prerequisites:[{buildingType:"HQ",level:2}],defenceLevel:0},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_tower_level_2.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_tower_level_2.maxResourceRepairCost},
ECSockets:{sockets:[{archetypeName:"a_d_tower_top_level_2",localOffset:[0,3,0]}]},ECWorldGui:{text2:"Level 2"}};e.archetypes.a_d_tower_level_3={shouldPlayerSave:!0,parent:"a_d_tower_level_2",ECMesh:{scale:1,path:"environment/models/e_b_tower_level_3.dae",offsetY:-0.5},ECHealth:{health:e.balanceBuildings.a_d_tower_level_3.health},ECUpgradable:{upgradeName:"Level 4",upgradeArchetypeName:"a_d_tower_level_4",upgradeInfo:"tower"},ECBuilding:{buildTime:e.balanceBuildings.a_d_tower_level_3.buildTime,resourceCost:e.balanceBuildings.a_d_tower_level_3.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_d_tower_level_3.secondaryResourceCost,level:3,prerequisites:[{buildingType:"HQ",level:3}],defenceLevel:0},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_tower_level_3.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_tower_level_3.maxResourceRepairCost},ECSockets:{sockets:[{archetypeName:"a_d_tower_top_level_3",localOffset:[0,3,0]}]},ECWorldGui:{text2:"Level 3"}};e.archetypes.a_d_tower_level_4={shouldPlayerSave:!0,parent:"a_d_tower_level_3",
ECMesh:{scale:1,path:"environment/models/e_b_tower_level_4.dae",offsetY:-0.5},ECHealth:{health:e.balanceBuildings.a_d_tower_level_4.health},ECUpgradable:{upgradeName:"Level 5",upgradeArchetypeName:"a_d_tower_level_5",upgradeInfo:"tower"},ECBuilding:{buildTime:e.balanceBuildings.a_d_tower_level_4.buildTime,resourceCost:e.balanceBuildings.a_d_tower_level_4.resourceCost,secondaryResourceCost:e.balanceBuildings.a_d_tower_level_4.secondaryResourceCost,level:4,prerequisites:[{buildingType:"HQ",level:4}],
defenceLevel:0},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_tower_level_4.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_tower_level_4.maxResourceRepairCost},ECSockets:{sockets:[{archetypeName:"a_d_tower_top_level_4",localOffset:[0,3,0]}]},ECWorldGui:{text2:"Level 4"}};e.archetypes.a_d_tower_level_5={shouldPlayerSave:!0,parent:"a_d_tower_level_4",ECMesh:{scale:1,path:"environment/models/e_b_tower_level_5.dae",offsetY:-0.5},ECHealth:{health:e.balanceBuildings.a_d_tower_level_5.health},
ECBuilding:{buildTime:e.balanceBuildings.a_d_tower_level_5.buildTime,resourceCost:e.balanceBuildings.a_d_tower_level_5.resourceCost,secondaryResourceCost:e.balanceBuildings.a_d_tower_level_5.secondaryResourceCost,level:5,prerequisites:[{buildingType:"HQ",level:5}],defenceLevel:0},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_tower_level_5.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_tower_level_5.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 6",upgradeArchetypeName:"a_d_tower_level_6",
upgradeInfo:"tower"},ECSockets:{sockets:[{archetypeName:"a_d_tower_top_level_5",localOffset:[0,3,0]}]},ECWorldGui:{text2:"Level 5"}};e.archetypes.a_d_tower_level_6={shouldPlayerSave:!0,parent:"a_d_tower_level_5",ECMesh:{scale:1,path:"environment/models/e_b_tower_level_6.dae",offsetY:-0.5},ECHealth:{health:e.balanceBuildings.a_d_tower_level_6.health},ECBuilding:{buildTime:e.balanceBuildings.a_d_tower_level_6.buildTime,resourceCost:e.balanceBuildings.a_d_tower_level_6.resourceCost,secondaryResourceCost:e.balanceBuildings.a_d_tower_level_6.secondaryResourceCost,
level:6,prerequisites:[{buildingType:"HQ",level:6}],defenceLevel:0},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_tower_level_6.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_tower_level_6.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 7",upgradeArchetypeName:"a_d_tower_level_7",upgradeInfo:"tower"},ECSockets:{sockets:[{archetypeName:"a_d_tower_top_level_6",localOffset:[0,3,0]}]},ECWorldGui:{text2:"Level 6"}};e.archetypes.a_d_tower_level_7={shouldPlayerSave:!0,
parent:"a_d_tower_level_6",ECMesh:{scale:1,path:"environment/models/e_b_tower_level_7.dae",offsetY:-0.5},ECHealth:{health:e.balanceBuildings.a_d_tower_level_7.health},ECBuilding:{buildTime:e.balanceBuildings.a_d_tower_level_7.buildTime,resourceCost:e.balanceBuildings.a_d_tower_level_7.resourceCost,secondaryResourceCost:e.balanceBuildings.a_d_tower_level_7.secondaryResourceCost,level:7,prerequisites:[{buildingType:"HQ",level:7}],defenceLevel:0},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_tower_level_7.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_d_tower_level_7.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 8",upgradeArchetypeName:"a_d_tower_level_8",upgradeInfo:"tower"},ECSockets:{sockets:[{archetypeName:"a_d_tower_top_level_7",localOffset:[0,3,0]}]},ECWorldGui:{text2:"Level 7"}};e.archetypes.a_d_tower_level_8={shouldPlayerSave:!0,parent:"a_d_tower_level_7",ECMesh:{scale:1,path:"environment/models/e_b_tower_level_8.dae",offsetY:-0.5},ECHealth:{health:e.balanceBuildings.a_d_tower_level_8.health},
ECBuilding:{buildTime:e.balanceBuildings.a_d_tower_level_8.buildTime,resourceCost:e.balanceBuildings.a_d_tower_level_8.resourceCost,secondaryResourceCost:e.balanceBuildings.a_d_tower_level_8.secondaryResourceCost,level:8,prerequisites:[{buildingType:"HQ",level:8}],defenceLevel:0},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_tower_level_8.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_tower_level_8.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 9",upgradeArchetypeName:"a_d_tower_level_9",
upgradeInfo:"tower"},ECSockets:{sockets:[{archetypeName:"a_d_tower_top_level_8",localOffset:[0,3,0]}]},ECWorldGui:{text2:"Level 8"}};e.archetypes.a_d_tower_level_9={shouldPlayerSave:!0,parent:"a_d_tower_level_8",ECMesh:{scale:1,path:"environment/models/e_b_tower_level_9.dae",offsetY:-0.5},ECHealth:{health:e.balanceBuildings.a_d_tower_level_9.health},ECBuilding:{buildTime:e.balanceBuildings.a_d_tower_level_9.buildTime,resourceCost:e.balanceBuildings.a_d_tower_level_9.resourceCost,secondaryResourceCost:e.balanceBuildings.a_d_tower_level_9.secondaryResourceCost,
level:9,prerequisites:[{buildingType:"HQ",level:9}],defenceLevel:0},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_tower_level_9.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_tower_level_9.maxResourceRepairCost},ECUpgradable:{upgradeName:"Level 10",upgradeArchetypeName:"a_d_tower_level_10",upgradeInfo:"tower"},ECSockets:{sockets:[{archetypeName:"a_d_tower_top_level_9",localOffset:[0,3,0]}]},ECWorldGui:{text2:"Level 9"}};e.archetypes.a_d_tower_level_10={shouldPlayerSave:!0,
parent:"a_d_tower_level_9",ECMesh:{scale:1,path:"environment/models/e_b_tower_level_10.dae",offsetY:-0.5},ECHealth:{health:e.balanceBuildings.a_d_tower_level_10.health},ECBuilding:{buildTime:e.balanceBuildings.a_d_tower_level_10.buildTime,resourceCost:e.balanceBuildings.a_d_tower_level_10.resourceCost,secondaryResourceCost:e.balanceBuildings.a_d_tower_level_10.secondaryResourceCost,level:10,prerequisites:[{buildingType:"HQ",level:10}],defenceLevel:0},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_tower_level_10.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_d_tower_level_10.maxResourceRepairCost},ECUpgradable:e.EC_REMOVE,ECUpgrader:e.EC_REMOVE,ECSockets:{sockets:[{archetypeName:"a_d_tower_top_level_10",localOffset:[0,3,0]}]},ECWorldGui:{text2:"Level 10"}};e.archetypes.a_d_tower_top={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_towertop_level_1.dae",localOffset:[0,-3,0]},ECOrientate:{angleLerpFactor:0.05},ECFirearm:{shootOffset:[0,-0.7,-0.2],drawWeaponRadius:!0,weapon:"wp_d_tower_gun01"},
ECAgent:{growInitialize:!1,actions:[{name:"AIActionRangedAttack",clearTargetAfterAttack:!0,numberOfProjectiles:1,aimDuration:0.1},{name:"AIActionChooseRangedTarget",maxRange:15,ignorePathing:!0}]},ECFaction:e.EC_DEFAULT};e.archetypes.a_d_tower_top_level_2={shouldPlayerSave:!1,parent:"a_d_tower_top",ECMesh:{path:"environment/models/e_b_towertop_level_2.dae"},ECFirearm:{weapon:"wp_d_tower_gun02"}};e.archetypes.a_d_tower_top_level_3={shouldPlayerSave:!1,parent:"a_d_tower_top_level_2",ECMesh:{path:"environment/models/e_b_towertop_level_3.dae"},
ECFirearm:{weapon:"wp_d_tower_gun03"}};e.archetypes.a_d_tower_top_level_4={shouldPlayerSave:!1,parent:"a_d_tower_top_level_3",ECMesh:{path:"environment/models/e_b_towertop_level_4.dae"},ECFirearm:{weapon:"wp_d_tower_gun04"}};e.archetypes.a_d_tower_top_level_5={shouldPlayerSave:!1,parent:"a_d_tower_top_level_4",ECMesh:{path:"environment/models/e_b_towertop_level_5.dae"},ECFirearm:{weapon:"wp_d_tower_gun05"}};e.archetypes.a_d_tower_top_level_6={shouldPlayerSave:!1,parent:"a_d_tower_top_level_5",ECMesh:{path:"environment/models/e_b_towertop_level_6.dae"},
ECFirearm:{weapon:"wp_d_tower_gun06"}};e.archetypes.a_d_tower_top_level_7={shouldPlayerSave:!1,parent:"a_d_tower_top_level_6",ECMesh:{path:"environment/models/e_b_towertop_level_7.dae"},ECFirearm:{weapon:"wp_d_tower_gun07"}};e.archetypes.a_d_tower_top_level_8={shouldPlayerSave:!1,parent:"a_d_tower_top_level_7",ECMesh:{path:"environment/models/e_b_towertop_level_8.dae"},ECFirearm:{weapon:"wp_d_tower_gun08"}};e.archetypes.a_d_tower_top_level_9={shouldPlayerSave:!1,parent:"a_d_tower_top_level_8",ECMesh:{path:"environment/models/e_b_towertop_level_9.dae"},
ECFirearm:{weapon:"wp_d_tower_gun09"}};e.archetypes.a_d_tower_top_level_10={shouldPlayerSave:!1,parent:"a_d_tower_top_level_9",ECMesh:{path:"environment/models/e_b_towertop_level_10.dae"},ECFirearm:{weapon:"wp_d_tower_gun10"}};e.archetypes.a_d_gate={shouldPlayerSave:!0,familyName:"gate",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_gate_level_1.dae",offsetY:-0.5,numInstances:16},ECPhysicsCube:{stationary:!1,scaleMesh:!1,terrainType:"gate1"},ECHealth:{health:e.balanceBuildings.a_d_gate.health},
ECFaction:e.EC_DEFAULT,ECSelectable:{smartRadiusFactor:0.3},ECGate:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECBuilding:{resourceCost:e.balanceBuildings.a_d_gate.resourceCost,secondaryResourceCost:e.balanceBuildings.a_d_gate.secondaryResourceCost,buildTime:e.balanceBuildings.a_d_gate.buildTime,autoRebuild:!1,canSpeedUpWithSoftCurrency:!1,buildingType:"Gate",level:1,addedFootprintSize:0,obeysScaffoldCap:!1,usesInfiniteBuildMode:!0,prerequisites:[{buildingType:"HQ",level:1}],randomRotate:!0,maxLinePlacementLength:5},
ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_gate.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_gate.maxResourceRepairCost,damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECSockets:{sockets:[{archetypeName:"a_b_gatebase_level_1",localOffset:[0,0,0]}]},ECRadialMenu:e.EC_DEFAULT,ECUpgradable:{upgradeName:"Level 2",maxNearbyEntitiesToUpgrade:5,upgradeArchetypeName:"a_d_gate_level_2",upgradeInfo:"gate"},ECUpgrader:e.EC_DEFAULT,ECWorldGui:{text1:"Stone Gate",
text2:"Level 1",onScreenGuiArchetype:"tipStoneWall",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_d_gate_level_2={shouldPlayerSave:!0,parent:"a_d_gate",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_gate_level_2.dae",offsetY:-0.5},ECPhysicsCube:{stationary:!1,scaleMesh:!1,terrainType:"gate2"},ECHealth:{health:e.balanceBuildings.a_d_gate_level_2.health},ECBuilding:{resourceCost:e.balanceBuildings.a_d_gate_level_2.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_d_gate_level_2.secondaryResourceCost,buildTime:e.balanceBuildings.a_d_gate_level_2.buildTime,level:2,addedFootprintSize:0,prerequisites:[{buildingType:"HQ",level:2}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_gate_level_2.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_gate_level_2.maxResourceRepairCost,damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECSockets:{sockets:[{archetypeName:"a_b_gatebase_level_2",
localOffset:[0,0,0]}]},ECUpgradable:{upgradeName:"Level 3",upgradeArchetypeName:"a_d_gate_level_3",upgradeInfo:"gate"},ECWorldGui:{text2:"Level 2"}};e.archetypes.a_d_gate_level_3={shouldPlayerSave:!0,parent:"a_d_gate_level_2",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_gate_level_3.dae",offsetY:-0.5},ECPhysicsCube:{stationary:!1,scaleMesh:!1,terrainType:"gate3"},ECHealth:{health:e.balanceBuildings.a_d_gate_level_3.health},ECBuilding:{resourceCost:e.balanceBuildings.a_d_gate_level_3.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_d_gate_level_3.secondaryResourceCost,buildTime:e.balanceBuildings.a_d_gate_level_3.buildTime,level:3,addedFootprintSize:0,prerequisites:[{buildingType:"HQ",level:3}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_gate_level_3.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_gate_level_3.maxResourceRepairCost,damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECSockets:{sockets:[{archetypeName:"a_b_gatebase_level_3",
localOffset:[0,0,0]}]},ECUpgradable:{upgradeName:"Level 4",upgradeArchetypeName:"a_d_gate_level_4",upgradeInfo:"gate"},ECWorldGui:{text2:"Level 3"}};e.archetypes.a_d_gate_level_4={shouldPlayerSave:!0,parent:"a_d_gate_level_3",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_gate_level_4.dae",offsetY:-0.5},ECPhysicsCube:{stationary:!1,scaleMesh:!1,terrainType:"gate4"},ECHealth:{health:e.balanceBuildings.a_d_gate_level_4.health},ECBuilding:{resourceCost:e.balanceBuildings.a_d_gate_level_4.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_d_gate_level_4.secondaryResourceCost,buildTime:e.balanceBuildings.a_d_gate_level_4.buildTime,level:4,addedFootprintSize:0,prerequisites:[{buildingType:"HQ",level:4}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_gate_level_4.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_gate_level_4.maxResourceRepairCost,damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECSockets:{sockets:[{archetypeName:"a_b_gatebase_level_4",
localOffset:[0,0,0]}]},ECUpgradable:{upgradeName:"Level 5",upgradeArchetypeName:"a_d_gate_level_5",upgradeInfo:"gate"},ECWorldGui:{text2:"Level 4"}};e.archetypes.a_d_gate_level_5={shouldPlayerSave:!0,parent:"a_d_gate_level_4",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_gate_level_5.dae",offsetY:-0.5},ECPhysicsCube:{stationary:!1,scaleMesh:!1,terrainType:"gate5"},ECHealth:{health:e.balanceBuildings.a_d_gate_level_5.health},ECBuilding:{resourceCost:e.balanceBuildings.a_d_gate_level_5.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_d_gate_level_5.secondaryResourceCost,buildTime:e.balanceBuildings.a_d_gate_level_5.buildTime,level:5,addedFootprintSize:0,prerequisites:[{buildingType:"HQ",level:5}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_gate_level_5.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_gate_level_5.maxResourceRepairCost,damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECSockets:{sockets:[{archetypeName:"a_b_gatebase_level_5",
localOffset:[0,0,0]}]},ECUpgradable:{upgradeName:"Level 6",upgradeArchetypeName:"a_d_gate_level_6",upgradeInfo:"gate"},ECWorldGui:{text2:"Level 5"}};e.archetypes.a_d_gate_level_6={shouldPlayerSave:!0,parent:"a_d_gate_level_5",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_gate_level_5.dae",offsetY:-0.5},ECPhysicsCube:{stationary:!1,scaleMesh:!1,terrainType:"gate6"},ECHealth:{health:e.balanceBuildings.a_d_gate_level_6.health},ECBuilding:{resourceCost:e.balanceBuildings.a_d_gate_level_6.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_d_gate_level_6.secondaryResourceCost,buildTime:e.balanceBuildings.a_d_gate_level_6.buildTime,level:6,addedFootprintSize:0,prerequisites:[{buildingType:"HQ",level:6}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_gate_level_6.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_gate_level_6.maxResourceRepairCost,damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECSockets:{sockets:[{archetypeName:"a_b_gatebase_level_5",
localOffset:[0,0,0]}]},ECUpgradable:{upgradeName:"Level 7",upgradeArchetypeName:"a_d_gate_level_7",upgradeInfo:"gate"},ECWorldGui:{text2:"Level 6"}};e.archetypes.a_d_gate_level_7={shouldPlayerSave:!0,parent:"a_d_gate_level_6",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_gate_level_5.dae",offsetY:-0.5},ECPhysicsCube:{stationary:!1,scaleMesh:!1,terrainType:"gate7"},ECHealth:{health:e.balanceBuildings.a_d_gate_level_7.health},ECBuilding:{resourceCost:e.balanceBuildings.a_d_gate_level_7.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_d_gate_level_7.secondaryResourceCost,buildTime:e.balanceBuildings.a_d_gate_level_7.buildTime,level:7,addedFootprintSize:0,prerequisites:[{buildingType:"HQ",level:7}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_gate_level_7.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_gate_level_7.maxResourceRepairCost,damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECSockets:{sockets:[{archetypeName:"a_b_gatebase_level_5",
localOffset:[0,0,0]}]},ECUpgradable:{upgradeName:"Level 8",upgradeArchetypeName:"a_d_gate_level_8",upgradeInfo:"gate"},ECWorldGui:{text2:"Level 7"}};e.archetypes.a_d_gate_level_8={shouldPlayerSave:!0,parent:"a_d_gate_level_7",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_gate_level_5.dae",offsetY:-0.5},ECPhysicsCube:{stationary:!1,scaleMesh:!1,terrainType:"gate8"},ECHealth:{health:e.balanceBuildings.a_d_gate_level_8.health},ECBuilding:{resourceCost:e.balanceBuildings.a_d_gate_level_8.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_d_gate_level_8.secondaryResourceCost,buildTime:e.balanceBuildings.a_d_gate_level_8.buildTime,level:8,addedFootprintSize:0,prerequisites:[{buildingType:"HQ",level:8}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_gate_level_8.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_gate_level_8.maxResourceRepairCost,damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECSockets:{sockets:[{archetypeName:"a_b_gatebase_level_5",
localOffset:[0,0,0]}]},ECUpgradable:{upgradeName:"Level 9",upgradeArchetypeName:"a_d_gate_level_9",upgradeInfo:"gate"},ECWorldGui:{text2:"Level 8"}};e.archetypes.a_d_gate_level_9={shouldPlayerSave:!0,parent:"a_d_gate_level_8",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_gate_level_5.dae",offsetY:-0.5},ECPhysicsCube:{stationary:!1,scaleMesh:!1,terrainType:"gate9"},ECHealth:{health:e.balanceBuildings.a_d_gate_level_9.health},ECBuilding:{resourceCost:e.balanceBuildings.a_d_gate_level_9.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_d_gate_level_9.secondaryResourceCost,buildTime:e.balanceBuildings.a_d_gate_level_9.buildTime,level:9,addedFootprintSize:0,prerequisites:[{buildingType:"HQ",level:9}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_gate_level_9.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_gate_level_9.maxResourceRepairCost,damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECSockets:{sockets:[{archetypeName:"a_b_gatebase_level_5",
localOffset:[0,0,0]}]},ECUpgradable:{upgradeName:"Level 10",upgradeArchetypeName:"a_d_gate_level_10",upgradeInfo:"gate"},ECWorldGui:{text2:"Level 9"}};e.archetypes.a_d_gate_level_10={shouldPlayerSave:!0,parent:"a_d_gate_level_9",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,path:"environment/models/e_b_gate_level_5.dae",offsetY:-0.5},ECPhysicsCube:{stationary:!1,scaleMesh:!1,terrainType:"gate10"},ECHealth:{health:e.balanceBuildings.a_d_gate_level_10.health},ECBuilding:{resourceCost:e.balanceBuildings.a_d_gate_level_10.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_d_gate_level_10.secondaryResourceCost,buildTime:e.balanceBuildings.a_d_gate_level_10.buildTime,level:10,addedFootprintSize:0,prerequisites:[{buildingType:"HQ",level:10}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_gate_level_10.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_gate_level_10.maxResourceRepairCost,damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECSockets:{sockets:[{archetypeName:"a_b_gatebase_level_5",
localOffset:[0,0,0]}]},ECUpgradable:e.EC_REMOVE,ECUpgrader:e.EC_REMOVE,ECWorldGui:{text2:"Level 10"}};e.archetypes.a_d_wall={shouldPlayerSave:!0,familyName:"wall",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,offsetY:-0.5,path:"environment/models/e_b_wall_level_1.dae",numInstances:32},ECHealth:{health:e.balanceBuildings.a_d_wall.health},ECPhysicsCube:{stationary:!0,terrainType:"wall1",v3Scale:[1,0.6,1],offsetY:-0.2},ECFaction:e.EC_DEFAULT,ECSelectable:{smartRadiusFactor:0.3},ECInteractable:e.EC_DEFAULT,ECBuilding:{resourceCost:e.balanceBuildings.a_d_wall.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_d_wall.secondaryResourceCost,buildTime:e.balanceBuildings.a_d_wall.buildTime,autoRebuild:!1,canSpeedUpWithSoftCurrency:!1,buildingType:"Wall",level:1,addedFootprintSize:0,obeysScaffoldCap:!1,usesInfiniteBuildMode:!0,stackable:!0,prerequisites:[{buildingType:"HQ",level:1}],randomRotate:!0,maxLinePlacementLength:10},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_wall.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_wall.maxResourceRepairCost,
damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECRadialMenu:e.EC_DEFAULT,ECUpgradable:{upgradeName:"Level 2",upgradeArchetypeName:"a_d_wall_level_2",upgradeInfo:"wall",maxNearbyEntitiesToUpgrade:5},ECUpgrader:e.EC_DEFAULT,ECWorldGui:{text1:"Stone Wall",text2:"Level 1",onScreenGuiArchetype:"tipStoneWall",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_d_wall_level_2={shouldPlayerSave:!0,parent:"a_d_wall",ECMesh:{scaleX:1,
scaleY:1,scaleZ:1,offsetY:-0.5,path:"environment/models/e_b_wall_level_2.dae"},ECPhysicsCube:{stationary:!0,terrainType:"wall2"},ECHealth:{health:e.balanceBuildings.a_d_wall_level_2.health},ECBuilding:{resourceCost:e.balanceBuildings.a_d_wall_level_2.resourceCost,secondaryResourceCost:e.balanceBuildings.a_d_wall_level_2.secondaryResourceCost,buildTime:e.balanceBuildings.a_d_wall_level_2.buildTime,level:2,prerequisites:[{buildingType:"HQ",level:2}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_wall_level_2.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_d_wall_level_2.maxResourceRepairCost,damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECUpgradable:{upgradeName:"Level 3",upgradeArchetypeName:"a_d_wall_level_3",upgradeInfo:"wall"},ECWorldGui:{text2:"Level 2"}};e.archetypes.a_d_wall_level_3={shouldPlayerSave:!0,parent:"a_d_wall_level_2",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,offsetY:-0.5,path:"environment/models/e_b_wall_level_3.dae"},ECPhysicsCube:{stationary:!0,terrainType:"wall3"},
ECHealth:{health:e.balanceBuildings.a_d_wall_level_3.health},ECBuilding:{resourceCost:e.balanceBuildings.a_d_wall_level_3.resourceCost,secondaryResourceCost:e.balanceBuildings.a_d_wall_level_3.secondaryResourceCost,buildTime:e.balanceBuildings.a_d_wall_level_3.buildTime,level:3,addedFootprintSize:0,prerequisites:[{buildingType:"HQ",level:3}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_wall_level_3.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_wall_level_3.maxResourceRepairCost,
damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECUpgradable:{upgradeName:"Level 4",upgradeArchetypeName:"a_d_wall_level_4",upgradeInfo:"wall"},ECWorldGui:{text2:"Level 3"}};e.archetypes.a_d_wall_level_4={shouldPlayerSave:!0,parent:"a_d_wall_level_3",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,offsetY:-0.5,path:"environment/models/e_b_wall_level_4.dae"},ECPhysicsCube:{stationary:!0,terrainType:"wall4"},ECHealth:{health:e.balanceBuildings.a_d_wall_level_4.health},ECBuilding:{resourceCost:e.balanceBuildings.a_d_wall_level_4.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_d_wall_level_4.secondaryResourceCost,buildTime:e.balanceBuildings.a_d_wall_level_4.buildTime,level:4,addedFootprintSize:0,prerequisites:[{buildingType:"HQ",level:4}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_wall_level_4.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_wall_level_4.maxResourceRepairCost,damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECUpgradable:{upgradeName:"Level 5",
upgradeArchetypeName:"a_d_wall_level_5",upgradeInfo:"wall"},ECWorldGui:{text2:"Level 4"}};e.archetypes.a_d_wall_level_5={shouldPlayerSave:!0,parent:"a_d_wall_level_4",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,offsetY:-0.5,path:"environment/models/e_b_wall_level_5.dae"},ECPhysicsCube:{stationary:!0,terrainType:"wall5",v3Scale:[1,1,1],offsetY:0},ECHealth:{health:e.balanceBuildings.a_d_wall_level_5.health},ECBuilding:{resourceCost:e.balanceBuildings.a_d_wall_level_5.resourceCost,secondaryResourceCost:e.balanceBuildings.a_d_wall_level_5.secondaryResourceCost,
buildTime:e.balanceBuildings.a_d_wall_level_5.buildTime,level:5,addedFootprintSize:0,prerequisites:[{buildingType:"HQ",level:5}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_wall_level_5.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_wall_level_5.maxResourceRepairCost,damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECUpgradable:{upgradeName:"Level 6",upgradeArchetypeName:"a_d_wall_level_6",upgradeInfo:"wall"},ECWorldGui:{text2:"Level 5"}};
e.archetypes.a_d_wall_level_6={shouldPlayerSave:!0,parent:"a_d_wall_level_5",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,offsetY:-0.5,path:"environment/models/e_b_wall_level_6.dae"},ECPhysicsCube:{stationary:!0,terrainType:"wall6"},ECHealth:{health:e.balanceBuildings.a_d_wall_level_6.health},ECBuilding:{resourceCost:e.balanceBuildings.a_d_wall_level_6.resourceCost,secondaryResourceCost:e.balanceBuildings.a_d_wall_level_6.secondaryResourceCost,buildTime:e.balanceBuildings.a_d_wall_level_6.buildTime,level:6,
addedFootprintSize:0,prerequisites:[{buildingType:"HQ",level:6}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_wall_level_6.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_wall_level_6.maxResourceRepairCost,damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECUpgradable:{upgradeName:"Level 7",upgradeArchetypeName:"a_d_wall_level_7",upgradeInfo:"wall"},ECWorldGui:{text2:"Level 6"}};e.archetypes.a_d_wall_level_7={shouldPlayerSave:!0,parent:"a_d_wall_level_6",
ECMesh:{scaleX:1,scaleY:1,scaleZ:1,offsetY:-0.5,path:"environment/models/e_b_wall_level_7.dae"},ECPhysicsCube:{stationary:!0,terrainType:"wall7"},ECHealth:{health:e.balanceBuildings.a_d_wall_level_7.health},ECBuilding:{resourceCost:e.balanceBuildings.a_d_wall_level_7.resourceCost,secondaryResourceCost:e.balanceBuildings.a_d_wall_level_7.secondaryResourceCost,buildTime:e.balanceBuildings.a_d_wall_level_7.buildTime,level:7,addedFootprintSize:0,prerequisites:[{buildingType:"HQ",level:7}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_wall_level_7.minResourceRepairCost,
maxResourceRepairCost:e.balanceBuildings.a_d_wall_level_7.maxResourceRepairCost,damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECUpgradable:{upgradeName:"Level 8",upgradeArchetypeName:"a_d_wall_level_8",upgradeInfo:"wall"},ECWorldGui:{text2:"Level 7"}};e.archetypes.a_d_wall_level_8={shouldPlayerSave:!0,parent:"a_d_wall_level_7",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,offsetY:-0.5,path:"environment/models/e_b_wall_level_8.dae"},ECPhysicsCube:{stationary:!0,terrainType:"wall8"},
ECHealth:{health:e.balanceBuildings.a_d_wall_level_8.health},ECBuilding:{resourceCost:e.balanceBuildings.a_d_wall_level_8.resourceCost,secondaryResourceCost:e.balanceBuildings.a_d_wall_level_8.secondaryResourceCost,buildTime:e.balanceBuildings.a_d_wall_level_8.buildTime,level:8,addedFootprintSize:0,prerequisites:[{buildingType:"HQ",level:8}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_wall_level_8.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_wall_level_8.maxResourceRepairCost,
damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECUpgradable:{upgradeName:"Level 9",upgradeArchetypeName:"a_d_wall_level_9",upgradeInfo:"wall"},ECWorldGui:{text2:"Level 8"}};e.archetypes.a_d_wall_level_9={shouldPlayerSave:!0,parent:"a_d_wall_level_8",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,offsetY:-0.5,path:"environment/models/e_b_wall_level_9.dae"},ECPhysicsCube:{stationary:!0,terrainType:"wall9"},ECHealth:{health:e.balanceBuildings.a_d_wall_level_9.health},ECBuilding:{resourceCost:e.balanceBuildings.a_d_wall_level_9.resourceCost,
secondaryResourceCost:e.balanceBuildings.a_d_wall_level_9.secondaryResourceCost,buildTime:e.balanceBuildings.a_d_wall_level_9.buildTime,level:9,addedFootprintSize:0,prerequisites:[{buildingType:"HQ",level:9}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_wall_level_9.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_wall_level_9.maxResourceRepairCost,damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECUpgradable:{upgradeName:"Level 10",
upgradeArchetypeName:"a_d_wall_level_10",upgradeInfo:"wall"},ECWorldGui:{text2:"Level 9"}};e.archetypes.a_d_wall_level_10={shouldPlayerSave:!0,parent:"a_d_wall_level_9",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,offsetY:-0.5,path:"environment/models/e_b_wall_level_10.dae"},ECPhysicsCube:{stationary:!0,terrainType:"wall10"},ECHealth:{health:e.balanceBuildings.a_d_wall_level_10.health},ECBuilding:{resourceCost:e.balanceBuildings.a_d_wall_level_10.resourceCost,secondaryResourceCost:e.balanceBuildings.a_d_wall_level_10.secondaryResourceCost,
buildTime:e.balanceBuildings.a_d_wall_level_10.buildTime,level:10,addedFootprintSize:0,prerequisites:[{buildingType:"HQ",level:10}]},ECRepairable:{minResourceRepairCost:e.balanceBuildings.a_d_wall_level_10.minResourceRepairCost,maxResourceRepairCost:e.balanceBuildings.a_d_wall_level_10.maxResourceRepairCost,damagedMeshPath:"environment/models/e_b_debris.dae",disablePhysicsWhenBroken:!0},ECUpgradable:e.EC_REMOVE,ECUpgrader:e.EC_REMOVE,ECWorldGui:{text2:"Level 10"}};e.archetypes.a_b_gatebase_level_1=
{shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_gatebase_level_1.dae",numInstances:16}};e.archetypes.a_b_gatebase_level_2={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_gatebase_level_2.dae"}};e.archetypes.a_b_gatebase_level_3={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_gatebase_level_3.dae"}};e.archetypes.a_b_gatebase_level_4={shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_gatebase_level_4.dae"}};e.archetypes.a_b_gatebase_level_5=
{shouldPlayerSave:!1,ECMesh:{scale:1,path:"environment/models/e_b_gatebase_level_5.dae"}};e.archetypes.a_e_bannerling={shouldPlayerSave:!1,familyName:"bannerling",ECMesh:{scale:1,path:"characters/models/c_bannerling_mob.dae",localOffset:[0,0,0],offsetY:-0.6},ECPhysicsSphere:{radius:0.4,usesGravity:!0,canClimb:!0,frictionType:qa.frictionType.CHARACTER,mass:50,height:0.8},ECHealth:{health:e.balanceEnemies.a_e_bannerling.health,barLevel:1,drawInWorldBarIfDamagedRecently:!0},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_bannerling.speed,
fastSpeed:e.balanceEnemies.a_e_bannerling.speed,angleLerpFactor:0.5,animationRate:1.9,animationWobble:0.2},ECAgent:{aggro:0,actions:["AIActionMeleeAttack",{name:"AIActionMoveIntoMeleeRange",initiativeDuration:0},"AIActionChooseMeleeTarget"],priorityTargetType:"Outposts",shouldAggroWhenAttacked:!1,xp:e.balanceEnemies.a_e_bannerling.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_bannerling.importantBuildingDamageLimit,iconSpritePath:"textures/enemy_bannerling.dds",displayNameTextId:"ENEMY_DISPLAY_NAME_BANNERLING"},
ECLootDropper:{coinGroups:e.balanceEnemies.a_e_bannerling.drops},ECMelee:{},ECNav:e.EC_DEFAULT,ECInventory:{weapon:"wp_e_commando_sword_level_1"},ECFaction:e.EC_DEFAULT,ECSelectable:{radiusFactor:2,smart:!1},ECTarget:e.EC_DEFAULT,ECEffectSpawner:{onCreateEffect:"sfx_crt_e_bannerling",impactEffect:"sfx_hit_e_basicmelee",onDestroyEffect:"dfx_dth_e_generic"}};e.archetypes.a_e_bannerling_bombthrower={parent:"a_e_bannerling",shouldPlayerSave:!1,familyName:"bannerling",ECMesh:{scale:1,path:"characters/models/c_bannerling_exploders.dae",
localOffset:[0,0,0],offsetY:-0.6}};e.archetypes.a_e_bannerling_boss={parent:"a_e_bannerling",shouldPlayerSave:!1,familyName:"bannerling",ECMesh:{scale:1,path:"characters/models/c_bannerling_boss.dae",localOffset:[0,0,0],offsetY:-0.6}};e.archetypes.a_e_bannerling_charger={parent:"a_e_bannerling",shouldPlayerSave:!1,familyName:"bannerling",ECMesh:{scale:1,path:"characters/models/c_bannerling_chargers.dae",localOffset:[0,0,0],offsetY:-0.6}};e.archetypes.a_e_bannerling_commando={parent:"a_e_bannerling",
shouldPlayerSave:!1,familyName:"bannerling",ECMesh:{scale:1,path:"characters/models/c_bannerling_commandos.dae",localOffset:[0,0,0],offsetY:-0.6}};e.archetypes.a_e_bannerling_death={parent:"a_e_bannerling",shouldPlayerSave:!1,familyName:"bannerling",ECMesh:{scale:1,path:"characters/models/c_bannerling_death.dae",localOffset:[0,0,0],offsetY:-0.6}};e.archetypes.a_e_bannerling_mob={parent:"a_e_bannerling",shouldPlayerSave:!1,familyName:"bannerling",ECMesh:{scale:1,path:"characters/models/c_bannerling_mob.dae",
localOffset:[0,0,0],offsetY:-0.6}};e.archetypes.a_e_bannerling_ranged={parent:"a_e_bannerling",shouldPlayerSave:!1,familyName:"bannerling",ECMesh:{scale:1,path:"characters/models/c_bannerling_ranged.dae",localOffset:[0,0,0],offsetY:-0.6}};e.archetypes.a_e_bannerling_thief={parent:"a_e_bannerling",shouldPlayerSave:!1,familyName:"bannerling",ECMesh:{scale:1,path:"characters/models/c_bannerling_thieves.dae",localOffset:[0,0,0],offsetY:-0.6}};e.archetypes.a_e_bannerling_treasuredropper={parent:"a_e_bannerling",
shouldPlayerSave:!1,familyName:"bannerling",ECMesh:{scale:1,path:"characters/models/c_bannerling_treasure.dae",localOffset:[0,0,0],offsetY:-0.6}};e.archetypes.a_e_basicmelee_level_1={shouldPlayerSave:!1,familyName:"basicmelee",ECMesh:{scale:1,path:"characters/models/c_basicmelee.dae",localOffset:[0,0,0],offsetY:-0.6},ECPhysicsSphere:{radius:0.4,usesGravity:!0,canClimb:!0,frictionType:qa.frictionType.CHARACTER,mass:50,height:0.8},ECHealth:{health:e.balanceEnemies.a_e_basicmelee_level_1.health,barLevel:1,
drawInWorldBarIfDamagedRecently:!0},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_basicmelee_level_1.speed,fastSpeed:e.balanceEnemies.a_e_basicmelee_level_1.speed,angleLerpFactor:0.5},ECAgent:{aggro:0,actions:["AIActionMeleeAttack",{name:"AIActionMoveIntoMeleeRange",initiativeDuration:0,overrideMeleeRange:1},"AIActionChooseMeleeTarget"],xp:e.balanceEnemies.a_e_basicmelee_level_1.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_basicmelee_level_1.importantBuildingDamageLimit,iconSpritePath:"textures/enemy_basic_melee.dds",
displayNameTextId:"ENEMY_DISPLAY_NAME_BASIC_MELEE"},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_basicmelee_level_1.drops},ECMelee:{},ECNav:e.EC_DEFAULT,ECInventory:{weapon:"wp_e_basicmelee_sword_level_1"},ECFaction:e.EC_DEFAULT,ECSelectable:{radiusFactor:2,smart:!1},ECTarget:e.EC_DEFAULT,ECEffectSpawner:{impactEffect:"sfx_hit_e_basicmelee",onDestroyEffect:"dfx_dth_e_generic"}};e.archetypes.a_aardvark_basicmelee_level_1={parent:"a_e_basicmelee_level_1",shouldPlayerSave:!1,familyName:"basicmelee"};
e.archetypes.a_e_basicmelee_level_2={parent:"a_e_basicmelee_level_1",shouldPlayerSave:!1,familyName:"basicmelee",ECMesh:{scale:1,path:"characters/models/c_basicmelee_level02.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_basicmelee_level_2.health,barLevel:2},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_basicmelee_level_2.speed,fastSpeed:e.balanceEnemies.a_e_basicmelee_level_2.speed},ECAgent:{xp:e.balanceEnemies.a_e_basicmelee_level_2.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_basicmelee_level_2.importantBuildingDamageLimit},
ECLootDropper:{coinGroups:e.balanceEnemies.a_e_basicmelee_level_2.drops},ECInventory:{weapon:"wp_e_basicmelee_sword_level_2"}};e.archetypes.a_e_basicmelee_level_3={parent:"a_e_basicmelee_level_2",shouldPlayerSave:!1,familyName:"basicmelee",ECMesh:{scale:1,path:"characters/models/c_basicmelee_level03.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_basicmelee_level_3.health,barLevel:3},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_basicmelee_level_3.speed,fastSpeed:e.balanceEnemies.a_e_basicmelee_level_3.speed},
ECAgent:{xp:e.balanceEnemies.a_e_basicmelee_level_3.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_basicmelee_level_3.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_basicmelee_level_3.drops},ECInventory:{weapon:"wp_e_basicmelee_sword_level_3"}};e.archetypes.a_e_basicmelee_level_4={parent:"a_e_basicmelee_level_3",shouldPlayerSave:!1,familyName:"basicmelee",ECMesh:{scale:1,path:"characters/models/c_basicmelee_level04.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_basicmelee_level_4.health,
barLevel:4},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_basicmelee_level_4.speed,fastSpeed:e.balanceEnemies.a_e_basicmelee_level_4.speed},ECAgent:{xp:e.balanceEnemies.a_e_basicmelee_level_4.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_basicmelee_level_4.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_basicmelee_level_4.drops},ECInventory:{weapon:"wp_e_basicmelee_sword_level_4"}};e.archetypes.a_e_basicmelee_level_5={parent:"a_e_basicmelee_level_4",shouldPlayerSave:!1,
familyName:"basicmelee",ECMesh:{scale:1,path:"characters/models/c_basicmelee_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_basicmelee_level_5.health,barLevel:5},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_basicmelee_level_5.speed,fastSpeed:e.balanceEnemies.a_e_basicmelee_level_5.speed},ECAgent:{xp:e.balanceEnemies.a_e_basicmelee_level_5.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_basicmelee_level_5.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_basicmelee_level_5.drops},
ECInventory:{weapon:"wp_e_basicmelee_sword_level_5"}};e.archetypes.a_e_basicmelee_level_6={parent:"a_e_basicmelee_level_5",shouldPlayerSave:!1,familyName:"basicmelee",ECMesh:{scale:1.2,path:"characters/models/c_basicmelee_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_basicmelee_level_6.health,barLevel:6},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_basicmelee_level_6.speed,fastSpeed:e.balanceEnemies.a_e_basicmelee_level_6.speed},ECAgent:{xp:e.balanceEnemies.a_e_basicmelee_level_6.xp,
importantBuildingDamageLimit:e.balanceEnemies.a_e_basicmelee_level_6.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_basicmelee_level_6.drops},ECInventory:{weapon:"wp_e_basicmelee_sword_level_6"}};e.archetypes.a_e_basicmelee_level_7={parent:"a_e_basicmelee_level_6",shouldPlayerSave:!1,familyName:"basicmelee",ECMesh:{scale:1.4,path:"characters/models/c_basicmelee_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_basicmelee_level_7.health,
barLevel:7},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_basicmelee_level_7.speed,fastSpeed:e.balanceEnemies.a_e_basicmelee_level_7.speed},ECAgent:{xp:e.balanceEnemies.a_e_basicmelee_level_7.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_basicmelee_level_7.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_basicmelee_level_7.drops},ECInventory:{weapon:"wp_e_basicmelee_sword_level_7"}};e.archetypes.a_e_basicmelee_level_8={parent:"a_e_basicmelee_level_7",shouldPlayerSave:!1,
familyName:"basicmelee",ECMesh:{scale:1.6,path:"characters/models/c_basicmelee_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_basicmelee_level_8.health,barLevel:8},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_basicmelee_level_8.speed,fastSpeed:e.balanceEnemies.a_e_basicmelee_level_8.speed},ECAgent:{xp:e.balanceEnemies.a_e_basicmelee_level_8.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_basicmelee_level_8.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_basicmelee_level_8.drops},
ECInventory:{weapon:"wp_e_basicmelee_sword_level_8"}};ba.archetypes.wp_e_basicmelee_sword_level_1={isMelee:!0,attackDuration:0.2,chargeDuration:0.2,attackRange:2,attackAngle:60,damageType:"dg_e_basicmelee_sword_level_1",beginAttackSound:"battleEffort",attackImpactSound:"punch"};ba.archetypes.wp_e_basicmelee_sword_level_2={isMelee:!0,attackDuration:0.2,chargeDuration:0.2,attackRange:2,attackAngle:60,damageType:"dg_e_basicmelee_sword_level_2",beginAttackSound:"battleEffort",attackImpactSound:"punch"};
ba.archetypes.wp_e_basicmelee_sword_level_3={isMelee:!0,attackDuration:0.2,chargeDuration:0.2,attackRange:2,attackAngle:60,damageType:"dg_e_basicmelee_sword_level_3",beginAttackSound:"battleEffort",attackImpactSound:"punch"};ba.archetypes.wp_e_basicmelee_sword_level_4={isMelee:!0,attackDuration:0.2,chargeDuration:0.2,attackRange:2,attackAngle:60,damageType:"dg_e_basicmelee_sword_level_4",beginAttackSound:"battleEffort",attackImpactSound:"punch"};ba.archetypes.wp_e_basicmelee_sword_level_5={isMelee:!0,
attackDuration:0.2,chargeDuration:0.2,attackRange:2,attackAngle:60,damageType:"dg_e_basicmelee_sword_level_5",beginAttackSound:"battleEffort",attackImpactSound:"punch"};ba.archetypes.wp_e_basicmelee_sword_level_6={isMelee:!0,attackDuration:0.2,chargeDuration:0.2,attackRange:2,attackAngle:60,damageType:"dg_e_basicmelee_sword_level_6",beginAttackSound:"battleEffort",attackImpactSound:"punch"};ba.archetypes.wp_e_basicmelee_sword_level_7={isMelee:!0,attackDuration:0.2,chargeDuration:0.2,attackRange:2,
attackAngle:60,damageType:"dg_e_basicmelee_sword_level_7",beginAttackSound:"battleEffort",attackImpactSound:"punch"};ba.archetypes.wp_e_basicmelee_sword_level_8={isMelee:!0,attackDuration:0.2,chargeDuration:0.2,attackRange:2,attackAngle:60,damageType:"dg_e_basicmelee_sword_level_8",beginAttackSound:"battleEffort",attackImpactSound:"punch"};A.archetypes.dg_e_basicmelee_sword_level_1=A.create("Basic Melee Sword Attack",{damage:e.balanceEnemies.a_e_basicmelee_level_1.damage,buildingDamage:e.balanceEnemies.a_e_basicmelee_level_1.buildingDamage,
wallDamage:e.balanceEnemies.a_e_basicmelee_level_1.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_basicmelee_sword_level_2=A.create("Basic Melee Sword Attack",{damage:e.balanceEnemies.a_e_basicmelee_level_2.damage,buildingDamage:e.balanceEnemies.a_e_basicmelee_level_2.buildingDamage,wallDamage:e.balanceEnemies.a_e_basicmelee_level_2.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_basicmelee_sword_level_3=
A.create("Basic Melee Sword Attack",{damage:e.balanceEnemies.a_e_basicmelee_level_3.damage,buildingDamage:e.balanceEnemies.a_e_basicmelee_level_3.buildingDamage,wallDamage:e.balanceEnemies.a_e_basicmelee_level_3.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_basicmelee_sword_level_4=A.create("Basic Melee Sword Attack",{damage:e.balanceEnemies.a_e_basicmelee_level_4.damage,buildingDamage:e.balanceEnemies.a_e_basicmelee_level_4.buildingDamage,
wallDamage:e.balanceEnemies.a_e_basicmelee_level_4.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_basicmelee_sword_level_5=A.create("Basic Melee Sword Attack",{damage:e.balanceEnemies.a_e_basicmelee_level_5.damage,buildingDamage:e.balanceEnemies.a_e_basicmelee_level_5.buildingDamage,wallDamage:e.balanceEnemies.a_e_basicmelee_level_5.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_basicmelee_sword_level_6=
A.create("Basic Melee Sword Attack",{damage:e.balanceEnemies.a_e_basicmelee_level_6.damage,buildingDamage:e.balanceEnemies.a_e_basicmelee_level_6.buildingDamage,wallDamage:e.balanceEnemies.a_e_basicmelee_level_6.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_basicmelee_sword_level_7=A.create("Basic Melee Sword Attack",{damage:e.balanceEnemies.a_e_basicmelee_level_7.damage,buildingDamage:e.balanceEnemies.a_e_basicmelee_level_7.buildingDamage,
wallDamage:e.balanceEnemies.a_e_basicmelee_level_7.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_basicmelee_sword_level_8=A.create("Basic Melee Sword Attack",{damage:e.balanceEnemies.a_e_basicmelee_level_8.damage,buildingDamage:e.balanceEnemies.a_e_basicmelee_level_8.buildingDamage,wallDamage:e.balanceEnemies.a_e_basicmelee_level_8.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});e.archetypes.a_e_ranged_level_1=
{shouldPlayerSave:!1,familyName:"ranged",ECMesh:{scale:1,path:"characters/models/c_basicrange.dae",localOffset:[0,0,0],offsetY:-0.75},ECPhysicsSphere:{radius:0.4,usesGravity:!0,canClimb:!0,frictionType:qa.frictionType.CHARACTER,mass:50,height:0.4},ECFirearm:{weapon:"wp_e_ranged_level_1",shootOffset:[0,-0.4,0.75]},ECHealth:{health:e.balanceEnemies.a_e_ranged_level_1.health,barLevel:1,drawInWorldBarIfDamagedRecently:!0},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_ranged_level_1.speed,fastSpeed:e.balanceEnemies.a_e_ranged_level_1.speed,
angleLerpFactor:0.5},ECAgent:{aggro:0,actions:[{name:"AIActionRangedAttack",numberOfProjectiles:3,firstShotPerfectAim:!0,aimDuration:0},{name:"AIActionMoveIntoFirearmRange",initiativeDuration:0},"AIActionChooseRangedTarget"],priorityTargetType:"Heroes",xp:e.balanceEnemies.a_e_ranged_level_1.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_ranged_level_1.importantBuildingDamageLimit,iconSpritePath:"textures/enemy_ranged.dds",displayNameTextId:"ENEMY_DISPLAY_NAME_RANGED"},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_ranged_level_1.drops},
ECNav:e.EC_DEFAULT,ECInventory:{weapon:"wp_e_ranged_level_1"},ECFaction:e.EC_DEFAULT,ECSelectable:{radiusFactor:2,smart:!1},ECTarget:e.EC_DEFAULT,ECEffectSpawner:{impactEffect:"sfx_hit_e_ranged",onDestroyEffect:"dfx_dth_e_generic"}};e.archetypes.a_e_ranged_level_2={parent:"a_e_ranged_level_1",shouldPlayerSave:!1,familyName:"ranged",ECMesh:{scale:1,path:"characters/models/c_basicrange_level02.dae",localOffset:[0,0,0],offsetY:-0.75},ECFirearm:{weapon:"wp_e_ranged_level_2"},ECHealth:{health:e.balanceEnemies.a_e_ranged_level_2.health,
barLevel:2},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_ranged_level_2.speed,fastSpeed:e.balanceEnemies.a_e_ranged_level_2.speed},ECAgent:{xp:e.balanceEnemies.a_e_ranged_level_2.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_ranged_level_2.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_ranged_level_2.drops},ECInventory:{weapon:"wp_e_ranged_level_2"}};e.archetypes.a_e_ranged_level_3={parent:"a_e_ranged_level_2",shouldPlayerSave:!1,familyName:"ranged",ECMesh:{scale:1,
path:"characters/models/c_basicrange_level03.dae",localOffset:[0,0,0],offsetY:-0.75},ECFirearm:{weapon:"wp_e_ranged_level_3"},ECHealth:{health:e.balanceEnemies.a_e_ranged_level_3.health,barLevel:3},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_ranged_level_3.speed,fastSpeed:e.balanceEnemies.a_e_ranged_level_3.speed},ECAgent:{xp:e.balanceEnemies.a_e_ranged_level_3.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_ranged_level_3.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_ranged_level_3.drops},
ECInventory:{weapon:"wp_e_ranged_level_3"}};e.archetypes.a_e_ranged_level_4={parent:"a_e_ranged_level_3",shouldPlayerSave:!1,familyName:"ranged",ECMesh:{scale:1,path:"characters/models/c_basicrange_level04.dae",localOffset:[0,0,0],offsetY:-0.75},ECFirearm:{weapon:"wp_e_ranged_level_4"},ECHealth:{health:e.balanceEnemies.a_e_ranged_level_4.health,barLevel:4},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_ranged_level_4.speed,fastSpeed:e.balanceEnemies.a_e_ranged_level_4.speed},ECAgent:{xp:e.balanceEnemies.a_e_ranged_level_4.xp,
importantBuildingDamageLimit:e.balanceEnemies.a_e_ranged_level_4.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_ranged_level_4.drops},ECInventory:{weapon:"wp_e_ranged_level_4"}};e.archetypes.a_e_ranged_level_5={parent:"a_e_ranged_level_4",shouldPlayerSave:!1,familyName:"ranged",ECMesh:{scale:1,path:"characters/models/c_basicrange_level05.dae",localOffset:[0,0,0],offsetY:-0.75},ECFirearm:{weapon:"wp_e_ranged_level_5"},ECHealth:{health:e.balanceEnemies.a_e_ranged_level_5.health,
barLevel:5},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_ranged_level_5.speed,fastSpeed:e.balanceEnemies.a_e_ranged_level_5.speed},ECAgent:{xp:e.balanceEnemies.a_e_ranged_level_5.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_ranged_level_5.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_ranged_level_5.drops},ECInventory:{weapon:"wp_e_ranged_level_5"}};e.archetypes.a_e_ranged_level_6={parent:"a_e_ranged_level_5",shouldPlayerSave:!1,familyName:"ranged",ECMesh:{scale:1.2,
path:"characters/models/c_basicrange_level05.dae",localOffset:[0,0,0],offsetY:-0.75},ECFirearm:{weapon:"wp_e_ranged_level_6"},ECHealth:{health:e.balanceEnemies.a_e_ranged_level_6.health,barLevel:6},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_ranged_level_6.speed,fastSpeed:e.balanceEnemies.a_e_ranged_level_6.speed},ECAgent:{xp:e.balanceEnemies.a_e_ranged_level_6.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_ranged_level_6.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_ranged_level_6.drops},
ECInventory:{weapon:"wp_e_ranged_level_6"}};e.archetypes.a_e_ranged_level_7={parent:"a_e_ranged_level_6",shouldPlayerSave:!1,familyName:"ranged",ECMesh:{scale:1.4,path:"characters/models/c_basicrange_level05.dae",localOffset:[0,0,0],offsetY:-0.75},ECFirearm:{weapon:"wp_e_ranged_level_7"},ECHealth:{health:e.balanceEnemies.a_e_ranged_level_7.health,barLevel:7},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_ranged_level_7.speed,fastSpeed:e.balanceEnemies.a_e_ranged_level_7.speed},ECAgent:{xp:e.balanceEnemies.a_e_ranged_level_7.xp,
importantBuildingDamageLimit:e.balanceEnemies.a_e_ranged_level_7.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_ranged_level_7.drops},ECInventory:{weapon:"wp_e_ranged_level_7"}};e.archetypes.a_e_ranged_level_8={parent:"a_e_ranged_level_7",shouldPlayerSave:!1,familyName:"ranged",ECMesh:{scale:1.6,path:"characters/models/c_basicrange_level05.dae",localOffset:[0,0,0],offsetY:-0.75},ECFirearm:{weapon:"wp_e_ranged_level_8"},ECHealth:{health:e.balanceEnemies.a_e_ranged_level_8.health,
barLevel:8},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_ranged_level_8.speed,fastSpeed:e.balanceEnemies.a_e_ranged_level_8.speed},ECAgent:{xp:e.balanceEnemies.a_e_ranged_level_8.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_ranged_level_8.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_ranged_level_8.drops},ECInventory:{weapon:"wp_e_ranged_level_8"}};ba.archetypes.wp_e_ranged_level_1={projectileType:"pj_e_ranged_level_1",fireSound:"spit",cockSound:"",reloadSound:"",
dryFireSound:"",reloadDuration:1.5,rechamberDuration:0.2,minRange:0,maxRange:10,maxProjectileRange:20,clipSize:3,randomSpreadAngle:30};ba.archetypes.wp_e_ranged_level_2={projectileType:"pj_e_ranged_level_2",fireSound:"spit",cockSound:"",reloadSound:"",dryFireSound:"",reloadDuration:1.5,rechamberDuration:0.2,minRange:0,maxRange:10,maxProjectileRange:20,clipSize:3,randomSpreadAngle:30};ba.archetypes.wp_e_ranged_level_3={projectileType:"pj_e_ranged_level_3",fireSound:"spit",cockSound:"",reloadSound:"",
dryFireSound:"",reloadDuration:1.5,rechamberDuration:0.2,minRange:0,maxRange:10,maxProjectileRange:20,clipSize:3,randomSpreadAngle:30};ba.archetypes.wp_e_ranged_level_4={projectileType:"pj_e_ranged_level_4",fireSound:"spit",cockSound:"",reloadSound:"",dryFireSound:"",reloadDuration:1.5,rechamberDuration:0.2,minRange:0,maxRange:10,maxProjectileRange:20,clipSize:3,randomSpreadAngle:30};ba.archetypes.wp_e_ranged_level_5={projectileType:"pj_e_ranged_level_5",fireSound:"spit",cockSound:"",reloadSound:"",
dryFireSound:"",reloadDuration:1.5,rechamberDuration:0.2,minRange:0,maxRange:10,maxProjectileRange:20,clipSize:3,randomSpreadAngle:30};ba.archetypes.wp_e_ranged_level_6={projectileType:"pj_e_ranged_level_6",fireSound:"spit",cockSound:"",reloadSound:"",dryFireSound:"",reloadDuration:1.5,rechamberDuration:0.2,minRange:0,maxRange:10,maxProjectileRange:20,clipSize:3,randomSpreadAngle:30};ba.archetypes.wp_e_ranged_level_7={projectileType:"pj_e_ranged_level_7",fireSound:"spit",cockSound:"",reloadSound:"",
dryFireSound:"",reloadDuration:1.5,rechamberDuration:0.2,minRange:0,maxRange:10,maxProjectileRange:20,clipSize:3,randomSpreadAngle:30};ba.archetypes.wp_e_ranged_level_8={projectileType:"pj_e_ranged_level_8",fireSound:"spit",cockSound:"",reloadSound:"",dryFireSound:"",reloadDuration:1.5,rechamberDuration:0.2,minRange:0,maxRange:10,maxProjectileRange:20,clipSize:3,randomSpreadAngle:30};e.archetypes.pj_e_ranged_level_1={shouldPlayerSave:!1,ECMesh:{path:"characters/models/mucus.dae",scale:2},ECProjectile:{speed:6,
damageType:"dg_e_ranged_spit_level_1",ignoresAllies:!0,hitSound:"dartHit",hurtSound:"dartHitFlesh"},ECEffectSpawner:{onCreateEffect:void 0,incidentalEffect:"sfx_amb_spit",incidentalMinTime:0,incidentalMaxTime:0.2}};e.archetypes.pj_e_ranged_level_2={parent:"pj_e_ranged_level_1",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_ranged_spit_level_2"}};e.archetypes.pj_e_ranged_level_3={parent:"pj_e_ranged_level_2",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_ranged_spit_level_3"}};e.archetypes.pj_e_ranged_level_4=
{parent:"pj_e_ranged_level_3",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_ranged_spit_level_4"}};e.archetypes.pj_e_ranged_level_5={parent:"pj_e_ranged_level_4",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_ranged_spit_level_5"}};e.archetypes.pj_e_ranged_level_6={parent:"pj_e_ranged_level_5",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_ranged_spit_level_6"}};e.archetypes.pj_e_ranged_level_7={parent:"pj_e_ranged_level_6",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_ranged_spit_level_7"}};
e.archetypes.pj_e_ranged_level_8={parent:"pj_e_ranged_level_7",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_ranged_spit_level_8"}};A.archetypes.dg_e_ranged_spit_level_1=A.create("dg_e_ranged_spit_level_1",{damage:e.balanceEnemies.a_e_ranged_level_1.damage,buildingDamage:e.balanceEnemies.a_e_ranged_level_1.buildingDamage,wallDamage:e.balanceEnemies.a_e_ranged_level_1.wallDamage,forceBack:0.2,forceLift:0.2,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_ranged_spit_level_2=
A.create("dg_e_ranged_spit_level_2",{damage:e.balanceEnemies.a_e_ranged_level_2.damage,buildingDamage:e.balanceEnemies.a_e_ranged_level_2.buildingDamage,wallDamage:e.balanceEnemies.a_e_ranged_level_2.wallDamage,forceBack:0.2,forceLift:0.2,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_ranged_spit_level_3=A.create("dg_e_ranged_spit_level_3",{damage:e.balanceEnemies.a_e_ranged_level_3.damage,buildingDamage:e.balanceEnemies.a_e_ranged_level_3.buildingDamage,wallDamage:e.balanceEnemies.a_e_ranged_level_3.wallDamage,
forceBack:0.2,forceLift:0.2,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_ranged_spit_level_4=A.create("dg_e_ranged_spit_level_4",{damage:e.balanceEnemies.a_e_ranged_level_4.damage,buildingDamage:e.balanceEnemies.a_e_ranged_level_4.buildingDamage,wallDamage:e.balanceEnemies.a_e_ranged_level_4.wallDamage,forceBack:0.2,forceLift:0.2,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_ranged_spit_level_5=A.create("dg_e_ranged_spit_level_5",{damage:e.balanceEnemies.a_e_ranged_level_5.damage,
buildingDamage:e.balanceEnemies.a_e_ranged_level_5.buildingDamage,wallDamage:e.balanceEnemies.a_e_ranged_level_5.wallDamage,forceBack:0.2,forceLift:0.2,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_ranged_spit_level_6=A.create("dg_e_ranged_spit_level_6",{damage:e.balanceEnemies.a_e_ranged_level_6.damage,buildingDamage:e.balanceEnemies.a_e_ranged_level_6.buildingDamage,wallDamage:e.balanceEnemies.a_e_ranged_level_6.wallDamage,forceBack:0.2,forceLift:0.2,forceRadial:0,
forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_ranged_spit_level_7=A.create("dg_e_ranged_spit_level_7",{damage:e.balanceEnemies.a_e_ranged_level_7.damage,buildingDamage:e.balanceEnemies.a_e_ranged_level_7.buildingDamage,wallDamage:e.balanceEnemies.a_e_ranged_level_7.wallDamage,forceBack:0.2,forceLift:0.2,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_ranged_spit_level_8=A.create("dg_e_ranged_spit_level_8",{damage:e.balanceEnemies.a_e_ranged_level_8.damage,
buildingDamage:e.balanceEnemies.a_e_ranged_level_8.buildingDamage,wallDamage:e.balanceEnemies.a_e_ranged_level_8.wallDamage,forceBack:0.2,forceLift:0.2,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});e.archetypes.a_e_berserker_level_1={shouldPlayerSave:!1,familyName:"berserker",ECMesh:{scale:1,path:"characters/models/c_kamikaze.dae",localOffset:[0,0,0],offsetY:-0.7},ECPhysicsSphere:{radius:0.4,usesGravity:!0,canClimb:!0,frictionType:qa.frictionType.CHARACTER,mass:500,height:0.8},ECHealth:{health:e.balanceEnemies.a_e_berserker_level_1.health,
barLevel:1,drawInWorldBarIfDamagedRecently:!0},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_berserker_level_1.speed,fastSpeed:e.balanceEnemies.a_e_berserker_level_1.speed,angleLerpFactor:0.5,animationWobble:0.25},ECAgent:{aggro:0,actions:["AIActionMeleeAttack",{name:"AIActionMoveIntoMeleeRange",initiativeDuration:0},"AIActionChooseMeleeTarget"],priorityTargetType:"Buildings",shouldAggroWhenAttacked:!1,stunnable:!1,xp:e.balanceEnemies.a_e_berserker_level_1.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_berserker_level_1.importantBuildingDamageLimit,
iconSpritePath:"textures/enemy_berserker.dds",displayNameTextId:"ENEMY_DISPLAY_NAME_BERSERKER"},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_berserker_level_1.drops},ECMelee:{attackType:"MeleeExplode",attackRange:1.5},ECExplode:{damageType:"dg_e_berserker_explode_level_1",explodeOnDeath:!0,sfxArchetype:"sfx_explosionBerserker"},ECNav:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECSelectable:{radiusFactor:2,smart:!1},ECTarget:e.EC_DEFAULT,ECEffectSpawner:{ambientEffect:"sfx_amb_e_berserker",impactEffect:"sfx_hit_e_berserker",
onDestroyEffect:"dfx_dth_e_generic"}};e.archetypes.a_e_berserker_level_2={parent:"a_e_berserker_level_1",shouldPlayerSave:!1,familyName:"berserker",ECMesh:{scale:1,path:"characters/models/c_kamikaze_level02.dae",localOffset:[0,0,0],offsetY:-0.7},ECHealth:{health:e.balanceEnemies.a_e_berserker_level_2.health,barLevel:2},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_berserker_level_2.speed,fastSpeed:e.balanceEnemies.a_e_berserker_level_2.speed},ECAgent:{xp:e.balanceEnemies.a_e_berserker_level_2.xp,
importantBuildingDamageLimit:e.balanceEnemies.a_e_berserker_level_2.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_berserker_level_2.drops},ECExplode:{damageType:"dg_e_berserker_explode_level_2"}};e.archetypes.a_e_berserker_level_3={parent:"a_e_berserker_level_2",shouldPlayerSave:!1,familyName:"berserker",ECMesh:{scale:1,path:"characters/models/c_kamikaze_level03.dae",localOffset:[0,0,0],offsetY:-0.7},ECHealth:{health:e.balanceEnemies.a_e_berserker_level_3.health,barLevel:3},
ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_berserker_level_3.speed,fastSpeed:e.balanceEnemies.a_e_berserker_level_3.speed},ECAgent:{xp:e.balanceEnemies.a_e_berserker_level_3.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_berserker_level_3.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_berserker_level_3.drops},ECExplode:{damageType:"dg_e_berserker_explode_level_3"}};e.archetypes.a_e_berserker_level_4={parent:"a_e_berserker_level_3",shouldPlayerSave:!1,familyName:"berserker",
ECMesh:{scale:1,path:"characters/models/c_kamikaze_level04.dae",localOffset:[0,0,0],offsetY:-0.7},ECHealth:{health:e.balanceEnemies.a_e_berserker_level_4.health,barLevel:4},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_berserker_level_4.speed,fastSpeed:e.balanceEnemies.a_e_berserker_level_4.speed},ECAgent:{xp:e.balanceEnemies.a_e_berserker_level_4.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_berserker_level_4.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_berserker_level_4.drops},
ECExplode:{damageType:"dg_e_berserker_explode_level_4"}};e.archetypes.a_e_berserker_level_5={parent:"a_e_berserker_level_4",shouldPlayerSave:!1,familyName:"berserker",ECMesh:{scale:1,path:"characters/models/c_kamikaze_level05.dae",localOffset:[0,0,0],offsetY:-0.7},ECHealth:{health:e.balanceEnemies.a_e_berserker_level_5.health,barLevel:5},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_berserker_level_5.speed,fastSpeed:e.balanceEnemies.a_e_berserker_level_5.speed},ECAgent:{xp:e.balanceEnemies.a_e_berserker_level_5.xp,
importantBuildingDamageLimit:e.balanceEnemies.a_e_berserker_level_5.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_berserker_level_5.drops},ECExplode:{damageType:"dg_e_berserker_explode_level_5"}};e.archetypes.a_e_berserker_level_6={parent:"a_e_berserker_level_5",shouldPlayerSave:!1,familyName:"berserker",ECMesh:{scale:1.2,path:"characters/models/c_kamikaze_level05.dae",localOffset:[0,0,0],offsetY:-0.7},ECHealth:{health:e.balanceEnemies.a_e_berserker_level_6.health,barLevel:6},
ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_berserker_level_6.speed,fastSpeed:e.balanceEnemies.a_e_berserker_level_6.speed},ECAgent:{xp:e.balanceEnemies.a_e_berserker_level_6.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_berserker_level_6.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_berserker_level_6.drops},ECExplode:{damageType:"dg_e_berserker_explode_level_6"}};e.archetypes.a_e_berserker_level_7={parent:"a_e_berserker_level_6",shouldPlayerSave:!1,familyName:"berserker",
ECMesh:{scale:1.4,path:"characters/models/c_kamikaze_level05.dae",localOffset:[0,0,0],offsetY:-0.7},ECHealth:{health:e.balanceEnemies.a_e_berserker_level_7.health,barLevel:7},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_berserker_level_7.speed,fastSpeed:e.balanceEnemies.a_e_berserker_level_7.speed},ECAgent:{xp:e.balanceEnemies.a_e_berserker_level_7.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_berserker_level_7.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_berserker_level_7.drops},
ECExplode:{damageType:"dg_e_berserker_explode_level_7"}};e.archetypes.a_e_berserker_level_8={parent:"a_e_berserker_level_7",shouldPlayerSave:!1,familyName:"berserker",ECMesh:{scale:1.6,path:"characters/models/c_kamikaze_level05.dae",localOffset:[0,0,0],offsetY:-0.7},ECHealth:{health:e.balanceEnemies.a_e_berserker_level_8.health,barLevel:8},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_berserker_level_8.speed,fastSpeed:e.balanceEnemies.a_e_berserker_level_8.speed},ECAgent:{xp:e.balanceEnemies.a_e_berserker_level_8.xp,
importantBuildingDamageLimit:e.balanceEnemies.a_e_berserker_level_8.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_berserker_level_8.drops},ECExplode:{damageType:"dg_e_berserker_explode_level_8"}};A.archetypes.dg_e_berserker_explode_level_1=A.create("Berserker Explosion",{damage:e.balanceEnemies.a_e_berserker_level_1.damage,buildingDamage:e.balanceEnemies.a_e_berserker_level_1.buildingDamage,wallDamage:e.balanceEnemies.a_e_berserker_level_1.wallDamage,forceBack:0,forceLift:1,
forceRadial:1,forceTangential:0,friendlyFire:0.2,radius:2.5,isExplosion:!0});A.archetypes.dg_e_berserker_explode_level_2=A.create("Berserker Explosion",{damage:e.balanceEnemies.a_e_berserker_level_2.damage,buildingDamage:e.balanceEnemies.a_e_berserker_level_2.buildingDamage,wallDamage:e.balanceEnemies.a_e_berserker_level_2.wallDamage,forceBack:0,forceLift:1,forceRadial:1,forceTangential:0,friendlyFire:0.2,radius:2.5,isExplosion:!0});A.archetypes.dg_e_berserker_explode_level_3=A.create("Berserker Explosion",
{damage:e.balanceEnemies.a_e_berserker_level_3.damage,buildingDamage:e.balanceEnemies.a_e_berserker_level_3.buildingDamage,wallDamage:e.balanceEnemies.a_e_berserker_level_3.wallDamage,forceBack:0,forceLift:1,forceRadial:1,forceTangential:0,friendlyFire:0.2,radius:2.5,isExplosion:!0});A.archetypes.dg_e_berserker_explode_level_4=A.create("Berserker Explosion",{damage:e.balanceEnemies.a_e_berserker_level_4.damage,buildingDamage:e.balanceEnemies.a_e_berserker_level_4.buildingDamage,wallDamage:e.balanceEnemies.a_e_berserker_level_4.wallDamage,
forceBack:0,forceLift:1,forceRadial:1,forceTangential:0,friendlyFire:0.2,radius:2.5,isExplosion:!0});A.archetypes.dg_e_berserker_explode_level_5=A.create("Berserker Explosion",{damage:e.balanceEnemies.a_e_berserker_level_5.damage,buildingDamage:e.balanceEnemies.a_e_berserker_level_5.buildingDamage,wallDamage:e.balanceEnemies.a_e_berserker_level_5.wallDamage,forceBack:0,forceLift:1,forceRadial:1,forceTangential:0,friendlyFire:0.2,radius:2.5,isExplosion:!0});A.archetypes.dg_e_berserker_explode_level_6=
A.create("Berserker Explosion",{damage:e.balanceEnemies.a_e_berserker_level_6.damage,buildingDamage:e.balanceEnemies.a_e_berserker_level_6.buildingDamage,wallDamage:e.balanceEnemies.a_e_berserker_level_6.wallDamage,forceBack:0,forceLift:1,forceRadial:1,forceTangential:0,friendlyFire:0.2,radius:2.5,isExplosion:!0});A.archetypes.dg_e_berserker_explode_level_7=A.create("Berserker Explosion",{damage:e.balanceEnemies.a_e_berserker_level_7.damage,buildingDamage:e.balanceEnemies.a_e_berserker_level_7.buildingDamage,
wallDamage:e.balanceEnemies.a_e_berserker_level_7.wallDamage,forceBack:0,forceLift:1,forceRadial:1,forceTangential:0,friendlyFire:0.2,radius:2.5,isExplosion:!0});A.archetypes.dg_e_berserker_explode_level_8=A.create("Berserker Explosion",{damage:e.balanceEnemies.a_e_berserker_level_8.damage,buildingDamage:e.balanceEnemies.a_e_berserker_level_8.buildingDamage,wallDamage:e.balanceEnemies.a_e_berserker_level_8.wallDamage,forceBack:0,forceLift:1,forceRadial:1,forceTangential:0,friendlyFire:0.2,radius:2.5,
isExplosion:!0});e.archetypes.a_e_bombthrower_level_1={shouldPlayerSave:!1,familyName:"bombthrower",ECMesh:{scale:1,path:"characters/models/c_bomber.dae",localOffset:[0,0,0],offsetY:-0.7},ECPhysicsSphere:{radius:0.4,usesGravity:!0,canClimb:!0,frictionType:qa.frictionType.CHARACTER,mass:50,height:0.8},ECFirearm:{},ECHealth:{health:e.balanceEnemies.a_e_bombthrower_level_1.health,barLevel:1,drawInWorldBarIfDamagedRecently:!0},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_bombthrower_level_1.speed,fastSpeed:e.balanceEnemies.a_e_bombthrower_level_1.speed,
angleLerpFactor:0.5},ECAgent:{aggro:0,actions:[{name:"AIActionRangedAttack",numberOfProjectiles:1,aimDuration:0.5},{name:"AIActionMoveIntoFirearmRange",initiativeDuration:0},"AIActionChooseRangedTarget"],xp:e.balanceEnemies.a_e_bombthrower_level_1.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_bombthrower_level_1.importantBuildingDamageLimit,iconSpritePath:"textures/enemy_bomb_thrower.dds",displayNameTextId:"ENEMY_DISPLAY_NAME_BOMB_THROWER"},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_bombthrower_level_1.drops},
ECNav:e.EC_DEFAULT,ECInventory:{weapon:"wp_e_bombs_level_1"},ECExplode:{damageType:"dg_e_bomb_explode_level_1",explodeOnDeath:!0,sfxArchetype:"sfx_explosion"},ECFaction:e.EC_DEFAULT,ECSelectable:{radiusFactor:2,smart:!1},ECTarget:e.EC_DEFAULT,ECEffectSpawner:{impactEffect:"sfx_hit_e_bombthrower",onDestroyEffect:"dfx_dth_e_generic"}};e.archetypes.a_e_bombthrower_level_2={parent:"a_e_bombthrower_level_1",shouldPlayerSave:!1,familyName:"bombthrower",ECMesh:{scale:1,path:"characters/models/c_bomber_level02.dae",
localOffset:[0,0,0],offsetY:-0.7},ECHealth:{health:e.balanceEnemies.a_e_bombthrower_level_2.health,barLevel:2},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_bombthrower_level_2.speed,fastSpeed:e.balanceEnemies.a_e_bombthrower_level_2.speed},ECAgent:{xp:e.balanceEnemies.a_e_bombthrower_level_2.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_bombthrower_level_2.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_bombthrower_level_2.drops},ECInventory:{weapon:"wp_e_bombs_level_2"},
ECExplode:{damageType:"dg_e_bomb_explode_level_2"}};e.archetypes.a_e_bombthrower_level_3={parent:"a_e_bombthrower_level_2",shouldPlayerSave:!1,familyName:"bombthrower",ECMesh:{scale:1,path:"characters/models/c_bomber_level03.dae",localOffset:[0,0,0],offsetY:-0.7},ECHealth:{health:e.balanceEnemies.a_e_bombthrower_level_3.health,barLevel:3},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_bombthrower_level_3.speed,fastSpeed:e.balanceEnemies.a_e_bombthrower_level_3.speed},ECAgent:{xp:e.balanceEnemies.a_e_bombthrower_level_3.xp,
importantBuildingDamageLimit:e.balanceEnemies.a_e_bombthrower_level_3.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_bombthrower_level_3.drops},ECInventory:{weapon:"wp_e_bombs_level_3"},ECExplode:{damageType:"dg_e_bomb_explode_level_3"}};e.archetypes.a_e_bombthrower_level_4={parent:"a_e_bombthrower_level_3",shouldPlayerSave:!1,familyName:"bombthrower",ECMesh:{scale:1,path:"characters/models/c_bomber_level04.dae",localOffset:[0,0,0],offsetY:-0.7},ECHealth:{health:e.balanceEnemies.a_e_bombthrower_level_4.health,
barLevel:4},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_bombthrower_level_4.speed,fastSpeed:e.balanceEnemies.a_e_bombthrower_level_4.speed},ECAgent:{xp:e.balanceEnemies.a_e_bombthrower_level_4.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_bombthrower_level_4.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_bombthrower_level_4.drops},ECInventory:{weapon:"wp_e_bombs_level_4"},ECExplode:{damageType:"dg_e_bomb_explode_level_4"}};e.archetypes.a_e_bombthrower_level_5=
{parent:"a_e_bombthrower_level_4",shouldPlayerSave:!1,familyName:"bombthrower",ECMesh:{scale:1,path:"characters/models/c_bomber_level05.dae",localOffset:[0,0,0],offsetY:-0.7},ECHealth:{health:e.balanceEnemies.a_e_bombthrower_level_5.health,barLevel:5},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_bombthrower_level_5.speed,fastSpeed:e.balanceEnemies.a_e_bombthrower_level_5.speed},ECAgent:{xp:e.balanceEnemies.a_e_bombthrower_level_5.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_bombthrower_level_5.importantBuildingDamageLimit},
ECLootDropper:{coinGroups:e.balanceEnemies.a_e_bombthrower_level_5.drops},ECInventory:{weapon:"wp_e_bombs_level_5"},ECExplode:{damageType:"dg_e_bomb_explode_level_5"}};e.archetypes.a_e_bombthrower_level_6={parent:"a_e_bombthrower_level_5",shouldPlayerSave:!1,familyName:"bombthrower",ECMesh:{scale:1.2,path:"characters/models/c_bomber_level05.dae",localOffset:[0,0,0],offsetY:-0.7},ECHealth:{health:e.balanceEnemies.a_e_bombthrower_level_6.health,barLevel:6},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_bombthrower_level_6.speed,
fastSpeed:e.balanceEnemies.a_e_bombthrower_level_6.speed},ECAgent:{xp:e.balanceEnemies.a_e_bombthrower_level_6.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_bombthrower_level_6.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_bombthrower_level_6.drops},ECInventory:{weapon:"wp_e_bombs_level_6"},ECExplode:{damageType:"dg_e_bomb_explode_level_6"}};e.archetypes.a_e_bombthrower_level_7={parent:"a_e_bombthrower_level_6",shouldPlayerSave:!1,familyName:"bombthrower",ECMesh:{scale:1.4,
path:"characters/models/c_bomber_level05.dae",localOffset:[0,0,0],offsetY:-0.7},ECHealth:{health:e.balanceEnemies.a_e_bombthrower_level_7.health,barLevel:7},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_bombthrower_level_7.speed,fastSpeed:e.balanceEnemies.a_e_bombthrower_level_7.speed},ECAgent:{xp:e.balanceEnemies.a_e_bombthrower_level_7.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_bombthrower_level_7.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_bombthrower_level_7.drops},
ECInventory:{weapon:"wp_e_bombs_level_7"},ECExplode:{damageType:"dg_e_bomb_explode_level_7"}};e.archetypes.a_e_bombthrower_level_8={parent:"a_e_bombthrower_level_7",shouldPlayerSave:!1,familyName:"bombthrower",ECMesh:{scale:1.6,path:"characters/models/c_bomber_level05.dae",localOffset:[0,0,0],offsetY:-0.7},ECHealth:{health:e.balanceEnemies.a_e_bombthrower_level_8.health,barLevel:8},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_bombthrower_level_8.speed,fastSpeed:e.balanceEnemies.a_e_bombthrower_level_8.speed},
ECAgent:{xp:e.balanceEnemies.a_e_bombthrower_level_8.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_bombthrower_level_8.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_bombthrower_level_8.drops},ECInventory:{weapon:"wp_e_bombs_level_8"},ECExplode:{damageType:"dg_e_bomb_explode_level_8"}};ba.archetypes.wp_e_bombs_level_1={projectileType:"pj_e_bomb_level_1",fireSound:"dartFly",cockSound:"pistolcock",reloadSound:"pistolreload",dryFireSound:"pistoldryfire",meshPath:"characters/models/dynamite.dae",
meshScale:1.5,reloadDuration:2,rechamberDuration:0,minRange:0,clipSize:1,maxRange:7.5,randomSpreadAngle:5};ba.archetypes.wp_e_bombs_level_2={projectileType:"pj_e_bomb_level_2",fireSound:"dartFly",cockSound:"pistolcock",reloadSound:"pistolreload",dryFireSound:"pistoldryfire",meshPath:"characters/models/dynamite.dae",meshScale:1.5,reloadDuration:2,rechamberDuration:0,minRange:0,clipSize:1,maxRange:7.5,randomSpreadAngle:5};ba.archetypes.wp_e_bombs_level_3={projectileType:"pj_e_bomb_level_3",fireSound:"dartFly",
cockSound:"pistolcock",reloadSound:"pistolreload",dryFireSound:"pistoldryfire",meshPath:"characters/models/dynamite.dae",meshScale:1.5,reloadDuration:2,rechamberDuration:0,minRange:0,clipSize:1,maxRange:7.5,randomSpreadAngle:5};ba.archetypes.wp_e_bombs_level_4={projectileType:"pj_e_bomb_level_4",fireSound:"dartFly",cockSound:"pistolcock",reloadSound:"pistolreload",dryFireSound:"pistoldryfire",meshPath:"characters/models/dynamite.dae",meshScale:1.5,reloadDuration:2,rechamberDuration:0,minRange:0,clipSize:1,
maxRange:7.5,randomSpreadAngle:5};ba.archetypes.wp_e_bombs_level_5={projectileType:"pj_e_bomb_level_5",fireSound:"dartFly",cockSound:"pistolcock",reloadSound:"pistolreload",dryFireSound:"pistoldryfire",meshPath:"characters/models/dynamite.dae",meshScale:1.5,reloadDuration:2,rechamberDuration:0,minRange:0,clipSize:1,maxRange:7.5,randomSpreadAngle:5};ba.archetypes.wp_e_bombs_level_6={projectileType:"pj_e_bomb_level_6",fireSound:"dartFly",cockSound:"pistolcock",reloadSound:"pistolreload",dryFireSound:"pistoldryfire",
meshPath:"characters/models/dynamite.dae",meshScale:1.5,reloadDuration:2,rechamberDuration:0,minRange:0,clipSize:1,maxRange:7.5,randomSpreadAngle:5};ba.archetypes.wp_e_bombs_level_7={projectileType:"pj_e_bomb_level_7",fireSound:"dartFly",cockSound:"pistolcock",reloadSound:"pistolreload",dryFireSound:"pistoldryfire",meshPath:"characters/models/dynamite.dae",meshScale:1.5,reloadDuration:2,rechamberDuration:0,minRange:0,clipSize:1,maxRange:7.5,randomSpreadAngle:5};ba.archetypes.wp_e_bombs_level_8={projectileType:"pj_e_bomb_level_8",
fireSound:"dartFly",cockSound:"pistolcock",reloadSound:"pistolreload",dryFireSound:"pistoldryfire",meshPath:"characters/models/dynamite.dae",meshScale:1.5,reloadDuration:2,rechamberDuration:0,minRange:0,clipSize:1,maxRange:7.5,randomSpreadAngle:5};e.archetypes.pj_e_bomb_level_1={shouldPlayerSave:!1,ECMesh:{path:"characters/models/dynamite.dae",scale:2},ECProjectile:{speed:3,usesGravity:!0,damageType:"dg_e_bomb_explode_level_1",rotationSpeed:2,hitEffect:"sfx_explosion_dc",hurtEffect:"sfx_explosion"},
ECEffectSpawner:{ambientEffect:"sfx_amb_dynamite"}};e.archetypes.pj_e_bomb_level_2={parent:"pj_e_bomb_level_1",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_bomb_explode_level_2"}};e.archetypes.pj_e_bomb_level_3={parent:"pj_e_bomb_level_2",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_bomb_explode_level_3"}};e.archetypes.pj_e_bomb_level_4={parent:"pj_e_bomb_level_3",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_bomb_explode_level_4"}};e.archetypes.pj_e_bomb_level_5={parent:"pj_e_bomb_level_4",
shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_bomb_explode_level_5"}};e.archetypes.pj_e_bomb_level_6={parent:"pj_e_bomb_level_5",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_bomb_explode_level_6"}};e.archetypes.pj_e_bomb_level_7={parent:"pj_e_bomb_level_6",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_bomb_explode_level_7"}};e.archetypes.pj_e_bomb_level_8={parent:"pj_e_bomb_level_7",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_bomb_explode_level_8"}};A.archetypes.dg_e_bomb_explode_level_1=
A.create("Bomb Explosion",{damage:e.balanceEnemies.a_e_bombthrower_level_1.damage,buildingDamage:e.balanceEnemies.a_e_bombthrower_level_1.buildingDamage,wallDamage:e.balanceEnemies.a_e_bombthrower_level_1.wallDamage,forceBack:0,forceLift:0.5,forceRadial:0.5,forceTangential:0,radius:1.5,isExplosion:!0,friendlyFire:0});A.archetypes.dg_e_bomb_explode_level_2=A.create("Bomb Explosion",{damage:e.balanceEnemies.a_e_bombthrower_level_2.damage,buildingDamage:e.balanceEnemies.a_e_bombthrower_level_2.buildingDamage,
wallDamage:e.balanceEnemies.a_e_bombthrower_level_2.wallDamage,forceBack:0,forceLift:0.5,forceRadial:0.5,forceTangential:0,radius:1.5,isExplosion:!0,friendlyFire:0});A.archetypes.dg_e_bomb_explode_level_3=A.create("Bomb Explosion",{damage:e.balanceEnemies.a_e_bombthrower_level_3.damage,buildingDamage:e.balanceEnemies.a_e_bombthrower_level_3.buildingDamage,wallDamage:e.balanceEnemies.a_e_bombthrower_level_3.wallDamage,forceBack:0,forceLift:0.5,forceRadial:0.5,forceTangential:0,radius:1.5,isExplosion:!0,
friendlyFire:0});A.archetypes.dg_e_bomb_explode_level_4=A.create("Bomb Explosion",{damage:e.balanceEnemies.a_e_bombthrower_level_4.damage,buildingDamage:e.balanceEnemies.a_e_bombthrower_level_4.buildingDamage,wallDamage:e.balanceEnemies.a_e_bombthrower_level_4.wallDamage,forceBack:0,forceLift:0.5,forceRadial:0.5,forceTangential:0,radius:1.5,isExplosion:!0,friendlyFire:0});A.archetypes.dg_e_bomb_explode_level_5=A.create("Bomb Explosion",{damage:e.balanceEnemies.a_e_bombthrower_level_5.damage,buildingDamage:e.balanceEnemies.a_e_bombthrower_level_5.buildingDamage,
wallDamage:e.balanceEnemies.a_e_bombthrower_level_5.wallDamage,forceBack:0,forceLift:0.5,forceRadial:0.5,forceTangential:0,radius:1.5,isExplosion:!0,friendlyFire:0});A.archetypes.dg_e_bomb_explode_level_6=A.create("Bomb Explosion",{damage:e.balanceEnemies.a_e_bombthrower_level_6.damage,buildingDamage:e.balanceEnemies.a_e_bombthrower_level_6.buildingDamage,wallDamage:e.balanceEnemies.a_e_bombthrower_level_6.wallDamage,forceBack:0,forceLift:0.5,forceRadial:0.5,forceTangential:0,radius:1.5,isExplosion:!0,
friendlyFire:0});A.archetypes.dg_e_bomb_explode_level_7=A.create("Bomb Explosion",{damage:e.balanceEnemies.a_e_bombthrower_level_7.damage,buildingDamage:e.balanceEnemies.a_e_bombthrower_level_7.buildingDamage,wallDamage:e.balanceEnemies.a_e_bombthrower_level_7.wallDamage,forceBack:0,forceLift:0.5,forceRadial:0.5,forceTangential:0,radius:1.5,isExplosion:!0,friendlyFire:0});A.archetypes.dg_e_bomb_explode_level_8=A.create("Bomb Explosion",{damage:e.balanceEnemies.a_e_bombthrower_level_8.damage,buildingDamage:e.balanceEnemies.a_e_bombthrower_level_8.buildingDamage,
wallDamage:e.balanceEnemies.a_e_bombthrower_level_8.wallDamage,forceBack:0,forceLift:0.5,forceRadial:0.5,forceTangential:0,radius:1.5,isExplosion:!0,friendlyFire:0});e.archetypes.a_e_charger_level_1={shouldPlayerSave:!1,familyName:"charger",ECMesh:{scale:1,path:"characters/models/c_trampler.dae",localOffset:[0,0,0],offsetY:-0.6},ECPhysicsSphere:{radius:0.4,usesGravity:!0,canClimb:!0,frictionType:qa.frictionType.CHARACTER,mass:100,height:0.8},ECHealth:{health:e.balanceEnemies.a_e_charger_level_1.health,
barLevel:1,drawInWorldBarIfDamagedRecently:!0},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_charger_level_1.speed,fastSpeed:e.balanceEnemies.a_e_charger_level_1.speed,angleLerpFactor:0.5},ECAgent:{aggro:0,actions:["AIActionMeleeAttack",{name:"AIActionMoveIntoMeleeRange",initiativeDuration:0.1},"AIActionChooseMeleeTarget"],crashIntoSolidObjectStunDuration:1,priorityTargetType:"Heroes",shouldAggroWhenAttacked:!1,xp:e.balanceEnemies.a_e_charger_level_1.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_charger_level_1.importantBuildingDamageLimit,
iconSpritePath:"textures/enemy_charger.dds",displayNameTextId:"ENEMY_DISPLAY_NAME_CHARGER"},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_charger_level_1.drops},ECMelee:{attackDuration:0.8,chargeDuration:0,attackRange:7,attackAngle:360,attackType:"MeleeCharge",needsNavLOS:!0,attackParameters:{chargeSpeedMod:3,chargeDistance:20,leanDuration:0.6,recoveryDuration:1},damageType:"dg_e_charger_charge_level_1",beginAttackSound:"roar",attackImpactSound:"punch"},ECNav:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,
ECSelectable:{radiusFactor:2,smart:!1},ECTarget:e.EC_DEFAULT,ECEffectSpawner:{impactEffect:"sfx_hit_e_charger",onDestroyEffect:"dfx_dth_e_generic"}};e.archetypes.a_e_charger_level_2={parent:"a_e_charger_level_1",shouldPlayerSave:!1,familyName:"charger",ECMesh:{scale:1,path:"characters/models/c_trampler_level02.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_charger_level_2.health,barLevel:2},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_charger_level_2.speed,fastSpeed:e.balanceEnemies.a_e_charger_level_2.speed},
ECAgent:{xp:e.balanceEnemies.a_e_charger_level_2.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_charger_level_2.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_charger_level_2.drops},ECMelee:{damageType:"dg_e_charger_charge_level_2"}};e.archetypes.a_e_charger_level_3={parent:"a_e_charger_level_2",shouldPlayerSave:!1,familyName:"charger",ECMesh:{scale:1,path:"characters/models/c_trampler_level03.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_charger_level_3.health,
barLevel:3},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_charger_level_3.speed,fastSpeed:e.balanceEnemies.a_e_charger_level_3.speed},ECAgent:{xp:e.balanceEnemies.a_e_charger_level_3.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_charger_level_3.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_charger_level_3.drops},ECMelee:{damageType:"dg_e_charger_charge_level_3"}};e.archetypes.a_e_charger_level_4={parent:"a_e_charger_level_3",shouldPlayerSave:!1,familyName:"charger",
ECHealth:{health:e.balanceEnemies.a_e_charger_level_4.health,barLevel:4},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_charger_level_4.speed,fastSpeed:e.balanceEnemies.a_e_charger_level_4.speed},ECAgent:{xp:e.balanceEnemies.a_e_charger_level_4.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_charger_level_4.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_charger_level_4.drops},ECMelee:{damageType:"dg_e_charger_charge_level_4"}};e.archetypes.a_e_charger_level_5={parent:"a_e_charger_level_4",
shouldPlayerSave:!1,familyName:"charger",ECMesh:{scale:1,path:"characters/models/c_trampler_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_charger_level_5.health,barLevel:5},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_charger_level_5.speed,fastSpeed:e.balanceEnemies.a_e_charger_level_5.speed},ECAgent:{xp:e.balanceEnemies.a_e_charger_level_5.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_charger_level_5.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_charger_level_5.drops},
ECMelee:{damageType:"dg_e_charger_charge_level_5"}};e.archetypes.a_e_charger_level_6={parent:"a_e_charger_level_5",shouldPlayerSave:!1,familyName:"charger",ECMesh:{scale:1.2,path:"characters/models/c_trampler_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_charger_level_6.health,barLevel:6},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_charger_level_6.speed,fastSpeed:e.balanceEnemies.a_e_charger_level_6.speed},ECAgent:{xp:e.balanceEnemies.a_e_charger_level_6.xp,
importantBuildingDamageLimit:e.balanceEnemies.a_e_charger_level_6.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_charger_level_6.drops},ECMelee:{damageType:"dg_e_charger_charge_level_6"}};e.archetypes.a_e_charger_level_7={parent:"a_e_charger_level_6",shouldPlayerSave:!1,familyName:"charger",ECMesh:{scale:1.4,path:"characters/models/c_trampler_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_charger_level_7.health,barLevel:7},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_charger_level_7.speed,
fastSpeed:e.balanceEnemies.a_e_charger_level_7.speed},ECAgent:{xp:e.balanceEnemies.a_e_charger_level_7.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_charger_level_7.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_charger_level_7.drops},ECMelee:{damageType:"dg_e_charger_charge_level_7"}};e.archetypes.a_e_charger_level_8={parent:"a_e_charger_level_7",shouldPlayerSave:!1,familyName:"charger",ECMesh:{scale:1.6,path:"characters/models/c_trampler_level05.dae",localOffset:[0,
0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_charger_level_8.health,barLevel:5},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_charger_level_8.speed,fastSpeed:e.balanceEnemies.a_e_charger_level_8.speed},ECAgent:{xp:e.balanceEnemies.a_e_charger_level_8.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_charger_level_8.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_charger_level_8.drops},ECMelee:{damageType:"dg_e_charger_charge_level_8"}};A.archetypes.dg_e_charger_charge_level_1=
A.create("Charger Charge Attack",{damage:e.balanceEnemies.a_e_charger_level_1.damage,buildingDamage:e.balanceEnemies.a_e_charger_level_1.buildingDamage,wallDamage:e.balanceEnemies.a_e_charger_level_1.wallDamage,forceBack:0.5,forceLift:0.5,forceRadial:0.5,forceTangential:0,radius:1.7,friendlyFire:0.25,stunDuration:2});A.archetypes.dg_e_charger_charge_level_2=A.create("Charger Charge Attack",{damage:e.balanceEnemies.a_e_charger_level_2.damage,buildingDamage:e.balanceEnemies.a_e_charger_level_2.buildingDamage,
wallDamage:e.balanceEnemies.a_e_charger_level_2.wallDamage,forceBack:0.5,forceLift:0.5,forceRadial:0.5,forceTangential:0,radius:1.7,friendlyFire:0.25,stunDuration:2});A.archetypes.dg_e_charger_charge_level_3=A.create("Charger Charge Attack",{damage:e.balanceEnemies.a_e_charger_level_3.damage,buildingDamage:e.balanceEnemies.a_e_charger_level_3.buildingDamage,wallDamage:e.balanceEnemies.a_e_charger_level_3.wallDamage,forceBack:0.5,forceLift:0.5,forceRadial:0.5,forceTangential:0,radius:1.7,friendlyFire:0.25,
stunDuration:2});A.archetypes.dg_e_charger_charge_level_4=A.create("Charger Charge Attack",{damage:e.balanceEnemies.a_e_charger_level_4.damage,buildingDamage:e.balanceEnemies.a_e_charger_level_4.buildingDamage,wallDamage:e.balanceEnemies.a_e_charger_level_4.wallDamage,forceBack:0.5,forceLift:0.5,forceRadial:0.5,forceTangential:0,radius:1.7,friendlyFire:0.25,stunDuration:2});A.archetypes.dg_e_charger_charge_level_5=A.create("Charger Charge Attack",{damage:e.balanceEnemies.a_e_charger_level_5.damage,
buildingDamage:e.balanceEnemies.a_e_charger_level_5.buildingDamage,wallDamage:e.balanceEnemies.a_e_charger_level_5.wallDamage,forceBack:0.5,forceLift:0.5,forceRadial:0.5,forceTangential:0,radius:1.7,friendlyFire:0.25,stunDuration:2});A.archetypes.dg_e_charger_charge_level_6=A.create("Charger Charge Attack",{damage:e.balanceEnemies.a_e_charger_level_6.damage,buildingDamage:e.balanceEnemies.a_e_charger_level_6.buildingDamage,wallDamage:e.balanceEnemies.a_e_charger_level_6.wallDamage,forceBack:0.5,forceLift:0.5,
forceRadial:0.5,forceTangential:0,radius:1.7,friendlyFire:0.25,stunDuration:2});A.archetypes.dg_e_charger_charge_level_7=A.create("Charger Charge Attack",{damage:e.balanceEnemies.a_e_charger_level_7.damage,buildingDamage:e.balanceEnemies.a_e_charger_level_7.buildingDamage,wallDamage:e.balanceEnemies.a_e_charger_level_7.wallDamage,forceBack:0.5,forceLift:0.5,forceRadial:0.5,forceTangential:0,radius:1.7,friendlyFire:0.25,stunDuration:2});A.archetypes.dg_e_charger_charge_level_8=A.create("Charger Charge Attack",
{damage:e.balanceEnemies.a_e_charger_level_8.damage,buildingDamage:e.balanceEnemies.a_e_charger_level_8.buildingDamage,wallDamage:e.balanceEnemies.a_e_charger_level_8.wallDamage,forceBack:0.5,forceLift:0.5,forceRadial:0.5,forceTangential:0,radius:1.7,friendlyFire:0.25,stunDuration:2});e.archetypes.a_e_mini_charger_level_1={shouldPlayerSave:!1,familyName:"mini_charger",ECMesh:{scale:1,path:"characters/models/c_mini_charger.dae",localOffset:[0,0,0],offsetY:-0.6},ECPhysicsSphere:{radius:0.4,usesGravity:!0,
canClimb:!0,frictionType:qa.frictionType.CHARACTER,mass:50,height:0.8},ECHealth:{health:e.balanceEnemies.a_e_mini_charger_level_1.health,barLevel:1,drawInWorldBarIfDamagedRecently:!0},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_mini_charger_level_1.speed,fastSpeed:e.balanceEnemies.a_e_mini_charger_level_1.speed,angleLerpFactor:0.5},ECAgent:{aggro:0,actions:["AIActionMeleeAttack",{name:"AIActionMoveIntoMeleeRange",initiativeDuration:0.1},"AIActionChooseMeleeTarget"],crashIntoSolidObjectStunDuration:1,
xp:e.balanceEnemies.a_e_mini_charger_level_1.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_mini_charger_level_1.importantBuildingDamageLimit,iconGuiArchetype:"miniChargerIcon",iconSpritePath:"textures/enemy_minicharger.dds",displayNameTextId:"ENEMY_DISPLAY_NAME_MINI_CHARGER"},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_mini_charger_level_1.drops},ECMelee:{attackDuration:0.6,chargeDuration:0,attackRange:4,attackAngle:360,attackType:"MeleeCharge",needsNavLOS:!0,attackParameters:{chargeSpeedMod:2.5,
chargeDistance:10,leanDuration:0.5,recoveryDuration:0.7},damageType:"dg_e_mini_charger_charge_level_1",beginAttackSound:"mini_wildling_roar",attackImpactSound:"punch"},ECNav:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECSelectable:{radiusFactor:2,smart:!1},ECTarget:e.EC_DEFAULT,ECEffectSpawner:{impactEffect:"sfx_hit_e_charger",onDestroyEffect:"dfx_dth_e_generic"}};e.archetypes.a_e_mini_charger_level_2={parent:"a_e_mini_charger_level_1",shouldPlayerSave:!1,familyName:"mini_charger",ECMesh:{scale:1,path:"characters/models/c_mini_charger_level02.dae",
localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_mini_charger_level_2.health,barLevel:2},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_mini_charger_level_2.speed,fastSpeed:e.balanceEnemies.a_e_mini_charger_level_2.speed},ECAgent:{xp:e.balanceEnemies.a_e_mini_charger_level_2.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_mini_charger_level_2.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_mini_charger_level_2.drops},ECMelee:{damageType:"dg_e_mini_charger_charge_level_2"}};
e.archetypes.a_e_mini_charger_level_3={parent:"a_e_mini_charger_level_2",shouldPlayerSave:!1,familyName:"mini_charger",ECMesh:{scale:1,path:"characters/models/c_mini_charger_level03.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_mini_charger_level_3.health,barLevel:3},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_mini_charger_level_3.speed,fastSpeed:e.balanceEnemies.a_e_mini_charger_level_3.speed},ECAgent:{xp:e.balanceEnemies.a_e_mini_charger_level_3.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_mini_charger_level_3.importantBuildingDamageLimit},
ECLootDropper:{coinGroups:e.balanceEnemies.a_e_mini_charger_level_3.drops},ECMelee:{damageType:"dg_e_mini_charger_charge_level_3"}};e.archetypes.a_e_mini_charger_level_4={parent:"a_e_mini_charger_level_3",shouldPlayerSave:!1,familyName:"mini_charger",ECMesh:{scale:1,path:"characters/models/c_mini_charger_level04.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_mini_charger_level_4.health,barLevel:4},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_mini_charger_level_4.speed,
fastSpeed:e.balanceEnemies.a_e_mini_charger_level_4.speed},ECAgent:{xp:e.balanceEnemies.a_e_mini_charger_level_4.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_mini_charger_level_4.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_mini_charger_level_4.drops},ECMelee:{damageType:"dg_e_mini_charger_charge_level_4"}};e.archetypes.a_e_mini_charger_level_5={parent:"a_e_mini_charger_level_4",shouldPlayerSave:!1,familyName:"mini_charger",ECMesh:{scale:1,path:"characters/models/c_mini_charger_level05.dae",
localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_mini_charger_level_5.health,barLevel:5},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_mini_charger_level_5.speed,fastSpeed:e.balanceEnemies.a_e_mini_charger_level_5.speed},ECAgent:{xp:e.balanceEnemies.a_e_mini_charger_level_5.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_mini_charger_level_5.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_mini_charger_level_5.drops},ECMelee:{damageType:"dg_e_mini_charger_charge_level_5"}};
e.archetypes.a_e_mini_charger_level_6={parent:"a_e_mini_charger_level_5",shouldPlayerSave:!1,familyName:"mini_charger",ECMesh:{scale:1.2,path:"characters/models/c_mini_charger_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_mini_charger_level_6.health,barLevel:6},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_mini_charger_level_6.speed,fastSpeed:e.balanceEnemies.a_e_mini_charger_level_6.speed},ECAgent:{xp:e.balanceEnemies.a_e_mini_charger_level_6.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_mini_charger_level_6.importantBuildingDamageLimit},
ECLootDropper:{coinGroups:e.balanceEnemies.a_e_mini_charger_level_6.drops},ECMelee:{damageType:"dg_e_mini_charger_charge_level_6"}};e.archetypes.a_e_mini_charger_level_7={parent:"a_e_mini_charger_level_6",shouldPlayerSave:!1,familyName:"mini_charger",ECMesh:{scale:1.4,path:"characters/models/c_mini_charger_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_mini_charger_level_7.health,barLevel:7},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_mini_charger_level_7.speed,
fastSpeed:e.balanceEnemies.a_e_mini_charger_level_7.speed},ECAgent:{xp:e.balanceEnemies.a_e_mini_charger_level_7.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_mini_charger_level_7.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_mini_charger_level_7.drops},ECMelee:{damageType:"dg_e_mini_charger_charge_level_7"}};e.archetypes.a_e_mini_charger_level_8={parent:"a_e_mini_charger_level_7",shouldPlayerSave:!1,familyName:"mini_charger",ECMesh:{scale:1.6,path:"characters/models/c_mini_charger_level05.dae",
localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_mini_charger_level_8.health,barLevel:8},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_mini_charger_level_8.speed,fastSpeed:e.balanceEnemies.a_e_mini_charger_level_8.speed},ECAgent:{xp:e.balanceEnemies.a_e_mini_charger_level_8.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_mini_charger_level_8.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_mini_charger_level_8.drops},ECMelee:{damageType:"dg_e_mini_charger_charge_level_8"}};
A.archetypes.dg_e_mini_charger_charge_level_1=A.create("Mini Charger Charge Attack",{damage:e.balanceEnemies.a_e_mini_charger_level_1.damage,buildingDamage:e.balanceEnemies.a_e_mini_charger_level_1.buildingDamage,wallDamage:e.balanceEnemies.a_e_mini_charger_level_1.wallDamage,forceBack:0.2,forceLift:0.2,forceRadial:0.2,forceTangential:0,radius:1,friendlyFire:0.25,stunDuration:0});A.archetypes.dg_e_mini_charger_charge_level_2=A.create("Mini Charger Charge Attack",{damage:e.balanceEnemies.a_e_mini_charger_level_2.damage,
buildingDamage:e.balanceEnemies.a_e_mini_charger_level_2.buildingDamage,wallDamage:e.balanceEnemies.a_e_mini_charger_level_2.wallDamage,forceBack:0.2,forceLift:0.2,forceRadial:0.2,forceTangential:0,radius:1,friendlyFire:0.25,stunDuration:0});A.archetypes.dg_e_mini_charger_charge_level_3=A.create("Mini Charger Charge Attack",{damage:e.balanceEnemies.a_e_mini_charger_level_3.damage,buildingDamage:e.balanceEnemies.a_e_mini_charger_level_3.buildingDamage,wallDamage:e.balanceEnemies.a_e_mini_charger_level_3.wallDamage,
forceBack:0.2,forceLift:0.2,forceRadial:0.2,forceTangential:0,radius:1,friendlyFire:0.25,stunDuration:0});A.archetypes.dg_e_mini_charger_charge_level_4=A.create("Mini Charger Charge Attack",{damage:e.balanceEnemies.a_e_mini_charger_level_4.damage,buildingDamage:e.balanceEnemies.a_e_mini_charger_level_4.buildingDamage,wallDamage:e.balanceEnemies.a_e_mini_charger_level_4.wallDamage,forceBack:0.2,forceLift:0.2,forceRadial:0.2,forceTangential:0,radius:1,friendlyFire:0.25,stunDuration:0});A.archetypes.dg_e_mini_charger_charge_level_5=
A.create("Mini Charger Charge Attack",{damage:e.balanceEnemies.a_e_mini_charger_level_5.damage,buildingDamage:e.balanceEnemies.a_e_mini_charger_level_5.buildingDamage,wallDamage:e.balanceEnemies.a_e_mini_charger_level_5.wallDamage,forceBack:0.2,forceLift:0.2,forceRadial:0.2,forceTangential:0,radius:1,friendlyFire:0.25,stunDuration:0});A.archetypes.dg_e_mini_charger_charge_level_6=A.create("Mini Charger Charge Attack",{damage:e.balanceEnemies.a_e_mini_charger_level_6.damage,buildingDamage:e.balanceEnemies.a_e_mini_charger_level_6.buildingDamage,
wallDamage:e.balanceEnemies.a_e_mini_charger_level_6.wallDamage,forceBack:0.2,forceLift:0.2,forceRadial:0.2,forceTangential:0,radius:1,friendlyFire:0.25,stunDuration:0});A.archetypes.dg_e_mini_charger_charge_level_7=A.create("Mini Charger Charge Attack",{damage:e.balanceEnemies.a_e_mini_charger_level_7.damage,buildingDamage:e.balanceEnemies.a_e_mini_charger_level_7.buildingDamage,wallDamage:e.balanceEnemies.a_e_mini_charger_level_7.wallDamage,forceBack:0.2,forceLift:0.2,forceRadial:0.2,forceTangential:0,
radius:1,friendlyFire:0.25,stunDuration:0});A.archetypes.dg_e_mini_charger_charge_level_8=A.create("Mini Charger Charge Attack",{damage:e.balanceEnemies.a_e_mini_charger_level_8.damage,buildingDamage:e.balanceEnemies.a_e_mini_charger_level_8.buildingDamage,wallDamage:e.balanceEnemies.a_e_mini_charger_level_8.wallDamage,forceBack:0.2,forceLift:0.2,forceRadial:0.2,forceTangential:0,radius:1,friendlyFire:0.25,stunDuration:0});e.archetypes.a_e_charger_boss_level_1={parent:"a_e_charger_level_1",familyName:"charger_boss",
shouldPlayerSave:!1,ECMesh:{scale:1,path:"characters/models/c_warlord.dae",localOffset:[0,0,0],offsetY:-0.6},ECPhysicsSphere:{mass:500},ECHealth:{health:e.balanceEnemies.a_e_charger_boss_level_1.health,barLevel:1,drawInWorldBar:!0,worldBarRow:-8,healthBarScale:2},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_charger_boss_level_1.speed,fastSpeed:e.balanceEnemies.a_e_charger_boss_level_1.speed},ECAgent:{crashIntoSolidObjectStunDuration:1,xp:e.balanceEnemies.a_e_charger_boss_level_1.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_charger_boss_level_1.importantBuildingDamageLimit,
iconSpritePath:"textures/enemy_boss.dds",displayNameTextId:"ENEMY_DISPLAY_NAME_CHARGER_BOSS"},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_charger_boss_level_1.drops},ECMelee:{attackParameters:{chargeSpeedMod:3.5,chargeDistance:15,leanDuration:1.2,recoveryDuration:1},damageType:"dg_e_charger_boss_charge_level_1",beginAttackSound:"roar",attackImpactSound:"punch"},ECSockets:{stationary:!1,sockets:[{archetypeName:"a_e_charger_boss_turret_level_1",localOffset:[0,2,0]}]},ECEffectSpawner:{impactEffect:"sfx_hit_e_charger",
onDestroyEffect:"dfx_dth_e_generic"}};e.archetypes.a_e_charger_boss_level_2={parent:"a_e_charger_boss_level_1",familyName:"charger_boss",shouldPlayerSave:!1,ECMesh:{scale:1,path:"characters/models/c_warlord_level02.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_charger_boss_level_2.health,barLevel:2},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_charger_boss_level_2.speed,fastSpeed:e.balanceEnemies.a_e_charger_boss_level_2.speed},ECAgent:{xp:e.balanceEnemies.a_e_charger_boss_level_2.xp,
importantBuildingDamageLimit:e.balanceEnemies.a_e_charger_boss_level_2.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_charger_boss_level_2.drops},ECMelee:{damageType:"dg_e_charger_boss_charge_level_2"},ECSockets:{sockets:[{archetypeName:"a_e_charger_boss_turret_level_2",localOffset:[0,2,0]}]}};e.archetypes.a_e_charger_boss_level_3={parent:"a_e_charger_boss_level_2",familyName:"charger_boss",shouldPlayerSave:!1,ECMesh:{scale:1,path:"characters/models/c_warlord_level03.dae",
localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_charger_boss_level_3.health,barLevel:3},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_charger_boss_level_3.speed,fastSpeed:e.balanceEnemies.a_e_charger_boss_level_3.speed},ECAgent:{xp:e.balanceEnemies.a_e_charger_boss_level_3.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_charger_boss_level_3.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_charger_boss_level_3.drops},ECMelee:{damageType:"dg_e_charger_boss_charge_level_3"},
ECSockets:{sockets:[{archetypeName:"a_e_charger_boss_turret_level_3",localOffset:[0,2,0]}]}};e.archetypes.a_e_charger_boss_level_4={parent:"a_e_charger_boss_level_3",familyName:"charger_boss",shouldPlayerSave:!1,ECMesh:{scale:1,path:"characters/models/c_warlord_level04.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_charger_boss_level_4.health,barLevel:4},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_charger_boss_level_4.speed,fastSpeed:e.balanceEnemies.a_e_charger_boss_level_4.speed},
ECAgent:{xp:e.balanceEnemies.a_e_charger_boss_level_4.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_charger_boss_level_4.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_charger_boss_level_4.drops},ECMelee:{damageType:"dg_e_charger_boss_charge_level_4"},ECSockets:{sockets:[{archetypeName:"a_e_charger_boss_turret_level_4",localOffset:[0,2,0]}]}};e.archetypes.a_e_charger_boss_level_5={parent:"a_e_charger_boss_level_4",familyName:"charger_boss",shouldPlayerSave:!1,
ECMesh:{scale:1,path:"characters/models/c_warlord_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_charger_boss_level_5.health,barLevel:5},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_charger_boss_level_5.speed,fastSpeed:e.balanceEnemies.a_e_charger_boss_level_5.speed},ECAgent:{xp:e.balanceEnemies.a_e_charger_boss_level_5.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_charger_boss_level_5.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_charger_boss_level_5.drops},
ECMelee:{damageType:"dg_e_charger_boss_charge_level_5"},ECSockets:{sockets:[{archetypeName:"a_e_charger_boss_turret_level_5",localOffset:[0,2,0]}]}};e.archetypes.a_e_charger_boss_level_6={parent:"a_e_charger_boss_level_5",familyName:"charger_boss",shouldPlayerSave:!1,ECMesh:{scale:1.2,path:"characters/models/c_warlord_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_charger_boss_level_6.health,barLevel:6},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_charger_boss_level_6.speed,
fastSpeed:e.balanceEnemies.a_e_charger_boss_level_6.speed},ECAgent:{xp:e.balanceEnemies.a_e_charger_boss_level_6.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_charger_boss_level_6.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_charger_boss_level_6.drops},ECMelee:{damageType:"dg_e_charger_boss_charge_level_6"},ECSockets:{sockets:[{archetypeName:"a_e_charger_boss_turret_level_6",localOffset:[0,2,0]}]}};e.archetypes.a_e_charger_boss_level_7={parent:"a_e_charger_boss_level_6",
familyName:"charger_boss",shouldPlayerSave:!1,ECMesh:{scale:1.4,path:"characters/models/c_warlord_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_charger_boss_level_7.health,barLevel:7},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_charger_boss_level_7.speed,fastSpeed:e.balanceEnemies.a_e_charger_boss_level_7.speed},ECAgent:{xp:e.balanceEnemies.a_e_charger_boss_level_7.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_charger_boss_level_7.importantBuildingDamageLimit},
ECLootDropper:{coinGroups:e.balanceEnemies.a_e_charger_boss_level_7.drops},ECMelee:{damageType:"dg_e_charger_boss_charge_level_7"},ECSockets:{sockets:[{archetypeName:"a_e_charger_boss_turret_level_7",localOffset:[0,2,0]}]}};e.archetypes.a_e_charger_boss_level_8={parent:"a_e_charger_boss_level_7",familyName:"charger_boss",shouldPlayerSave:!1,ECMesh:{scale:1.6,path:"characters/models/c_warlord_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_charger_boss_level_8.health,
barLevel:8},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_charger_boss_level_8.speed,fastSpeed:e.balanceEnemies.a_e_charger_boss_level_8.speed},ECAgent:{xp:e.balanceEnemies.a_e_charger_boss_level_8.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_charger_boss_level_8.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_charger_boss_level_8.drops},ECMelee:{damageType:"dg_e_charger_boss_charge_level_8"},ECSockets:{sockets:[{archetypeName:"a_e_charger_boss_turret_level_8",
localOffset:[0,2,0]}]}};A.archetypes.dg_e_charger_boss_charge_level_1=A.create("Charger (Boss) Charge Attack",{damage:e.balanceEnemies.a_e_charger_boss_level_1.damage,buildingDamage:e.balanceEnemies.a_e_charger_boss_level_1.buildingDamage,wallDamage:e.balanceEnemies.a_e_charger_boss_level_1.wallDamage,forceBack:1.5,forceLift:1,forceRadial:0.5,forceTangential:0,radius:2,friendlyFire:1,stunDuration:2});A.archetypes.dg_e_charger_boss_charge_level_2=A.create("Charger (Boss) Charge Attack",{damage:e.balanceEnemies.a_e_charger_boss_level_2.damage,
buildingDamage:e.balanceEnemies.a_e_charger_boss_level_2.buildingDamage,wallDamage:e.balanceEnemies.a_e_charger_boss_level_2.wallDamage,forceBack:1.5,forceLift:1,forceRadial:0.5,forceTangential:0,radius:2,friendlyFire:1,stunDuration:2});A.archetypes.dg_e_charger_boss_charge_level_3=A.create("Charger (Boss) Charge Attack",{damage:e.balanceEnemies.a_e_charger_boss_level_3.damage,buildingDamage:e.balanceEnemies.a_e_charger_boss_level_3.buildingDamage,wallDamage:e.balanceEnemies.a_e_charger_boss_level_3.wallDamage,
forceBack:1.5,forceLift:1,forceRadial:0.5,forceTangential:0,radius:2,friendlyFire:1,stunDuration:2});A.archetypes.dg_e_charger_boss_charge_level_4=A.create("Charger (Boss) Charge Attack",{damage:e.balanceEnemies.a_e_charger_boss_level_4.damage,buildingDamage:e.balanceEnemies.a_e_charger_boss_level_4.buildingDamage,wallDamage:e.balanceEnemies.a_e_charger_boss_level_4.wallDamage,forceBack:1.5,forceLift:1,forceRadial:0.5,forceTangential:0,radius:2,friendlyFire:1,stunDuration:2});A.archetypes.dg_e_charger_boss_charge_level_5=
A.create("Charger (Boss) Charge Attack",{damage:e.balanceEnemies.a_e_charger_boss_level_5.damage,buildingDamage:e.balanceEnemies.a_e_charger_boss_level_5.buildingDamage,wallDamage:e.balanceEnemies.a_e_charger_boss_level_5.wallDamage,forceBack:1.5,forceLift:1,forceRadial:0.5,forceTangential:0,radius:2,friendlyFire:1,stunDuration:2});A.archetypes.dg_e_charger_boss_charge_level_6=A.create("Charger (Boss) Charge Attack",{damage:e.balanceEnemies.a_e_charger_boss_level_6.damage,buildingDamage:e.balanceEnemies.a_e_charger_boss_level_6.buildingDamage,
wallDamage:e.balanceEnemies.a_e_charger_boss_level_6.wallDamage,forceBack:1.5,forceLift:1,forceRadial:0.5,forceTangential:0,radius:2,friendlyFire:1,stunDuration:2});A.archetypes.dg_e_charger_boss_charge_level_7=A.create("Charger (Boss) Charge Attack",{damage:e.balanceEnemies.a_e_charger_boss_level_7.damage,buildingDamage:e.balanceEnemies.a_e_charger_boss_level_7.buildingDamage,wallDamage:e.balanceEnemies.a_e_charger_boss_level_7.wallDamage,forceBack:1.5,forceLift:1,forceRadial:0.5,forceTangential:0,
radius:2,friendlyFire:1,stunDuration:2});A.archetypes.dg_e_charger_boss_charge_level_8=A.create("Charger (Boss) Charge Attack",{damage:e.balanceEnemies.a_e_charger_boss_level_8.damage,buildingDamage:e.balanceEnemies.a_e_charger_boss_level_8.buildingDamage,wallDamage:e.balanceEnemies.a_e_charger_boss_level_8.wallDamage,forceBack:1.5,forceLift:1,forceRadial:0.5,forceTangential:0,radius:2,friendlyFire:1,stunDuration:2});e.archetypes.a_e_charger_boss_turret_level_1={shouldPlayerSave:!1,ECMesh:{scale:0,
path:"environment/models/e_b_towertop_level_1.dae",localOffset:[0,-3,0]},ECFirearm:{shootOffset:[0,1,0],weapon:"wp_e_charger_boss_gun01"},ECAgent:{growInitialize:!1,actions:[{name:"AIActionRangedAttack",clearTargetAfterAttack:!0,numberOfProjectiles:1,aimDuration:0.05},{name:"AIActionChooseRangedTarget",maxRange:10,ignorePathing:!0}]},ECFaction:e.EC_DEFAULT};e.archetypes.a_e_charger_boss_turret_level_2={parent:"a_e_charger_boss_turret_level_1",shouldPlayerSave:!1,ECFirearm:{weapon:"wp_e_charger_boss_gun02"}};
e.archetypes.a_e_charger_boss_turret_level_3={parent:"a_e_charger_boss_turret_level_2",shouldPlayerSave:!1,ECFirearm:{weapon:"wp_e_charger_boss_gun03"}};e.archetypes.a_e_charger_boss_turret_level_4={parent:"a_e_charger_boss_turret_level_3",shouldPlayerSave:!1,ECFirearm:{weapon:"wp_e_charger_boss_gun04"}};e.archetypes.a_e_charger_boss_turret_level_5={parent:"a_e_charger_boss_turret_level_4",shouldPlayerSave:!1,ECFirearm:{weapon:"wp_e_charger_boss_gun05"}};e.archetypes.a_e_charger_boss_turret_level_6=
{parent:"a_e_charger_boss_turret_level_5",shouldPlayerSave:!1,ECFirearm:{weapon:"wp_e_charger_boss_gun06"}};e.archetypes.a_e_charger_boss_turret_level_7={parent:"a_e_charger_boss_turret_level_6",shouldPlayerSave:!1,ECFirearm:{weapon:"wp_e_charger_boss_gun07"}};e.archetypes.a_e_charger_boss_turret_level_8={parent:"a_e_charger_boss_turret_level_7",shouldPlayerSave:!1,ECFirearm:{weapon:"wp_e_charger_boss_gun08"}};ba.archetypes.wp_e_charger_boss_gun01={projectileType:"pj_e_charger_boss_gun01",fireSound:"arrowshot",
cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:2,minRange:0,maxRange:10,clipSize:1,rechamberDuration:0,randomSpreadAngle:0};ba.archetypes.wp_e_charger_boss_gun02={projectileType:"pj_e_charger_boss_gun02",fireSound:"arrowshot",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:2,minRange:0,maxRange:10,clipSize:1,rechamberDuration:0,randomSpreadAngle:0};ba.archetypes.wp_e_charger_boss_gun03={projectileType:"pj_e_charger_boss_gun03",
fireSound:"arrowshot",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:2,minRange:0,maxRange:10,clipSize:1,rechamberDuration:0,randomSpreadAngle:0};ba.archetypes.wp_e_charger_boss_gun04={projectileType:"pj_e_charger_boss_gun04",fireSound:"arrowshot",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:2,minRange:0,maxRange:10,clipSize:1,rechamberDuration:0,randomSpreadAngle:0};ba.archetypes.wp_e_charger_boss_gun05={projectileType:"pj_e_charger_boss_gun05",
fireSound:"arrowshot",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:2,minRange:0,maxRange:10,clipSize:1,rechamberDuration:0,randomSpreadAngle:0};ba.archetypes.wp_e_charger_boss_gun06={projectileType:"pj_e_charger_boss_gun06",fireSound:"arrowshot",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:2,minRange:0,maxRange:10,clipSize:1,rechamberDuration:0,randomSpreadAngle:0};ba.archetypes.wp_e_charger_boss_gun07={projectileType:"pj_e_charger_boss_gun07",
fireSound:"arrowshot",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:2,minRange:0,maxRange:10,clipSize:1,rechamberDuration:0,randomSpreadAngle:0};ba.archetypes.wp_e_charger_boss_gun08={projectileType:"pj_e_charger_boss_gun08",fireSound:"arrowshot",cockSound:"pistolcock",reloadSound:"pistolcock",dryFireSound:"pistoldryfire",reloadDuration:2,minRange:0,maxRange:10,clipSize:1,rechamberDuration:0,randomSpreadAngle:0};e.archetypes.pj_e_charger_boss_gun01={shouldPlayerSave:!1,
ECMesh:{path:"characters/models/dynamite.dae",scale:1},ECProjectile:{speed:5,usesGravity:!0,damageType:"dg_e_charger_boss_gun01",hitEffect:"sfx_explosion_dc",hurtEffect:"sfx_explosion",ignoresAllies:!0}};e.archetypes.pj_e_charger_boss_gun02={parent:"pj_e_charger_boss_gun01",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_charger_boss_gun02"}};e.archetypes.pj_e_charger_boss_gun03={parent:"pj_e_charger_boss_gun02",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_charger_boss_gun03"}};e.archetypes.pj_e_charger_boss_gun04=
{parent:"pj_e_charger_boss_gun03",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_charger_boss_gun04"}};e.archetypes.pj_e_charger_boss_gun05={parent:"pj_e_charger_boss_gun04",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_charger_boss_gun05"}};e.archetypes.pj_e_charger_boss_gun06={parent:"pj_e_charger_boss_gun05",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_charger_boss_gun06"}};e.archetypes.pj_e_charger_boss_gun07={parent:"pj_e_charger_boss_gun06",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_charger_boss_gun07"}};
e.archetypes.pj_e_charger_boss_gun08={parent:"pj_e_charger_boss_gun07",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_e_charger_boss_gun08"}};A.archetypes.dg_e_charger_boss_gun01=A.create("dg_e_charger_boss_gun01",{radius:1.5,friendlyFire:1,damage:e.balanceEnemies.a_e_charger_boss_level_1.rangedDamage,forceBack:0.1,forceLift:0,forceRadial:0,forceTangential:0});A.archetypes.dg_e_charger_boss_gun02=A.create("dg_e_charger_boss_gun02",{radius:1.5,friendlyFire:1,damage:e.balanceEnemies.a_e_charger_boss_level_2.rangedDamage,
forceBack:0.1,forceLift:0,forceRadial:0,forceTangential:0});A.archetypes.dg_e_charger_boss_gun03=A.create("dg_e_charger_boss_gun03",{radius:1.5,friendlyFire:1,damage:e.balanceEnemies.a_e_charger_boss_level_3.rangedDamage,forceBack:0.1,forceLift:0,forceRadial:0,forceTangential:0});A.archetypes.dg_e_charger_boss_gun04=A.create("dg_e_charger_boss_gun04",{radius:1.5,friendlyFire:1,damage:e.balanceEnemies.a_e_charger_boss_level_4.rangedDamage,forceBack:0.1,forceLift:0,forceRadial:0,forceTangential:0});
A.archetypes.dg_e_charger_boss_gun05=A.create("dg_e_charger_boss_gun05",{radius:1.5,friendlyFire:1,damage:e.balanceEnemies.a_e_charger_boss_level_5.rangedDamage,forceBack:0.1,forceLift:0,forceRadial:0,forceTangential:0});A.archetypes.dg_e_charger_boss_gun06=A.create("dg_e_charger_boss_gun06",{radius:1.5,friendlyFire:1,damage:e.balanceEnemies.a_e_charger_boss_level_6.rangedDamage,forceBack:0.1,forceLift:0,forceRadial:0,forceTangential:0});A.archetypes.dg_e_charger_boss_gun07=A.create("dg_e_charger_boss_gun07",
{radius:1.5,friendlyFire:1,damage:e.balanceEnemies.a_e_charger_boss_level_7.rangedDamage,forceBack:0.1,forceLift:0,forceRadial:0,forceTangential:0});A.archetypes.dg_e_charger_boss_gun08=A.create("dg_e_charger_boss_gun08",{radius:1.5,friendlyFire:1,damage:e.balanceEnemies.a_e_charger_boss_level_8.rangedDamage,forceBack:0.1,forceLift:0,forceRadial:0,forceTangential:0});e.archetypes.a_e_death={shouldPlayerSave:!1,familyName:"death",ECMesh:{scale:0.85,path:"characters/models/c_death.dae",localOffset:[0,
0,0],offsetY:-0.5},ECPhysicsSphere:{radius:0.4,usesGravity:!0,canClimb:!0,frictionType:qa.frictionType.CHARACTER,mass:500,height:0.8},ECHealth:{health:e.balanceEnemies.a_e_death.health,canTakeDamage:!1,regen:-100,regenDelay:0,drawInWorldBarIfDamagedRecently:!0},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_death.speed,fastSpeed:e.balanceEnemies.a_e_death.speed,angleLerpFactor:0.2,animationRate:0.1},ECAgent:{aggro:0,actions:[{name:"AIActionMeleeAttack",onlyAttackHeroes:!0},{name:"AIActionMoveIntoMeleeRange",
initiativeDuration:0.1},"AIActionChooseMeleeTarget"],priorityTargetType:"Heroes",shouldAggroWhenAttacked:!1,stunnable:!1,xp:e.balanceEnemies.a_e_death.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_death.importantBuildingDamageLimit,iconSpritePath:"textures/enemy_death.dds",displayNameTextId:"ENEMY_DISPLAY_NAME_DEATH"},ECDeathAgent:{minDistanceFromTarget:e.balanceEnemies.a_e_death.minDistanceFromTarget},ECMelee:{attackDuration:0.1,chargeDuration:0.1,attackRange:3,attackAngle:360,attackType:"MeleeSwing",
damageType:"dg_e_death_attack",attackImpactSound:"aud_attack_death"},ECNav:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECEffectSpawner:{ambientEffect:"sfx_amb_e_death",onDeathEffect:"sfx_dth_e_death",incidentalEffect:"sfx_inc_death",incidentalMinTime:0.1,incidentalMaxTime:0.1}};A.archetypes.dg_e_death_attack=A.create("Death Attack",{damage:e.balanceEnemies.a_e_death.damage,buildingDamage:e.balanceEnemies.a_e_death.buildingDamage,wallDamage:e.balanceEnemies.a_e_death.wallDamage,forceBack:0.5,forceLift:0.5,
forceRadial:0.5,forceTangential:0,radius:1.7,friendlyFire:0});e.archetypes.a_e_treasuredropper_level_1={shouldPlayerSave:!1,familyName:"treasuredropper",ECMesh:{scale:1,path:"characters/models/c_tresureling.dae",offsetY:-0.6},ECPhysicsSphere:{radius:0.4,usesGravity:!0,canClimb:!0,frictionType:qa.frictionType.CHARACTER,mass:50,height:0.8},ECHealth:{health:e.balanceEnemies.a_e_treasuredropper_level_1.health,barLevel:1,drawInWorldBarIfDamagedRecently:!0},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_treasuredropper_level_1.speed,
fastSpeed:e.balanceEnemies.a_e_treasuredropper_level_1.speed,angleLerpFactor:0.5},ECAgent:{aggro:0,actions:["AIActionWanderAndEscape"],xp:e.balanceEnemies.a_e_treasuredropper_level_1.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_treasuredropper_level_1.importantBuildingDamageLimit,iconSpritePath:"textures/enemy_treasure_dropper.dds",displayNameTextId:"ENEMY_DISPLAY_NAME_TREASURE_DROPPER"},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_treasuredropper_level_1.drops,lootToDropWhenDamaged:e.balanceEnemies.a_e_treasuredropper_level_1.damageDrops,
numHitsThatDropLoot:3},ECNav:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECSelectable:{radiusFactor:2,smart:!1},ECTarget:e.EC_DEFAULT,ECEffectSpawner:{impactEffect:"sfx_hit_e_treasure",onDestroyEffect:"dfx_dth_e_generic"},ECWorldGui:{onScreenGuiArchetype:"none",offScreenGuiArchetype:"offScreenTreasure",visibleAlways:!0,visibleOnActivated:!1,visibleOnHover:!1}};e.archetypes.a_e_treasuredropper_level_2={parent:"a_e_treasuredropper_level_1",shouldPlayerSave:!1,familyName:"treasuredropper",ECHealth:{health:e.balanceEnemies.a_e_treasuredropper_level_2.health,
barLevel:2},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_treasuredropper_level_2.speed,fastSpeed:e.balanceEnemies.a_e_treasuredropper_level_2.speed},ECAgent:{xp:e.balanceEnemies.a_e_treasuredropper_level_2.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_treasuredropper_level_2.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_treasuredropper_level_2.drops,lootToDropWhenDamaged:e.balanceEnemies.a_e_treasuredropper_level_2.damageDrops,numHitsThatDropLoot:3}};e.archetypes.a_e_treasuredropper_level_3=
{parent:"a_e_treasuredropper_level_2",shouldPlayerSave:!1,familyName:"treasuredropper",ECHealth:{health:e.balanceEnemies.a_e_treasuredropper_level_3.health,barLevel:3},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_treasuredropper_level_3.speed,fastSpeed:e.balanceEnemies.a_e_treasuredropper_level_3.speed},ECAgent:{xp:e.balanceEnemies.a_e_treasuredropper_level_3.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_treasuredropper_level_3.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_treasuredropper_level_3.drops,
lootToDropWhenDamaged:e.balanceEnemies.a_e_treasuredropper_level_3.damageDrops,numHitsThatDropLoot:3}};e.archetypes.a_e_treasuredropper_level_4={parent:"a_e_treasuredropper_level_3",shouldPlayerSave:!1,familyName:"treasuredropper",ECHealth:{health:e.balanceEnemies.a_e_treasuredropper_level_4.health,barLevel:4},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_treasuredropper_level_4.speed,fastSpeed:e.balanceEnemies.a_e_treasuredropper_level_4.speed},ECAgent:{xp:e.balanceEnemies.a_e_treasuredropper_level_4.xp,
importantBuildingDamageLimit:e.balanceEnemies.a_e_treasuredropper_level_4.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_treasuredropper_level_4.drops,lootToDropWhenDamaged:e.balanceEnemies.a_e_treasuredropper_level_4.damageDrops,numHitsThatDropLoot:3}};e.archetypes.a_e_treasuredropper_level_5={parent:"a_e_treasuredropper_level_4",shouldPlayerSave:!1,familyName:"treasuredropper",ECHealth:{health:e.balanceEnemies.a_e_treasuredropper_level_5.health,barLevel:5},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_treasuredropper_level_5.speed,
fastSpeed:e.balanceEnemies.a_e_treasuredropper_level_5.speed},ECAgent:{xp:e.balanceEnemies.a_e_treasuredropper_level_5.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_treasuredropper_level_5.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_treasuredropper_level_5.drops,lootToDropWhenDamaged:e.balanceEnemies.a_e_treasuredropper_level_5.damageDrops,numHitsThatDropLoot:3}};e.archetypes.a_e_treasuredropper_level_6={parent:"a_e_treasuredropper_level_5",shouldPlayerSave:!1,
familyName:"treasuredropper",ECHealth:{health:e.balanceEnemies.a_e_treasuredropper_level_6.health,barLevel:6},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_treasuredropper_level_6.speed,fastSpeed:e.balanceEnemies.a_e_treasuredropper_level_6.speed},ECAgent:{xp:e.balanceEnemies.a_e_treasuredropper_level_6.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_treasuredropper_level_6.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_treasuredropper_level_6.drops,lootToDropWhenDamaged:e.balanceEnemies.a_e_treasuredropper_level_6.damageDrops,
numHitsThatDropLoot:3}};e.archetypes.a_e_treasuredropper_level_7={parent:"a_e_treasuredropper_level_6",shouldPlayerSave:!1,familyName:"treasuredropper",ECHealth:{health:e.balanceEnemies.a_e_treasuredropper_level_7.health,barLevel:7},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_treasuredropper_level_7.speed,fastSpeed:e.balanceEnemies.a_e_treasuredropper_level_7.speed},ECAgent:{xp:e.balanceEnemies.a_e_treasuredropper_level_7.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_treasuredropper_level_7.importantBuildingDamageLimit},
ECLootDropper:{coinGroups:e.balanceEnemies.a_e_treasuredropper_level_7.drops,lootToDropWhenDamaged:e.balanceEnemies.a_e_treasuredropper_level_7.damageDrops,numHitsThatDropLoot:3}};e.archetypes.a_e_treasuredropper_level_8={parent:"a_e_treasuredropper_level_7",shouldPlayerSave:!1,familyName:"treasuredropper",ECHealth:{health:e.balanceEnemies.a_e_treasuredropper_level_8.health,barLevel:8},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_treasuredropper_level_8.speed,fastSpeed:e.balanceEnemies.a_e_treasuredropper_level_8.speed},
ECAgent:{xp:e.balanceEnemies.a_e_treasuredropper_level_8.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_treasuredropper_level_8.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_treasuredropper_level_8.drops,lootToDropWhenDamaged:e.balanceEnemies.a_e_treasuredropper_level_8.damageDrops,numHitsThatDropLoot:3}};e.archetypes.a_e_commando_level_1={shouldPlayerSave:!1,familyName:"commando",ECMesh:{scale:1,path:"characters/models/c_commandoblade.dae",localOffset:[0,0,0],
offsetY:-0.6},ECPhysicsSphere:{radius:0.4,usesGravity:!0,canClimb:!0,frictionType:qa.frictionType.CHARACTER,mass:50,height:0.8},ECHealth:{health:e.balanceEnemies.a_e_commando_level_1.health,barLevel:1,drawInWorldBarIfDamagedRecently:!0},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_commando_level_1.speed,fastSpeed:e.balanceEnemies.a_e_commando_level_1.speed,angleLerpFactor:0.5},ECAgent:{aggro:0,actions:["AIActionMeleeAttack",{name:"AIActionMoveIntoMeleeRange",initiativeDuration:0},"AIActionChooseMeleeTarget"],
priorityTargetType:"HQs",shouldAggroWhenAttacked:!1,xp:e.balanceEnemies.a_e_commando_level_1.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_commando_level_1.importantBuildingDamageLimit,iconSpritePath:"textures/enemy_commando.dds",displayNameTextId:"ENEMY_DISPLAY_NAME_COMMANDO"},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_commando_level_1.drops},ECMelee:{},ECNav:e.EC_DEFAULT,ECInventory:{weapon:"wp_e_commando_sword_level_1"},ECFaction:e.EC_DEFAULT,ECSelectable:{radiusFactor:2,smart:!1},ECTarget:e.EC_DEFAULT,
ECEffectSpawner:{impactEffect:"sfx_hit_e_commando",onDestroyEffect:"dfx_dth_e_generic"}};e.archetypes.a_e_commando_level_2={parent:"a_e_commando_level_1",shouldPlayerSave:!1,familyName:"commando",ECMesh:{scale:1,path:"characters/models/c_commandoblade_level02.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_commando_level_2.health,barLevel:2},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_commando_level_2.speed,fastSpeed:e.balanceEnemies.a_e_commando_level_2.speed},ECAgent:{xp:e.balanceEnemies.a_e_commando_level_2.xp,
importantBuildingDamageLimit:e.balanceEnemies.a_e_commando_level_2.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_commando_level_2.drops},ECInventory:{weapon:"wp_e_commando_sword_level_2"}};e.archetypes.a_e_commando_level_3={parent:"a_e_commando_level_2",shouldPlayerSave:!1,familyName:"commando",ECMesh:{scale:1,path:"characters/models/c_commandoblade_level03.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_commando_level_3.health,barLevel:3},
ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_commando_level_3.speed,fastSpeed:e.balanceEnemies.a_e_commando_level_3.speed},ECAgent:{xp:e.balanceEnemies.a_e_commando_level_3.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_commando_level_3.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_commando_level_3.drops},ECInventory:{weapon:"wp_e_commando_sword_level_3"}};e.archetypes.a_e_commando_level_4={parent:"a_e_commando_level_3",shouldPlayerSave:!1,familyName:"commando",
ECMesh:{scale:1,path:"characters/models/c_commandoblade_level04.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_commando_level_4.health,barLevel:4},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_commando_level_4.speed,fastSpeed:e.balanceEnemies.a_e_commando_level_4.speed},ECAgent:{xp:e.balanceEnemies.a_e_commando_level_4.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_commando_level_4.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_commando_level_4.drops},
ECInventory:{weapon:"wp_e_commando_sword_level_4"}};e.archetypes.a_e_commando_level_5={parent:"a_e_commando_level_4",shouldPlayerSave:!1,familyName:"commando",ECMesh:{scale:1,path:"characters/models/c_commandoblade_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_commando_level_5.health,barLevel:5},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_commando_level_5.speed,fastSpeed:e.balanceEnemies.a_e_commando_level_5.speed},ECAgent:{xp:e.balanceEnemies.a_e_commando_level_5.xp,
importantBuildingDamageLimit:e.balanceEnemies.a_e_commando_level_5.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_commando_level_5.drops},ECInventory:{weapon:"wp_e_commando_sword_level_5"}};e.archetypes.a_e_commando_level_6={parent:"a_e_commando_level_5",shouldPlayerSave:!1,familyName:"commando",ECMesh:{scale:1.2,path:"characters/models/c_commandoblade_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_commando_level_6.health,barLevel:6},
ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_commando_level_6.speed,fastSpeed:e.balanceEnemies.a_e_commando_level_6.speed},ECAgent:{xp:e.balanceEnemies.a_e_commando_level_6.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_commando_level_6.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_commando_level_6.drops},ECInventory:{weapon:"wp_e_commando_sword_level_6"}};e.archetypes.a_e_commando_level_7={parent:"a_e_commando_level_6",shouldPlayerSave:!1,familyName:"commando",
ECMesh:{scale:1.4,path:"characters/models/c_commandoblade_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_commando_level_7.health,barLevel:7},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_commando_level_7.speed,fastSpeed:e.balanceEnemies.a_e_commando_level_7.speed},ECAgent:{xp:e.balanceEnemies.a_e_commando_level_7.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_commando_level_7.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_commando_level_7.drops},
ECInventory:{weapon:"wp_e_commando_sword_level_7"}};e.archetypes.a_e_commando_level_8={parent:"a_e_commando_level_7",shouldPlayerSave:!1,familyName:"commando",ECMesh:{scale:1.6,path:"characters/models/c_commandoblade_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_commando_level_8.health,barLevel:8},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_commando_level_8.speed,fastSpeed:e.balanceEnemies.a_e_commando_level_8.speed},ECAgent:{xp:e.balanceEnemies.a_e_commando_level_8.xp,
importantBuildingDamageLimit:e.balanceEnemies.a_e_commando_level_8.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_commando_level_8.drops},ECInventory:{weapon:"wp_e_commando_sword_level_8"}};ba.archetypes.wp_e_commando_sword_level_1={isMelee:!0,attackDuration:0.25,chargeDuration:0,attackRange:1.5,attackAngle:60,damageType:"dg_e_commando_sword_level_1",beginAttackSound:"battleEffort",attackImpactSound:"punch"};ba.archetypes.wp_e_commando_sword_level_2={isMelee:!0,attackDuration:0.25,
chargeDuration:0,attackRange:1.5,attackAngle:60,damageType:"dg_e_commando_sword_level_2",beginAttackSound:"battleEffort",attackImpactSound:"punch"};ba.archetypes.wp_e_commando_sword_level_3={isMelee:!0,attackDuration:0.25,chargeDuration:0,attackRange:1.5,attackAngle:60,damageType:"dg_e_commando_sword_level_3",beginAttackSound:"battleEffort",attackImpactSound:"punch"};ba.archetypes.wp_e_commando_sword_level_4={isMelee:!0,attackDuration:0.25,chargeDuration:0,attackRange:1.5,attackAngle:60,damageType:"dg_e_commando_sword_level_4",
beginAttackSound:"battleEffort",attackImpactSound:"punch"};ba.archetypes.wp_e_commando_sword_level_5={isMelee:!0,attackDuration:0.25,chargeDuration:0,attackRange:1.5,attackAngle:60,damageType:"dg_e_commando_sword_level_5",beginAttackSound:"battleEffort",attackImpactSound:"punch"};ba.archetypes.wp_e_commando_sword_level_6={isMelee:!0,attackDuration:0.25,chargeDuration:0,attackRange:1.5,attackAngle:60,damageType:"dg_e_commando_sword_level_6",beginAttackSound:"battleEffort",attackImpactSound:"punch"};
ba.archetypes.wp_e_commando_sword_level_7={isMelee:!0,attackDuration:0.25,chargeDuration:0,attackRange:1.5,attackAngle:60,damageType:"dg_e_commando_sword_level_7",beginAttackSound:"battleEffort",attackImpactSound:"punch"};ba.archetypes.wp_e_commando_sword_level_8={isMelee:!0,attackDuration:0.25,chargeDuration:0,attackRange:1.5,attackAngle:60,damageType:"dg_e_commando_sword_level_8",beginAttackSound:"battleEffort",attackImpactSound:"punch"};A.archetypes.dg_e_commando_sword_level_1=A.create("Commando Sword Attack",
{damage:e.balanceEnemies.a_e_commando_level_1.damage,buildingDamage:e.balanceEnemies.a_e_commando_level_1.buildingDamage,wallDamage:e.balanceEnemies.a_e_commando_level_1.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_commando_sword_level_2=A.create("Commando Sword Attack",{damage:e.balanceEnemies.a_e_commando_level_2.damage,buildingDamage:e.balanceEnemies.a_e_commando_level_2.buildingDamage,wallDamage:e.balanceEnemies.a_e_commando_level_2.wallDamage,
forceBack:0.01,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_commando_sword_level_3=A.create("Commando Sword Attack",{damage:e.balanceEnemies.a_e_commando_level_3.damage,buildingDamage:e.balanceEnemies.a_e_commando_level_3.buildingDamage,wallDamage:e.balanceEnemies.a_e_commando_level_3.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_commando_sword_level_4=A.create("Commando Sword Attack",{damage:e.balanceEnemies.a_e_commando_level_4.damage,
buildingDamage:e.balanceEnemies.a_e_commando_level_4.buildingDamage,wallDamage:e.balanceEnemies.a_e_commando_level_4.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_commando_sword_level_5=A.create("Commando Sword Attack",{damage:e.balanceEnemies.a_e_commando_level_5.damage,buildingDamage:e.balanceEnemies.a_e_commando_level_5.buildingDamage,wallDamage:e.balanceEnemies.a_e_commando_level_5.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,
forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_commando_sword_level_6=A.create("Commando Sword Attack",{damage:e.balanceEnemies.a_e_commando_level_6.damage,buildingDamage:e.balanceEnemies.a_e_commando_level_6.buildingDamage,wallDamage:e.balanceEnemies.a_e_commando_level_6.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_commando_sword_level_7=A.create("Commando Sword Attack",{damage:e.balanceEnemies.a_e_commando_level_7.damage,
buildingDamage:e.balanceEnemies.a_e_commando_level_7.buildingDamage,wallDamage:e.balanceEnemies.a_e_commando_level_7.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_commando_sword_level_8=A.create("Commando Sword Attack",{damage:e.balanceEnemies.a_e_commando_level_8.damage,buildingDamage:e.balanceEnemies.a_e_commando_level_8.buildingDamage,wallDamage:e.balanceEnemies.a_e_commando_level_8.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,
forceTangential:0,radius:0,friendlyFire:0});e.archetypes.a_e_thief_level_1={shouldPlayerSave:!1,familyName:"thief",ECMesh:{scale:1,path:"characters/models/c_thief.dae",localOffset:[0,0,0],offsetY:-0.6},ECPhysicsSphere:{radius:0.4,usesGravity:!0,canClimb:!0,frictionType:qa.frictionType.CHARACTER,mass:50,height:0.8},ECHealth:{health:e.balanceEnemies.a_e_thief_level_1.health,barLevel:1,drawInWorldBarIfDamagedRecently:!0},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_thief_level_1.speed,fastSpeed:e.balanceEnemies.a_e_thief_level_1.speed,
angleLerpFactor:0.5},ECAgent:{aggro:0,actions:["AIActionMeleeAttack",{name:"AIActionMoveIntoMeleeRange",initiativeDuration:0},"AIActionChooseMeleeTarget"],priorityTargetType:"Storage",shouldAggroWhenAttacked:!1,xp:e.balanceEnemies.a_e_thief_level_1.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_thief_level_1.importantBuildingDamageLimit,iconSpritePath:"textures/enemy_thief.dds",displayNameTextId:"ENEMY_DISPLAY_NAME_THIEF"},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_thief_level_1.drops},
ECMelee:{},ECNav:e.EC_DEFAULT,ECInventory:{weapon:"wp_e_commando_sword_level_1"},ECFaction:e.EC_DEFAULT,ECSelectable:{radiusFactor:2,smart:!1},ECTarget:e.EC_DEFAULT,ECEffectSpawner:{impactEffect:"sfx_hit_e_basicmelee",onDestroyEffect:"dfx_dth_e_generic"}};e.archetypes.a_e_thief_level_2={parent:"a_e_thief_level_1",shouldPlayerSave:!1,familyName:"thief",ECMesh:{scale:1,path:"characters/models/c_thief_level02.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_thief_level_2.health,
barLevel:2},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_thief_level_2.speed,fastSpeed:e.balanceEnemies.a_e_thief_level_2.speed},ECAgent:{xp:e.balanceEnemies.a_e_thief_level_2.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_thief_level_2.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_thief_level_2.drops},ECInventory:{weapon:"wp_e_commando_sword_level_2"}};e.archetypes.a_e_thief_level_3={parent:"a_e_thief_level_2",shouldPlayerSave:!1,familyName:"thief",ECMesh:{scale:1,
path:"characters/models/c_thief_level03.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_thief_level_3.health,barLevel:3},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_thief_level_3.speed,fastSpeed:e.balanceEnemies.a_e_thief_level_3.speed},ECAgent:{xp:e.balanceEnemies.a_e_thief_level_3.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_thief_level_3.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_thief_level_3.drops},ECInventory:{weapon:"wp_e_commando_sword_level_3"}};
e.archetypes.a_e_thief_level_4={parent:"a_e_thief_level_3",shouldPlayerSave:!1,familyName:"thief",ECMesh:{scale:1,path:"characters/models/c_thief_level04.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_thief_level_4.health,barLevel:4},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_thief_level_4.speed,fastSpeed:e.balanceEnemies.a_e_thief_level_4.speed},ECAgent:{xp:e.balanceEnemies.a_e_thief_level_4.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_thief_level_4.importantBuildingDamageLimit},
ECLootDropper:{coinGroups:e.balanceEnemies.a_e_thief_level_4.drops},ECInventory:{weapon:"wp_e_commando_sword_level_4"}};e.archetypes.a_e_thief_level_5={parent:"a_e_thief_level_4",shouldPlayerSave:!1,familyName:"thief",ECMesh:{scale:1,path:"characters/models/c_thief_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_thief_level_5.health,barLevel:5},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_thief_level_5.speed,fastSpeed:e.balanceEnemies.a_e_thief_level_5.speed},
ECAgent:{xp:e.balanceEnemies.a_e_thief_level_5.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_thief_level_5.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_thief_level_5.drops},ECInventory:{weapon:"wp_e_commando_sword_level_5"}};e.archetypes.a_e_thief_level_6={parent:"a_e_thief_level_5",shouldPlayerSave:!1,familyName:"thief",ECMesh:{scale:1.2,path:"characters/models/c_thief_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_thief_level_6.health,
barLevel:6},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_thief_level_6.speed,fastSpeed:e.balanceEnemies.a_e_thief_level_6.speed},ECAgent:{xp:e.balanceEnemies.a_e_thief_level_6.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_thief_level_6.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_thief_level_6.drops},ECInventory:{weapon:"wp_e_commando_sword_level_6"}};e.archetypes.a_e_thief_level_7={parent:"a_e_thief_level_6",shouldPlayerSave:!1,familyName:"thief",ECMesh:{scale:1.4,
path:"characters/models/c_thief_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_thief_level_7.health,barLevel:7},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_thief_level_7.speed,fastSpeed:e.balanceEnemies.a_e_thief_level_7.speed},ECAgent:{xp:e.balanceEnemies.a_e_thief_level_7.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_thief_level_7.importantBuildingDamageLimit},ECLootDropper:{coinGroups:e.balanceEnemies.a_e_thief_level_7.drops},ECInventory:{weapon:"wp_e_commando_sword_level_7"}};
e.archetypes.a_e_thief_level_8={parent:"a_e_thief_level_7",shouldPlayerSave:!1,familyName:"thief",ECMesh:{scale:1.6,path:"characters/models/c_thief_level05.dae",localOffset:[0,0,0],offsetY:-0.6},ECHealth:{health:e.balanceEnemies.a_e_thief_level_8.health,barLevel:8},ECLocomotion:{normalSpeed:e.balanceEnemies.a_e_thief_level_8.speed,fastSpeed:e.balanceEnemies.a_e_thief_level_8.speed},ECAgent:{xp:e.balanceEnemies.a_e_thief_level_8.xp,importantBuildingDamageLimit:e.balanceEnemies.a_e_thief_level_8.importantBuildingDamageLimit},
ECLootDropper:{coinGroups:e.balanceEnemies.a_e_thief_level_8.drops},ECInventory:{weapon:"wp_e_commando_sword_level_8"}};ba.archetypes.wp_e_commando_sword_level_1={isMelee:!0,attackDuration:0.25,chargeDuration:0.25,attackRange:1.5,attackAngle:60,damageType:"dg_e_commando_sword_level_1",beginAttackSound:"battleEffort",attackImpactSound:"punch"};ba.archetypes.wp_e_commando_sword_level_2={isMelee:!0,attackDuration:0.25,chargeDuration:0.25,attackRange:1.5,attackAngle:60,damageType:"dg_e_commando_sword_level_2",
beginAttackSound:"battleEffort",attackImpactSound:"punch"};ba.archetypes.wp_e_commando_sword_level_3={isMelee:!0,attackDuration:0.25,chargeDuration:0.25,attackRange:1.5,attackAngle:60,damageType:"dg_e_commando_sword_level_3",beginAttackSound:"battleEffort",attackImpactSound:"punch"};ba.archetypes.wp_e_commando_sword_level_4={isMelee:!0,attackDuration:0.25,chargeDuration:0.25,attackRange:1.5,attackAngle:60,damageType:"dg_e_commando_sword_level_4",beginAttackSound:"battleEffort",attackImpactSound:"punch"};
ba.archetypes.wp_e_commando_sword_level_5={isMelee:!0,attackDuration:0.25,chargeDuration:0.25,attackRange:1.5,attackAngle:60,damageType:"dg_e_commando_sword_level_5",beginAttackSound:"battleEffort",attackImpactSound:"punch"};ba.archetypes.wp_e_commando_sword_level_6={isMelee:!0,attackDuration:0.25,chargeDuration:0.25,attackRange:1.5,attackAngle:60,damageType:"dg_e_commando_sword_level_6",beginAttackSound:"battleEffort",attackImpactSound:"punch"};ba.archetypes.wp_e_commando_sword_level_7={isMelee:!0,
attackDuration:0.25,chargeDuration:0.25,attackRange:1.5,attackAngle:60,damageType:"dg_e_commando_sword_level_7",beginAttackSound:"battleEffort",attackImpactSound:"punch"};ba.archetypes.wp_e_commando_sword_level_8={isMelee:!0,attackDuration:0.25,chargeDuration:0.25,attackRange:1.5,attackAngle:60,damageType:"dg_e_commando_sword_level_8",beginAttackSound:"battleEffort",attackImpactSound:"punch"};A.archetypes.dg_e_commando_sword_level_1=A.create("Commando Sword Attack",{damage:e.balanceEnemies.a_e_commando_level_1.damage,
buildingDamage:e.balanceEnemies.a_e_commando_level_1.buildingDamage,wallDamage:e.balanceEnemies.a_e_commando_level_1.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_commando_sword_level_2=A.create("Commando Sword Attack",{damage:e.balanceEnemies.a_e_commando_level_2.damage,buildingDamage:e.balanceEnemies.a_e_commando_level_2.buildingDamage,wallDamage:e.balanceEnemies.a_e_commando_level_2.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,
forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_commando_sword_level_3=A.create("Commando Sword Attack",{damage:e.balanceEnemies.a_e_commando_level_3.damage,buildingDamage:e.balanceEnemies.a_e_commando_level_3.buildingDamage,wallDamage:e.balanceEnemies.a_e_commando_level_3.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_commando_sword_level_4=A.create("Commando Sword Attack",{damage:e.balanceEnemies.a_e_commando_level_4.damage,
buildingDamage:e.balanceEnemies.a_e_commando_level_4.buildingDamage,wallDamage:e.balanceEnemies.a_e_commando_level_4.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_commando_sword_level_5=A.create("Commando Sword Attack",{damage:e.balanceEnemies.a_e_commando_level_5.damage,buildingDamage:e.balanceEnemies.a_e_commando_level_5.buildingDamage,wallDamage:e.balanceEnemies.a_e_commando_level_5.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,
forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_commando_sword_level_6=A.create("Commando Sword Attack",{damage:e.balanceEnemies.a_e_commando_level_6.damage,buildingDamage:e.balanceEnemies.a_e_commando_level_6.buildingDamage,wallDamage:e.balanceEnemies.a_e_commando_level_6.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_commando_sword_level_7=A.create("Commando Sword Attack",{damage:e.balanceEnemies.a_e_commando_level_7.damage,
buildingDamage:e.balanceEnemies.a_e_commando_level_7.buildingDamage,wallDamage:e.balanceEnemies.a_e_commando_level_7.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_e_commando_sword_level_8=A.create("Commando Sword Attack",{damage:e.balanceEnemies.a_e_commando_level_8.damage,buildingDamage:e.balanceEnemies.a_e_commando_level_8.buildingDamage,wallDamage:e.balanceEnemies.a_e_commando_level_8.wallDamage,forceBack:0.01,forceLift:0,forceRadial:0,
forceTangential:0,radius:0,friendlyFire:0});e.archetypes.a_e_dday_melee={shouldPlayerSave:!1,familyName:"tutorialenemy",ECMesh:{scale:1,path:"characters/models/c_basicmelee.dae",localOffset:[0,0,0],offsetY:-0.6},ECPhysicsSphere:{radius:0.4,usesGravity:!0,canClimb:!0,frictionType:qa.frictionType.CHARACTER,mass:50,height:0.8},ECHealth:{health:50,barLevel:1,drawInWorldBarIfDamagedRecently:!0},ECLocomotion:{normalSpeed:5,fastSpeed:5,angleLerpFactor:0.5},ECAgent:{aggro:0,actions:["AIActionMeleeAttack",
{name:"AIActionMoveIntoMeleeRange",initiativeDuration:0,overrideMeleeRange:1},"AIActionChooseMeleeTarget"],xp:5,importantBuildingDamageLimit:-1,iconSpritePath:"textures/enemy_basic_melee.dds",displayNameTextId:"ENEMY_DISPLAY_NAME_BASIC_MELEE"},ECMelee:{},ECNav:e.EC_DEFAULT,ECInventory:{weapon:"wp_e_dday_sword"},ECFaction:e.EC_DEFAULT,ECSelectable:{radiusFactor:2,smart:!1},ECTarget:e.EC_DEFAULT,ECEffectSpawner:{impactEffect:"sfx_hit_e_basicmelee",onDestroyEffect:"dfx_dth_e_generic"}};ba.archetypes.wp_e_dday_sword=
{isMelee:!0,attackDuration:0.2,chargeDuration:0.2,attackRange:2,attackAngle:60,damageType:"dg_e_dday_sword",beginAttackSound:"battleEffort",attackImpactSound:"punch"};A.archetypes.dg_e_dday_sword=A.create("Basic Melee Sword Attack",{damage:1E-8,buildingDamage:1E-8,wallDamage:1E-8,forceBack:0.01,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});e.archetypes.a_e_dday_ranged={shouldPlayerSave:!1,familyName:"tutorialenemy",ECMesh:{scale:1,path:"characters/models/c_basicrange.dae",
localOffset:[0,0,0],offsetY:-0.75},ECPhysicsSphere:{radius:0.4,usesGravity:!0,canClimb:!0,frictionType:qa.frictionType.CHARACTER,mass:50,height:0.4},ECFirearm:{weapon:"wp_e_dday_ranged",shootOffset:[0,-0.4,0.75]},ECHealth:{health:30,barLevel:1,drawInWorldBarIfDamagedRecently:!0},ECLocomotion:{normalSpeed:5,fastSpeed:5,angleLerpFactor:0.5},ECAgent:{aggro:0,actions:[{name:"AIActionRangedAttack",numberOfProjectiles:1,firstShotPerfectAim:!0,aimDuration:0},{name:"AIActionMoveIntoFirearmRange",initiativeDuration:0},
"AIActionChooseRangedTarget"],priorityTargetType:"Heroes",xp:5,importantBuildingDamageLimit:-1,iconSpritePath:"textures/enemy_ranged.dds",displayNameTextId:"ENEMY_DISPLAY_NAME_RANGED"},ECNav:e.EC_DEFAULT,ECInventory:{weapon:"wp_e_dday_ranged"},ECFaction:e.EC_DEFAULT,ECSelectable:{radiusFactor:2,smart:!1},ECTarget:e.EC_DEFAULT,ECEffectSpawner:{impactEffect:"sfx_hit_e_ranged",onDestroyEffect:"dfx_dth_e_generic"}};ba.archetypes.wp_e_dday_ranged={projectileType:"pj_e_dday_ranged",fireSound:"spit",cockSound:"",
reloadSound:"",dryFireSound:"",reloadDuration:1.5,rechamberDuration:1,minRange:0,maxRange:10,maxProjectileRange:20,clipSize:1,randomSpreadAngle:30};e.archetypes.pj_e_dday_ranged={shouldPlayerSave:!1,ECMesh:{path:"characters/models/mucus.dae",scale:2},ECProjectile:{speed:6,damageType:"dg_e_dday_ranged_spit",ignoresAllies:!0,hitSound:"dartHit",hurtSound:"dartHitFlesh"},ECEffectSpawner:{onCreateEffect:void 0,incidentalEffect:"sfx_amb_spit",incidentalMinTime:0,incidentalMaxTime:0.2}};A.archetypes.dg_e_dday_ranged_spit=
A.create("dg_e_dday_ranged_spit",{damage:1E-8,buildingDamage:1E-8,wallDamage:1E-8,forceBack:0.2,forceLift:0.2,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});e.archetypes.a_f_wildling={shouldPlayerSave:!1,familyName:"friendlyWildling",ECMesh:{scale:1,path:"characters/models/c_wildling01.dae",localOffset:[0,0,0],offsetY:-0.4},ECPhysicsSphere:{radius:0.225,usesGravity:!0,canClimb:!0,frictionType:qa.frictionType.CHARACTER,mass:50,height:0.8},ECLocomotion:{normalSpeed:3,fastSpeed:3,animationRate:3,
angleLerpFactor:0.5},ECSelectable:{radiusFactor:1,smart:!0,smartRadiusFactor:1.2},ECGateTriggerer:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECWildlingAgent:{buildingAssistRate:0.1,offlineBuildingAssistRate:0.1,offlineResourcePerMinute:1,offlineMinutesBeforeSleeping:150,recoveryDuration:0,stunnable:!1,actions:["AIActionMoveAwayFromOverlappingScaffold","AIActionHouseUpgrading","AIActionFollowLeader","AIActionSpeedUpScaffold","AIActionPickUpNearbyLumber","AIActionChopTree",{name:"AIActionMoveToLumberDestination",
initiativeDuration:0.5},{name:"AIActionMoveToScaffold",initiativeDuration:0.5},{name:"AIActionMoveToResourceDispenser",initiativeDuration:0.5},{name:"AIActionChooseScaffold",scaffoldType:"normal"},"AIActionChooseTree","AIActionChooseLumberDestination",{name:"AIActionGoHome",initiativeDuration:2}],orders:["Gather Lumber","Gather Stone","Assist With Building","Assist With WarBuilding"]},ECNav:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECResourceCarrier:{maxResource:[10,10],maxUnemcumberedResource:1,resourcesPerBlock:[10,
10]}};e.archetypes.a_f_lumberling={shouldPlayerSave:!1,familyName:"friendlyLumberling",ECMesh:{scale:1,path:"characters/models/c_lumberling.dae",localOffset:[0,0,0],offsetY:-0.6},ECPhysicsSphere:{radius:0.225,usesGravity:!0,canClimb:!0,frictionType:qa.frictionType.CHARACTER,mass:50,height:0.8},ECLocomotion:{normalSpeed:1.5*1.1,fastSpeed:1.5*1.1,animationRate:2.02,angleLerpFactor:0.5},ECSelectable:{radiusFactor:1,smart:!0,smartRadiusFactor:1.2},ECGateTriggerer:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,
ECWildlingAgent:{offlineResourcePerMinute:50/60,offlineMinutesBeforeSleeping:150,onlineResourcePerMinute:50/60,recoveryDuration:0,stunnable:!1,actions:["AIActionMoveAwayFromOverlappingScaffold","AIActionHouseUpgrading","AIActionFollowLeader","AIActionPickUpNearbyLumber","AIActionChopTree",{name:"AIActionMoveToLumberDestination",initiativeDuration:1},{name:"AIActionMoveToResourceDispenser",initiativeDuration:1},"AIActionChooseTree","AIActionChooseLumberDestination",{name:"AIActionGoHome",initiativeDuration:5}],
orders:["Gather Lumber"]},ECNav:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECResourceCarrier:{maxResource:[10,0],maxUnemcumberedResource:10,resourcesPerBlock:[10,0],resourcePerInteract:[0.3,0.3]},ECWorldGui:{text1:"Lumberling",text2:"Level 1",onScreenGuiArchetype:"tipLumberling",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_f_lumberling_level_2={shouldPlayerSave:!1,parent:"a_f_lumberling",ECMesh:{path:"characters/models/c_lumberling_level02.dae"},
ECLocomotion:{normalSpeed:1.5*1.2,fastSpeed:1.5*1.2,animationRate:2.04,angleLerpFactor:0.5},ECWildlingAgent:{offlineResourcePerMinute:100/60,offlineMinutesBeforeSleeping:180,onlineResourcePerMinute:100/60},ECResourceCarrier:{maxResource:[10,0],maxUnemcumberedResource:20,resourcesPerBlock:[10,0]},ECWorldGui:{text2:"Level 2"}};e.archetypes.a_f_lumberling_level_3={shouldPlayerSave:!1,parent:"a_f_lumberling_level_2",ECMesh:{path:"characters/models/c_lumberling_level03.dae"},ECLocomotion:{normalSpeed:1.5*
1.3,fastSpeed:1.5*1.3,animationRate:2.06,angleLerpFactor:0.5},ECWildlingAgent:{offlineResourcePerMinute:2.5,offlineMinutesBeforeSleeping:210,onlineResourcePerMinute:2.5},ECResourceCarrier:{maxResource:[10,0],maxUnemcumberedResource:30,resourcesPerBlock:[10,0]},ECWorldGui:{text2:"Level 3"}};e.archetypes.a_f_lumberling_level_4={shouldPlayerSave:!1,parent:"a_f_lumberling_level_3",ECMesh:{path:"characters/models/c_lumberling_level04.dae"},ECLocomotion:{normalSpeed:1.5*1.4,fastSpeed:1.5*1.4,animationRate:2.08,
angleLerpFactor:0.5},ECWildlingAgent:{offlineResourcePerMinute:200/60,offlineMinutesBeforeSleeping:240,onlineResourcePerMinute:200/60},ECResourceCarrier:{maxResource:[10,0],maxUnemcumberedResource:40,resourcesPerBlock:[10,0]},ECWorldGui:{text2:"Level 4"}};e.archetypes.a_f_lumberling_level_5={shouldPlayerSave:!1,parent:"a_f_lumberling_level_4",ECMesh:{path:"characters/models/c_lumberling_level05.dae"},ECLocomotion:{normalSpeed:2.25,fastSpeed:2.25,animationRate:2.1,angleLerpFactor:0.5},ECWildlingAgent:{offlineResourcePerMinute:250/
60,offlineMinutesBeforeSleeping:480,onlineResourcePerMinute:250/60},ECResourceCarrier:{maxResource:[10,0],maxUnemcumberedResource:50,resourcesPerBlock:[10,0]},ECWorldGui:{text2:"Level 5"}};e.archetypes.a_f_lumberling_level_6={shouldPlayerSave:!1,parent:"a_f_lumberling_level_5",ECMesh:{path:"characters/models/c_lumberling_level06.dae"},ECLocomotion:{normalSpeed:1.5*1.6,fastSpeed:1.5*1.6,animationRate:2.12,angleLerpFactor:0.5},ECWildlingAgent:{offlineResourcePerMinute:5,offlineMinutesBeforeSleeping:960,
onlineResourcePerMinute:5},ECResourceCarrier:{maxResource:[10,0],maxUnemcumberedResource:60,resourcesPerBlock:[10,0]},ECWorldGui:{text2:"Level 6"}};e.archetypes.a_f_lumberling_level_7={shouldPlayerSave:!1,parent:"a_f_lumberling_level_6",ECMesh:{path:"characters/models/c_lumberling_level07.dae"},ECLocomotion:{normalSpeed:2.55,fastSpeed:2.55,animationRate:2.14,angleLerpFactor:0.5},ECWildlingAgent:{offlineResourcePerMinute:400/60,offlineMinutesBeforeSleeping:1200,onlineResourcePerMinute:400/60},ECResourceCarrier:{maxResource:[10,
0],maxUnemcumberedResource:80,resourcesPerBlock:[10,0]},ECWorldGui:{text2:"Level 7"}};e.archetypes.a_f_lumberling_level_8={shouldPlayerSave:!1,parent:"a_f_lumberling_level_7",ECMesh:{path:"characters/models/c_lumberling_level08.dae"},ECLocomotion:{normalSpeed:2.7,fastSpeed:2.7,animationRate:2.16,angleLerpFactor:0.5},ECWildlingAgent:{offlineResourcePerMinute:500/60,offlineMinutesBeforeSleeping:1440,onlineResourcePerMinute:500/60},ECResourceCarrier:{maxResource:[10,0],maxUnemcumberedResource:100,resourcesPerBlock:[10,
0]},ECWorldGui:{text2:"Level 8"}};e.archetypes.a_f_lumberling_level_9={shouldPlayerSave:!1,parent:"a_f_lumberling_level_8",ECMesh:{path:"characters/models/c_lumberling_level09.dae"},ECLocomotion:{normalSpeed:1.5*1.9,fastSpeed:1.5*1.9,animationRate:2.18,angleLerpFactor:0.5},ECWildlingAgent:{offlineResourcePerMinute:10,offlineMinutesBeforeSleeping:2160,onlineResourcePerMinute:10},ECResourceCarrier:{maxResource:[10,0],maxUnemcumberedResource:120,resourcesPerBlock:[10,0]},ECWorldGui:{text2:"Level 9"}};
e.archetypes.a_f_lumberling_level_10={shouldPlayerSave:!1,parent:"a_f_lumberling_level_9",ECMesh:{path:"characters/models/c_lumberling_level010.dae"},ECLocomotion:{normalSpeed:3,fastSpeed:3,animationRate:2.2,angleLerpFactor:0.5},ECWildlingAgent:{offlineResourcePerMinute:12.5,offlineMinutesBeforeSleeping:2520,onlineResourcePerMinute:12.5},ECResourceCarrier:{maxResource:[10,0],maxUnemcumberedResource:150,resourcesPerBlock:[10,0]},ECWorldGui:{text2:"Level 10"}};e.archetypes.a_f_stoneling={shouldPlayerSave:!1,
familyName:"friendlyStoneling",ECMesh:{scale:1,path:"characters/models/c_stoneling.dae",localOffset:[0,0,0],offsetY:-0.4},ECPhysicsSphere:{radius:0.225,usesGravity:!0,canClimb:!0,frictionType:qa.frictionType.CHARACTER,mass:50,height:0.8},ECLocomotion:{normalSpeed:1.3*1.1,fastSpeed:1.3*1.1,animationRate:1.616,angleLerpFactor:0.5},ECSelectable:{radiusFactor:1,smart:!0,smartRadiusFactor:1.2},ECGateTriggerer:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECWildlingAgent:{offlineResourcePerMinute:25/60,offlineMinutesBeforeSleeping:150,
onlineResourcePerMinute:35/60,recoveryDuration:0,stunnable:!1,actions:["AIActionMoveAwayFromOverlappingScaffold","AIActionHouseUpgrading","AIActionFollowLeader","AIActionPickUpNearbyStone","AIActionQuarryStone",{name:"AIActionMoveToStoneDestination",initiativeDuration:1},{name:"AIActionMoveToResourceDispenser",initiativeDuration:1},"AIActionChooseQuarry","AIActionChooseStoneDestination",{name:"AIActionGoHome",initiativeDuration:5}],orders:["Gather Stone"]},ECNav:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,
ECResourceCarrier:{maxResource:[0,10],maxUnemcumberedResource:10,resourcesPerBlock:[0,10],resourcePerInteract:[0.3,0.3]},ECWorldGui:{text1:"Stoneling",text2:"Level 1",onScreenGuiArchetype:"tipStoneling",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_f_stoneling_level_2={shouldPlayerSave:!1,parent:"a_f_stoneling",ECMesh:{path:"characters/models/c_stoneling_level02.dae"},ECLocomotion:{normalSpeed:1.56,fastSpeed:1.56,animationRate:1.6*1.02,angleLerpFactor:0.5},
ECWildlingAgent:{offlineResourcePerMinute:50/60,offlineMinutesBeforeSleeping:180,onlineResourcePerMinute:70/60},ECResourceCarrier:{maxResource:[0,10],maxUnemcumberedResource:20,resourcesPerBlock:[0,10]},ECWorldGui:{text2:"Level 2"}};e.archetypes.a_f_stoneling_level_3={shouldPlayerSave:!1,parent:"a_f_stoneling_level_2",ECMesh:{path:"characters/models/c_stoneling_level03.dae"},ECLocomotion:{normalSpeed:1.3*1.3,fastSpeed:1.3*1.3,animationRate:1.6*1.03,angleLerpFactor:0.5},ECWildlingAgent:{offlineResourcePerMinute:1.25,
offlineMinutesBeforeSleeping:210,onlineResourcePerMinute:1.75},ECResourceCarrier:{maxResource:[0,10],maxUnemcumberedResource:30,resourcesPerBlock:[0,10]},ECWorldGui:{text2:"Level 3"}};e.archetypes.a_f_stoneling_level_4={shouldPlayerSave:!1,parent:"a_f_stoneling_level_3",ECMesh:{path:"characters/models/c_stoneling_level04.dae"},ECLocomotion:{normalSpeed:1.3*1.4,fastSpeed:1.3*1.4,animationRate:1.6*1.04,angleLerpFactor:0.5},ECWildlingAgent:{offlineResourcePerMinute:100/60,offlineMinutesBeforeSleeping:240,
onlineResourcePerMinute:140/60},ECResourceCarrier:{maxResource:[0,10],maxUnemcumberedResource:40,resourcesPerBlock:[0,10]},ECWorldGui:{text2:"Level 4"}};e.archetypes.a_f_stoneling_level_5={shouldPlayerSave:!1,parent:"a_f_stoneling_level_4",ECMesh:{path:"characters/models/c_stoneling_level05.dae"},ECLocomotion:{normalSpeed:1.3*1.5,fastSpeed:1.3*1.5,animationRate:1.6*1.05,angleLerpFactor:0.5},ECWildlingAgent:{offlineResourcePerMinute:125/60,offlineMinutesBeforeSleeping:480,onlineResourcePerMinute:175/
60},ECResourceCarrier:{maxResource:[0,10],maxUnemcumberedResource:50,resourcesPerBlock:[0,10]},ECWorldGui:{text2:"Level 5"}};e.archetypes.a_f_stoneling_level_6={shouldPlayerSave:!1,parent:"a_f_stoneling_level_5",ECMesh:{path:"characters/models/c_stoneling_level06.dae"},ECLocomotion:{normalSpeed:2.08,fastSpeed:2.08,animationRate:1.6*1.06,angleLerpFactor:0.5},ECWildlingAgent:{offlineResourcePerMinute:2.5,offlineMinutesBeforeSleeping:960,onlineResourcePerMinute:3.5},ECResourceCarrier:{maxResource:[0,
10],maxUnemcumberedResource:60,resourcesPerBlock:[0,10]},ECWorldGui:{text2:"Level 6"}};e.archetypes.a_f_stoneling_level_7={shouldPlayerSave:!1,parent:"a_f_stoneling_level_6",ECMesh:{path:"characters/models/c_stoneling_level07.dae"},ECLocomotion:{normalSpeed:2.21,fastSpeed:2.21,animationRate:1.6*1.07,angleLerpFactor:0.5},ECWildlingAgent:{offlineResourcePerMinute:200/60,offlineMinutesBeforeSleeping:1200,onlineResourcePerMinute:280/60},ECResourceCarrier:{maxResource:[0,10],maxUnemcumberedResource:80,
resourcesPerBlock:[0,10]},ECWorldGui:{text2:"Level 7"}};e.archetypes.a_f_stoneling_level_8={shouldPlayerSave:!1,parent:"a_f_stoneling_level_7",ECMesh:{path:"characters/models/c_stoneling_level08.dae"},ECLocomotion:{normalSpeed:1.3*1.8,fastSpeed:1.3*1.8,animationRate:1.6*1.08,angleLerpFactor:0.5},ECWildlingAgent:{offlineResourcePerMinute:250/60,offlineMinutesBeforeSleeping:1440,onlineResourcePerMinute:350/60},ECResourceCarrier:{maxResource:[0,10],maxUnemcumberedResource:100,resourcesPerBlock:[0,10]},
ECWorldGui:{text2:"Level 8"}};e.archetypes.a_f_stoneling_level_9={shouldPlayerSave:!1,parent:"a_f_stoneling_level_8",ECMesh:{path:"characters/models/c_stoneling_level09.dae"},ECLocomotion:{normalSpeed:1.3*1.9,fastSpeed:1.3*1.9,animationRate:1.6*1.09,angleLerpFactor:0.5},ECWildlingAgent:{offlineResourcePerMinute:5,offlineMinutesBeforeSleeping:2160,onlineResourcePerMinute:7},ECResourceCarrier:{maxResource:[0,10],maxUnemcumberedResource:120,resourcesPerBlock:[0,10]},ECWorldGui:{text2:"Level 9"}};e.archetypes.a_f_stoneling_level_10=
{shouldPlayerSave:!1,parent:"a_f_stoneling_level_9",ECMesh:{path:"characters/models/c_stoneling_level010.dae"},ECLocomotion:{normalSpeed:2.6,fastSpeed:2.6,animationRate:1.6*1.1,angleLerpFactor:0.5},ECWildlingAgent:{offlineResourcePerMinute:6.25,offlineMinutesBeforeSleeping:2520,onlineResourcePerMinute:8.75},ECResourceCarrier:{maxResource:[0,10],maxUnemcumberedResource:150,resourcesPerBlock:[0,10]},ECWorldGui:{text2:"Level 10"}};e.archetypes.a_f_buildling={shouldPlayerSave:!1,familyName:"friendlyBuildling",
ECMesh:{scale:1,path:"characters/models/c_builderling01.dae",localOffset:[0,0,0],offsetY:-0.4},ECPhysicsSphere:{radius:0.225,usesGravity:!0,canClimb:!0,frictionType:qa.frictionType.CHARACTER,mass:50,height:0.8},ECLocomotion:{normalSpeed:3.8,fastSpeed:3.5,animationRate:2.5,angleLerpFactor:0.5},ECSelectable:{radiusFactor:1,smart:!0,smartRadiusFactor:1.2},ECGateTriggerer:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECWildlingAgent:{buildingAssistRate:1,offlineBuildingAssistRate:1,canSleep:!1,recoveryDuration:0,
stunnable:!1,actions:["AIActionMoveAwayFromOverlappingScaffold","AIActionFollowLeader","AIActionSpeedUpScaffold",{name:"AIActionMoveToScaffold",initiativeDuration:0.5},{name:"AIActionChooseScaffold",scaffoldType:"normal"},{name:"AIActionChooseBuilder",scaffoldType:"normal"},{name:"AIActionGoHome",initiativeDuration:2}],orders:["Assist With Building"]},ECNav:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECWorldGui:{text1:"Buildling",onScreenGuiArchetype:"tipBuildling",offScreenGuiArchetype:"none",visibleAlways:!1,
visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_f_warling={shouldPlayerSave:!1,familyName:"friendlyWarling",ECMesh:{scale:1,path:"characters/models/c_warling.dae",localOffset:[0,0,0],offsetY:-0.4},ECPhysicsSphere:{radius:0.225,usesGravity:!0,canClimb:!0,frictionType:qa.frictionType.CHARACTER,mass:50,height:0.8},ECLocomotion:{normalSpeed:2.75,fastSpeed:2.75,animationRate:1.616,angleLerpFactor:0.5},ECSelectable:{radiusFactor:1,smart:!0,smartRadiusFactor:1.2},ECGateTriggerer:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,
ECWildlingAgent:{buildingAssistRate:1,offlineBuildingAssistRate:1,offlineCanBuildMultipleBuildings:!0,offlineScaffoldType:"war",canSleep:!1,recoveryDuration:0,stunnable:!1,actions:["AIActionMoveAwayFromOverlappingScaffold","AIActionHouseUpgrading","AIActionFollowLeader","AIActionSpeedUpScaffold",{name:"AIActionMoveToScaffold",initiativeDuration:0.5},{name:"AIActionChooseScaffold",scaffoldType:"war"},{name:"AIActionChooseBuilder",scaffoldType:"war"},{name:"AIActionMoveToOutpost",initiativeDuration:2},
"AIActionChooseOutpost",{name:"AIActionGoHome",initiativeDuration:2}],orders:["Assist With WarBuilding"]},ECNav:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECWorldGui:{text1:"Defendling",text2:"Level 1",onScreenGuiArchetype:"tipDefendling",offScreenGuiArchetype:"none",visibleAlways:!1,visibleOnActivated:!1,visibleOnHover:!0}};e.archetypes.a_f_warling_level_2={shouldPlayerSave:!1,parent:"a_f_warling",ECMesh:{path:"characters/models/c_warling_level02.dae"},ECLocomotion:{normalSpeed:3,fastSpeed:3,animationRate:1.6*
1.02,angleLerpFactor:0.5},ECWildlingAgent:{buildingAssistRate:1.05,offlineBuildingAssistRate:1.05},ECWorldGui:{text2:"Level 2"}};e.archetypes.a_f_warling_level_3={shouldPlayerSave:!1,parent:"a_f_warling_level_2",ECMesh:{path:"characters/models/c_warling_level03.dae"},ECLocomotion:{normalSpeed:3.5,fastSpeed:3.5,animationRate:1.6*1.03,angleLerpFactor:0.5},ECWildlingAgent:{buildingAssistRate:1.1,offlineBuildingAssistRate:1.1},ECWorldGui:{text2:"Level 3"}};e.archetypes.a_f_warling_level_4={shouldPlayerSave:!1,
parent:"a_f_warling_level_3",ECMesh:{path:"characters/models/c_warling_level04.dae"},ECLocomotion:{normalSpeed:4,fastSpeed:4,animationRate:1.6*1.04,angleLerpFactor:0.5},ECWildlingAgent:{buildingAssistRate:1.15,offlineBuildingAssistRate:1.15},ECWorldGui:{text2:"Level 4"}};e.archetypes.a_f_warling_level_5={shouldPlayerSave:!1,parent:"a_f_warling_level_4",ECMesh:{path:"characters/models/c_warling_level05.dae"},ECLocomotion:{normalSpeed:4.5,fastSpeed:4.5,animationRate:1.6*1.05,angleLerpFactor:0.5},ECWildlingAgent:{buildingAssistRate:1.2,
offlineBuildingAssistRate:1.2},ECWorldGui:{text2:"Level 5"}};e.archetypes.a_f_warling_level_6={shouldPlayerSave:!1,parent:"a_f_warling_level_5",ECMesh:{path:"characters/models/c_warling_level06.dae"},ECLocomotion:{normalSpeed:5,fastSpeed:5,animationRate:1.6*1.06,angleLerpFactor:0.5},ECWildlingAgent:{buildingAssistRate:1.25,offlineBuildingAssistRate:1.25},ECWorldGui:{text2:"Level 6"}};e.archetypes.a_f_warling_level_7={shouldPlayerSave:!1,parent:"a_f_warling_level_6",ECMesh:{path:"characters/models/c_warling_level07.dae"},
ECLocomotion:{normalSpeed:5.5,fastSpeed:5.5,animationRate:1.6*1.07,angleLerpFactor:0.5},ECWildlingAgent:{buildingAssistRate:1.3,offlineBuildingAssistRate:1.3},ECWorldGui:{text2:"Level 7"}};e.archetypes.a_f_warling_level_8={shouldPlayerSave:!1,parent:"a_f_warling_level_7",ECMesh:{path:"characters/models/c_warling_level08.dae"},ECLocomotion:{normalSpeed:6,fastSpeed:6,animationRate:1.6*1.07,angleLerpFactor:0.5},ECWildlingAgent:{buildingAssistRate:1.35,offlineBuildingAssistRate:1.35},ECWorldGui:{text2:"Level 8"}};
e.archetypes.a_f_warling_level_9={shouldPlayerSave:!1,parent:"a_f_warling_level_8",ECMesh:{path:"characters/models/c_warling_level09.dae"},ECLocomotion:{normalSpeed:6.5,fastSpeed:6.5,animationRate:1.6*1.07,angleLerpFactor:0.5},ECWildlingAgent:{buildingAssistRate:1.4,offlineBuildingAssistRate:1.4},ECWorldGui:{text2:"Level 9"}};e.archetypes.a_f_warling_level_10={shouldPlayerSave:!1,parent:"a_f_warling_level_9",ECMesh:{path:"characters/models/c_warling_level010.dae"},ECLocomotion:{normalSpeed:7,fastSpeed:7,
animationRate:1.6*1.07,angleLerpFactor:0.5},ECWildlingAgent:{buildingAssistRate:1.45,offlineBuildingAssistRate:1.45},ECWorldGui:{text2:"Level 10"}};A.archetypes.dg_h_pistol_weak=A.create("Builder Gun (Weak Charge)",{damage:60,nearDamageFactor:1.5,farDamageFactor:1,nearForceFactor:1.5,farForceFactor:1,nearRange:4,farRange:7,forceBack:0.3,forceLift:0.3,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_h_pistol_medium=A.create("Builder Gun (Medium Charge)",{damage:60,forceBack:0.7,
forceLift:0.7,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_h_pistol_strong=A.create("Builder Gun (Strong Charge)",{damage:80,forceBack:0.9,forceLift:0.9,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_h_pistol_superstrong=A.create("Builder Gun (Full Charge)",{damage:100,forceBack:1.2,forceLift:1.2,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_h_bomb=A.create("Hero Bomb Explosion",{damage:100,forceBack:0,forceLift:1.5,
forceRadial:1,forceTangential:0,radius:2,isExplosion:!0});A.archetypes.dg_h_melee_bump01=A.create("Hero Melee Bump",{damage:40,stunDuration:0.5,forceBack:0.8,forceLift:0.4,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_h_melee_bump02=A.create("Hero Melee Bump",{damage:80,stunDuration:0.5,forceBack:0.8,forceLift:0.4,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_h_melee_bump03=A.create("Hero Melee Bump",{damage:120,stunDuration:0.5,forceBack:0.8,
forceLift:0.4,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_h_melee_bump04=A.create("Hero Melee Bump",{damage:160,stunDuration:0.5,forceBack:0.8,forceLift:0.4,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_h_melee_bump05=A.create("Hero Melee Bump",{damage:200,stunDuration:0.5,forceBack:0.8,forceLift:0.4,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_h_shotgun_blast_cone01=A.create("Shotgun Blast",{damage:20,nearDamageFactor:1,
farDamageFactor:0.3,nearForceFactor:1,farForceFactor:0.3,nearRange:3,farRange:7.5,forceBack:1,forceLift:0.25,forceRadial:0,forceTangential:0,radius:10,arcAngle:30,friendlyFire:0});A.archetypes.dg_h_shotgun_blast_cone02=A.create("Shotgun Blast",{damage:40,nearDamageFactor:1,farDamageFactor:0.3,nearForceFactor:1,farForceFactor:0.3,nearRange:3,farRange:7.5,forceBack:1,forceLift:0.25,forceRadial:0,forceTangential:0,radius:10,arcAngle:30,friendlyFire:0});A.archetypes.dg_h_shotgun_blast_cone03=A.create("Shotgun Blast",
{damage:60,nearDamageFactor:1,farDamageFactor:0.3,nearForceFactor:1,farForceFactor:0.3,nearRange:3,farRange:7.5,forceBack:1,forceLift:0.25,forceRadial:0,forceTangential:0,radius:10,arcAngle:30,friendlyFire:0});A.archetypes.dg_h_shotgun_blast_cone04=A.create("Shotgun Blast",{damage:80,nearDamageFactor:1,farDamageFactor:0.3,nearForceFactor:1,farForceFactor:0.3,nearRange:3,farRange:7.5,forceBack:1,forceLift:0.25,forceRadial:0,forceTangential:0,radius:10,arcAngle:30,friendlyFire:0});A.archetypes.dg_h_shotgun_blast_cone05=
A.create("Shotgun Blast",{damage:100,nearDamageFactor:1,farDamageFactor:0.3,nearForceFactor:1,farForceFactor:0.3,nearRange:3,farRange:7.5,forceBack:1,forceLift:0.25,forceRadial:0,forceTangential:0,radius:10,arcAngle:30,friendlyFire:0});A.archetypes.dg_h_shotgun_pellet=A.create("Shotgun Pellet",{damage:20,forceBack:0.1,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_h_shotgun_pellet_nodamage=A.create("Shotgun Pellet (no damage)",{damage:0,forceBack:0.1,forceLift:0,
forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.dg_h_boomerang=A.create("Hero Boomerang",{damage:45,forceBack:0,forceLift:0,forceRadial:0,forceTangential:0,radius:0,friendlyFire:0});A.archetypes.DAMAGE_TYPE_CHARGE=A.create("Charge",{damage:75,forceBack:1,forceLift:1,forceRadial:0,forceTangential:0,radius:1.5,friendlyFire:0});A.archetypes.DAMAGE_TYPE_CHARGE_CLOSE=A.create("Charge Close",{damage:50,forceBack:0.5,forceLift:0.5,forceRadial:0,forceTangential:0,radius:1});A.archetypes.DAMAGE_TYPE_SWIPE=
A.create("Charge Close",{damage:50,forceBack:0.5,forceLift:0.5,forceRadial:0,forceTangential:0,radius:1});e.archetypes.pj_h_pistol_weak={ECMesh:{path:"characters/models/bullet.dae",scale:5},ECProjectile:{speed:80,ignoresAllies:!0,maxImpacts:1,damageType:"dg_h_pistol_weak",hitSound:"dartHit",hurtSound:"dartHitFlesh"}};e.archetypes.pj_h_pistol_medium={ECMesh:{path:"characters/models/bullet.dae",scale:5},ECProjectile:{speed:40,damageType:"dg_h_pistol_medium",hitSound:"dartHit",hurtSound:"dartHitFlesh"}};
e.archetypes.pj_h_pistol_strong={ECMesh:{path:"characters/models/bullet.dae",scale:5},ECProjectile:{speed:60,damageType:"dg_h_pistol_strong",hitSound:"dartHit",hurtSound:"dartHitFlesh"}};e.archetypes.pj_h_pistol_superstrong={ECMesh:{path:"characters/models/bullet.dae",scale:5},ECProjectile:{speed:80,damageType:"dg_h_pistol_superstrong",hitSound:"dartHit",hurtSound:"dartHitFleshCharged"}};e.archetypes.pj_h_bomb={ECMesh:{path:"models/bomb.dae",scale:0.5},ECProjectile:{speed:12,usesGravity:!0,damageType:"dg_h_bomb",
hitEffect:"sfx_explosion_dc",hurtEffect:"sfx_explosion"}};e.archetypes.pj_h_shotgun_pellet={ECMesh:{path:"characters/models/bullet.dae",scale:2.5},ECProjectile:{speed:50,ignoresAllies:!0,maxImpacts:1,damageType:"dg_h_shotgun_pellet",hitSound:"dartHit",hurtSound:"dartHitFlesh"},ECEffectSpawner:{onCreateEffect:"sfx_crt_bullet",incidentalEffect:"sfx_amb_bullet",incidentalMinTime:0,incidentalMaxTime:0.2}};e.archetypes.pj_h_shotgun_pellet_nodamage={ECMesh:{path:"characters/models/bullet.dae",scale:2.5},
ECProjectile:{speed:60,ignoresAllies:!0,maxImpacts:3,damageType:void 0},ECEffectSpawner:{onCreateEffect:"sfx_crt_bullet",incidentalEffect:"sfx_amb_bullet",incidentalMinTime:0,incidentalMaxTime:0.001}};e.archetypes.pj_h_boomerang={ECMesh:{path:"environment/models/e_i_amber.dae",scale:0.9},ECSprite:{size:0.8,path:"textures/orb.dds",additive:!0,color:[1,1,1,0.3],rotationSpeed:0.8},ECProjectile:{speed:24,damageType:"dg_h_boomerang",ignoresAllies:!0,maxImpacts:10,hitSound:"dartHit"},ECBoomerang:{outwardsDeceleration:24,
returningAcceleration:18,returningMaxSpeed:30}};e.archetypes.pj_h_shotgun_blast_cone01={shouldPlayerSave:!1,ECProjectile:{explodeInstantly:!0,damageType:"dg_h_shotgun_blast_cone01",hitSound:"dartHit"}};e.archetypes.pj_h_shotgun_blast_cone02={parent:"pj_h_shotgun_blast_cone01",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_h_shotgun_blast_cone02"}};e.archetypes.pj_h_shotgun_blast_cone03={parent:"pj_h_shotgun_blast_cone02",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_h_shotgun_blast_cone03"}};
e.archetypes.pj_h_shotgun_blast_cone04={parent:"pj_h_shotgun_blast_cone03",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_h_shotgun_blast_cone04"}};e.archetypes.pj_h_shotgun_blast_cone05={parent:"pj_h_shotgun_blast_cone04",shouldPlayerSave:!1,ECProjectile:{damageType:"dg_h_shotgun_blast_cone05"}};ba.archetypes.wp_h_pistol={meshPath:"characters/models/hero_gunhand.dae",projectileType:"pj_h_pistol_weak",fireEffect:"pistolshoteffect",fireSound:"pistolshot",cockSound:"pistolcock",dryFireSound:"pistoldryfire",
meshScale:1.25,clipSize:1,reloadDuration:1,rechamberDuration:0,minRange:0,maxRange:17.5,speedModAiming:1,speedModRechambering:1,speedModReloading:1};ba.archetypes.wp_h_bombs={projectileType:"pj_h_bomb",fireSound:"dartFly",cockSound:"pistolcock",reloadSound:"pistolreload",dryFireSound:"pistoldryfire",meshPath:"models/bomb.dae",meshScale:0.5,clipSize:3,reloadDuration:0,rechamberDuration:2,minRange:0,maxRange:15};ba.archetypes.wp_h_shotgun_projectiles={meshPath:"characters/models/hero_gunhand.dae",projectileType:"pj_h_shotgun_pellet",
fireSound:"aud_shotgunshot",cockSound:"aud_shotguncock",dryFireSound:"aud_shotgundryfire",meshScale:1.25,clipSize:2,projectilesPerShot:5,randomSpreadAngle:10,reloadDuration:1.5,rechamberDuration:0.4,minRange:0,maxRange:20,speedModAiming:1,speedModRechambering:1,speedModReloading:1};ba.archetypes.wp_h_boomerang={meshPath:"characters/models/hero_gunhand.dae",projectileType:"pj_h_boomerang",fireSound:"dartFly",cockSound:"pistolcock",dryFireSound:"pistoldryfire",meshScale:1.25,clipSize:1,reloadDuration:3,
rechamberDuration:0,minRange:0,maxRange:13,speedModAiming:1,speedModRechambering:1,speedModReloading:1};ba.archetypes.wp_h_shotgun_cone01={meshPath:"characters/models/hero_gunhand.dae",projectileType:"pj_h_shotgun_blast_cone01",fireSound:"aud_shotgunshot",cockSound:"aud_shotguncock",dryFireSound:"aud_shotgundryfire",effectProjectileType:"pj_h_shotgun_pellet_nodamage",numEffectProjectiles:5,effectProjectileSpreadAngle:10,meshScale:1.25,clipSize:2,reloadDuration:1.5,rechamberDuration:0.4,minRange:0,
maxRange:10,speedModAiming:1,speedModRechambering:1,speedModReloading:1};ba.archetypes.wp_h_shotgun_cone02={meshPath:"characters/models/hero_gunhand.dae",projectileType:"pj_h_shotgun_blast_cone02",fireSound:"aud_shotgunshot",cockSound:"aud_shotguncock",dryFireSound:"aud_shotgundryfire",effectProjectileType:"pj_h_shotgun_pellet_nodamage",numEffectProjectiles:5,effectProjectileSpreadAngle:10,meshScale:1.25,clipSize:2,reloadDuration:1.5,rechamberDuration:0.4,minRange:0,maxRange:10,speedModAiming:1,speedModRechambering:1,
speedModReloading:1};ba.archetypes.wp_h_shotgun_cone03={meshPath:"characters/models/hero_gunhand.dae",projectileType:"pj_h_shotgun_blast_cone03",fireSound:"aud_shotgunshot",cockSound:"aud_shotguncock",dryFireSound:"aud_shotgundryfire",effectProjectileType:"pj_h_shotgun_pellet_nodamage",numEffectProjectiles:5,effectProjectileSpreadAngle:10,meshScale:1.25,clipSize:2,reloadDuration:1.5,rechamberDuration:0.4,minRange:0,maxRange:10,speedModAiming:1,speedModRechambering:1,speedModReloading:1};ba.archetypes.wp_h_shotgun_cone04=
{meshPath:"characters/models/hero_gunhand.dae",projectileType:"pj_h_shotgun_blast_cone04",fireSound:"aud_shotgunshot",cockSound:"aud_shotguncock",dryFireSound:"aud_shotgundryfire",effectProjectileType:"pj_h_shotgun_pellet_nodamage",numEffectProjectiles:5,effectProjectileSpreadAngle:10,meshScale:1.25,clipSize:2,reloadDuration:1.5,rechamberDuration:0.4,minRange:0,maxRange:10,speedModAiming:1,speedModRechambering:1,speedModReloading:1};ba.archetypes.wp_h_shotgun_cone05={meshPath:"characters/models/hero_gunhand.dae",
projectileType:"pj_h_shotgun_blast_cone05",fireSound:"aud_shotgunshot",cockSound:"aud_shotguncock",dryFireSound:"aud_shotgundryfire",effectProjectileType:"pj_h_shotgun_pellet_nodamage",numEffectProjectiles:5,effectProjectileSpreadAngle:10,meshScale:1.25,clipSize:2,reloadDuration:1.5,rechamberDuration:0.4,minRange:0,maxRange:10,speedModAiming:1,speedModRechambering:1,speedModReloading:1};e.archetypes.a_h_hero_01={shouldPlayerSave:!1,familyName:"hero",ECMesh:{scale:1.25,path:"characters/models/hero_01.dae",
localOffset:[0,0,0],offsetY:-0.6},ECSleeping:e.EC_DEFAULT,ECPhysicsSphere:{radius:0.4,usesGravity:!0,mass:50,canClimb:!0,frictionType:qa.frictionType.CHARACTER,bounce:0.1,height:0.8},ECFirearm:{weapon:"wp_h_shotgun_cone01",shootOffset:[-0.4,-0.25,0.4]},ECBumpAttack:{damageType:"dg_h_melee_bump01",hitEffect:"heroMeleeHit",minimumSpeed:2,cooldownDuration:0.6},ECHeroTorch:e.EC_DEFAULT,ECHealth:{invunTime:0.75,health:50,drawInWorldBarIfDamagedRecently:!0,regen:15,regenDelay:2,canOnlyRegenNearRegenerators:!0},
ECLocomotion:{normalSpeed:5,fastSpeed:8,angleLerpFactor:0.5,fastLerpFactor:0.125,fastDistance:6,normalMaxDistance:3,normalMinDistance:1,hasLookAhead:!0},ECHero:e.EC_DEFAULT,ECFaction:e.EC_DEFAULT,ECPlayerData:e.EC_DEFAULT,ECResourceCarrier:{maxResource:[50,50],maxUnemcumberedResource:25,resourcesPerBlock:[5,5],resourcePerInteract:[5,5],fractionLostPerHit:0.5,fractionDroppedPerHit:0.25},ECInventory:{},ECMeleeTarget:e.EC_DEFAULT,ECAttackerLimit:{maxAttackers:2,maxHighPriorityAttackers:4},ECPlayerLife:{infiniteLives:!0,
respawnDelay:15},ECTarget:{radiusFactor:0.7},ECPlayerBuilder:{snapBuildingsToGrid:!0,usesBuildZones:!0,canBuildOnEntities:!0,playerBuildCloseness:0,maxBuildHeight:1,maxPlayerBuildCloseness:8,needsDoubleClickWhenClose:!1},ECSmartSelectableTrigger:e.EC_DEFAULT,ECGateTriggerer:e.EC_DEFAULT,ECWildlingLeader:e.EC_DEFAULT,ECNav:{canClimb:!0,canDrop:!0},ECAutoFire:{additionalPauseBetweenShots:0,targetRange:25,triggerRange:25},ECHeroUpgrades:{movementSpeedFactors:[1,1.04,1.08,1.12,1.16,1.2],carrySpeedFactors:[1,
1.04,1.08,1.12,1.16,1.2],shotgunDamageFactors:[1,1.04,1.08,1.12,1.16,1.2],reloadSpeedFactors:[1,1.04,1.08,1.12,1.16,1.2],maxHealthFactors:[1,1.04,1.08,1.12,1.16,1.2],explosionDamageFactors:[1,0.96,0.92,0.88,0.84,0.8],carryCapacityBlocks:[0,2,4,6,8,10],chopExtraBlocks:[0,1,2,3,4,5]}};e.archetypes.a_h_hero_02={parent:"a_h_hero_01",familyName:"hero",ECHealth:{health:50},ECResourceCarrier:{maxResource:[60,60],maxUnemcumberedResource:30},ECBumpAttack:{damageType:"dg_h_melee_bump02"}};e.archetypes.a_h_hero_03=
{parent:"a_h_hero_02",ECHealth:{health:75},ECResourceCarrier:{maxResource:[60,60],maxUnemcumberedResource:30},ECFirearm:{weapon:"wp_h_shotgun_cone02"}};e.archetypes.a_h_hero_04={parent:"a_h_hero_03",ECHealth:{health:75},ECResourceCarrier:{maxResource:[70,70],maxUnemcumberedResource:35},ECBumpAttack:{damageType:"dg_h_melee_bump03"}};e.archetypes.a_h_hero_05={parent:"a_h_hero_04",ECHealth:{health:100},ECResourceCarrier:{maxResource:[70,70],maxUnemcumberedResource:35},ECFirearm:{weapon:"wp_h_shotgun_cone03"}};
e.archetypes.a_h_hero_06={parent:"a_h_hero_05",ECHealth:{health:100},ECResourceCarrier:{maxResource:[80,80],maxUnemcumberedResource:40},ECBumpAttack:{damageType:"dg_h_melee_bump04"}};e.archetypes.a_h_hero_07={parent:"a_h_hero_06",ECHealth:{health:125},ECResourceCarrier:{maxResource:[80,80],maxUnemcumberedResource:40},ECFirearm:{weapon:"wp_h_shotgun_cone04"}};e.archetypes.a_h_hero_08={parent:"a_h_hero_07",ECHealth:{health:125},ECResourceCarrier:{maxResource:[90,90],maxUnemcumberedResource:45},ECBumpAttack:{damageType:"dg_h_melee_bump05"}};
e.archetypes.a_h_hero_09={parent:"a_h_hero_08",ECHealth:{health:150},ECResourceCarrier:{maxResource:[90,90],maxUnemcumberedResource:45},ECFirearm:{weapon:"wp_h_shotgun_cone05"}};e.archetypes.a_h_hero_10={parent:"a_h_hero_09",ECHealth:{health:200},ECResourceCarrier:{maxResource:[100,100],maxUnemcumberedResource:50}};e.archetypes.a_lm_tutorialGun={shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"tutorialGun",ECLocationMarker:{locationName:"tutorialGun",type:"tutorialLocation"}};e.archetypes.a_lm_triggerBridge=
{shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"triggerBridge",ECLocationMarker:{locationName:"triggerBridge",type:"tutorialLocation"}};e.archetypes.a_lm_resourceArea={shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"resourceArea",ECLocationMarker:{locationName:"resourceArea",type:"tutorialLocation"}};e.archetypes.a_lm_suggestHq={shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"suggestHq",ECLocationMarker:{locationName:"suggestHq",type:"tutorialLocation"}};e.archetypes.a_lm_suggestOutpost=
{shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"suggestOutpost",ECLocationMarker:{locationName:"suggestOutpost",type:"tutorialLocation"}};e.archetypes.a_lm_suggestBarricade={shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"suggestBarricade",ECLocationMarker:{locationName:"suggestBarricade",type:"tutorialLocation"}};e.archetypes.a_lm_suggestGatling={shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"suggestGatling",ECLocationMarker:{locationName:"suggestGatling",type:"tutorialLocation"}};e.archetypes.a_lm_tutEnemy=
{shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"tutorialEnemy",ECLocationMarker:{locationName:"tutorialEnemy"}};e.archetypes.a_lm_tutEnemy1={shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"tutorialEnemy1",ECLocationMarker:{locationName:"tutorialEnemy1"}};e.archetypes.a_lm_tutEnemy2={shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"tutorialEnemy2",ECLocationMarker:{locationName:"tutorialEnemy2"}};e.archetypes.a_lm_tutEnemy3={shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"tutorialEnemy3",
ECLocationMarker:{locationName:"tutorialEnemy3"}};e.archetypes.a_lm_tutEnemy4={shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"tutorialEnemy4",ECLocationMarker:{locationName:"tutorialEnemy4"}};e.archetypes.a_lm_tutEnemy5={shouldPlayerSave:!1,shouldLevelSave:!0,familyName:"tutorialEnemy5",ECLocationMarker:{locationName:"tutorialEnemy5"}};e.archetypes.a_lm_heroSpawnLocation={shouldPlayerSave:!1,shouldLevelSave:!0,ECLocationMarker:{type:"heroSpawnLocation"}};e.archetypes.a_as_war_new_n={shouldPlayerSave:!1,
shouldLevelSave:!0,ECLocationMarker:{groupName:"warnew01",locationName:"N"}};e.archetypes.a_lm_campaign_starter_n={shouldPlayerSave:!1,shouldLevelSave:!0,ECLocationMarker:{groupName:"warnew01",locationName:"N",type:"campaignStarter"}};e.archetypes.a_r_lumber={shouldPlayerSave:!1,familyName:"lumber",ECSprite:{size:0.5,path:"textures/orbgreen.dds",additive:!0,color:[1,1,1,0.3],rotationSpeed:0.8},ECMesh:{scale:0.25,path:"environment/models/lumber_01.dae",numInstances:32},ECPickup:{carriedResource:[5,
0],placed:!0,randomRadius:4,lifeTime:15},ECEffectSpawner:{onDestroyEffect:"sfx_dst_r_lumber"}};e.archetypes.a_r_lumber_large={shouldPlayerSave:!1,familyName:"lumber",ECSprite:{size:1,path:"textures/orbgreen.dds",additive:!0,color:[1,1,1,0.3],rotationSpeed:0.8},ECMesh:{scale:0.5,path:"environment/models/lumber_01.dae",numInstances:32},ECPickup:{carriedResource:[50,0],placed:!0,randomRadius:4,lifeTime:20},ECEffectSpawner:{onDestroyEffect:"sfx_dst_r_lumber"}};e.archetypes.a_r_stone={shouldPlayerSave:!1,
familyName:"rock",ECSprite:{size:0.5,path:"textures/orbblue.dds",additive:!0,color:[1,1,1,0.3],rotationSpeed:0.8},ECMesh:{scale:0.25,path:"environment/models/stone_01.dae",numInstances:32},ECPickup:{carriedResource:[0,5],placed:!0,randomRadius:4,lifeTime:15},ECEffectSpawner:{onDestroyEffect:"sfx_dst_r_stone"}};e.archetypes.a_r_stone_large={shouldPlayerSave:!1,familyName:"rock",ECSprite:{size:1,path:"textures/orbblue.dds",additive:!0,color:[1,1,1,0.3],rotationSpeed:0.8},ECMesh:{scale:0.5,path:"environment/models/stone_01.dae",
numInstances:32},ECPickup:{carriedResource:[0,50],placed:!0,randomRadius:4,lifeTime:20},ECEffectSpawner:{onDestroyEffect:"sfx_dst_r_stone"}};e.archetypes.a_r_amber={familyName:"amber",ECSprite:{size:0.8,path:"textures/orb.dds",additive:!0,color:[1,1,1,0.3],rotationSpeed:0.8},ECMesh:{scale:0.9,path:"environment/models/e_i_amber.dae",numInstances:32},ECPickup:{softCurrency:1,randomRadius:5,attractRadius:6,lifeTime:30},ECEffectSpawner:{onDestroyEffect:"sfx_dst_r_amber",incidentalEffect:"sfx_amb_amber",
incidentalMinTime:0.5,incidentalMaxTime:8}};e.archetypes.a_r_big_amber={familyName:"amber",ECSprite:{size:1.6,path:"textures/orb.dds",additive:!0,color:[1,1,1,0.3],rotationSpeed:0.4},ECMesh:{scale:1.2,path:"environment/models/e_i_amber.dae"},ECPickup:{softCurrency:10,randomRadius:2.5,attractRadius:6,lifeTime:-1},ECEffectSpawner:{onDestroyEffect:"sfx_dst_r_amber",incidentalEffect:"sfx_amb_amber",incidentalMinTime:0.5,incidentalMaxTime:8}};e.archetypes.a_r_xp1={familyName:"xpshard",ECSprite:{size:0.6,
path:"textures/orbblue.dds",additive:!0,color:[175/255,47/255,164/255,0.4],rotationSpeed:0.8},ECMesh:{scale:0.8,path:"environment/models/e_i_xp1x.dae"},ECPickup:{randomRadius:5,attractRadius:6,lifeTime:60,xp:1},ECEffectSpawner:{onDestroyEffect:"sfx_dst_r_xp",incidentalEffect:"sfx_amb_xp",incidentalMinTime:0.5,incidentalMaxTime:8}};e.archetypes.a_r_xp2={familyName:"xpshard",ECSprite:{size:0.6,path:"textures/orbblue.dds",additive:!0,color:[175/255,47/255,164/255,0.4],rotationSpeed:0.8},ECMesh:{scale:0.8,
path:"environment/models/e_i_xp1x.dae"},ECPickup:{randomRadius:5,attractRadius:6,lifeTime:60,xp:2},ECEffectSpawner:{onDestroyEffect:"sfx_dst_r_xp",incidentalEffect:"sfx_amb_xp",incidentalMinTime:0.5,incidentalMaxTime:8}};e.archetypes.a_r_xp3={familyName:"xpshard",ECSprite:{size:0.6,path:"textures/orbblue.dds",additive:!0,color:[175/255,47/255,164/255,0.4],rotationSpeed:0.8},ECMesh:{scale:0.8,path:"environment/models/e_i_xp1x.dae"},ECPickup:{randomRadius:5,attractRadius:6,lifeTime:60,xp:3},ECEffectSpawner:{onDestroyEffect:"sfx_dst_r_xp",
incidentalEffect:"sfx_amb_xp",incidentalMinTime:0.5,incidentalMaxTime:8}};e.archetypes.a_r_xp4={familyName:"xpshard",ECSprite:{size:0.6,path:"textures/orbblue.dds",additive:!0,color:[175/255,47/255,164/255,0.4],rotationSpeed:0.8},ECMesh:{scale:0.8,path:"environment/models/e_i_xp1x.dae"},ECPickup:{randomRadius:5,attractRadius:6,lifeTime:60,xp:4},ECEffectSpawner:{onDestroyEffect:"sfx_dst_r_xp",incidentalEffect:"sfx_amb_xp",incidentalMinTime:0.5,incidentalMaxTime:8}};e.archetypes.a_r_xp5={familyName:"xpshard",
ECSprite:{size:0.7,path:"textures/orbblue.dds",additive:!0,color:[175/255,47/255,164/255,0.4],rotationSpeed:0.8},ECMesh:{scale:1,path:"environment/models/e_i_xp1x.dae"},ECPickup:{randomRadius:5,attractRadius:6,lifeTime:60,xp:5},ECEffectSpawner:{onDestroyEffect:"sfx_dst_r_xp",incidentalEffect:"sfx_amb_xp",incidentalMinTime:0.5,incidentalMaxTime:8}};e.archetypes.a_r_xp6={familyName:"xpshard",ECSprite:{size:0.7,path:"textures/orbblue.dds",additive:!0,color:[175/255,47/255,164/255,0.4],rotationSpeed:0.8},
ECMesh:{scale:1,path:"environment/models/e_i_xp1x.dae"},ECPickup:{randomRadius:5,attractRadius:6,lifeTime:60,xp:6},ECEffectSpawner:{onDestroyEffect:"sfx_dst_r_xp",incidentalEffect:"sfx_amb_xp",incidentalMinTime:0.5,incidentalMaxTime:8}};e.archetypes.a_r_xp7={familyName:"xpshard",ECSprite:{size:0.7,path:"textures/orbblue.dds",additive:!0,color:[175/255,47/255,164/255,0.4],rotationSpeed:0.8},ECMesh:{scale:1,path:"environment/models/e_i_xp1x.dae"},ECPickup:{randomRadius:5,attractRadius:6,lifeTime:60,
xp:7},ECEffectSpawner:{onDestroyEffect:"sfx_dst_r_xp",incidentalEffect:"sfx_amb_xp",incidentalMinTime:0.5,incidentalMaxTime:8}};e.archetypes.a_r_xp8={familyName:"xpshard",ECSprite:{size:0.7,path:"textures/orbblue.dds",additive:!0,color:[175/255,47/255,164/255,0.4],rotationSpeed:0.8},ECMesh:{scale:1,path:"environment/models/e_i_xp1x.dae"},ECPickup:{randomRadius:5,attractRadius:6,lifeTime:60,xp:8},ECEffectSpawner:{onDestroyEffect:"sfx_dst_r_xp",incidentalEffect:"sfx_amb_xp",incidentalMinTime:0.5,incidentalMaxTime:8}};
e.archetypes.a_r_xp9={familyName:"xpshard",ECSprite:{size:0.7,path:"textures/orbblue.dds",additive:!0,color:[175/255,47/255,164/255,0.4],rotationSpeed:0.8},ECMesh:{scale:1,path:"environment/models/e_i_xp1x.dae"},ECPickup:{randomRadius:5,attractRadius:6,lifeTime:60,xp:9},ECEffectSpawner:{onDestroyEffect:"sfx_dst_r_xp",incidentalEffect:"sfx_amb_xp",incidentalMinTime:0.5,incidentalMaxTime:8}};e.archetypes.a_r_xp10={familyName:"xpshard",ECSprite:{size:0.8,path:"textures/orbblue.dds",additive:!0,color:[175/
255,47/255,164/255,0.4],rotationSpeed:0.8},ECMesh:{scale:1.2,path:"environment/models/e_i_xp1x.dae"},ECPickup:{randomRadius:5,attractRadius:6,lifeTime:60,xp:10},ECEffectSpawner:{onDestroyEffect:"sfx_dst_r_xp",incidentalEffect:"sfx_amb_xp",incidentalMinTime:0.5,incidentalMaxTime:8}};e.archetypes.a_r_xp20={familyName:"xpshard",ECSprite:{size:1.2,path:"textures/orbblue.dds",additive:!0,color:[175/255,47/255,164/255,0.4],rotationSpeed:0.8},ECMesh:{scale:1.2,path:"environment/models/e_i_xp1x.dae"},ECPickup:{randomRadius:5,
attractRadius:6,lifeTime:60,xp:20},ECEffectSpawner:{onDestroyEffect:"sfx_dst_r_xp",incidentalEffect:"sfx_amb_xp",incidentalMinTime:0.5,incidentalMaxTime:8}};e.archetypes.a_r_xp50={familyName:"xpshard",ECSprite:{size:1.5,path:"textures/orbblue.dds",additive:!0,color:[175/255,47/255,164/255,0.4],rotationSpeed:0.8},ECMesh:{scale:1.5,path:"environment/models/e_i_xp1x.dae"},ECPickup:{randomRadius:5,attractRadius:6,lifeTime:60,xp:50},ECEffectSpawner:{onDestroyEffect:"sfx_dst_r_xp",incidentalEffect:"sfx_amb_xp",
incidentalMinTime:0.5,incidentalMaxTime:8}};e.archetypes.a_r_xp100={familyName:"xpshard",ECSprite:{size:2,path:"textures/orbblue.dds",additive:!0,color:[175/255,47/255,164/255,0.4],rotationSpeed:0.8},ECMesh:{scale:1.5,path:"environment/models/e_i_xp1x.dae"},ECPickup:{randomRadius:5,attractRadius:6,lifeTime:60,xp:100},ECEffectSpawner:{onDestroyEffect:"sfx_dst_r_xp",incidentalEffect:"sfx_amb_xp",incidentalMinTime:0.5,incidentalMaxTime:8}};e.archetypes.a_r_xp500={familyName:"xpshard",ECSprite:{size:3,
path:"textures/orbblue.dds",additive:!0,color:[175/255,47/255,164/255,0.4],rotationSpeed:0.8},ECMesh:{scale:3,path:"environment/models/e_i_xp1x.dae"},ECPickup:{randomRadius:5,attractRadius:6,lifeTime:60,xp:500},ECEffectSpawner:{onDestroyEffect:"sfx_dst_r_xp",incidentalEffect:"sfx_amb_xp",incidentalMinTime:0.5,incidentalMaxTime:8}};e.archetypes.a_p_bombs={familyName:"bomb",ECMesh:{scale:0.5,path:"models/bomb.dae",numInstances:32},ECPickup:{item:"wp_h_bombs",itemAmmo:3,placed:!0,lifeTime:15}};e.archetypes.a_p_bomb=
{familyName:"bomb",ECMesh:{scale:1,path:"models/bomb.dae",numInstances:32},ECPickup:{item:"wp_h_bombs",itemAmmo:1,placed:!0,randomRadius:0,lifeTime:-1}};e.archetypes.a_p_heal={familyName:"bomb",ECMesh:{scale:2,path:"models/bomb.dae"},ECPickup:{health:10,placed:!0,randomRadius:0,lifeTime:-1}};e.archetypes.a_r_tree01={shouldPlayerSave:!0,shouldLevelSave:!0,familyName:"tree",ECMesh:{scale:2.75,randomScale:0.15,randomRotationY:Math.PI,offsetY:-0.5,path:"environment/models/e_i_tree02.dae"},ECPhysicsCube:{stationary:!1,
scaleMesh:!1,v3Scale:[0.5,5,0.5],offsetY:0,terrainType:"impass"},ECSelectable:{smart:!0,radiusFactor:1},ECInteractable:{requiresMovement:!1},ECResourceDispenser:{resourceType:E.LUMBER,growingMesh:"environment/models/e_i_treegrowing.dae",depletedMeshes:["environment/models/e_i_tree02trunk.dae","environment/models/e_i_tree02trunk02.dae","environment/models/e_i_tree02trunk03.dae","environment/models/e_i_tree02trunk04.dae"],maxResource:25,randMaxResource:0,growDuration:120,growDurationMax:240,resourcePerInteract:5,
regrows:!0,chanceOfSoftCurrencyPerInteraction:0.005},ECAnimationPlayer:{animationSet:"tree01"}};e.archetypes.a_r_tree02={shouldPlayerSave:!0,shouldLevelSave:!0,familyName:"tree",ECMesh:{scale:1.75*1.1,randomScale:0.15,randomRotationY:Math.PI,offsetY:-0.5,path:"environment/models/e_i_tree03.dae"},ECPhysicsCube:{stationary:!1,scaleMesh:!1,v3Scale:[0.5,5,0.5],offsetY:0,terrainType:"impass"},ECSelectable:{smart:!0,radiusFactor:1},ECInteractable:{requiresMovement:!1},ECResourceDispenser:{resourceType:E.LUMBER,
growingMesh:"environment/models/e_i_treegrowing.dae",depletedMeshes:["environment/models/e_i_tree03trunk.dae","environment/models/e_i_tree03trunk02.dae","environment/models/e_i_tree03trunk03.dae","environment/models/e_i_tree03trunk04.dae"],maxResource:50,randMaxResource:0,growDuration:240,growDurationMax:480,resourcePerInteract:5,regrows:!0,chanceOfSoftCurrencyPerInteraction:0.005},ECAnimationPlayer:{animationSet:"tree02"}};e.archetypes.a_r_tree04={shouldPlayerSave:!0,shouldLevelSave:!0,familyName:"tree",
ECMesh:{scale:1.75*1.1,randomScale:0.15,randomRotationY:Math.PI,offsetY:-0.5,path:"environment/models/e_i_tree04.dae"},ECPhysicsCube:{stationary:!1,scaleMesh:!1,v3Scale:[0.5,5,0.5],offsetY:0,terrainType:"impass"},ECSelectable:{smart:!0,radiusFactor:1},ECInteractable:{requiresMovement:!1},ECResourceDispenser:{resourceType:E.LUMBER,growingMesh:"environment/models/e_i_treegrowingblue.dae",depletedMeshes:["environment/models/e_i_tree04trunk.dae","environment/models/e_i_tree04trunk02.dae","environment/models/e_i_tree04trunk03.dae",
"environment/models/e_i_tree04trunk04.dae","environment/models/e_i_tree04trunk05.dae"],maxResource:50,randMaxResource:0,growDuration:240,growDurationMax:480,resourcePerInteract:5,regrows:!0,chanceOfSoftCurrencyPerInteraction:0.005},ECAnimationPlayer:{animationSet:"tree04"}};e.archetypes.a_scenerytest_BIGROCK_nophys={shouldPlayerSave:!0,shouldLevelSave:!0,familyName:"scenery",ECMesh:{scale:0.5,offsetY:-0.5,path:"environment/models/e_i_quarry01.dae"},ECPhysicsCube:{stationary:!0,scaleMesh:!1,v3Scale:[0.5,
0.5,0.5],offsetY:-0.25,terrainType:"impass"},ECResourceDispenser:{resourceType:E.STONE,growingMesh:"environment/models/e_i_quarry01.dae",depletedMeshes:["environment/models/e_i_quarry01.dae","environment/models/e_i_quarry02.dae","environment/models/e_i_quarry03.dae","environment/models/e_i_quarry04.dae","environment/models/e_i_quarry05.dae"],maxResource:15,randMaxResource:0,growDuration:50,growDurationMax:1E3,resourcePerInteract:5,regrows:!0,chanceOfSoftCurrencyPerInteraction:0.005}};e.archetypes.a_r_rock01=
{shouldPlayerSave:!0,shouldLevelSave:!0,familyName:"rock",ECMesh:{scale:0.5,randomScale:0.2,randomRotationY:Math.PI,offsetY:-0.5,path:"environment/models/e_i_quarry01.dae"},ECPhysicsCube:{stationary:!1,scaleMesh:!1,v3Scale:[0.5,0.5,0.5],offsetY:-0.25,terrainType:"impass"},ECSelectable:{radiusFactor:1,smart:!0},ECInteractable:{requiresMovement:!1},ECResourceDispenser:{resourceType:E.STONE,growingMesh:"environment/models/e_i_quarry01.dae",depletedMeshes:["environment/models/e_i_quarry01.dae","environment/models/e_i_quarry02.dae",
"environment/models/e_i_quarry03.dae","environment/models/e_i_quarry04.dae","environment/models/e_i_quarry05.dae"],maxResource:25,randMaxResource:0,growDuration:120,growDurationMax:240,resourcePerInteract:5,regrows:!0,chanceOfSoftCurrencyPerInteraction:0.005}};e.archetypes.a_r_rock02={shouldPlayerSave:!0,shouldLevelSave:!0,familyName:"rock",ECMesh:{scale:0.5,randomScale:0.1,randomRotationY:Math.PI,offsetY:-0.5,path:"environment/models/e_i_quarry01.dae"},ECPhysicsCube:{stationary:!1,scaleMesh:!1,v3Scale:[1,
1,1],offsetY:0,terrainType:"impass"},ECSelectable:{radiusFactor:1,smart:!0},ECInteractable:{requiresMovement:!1},ECResourceDispenser:{resourceType:E.STONE,growingMesh:"environment/models/e_i_quarry01.dae",depletedMeshes:["environment/models/e_i_quarry01.dae","environment/models/e_i_quarry02.dae","environment/models/e_i_quarry03.dae","environment/models/e_i_quarry04.dae","environment/models/e_i_quarry05.dae"],maxResource:35,randMaxResource:0,growDuration:120,growDurationMax:240,resourcePerInteract:5,
regrows:!0,chanceOfSoftCurrencyPerInteraction:0.005}};e.archetypes.a_r_rock03={shouldPlayerSave:!0,shouldLevelSave:!0,familyName:"rock",ECMesh:{scale:1,randomScale:0.1,randomRotationY:Math.PI,offsetY:-0.5,path:"environment/models/e_i_quarry01.dae"},ECPhysicsCube:{stationary:!1,scaleMesh:!1,v3Scale:[2,2,2],offsetY:0.5,terrainType:"impass"},ECSelectable:{radiusFactor:1,smart:!0},ECInteractable:{requiresMovement:!1},ECResourceDispenser:{resourceType:E.STONE,growingMesh:"environment/models/e_i_quarry01.dae",
depletedMeshes:["environment/models/e_i_quarry01.dae","environment/models/e_i_quarry02.dae","environment/models/e_i_quarry03.dae","environment/models/e_i_quarry04.dae","environment/models/e_i_quarry05.dae"],maxResource:50,randMaxResource:0,growDuration:240,growDurationMax:480,resourcePerInteract:5,regrows:!0,chanceOfSoftCurrencyPerInteraction:0.005}};e.archetypes.a_r_rock04={shouldPlayerSave:!0,shouldLevelSave:!0,familyName:"rock",ECMesh:{scale:1.2,randomScale:0.1,randomRotationY:Math.PI,offsetY:-0.5,
path:"environment/models/e_i_quarryspike01.dae"},ECPhysicsCube:{stationary:!1,scaleMesh:!1,v3Scale:[2,2,2],offsetY:0.5,terrainType:"impass"},ECSelectable:{radiusFactor:1,smart:!0},ECInteractable:{requiresMovement:!1},ECResourceDispenser:{resourceType:E.STONE,growingMesh:"environment/models/e_i_quarryspike01.dae",depletedMeshes:["environment/models/e_i_quarryspike01.dae","environment/models/e_i_quarryspike02.dae","environment/models/e_i_quarryspike03.dae","environment/models/e_i_quarryspike04.dae",
"environment/models/e_i_quarryspike05.dae"],maxResource:50,randMaxResource:0,growDuration:240,growDurationMax:480,resourcePerInteract:5,regrows:!0,chanceOfSoftCurrencyPerInteraction:0.005}};e.archetypes.a_r_mushroomMap={shouldPlayerSave:!0,shouldLevelSave:!1,familyName:"mushroom",ECMesh:{scale:2.8,offsetY:-0.6,randomScale:0.25,randomRotationY:Math.PI,path:"environment/models/e_i_mushroomblue.dae"},ECSockets:{sockets:[{archetypeName:"v_socket_glow_green",localOffset:[0,0.25,0]}]},ECPhysicsCube:{stationary:!1,
scaleMesh:!1,v3Scale:[0.3,0.3,0.3],offsetY:0},ECSelectable:{radiusFactor:1,smart:!1},ECTarget:null,ECHealth:{health:1,rooted:!0},ECLootDropper:{coinGroups:[{number:1,likelihood:0.75,archetype:"a_r_amber"}],roomID:-1},ECEffectSpawner:{onCreateEffect:"sfx_mushroom1_puff",impactEffect:"sfx_mushroom_hit",onDestroyEffect:"sfx_mushroom1_puff"}};e.archetypes.a_r_mushroomR1={shouldPlayerSave:!0,shouldLevelSave:!0,familyName:"mushroom",ECMesh:{scale:2.8,offsetY:-0.6,randomScale:0.25,randomRotationY:Math.PI,
path:"environment/models/e_i_mushroomblue.dae"},ECSockets:{sockets:[{archetypeName:"v_socket_glow_green",localOffset:[0,0.25,0]}]},ECPhysicsCube:{stationary:!1,scaleMesh:!1,v3Scale:[0.3,0.3,0.3],offsetY:0},ECSelectable:{radiusFactor:1,smart:!1},ECTarget:null,ECHealth:{health:1,rooted:!0},ECLootDropper:{coinGroups:[{number:1,likelihood:0.4,archetype:"a_r_amber"}],roomID:-1},ECEffectSpawner:{onCreateEffect:"sfx_mushroom1_puff",impactEffect:"sfx_mushroom_hit",onDestroyEffect:"sfx_mushroom1_puff"}};e.archetypes.a_r_mushroomR2=
{shouldPlayerSave:!0,shouldLevelSave:!0,familyName:"mushroom",ECMesh:{scale:2.8,offsetY:-0.6,randomScale:0.25,randomRotationY:Math.PI,path:"environment/models/e_i_mushroompink.dae"},ECSockets:{sockets:[{archetypeName:"v_socket_glow_purple",localOffset:[0,0.15,0]}]},ECPhysicsCube:{stationary:!1,scaleMesh:!1,v3Scale:[0.3,0.3,0.3],offsetY:0},ECSelectable:{radiusFactor:1,smart:!1},ECTarget:null,ECHealth:{health:1,rooted:!0},ECLootDropper:{coinGroups:[{number:1,likelihood:0.4,archetype:"a_r_amber"}],roomID:-1},
ECEffectSpawner:{onCreateEffect:"sfx_mushroom2_puff",impactEffect:"sfx_mushroom_hit",onDestroyEffect:"sfx_mushroom2_puff"}};e.archetypes.a_r_mushroomR3={shouldPlayerSave:!0,shouldLevelSave:!0,familyName:"mushroom",ECMesh:{scale:2.8,offsetY:-0.6,randomScale:0.25,randomRotationY:Math.PI,path:"environment/models/e_i_mushroomyellow.dae"},ECSockets:{sockets:[{archetypeName:"v_socket_glow_red",localOffset:[0,0.15,0]}]},ECPhysicsCube:{stationary:!1,scaleMesh:!1,v3Scale:[0.3,0.3,0.3],offsetY:1},ECSelectable:{radiusFactor:1,
smart:!1},ECTarget:null,ECHealth:{health:1,rooted:!0},ECLootDropper:{coinGroups:[{number:1,likelihood:0.4,archetype:"a_r_amber"}],roomID:-1},ECEffectSpawner:{onCreateEffect:"sfx_mushroom3_puff",impactEffect:"sfx_mushroom_hit",onDestroyEffect:"sfx_mushroom3_puff"}};e.archetypes.a_r_mushroom_patch_small={shouldPlayerSave:!0,shouldLevelSave:!0,ECEntitySpawnManager:{minTimeBetweenAddingNewEntity:7200,maxTimeBetweenAddingNewEntity:43200,entityArchetypes:[{likelihood:0.33,archetype:"a_r_mushroomR1"},{likelihood:0.33,
archetype:"a_r_mushroomR2"},{likelihood:0.33,archetype:"a_r_mushroomR3"}],maxEntities:5,randomGenerateRadius:4}};e.archetypes.a_r_mushroom_single={shouldPlayerSave:!0,shouldLevelSave:!0,ECEntitySpawnManager:{minTimeBetweenAddingNewEntity:14400,maxTimeBetweenAddingNewEntity:93600,entityArchetypes:[{likelihood:0.33,archetype:"a_r_mushroomR1"},{likelihood:0.33,archetype:"a_r_mushroomR2"},{likelihood:0.33,archetype:"a_r_mushroomR3"}],maxEntities:1,randomGenerateRadius:0.5}};e.archetypes.v_socket_glow_purple=
{ECSprite:{size:0.6,offsetY:0,path:"textures/glowstumpy.dds",additive:!0,color:[225/255,32/255,122/255,0.3]}};e.archetypes.v_socket_glow_green={ECSprite:{size:0.7,offsetY:0,path:"textures/glowstumpy.dds",additive:!0,color:[31/255,1,0,0.2]}};e.archetypes.v_socket_glow_red={ECSprite:{size:0.6,offsetY:0,path:"textures/glowstumpy.dds",additive:!0,color:[1,60/255,0,0.2]}};e.archetypes.a_r_xpplantMap={shouldPlayerSave:!0,shouldLevelSave:!1,familyName:"xpplant",ECMesh:{scale:1.2,offsetY:-0.5,randomScale:0.25,
randomRotationY:Math.PI,path:"environment/models/e_i_xpplant01.dae"},ECSockets:{sockets:[{archetypeName:"v_socket_glow_xpp_purple",localOffset:[0,0.6,0]}]},ECPhysicsCube:{stationary:!1,scaleMesh:!1,v3Scale:[0.3,0.3,0.3],offsetY:0},ECSelectable:{radiusFactor:1,smart:!1},ECTarget:null,ECHealth:{health:1,rooted:!0},ECLootDropper:{coinGroups:[{number:1,likelihood:0.75,archetype:"a_r_xp50"}],roomID:-1},ECEffectSpawner:{onCreateEffect:"sfx_mushroom1_puff",impactEffect:"sfx_mushroom_hit",onDestroyEffect:"sfx_mushroom1_puff"}};
e.archetypes.a_r_xpplant1={shouldPlayerSave:!0,shouldLevelSave:!0,familyName:"xpplant",ECMesh:{scale:1.2,offsetY:-0.5,randomScale:0.25,randomRotationY:Math.PI,path:"environment/models/e_i_xpplant01.dae"},ECSockets:{sockets:[{archetypeName:"v_socket_glow_xpp_purple",localOffset:[0,0.6,0]}]},ECPhysicsCube:{stationary:!1,scaleMesh:!1,v3Scale:[0.3,0.3,0.3],offsetY:0},ECSelectable:{radiusFactor:1,smart:!1},ECTarget:null,ECHealth:{health:1,rooted:!0},ECLootDropper:{coinGroups:[{number:1,likelihood:0.4,
archetype:"a_r_xp50"}],roomID:-1},ECEffectSpawner:{onCreateEffect:"sfx_mushroom1_puff",impactEffect:"sfx_mushroom_hit",onDestroyEffect:"sfx_mushroom1_puff"}};e.archetypes.a_r_xpplant2={shouldPlayerSave:!0,shouldLevelSave:!0,familyName:"xpplant",ECMesh:{scale:1.2,offsetY:-0.5,randomScale:0.25,randomRotationY:Math.PI,path:"environment/models/e_i_xpplant02.dae"},ECSockets:{sockets:[{archetypeName:"v_socket_glow_xpp_purple",localOffset:[0,0.15,0]}]},ECPhysicsCube:{stationary:!1,scaleMesh:!1,v3Scale:[0.3,
0.3,0.3],offsetY:0},ECSelectable:{radiusFactor:1,smart:!1},ECTarget:null,ECHealth:{health:1,rooted:!0},ECLootDropper:{coinGroups:[{number:1,likelihood:0.4,archetype:"a_r_xp50"}],roomID:-1},ECEffectSpawner:{onCreateEffect:"sfx_mushroom2_puff",impactEffect:"sfx_mushroom_hit",onDestroyEffect:"sfx_mushroom2_puff"}};e.archetypes.a_r_xpplant3={shouldPlayerSave:!0,shouldLevelSave:!0,familyName:"xpplant",ECMesh:{scale:1.2,offsetY:-0.5,randomScale:0.25,randomRotationY:Math.PI,path:"environment/models/e_i_xpplant03.dae"},
ECSockets:{sockets:[{archetypeName:"v_socket_glow_xpp_purple",localOffset:[0,0.65,0]}]},ECPhysicsCube:{stationary:!1,scaleMesh:!1,v3Scale:[0.3,0.3,0.3],offsetY:1},ECSelectable:{radiusFactor:1,smart:!1},ECTarget:null,ECHealth:{health:1,rooted:!0},ECLootDropper:{coinGroups:[{number:1,likelihood:0.4,archetype:"a_r_xp50"}],roomID:-1},ECEffectSpawner:{onCreateEffect:"sfx_mushroom3_puff",impactEffect:"sfx_mushroom_hit",onDestroyEffect:"sfx_mushroom3_puff"}};e.archetypes.a_r_xpplant_patch_small={shouldPlayerSave:!0,
shouldLevelSave:!0,ECEntitySpawnManager:{minTimeBetweenAddingNewEntity:7200,maxTimeBetweenAddingNewEntity:43200,entityArchetypes:[{likelihood:0.33,archetype:"a_r_xpplant1"},{likelihood:0.33,archetype:"a_r_xpplant2"},{likelihood:0.33,archetype:"a_r_xpplant3"}],maxEntities:3,randomGenerateRadius:3}};e.archetypes.a_r_xpplant_single={shouldPlayerSave:!0,shouldLevelSave:!0,ECEntitySpawnManager:{minTimeBetweenAddingNewEntity:14400,maxTimeBetweenAddingNewEntity:93600,entityArchetypes:[{likelihood:0.33,archetype:"a_r_xpplant1"},
{likelihood:0.33,archetype:"a_r_xpplant2"},{likelihood:0.33,archetype:"a_r_xpplant3"}],maxEntities:1,randomGenerateRadius:0.5}};e.archetypes.v_socket_glow_xpp_purple={ECSprite:{size:0.7,offsetY:0,path:"textures/glowstumpy.dds",additive:!0,color:[225/255,32/255,122/255,0.2]}};e.archetypes.v_socket_glow_xpp_green={ECSprite:{size:0.7,offsetY:0,path:"textures/glowstumpy.dds",additive:!0,color:[31/255,1,0,0.2]}};e.archetypes.v_socket_glow_xpp_red={ECSprite:{size:0.6,offsetY:0,path:"textures/glowstumpy.dds",
additive:!0,color:[1,60/255,0,0.2]}};O.archetypes.a_bl_invisible_impass={isBuildZone:!1,hasPhysics:!0,terrainType:"impass"};O.archetypes.a_bl_invisible_nobuild={isBuildZone:!1,hasPhysics:!0};O.archetypes.a_bl_invisible_no_terrain={hasPhysics:!0,isBuildZone:!0};O.archetypes.a_bl_invisible_build_zone={hasPhysics:!0,isBuildZone:!0};O.archetypes.a_bl_grasscube_impass={path:"models/CubeHill.dae",hasPhysics:!0,isBuildZone:!1,terrainType:"impass"};O.archetypes.a_bl_proto_cube={path:"environment/models/prototype_cube.dae",
hasPhysics:!0,isBuildZone:!0};O.archetypes.a_bl_proto_cube_no_build={path:"environment/models/prototype_cube.dae",hasPhysics:!0,isBuildZone:!1};O.archetypes.a_bl_proto_cube02={path:"environment/models/prototype_cube02.dae",hasPhysics:!0,isBuildZone:!0};O.archetypes.a_bl_proto_cube02_no_build={path:"environment/models/prototype_cube02.dae",hasPhysics:!0,isBuildZone:!1};O.archetypes.a_bl_proto_cube03={path:"environment/models/prototype_cube03.dae",hasPhysics:!0,isBuildZone:!0};O.archetypes.a_bl_e_d_rockcliffedge01=
{path:"environment/models/e_s_rockcliffedge01.dae"};O.archetypes.a_bl_e_d_rockcliffedge02={path:"environment/models/e_s_rockcliffedge02.dae"};O.archetypes.a_bl_e_d_rockcliffedge03={path:"environment/models/e_s_rockcliffedge03.dae"};O.archetypes.a_bl_e_d_rockcavern={path:"environment/models/e_s_invasioncavern.dae"};O.archetypes.a_bl_e_d_hillbig={path:"environment/models/e_s_rockcliff20by20.dae",hasPhysics:!0,terrainType:"impass"};O.archetypes.a_bl_e_d_hillmed={path:"environment/models/e_s_rockcliff10by10.dae",
hasPhysics:!0,terrainType:"impass"};O.archetypes.a_bl_e_d_hillsml={path:"environment/models/e_s_rockcliff3by3.dae",hasPhysics:!0,terrainType:"impass"};O.archetypes.a_bl_e_d_rockcliffarch01={path:"environment/models/e_s_rockseacliff01.dae"};O.archetypes.a_bl_e_d_rockcliffarch02={path:"environment/models/e_s_rockseacliff02.dae"};O.archetypes.a_bl_e_d_rockspikebig={path:"environment/models/e_s_rockspikebig.dae",hasPhysics:!0,terrainType:"impass"};O.archetypes.a_bl_e_d_rockspikemed={path:"environment/models/e_s_rockspikemed.dae",
hasPhysics:!0,terrainType:"impass"};O.archetypes.a_bl_e_d_rockspikesml={path:"environment/models/e_s_rockspikesmall.dae",hasPhysics:!0,terrainType:"impass"};O.archetypes.a_bl_e_d_patchsand={path:"environment/models/e_s_sandpatchbig.dae"};O.archetypes.a_bl_e_d_patchgrass={path:"environment/models/e_s_patchgrassbig.dae"};O.archetypes.a_bl_e_d_torchpost={path:"environment/models/e_s_torchpost.dae",hasPhysics:!0,terrainType:"impass"};O.archetypes.a_bl_e_d_grass01={path:"environment/models/e_s_grassblade01.dae"};
O.archetypes.a_bl_e_d_grass02={path:"environment/models/e_s_grassblade02.dae"};O.archetypes.a_bl_e_d_patchdeco01={path:"environment/models/e_s_decopatch01.dae"};O.archetypes.a_bl_e_d_patchdeco02={path:"environment/models/e_s_decopatch02.dae"};O.archetypes.a_bl_e_d_patchdeco03={path:"environment/models/e_s_decopatch03.dae"};O.archetypes.a_bl_e_d_patchdeco04={path:"environment/models/e_s_decopatch04.dae"};O.archetypes.a_bl_e_d_rockcliffwaterfall={path:"environment/models/rockprop_01.dae"};O.archetypes.a_bl_e_d_hillstepcorner=
{path:"environment/models/e_s_hillstepcorner.dae",hasPhysics:!0,v3PhysicsScale:[1,1,1]};O.archetypes.a_bl_e_d_hillstep_02={path:"environment/models/e_s_hillstep_02.dae",hasPhysics:!0,v3PhysicsScale:[1,1,1]};O.archetypes.a_bl_e_d_hillstep_01={path:"environment/models/e_s_hillstep_01.dae",hasPhysics:!0,v3PhysicsScale:[1,1,1]};O.archetypes.a_bl_e_d_hillstep_double={path:"environment/models/e_s_hillstep_double.dae",hasPhysics:!0,v3PhysicsScale:[2,1,1]};O.archetypes.a_bl_e_d_hillsteptop={path:"environment/models/e_s_hillsteptop02.dae",
hasPhysics:!0,v3PhysicsScale:[1,1,1],v3PhysicsOffset:[0,-0.5,0]};O.archetypes.a_bl_e_d_hillsteptop_double={path:"environment/models/e_s_hillsteptop_double.dae",hasPhysics:!0,v3PhysicsScale:[2,1,1],v3PhysicsOffset:[0,-0.5,0]};O.archetypes.a_bl_e_d_hillcorner={path:"environment/models/e_s_hillcorner.dae",hasPhysics:!0};O.archetypes.a_bl_e_d_hillcorner_hole={path:"environment/models/e_s_hillcorner_hole.dae",hasPhysics:!0};O.archetypes.a_bl_e_d_hill_02={path:"environment/models/e_s_hill_02.dae",hasPhysics:!0};
O.archetypes.a_bl_e_d_hill_01={path:"environment/models/e_s_hill_01.dae",hasPhysics:!0};O.archetypes.a_bl_e_d_hill_double={path:"environment/models/e_s_hill_double.dae",hasPhysics:!0};O.archetypes.a_bl_e_d_hilltop={path:"environment/models/e_s_hilltop02.dae",hasPhysics:!0,v3PhysicsScale:[1,1,1],v3PhysicsOffset:[0,-0.5,0]};O.archetypes.a_bl_e_d_hilltop_double={path:"environment/models/e_s_hilltop_double.dae",hasPhysics:!0,v3PhysicsScale:[1,1,1],v3PhysicsOffset:[0,-0.5,0]};O.archetypes.a_bl_e_d_wildlingtunnel=
{path:"environment/models/e_s_wildlingtunnel.dae"};O.archetypes.a_bl_e_d_tunnelblocker={path:"environment/models/e_s_tunnelblocker.dae"};O.archetypes.a_bl_e_d_patchbrownsmall={path:"environment/models/e_s_patchbrownsmall.dae"};O.archetypes.a_bl_e_s_skywind={path:"environment/models/e_s_skywind.dae"};O.archetypes.a_bl_e_s_skywind_curved={path:"environment/models/e_s_skywind_curved.dae"};O.archetypes.a_bl_e_s_skywind_twirl={path:"environment/models/e_s_skywind_twirl.dae"};O.archetypes.a_bl_e_s_skydome=
{path:"environment/models/e_s_skydome.dae"};O.archetypes.a_bl_e_v_marketplace={path:"environment/models/e_v_marketplace.dae"};O.archetypes.a_bl_e_v_lightcrystal={path:"environment/models/e_v_lightcrystal.dae"};O.archetypes.a_bl_e_v_lightcrystalpurple={path:"environment/models/e_v_lightcrystalpurple.dae"};O.archetypes.a_bl_e_v_lightcrystalblue={path:"environment/models/e_v_lightcrystalblue.dae"};O.archetypes.a_bl_e_v_lightcrystalgreen={path:"environment/models/e_v_lightcrystalgreen.dae"};O.archetypes.a_bl_e_v_lightcrystalpink=
{path:"environment/models/e_v_lightcrystalpink.dae"};O.archetypes.a_bl_e_v_lightcrystalred={path:"environment/models/e_v_lightcrystalred.dae"};O.archetypes.a_bl_e_v_lightcrystalyellow={path:"environment/models/e_v_lightcrystalyellow.dae"};O.archetypes.a_bl_e_v_lightlantern={path:"environment/models/e_v_lightlantern.dae"};O.archetypes.a_bl_e_v_citybell={path:"environment/models/e_v_citybell.dae"};O.archetypes.a_bl_e_v_citygong={path:"environment/models/e_v_citygong.dae"};O.archetypes.a_bl_e_v_crystalplate=
{path:"environment/models/e_v_crystalplate.dae"};O.archetypes.a_bl_e_v_crystalplateyellow={path:"environment/models/e_v_crystalplateyellow.dae"};O.archetypes.a_bl_e_v_crystalplatered={path:"environment/models/e_v_crystalplatered.dae"};O.archetypes.a_bl_e_v_crystalplateblue={path:"environment/models/e_v_crystalplateblue.dae"};O.archetypes.a_bl_e_v_crystalplategreen={path:"environment/models/e_v_crystalplategreen.dae"};O.archetypes.a_bl_e_v_crystalplatepurple={path:"environment/models/e_v_crystalplatepurple.dae"};
O.archetypes.a_bl_e_v_crystalplatepink={path:"environment/models/e_v_crystalplatepink.dae"};O.archetypes.a_bl_e_v_flowerpot={path:"environment/models/e_v_flowerpot.dae"};O.archetypes.a_bl_e_v_statuesage={path:"environment/models/e_v_statuesage.dae"};O.archetypes.a_bl_e_v_flagred={path:"environment/models/e_v_flagred.dae"};O.archetypes.a_bl_e_v_flagyellow={path:"environment/models/e_v_flagyellow.dae"};O.archetypes.a_bl_e_v_flagblue={path:"environment/models/e_v_flagblue.dae"};O.archetypes.a_bl_e_v_flaggreen=
{path:"environment/models/e_v_flaggreen.dae"};O.archetypes.a_bl_e_v_flagpurple={path:"environment/models/e_v_flagpurple.dae"};O.archetypes.a_bl_e_v_flagdark={path:"environment/models/e_v_flagdark.dae"};O.archetypes.a_bl_e_v_flagblack={path:"environment/models/e_v_flagblack.dae"};O.archetypes.a_bl_e_v_flagwhite={path:"environment/models/e_v_flagwhite.dae"};O.archetypes.a_bl_e_v_fountain01={path:"environment/models/e_v_fountain01.dae"};O.archetypes.a_bl_e_v_floortiles01={path:"environment/models/e_v_floortiles01.dae"};
O.archetypes.a_bl_e_v_floortiles02={path:"environment/models/e_v_floortiles02.dae"};O.archetypes.a_bl_e_s_bridge={path:"environment/models/e_s_bridge.dae"};O.archetypes.a_bl_e_s_shipwreck={path:"environment/models/e_s_shipwreck.dae"};O.archetypes.a_bl_e_s_crate={path:"environment/models/e_s_crate.dae",hasPhysics:!0,v3PhysicsScale:[1,1,1]};O.archetypes.a_bl_e_s_plank={path:"environment/models/e_s_floatingplank.dae",hasPhysics:!0,v3PhysicsScale:[1.3,0.1,0.5]};O.archetypes.a_bl_e_s_ripple_circ={path:"environment/models/e_s_circularripple.dae"};
O.archetypes.a_bl_e_s_weaponcrate={path:"environment/models/e_s_weaponcrate.dae",hasPhysics:!0,v3PhysicsScale:[2,1,1]};O.archetypes.a_bl_e_s_grassbladeflower01={path:"environment/models/e_s_grassbladeflower01.dae"};O.archetypes.a_bl_e_s_grassbladeflower02={path:"environment/models/e_s_grassbladeflower02.dae"};O.archetypes.a_bl_e_s_grassbladeflower03={path:"environment/models/e_s_grassbladeflower03.dae"};O.archetypes.a_bl_e_i_tree04={path:"environment/models/e_i_tree04.dae"};O.archetypes.a_bl_e_s_skull01=
{path:"environment/models/e_s_skull01.dae"};O.archetypes.a_bl_e_s_pathtiles={path:"environment/models/e_s_pathtiles.dae"};O.archetypes.a_bl_e_s_pathcurve={path:"environment/models/e_s_pathcurve.dae"};O.archetypes.a_bl_e_s_path_l={path:"environment/models/e_s_path01.dae"};O.archetypes.a_bl_e_s_path_m={path:"environment/models/e_s_path02.dae"};O.archetypes.a_bl_e_s_path_s={path:"environment/models/e_s_path03.dae"};O.archetypes.a_bl_e_s_riverbank_top06={path:"environment/models/e_s_riverbank_top06.dae"};
O.archetypes.a_bl_e_s_riverbank_top05={path:"environment/models/e_s_riverbank_top05.dae"};O.archetypes.a_bl_e_s_riverbank_top04={path:"environment/models/e_s_riverbank_top04.dae"};O.archetypes.a_bl_e_s_riverbank_top03={path:"environment/models/e_s_riverbank_top03.dae"};O.archetypes.a_bl_e_s_riverbank_top02={path:"environment/models/e_s_riverbank_top02.dae"};O.archetypes.a_bl_e_s_riverbank_top01={path:"environment/models/e_s_riverbank_top01.dae"};O.archetypes.a_bl_e_s_sea10by10={path:"environment/models/e_s_sea10by10.dae"};
O.archetypes.a_bl_e_s_seashore10by10_03={path:"environment/models/e_s_seashore10by10_03.dae"};O.archetypes.a_bl_e_s_seashore10by10_02={path:"environment/models/e_s_seashore10by10_02.dae"};O.archetypes.a_bl_e_s_seashore10by10_01={path:"environment/models/e_s_seashore10by10_01.dae"};O.archetypes.a_bl_e_s_riverend01right={path:"environment/models/e_s_riverend01right.dae"};O.archetypes.a_bl_e_s_riverend01={path:"environment/models/e_s_riverend01.dae"};O.archetypes.a_bl_e_s_lake20by20_04={path:"environment/models/e_s_lake20by20_04.dae"};
O.archetypes.a_bl_e_s_lake20by20_03={path:"environment/models/e_s_lake20by20_03.dae"};O.archetypes.a_bl_e_s_lake20by20_02={path:"environment/models/e_s_lake20by20_02.dae"};O.archetypes.a_bl_e_s_lake20by20_01={path:"environment/models/e_s_lake20by20_01.dae"};O.archetypes.a_bl_e_s_riverbank_bott06={path:"environment/models/e_s_riverbank_bott06.dae"};O.archetypes.a_bl_e_s_riverbank_bott05={path:"environment/models/e_s_riverbank_bott05.dae"};O.archetypes.a_bl_e_s_riverbank_bott04={path:"environment/models/e_s_riverbank_bott04.dae"};
O.archetypes.a_bl_e_s_riverbank_bott03={path:"environment/models/e_s_riverbank_bott03.dae"};O.archetypes.a_bl_e_s_riverbank_bott02={path:"environment/models/e_s_riverbank_bott02.dae"};O.archetypes.a_bl_e_s_riverbank_bott01={path:"environment/models/e_s_riverbank_bott01.dae"};O.archetypes.a_bl_e_s_lake10by10={path:"environment/models/e_s_lake10by10.dae"};O.archetypes.a_bl_e_s_grasspatch10by10={path:"environment/models/e_s_grasspatch10by10.dae"};e.archetypes.a_d_bombplant={shouldPlayerSave:!0,familyName:"resupply",
ECMesh:{scaleX:1,scaleY:1,scaleZ:1,offsetY:-0.5,path:"environment/models/e_b_gatebase_level_1.dae"},ECPhysicsCube:{stationary:!0,offsetY:-0.495,v3Scale:[1,0.05,1],scaleMesh:!1},ECHealth:{health:5,drawInWorldBarIfDamagedRecently:!0},ECFaction:e.EC_DEFAULT,ECTarget:e.EC_DEFAULT,ECBuilding:{resourceCost:20,secondaryResourceCost:0,buildTime:0,rebuildTime:0,canSpeedUpWithSoftCurrency:!0,buildingType:"Defence",level:1,addedFootprintSize:0,mustPlaceNearCreator:!0,obeysScaffoldCap:!1,scaffoldType:"war",usesInfiniteBuildMode:!1,
prerequisites:[{buildingType:"HQ",level:1}],randomRotate:!0},ECEntitySpawnManager:{minTimeBetweenAddingNewEntity:20,maxTimeBetweenAddingNewEntity:20,entityArchetypes:[{likelihood:1,archetype:"a_p_bomb"}],maxEntities:1,randomGenerateRadius:0}};e.archetypes.a_d_healplant={shouldPlayerSave:!0,familyName:"resupply",ECMesh:{scaleX:1,scaleY:1,scaleZ:1,offsetY:-0.5,path:"environment/models/e_b_gatebase_level_1.dae"},ECPhysicsCube:{stationary:!0,offsetY:-0.495,v3Scale:[1,0.05,1],scaleMesh:!1},ECHealth:{health:5,
drawInWorldBarIfDamagedRecently:!0},ECFaction:e.EC_DEFAULT,ECTarget:e.EC_DEFAULT,ECBuilding:{resourceCost:20,secondaryResourceCost:0,buildTime:0,rebuildTime:0,canSpeedUpWithSoftCurrency:!0,buildingType:"Defence",level:1,addedFootprintSize:0,obeysScaffoldCap:!1,mustPlaceNearCreator:!0,scaffoldType:"war",usesInfiniteBuildMode:!1,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Heal Unlock",level:2,minimumQuantity:0,maximumQuantity:1}],randomRotate:!0},ECEntitySpawnManager:{minTimeBetweenAddingNewEntity:60,
maxTimeBetweenAddingNewEntity:60,entityArchetypes:[{likelihood:1,archetype:"a_p_heal"}],maxEntities:1,randomGenerateRadius:0}};e.archetypes.a_d_barrel={shouldPlayerSave:!0,familyName:"barrel",ECMesh:{scale:1,path:"environment/models/e_b_barrel.dae",offsetY:-0.5},ECPhysicsCube:{stationary:!0,offsetY:0,v3Scale:[1,1,1],scaleMesh:!1,terrainType:"building"},ECInteractable:{selectType:"selectTypePrepare"},ECSelectable:{radiusFactor:1,smart:!1,selectType:"selectTypeWar"},ECTarget:{onlyTargetedByFriendlyUnits:!0},
ECHealth:{health:e.balanceDefences.a_d_barrel.health,takesFullDamageFromFriendlyFire:!0,canOnlyBeDamagedByHero:!0,immuneToIndirectHits:!0,deathBehavior:"none",rooted:!0},ECFaction:e.EC_DEFAULT,ECExplode:{damageType:"dg_d_barrel",explodeOnDeath:!0,sfxArchetype:"sfx_explosionBarrel"},ECBuilding:{resourceCost:e.balanceDefences.a_d_barrel.resourceCost,secondaryResourceCost:0,buildTime:e.balanceDefences.a_d_barrel.buildTime,canSpeedUpWithSoftCurrency:!0,buildingType:"Trap",buildingName:"Barrel",obeysScaffoldCap:!1,
scaffoldType:"war",usesInfiniteBuildMode:!0,mustPlaceNearCreator:!0,level:1,addedFootprintSize:0,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Barrel Unlock",level:2,minimumQuantity:0,maximumQuantity:1}]},ECRadialMenu:e.EC_DEFAULT};A.archetypes.dg_d_barrel=A.create("Barrel Explosion",{damage:e.balanceDefences.a_d_barrel.damage,buildingDamage:e.balanceDefences.a_d_barrel.buildingDamage,forceBack:e.balanceDefences.a_d_barrel.forceBack,forceLift:e.balanceDefences.a_d_barrel.forceLift,
forceRadial:e.balanceDefences.a_d_barrel.forceRadial,forceTangential:0,radius:e.balanceDefences.a_d_barrel.radius,isExplosion:!0,friendlyFire:e.balanceDefences.a_d_barrel.friendlyFire});e.archetypes.a_d_barrel_level_2={parent:"a_d_barrel",ECMesh:{scale:1,path:"environment/models/e_b_barrel_02.dae",offsetY:-0.5},ECHealth:{health:e.balanceDefences.a_d_barrel_level_2.health,takesFullDamageFromFriendlyFire:!0,canOnlyBeDamagedByHero:!0,immuneToIndirectHits:!0,deathBehavior:"none",rooted:!0},ECExplode:{damageType:"dg_d_barrel_level_2",
explodeOnDeath:!0,sfxArchetype:"sfx_explosionBarrel"},ECBuilding:{resourceCost:e.balanceDefences.a_d_barrel_level_2.resourceCost,secondaryResourceCost:0,buildTime:e.balanceDefences.a_d_barrel_level_2.buildTime,canSpeedUpWithSoftCurrency:!0,buildingType:"Trap",obeysScaffoldCap:!1,scaffoldType:"war",usesInfiniteBuildMode:!0,level:2,addedFootprintSize:0,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Barrel Unlock",level:2,minimumQuantity:1},{buildingType:"Barrel Unlock",level:3,
minimumQuantity:0,maximumQuantity:1}]}};A.archetypes.dg_d_barrel_level_2=A.create("Barrel Explosion",{damage:e.balanceDefences.a_d_barrel_level_2.damage,buildingDamage:e.balanceDefences.a_d_barrel_level_2.buildingDamage,forceBack:e.balanceDefences.a_d_barrel_level_2.forceBack,forceLift:e.balanceDefences.a_d_barrel_level_2.forceLift,forceRadial:e.balanceDefences.a_d_barrel_level_2.forceRadial,forceTangential:0,radius:e.balanceDefences.a_d_barrel_level_2.radius,isExplosion:!0,friendlyFire:e.balanceDefences.a_d_barrel_level_2.friendlyFire});
e.archetypes.a_d_barrel_level_3={parent:"a_d_barrel_level_2",ECMesh:{scale:1,path:"environment/models/e_b_barrel_03.dae",offsetY:-0.5},ECHealth:{health:e.balanceDefences.a_d_barrel_level_3.health,takesFullDamageFromFriendlyFire:!0,canOnlyBeDamagedByHero:!0,immuneToIndirectHits:!0,deathBehavior:"none",rooted:!0},ECExplode:{damageType:"dg_d_barrel_level_3",explodeOnDeath:!0,sfxArchetype:"sfx_explosionBarrel"},ECBuilding:{resourceCost:e.balanceDefences.a_d_barrel_level_3.resourceCost,secondaryResourceCost:0,
buildTime:e.balanceDefences.a_d_barrel_level_3.buildTime,canSpeedUpWithSoftCurrency:!0,buildingType:"Trap",obeysScaffoldCap:!1,scaffoldType:"war",usesInfiniteBuildMode:!0,level:3,addedFootprintSize:0,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Barrel Unlock",level:3,minimumQuantity:1},{buildingType:"Barrel Unlock",level:4,minimumQuantity:0,maximumQuantity:1}]}};A.archetypes.dg_d_barrel_level_3=A.create("Barrel Explosion",{damage:e.balanceDefences.a_d_barrel_level_3.damage,
buildingDamage:e.balanceDefences.a_d_barrel_level_3.buildingDamage,forceBack:e.balanceDefences.a_d_barrel_level_3.forceBack,forceLift:e.balanceDefences.a_d_barrel_level_3.forceLift,forceRadial:e.balanceDefences.a_d_barrel_level_3.forceRadial,forceTangential:0,radius:e.balanceDefences.a_d_barrel_level_3.radius,isExplosion:!0,friendlyFire:e.balanceDefences.a_d_barrel_level_3.friendlyFire});e.archetypes.a_d_barrel_level_4={parent:"a_d_barrel_level_3",ECMesh:{scale:1,path:"environment/models/e_b_barrel_04.dae",
offsetY:-0.5},ECHealth:{health:e.balanceDefences.a_d_barrel_level_4.health,takesFullDamageFromFriendlyFire:!0,canOnlyBeDamagedByHero:!0,immuneToIndirectHits:!0,deathBehavior:"none",rooted:!0},ECExplode:{damageType:"dg_d_barrel_level_4",explodeOnDeath:!0,sfxArchetype:"sfx_explosionBarrel"},ECBuilding:{resourceCost:e.balanceDefences.a_d_barrel_level_4.resourceCost,secondaryResourceCost:0,buildTime:e.balanceDefences.a_d_barrel_level_4.buildTime,canSpeedUpWithSoftCurrency:!0,buildingType:"Trap",obeysScaffoldCap:!1,
scaffoldType:"war",usesInfiniteBuildMode:!0,level:4,addedFootprintSize:0,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Barrel Unlock",level:4,minimumQuantity:1},{buildingType:"Barrel Unlock",level:5,minimumQuantity:0,maximumQuantity:1}]}};A.archetypes.dg_d_barrel_level_4=A.create("Barrel Explosion",{damage:e.balanceDefences.a_d_barrel_level_4.damage,buildingDamage:e.balanceDefences.a_d_barrel_level_4.buildingDamage,forceBack:e.balanceDefences.a_d_barrel_level_4.forceBack,
forceLift:e.balanceDefences.a_d_barrel_level_4.forceLift,forceRadial:e.balanceDefences.a_d_barrel_level_4.forceRadial,forceTangential:0,radius:e.balanceDefences.a_d_barrel_level_4.radius,isExplosion:!0,friendlyFire:e.balanceDefences.a_d_barrel_level_4.friendlyFire});e.archetypes.a_d_barrel_level_5={parent:"a_d_barrel_level_4",ECMesh:{scale:1,path:"environment/models/e_b_barrel_05.dae",offsetY:-0.5},ECHealth:{health:e.balanceDefences.a_d_barrel_level_5.health,takesFullDamageFromFriendlyFire:!0,canOnlyBeDamagedByHero:!0,
immuneToIndirectHits:!0,deathBehavior:"none",rooted:!0},ECExplode:{damageType:"dg_d_barrel_level_5",explodeOnDeath:!0,sfxArchetype:"sfx_explosionBarrel"},ECBuilding:{resourceCost:e.balanceDefences.a_d_barrel_level_5.resourceCost,secondaryResourceCost:0,buildTime:e.balanceDefences.a_d_barrel_level_5.buildTime,canSpeedUpWithSoftCurrency:!0,buildingType:"Trap",obeysScaffoldCap:!1,scaffoldType:"war",usesInfiniteBuildMode:!0,level:5,addedFootprintSize:0,prerequisites:[{buildingType:"Defence Factory",level:1},
{buildingType:"Barrel Unlock",level:5,minimumQuantity:1},{buildingType:"Barrel Unlock",level:6,minimumQuantity:0,maximumQuantity:1}]}};A.archetypes.dg_d_barrel_level_5=A.create("Barrel Explosion",{damage:e.balanceDefences.a_d_barrel_level_5.damage,buildingDamage:e.balanceDefences.a_d_barrel_level_5.buildingDamage,forceBack:e.balanceDefences.a_d_barrel_level_5.forceBack,forceLift:e.balanceDefences.a_d_barrel_level_5.forceLift,forceRadial:e.balanceDefences.a_d_barrel_level_5.forceRadial,forceTangential:0,
radius:e.balanceDefences.a_d_barrel_level_5.radius,isExplosion:!0,friendlyFire:e.balanceDefences.a_d_barrel_level_5.friendlyFire});e.archetypes.a_d_mine={shouldPlayerSave:!0,familyName:"mine",ECMesh:{scale:1,path:"environment/models/e_b_mine.dae",offsetY:-0.5},ECPhysicsCube:{stationary:!1,scaleMesh:!1,offsetY:-0.45,v3Scale:[1,0.1,1]},ECHealth:{health:e.balanceDefences.a_d_mine.health,canTakeDamage:!1,deathBehavior:"none",rooted:!0},ECFaction:e.EC_DEFAULT,ECExchanger:{heroCollide:e.balanceDefences.a_d_mine.triggeredByHeroTouch,
agentCollide:e.balanceDefences.a_d_mine.triggeredByEnemyTouch,wildlingCollide:e.balanceDefences.a_d_mine.triggeredByWildlingTouch,killSelf:!0},ECExplode:{damageType:"dg_d_mine",explodeOnDeath:!0,sfxArchetype:"sfx_explosionMine"},ECBuilding:{resourceCost:e.balanceDefences.a_d_mine.resourceCost,secondaryResourceCost:0,buildTime:e.balanceDefences.a_d_mine.buildTime,canSpeedUpWithSoftCurrency:!0,buildingType:"Trap",buildingName:"Mine",obeysScaffoldCap:!1,mustPlaceNearCreator:!0,scaffoldType:"war",usesInfiniteBuildMode:!0,
level:1,addedFootprintSize:0,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Mine Unlock",level:2,minimumQuantity:0,maximumQuantity:1}]}};A.archetypes.dg_d_mine=A.create("Mine Explosion",{damage:e.balanceDefences.a_d_mine.damage,buildingDamage:e.balanceDefences.a_d_mine.buildingDamage,stunDuration:e.balanceDefences.a_d_mine.stunDuration,forceBack:e.balanceDefences.a_d_mine.forceBack,forceLift:e.balanceDefences.a_d_mine.forceLift,forceRadial:e.balanceDefences.a_d_mine.forceRadial,
forceTangential:0,radius:e.balanceDefences.a_d_mine.radius,isExplosion:!0,friendlyFire:e.balanceDefences.a_d_mine.friendlyFire});e.archetypes.a_d_mine_level_2={parent:"a_d_mine",ECMesh:{scale:1,path:"environment/models/e_b_mine_02.dae",offsetY:-0.5},ECHealth:{health:e.balanceDefences.a_d_mine_level_2.health,canTakeDamage:!1,deathBehavior:"none",rooted:!0},ECExchanger:{heroCollide:e.balanceDefences.a_d_mine_level_2.triggeredByHeroTouch,agentCollide:e.balanceDefences.a_d_mine_level_2.triggeredByEnemyTouch,
wildlingCollide:e.balanceDefences.a_d_mine_level_2.triggeredByWildlingTouch,killSelf:!0},ECExplode:{damageType:"dg_d_mine_level_2",explodeOnDeath:!0,sfxArchetype:"sfx_explosionMine"},ECBuilding:{resourceCost:e.balanceDefences.a_d_mine_level_2.resourceCost,secondaryResourceCost:0,buildTime:e.balanceDefences.a_d_mine_level_2.buildTime,canSpeedUpWithSoftCurrency:!0,buildingType:"Trap",obeysScaffoldCap:!1,scaffoldType:"war",usesInfiniteBuildMode:!0,level:2,addedFootprintSize:0,prerequisites:[{buildingType:"Defence Factory",
level:1},{buildingType:"Mine Unlock",level:2,minimumQuantity:1},{buildingType:"Mine Unlock",level:3,minimumQuantity:0,maximumQuantity:1}]}};A.archetypes.dg_d_mine_level_2=A.create("Mine Explosion",{damage:e.balanceDefences.a_d_mine_level_2.damage,buildingDamage:e.balanceDefences.a_d_mine_level_2.buildingDamage,stunDuration:e.balanceDefences.a_d_mine_level_2.stunDuration,forceBack:e.balanceDefences.a_d_mine_level_2.forceBack,forceLift:e.balanceDefences.a_d_mine_level_2.forceLift,forceRadial:e.balanceDefences.a_d_mine_level_2.forceRadial,
forceTangential:0,radius:e.balanceDefences.a_d_mine_level_2.radius,isExplosion:!0,friendlyFire:e.balanceDefences.a_d_mine_level_2.friendlyFire});e.archetypes.a_d_mine_level_3={parent:"a_d_mine_level_2",ECMesh:{scale:1,path:"environment/models/e_b_mine_03.dae",offsetY:-0.5},ECHealth:{health:e.balanceDefences.a_d_mine_level_3.health,canTakeDamage:!1,deathBehavior:"none",rooted:!0},ECExchanger:{heroCollide:e.balanceDefences.a_d_mine_level_3.triggeredByHeroTouch,agentCollide:e.balanceDefences.a_d_mine_level_3.triggeredByEnemyTouch,
wildlingCollide:e.balanceDefences.a_d_mine_level_3.triggeredByWildlingTouch,killSelf:!0},ECExplode:{damageType:"dg_d_mine_level_3",explodeOnDeath:!0,sfxArchetype:"sfx_explosionMine"},ECBuilding:{resourceCost:e.balanceDefences.a_d_mine_level_3.resourceCost,secondaryResourceCost:0,buildTime:e.balanceDefences.a_d_mine_level_3.buildTime,canSpeedUpWithSoftCurrency:!0,buildingType:"Trap",obeysScaffoldCap:!1,scaffoldType:"war",usesInfiniteBuildMode:!0,level:3,addedFootprintSize:0,prerequisites:[{buildingType:"Defence Factory",
level:1},{buildingType:"Mine Unlock",level:3,minimumQuantity:1},{buildingType:"Mine Unlock",level:4,minimumQuantity:0,maximumQuantity:1}]}};A.archetypes.dg_d_mine_level_3=A.create("Mine Explosion",{damage:e.balanceDefences.a_d_mine_level_3.damage,buildingDamage:e.balanceDefences.a_d_mine_level_3.buildingDamage,stunDuration:e.balanceDefences.a_d_mine_level_3.stunDuration,forceBack:e.balanceDefences.a_d_mine_level_3.forceBack,forceLift:e.balanceDefences.a_d_mine_level_3.forceLift,forceRadial:e.balanceDefences.a_d_mine_level_3.forceRadial,
forceTangential:0,radius:e.balanceDefences.a_d_mine_level_3.radius,isExplosion:!0,friendlyFire:e.balanceDefences.a_d_mine_level_3.friendlyFire});e.archetypes.a_d_mine_level_4={parent:"a_d_mine_level_3",ECMesh:{scale:1,path:"environment/models/e_b_mine_04.dae",offsetY:-0.5},ECHealth:{health:e.balanceDefences.a_d_mine_level_4.health,canTakeDamage:!1,deathBehavior:"none",rooted:!0},ECExchanger:{heroCollide:e.balanceDefences.a_d_mine_level_4.triggeredByHeroTouch,agentCollide:e.balanceDefences.a_d_mine_level_4.triggeredByEnemyTouch,
wildlingCollide:e.balanceDefences.a_d_mine_level_4.triggeredByWildlingTouch,killSelf:!0},ECExplode:{damageType:"dg_d_mine_level_4",explodeOnDeath:!0,sfxArchetype:"sfx_explosionMine"},ECBuilding:{resourceCost:e.balanceDefences.a_d_mine_level_4.resourceCost,secondaryResourceCost:0,buildTime:e.balanceDefences.a_d_mine_level_4.buildTime,canSpeedUpWithSoftCurrency:!0,buildingType:"Trap",obeysScaffoldCap:!1,scaffoldType:"war",usesInfiniteBuildMode:!0,level:4,addedFootprintSize:0,prerequisites:[{buildingType:"Defence Factory",
level:1},{buildingType:"Mine Unlock",level:4,minimumQuantity:1},{buildingType:"Mine Unlock",level:5,minimumQuantity:0,maximumQuantity:1}]}};A.archetypes.dg_d_mine_level_4=A.create("Mine Explosion",{damage:e.balanceDefences.a_d_mine_level_4.damage,buildingDamage:e.balanceDefences.a_d_mine_level_4.buildingDamage,stunDuration:e.balanceDefences.a_d_mine_level_4.stunDuration,forceBack:e.balanceDefences.a_d_mine_level_4.forceBack,forceLift:e.balanceDefences.a_d_mine_level_4.forceLift,forceRadial:e.balanceDefences.a_d_mine_level_4.forceRadial,
forceTangential:0,radius:e.balanceDefences.a_d_mine_level_4.radius,isExplosion:!0,friendlyFire:e.balanceDefences.a_d_mine_level_4.friendlyFire});e.archetypes.a_d_mine_level_5={parent:"a_d_mine_level_4",ECMesh:{scale:1,path:"environment/models/e_b_mine_05.dae",offsetY:-0.5},ECHealth:{health:e.balanceDefences.a_d_mine_level_5.health,canTakeDamage:!1,deathBehavior:"none",rooted:!0},ECExchanger:{heroCollide:e.balanceDefences.a_d_mine_level_5.triggeredByHeroTouch,agentCollide:e.balanceDefences.a_d_mine_level_5.triggeredByEnemyTouch,
wildlingCollide:e.balanceDefences.a_d_mine_level_5.triggeredByWildlingTouch,killSelf:!0},ECExplode:{damageType:"dg_d_mine_level_5",explodeOnDeath:!0,sfxArchetype:"sfx_explosionMine"},ECBuilding:{resourceCost:e.balanceDefences.a_d_mine_level_5.resourceCost,secondaryResourceCost:0,buildTime:e.balanceDefences.a_d_mine_level_5.buildTime,canSpeedUpWithSoftCurrency:!0,buildingType:"Trap",obeysScaffoldCap:!1,scaffoldType:"war",usesInfiniteBuildMode:!0,level:5,addedFootprintSize:0,prerequisites:[{buildingType:"Defence Factory",
level:1},{buildingType:"Mine Unlock",level:5,minimumQuantity:1},{buildingType:"Mine Unlock",level:6,minimumQuantity:0,maximumQuantity:1}]}};A.archetypes.dg_d_mine_level_5=A.create("Mine Explosion",{damage:e.balanceDefences.a_d_mine_level_5.damage,buildingDamage:e.balanceDefences.a_d_mine_level_5.buildingDamage,stunDuration:e.balanceDefences.a_d_mine_level_5.stunDuration,forceBack:e.balanceDefences.a_d_mine_level_5.forceBack,forceLift:e.balanceDefences.a_d_mine_level_5.forceLift,forceRadial:e.balanceDefences.a_d_mine_level_5.forceRadial,
forceTangential:0,radius:e.balanceDefences.a_d_mine_level_5.radius,isExplosion:!0,friendlyFire:e.balanceDefences.a_d_mine_level_5.friendlyFire});e.archetypes.a_d_decoy={shouldPlayerSave:!0,familyName:"decoy",ECMesh:{scale:1,path:"environment/models/e_b_decoy.dae",offsetY:-0.5},ECPhysicsCube:{scaleMesh:!1,stationary:!0,v3Scale:[1,2,1],offsetY:0,terrainType:"building"},ECHealth:{health:e.balanceDefences.a_d_decoy.health,drawInWorldBarIfDamagedRecently:!0},ECFaction:e.EC_DEFAULT,ECSelectable:{selectType:"selectTypePrepare"},
ECInteractable:e.EC_DEFAULT,ECTarget:e.EC_DEFAULT,ECAttackerLimit:{maxAttackers:e.balanceDefences.a_d_decoy.maxAttackers},ECBuilding:{resourceCost:e.balanceDefences.a_d_decoy.resourceCost,secondaryResourceCost:0,buildTime:e.balanceDefences.a_d_decoy.buildTime,canSpeedUpWithSoftCurrency:!0,buildingType:"Trap",buildingName:"Decoy",obeysScaffoldCap:!1,scaffoldType:"war",usesInfiniteBuildMode:!0,mustPlaceNearCreator:!0,level:1,addedFootprintSize:1,prerequisites:[{buildingType:"Defence Factory",level:1},
{buildingType:"Decoy Unlock",level:2,minimumQuantity:0,maximumQuantity:1}]},ECRadialMenu:e.EC_DEFAULT};e.archetypes.a_d_decoy_level_2={parent:"a_d_decoy",ECMesh:{scale:1,path:"environment/models/e_b_decoy_02.dae",offsetY:-0.5},ECHealth:{health:e.balanceDefences.a_d_decoy_level_2.health,drawInWorldBarIfDamagedRecently:!0},ECAttackerLimit:{maxAttackers:e.balanceDefences.a_d_decoy_level_2.maxAttackers},ECBuilding:{resourceCost:e.balanceDefences.a_d_decoy_level_2.resourceCost,secondaryResourceCost:0,
buildTime:e.balanceDefences.a_d_decoy_level_2.buildTime,canSpeedUpWithSoftCurrency:!0,buildingType:"Trap",obeysScaffoldCap:!1,scaffoldType:"war",usesInfiniteBuildMode:!0,level:2,addedFootprintSize:1,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Decoy Unlock",level:2,minimumQuantity:1},{buildingType:"Decoy Unlock",level:3,minimumQuantity:0,maximumQuantity:1}]}};e.archetypes.a_d_decoy_level_3={parent:"a_d_decoy_level_2",ECMesh:{scale:1,path:"environment/models/e_b_decoy_03.dae",
offsetY:-0.5},ECHealth:{health:e.balanceDefences.a_d_decoy_level_3.health,drawInWorldBarIfDamagedRecently:!0},ECAttackerLimit:{maxAttackers:e.balanceDefences.a_d_decoy_level_3.maxAttackers},ECBuilding:{resourceCost:e.balanceDefences.a_d_decoy_level_3.resourceCost,secondaryResourceCost:0,buildTime:e.balanceDefences.a_d_decoy_level_3.buildTime,canSpeedUpWithSoftCurrency:!0,buildingType:"Trap",obeysScaffoldCap:!1,scaffoldType:"war",usesInfiniteBuildMode:!0,level:3,addedFootprintSize:1,prerequisites:[{buildingType:"Defence Factory",
level:1},{buildingType:"Decoy Unlock",level:3,minimumQuantity:1},{buildingType:"Decoy Unlock",level:4,minimumQuantity:0,maximumQuantity:1}]}};e.archetypes.a_d_decoy_level_4={parent:"a_d_decoy_level_3",ECMesh:{scale:1,path:"environment/models/e_b_decoy_04.dae",offsetY:-0.5},ECHealth:{health:e.balanceDefences.a_d_decoy_level_4.health,drawInWorldBarIfDamagedRecently:!0},ECAttackerLimit:{maxAttackers:e.balanceDefences.a_d_decoy_level_4.maxAttackers},ECBuilding:{resourceCost:e.balanceDefences.a_d_decoy_level_4.resourceCost,
secondaryResourceCost:0,buildTime:e.balanceDefences.a_d_decoy_level_4.buildTime,canSpeedUpWithSoftCurrency:!0,buildingType:"Trap",obeysScaffoldCap:!1,scaffoldType:"war",usesInfiniteBuildMode:!0,level:4,addedFootprintSize:1,prerequisites:[{buildingType:"Defence Factory",level:1},{buildingType:"Decoy Unlock",level:4,minimumQuantity:1},{buildingType:"Decoy Unlock",level:5,minimumQuantity:0,maximumQuantity:1}]}};e.archetypes.a_d_decoy_level_5={parent:"a_d_decoy_level_4",ECMesh:{scale:1,path:"environment/models/e_b_decoy_05.dae",
offsetY:-0.5},ECHealth:{health:e.balanceDefences.a_d_decoy_level_5.health,drawInWorldBarIfDamagedRecently:!0},ECAttackerLimit:{maxAttackers:e.balanceDefences.a_d_decoy_level_5.maxAttackers},ECBuilding:{resourceCost:e.balanceDefences.a_d_decoy_level_5.resourceCost,secondaryResourceCost:0,buildTime:e.balanceDefences.a_d_decoy_level_5.buildTime,canSpeedUpWithSoftCurrency:!0,buildingType:"Trap",obeysScaffoldCap:!1,scaffoldType:"war",usesInfiniteBuildMode:!0,level:5,addedFootprintSize:1,prerequisites:[{buildingType:"Defence Factory",
level:1},{buildingType:"Decoy Unlock",level:5,minimumQuantity:1},{buildingType:"Decoy Unlock",level:6,minimumQuantity:0,maximumQuantity:1}]}};e.archetypes.a_s_damaged_big={shouldPlayerSave:!1,familyName:"damagedEffect",ECMesh:{scale:5,offsetY:0,path:"environment/models/e_b_smokefire.dae",localOffset:[0,0,0]},ECEffectSpawner:{ambientEffect:"sfx_amb_fire",onCreateEffect:"sfx_dth_building",onDestroyEffect:"sfx_dst_fire"}};e.archetypes.a_s_damaged_small={shouldPlayerSave:!1,familyName:"damagedEffect",
ECMesh:{scale:2,offsetY:0,path:"environment/models/e_b_smokefire.dae",localOffset:[0,0,0]},ECEffectSpawner:{ambientEffect:"sfx_amb_fire",onCreateEffect:"sfx_dth_small_building",onDestroyEffect:"sfx_dst_fire_small"}};var Ld={archetypes:{}};Ld.archetypes.tree01={initialAnimation:"idle",animations:{idle:{source:"tree01rustlingSource",looping:!0,randomStartTime:!0,speedRange:[0.9,1.1]}}};Ld.archetypes.tree02={initialAnimation:"idle",animations:{idle:{source:"tree03rustlingSource",looping:!0,randomStartTime:!0,
speedRange:[0.9,1.1]}}};Ld.archetypes.tree04={initialAnimation:"idle",animations:{idle:{source:"tree04rustlingSource",looping:!0,randomStartTime:!0,speedRange:[0.9,1.1]}}};WarBalance={campaign_tutorial_01:{maxResourceBonusList:[0,250],maxXpBonus:50,battleList:[{battle:"a_wm_battle_tutorial_01",level:1}]},campaign_tutorial_02:{maxResourceBonusList:[0,250],maxXpBonus:50,battleList:[{battle:"a_wm_battle_tutorial_02",level:1}],trickleList:[{battle:"a_wm_trickle_tutorial_01",level:1}]},campaign_tutorial_03:{maxResourceBonusList:[0,
250],maxXpBonus:50,battleList:[{battle:"a_wm_battle_tutorial_03",level:1}],trickleList:[{battle:"a_wm_trickle_tutorial_01",level:1}]},campaign_tutorial_04:{maxResourceBonusList:[0,250],maxXpBonus:50,battleList:[{battle:"a_wm_battle_tutorial_04",level:1}],trickleList:[{battle:"a_wm_trickle_tutorial_01",level:1}]},campaign_tutorial_05:{maxResourceBonusList:[0,250],maxXpBonus:50,battleList:[{battle:"a_wm_battle_tutorial_05",level:1}],trickleList:[{battle:"a_wm_trickle_tutorial_01",level:1}]},campaign_easy_01:{maxResourceBonusList:[0,
500],maxXpBonus:100,battleList:[{battle:"a_wm_battle_easy_01",level:1}],trickleList:[{battle:"a_wm_trickle_commando_01",level:1}]},campaign_easy_02:{maxResourceBonusList:[0,500],maxXpBonus:100,battleList:[{battle:"a_wm_battle_easy_02",level:1}],trickleList:[{battle:"a_wm_trickle_commando_01",level:1}]},campaign_easy_03:{maxResourceBonusList:[0,500],maxXpBonus:100,battleList:[{battle:"a_wm_battle_easy_03",level:1}],trickleList:[{battle:"a_wm_trickle_commando_01",level:1}]},campaign_easy_04:{maxResourceBonusList:[0,
500],maxXpBonus:100,battleList:[{battle:"a_wm_battle_easy_04",level:1}],trickleList:[{battle:"a_wm_trickle_commando_01",level:1}]},campaign_easy_05:{maxResourceBonusList:[0,500],maxXpBonus:100,battleList:[{battle:"a_wm_battle_easy_05",level:1}],trickleList:[{battle:"a_wm_trickle_commando_01",level:1}]},campaign_medium_01:{maxResourceBonusList:[0,750],maxXpBonus:150,battleList:[{battle:"a_wm_battle_medium_01",level:1}],trickleList:[{battle:"a_wm_trickle_commando_01",level:1}]},campaign_medium_02:{maxResourceBonusList:[0,
750],maxXpBonus:150,battleList:[{battle:"a_wm_battle_medium_02",level:1}],trickleList:[{battle:"a_wm_trickle_commando_01",level:1}]},campaign_medium_03:{maxResourceBonusList:[0,750],maxXpBonus:150,battleList:[{battle:"a_wm_battle_medium_03",level:2}],trickleList:[{battle:"a_wm_trickle_commando_01",level:2}]},campaign_moba_01:{maxResourceBonusList:[0,750],maxXpBonus:150,battleList:[{battle:"a_wm_battle_moba_01",level:2}],trickleList:[{battle:"a_wm_trickle_thief_01",level:2}]},campaign_mobb_01:{maxResourceBonusList:[0,
750],maxXpBonus:150,battleList:[{battle:"a_wm_battle_mobb_01",level:2}],trickleList:[{battle:"a_wm_trickle_thief_01",level:2}]},campaign_mobc_01:{maxResourceBonusList:[0,750],maxXpBonus:150,battleList:[{battle:"a_wm_battle_mobc_01",level:2}],trickleList:[{battle:"a_wm_trickle_thief_01",level:2}]},campaign_death_01:{maxResourceBonusList:[0,1E3],maxXpBonus:200,battleList:[{battle:"a_wm_battle_death_01",level:2}],trickleList:[{battle:"a_wm_trickle_commando_01",level:2}]},campaign_moba_02:{maxResourceBonusList:[0,
1E3],maxXpBonus:200,battleList:[{battle:"a_wm_battle_moba_02",level:2}],trickleList:[{battle:"a_wm_trickle_thief_01",level:2}]},campaign_mobb_02:{maxResourceBonusList:[0,1E3],maxXpBonus:200,battleList:[{battle:"a_wm_battle_mobb_02",level:2}],trickleList:[{battle:"a_wm_trickle_commando_01",level:2}]},campaign_mobc_02:{maxResourceBonusList:[0,1E3],maxXpBonus:200,battleList:[{battle:"a_wm_battle_mobc_02",level:2}],trickleList:[{battle:"a_wm_trickle_thief_01",level:2}]},campaign_moba_03:{maxResourceBonusList:[0,
1E3],maxXpBonus:200,battleList:[{battle:"a_wm_battle_moba_02",level:3}],trickleList:[{battle:"a_wm_trickle_thief_01",level:3}]},campaign_mobb_03:{maxResourceBonusList:[0,1E3],maxXpBonus:200,battleList:[{battle:"a_wm_battle_mobb_02",level:3}],trickleList:[{battle:"a_wm_trickle_commando_01",level:3}]},campaign_mobc_03:{maxResourceBonusList:[0,1E3],maxXpBonus:200,battleList:[{battle:"a_wm_battle_mobc_02",level:3}],trickleList:[{battle:"a_wm_trickle_thief_01",level:3}]},campaign_boss_01:{maxResourceBonusList:[0,
1E3],maxXpBonus:200,battleList:[{battle:"a_wm_battle_boss_05",level:3}],trickleList:[{battle:"a_wm_trickle_thief_01",level:3}]},campaign_moba_04:{maxResourceBonusList:[0,1500],maxXpBonus:250,battleList:[{battle:"a_wm_battle_moba_03",level:3}],trickleList:[{battle:"a_wm_trickle_thief_01",level:3}]},campaign_mobb_04:{maxResourceBonusList:[0,1500],maxXpBonus:250,battleList:[{battle:"a_wm_battle_mobb_03",level:3}],trickleList:[{battle:"a_wm_trickle_commando_01",level:3}]},campaign_mobc_04:{maxResourceBonusList:[0,
1500],maxXpBonus:250,battleList:[{battle:"a_wm_battle_mobc_03",level:3}],trickleList:[{battle:"a_wm_trickle_thief_01",level:3}]},campaign_moba_05:{maxResourceBonusList:[0,1500],maxXpBonus:250,battleList:[{battle:"a_wm_battle_moba_04",level:4}],trickleList:[{battle:"a_wm_trickle_thief_01",level:4}]},campaign_mobb_05:{maxResourceBonusList:[0,1500],maxXpBonus:250,battleList:[{battle:"a_wm_battle_mobb_04",level:4}],trickleList:[{battle:"a_wm_trickle_commando_01",level:4}]},campaign_mobc_05:{maxResourceBonusList:[0,
1500],maxXpBonus:250,battleList:[{battle:"a_wm_battle_mobc_04",level:4}],trickleList:[{battle:"a_wm_trickle_thief_01",level:4}]},campaign_pyro_01:{maxResourceBonusList:[0,2500],maxXpBonus:300,battleList:[{battle:"a_wm_battle_pyro_03",level:4}],trickleList:[{battle:"a_wm_trickle_commando_01",level:4}]},campaign_mobc_06:{maxResourceBonusList:[0,2500],maxXpBonus:300,battleList:[{battle:"a_wm_battle_moba_04",level:4}],trickleList:[{battle:"a_wm_trickle_thief_01",level:4}]},campaign_moba_06:{maxResourceBonusList:[0,
2500],maxXpBonus:300,battleList:[{battle:"a_wm_battle_mobb_04",level:4}],trickleList:[{battle:"a_wm_trickle_commando_01",level:4}]},campaign_mobb_06:{maxResourceBonusList:[0,2500],maxXpBonus:300,battleList:[{battle:"a_wm_battle_mobc_04",level:4}],trickleList:[{battle:"a_wm_trickle_thief_01",level:4}]},campaign_ranged_01:{maxResourceBonusList:[0,2500],maxXpBonus:300,battleList:[{battle:"a_wm_battle_ranged_03",level:5}],trickleList:[{battle:"a_wm_trickle_commando_01",level:5}]},campaign_mobb_07:{maxResourceBonusList:[0,
2500],maxXpBonus:300,battleList:[{battle:"a_wm_battle_mobb_04",level:5}],trickleList:[{battle:"a_wm_trickle_thief_01",level:5}]},campaign_moba_07:{maxResourceBonusList:[0,2500],maxXpBonus:300,battleList:[{battle:"a_wm_battle_moba_04",level:5}],trickleList:[{battle:"a_wm_trickle_commando_01",level:5}]},campaign_mobc_07:{maxResourceBonusList:[0,2500],maxXpBonus:300,battleList:[{battle:"a_wm_battle_mobc_04",level:5}],trickleList:[{battle:"a_wm_trickle_thief_01",level:5}]},campaign_charger_01:{maxResourceBonusList:[0,
5E3],maxXpBonus:350,battleList:[{battle:"a_wm_battle_charger_03",level:5}],trickleList:[{battle:"a_wm_trickle_commando_02",level:5}]},campaign_moba_08:{maxResourceBonusList:[0,5E3],maxXpBonus:350,battleList:[{battle:"a_wm_battle_moba_05",level:5}],trickleList:[{battle:"a_wm_trickle_thief_02",level:5}]},campaign_commando_01:{maxResourceBonusList:[0,5E3],maxXpBonus:350,battleList:[{battle:"a_wm_battle_commando_03",level:5}],trickleList:[{battle:"a_wm_trickle_commando_02",level:5}]},campaign_mobb_08:{maxResourceBonusList:[0,
5E3],maxXpBonus:350,battleList:[{battle:"a_wm_battle_mobb_05",level:5}],trickleList:[{battle:"a_wm_trickle_thief_02",level:5}]},campaign_death_02:{maxResourceBonusList:[0,5E3],maxXpBonus:350,battleList:[{battle:"a_wm_battle_death_01",level:5}],trickleList:[{battle:"a_wm_trickle_commando_02",level:5}]},campaign_mobc_08:{maxResourceBonusList:[0,5E3],maxXpBonus:350,battleList:[{battle:"a_wm_battle_mobc_05",level:5}],trickleList:[{battle:"a_wm_trickle_thief_02",level:5}]},campaign_pyro_02:{maxResourceBonusList:[0,
5E3],maxXpBonus:350,battleList:[{battle:"a_wm_battle_pyro_03",level:4}],trickleList:[{battle:"a_wm_trickle_commando_02",level:5}]},campaign_thief_01:{maxResourceBonusList:[0,5E3],maxXpBonus:350,battleList:[{battle:"a_wm_battle_thief_03",level:5}],trickleList:[{battle:"a_wm_trickle_thief_02",level:5}]},campaign_ranged_02:{maxResourceBonusList:[0,5E3],maxXpBonus:350,battleList:[{battle:"a_wm_battle_ranged_03",level:5}],trickleList:[{battle:"a_wm_trickle_commando_02",level:5}]},campaign_treasure_01:{maxResourceBonusList:[0,
5E3],maxXpBonus:350,battleList:[{battle:"a_wm_battle_treasure_03",level:5}],trickleList:[{battle:"a_wm_trickle_thief_02",level:5}]},campaign_boss_02:{maxResourceBonusList:[0,5E3],maxXpBonus:350,battleList:[{battle:"a_wm_battle_boss_05",level:6}],trickleList:[{battle:"a_wm_trickle_commando_02",level:6}]},campaign_ranged_03:{maxResourceBonusList:[0,1E4],maxXpBonus:400,battleList:[{battle:"a_wm_battle_ranged_04",level:6}],trickleList:[{battle:"a_wm_trickle_commando_02",level:6}]},campaign_commando_02:{maxResourceBonusList:[0,
1E4],maxXpBonus:400,battleList:[{battle:"a_wm_battle_commando_04",level:6}],trickleList:[{battle:"a_wm_trickle_commando_02",level:6}]},campaign_mobc_09:{maxResourceBonusList:[0,1E4],maxXpBonus:400,battleList:[{battle:"a_wm_battle_mobc_06",level:6}],trickleList:[{battle:"a_wm_trickle_thief_02",level:6}]},campaign_charger_02:{maxResourceBonusList:[0,1E4],maxXpBonus:400,battleList:[{battle:"a_wm_battle_charger_04",level:6}],trickleList:[{battle:"a_wm_trickle_commando_02",level:6}]},campaign_treasure_02:{maxResourceBonusList:[0,
1E4],maxXpBonus:400,battleList:[{battle:"a_wm_battle_treasure_04",level:6}],trickleList:[{battle:"a_wm_trickle_thief_02",level:6}]},campaign_pyro_03:{maxResourceBonusList:[0,1E4],maxXpBonus:400,battleList:[{battle:"a_wm_battle_pyro_04",level:6}],trickleList:[{battle:"a_wm_trickle_commando_02",level:6}]},campaign_mobb_09:{maxResourceBonusList:[0,1E4],maxXpBonus:400,battleList:[{battle:"a_wm_battle_mobb_06",level:6}],trickleList:[{battle:"a_wm_trickle_thief_02",level:6}]},campaign_death_03:{maxResourceBonusList:[0,
1E4],maxXpBonus:400,battleList:[{battle:"a_wm_battle_death_04",level:6}],trickleList:[{battle:"a_wm_trickle_commando_02",level:6}]},campaign_moba_09:{maxResourceBonusList:[0,1E4],maxXpBonus:400,battleList:[{battle:"a_wm_battle_moba_06",level:6}],trickleList:[{battle:"a_wm_trickle_thief_02",level:6}]},campaign_thief_02:{maxResourceBonusList:[0,1E4],maxXpBonus:400,battleList:[{battle:"a_wm_battle_thief_04",level:6}],trickleList:[{battle:"a_wm_trickle_thief_02",level:6}]},campaign_boss_03:{maxResourceBonusList:[0,
1E4],maxXpBonus:400,battleList:[{battle:"a_wm_battle_boss_05",level:7}],trickleList:[{battle:"a_wm_trickle_commando_02",level:7}]},campaign_thief_03:{maxResourceBonusList:[0,25E3],maxXpBonus:450,battleList:[{battle:"a_wm_battle_thief_04",level:7}],trickleList:[{battle:"a_wm_trickle_thief_02",level:7}]},campaign_charger_03:{maxResourceBonusList:[0,25E3],maxXpBonus:450,battleList:[{battle:"a_wm_battle_charger_04",level:7}],trickleList:[{battle:"a_wm_trickle_commando_02",level:7}]},campaign_treasure_03:{maxResourceBonusList:[0,
25E3],maxXpBonus:450,battleList:[{battle:"a_wm_battle_treasure_04",level:7}],trickleList:[{battle:"a_wm_trickle_thief_02",level:7}]},campaign_death_04:{maxResourceBonusList:[0,25E3],maxXpBonus:450,battleList:[{battle:"a_wm_battle_death_04",level:7}],trickleList:[{battle:"a_wm_trickle_commando_02",level:7}]},campaign_mobb_10:{maxResourceBonusList:[0,25E3],maxXpBonus:450,battleList:[{battle:"a_wm_battle_mobb_06",level:7}],trickleList:[{battle:"a_wm_trickle_thief_02",level:7}]},campaign_commando_03:{maxResourceBonusList:[0,
25E3],maxXpBonus:450,battleList:[{battle:"a_wm_battle_commando_04",level:7}],trickleList:[{battle:"a_wm_trickle_commando_02",level:7}]},campaign_mobc_10:{maxResourceBonusList:[0,25E3],maxXpBonus:450,battleList:[{battle:"a_wm_battle_mobc_06",level:7}],trickleList:[{battle:"a_wm_trickle_thief_02",level:7}]},campaign_ranged_04:{maxResourceBonusList:[0,25E3],maxXpBonus:450,battleList:[{battle:"a_wm_battle_ranged_04",level:7}],trickleList:[{battle:"a_wm_trickle_commando_02",level:7}]},campaign_moba_10:{maxResourceBonusList:[0,
25E3],maxXpBonus:450,battleList:[{battle:"a_wm_battle_moba_06",level:7}],trickleList:[{battle:"a_wm_trickle_thief_02",level:7}]},campaign_pyro_04:{maxResourceBonusList:[0,25E3],maxXpBonus:450,battleList:[{battle:"a_wm_battle_pyro_04",level:7}],trickleList:[{battle:"a_wm_trickle_commando_02",level:7}]},campaign_boss_04:{maxResourceBonusList:[0,25E3],maxXpBonus:450,battleList:[{battle:"a_wm_battle_boss_05",level:8}],trickleList:[{battle:"a_wm_trickle_commando_02",level:8}]},campaign_treasure_04:{maxResourceBonusList:[0,
5E4],maxXpBonus:500,battleList:[{battle:"a_wm_battle_treasure_04",level:8}],trickleList:[{battle:"a_wm_trickle_thief_02",level:8}]},campaign_ranged_05:{maxResourceBonusList:[0,5E4],maxXpBonus:500,battleList:[{battle:"a_wm_battle_ranged_04",level:8}],trickleList:[{battle:"a_wm_trickle_commando_02",level:8}]},campaign_charger_04:{maxResourceBonusList:[0,5E4],maxXpBonus:500,battleList:[{battle:"a_wm_battle_charger_04",level:8}],trickleList:[{battle:"a_wm_trickle_commando_02",level:8}]},campaign_thief_04:{maxResourceBonusList:[0,
5E4],maxXpBonus:500,battleList:[{battle:"a_wm_battle_thief_04",level:8}],trickleList:[{battle:"a_wm_trickle_thief_02",level:8}]},campaign_mobc_11:{maxResourceBonusList:[0,5E4],maxXpBonus:500,battleList:[{battle:"a_wm_battle_mobc_06",level:8}],trickleList:[{battle:"a_wm_trickle_thief_02",level:8}]},campaign_death_05:{maxResourceBonusList:[0,5E4],maxXpBonus:500,battleList:[{battle:"a_wm_battle_death_04",level:8}],trickleList:[{battle:"a_wm_trickle_commando_02",level:8}]},campaign_moba_11:{maxResourceBonusList:[0,
5E4],maxXpBonus:500,battleList:[{battle:"a_wm_battle_moba_06",level:8}],trickleList:[{battle:"a_wm_trickle_thief_02",level:8}]},campaign_commando_04:{maxResourceBonusList:[0,5E4],maxXpBonus:500,battleList:[{battle:"a_wm_battle_commando_04",level:8}],trickleList:[{battle:"a_wm_trickle_commando_02",level:8}]},campaign_mobb_11:{maxResourceBonusList:[0,5E4],maxXpBonus:500,battleList:[{battle:"a_wm_battle_mobb_06",level:8}],trickleList:[{battle:"a_wm_trickle_thief_02",level:8}]},campaign_pyro_05:{maxResourceBonusList:[0,
5E4],maxXpBonus:500,battleList:[{battle:"a_wm_battle_pyro_04",level:8}],trickleList:[{battle:"a_wm_trickle_commando_02",level:8}]},campaign_boss_05:{maxResourceBonusList:[0,5E4],maxXpBonus:500,battleList:[{battle:"a_wm_battle_boss_05",level:8}],trickleList:[{battle:"a_wm_trickle_commando_02",level:8}]}};var bk={basic:"infoPanelFlagBasic",mob:"infoPanelFlagMob",bombthrower:"infoPanelFlagBombthrower",charger:"infoPanelFlagCharger",ranged:"infoPanelFlagRanged",commando:"infoPanelFlagCommando",death:"infoPanelFlagDeath",
thief:"infoPanelFlagThief",treasure:"infoPanelFlagTreasure",boss:"infoPanelFlagBoss"},ca={};e.archetypes.a_cs_test={shouldPlayerSave:!1,shouldLevelSave:!1,familyName:"mapbannerling",ECMesh:{scale:1,path:"characters/models/c_bannerling_mob.dae",localOffset:[0,0,0],offsetY:-0.6},ECPhysicsCube:{scaleMesh:!1,stationary:!0,v3Scale:[1,1,1],offsetY:1,terrainType:"impass"},ECCampaignStarter:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECSelectable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECEffectSpawner:{incidentalEffect:"sfx_bannerling_alert_mob",
incidentalMinTime:4,incidentalMaxTime:4}};e.archetypes.a_cs_pyro={shouldPlayerSave:!1,shouldLevelSave:!1,familyName:"mapbannerling",ECMesh:{scale:1,path:"characters/models/c_bannerling_exploders.dae",localOffset:[0,0,0],offsetY:-0.6},ECPhysicsCube:{scaleMesh:!1,stationary:!0,v3Scale:[1,1,1],offsetY:1,terrainType:"impass"},ECCampaignStarter:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECSelectable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECEffectSpawner:{incidentalEffect:"sfx_bannerling_alert_bombthrower",
incidentalMinTime:4,incidentalMaxTime:4}};e.archetypes.a_cs_boss={shouldPlayerSave:!1,shouldLevelSave:!1,familyName:"mapbannerling",ECMesh:{scale:1,path:"characters/models/c_bannerling_boss.dae",localOffset:[0,0,0],offsetY:-0.6},ECPhysicsCube:{scaleMesh:!1,stationary:!0,v3Scale:[1,1,1],offsetY:1,terrainType:"impass"},ECCampaignStarter:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECSelectable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECEffectSpawner:{incidentalEffect:"sfx_bannerling_alert_boss",incidentalMinTime:4,
incidentalMaxTime:4}};e.archetypes.a_cs_charger={shouldPlayerSave:!1,shouldLevelSave:!1,familyName:"mapbannerling",ECMesh:{scale:1,path:"characters/models/c_bannerling_chargers.dae",localOffset:[0,0,0],offsetY:-0.6},ECPhysicsCube:{scaleMesh:!1,stationary:!0,v3Scale:[1,1,1],offsetY:1,terrainType:"impass"},ECCampaignStarter:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECSelectable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECEffectSpawner:{incidentalEffect:"sfx_bannerling_alert_charger",incidentalMinTime:4,
incidentalMaxTime:4}};e.archetypes.a_cs_commando={shouldPlayerSave:!1,shouldLevelSave:!1,familyName:"mapbannerling",ECMesh:{scale:1,path:"characters/models/c_bannerling_commandos.dae",localOffset:[0,0,0],offsetY:-0.6},ECPhysicsCube:{scaleMesh:!1,stationary:!0,v3Scale:[1,1,1],offsetY:1,terrainType:"impass"},ECCampaignStarter:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECSelectable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECEffectSpawner:{incidentalEffect:"sfx_bannerling_alert_commando",incidentalMinTime:4,
incidentalMaxTime:4}};e.archetypes.a_cs_death={shouldPlayerSave:!1,shouldLevelSave:!1,familyName:"mapbannerling",ECMesh:{scale:1,path:"characters/models/c_bannerling_death.dae",localOffset:[0,0,0],offsetY:-0.6},ECPhysicsCube:{scaleMesh:!1,stationary:!0,v3Scale:[1,1,1],offsetY:1,terrainType:"impass"},ECCampaignStarter:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECSelectable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECEffectSpawner:{incidentalEffect:"sfx_bannerling_alert_death",incidentalMinTime:4,incidentalMaxTime:4}};
e.archetypes.a_cs_mob={shouldPlayerSave:!1,shouldLevelSave:!1,familyName:"mapbannerling",ECMesh:{scale:1,path:"characters/models/c_bannerling_mob.dae",localOffset:[0,0,0],offsetY:-0.6},ECPhysicsCube:{scaleMesh:!1,stationary:!0,v3Scale:[1,1,1],offsetY:1,terrainType:"impass"},ECCampaignStarter:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECSelectable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECEffectSpawner:{incidentalEffect:"sfx_bannerling_alert_mob",incidentalMinTime:4,incidentalMaxTime:4}};e.archetypes.a_cs_ranged=
{shouldPlayerSave:!1,shouldLevelSave:!1,familyName:"mapbannerling",ECMesh:{scale:1,path:"characters/models/c_bannerling_ranged.dae",localOffset:[0,0,0],offsetY:-0.6},ECPhysicsCube:{scaleMesh:!1,stationary:!0,v3Scale:[1,1,1],offsetY:1,terrainType:"impass"},ECCampaignStarter:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECSelectable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECEffectSpawner:{incidentalEffect:"sfx_bannerling_alert_ranged",incidentalMinTime:4,incidentalMaxTime:4}};e.archetypes.a_cs_thief={shouldPlayerSave:!1,
shouldLevelSave:!1,familyName:"mapbannerling",ECMesh:{scale:1,path:"characters/models/c_bannerling_thieves.dae",localOffset:[0,0,0],offsetY:-0.6},ECPhysicsCube:{scaleMesh:!1,stationary:!0,v3Scale:[1,1,1],offsetY:1,terrainType:"impass"},ECCampaignStarter:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECSelectable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECEffectSpawner:{incidentalEffect:"sfx_bannerling_alert_thief",incidentalMinTime:4,incidentalMaxTime:4}};e.archetypes.a_cs_treasure={shouldPlayerSave:!1,shouldLevelSave:!1,
familyName:"mapbannerling",ECMesh:{scale:1,path:"characters/models/c_bannerling_treasure.dae",localOffset:[0,0,0],offsetY:-0.6},ECPhysicsCube:{scaleMesh:!1,stationary:!0,v3Scale:[1,1,1],offsetY:1,terrainType:"impass"},ECCampaignStarter:e.EC_DEFAULT,ECInteractable:e.EC_DEFAULT,ECSelectable:e.EC_DEFAULT,ECRadialMenu:e.EC_DEFAULT,ECEffectSpawner:{incidentalEffect:"sfx_bannerling_alert_treasuredropper",incidentalMinTime:4,incidentalMaxTime:4}};e.archetypes.a_warm_campaigns={shouldPlayerSave:!0,ECWarManager:{groupName:"warnew01",
warTable:"war_0_tutorial war_1 war_2 war_3 war_4 war_5 war_6 war_7 war_8 war_9".split(" ")}};var Ua={},Zj={bannerling:"a_e_bannerling a_e_bannerling a_e_bannerling a_e_bannerling a_e_bannerling a_e_bannerling".split(" "),bannerlingBombThrower:"a_e_bannerling_bombthrower a_e_bannerling_bombthrower a_e_bannerling_bombthrower a_e_bannerling_bombthrower a_e_bannerling_bombthrower a_e_bannerling_bombthrower".split(" "),bannerlingBoss:"a_e_bannerling_boss a_e_bannerling_boss a_e_bannerling_boss a_e_bannerling_boss a_e_bannerling_boss a_e_bannerling_boss".split(" "),
bannerlingCharger:"a_e_bannerling_charger a_e_bannerling_charger a_e_bannerling_charger a_e_bannerling_charger a_e_bannerling_charger a_e_bannerling_charger".split(" "),bannerlingCommando:"a_e_bannerling_commando a_e_bannerling_commando a_e_bannerling_commando a_e_bannerling_commando a_e_bannerling_commando a_e_bannerling_commando".split(" "),bannerlingDeath:"a_e_bannerling_death a_e_bannerling_death a_e_bannerling_death a_e_bannerling_death a_e_bannerling_death a_e_bannerling_death".split(" "),bannerlingMob:"a_e_bannerling_mob a_e_bannerling_mob a_e_bannerling_mob a_e_bannerling_mob a_e_bannerling_mob a_e_bannerling_mob".split(" "),
bannerlingRanged:"a_e_bannerling_ranged a_e_bannerling_ranged a_e_bannerling_ranged a_e_bannerling_ranged a_e_bannerling_ranged a_e_bannerling_ranged".split(" "),bannerlingThief:"a_e_bannerling_thief a_e_bannerling_thief a_e_bannerling_thief a_e_bannerling_thief a_e_bannerling_thief a_e_bannerling_thief".split(" "),bannerlingTreasureDropper:"a_e_bannerling_treasuredropper a_e_bannerling_treasuredropper a_e_bannerling_treasuredropper a_e_bannerling_treasuredropper a_e_bannerling_treasuredropper a_e_bannerling_treasuredropper".split(" "),
basicMelee:"a_e_basicmelee_level_0 a_e_basicmelee_level_1 a_e_basicmelee_level_2 a_e_basicmelee_level_3 a_e_basicmelee_level_4 a_e_basicmelee_level_5 a_e_basicmelee_level_6 a_e_basicmelee_level_7 a_e_basicmelee_level_8".split(" "),berserker:"a_e_berserker_level_0 a_e_berserker_level_1 a_e_berserker_level_2 a_e_berserker_level_3 a_e_berserker_level_4 a_e_berserker_level_5 a_e_berserker_level_6 a_e_berserker_level_7 a_e_berserker_level_8".split(" "),bombThrower:"a_e_bombthrower_level_0 a_e_bombthrower_level_1 a_e_bombthrower_level_2 a_e_bombthrower_level_3 a_e_bombthrower_level_4 a_e_bombthrower_level_5 a_e_bombthrower_level_6 a_e_bombthrower_level_7 a_e_bombthrower_level_8".split(" "),
chargerBoss:"a_e_charger_boss_level_0 a_e_charger_boss_level_1 a_e_charger_boss_level_2 a_e_charger_boss_level_3 a_e_charger_boss_level_4 a_e_charger_boss_level_5 a_e_charger_boss_level_6 a_e_charger_boss_level_7 a_e_charger_boss_level_8".split(" "),charger:"a_e_charger_level_0 a_e_charger_level_1 a_e_charger_level_2 a_e_charger_level_3 a_e_charger_level_4 a_e_charger_level_5 a_e_charger_level_6 a_e_charger_level_7 a_e_charger_level_8".split(" "),commando:"a_e_commando_level_0 a_e_commando_level_1 a_e_commando_level_2 a_e_commando_level_3 a_e_commando_level_4 a_e_commando_level_5 a_e_commando_level_6 a_e_commando_level_7 a_e_commando_level_8".split(" "),
death:"a_e_death a_e_death a_e_death a_e_death a_e_death a_e_death a_e_death a_e_death a_e_death".split(" "),ranged:"a_e_ranged_level_0 a_e_ranged_level_1 a_e_ranged_level_2 a_e_ranged_level_3 a_e_ranged_level_4 a_e_ranged_level_5 a_e_ranged_level_6 a_e_ranged_level_7 a_e_ranged_level_8".split(" "),thief:"a_e_thief_level_0 a_e_thief_level_1 a_e_thief_level_2 a_e_thief_level_3 a_e_thief_level_4 a_e_thief_level_5 a_e_thief_level_6 a_e_thief_level_7 a_e_thief_level_8".split(" "),miniCharger:"a_e_mini_charger_level_0 a_e_mini_charger_level_1 a_e_mini_charger_level_2 a_e_mini_charger_level_3 a_e_mini_charger_level_4 a_e_mini_charger_level_5 a_e_mini_charger_level_6 a_e_mini_charger_level_7 a_e_mini_charger_level_8".split(" "),
treasureDropper:"a_e_treasuredropper_level_0 a_e_treasuredropper_level_1 a_e_treasuredropper_level_2 a_e_treasuredropper_level_3 a_e_treasuredropper_level_4 a_e_treasuredropper_level_5 a_e_treasuredropper_level_6 a_e_treasuredropper_level_7 a_e_treasuredropper_level_8".split(" ")};Ua.war_all_campaigns={campaignList:[{campaign:"campaign_moba_01"},{campaign:"campaign_mobb_01"},{campaign:"campaign_mobc_01"},{campaign:"campaign_pyro_01"},{campaign:"campaign_ranged_01"},{campaign:"campaign_commando_01"},
{campaign:"campaign_charger_01"},{campaign:"campaign_thief_01"},{campaign:"campaign_death_01"},{campaign:"campaign_boss_01"}]};Ua.war_0_tutorial={campaignList:[{campaign:"campaign_tutorial_01"},{campaign:"campaign_tutorial_02"},{campaign:"campaign_tutorial_03"},{campaign:"campaign_tutorial_04"},{campaign:"campaign_tutorial_05"}],poolCampaignList:[{campaign:"campaign_tutorial_03"},{campaign:"campaign_tutorial_04"},{campaign:"campaign_tutorial_05"}]};Ua.war_1={campaignList:[{campaign:"campaign_easy_01"},
{campaign:"campaign_easy_02"},{campaign:"campaign_easy_03"},{campaign:"campaign_easy_04"},{campaign:"campaign_easy_05"}],poolCampaignList:[{campaign:"campaign_easy_03"},{campaign:"campaign_easy_04"},{campaign:"campaign_easy_05"}]};Ua.war_2={campaignList:[{campaign:"campaign_medium_01"},{campaign:"campaign_medium_02"},{campaign:"campaign_medium_03"},{campaign:"campaign_moba_01"},{campaign:"campaign_mobb_01"},{campaign:"campaign_mobc_01"}],poolCampaignList:[{campaign:"campaign_moba_01"},{campaign:"campaign_mobb_01"},
{campaign:"campaign_mobc_01"}]};Ua.war_3={campaignList:[{campaign:"campaign_death_01"},{campaign:"campaign_moba_02"},{campaign:"campaign_mobb_02"},{campaign:"campaign_mobc_02"},{campaign:"campaign_moba_03"},{campaign:"campaign_mobb_03"},{campaign:"campaign_mobc_03"},{campaign:"campaign_boss_01"}],poolCampaignList:[{campaign:"campaign_moba_03"},{campaign:"campaign_mobb_03"},{campaign:"campaign_mobc_03"}]};Ua.war_4={campaignList:[{campaign:"campaign_moba_04"},{campaign:"campaign_mobb_04"},{campaign:"campaign_mobc_04"},
{campaign:"campaign_moba_05"},{campaign:"campaign_mobb_05"},{campaign:"campaign_mobc_05"}],poolCampaignList:[{campaign:"campaign_moba_05"},{campaign:"campaign_mobb_05"},{campaign:"campaign_mobc_05"}]};Ua.war_5={campaignList:[{campaign:"campaign_pyro_01"},{campaign:"campaign_mobc_06"},{campaign:"campaign_moba_06"},{campaign:"campaign_mobb_06"},{campaign:"campaign_ranged_01"},{campaign:"campaign_mobb_07"},{campaign:"campaign_moba_07"},{campaign:"campaign_mobc_07"}],poolCampaignList:[{campaign:"campaign_ranged_01"},
{campaign:"campaign_mobb_07"},{campaign:"campaign_moba_07"},{campaign:"campaign_mobc_07"}]};Ua.war_6={campaignList:[{campaign:"campaign_charger_01"},{campaign:"campaign_moba_08"},{campaign:"campaign_commando_01"},{campaign:"campaign_mobb_08"},{campaign:"campaign_death_02"},{campaign:"campaign_mobc_08"},{campaign:"campaign_pyro_02"},{campaign:"campaign_thief_01"},{campaign:"campaign_ranged_02"},{campaign:"campaign_treasure_01"},{campaign:"campaign_boss_02"}],poolCampaignList:[{campaign:"campaign_charger_01"},
{campaign:"campaign_moba_08"},{campaign:"campaign_commando_01"},{campaign:"campaign_mobb_08"},{campaign:"campaign_death_02"},{campaign:"campaign_mobc_08"},{campaign:"campaign_pyro_02"},{campaign:"campaign_thief_01"},{campaign:"campaign_ranged_02"},{campaign:"campaign_treasure_01"},{campaign:"campaign_boss_02"}]};Ua.war_7={campaignList:[{campaign:"campaign_ranged_03"},{campaign:"campaign_commando_02"},{campaign:"campaign_mobc_09"},{campaign:"campaign_charger_02"},{campaign:"campaign_treasure_02"},
{campaign:"campaign_pyro_03"},{campaign:"campaign_mobb_09"},{campaign:"campaign_death_03"},{campaign:"campaign_moba_09"},{campaign:"campaign_thief_02"},{campaign:"campaign_boss_02"}],poolCampaignList:[{campaign:"campaign_ranged_03"},{campaign:"campaign_commando_02"},{campaign:"campaign_mobc_09"},{campaign:"campaign_charger_02"},{campaign:"campaign_treasure_02"},{campaign:"campaign_pyro_03"},{campaign:"campaign_mobb_09"},{campaign:"campaign_death_03"},{campaign:"campaign_moba_09"},{campaign:"campaign_thief_02"},
{campaign:"campaign_boss_02"}]};Ua.war_8={campaignList:[{campaign:"campaign_thief_03"},{campaign:"campaign_charger_03"},{campaign:"campaign_treasure_03"},{campaign:"campaign_death_04"},{campaign:"campaign_mobb_10"},{campaign:"campaign_commando_03"},{campaign:"campaign_mobc_10"},{campaign:"campaign_ranged_04"},{campaign:"campaign_moba_10"},{campaign:"campaign_pyro_04"},{campaign:"campaign_boss_04"}],poolCampaignList:[{campaign:"campaign_thief_03"},{campaign:"campaign_charger_03"},{campaign:"campaign_treasure_03"},
{campaign:"campaign_death_04"},{campaign:"campaign_mobb_10"},{campaign:"campaign_commando_03"},{campaign:"campaign_mobc_10"},{campaign:"campaign_ranged_04"},{campaign:"campaign_moba_10"},{campaign:"campaign_pyro_04"},{campaign:"campaign_boss_04"}]};Ua.war_9={campaignList:[{campaign:"campaign_treasure_04"},{campaign:"campaign_ranged_05"},{campaign:"campaign_charger_04"},{campaign:"campaign_thief_04"},{campaign:"campaign_mobc_11"},{campaign:"campaign_death_05"},{campaign:"campaign_moba_11"},{campaign:"campaign_commando_04"},
{campaign:"campaign_mobb_11"},{campaign:"campaign_pyro_05"},{campaign:"campaign_boss_05"}],poolCampaignList:[{campaign:"campaign_treasure_04"},{campaign:"campaign_ranged_05"},{campaign:"campaign_charger_04"},{campaign:"campaign_thief_04"},{campaign:"campaign_mobc_11"},{campaign:"campaign_death_05"},{campaign:"campaign_moba_11"},{campaign:"campaign_commando_04"},{campaign:"campaign_mobb_11"},{campaign:"campaign_pyro_05"},{campaign:"campaign_boss_05"}]};ca.campaign_tutorial_01={nameTextId:"CAMPAIGN_NAME_TUTORIAL_1",
descriptionTextId:"CAMPAIGN_DESCRIPTION_TUTORIAL_1",level:1,flag:"mob",maxResourceBonusList:WarBalance.campaign_tutorial_01.maxResourceBonusList,maxXpBonus:WarBalance.campaign_tutorial_01.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_tutorial_01.battleList,trickleList:WarBalance.campaign_tutorial_01.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:0},{name:"killNEnemiesWithHero",
minNumberOfFeralsKilledByHeroForSuccess:6}]};ca.campaign_tutorial_02={nameTextId:"CAMPAIGN_NAME_TUTORIAL_2",descriptionTextId:"CAMPAIGN_DESCRIPTION_TUTORIAL_2",level:1,flag:"mob",maxResourceBonusList:WarBalance.campaign_tutorial_02.maxResourceBonusList,maxXpBonus:WarBalance.campaign_tutorial_02.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_tutorial_02.battleList,trickleList:WarBalance.campaign_tutorial_02.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},
{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:0},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:10}]};ca.campaign_tutorial_03={nameTextId:"CAMPAIGN_NAME_TUTORIAL_3",descriptionTextId:"CAMPAIGN_DESCRIPTION_TUTORIAL_3",level:1,flag:"mob",maxResourceBonusList:WarBalance.campaign_tutorial_03.maxResourceBonusList,maxXpBonus:WarBalance.campaign_tutorial_03.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_tutorial_03.battleList,trickleList:WarBalance.campaign_tutorial_03.trickleList,
starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:0},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:10}]};ca.campaign_tutorial_04={nameTextId:"CAMPAIGN_NAME_TUTORIAL_4",descriptionTextId:"CAMPAIGN_DESCRIPTION_TUTORIAL_4",level:1,flag:"mob",maxResourceBonusList:WarBalance.campaign_tutorial_04.maxResourceBonusList,maxXpBonus:WarBalance.campaign_tutorial_04.maxXpBonus,campaignStarterArchetype:"a_cs_mob",
battleList:WarBalance.campaign_tutorial_04.battleList,trickleList:WarBalance.campaign_tutorial_04.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:0},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:10}]};ca.campaign_tutorial_05={nameTextId:"CAMPAIGN_NAME_TUTORIAL_5",descriptionTextId:"CAMPAIGN_DESCRIPTION_TUTORIAL_5",level:1,flag:"mob",maxResourceBonusList:WarBalance.campaign_tutorial_05.maxResourceBonusList,
maxXpBonus:WarBalance.campaign_tutorial_05.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_tutorial_05.battleList,trickleList:WarBalance.campaign_tutorial_05.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:0},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:10}]};e.archetypes.a_wm_battle_tutorial_01={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:10,
postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:7,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:7,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:6,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:6,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:5,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,
postThresholdDelay:5,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:4,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:4,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:3,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:3,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,
postThresholdDelay:2,families:[{familyName:"thief",min:2,max:2}]}]}};e.archetypes.a_wm_battle_tutorial_02={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:15,families:[{familyName:"basicMelee",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"basicMelee",min:1,max:1}]},{enemyThreshold:1,postThresholdDelay:10,families:[{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:2,postThresholdDelay:10,families:[{familyName:"basicMelee",min:2,max:2}]}]}};
e.archetypes.a_wm_battle_tutorial_03={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:15,families:[{familyName:"basicMelee",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:10,families:[{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:2,postThresholdDelay:10,families:[{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"basicMelee",
min:2,max:2}]}]}};e.archetypes.a_wm_battle_tutorial_04={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:15,families:[{familyName:"basicMelee",min:1,max:1},{familyName:"ranged",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:10,families:[{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:2,postThresholdDelay:10,families:[{familyName:"basicMelee",
min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]}]}};e.archetypes.a_wm_battle_tutorial_05={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:15,families:[{familyName:"basicMelee",min:1,max:1},{familyName:"ranged",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:1,
postThresholdDelay:10,families:[{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:2,postThresholdDelay:10,families:[{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:5,families:[{familyName:"ranged",min:1,max:1}]},{postThresholdDelay:3,families:[{familyName:"basicMelee",min:2,
max:2}]},{postThresholdDelay:3,families:[{familyName:"miniCharger",min:4,max:4}]}]}};ca.campaign_easy_01={nameTextId:"CAMPAIGN_NAME_EASY_1",descriptionTextId:"CAMPAIGN_DESCRIPTION_EASY_1",level:2,flag:"mob",maxResourceBonusList:WarBalance.campaign_easy_01.maxResourceBonusList,maxXpBonus:WarBalance.campaign_easy_01.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_easy_01.battleList,trickleList:WarBalance.campaign_easy_01.trickleList,starCriteriaList:[{name:"hqHealthFactor",
minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:0},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_easy_02={nameTextId:"CAMPAIGN_NAME_EASY_2",descriptionTextId:"CAMPAIGN_DESCRIPTION_EASY_2",level:2,flag:"mob",maxResourceBonusList:WarBalance.campaign_easy_02.maxResourceBonusList,maxXpBonus:WarBalance.campaign_easy_02.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_easy_02.battleList,
trickleList:WarBalance.campaign_easy_02.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:0},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:40}]};ca.campaign_easy_03={nameTextId:"CAMPAIGN_NAME_EASY_3",descriptionTextId:"CAMPAIGN_DESCRIPTION_EASY_3",level:2,flag:"mob",maxResourceBonusList:WarBalance.campaign_easy_03.maxResourceBonusList,maxXpBonus:WarBalance.campaign_easy_03.maxXpBonus,
campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_easy_03.battleList,trickleList:WarBalance.campaign_easy_03.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:0},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:40}]};ca.campaign_easy_04={nameTextId:"CAMPAIGN_NAME_EASY_4",descriptionTextId:"CAMPAIGN_DESCRIPTION_EASY_4",level:2,flag:"mob",maxResourceBonusList:WarBalance.campaign_easy_04.maxResourceBonusList,
maxXpBonus:WarBalance.campaign_easy_04.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_easy_04.battleList,trickleList:WarBalance.campaign_easy_04.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:0},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:40}]};ca.campaign_easy_05={nameTextId:"CAMPAIGN_NAME_EASY_5",descriptionTextId:"CAMPAIGN_DESCRIPTION_EASY_5",
level:2,flag:"mob",maxResourceBonusList:WarBalance.campaign_easy_05.maxResourceBonusList,maxXpBonus:WarBalance.campaign_easy_05.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_easy_05.battleList,trickleList:WarBalance.campaign_easy_05.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:0},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:40}]};e.archetypes.a_wm_battle_easy_01=
{shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:15,families:[{familyName:"basicMelee",min:1,max:1},{familyName:"basicMelee",min:1,max:1},{familyName:"ranged",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:10,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",
min:2,max:2}]},{enemyThreshold:2,postThresholdDelay:10,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:5,postThresholdDelay:5,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:5,families:[{familyName:"ranged",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"basicMelee",min:4,max:4}]},{postThresholdDelay:3,
families:[{familyName:"miniCharger",min:4,max:4}]},{postThresholdDelay:3,families:[{familyName:"miniCharger",min:4,max:4}]}]}};e.archetypes.a_wm_battle_easy_02={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:15,families:[{familyName:"basicMelee",min:1,max:1},{familyName:"basicMelee",min:1,max:1},{familyName:"ranged",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",
min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:10,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:2,postThresholdDelay:10,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:5,postThresholdDelay:5,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},
{enemyThreshold:5,postThresholdDelay:5,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:5,families:[{familyName:"ranged",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"miniCharger",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"miniCharger",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"charger",
min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"charger",min:2,max:2}]}]}};e.archetypes.a_wm_battle_easy_03={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:15,families:[{familyName:"charger",min:1,max:1}]},{postThresholdDelay:1,families:[{familyName:"charger",min:1,max:1}]},{postThresholdDelay:1,families:[{familyName:"charger",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:2,max:2},
{familyName:"ranged",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:10,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:2,postThresholdDelay:10,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:5,postThresholdDelay:5,families:[{familyName:"miniCharger",min:2,max:3},{familyName:"charger",min:2,max:2},{familyName:"ranged",
min:2,max:2}]},{enemyThreshold:5,postThresholdDelay:5,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"charger",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"basicMelee",min:1,max:1},{familyName:"basicMelee",min:1,max:1},{familyName:"ranged",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:0,
postThresholdDelay:5,families:[{familyName:"ranged",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"miniCharger",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"miniCharger",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"charger",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"charger",min:2,max:2}]}]}};e.archetypes.a_wm_battle_easy_04={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:15,
families:[{familyName:"basicMelee",min:1,max:1},{familyName:"basicMelee",min:1,max:1},{familyName:"ranged",min:1,max:1}]},{enemyThreshold:1,postThresholdDelay:10,families:[{familyName:"bombThrower",min:1,max:1},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:2,postThresholdDelay:10,families:[{familyName:"bombThrower",min:1,max:1},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:5,postThresholdDelay:5,families:[{familyName:"bombThrower",
min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:5,families:[{familyName:"ranged",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"bombThrower",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"bombThrower",min:2,max:2}]}]}};e.archetypes.a_wm_battle_easy_05={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:15,families:[{familyName:"basicMelee",
min:1,max:1},{familyName:"basicMelee",min:1,max:1},{familyName:"ranged",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:10,families:[{familyName:"bombThrower",min:1,max:1},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:2,postThresholdDelay:10,families:[{familyName:"bombThrower",min:1,max:1},
{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:5,postThresholdDelay:5,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:5,postThresholdDelay:5,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:5,families:[{familyName:"ranged",min:2,max:2}]},{postThresholdDelay:3,
families:[{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"bombThrower",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"bombThrower",min:2,max:2}]}]}};ca.campaign_medium_01={nameTextId:"CAMPAIGN_NAME_MEDIUM_1",descriptionTextId:"CAMPAIGN_DESCRIPTION_MEDIUM_1",level:3,flag:"mob",maxResourceBonusList:WarBalance.campaign_medium_01.maxResourceBonusList,maxXpBonus:WarBalance.campaign_medium_01.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_medium_01.battleList,
trickleList:WarBalance.campaign_medium_01.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:0},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:20}]};ca.campaign_medium_02={nameTextId:"CAMPAIGN_NAME_MEDIUM_2",descriptionTextId:"CAMPAIGN_DESCRIPTION_MEDIUM_2",level:3,flag:"mob",maxResourceBonusList:WarBalance.campaign_medium_02.maxResourceBonusList,maxXpBonus:WarBalance.campaign_medium_02.maxXpBonus,
campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_medium_02.battleList,trickleList:WarBalance.campaign_medium_02.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:0},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:50}]};ca.campaign_medium_03={nameTextId:"CAMPAIGN_NAME_MEDIUM_3",descriptionTextId:"CAMPAIGN_DESCRIPTION_MEDIUM_3",level:3,flag:"mob",maxResourceBonusList:WarBalance.campaign_medium_03.maxResourceBonusList,
maxXpBonus:WarBalance.campaign_medium_03.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_medium_03.battleList,trickleList:WarBalance.campaign_medium_03.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:0},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:70}]};e.archetypes.a_wm_battle_medium_01={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:15,
families:[{familyName:"basicMelee",min:1,max:1},{familyName:"basicMelee",min:1,max:1},{familyName:"ranged",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:10,families:[{familyName:"berserker",min:1,max:1}]},{enemyThreshold:2,postThresholdDelay:10,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:2,max:2},
{familyName:"ranged",min:2,max:2}]},{enemyThreshold:5,postThresholdDelay:5,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:10,families:[{familyName:"berserker",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:5,families:[{familyName:"ranged",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:3,families:[{familyName:"bombThrower",
min:3,max:3}]},{postThresholdDelay:3,families:[{familyName:"bombThrower",min:3,max:3}]}]}};e.archetypes.a_wm_battle_medium_02={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:15,families:[{familyName:"basicMelee",min:1,max:1},{familyName:"basicMelee",min:1,max:1},{familyName:"ranged",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:1,
postThresholdDelay:10,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:10,families:[{familyName:"berserker",min:1,max:1}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:5,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:5,postThresholdDelay:5,
families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:10,families:[{familyName:"berserker",min:1,max:1}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:5,families:[{familyName:"ranged",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"bombThrower",min:2,
max:2}]},{postThresholdDelay:3,families:[{familyName:"bombThrower",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:10,families:[{familyName:"berserker",min:1,max:1}]},{enemyThreshold:1,postThresholdDelay:10,families:[{familyName:"berserker",min:1,max:1}]},{postThresholdDelay:3,families:[{familyName:"bombThrower",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"bombThrower",min:2,max:2}]}]}};e.archetypes.a_wm_battle_medium_03={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:15,
families:[{familyName:"berserker",min:1,max:1}]},{postThresholdDelay:1,families:[{familyName:"berserker",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:5,families:[{familyName:"treasureDropper",min:1,max:1}]},{enemyThreshold:1,postThresholdDelay:10,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:2,max:2},
{familyName:"ranged",min:2,max:2}]},{enemyThreshold:2,postThresholdDelay:10,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:5,postThresholdDelay:5,families:[{familyName:"bombThrower",min:2,max:3},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:10,postThresholdDelay:5,families:[{familyName:"treasureDropper",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:5,families:[{familyName:"miniCharger",min:2,max:2},
{familyName:"charger",min:2,max:2},{familyName:"ranged",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"basicMelee",min:1,max:1},{familyName:"basicMelee",min:1,max:1},{familyName:"ranged",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:2,max:2},{familyName:"bombThrower",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:5,families:[{familyName:"ranged",min:2,max:2}]},{postThresholdDelay:3,
families:[{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"miniCharger",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"bombThrower",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"charger",min:2,max:2}]}]}};ca.campaign_pyro_01={nameTextId:"CAMPAIGN_NAME_BOMBTHROWER_1",descriptionTextId:"CAMPAIGN_DESCRIPTION_BOMBTHROWER_1",level:6,flag:"bombthrower",maxResourceBonusList:WarBalance.campaign_pyro_01.maxResourceBonusList,maxXpBonus:WarBalance.campaign_pyro_01.maxXpBonus,
campaignStarterArchetype:"a_cs_pyro",battleList:WarBalance.campaign_pyro_01.battleList,trickleList:WarBalance.campaign_pyro_01.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:40}]};ca.campaign_pyro_02={nameTextId:"CAMPAIGN_NAME_BOMBTHROWER_2",descriptionTextId:"CAMPAIGN_DESCRIPTION_BOMBTHROWER_2",level:7,flag:"bombthrower",maxResourceBonusList:WarBalance.campaign_pyro_02.maxResourceBonusList,
maxXpBonus:WarBalance.campaign_pyro_02.maxXpBonus,campaignStarterArchetype:"a_cs_pyro",battleList:WarBalance.campaign_pyro_02.battleList,trickleList:WarBalance.campaign_pyro_02.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:40}]};ca.campaign_pyro_03={nameTextId:"CAMPAIGN_NAME_BOMBTHROWER_3",descriptionTextId:"CAMPAIGN_DESCRIPTION_BOMBTHROWER_3",
level:8,flag:"bombthrower",maxResourceBonusList:WarBalance.campaign_pyro_03.maxResourceBonusList,maxXpBonus:WarBalance.campaign_pyro_03.maxXpBonus,campaignStarterArchetype:"a_cs_pyro",battleList:WarBalance.campaign_pyro_03.battleList,trickleList:WarBalance.campaign_pyro_03.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_pyro_04=
{nameTextId:"CAMPAIGN_NAME_BOMBTHROWER_4",descriptionTextId:"CAMPAIGN_DESCRIPTION_BOMBTHROWER_4",level:9,flag:"bombthrower",maxResourceBonusList:WarBalance.campaign_pyro_04.maxResourceBonusList,maxXpBonus:WarBalance.campaign_pyro_04.maxXpBonus,campaignStarterArchetype:"a_cs_pyro",battleList:WarBalance.campaign_pyro_04.battleList,trickleList:WarBalance.campaign_pyro_04.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},
{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_pyro_05={nameTextId:"CAMPAIGN_NAME_BOMBTHROWER_5",descriptionTextId:"CAMPAIGN_DESCRIPTION_BOMBTHROWER_5",level:10,flag:"bombthrower",maxResourceBonusList:WarBalance.campaign_pyro_05.maxResourceBonusList,maxXpBonus:WarBalance.campaign_pyro_05.maxXpBonus,campaignStarterArchetype:"a_cs_pyro",battleList:WarBalance.campaign_pyro_05.battleList,trickleList:WarBalance.campaign_pyro_05.trickleList,starCriteriaList:[{name:"hqHealthFactor",
minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};e.archetypes.a_wm_battle_pyro_01={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bannerlingBombThrower",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:4,max:4}]},{enemyThreshold:0,
postThresholdDelay:0,families:[{familyName:"bombThrower",min:3,max:3},{familyName:"basicMelee",min:4,max:4}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bombThrower",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:6,families:[{familyName:"bombThrower",min:2,max:2}]},{postThresholdDelay:9,families:[{familyName:"basicMelee",min:2,max:2}]}]}};e.archetypes.a_wm_battle_pyro_02={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,
postThresholdDelay:0,families:[{familyName:"berserker",min:1,max:1}]},{postThresholdDelay:6,families:[{familyName:"bombThrower",min:3,max:3}]},{postThresholdDelay:2,families:[{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:1,max:1}]},{postThresholdDelay:1,families:[{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:6,families:[{familyName:"bombThrower",min:3,max:3}]},{postThresholdDelay:9,families:[{familyName:"basicMelee",
min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:2,max:2}]},{postThresholdDelay:2,families:[{familyName:"basicMelee",min:6,max:6}]},{postThresholdDelay:4,families:[{familyName:"bombThrower",min:2,max:2}]},{postThresholdDelay:9,families:[{familyName:"bombThrower",min:2,max:2}]}]}};e.archetypes.a_wm_battle_pyro_03={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"berserker",min:1,max:1}]},{postThresholdDelay:6,
families:[{familyName:"bombThrower",min:3,max:3}]},{postThresholdDelay:2,families:[{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:1,max:1}]},{postThresholdDelay:1,families:[{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:6,families:[{familyName:"bombThrower",min:3,max:3}]},{postThresholdDelay:9,families:[{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",
min:3,max:3}]},{postThresholdDelay:2,families:[{familyName:"basicMelee",min:6,max:6}]},{postThresholdDelay:4,families:[{familyName:"bombThrower",min:4,max:4}]},{postThresholdDelay:6,families:[{familyName:"chargerBoss",min:1,max:1}]}]}};e.archetypes.a_wm_battle_pyro_04={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"berserker",min:1,max:1}]},{postThresholdDelay:6,families:[{familyName:"bombThrower",min:3,max:3}]},{postThresholdDelay:2,
families:[{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:1,max:1}]},{postThresholdDelay:1,families:[{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:6,families:[{familyName:"bombThrower",min:3,max:3}]},{postThresholdDelay:9,families:[{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:2,max:2}]},{postThresholdDelay:2,families:[{familyName:"basicMelee",min:6,
max:6}]},{postThresholdDelay:4,families:[{familyName:"bombThrower",min:2,max:2}]},{postThresholdDelay:9,families:[{familyName:"bombThrower",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:15,families:[{familyName:"berserker",min:1,max:1}]},{postThresholdDelay:6,families:[{familyName:"bombThrower",min:3,max:3}]},{postThresholdDelay:2,families:[{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:1,max:1}]},{postThresholdDelay:1,families:[{familyName:"basicMelee",
min:2,max:2}]},{postThresholdDelay:6,families:[{familyName:"bombThrower",min:3,max:3}]},{postThresholdDelay:9,families:[{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:3,max:3}]},{postThresholdDelay:2,families:[{familyName:"basicMelee",min:6,max:6}]},{postThresholdDelay:4,families:[{familyName:"bombThrower",min:4,max:4}]},{postThresholdDelay:6,families:[{familyName:"chargerBoss",min:1,max:1}]}]}};ca.campaign_moba_01={nameTextId:"CAMPAIGN_NAME_MOBA_1",
descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBA_1",level:3,flag:"mob",maxResourceBonusList:WarBalance.campaign_moba_01.maxResourceBonusList,maxXpBonus:WarBalance.campaign_moba_01.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_moba_01.battleList,trickleList:WarBalance.campaign_moba_01.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};
ca.campaign_moba_02={nameTextId:"CAMPAIGN_NAME_MOBA_2",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBA_2",level:4,flag:"mob",maxResourceBonusList:WarBalance.campaign_moba_02.maxResourceBonusList,maxXpBonus:WarBalance.campaign_moba_02.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_moba_02.battleList,trickleList:WarBalance.campaign_moba_02.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},
{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:50}]};ca.campaign_moba_03={nameTextId:"CAMPAIGN_NAME_MOBA_3",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBA_3",level:4,flag:"mob",maxResourceBonusList:WarBalance.campaign_moba_03.maxResourceBonusList,maxXpBonus:WarBalance.campaign_moba_03.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_moba_03.battleList,trickleList:WarBalance.campaign_moba_03.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},
{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:50}]};ca.campaign_moba_04={nameTextId:"CAMPAIGN_NAME_MOBA_4",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBA_4",level:5,flag:"mob",maxResourceBonusList:WarBalance.campaign_moba_04.maxResourceBonusList,maxXpBonus:WarBalance.campaign_moba_04.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_moba_04.battleList,trickleList:WarBalance.campaign_moba_04.trickleList,
starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:40}]};ca.campaign_moba_05={nameTextId:"CAMPAIGN_NAME_MOBA_5",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBA_5",level:5,flag:"mob",maxResourceBonusList:WarBalance.campaign_moba_05.maxResourceBonusList,maxXpBonus:WarBalance.campaign_moba_05.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_moba_05.battleList,
trickleList:WarBalance.campaign_moba_05.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_moba_06={nameTextId:"CAMPAIGN_NAME_MOBA_6",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBA_6",level:6,flag:"mob",maxResourceBonusList:WarBalance.campaign_moba_06.maxResourceBonusList,maxXpBonus:WarBalance.campaign_moba_06.maxXpBonus,
campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_moba_06.battleList,trickleList:WarBalance.campaign_moba_06.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_moba_07={nameTextId:"CAMPAIGN_NAME_MOBA_7",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBA_7",level:6,flag:"mob",maxResourceBonusList:WarBalance.campaign_moba_07.maxResourceBonusList,
maxXpBonus:WarBalance.campaign_moba_07.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_moba_07.battleList,trickleList:WarBalance.campaign_moba_07.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_moba_08={nameTextId:"CAMPAIGN_NAME_MOBA_8",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBA_8",
level:7,flag:"mob",maxResourceBonusList:WarBalance.campaign_moba_08.maxResourceBonusList,maxXpBonus:WarBalance.campaign_moba_08.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_moba_08.battleList,trickleList:WarBalance.campaign_moba_08.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_moba_09=
{nameTextId:"CAMPAIGN_NAME_MOBA_9",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBA_9",level:8,flag:"mob",maxResourceBonusList:WarBalance.campaign_moba_09.maxResourceBonusList,maxXpBonus:WarBalance.campaign_moba_09.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_moba_09.battleList,trickleList:WarBalance.campaign_moba_09.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",
minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_moba_10={nameTextId:"CAMPAIGN_NAME_MOBA_10",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBA_10",level:9,flag:"mob",maxResourceBonusList:WarBalance.campaign_moba_10.maxResourceBonusList,maxXpBonus:WarBalance.campaign_moba_10.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_moba_10.battleList,trickleList:WarBalance.campaign_moba_10.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",
maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_moba_11={nameTextId:"CAMPAIGN_NAME_MOBA_11",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBA_11",level:10,flag:"mob",maxResourceBonusList:WarBalance.campaign_moba_11.maxResourceBonusList,maxXpBonus:WarBalance.campaign_moba_11.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_moba_11.battleList,trickleList:WarBalance.campaign_moba_11.trickleList,starCriteriaList:[{name:"hqHealthFactor",
minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};e.archetypes.a_wm_battle_moba_01={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:7,families:[{familyName:"bombThrower",
min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:14,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:2,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:3,
postThresholdDelay:7,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"treasureDropper",min:0,max:1}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]}]}};e.archetypes.a_wm_battle_moba_02={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:1,max:1},{familyName:"basicMelee",
min:2,max:2}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:7,families:[{familyName:"bombThrower",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"death",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:14,families:[{familyName:"bombThrower",min:2,
max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:2,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:3,postThresholdDelay:7,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"treasureDropper",min:0,max:1}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"ranged",
min:2,max:2},{familyName:"basicMelee",min:3,max:3}]}]}};e.archetypes.a_wm_battle_moba_03={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:7,families:[{familyName:"bombThrower",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:7,
families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"death",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:14,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:2,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:3,
postThresholdDelay:7,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"treasureDropper",min:0,max:1}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"chargerBoss",min:0,max:1}]}]}};e.archetypes.a_wm_battle_moba_04={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,
postThresholdDelay:10,families:[{familyName:"ranged",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:7,families:[{familyName:"bombThrower",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"death",min:0,
max:1}]},{enemyThreshold:0,postThresholdDelay:14,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:2,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:3,postThresholdDelay:7,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"treasureDropper",
min:0,max:1}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"chargerBoss",min:0,max:1}]}]}};e.archetypes.a_wm_battle_moba_05={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},
{enemyThreshold:0,postThresholdDelay:7,families:[{familyName:"bombThrower",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"death",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:14,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"berserker",
min:0,max:1}]},{enemyThreshold:2,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:3,postThresholdDelay:7,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"treasureDropper",min:0,max:1}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:4,postThresholdDelay:7,
families:[{familyName:"chargerBoss",min:0,max:1}]}]}};e.archetypes.a_wm_battle_moba_06={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:7,families:[{familyName:"bombThrower",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:7,families:[{familyName:"ranged",
min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"death",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:14,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:2,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:3,postThresholdDelay:7,families:[{familyName:"bombThrower",
min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"treasureDropper",min:0,max:1}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"chargerBoss",min:0,max:1}]}]}};ca.campaign_mobb_01={nameTextId:"CAMPAIGN_NAME_MOBB_1",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBB_1",level:3,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobb_01.maxResourceBonusList,
maxXpBonus:WarBalance.campaign_mobb_01.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobb_01.battleList,trickleList:WarBalance.campaign_mobb_01.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_mobb_02={nameTextId:"CAMPAIGN_NAME_MOBB_2",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBB_2",
level:4,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobb_02.maxResourceBonusList,maxXpBonus:WarBalance.campaign_mobb_02.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobb_02.battleList,trickleList:WarBalance.campaign_mobb_02.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:50}]};ca.campaign_mobb_03=
{nameTextId:"CAMPAIGN_NAME_MOBB_3",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBB_3",level:4,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobb_03.maxResourceBonusList,maxXpBonus:WarBalance.campaign_mobb_03.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobb_03.battleList,trickleList:WarBalance.campaign_mobb_03.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",
minNumberOfFeralsKilledByHeroForSuccess:50}]};ca.campaign_mobb_04={nameTextId:"CAMPAIGN_NAME_MOBB_4",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBB_4",level:5,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobb_04.maxResourceBonusList,maxXpBonus:WarBalance.campaign_mobb_04.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobb_04.battleList,trickleList:WarBalance.campaign_mobb_04.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",
maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:40}]};ca.campaign_mobb_05={nameTextId:"CAMPAIGN_NAME_MOBB_5",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBB_5",level:5,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobb_05.maxResourceBonusList,maxXpBonus:WarBalance.campaign_mobb_05.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobb_05.battleList,trickleList:WarBalance.campaign_mobb_05.trickleList,starCriteriaList:[{name:"hqHealthFactor",
minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_mobb_06={nameTextId:"CAMPAIGN_NAME_MOBB_6",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBB_6",level:6,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobb_06.maxResourceBonusList,maxXpBonus:WarBalance.campaign_mobb_06.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobb_06.battleList,
trickleList:WarBalance.campaign_mobb_06.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_mobb_07={nameTextId:"CAMPAIGN_NAME_MOBB_7",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBB_7",level:6,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobb_07.maxResourceBonusList,maxXpBonus:WarBalance.campaign_mobb_07.maxXpBonus,
campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobb_07.battleList,trickleList:WarBalance.campaign_mobb_07.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_mobb_08={nameTextId:"CAMPAIGN_NAME_MOBB_8",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBB_8",level:7,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobb_08.maxResourceBonusList,
maxXpBonus:WarBalance.campaign_mobb_08.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobb_08.battleList,trickleList:WarBalance.campaign_mobb_08.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_mobb_09={nameTextId:"CAMPAIGN_NAME_MOBB_9",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBB_9",
level:8,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobb_09.maxResourceBonusList,maxXpBonus:WarBalance.campaign_mobb_09.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobb_09.battleList,trickleList:WarBalance.campaign_mobb_09.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_mobb_10=
{nameTextId:"CAMPAIGN_NAME_MOBB_10",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBB_10",level:9,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobb_10.maxResourceBonusList,maxXpBonus:WarBalance.campaign_mobb_10.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobb_10.battleList,trickleList:WarBalance.campaign_mobb_10.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},
{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_mobb_11={nameTextId:"CAMPAIGN_NAME_MOBB_11",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBB_11",level:10,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobb_11.maxResourceBonusList,maxXpBonus:WarBalance.campaign_mobb_11.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobb_11.battleList,trickleList:WarBalance.campaign_mobb_11.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},
{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};e.archetypes.a_wm_battle_mobb_01={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:7,families:[{familyName:"charger",min:1,max:1},
{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:14,families:[{familyName:"charger",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:2,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:3,postThresholdDelay:7,
families:[{familyName:"charger",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"treasureDropper",min:0,max:1}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]}]}};e.archetypes.a_wm_battle_mobb_02={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:0,
families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:7,families:[{familyName:"charger",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"death",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:14,families:[{familyName:"charger",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},
{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:2,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:3,postThresholdDelay:7,families:[{familyName:"charger",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"treasureDropper",min:0,max:1}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",
min:3,max:3}]}]}};e.archetypes.a_wm_battle_mobb_03={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:7,families:[{familyName:"charger",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},
{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"death",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:14,families:[{familyName:"charger",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:2,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:3,postThresholdDelay:7,families:[{familyName:"charger",
min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"treasureDropper",min:0,max:1}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"chargerBoss",min:0,max:1}]}]}};e.archetypes.a_wm_battle_mobb_04={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:1,
max:1},{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:7,families:[{familyName:"charger",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"death",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:14,families:[{familyName:"charger",
min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:2,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:3,postThresholdDelay:7,families:[{familyName:"charger",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"treasureDropper",min:0,max:1}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"ranged",
min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"chargerBoss",min:0,max:1}]}]}};e.archetypes.a_wm_battle_mobb_05={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:7,families:[{familyName:"charger",min:1,
max:1},{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"death",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:14,families:[{familyName:"charger",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:2,postThresholdDelay:7,families:[{familyName:"ranged",
min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:3,postThresholdDelay:7,families:[{familyName:"charger",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"treasureDropper",min:0,max:1}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"chargerBoss",min:0,max:1}]}]}};e.archetypes.a_wm_battle_mobb_06=
{shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:7,families:[{familyName:"charger",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,
postThresholdDelay:10,families:[{familyName:"death",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:14,families:[{familyName:"charger",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:2,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:3,postThresholdDelay:7,families:[{familyName:"charger",min:2,max:2},{familyName:"basicMelee",min:3,
max:3}]},{postThresholdDelay:0,families:[{familyName:"treasureDropper",min:0,max:1}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"chargerBoss",min:0,max:1}]}]}};ca.campaign_mobc_01={nameTextId:"CAMPAIGN_NAME_MOBC_1",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBC_1",level:3,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobc_01.maxResourceBonusList,maxXpBonus:WarBalance.campaign_mobc_01.maxXpBonus,
campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobc_01.battleList,trickleList:WarBalance.campaign_mobc_01.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_mobc_02={nameTextId:"CAMPAIGN_NAME_MOBC_2",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBC_2",level:4,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobc_02.maxResourceBonusList,
maxXpBonus:WarBalance.campaign_mobc_02.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobc_02.battleList,trickleList:WarBalance.campaign_mobc_02.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:50}]};ca.campaign_mobc_03={nameTextId:"CAMPAIGN_NAME_MOBC_3",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBC_3",
level:4,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobc_03.maxResourceBonusList,maxXpBonus:WarBalance.campaign_mobc_03.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobc_03.battleList,trickleList:WarBalance.campaign_mobc_03.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:50}]};ca.campaign_mobc_04=
{nameTextId:"CAMPAIGN_NAME_MOBC_4",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBC_4",level:5,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobc_04.maxResourceBonusList,maxXpBonus:WarBalance.campaign_mobc_04.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobc_04.battleList,trickleList:WarBalance.campaign_mobc_04.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",
minNumberOfFeralsKilledByHeroForSuccess:40}]};ca.campaign_mobc_05={nameTextId:"CAMPAIGN_NAME_MOBC_5",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBC_5",level:5,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobc_05.maxResourceBonusList,maxXpBonus:WarBalance.campaign_mobc_05.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobc_05.battleList,trickleList:WarBalance.campaign_mobc_05.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",
maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_mobc_06={nameTextId:"CAMPAIGN_NAME_MOBC_6",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBC_6",level:6,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobc_06.maxResourceBonusList,maxXpBonus:WarBalance.campaign_mobc_06.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobc_06.battleList,trickleList:WarBalance.campaign_mobc_06.trickleList,starCriteriaList:[{name:"hqHealthFactor",
minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_mobc_07={nameTextId:"CAMPAIGN_NAME_MOBC_7",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBC_7",level:6,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobc_07.maxResourceBonusList,maxXpBonus:WarBalance.campaign_mobc_07.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobc_07.battleList,
trickleList:WarBalance.campaign_mobc_07.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_mobc_08={nameTextId:"CAMPAIGN_NAME_MOBC_8",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBC_8",level:7,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobc_08.maxResourceBonusList,maxXpBonus:WarBalance.campaign_mobc_08.maxXpBonus,
campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobc_08.battleList,trickleList:WarBalance.campaign_mobc_08.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_mobc_09={nameTextId:"CAMPAIGN_NAME_MOBC_9",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBC_9",level:8,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobc_09.maxResourceBonusList,
maxXpBonus:WarBalance.campaign_mobc_09.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobc_09.battleList,trickleList:WarBalance.campaign_mobc_09.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_mobc_10={nameTextId:"CAMPAIGN_NAME_MOBC_10",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBC_10",
level:9,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobc_10.maxResourceBonusList,maxXpBonus:WarBalance.campaign_mobc_10.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobc_10.battleList,trickleList:WarBalance.campaign_mobc_10.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_mobc_11=
{nameTextId:"CAMPAIGN_NAME_MOBC_11",descriptionTextId:"CAMPAIGN_DESCRIPTION_MOBC_11",level:10,flag:"mob",maxResourceBonusList:WarBalance.campaign_mobc_11.maxResourceBonusList,maxXpBonus:WarBalance.campaign_mobc_11.maxXpBonus,campaignStarterArchetype:"a_cs_mob",battleList:WarBalance.campaign_mobc_11.battleList,trickleList:WarBalance.campaign_mobc_11.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},
{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};e.archetypes.a_wm_battle_mobc_01={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:7,families:[{familyName:"miniCharger",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:7,
families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:14,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:2,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:3,postThresholdDelay:7,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",
min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"treasureDropper",min:0,max:1}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]}]}};e.archetypes.a_wm_battle_mobc_02={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:0,
postThresholdDelay:7,families:[{familyName:"miniCharger",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"death",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:14,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"berserker",
min:0,max:1}]},{enemyThreshold:2,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:3,postThresholdDelay:7,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"treasureDropper",min:0,max:1}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]}]}};e.archetypes.a_wm_battle_mobc_03=
{shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:7,families:[{familyName:"miniCharger",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,
postThresholdDelay:10,families:[{familyName:"death",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:14,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:2,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:3,postThresholdDelay:7,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",
min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"treasureDropper",min:0,max:1}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"chargerBoss",min:0,max:1}]}]}};e.archetypes.a_wm_battle_mobc_04={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:1,max:1},{familyName:"basicMelee",min:2,
max:2}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:7,families:[{familyName:"miniCharger",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"death",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:14,families:[{familyName:"miniCharger",min:2,max:2},
{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:2,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:3,postThresholdDelay:7,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"treasureDropper",min:0,max:1}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"ranged",
min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"chargerBoss",min:0,max:1}]}]}};e.archetypes.a_wm_battle_mobc_05={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:7,families:[{familyName:"miniCharger",min:1,
max:1},{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"death",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:14,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:2,postThresholdDelay:7,families:[{familyName:"ranged",
min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:3,postThresholdDelay:7,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"treasureDropper",min:0,max:1}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"chargerBoss",min:0,max:1}]}]}};e.archetypes.a_wm_battle_mobc_06=
{shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:7,families:[{familyName:"miniCharger",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,
postThresholdDelay:10,families:[{familyName:"death",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:14,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:2,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:3,postThresholdDelay:7,families:[{familyName:"miniCharger",min:2,max:2},{familyName:"basicMelee",
min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"treasureDropper",min:0,max:1}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"chargerBoss",min:0,max:1}]}]}};ca.campaign_boss_01={nameTextId:"CAMPAIGN_NAME_BOSS_1",descriptionTextId:"CAMPAIGN_DESCRIPTION_BOSS_1",level:4,flag:"boss",isBossCampaign:!0,maxResourceBonusList:WarBalance.campaign_boss_01.maxResourceBonusList,
maxXpBonus:WarBalance.campaign_boss_01.maxXpBonus,campaignStarterArchetype:"a_cs_boss",battleList:WarBalance.campaign_boss_01.battleList,trickleList:WarBalance.campaign_boss_01.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:50}]};ca.campaign_boss_02={nameTextId:"CAMPAIGN_NAME_BOSS_2",descriptionTextId:"CAMPAIGN_DESCRIPTION_BOSS_2",
level:7,flag:"boss",isBossCampaign:!0,maxResourceBonusList:WarBalance.campaign_boss_02.maxResourceBonusList,maxXpBonus:WarBalance.campaign_boss_02.maxXpBonus,campaignStarterArchetype:"a_cs_boss",battleList:WarBalance.campaign_boss_02.battleList,trickleList:WarBalance.campaign_boss_02.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:40}]};
ca.campaign_boss_03={nameTextId:"CAMPAIGN_NAME_BOSS_3",descriptionTextId:"CAMPAIGN_DESCRIPTION_BOSS_3",level:8,flag:"boss",isBossCampaign:!0,maxResourceBonusList:WarBalance.campaign_boss_03.maxResourceBonusList,maxXpBonus:WarBalance.campaign_boss_03.maxXpBonus,campaignStarterArchetype:"a_cs_boss",battleList:WarBalance.campaign_boss_03.battleList,trickleList:WarBalance.campaign_boss_03.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",
maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:40}]};ca.campaign_boss_04={nameTextId:"CAMPAIGN_NAME_BOSS_4",descriptionTextId:"CAMPAIGN_DESCRIPTION_BOSS_4",level:9,flag:"boss",isBossCampaign:!0,maxResourceBonusList:WarBalance.campaign_boss_04.maxResourceBonusList,maxXpBonus:WarBalance.campaign_boss_04.maxXpBonus,campaignStarterArchetype:"a_cs_boss",battleList:WarBalance.campaign_boss_04.battleList,trickleList:WarBalance.campaign_boss_04.trickleList,
starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:40}]};ca.campaign_boss_05={nameTextId:"CAMPAIGN_NAME_BOSS_5",descriptionTextId:"CAMPAIGN_DESCRIPTION_BOSS_5",level:10,flag:"boss",isBossCampaign:!0,maxResourceBonusList:WarBalance.campaign_boss_05.maxResourceBonusList,maxXpBonus:WarBalance.campaign_boss_05.maxXpBonus,campaignStarterArchetype:"a_cs_boss",
battleList:WarBalance.campaign_boss_05.battleList,trickleList:WarBalance.campaign_boss_05.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};e.archetypes.a_wm_battle_boss_01={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:1,max:1},{familyName:"basicMelee",
min:2,max:2}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:7,families:[{familyName:"bombThrower",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"death",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:14,families:[{familyName:"bombThrower",min:2,
max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:1,max:1}]},{enemyThreshold:2,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:3,postThresholdDelay:7,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"treasureDropper",min:1,max:1}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"ranged",
min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"chargerBoss",min:1,max:1}]}]}};e.archetypes.a_wm_battle_boss_02={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bannerling",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:1,max:1}]},{postThresholdDelay:6,families:[{familyName:"bombThrower",min:3,max:3}]},{postThresholdDelay:2,
families:[{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:1,max:1}]},{postThresholdDelay:1,families:[{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:6,families:[{familyName:"bombThrower",min:3,max:3}]},{postThresholdDelay:9,families:[{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:3,max:3}]},{postThresholdDelay:2,families:[{familyName:"basicMelee",min:6,
max:6}]},{postThresholdDelay:4,families:[{familyName:"bombThrower",min:4,max:4}]},{postThresholdDelay:6,families:[{familyName:"chargerBoss",min:1,max:1}]}]}};e.archetypes.a_wm_battle_boss_03={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bannerlingBoss",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:4,max:4}]},{postThresholdDelay:3,families:[{familyName:"basicMelee",min:6,max:6}]},{postThresholdDelay:3,
families:[{familyName:"death",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:2,max:2}]},{postThresholdDelay:1,families:[{familyName:"death",min:1,max:1}]},{postThresholdDelay:8,families:[{familyName:"basicMelee",min:6,max:6}]},{postThresholdDelay:10,families:[{familyName:"death",min:2,max:2}]},{postThresholdDelay:16,families:[{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:4,max:4}]},
{postThresholdDelay:0,families:[{familyName:"death",min:3,max:3}]},{postThresholdDelay:8,families:[{familyName:"thief",min:6,max:6}]},{postThresholdDelay:10,families:[{familyName:"death",min:1,max:1}]},{postThresholdDelay:10,families:[{familyName:"chargerBoss",min:1,max:1}]}]}};e.archetypes.a_wm_battle_boss_04={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bannerlingBoss",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bombThrower",
min:3,max:3},{familyName:"miniCharger",min:2,max:2}]},{postThresholdDelay:6,families:[{familyName:"charger",min:1,max:1}]},{postThresholdDelay:2,families:[{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bombThrower",min:3,max:3},{familyName:"miniCharger",min:2,max:2}]},{postThresholdDelay:1,families:[{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:6,families:[{familyName:"charger",min:2,max:2}]},{postThresholdDelay:9,families:[{familyName:"basicMelee",
min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:1,max:1},{familyName:"miniCharger",min:3,max:3}]},{postThresholdDelay:2,families:[{familyName:"basicMelee",min:4,max:4}]},{postThresholdDelay:4,families:[{familyName:"charger",min:2,max:2}]},{postThresholdDelay:9,families:[{familyName:"chargerBoss",min:1,max:1}]}]}};e.archetypes.a_wm_battle_boss_05={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"berserker",
min:1,max:1}]},{postThresholdDelay:6,families:[{familyName:"bombThrower",min:3,max:3}]},{postThresholdDelay:2,families:[{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:2,postThresholdDelay:0,families:[{familyName:"berserker",min:1,max:1}]},{postThresholdDelay:1,families:[{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:6,families:[{familyName:"bombThrower",min:3,max:3}]},{postThresholdDelay:9,families:[{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:3,postThresholdDelay:0,
families:[{familyName:"berserker",min:3,max:3}]},{postThresholdDelay:2,families:[{familyName:"basicMelee",min:6,max:6}]},{postThresholdDelay:4,families:[{familyName:"bombThrower",min:4,max:4}]},{enemyThreshold:4,postThresholdDelay:0,families:[{familyName:"berserker",min:1,max:1}]},{postThresholdDelay:6,families:[{familyName:"bombThrower",min:3,max:3}]},{postThresholdDelay:2,families:[{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:5,postThresholdDelay:0,families:[{familyName:"berserker",min:1,
max:1}]},{postThresholdDelay:1,families:[{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:6,families:[{familyName:"bombThrower",min:3,max:3}]},{postThresholdDelay:9,families:[{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:6,postThresholdDelay:0,families:[{familyName:"berserker",min:3,max:3}]},{postThresholdDelay:2,families:[{familyName:"basicMelee",min:6,max:6}]},{postThresholdDelay:4,families:[{familyName:"bombThrower",min:4,max:4}]},{postThresholdDelay:6,families:[{familyName:"chargerBoss",
min:1,max:1}]}]}};ca.campaign_ranged_01={nameTextId:"CAMPAIGN_NAME_RANGED_1",descriptionTextId:"CAMPAIGN_DESCRIPTION_RANGED_1",level:6,flag:"ranged",maxResourceBonusList:WarBalance.campaign_ranged_01.maxResourceBonusList,maxXpBonus:WarBalance.campaign_ranged_01.maxXpBonus,campaignStarterArchetype:"a_cs_ranged",battleList:WarBalance.campaign_ranged_01.battleList,trickleList:WarBalance.campaign_ranged_01.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",
maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:40}]};ca.campaign_ranged_02={nameTextId:"CAMPAIGN_NAME_RANGED_2",descriptionTextId:"CAMPAIGN_DESCRIPTION_RANGED_2",level:7,flag:"ranged",maxResourceBonusList:WarBalance.campaign_ranged_02.maxResourceBonusList,maxXpBonus:WarBalance.campaign_ranged_02.maxXpBonus,campaignStarterArchetype:"a_cs_ranged",battleList:WarBalance.campaign_ranged_02.battleList,trickleList:WarBalance.campaign_ranged_02.trickleList,
starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:40}]};ca.campaign_ranged_03={nameTextId:"CAMPAIGN_NAME_RANGED_3",descriptionTextId:"CAMPAIGN_DESCRIPTION_RANGED_3",level:8,flag:"ranged",maxResourceBonusList:WarBalance.campaign_ranged_03.maxResourceBonusList,maxXpBonus:WarBalance.campaign_ranged_03.maxXpBonus,campaignStarterArchetype:"a_cs_ranged",
battleList:WarBalance.campaign_ranged_03.battleList,trickleList:WarBalance.campaign_ranged_03.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_ranged_04={nameTextId:"CAMPAIGN_NAME_RANGED_4",descriptionTextId:"CAMPAIGN_DESCRIPTION_RANGED_4",level:9,flag:"ranged",maxResourceBonusList:WarBalance.campaign_ranged_04.maxResourceBonusList,
maxXpBonus:WarBalance.campaign_ranged_04.maxXpBonus,campaignStarterArchetype:"a_cs_ranged",battleList:WarBalance.campaign_ranged_04.battleList,trickleList:WarBalance.campaign_ranged_04.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_ranged_05={nameTextId:"CAMPAIGN_NAME_RANGED_5",descriptionTextId:"CAMPAIGN_DESCRIPTION_RANGED_5",
level:10,flag:"ranged",maxResourceBonusList:WarBalance.campaign_ranged_05.maxResourceBonusList,maxXpBonus:WarBalance.campaign_ranged_05.maxXpBonus,campaignStarterArchetype:"a_cs_ranged",battleList:WarBalance.campaign_ranged_05.battleList,trickleList:WarBalance.campaign_ranged_05.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};
e.archetypes.a_wm_battle_ranged_01={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bannerlingRanged",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:4,max:4}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:4,max:4},{familyName:"basicMelee",min:4,max:4}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:6,
max:6},{familyName:"basicMelee",min:4,max:4}]}]}};e.archetypes.a_wm_battle_ranged_02={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:2,max:2},{familyName:"charger",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:4,max:4},{familyName:"charger",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:6,max:6},{familyName:"charger",min:1,max:1}]}]}};e.archetypes.a_wm_battle_ranged_03=
{shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:6,max:6},{familyName:"berserker",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"death",min:1,max:1}]},{postThresholdDelay:3,families:[{familyName:"ranged",min:6,max:6}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:9,max:9}]},{postThresholdDelay:3,families:[{familyName:"chargerBoss",min:1,max:1}]}]}};e.archetypes.a_wm_battle_ranged_04=
{shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:2,max:2},{familyName:"charger",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:4,max:4},{familyName:"charger",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:6,max:6},{familyName:"charger",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:15,families:[{familyName:"ranged",min:6,max:6},{familyName:"berserker",
min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"death",min:1,max:1}]},{postThresholdDelay:3,families:[{familyName:"ranged",min:6,max:6}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:9,max:9}]},{postThresholdDelay:3,families:[{familyName:"chargerBoss",min:1,max:1}]}]}};ca.campaign_thief_01={nameTextId:"CAMPAIGN_NAME_THIEF_1",descriptionTextId:"CAMPAIGN_DESCRIPTION_THIEF_1",level:7,flag:"thief",maxResourceBonusList:WarBalance.campaign_thief_01.maxResourceBonusList,
maxXpBonus:WarBalance.campaign_thief_01.maxXpBonus,campaignStarterArchetype:"a_cs_thief",battleList:WarBalance.campaign_thief_01.battleList,trickleList:WarBalance.campaign_thief_01.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:40}]};ca.campaign_thief_02={nameTextId:"CAMPAIGN_NAME_THIEF_2",descriptionTextId:"CAMPAIGN_DESCRIPTION_THIEF_2",
level:8,flag:"thief",maxResourceBonusList:WarBalance.campaign_thief_02.maxResourceBonusList,maxXpBonus:WarBalance.campaign_thief_02.maxXpBonus,campaignStarterArchetype:"a_cs_thief",battleList:WarBalance.campaign_thief_02.battleList,trickleList:WarBalance.campaign_thief_02.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:40}]};ca.campaign_thief_03=
{nameTextId:"CAMPAIGN_NAME_THIEF_3",descriptionTextId:"CAMPAIGN_DESCRIPTION_THIEF_3",level:9,flag:"thief",maxResourceBonusList:WarBalance.campaign_thief_03.maxResourceBonusList,maxXpBonus:WarBalance.campaign_thief_03.maxXpBonus,campaignStarterArchetype:"a_cs_thief",battleList:WarBalance.campaign_thief_03.battleList,trickleList:WarBalance.campaign_thief_03.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},
{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_thief_04={nameTextId:"CAMPAIGN_NAME_THIEF_4",descriptionTextId:"CAMPAIGN_DESCRIPTION_THIEF_4",level:10,flag:"thief",maxResourceBonusList:WarBalance.campaign_thief_04.maxResourceBonusList,maxXpBonus:WarBalance.campaign_thief_04.maxXpBonus,campaignStarterArchetype:"a_cs_thief",battleList:WarBalance.campaign_thief_04.battleList,trickleList:WarBalance.campaign_thief_04.trickleList,starCriteriaList:[{name:"hqHealthFactor",
minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};e.archetypes.a_wm_battle_thief_01={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:0,families:[{familyName:"bannerlingThief",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"basicMelee",min:4,max:4}]},{postThresholdDelay:3,families:[{familyName:"thief",min:8,max:8}]},{enemyThreshold:0,
postThresholdDelay:0,families:[{familyName:"bombThrower",min:4,max:4}]},{postThresholdDelay:3,families:[{familyName:"thief",min:8,max:8}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:4,max:4}]},{postThresholdDelay:3,families:[{familyName:"thief",min:8,max:8}]}]}};e.archetypes.a_wm_battle_thief_02={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:0,families:[{familyName:"bannerlingThief",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"basicMelee",
min:6,max:6}]},{postThresholdDelay:3,families:[{familyName:"thief",min:10,max:10}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bombThrower",min:6,max:6}]},{postThresholdDelay:3,families:[{familyName:"thief",min:10,max:10}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:6,max:6}]},{postThresholdDelay:3,families:[{familyName:"thief",min:10,max:10}]}]}};e.archetypes.a_wm_battle_thief_03={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,
postThresholdDelay:10,families:[{familyName:"basicMelee",min:4,max:4}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"charger",min:1,max:1}]},{postThresholdDelay:3,families:[{familyName:"thief",min:14,max:14}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:2,max:2}]},{postThresholdDelay:8,families:[{familyName:"thief",min:15,max:15}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"chargerBoss",min:1,max:1}]},{postThresholdDelay:3,families:[{familyName:"thief",
min:15,max:15}]}]}};e.archetypes.a_wm_battle_thief_04={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"basicMelee",min:6,max:6}]},{postThresholdDelay:3,families:[{familyName:"thief",min:10,max:10}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bombThrower",min:6,max:6}]},{postThresholdDelay:3,families:[{familyName:"thief",min:10,max:10}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:6,max:6}]},
{postThresholdDelay:3,families:[{familyName:"thief",min:10,max:10}]},{enemyThreshold:0,postThresholdDelay:15,families:[{familyName:"basicMelee",min:4,max:4}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"charger",min:1,max:1}]},{postThresholdDelay:3,families:[{familyName:"thief",min:14,max:14}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:2,max:2}]},{postThresholdDelay:8,families:[{familyName:"thief",min:15,max:15}]},{enemyThreshold:0,postThresholdDelay:0,
families:[{familyName:"chargerBoss",min:1,max:1}]},{postThresholdDelay:3,families:[{familyName:"thief",min:15,max:15}]}]}};ca.campaign_charger_01={nameTextId:"CAMPAIGN_NAME_CHARGER_1",descriptionTextId:"CAMPAIGN_DESCRIPTION_CHARGER_1",level:7,flag:"charger",maxResourceBonusList:WarBalance.campaign_charger_01.maxResourceBonusList,maxXpBonus:WarBalance.campaign_charger_01.maxXpBonus,campaignStarterArchetype:"a_cs_charger",battleList:WarBalance.campaign_charger_01.battleList,trickleList:WarBalance.campaign_charger_01.trickleList,
starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_charger_02={nameTextId:"CAMPAIGN_NAME_CHARGER_2",descriptionTextId:"CAMPAIGN_DESCRIPTION_CHARGER_2",level:8,flag:"charger",maxResourceBonusList:WarBalance.campaign_charger_02.maxResourceBonusList,maxXpBonus:WarBalance.campaign_charger_02.maxXpBonus,campaignStarterArchetype:"a_cs_charger",
battleList:WarBalance.campaign_charger_02.battleList,trickleList:WarBalance.campaign_charger_02.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_charger_03={nameTextId:"CAMPAIGN_NAME_CHARGER_3",descriptionTextId:"CAMPAIGN_DESCRIPTION_CHARGER_3",level:9,flag:"charger",maxResourceBonusList:WarBalance.campaign_charger_03.maxResourceBonusList,
maxXpBonus:WarBalance.campaign_charger_03.maxXpBonus,campaignStarterArchetype:"a_cs_charger",battleList:WarBalance.campaign_charger_03.battleList,trickleList:WarBalance.campaign_charger_03.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_charger_04={nameTextId:"CAMPAIGN_NAME_CHARGER_4",descriptionTextId:"CAMPAIGN_DESCRIPTION_CHARGER_4",
level:10,flag:"charger",maxResourceBonusList:WarBalance.campaign_charger_04.maxResourceBonusList,maxXpBonus:WarBalance.campaign_charger_04.maxXpBonus,campaignStarterArchetype:"a_cs_charger",battleList:WarBalance.campaign_charger_04.battleList,trickleList:WarBalance.campaign_charger_04.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};
e.archetypes.a_wm_battle_charger_01={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bannerling",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"charger",min:1,max:1},{familyName:"charger",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"charger",min:1,max:1},{familyName:"charger",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,
postThresholdDelay:0,families:[{familyName:"ranged",min:3,max:3}]},{postThresholdDelay:3,families:[{familyName:"basicMelee",min:2,max:2},{familyName:"charger",min:4,max:4}]},{postThresholdDelay:6,families:[{familyName:"charger",min:1,max:1}]},{postThresholdDelay:9,families:[{familyName:"basicMelee",min:2,max:2}]}]}};e.archetypes.a_wm_battle_charger_02={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bannerlingCharger",min:1,max:1}]},{enemyThreshold:0,
postThresholdDelay:0,families:[{familyName:"basicMelee",min:4,max:4},{familyName:"miniCharger",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"charger",min:1,max:1}]},{postThresholdDelay:9,families:[{familyName:"basicMelee",min:4,max:4}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:4,max:4},{familyName:"miniCharger",min:2,max:2}]},{postThresholdDelay:1,families:[{familyName:"basicMelee",min:4,max:4}]},{postThresholdDelay:6,families:[{familyName:"charger",
min:1,max:1}]},{postThresholdDelay:9,families:[{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:4,max:4}]},{postThresholdDelay:2,families:[{familyName:"basicMelee",min:4,max:4},{familyName:"miniCharger",min:2,max:2}]},{postThresholdDelay:4,families:[{familyName:"charger",min:1,max:1}]},{postThresholdDelay:10,families:[{familyName:"charger",min:2,max:2}]}]}};e.archetypes.a_wm_battle_charger_03={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,
postThresholdDelay:10,families:[{familyName:"bombThrower",min:3,max:3},{familyName:"miniCharger",min:2,max:2}]},{postThresholdDelay:6,families:[{familyName:"charger",min:1,max:1}]},{postThresholdDelay:2,families:[{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bombThrower",min:3,max:3},{familyName:"miniCharger",min:2,max:2}]},{postThresholdDelay:1,families:[{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:6,families:[{familyName:"charger",
min:2,max:2}]},{postThresholdDelay:9,families:[{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:1,max:1},{familyName:"miniCharger",min:3,max:3}]},{postThresholdDelay:2,families:[{familyName:"basicMelee",min:4,max:4}]},{postThresholdDelay:4,families:[{familyName:"charger",min:2,max:2}]},{postThresholdDelay:9,families:[{familyName:"chargerBoss",min:1,max:1}]}]}};e.archetypes.a_wm_battle_charger_04={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,
postThresholdDelay:10,families:[{familyName:"basicMelee",min:4,max:4},{familyName:"miniCharger",min:2,max:2}]},{postThresholdDelay:3,families:[{familyName:"charger",min:1,max:1}]},{postThresholdDelay:9,families:[{familyName:"basicMelee",min:4,max:4}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:4,max:4},{familyName:"miniCharger",min:2,max:2}]},{postThresholdDelay:1,families:[{familyName:"basicMelee",min:4,max:4}]},{postThresholdDelay:6,families:[{familyName:"charger",
min:1,max:1}]},{postThresholdDelay:9,families:[{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:4,max:4}]},{postThresholdDelay:2,families:[{familyName:"basicMelee",min:4,max:4},{familyName:"miniCharger",min:2,max:2}]},{postThresholdDelay:4,families:[{familyName:"charger",min:1,max:1}]},{postThresholdDelay:10,families:[{familyName:"charger",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:15,families:[{familyName:"bombThrower",min:3,
max:3},{familyName:"miniCharger",min:2,max:2}]},{postThresholdDelay:6,families:[{familyName:"charger",min:1,max:1}]},{postThresholdDelay:2,families:[{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bombThrower",min:3,max:3},{familyName:"miniCharger",min:2,max:2}]},{postThresholdDelay:1,families:[{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:6,families:[{familyName:"charger",min:2,max:2}]},{postThresholdDelay:9,families:[{familyName:"basicMelee",
min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:1,max:1},{familyName:"miniCharger",min:3,max:3}]},{postThresholdDelay:2,families:[{familyName:"basicMelee",min:4,max:4}]},{postThresholdDelay:4,families:[{familyName:"charger",min:2,max:2}]},{postThresholdDelay:9,families:[{familyName:"chargerBoss",min:1,max:1}]}]}};ca.campaign_treasure_01={nameTextId:"CAMPAIGN_NAME_TREASURE_1",descriptionTextId:"CAMPAIGN_DESCRIPTION_TREASURE_1",level:7,flag:"treasure",maxResourceBonusList:WarBalance.campaign_treasure_01.maxResourceBonusList,
maxXpBonus:WarBalance.campaign_treasure_01.maxXpBonus,campaignStarterArchetype:"a_cs_treasure",battleList:WarBalance.campaign_treasure_01.battleList,trickleList:WarBalance.campaign_treasure_01.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:40}]};ca.campaign_treasure_02={nameTextId:"CAMPAIGN_NAME_TREASURE_2",descriptionTextId:"CAMPAIGN_DESCRIPTION_TREASURE_2",
level:8,flag:"treasure",maxResourceBonusList:WarBalance.campaign_treasure_02.maxResourceBonusList,maxXpBonus:WarBalance.campaign_treasure_02.maxXpBonus,campaignStarterArchetype:"a_cs_treasure",battleList:WarBalance.campaign_treasure_02.battleList,trickleList:WarBalance.campaign_treasure_02.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:40}]};
ca.campaign_treasure_03={nameTextId:"CAMPAIGN_NAME_TREASURE_3",descriptionTextId:"CAMPAIGN_DESCRIPTION_TREASURE_3",level:9,flag:"treasure",maxResourceBonusList:WarBalance.campaign_treasure_03.maxResourceBonusList,maxXpBonus:WarBalance.campaign_treasure_03.maxXpBonus,campaignStarterArchetype:"a_cs_treasure",battleList:WarBalance.campaign_treasure_03.battleList,trickleList:WarBalance.campaign_treasure_03.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",
maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_treasure_04={nameTextId:"CAMPAIGN_NAME_TREASURE_4",descriptionTextId:"CAMPAIGN_DESCRIPTION_TREASURE_4",level:10,flag:"treasure",maxResourceBonusList:WarBalance.campaign_treasure_04.maxResourceBonusList,maxXpBonus:WarBalance.campaign_treasure_04.maxXpBonus,campaignStarterArchetype:"a_cs_treasure",battleList:WarBalance.campaign_treasure_04.battleList,trickleList:WarBalance.campaign_treasure_04.trickleList,
starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};e.archetypes.a_wm_battle_treasure_01={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:0,families:[{familyName:"bannerlingTreasureDropper",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"basicMelee",min:4,max:4},{familyName:"treasureDropper",
min:1,max:1}]},{postThresholdDelay:3,families:[{familyName:"thief",min:8,max:8}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bombThrower",min:4,max:4}]},{postThresholdDelay:3,families:[{familyName:"thief",min:8,max:8}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:4,max:4}]},{postThresholdDelay:3,families:[{familyName:"thief",min:8,max:8},{familyName:"treasureDropper",min:1,max:1}]}]}};e.archetypes.a_wm_battle_treasure_02={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:0,
families:[{familyName:"bannerlingTreasureDropper",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"basicMelee",min:6,max:6},{familyName:"treasureDropper",min:1,max:1}]},{postThresholdDelay:3,families:[{familyName:"thief",min:10,max:10}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bombThrower",min:6,max:6}]},{postThresholdDelay:3,families:[{familyName:"thief",min:10,max:10}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:6,
max:6}]},{postThresholdDelay:3,families:[{familyName:"thief",min:10,max:10},{familyName:"treasureDropper",min:1,max:1}]}]}};e.archetypes.a_wm_battle_treasure_03={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"basicMelee",min:4,max:4},{familyName:"treasureDropper",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"charger",min:1,max:1}]},{postThresholdDelay:3,families:[{familyName:"thief",min:14,max:14}]},{enemyThreshold:0,
postThresholdDelay:0,families:[{familyName:"berserker",min:2,max:2}]},{postThresholdDelay:8,families:[{familyName:"thief",min:15,max:15},{familyName:"treasureDropper",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"chargerBoss",min:1,max:1}]},{postThresholdDelay:3,families:[{familyName:"thief",min:15,max:15}]}]}};e.archetypes.a_wm_battle_treasure_04={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"basicMelee",
min:6,max:6},{familyName:"treasureDropper",min:1,max:1}]},{postThresholdDelay:3,families:[{familyName:"thief",min:10,max:10}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bombThrower",min:6,max:6}]},{postThresholdDelay:3,families:[{familyName:"thief",min:10,max:10}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:6,max:6}]},{postThresholdDelay:3,families:[{familyName:"thief",min:10,max:10},{familyName:"treasureDropper",min:1,max:1}]},{enemyThreshold:0,
postThresholdDelay:15,families:[{familyName:"basicMelee",min:4,max:4},{familyName:"treasureDropper",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"charger",min:1,max:1}]},{postThresholdDelay:3,families:[{familyName:"thief",min:14,max:14}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:2,max:2}]},{postThresholdDelay:8,families:[{familyName:"thief",min:15,max:15},{familyName:"treasureDropper",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,
families:[{familyName:"chargerBoss",min:1,max:1}]},{postThresholdDelay:3,families:[{familyName:"thief",min:15,max:15}]}]}};ca.campaign_commando_01={nameTextId:"CAMPAIGN_NAME_COMMANDO_1",descriptionTextId:"CAMPAIGN_DESCRIPTION_COMMANDO_1",level:7,flag:"commando",maxResourceBonusList:WarBalance.campaign_commando_01.maxResourceBonusList,maxXpBonus:WarBalance.campaign_commando_01.maxXpBonus,campaignStarterArchetype:"a_cs_commando",battleList:WarBalance.campaign_commando_01.battleList,trickleList:WarBalance.campaign_commando_01.trickleList,
starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:40}]};ca.campaign_commando_02={nameTextId:"CAMPAIGN_NAME_COMMANDO_2",descriptionTextId:"CAMPAIGN_DESCRIPTION_COMMANDO_2",level:8,flag:"commando",maxResourceBonusList:WarBalance.campaign_commando_02.maxResourceBonusList,maxXpBonus:WarBalance.campaign_commando_02.maxXpBonus,campaignStarterArchetype:"a_cs_commando",
battleList:WarBalance.campaign_commando_02.battleList,trickleList:WarBalance.campaign_commando_02.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:40}]};ca.campaign_commando_03={nameTextId:"CAMPAIGN_NAME_COMMANDO_3",descriptionTextId:"CAMPAIGN_DESCRIPTION_COMMANDO_3",level:9,flag:"commando",maxResourceBonusList:WarBalance.campaign_commando_03.maxResourceBonusList,
maxXpBonus:WarBalance.campaign_commando_03.maxXpBonus,campaignStarterArchetype:"a_cs_commando",battleList:WarBalance.campaign_commando_03.battleList,trickleList:WarBalance.campaign_commando_03.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_commando_04={nameTextId:"CAMPAIGN_NAME_COMMANDO_4",descriptionTextId:"CAMPAIGN_DESCRIPTION_COMMANDO_4",
level:10,flag:"commando",maxResourceBonusList:WarBalance.campaign_commando_04.maxResourceBonusList,maxXpBonus:WarBalance.campaign_commando_04.maxXpBonus,campaignStarterArchetype:"a_cs_commando",battleList:WarBalance.campaign_commando_04.battleList,trickleList:WarBalance.campaign_commando_04.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};
e.archetypes.a_wm_battle_commando_01={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:0,families:[{familyName:"bannerlingCommando",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"basicMelee",min:4,max:4}]},{postThresholdDelay:3,families:[{familyName:"commando",min:4,max:4}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bombThrower",min:4,max:4}]},{postThresholdDelay:3,families:[{familyName:"commando",min:4,max:4}]},{enemyThreshold:0,
postThresholdDelay:0,families:[{familyName:"ranged",min:4,max:4}]},{postThresholdDelay:3,families:[{familyName:"commando",min:4,max:4}]}]}};e.archetypes.a_wm_battle_commando_02={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:0,families:[{familyName:"bannerlingCommando",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"basicMelee",min:6,max:6}]},{postThresholdDelay:3,families:[{familyName:"commando",min:5,max:5}]},{enemyThreshold:0,postThresholdDelay:0,
families:[{familyName:"bombThrower",min:6,max:6}]},{postThresholdDelay:3,families:[{familyName:"commando",min:5,max:5}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:6,max:6}]},{postThresholdDelay:3,families:[{familyName:"commando",min:5,max:5}]}]}};e.archetypes.a_wm_battle_commando_03={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"basicMelee",min:2,max:2},{familyName:"commando",min:4,max:4}]},{enemyThreshold:0,
postThresholdDelay:0,families:[{familyName:"charger",min:1,max:1}]},{postThresholdDelay:3,families:[{familyName:"commando",min:8,max:8}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:2,max:2}]},{postThresholdDelay:8,families:[{familyName:"commando",min:8,max:8}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"chargerBoss",min:1,max:1}]},{postThresholdDelay:3,families:[{familyName:"commando",min:8,max:8}]}]}};e.archetypes.a_wm_battle_commando_04={shouldPlayerSave:!1,
ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"basicMelee",min:6,max:6}]},{postThresholdDelay:3,families:[{familyName:"commando",min:5,max:5}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bombThrower",min:6,max:6}]},{postThresholdDelay:3,families:[{familyName:"commando",min:5,max:5}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:6,max:6}]},{postThresholdDelay:3,families:[{familyName:"commando",min:5,max:5}]},
{enemyThreshold:0,postThresholdDelay:15,families:[{familyName:"basicMelee",min:2,max:2},{familyName:"commando",min:4,max:4}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"charger",min:1,max:1}]},{postThresholdDelay:3,families:[{familyName:"commando",min:8,max:8}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:2,max:2}]},{postThresholdDelay:8,families:[{familyName:"commando",min:8,max:8}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"chargerBoss",
min:1,max:1}]},{postThresholdDelay:3,families:[{familyName:"commando",min:8,max:8}]}]}};ca.campaign_death_01={nameTextId:"CAMPAIGN_NAME_DEATH_1",descriptionTextId:"CAMPAIGN_DESCRIPTION_DEATH_1",level:4,flag:"death",maxResourceBonusList:WarBalance.campaign_death_01.maxResourceBonusList,maxXpBonus:WarBalance.campaign_death_01.maxXpBonus,campaignStarterArchetype:"a_cs_death",battleList:WarBalance.campaign_death_01.battleList,trickleList:WarBalance.campaign_death_01.trickleList,starCriteriaList:[{name:"hqHealthFactor",
minHealthFactorForSuccess:0.95},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:1},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:40}]};ca.campaign_death_02={nameTextId:"CAMPAIGN_NAME_DEATH_2",descriptionTextId:"CAMPAIGN_DESCRIPTION_DEATH_2",level:7,flag:"death",maxResourceBonusList:WarBalance.campaign_death_02.maxResourceBonusList,maxXpBonus:WarBalance.campaign_death_02.maxXpBonus,campaignStarterArchetype:"a_cs_death",battleList:WarBalance.campaign_death_02.battleList,
trickleList:WarBalance.campaign_death_02.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.9},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_death_03={nameTextId:"CAMPAIGN_NAME_DEATH_3",descriptionTextId:"CAMPAIGN_DESCRIPTION_DEATH_3",level:8,flag:"death",maxResourceBonusList:WarBalance.campaign_death_03.maxResourceBonusList,maxXpBonus:WarBalance.campaign_death_03.maxXpBonus,
campaignStarterArchetype:"a_cs_death",battleList:WarBalance.campaign_death_03.battleList,trickleList:WarBalance.campaign_death_03.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_death_04={nameTextId:"CAMPAIGN_NAME_DEATH_4",descriptionTextId:"CAMPAIGN_DESCRIPTION_DEATH_4",level:9,flag:"death",maxResourceBonusList:WarBalance.campaign_death_04.maxResourceBonusList,
maxXpBonus:WarBalance.campaign_death_04.maxXpBonus,campaignStarterArchetype:"a_cs_death",battleList:WarBalance.campaign_death_04.battleList,trickleList:WarBalance.campaign_death_04.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};ca.campaign_death_05={nameTextId:"CAMPAIGN_NAME_DEATH_5",descriptionTextId:"CAMPAIGN_DESCRIPTION_DEATH_5",
level:10,flag:"death",maxResourceBonusList:WarBalance.campaign_death_05.maxResourceBonusList,maxXpBonus:WarBalance.campaign_death_05.maxXpBonus,campaignStarterArchetype:"a_cs_death",battleList:WarBalance.campaign_death_05.battleList,trickleList:WarBalance.campaign_death_05.trickleList,starCriteriaList:[{name:"hqHealthFactor",minHealthFactorForSuccess:0.8},{name:"fewerThanNHeroDeaths",maxNumberOfDeathsAllowedForSuccess:2},{name:"killNEnemiesWithHero",minNumberOfFeralsKilledByHeroForSuccess:30}]};e.archetypes.a_wm_battle_death_01=
{shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:0,postThresholdDelay:7,families:[{familyName:"bombThrower",min:1,max:1},{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:1,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:0,
postThresholdDelay:10,families:[{familyName:"death",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:14,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"berserker",min:0,max:1}]},{enemyThreshold:2,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]},{enemyThreshold:3,postThresholdDelay:7,families:[{familyName:"bombThrower",min:2,max:2},{familyName:"basicMelee",
min:3,max:3}]},{postThresholdDelay:0,families:[{familyName:"treasureDropper",min:0,max:1}]},{enemyThreshold:4,postThresholdDelay:7,families:[{familyName:"ranged",min:2,max:2},{familyName:"basicMelee",min:3,max:3}]}]}};e.archetypes.a_wm_battle_death_02={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"bannerling",min:1,max:1}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"basicMelee",min:6,max:6}]},{enemyThreshold:3,postThresholdDelay:0,
families:[{familyName:"ranged",min:4,max:4}]},{postThresholdDelay:6,families:[{familyName:"death",min:1,max:1}]},{postThresholdDelay:9,families:[{familyName:"basicMelee",min:4,max:4}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:6,max:6}]},{postThresholdDelay:3,families:[{familyName:"bombThrower",min:4,max:4}]},{postThresholdDelay:6,families:[{familyName:"death",min:1,max:1}]},{postThresholdDelay:9,families:[{familyName:"bombThrower",min:2,max:2}]},{enemyThreshold:0,
postThresholdDelay:0,families:[{familyName:"basicMelee",min:4,max:4}]},{postThresholdDelay:6,families:[{familyName:"basicMelee",min:4,max:4}]},{postThresholdDelay:9,families:[{familyName:"death",min:2,max:2}]},{postThresholdDelay:12,families:[{familyName:"bombThrower",min:2,max:2}]}]}};e.archetypes.a_wm_battle_death_03={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:4,max:4}]},{postThresholdDelay:3,families:[{familyName:"basicMelee",
min:6,max:6}]},{postThresholdDelay:3,families:[{familyName:"death",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:2,max:2}]},{postThresholdDelay:1,families:[{familyName:"death",min:1,max:1}]},{postThresholdDelay:8,families:[{familyName:"basicMelee",min:6,max:6}]},{postThresholdDelay:10,families:[{familyName:"death",min:2,max:2}]},{postThresholdDelay:16,families:[{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",
min:4,max:4}]},{postThresholdDelay:0,families:[{familyName:"death",min:3,max:3}]},{postThresholdDelay:8,families:[{familyName:"thief",min:6,max:6}]},{postThresholdDelay:10,families:[{familyName:"death",min:1,max:1}]},{postThresholdDelay:10,families:[{familyName:"chargerBoss",min:1,max:1}]}]}};e.archetypes.a_wm_battle_death_04={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"basicMelee",min:6,max:6}]},{enemyThreshold:3,postThresholdDelay:0,
families:[{familyName:"ranged",min:4,max:4}]},{postThresholdDelay:6,families:[{familyName:"death",min:1,max:1}]},{postThresholdDelay:9,families:[{familyName:"basicMelee",min:4,max:4}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"ranged",min:6,max:6}]},{postThresholdDelay:3,families:[{familyName:"bombThrower",min:4,max:4}]},{postThresholdDelay:6,families:[{familyName:"death",min:1,max:1}]},{postThresholdDelay:9,families:[{familyName:"bombThrower",min:2,max:2}]},{enemyThreshold:0,
postThresholdDelay:0,families:[{familyName:"basicMelee",min:4,max:4}]},{postThresholdDelay:6,families:[{familyName:"basicMelee",min:4,max:4}]},{postThresholdDelay:9,families:[{familyName:"death",min:2,max:2}]},{postThresholdDelay:12,families:[{familyName:"bombThrower",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:10,families:[{familyName:"ranged",min:4,max:4}]},{postThresholdDelay:3,families:[{familyName:"basicMelee",min:6,max:6}]},{postThresholdDelay:3,families:[{familyName:"death",min:2,max:2}]},
{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:2,max:2}]},{postThresholdDelay:1,families:[{familyName:"death",min:1,max:1}]},{postThresholdDelay:8,families:[{familyName:"basicMelee",min:6,max:6}]},{postThresholdDelay:10,families:[{familyName:"death",min:2,max:2}]},{postThresholdDelay:16,families:[{familyName:"basicMelee",min:2,max:2}]},{enemyThreshold:0,postThresholdDelay:0,families:[{familyName:"berserker",min:4,max:4}]},{postThresholdDelay:0,families:[{familyName:"death",
min:3,max:3}]},{postThresholdDelay:8,families:[{familyName:"thief",min:6,max:6}]},{postThresholdDelay:10,families:[{familyName:"death",min:1,max:1}]},{postThresholdDelay:10,families:[{familyName:"chargerBoss",min:1,max:1}]}]}};e.archetypes.a_wm_trickle_tutorial_01={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{enemyThreshold:10,postThresholdDelay:8,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:8,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,
postThresholdDelay:7,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:7,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:6,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:6,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:5,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:5,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,
postThresholdDelay:4,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:4,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:3,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:3,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,
postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,
postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]}]}};e.archetypes.a_wm_trickle_commando_01={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:3,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:8,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:7,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,
postThresholdDelay:7,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:6,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:6,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:5,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:5,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:4,families:[{familyName:"commando",min:1,max:1}]},
{enemyThreshold:5,postThresholdDelay:4,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:3,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:3,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:1}]}]}};e.archetypes.a_wm_trickle_commando_02={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:3,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:8,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:7,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:7,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:6,families:[{familyName:"commando",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:6,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:5,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:5,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:4,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:4,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:3,families:[{familyName:"commando",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:3,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:6,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:7,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:8,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:9,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"commando",min:1,max:2}]}]}};e.archetypes.a_wm_trickle_thief_01={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:3,families:[{familyName:"thief",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:8,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:7,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:7,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:6,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:6,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:5,families:[{familyName:"thief",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:5,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:4,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:4,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:3,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:3,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]}]}};e.archetypes.a_wm_trickle_thief_02={shouldPlayerSave:!1,ECAttackWavesManager:{waves:[{postThresholdDelay:3,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:8,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:7,families:[{familyName:"thief",min:1,max:1}]},
{enemyThreshold:5,postThresholdDelay:7,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:6,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:6,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:5,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:5,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:4,families:[{familyName:"thief",min:1,max:1}]},
{enemyThreshold:5,postThresholdDelay:4,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:3,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:3,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:5,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:6,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:7,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},
{enemyThreshold:8,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:9,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:1}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},
{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,
max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",min:1,max:2}]},{enemyThreshold:10,postThresholdDelay:2,families:[{familyName:"thief",
min:1,max:2}]}]}};Gb.keyframes={dawn:{ambient:{r:118,g:94,b:7,intensity:0.3},worldLight1:{r:181,g:96,b:0,pitch:-1.064,yaw:-2.373,intensity:0.7},worldLight2:{r:3,g:157,b:254,pitch:-0.226,yaw:0.122,intensity:0.2},heroLight:{r:128,g:96,b:0,intensity:1,radius:6}},midday:{ambient:{r:255,g:255,b:190,intensity:0.15},worldLight1:{r:254,g:255,b:165,pitch:-1.064,yaw:-2.373,intensity:0.4},worldLight2:{r:1,g:211,b:255,pitch:-0.226,yaw:0.122,intensity:0.2},heroLight:{r:128,g:96,b:0,intensity:0,radius:6}},dusk:{ambient:{r:201,
g:185,b:157,intensity:0.2},worldLight1:{r:118,g:44,b:114,pitch:-1.064,yaw:-2.373,intensity:1},worldLight2:{r:1,g:211,b:179,pitch:-0.226,yaw:0.122,intensity:0.1},heroLight:{r:128,g:96,b:0,intensity:1,radius:6}},midnight:{ambient:{r:17,g:37,b:74,intensity:0.6},worldLight1:{r:13,g:15,b:39,pitch:-1.169,yaw:1.274,intensity:2.7},worldLight2:{r:1,g:25,b:72,pitch:3.124,yaw:0.872,intensity:0.9},heroLight:{r:155,g:96,b:0,intensity:1,radius:6}}};Gb.dayNightKeyframes=[{hour:0,keyframe:"midnight"},{hour:3,keyframe:"midnight"},
{hour:4,keyframe:"dawn"},{hour:5,keyframe:"midday"},{hour:16,keyframe:"midday"},{hour:20,keyframe:"dusk"},{hour:21,keyframe:"midnight"},{hour:24,keyframe:"midnight"}];e.archetypes.l_torch={};e.archetypes.l_wallTorch={ECLight:{colour:[2,1.5,1.5],radius:6,flicker:0,wobble:0,dynamic:!1,shadows:!1}};e.archetypes.l_wallTorchFlickering={ECLight:{colour:[2,1.5,1.5],radius:6,flicker:6,wobble:5,dynamic:!1,shadows:!1}};e.archetypes.l_roomBig={ECLight:{colour:[1,1,1],radius:9,flicker:0,wobble:0,dynamic:!1,shadows:!1}};
e.archetypes.l_roomHuge={};M.archetypes.footStep={random:!0,sounds:[{path:"sounds/Footsteps/grass_step_1.ogg",loop:!1,volume:0.08},{path:"sounds/Footsteps/grass_step_2.ogg",loop:!1,volume:0.08},{path:"sounds/Footsteps/grass_step_3.ogg",loop:!1,volume:0.08},{path:"sounds/Footsteps/grass_step_4.ogg",loop:!1,volume:0.08},{path:"sounds/Footsteps/grass_step_5.ogg",loop:!1,volume:0.08}]};M.archetypes.uiDown={path:"sounds/NFF-switch-on.ogg",loop:!1,volume:0.5};M.archetypes.uiUp={path:"sounds/NFF-switch-off.ogg",
loop:!1,volume:0.5};M.archetypes.uiSelect={path:"sounds/NFF-menu-08-a.ogg",loop:!1,volume:0.5};M.archetypes.uiDeselect={path:"sounds/NFF-menu-08-b.ogg",loop:!1,volume:0.5};M.archetypes.imguiDown={path:"sounds/gui_click.ogg",loop:!1,volume:0.8,camera:!0};M.archetypes.imguiUp={path:"sounds/gui_click.ogg",loop:!1,volume:0,camera:!0};M.archetypes.imguiSelect={path:"sounds/gui_over.ogg",loop:!1,volume:0.4};M.archetypes.imguiDeselect={path:"sounds/gui_click.ogg",loop:!1,volume:0};M.archetypes.healStart=
{path:"sounds/spawn.ogg",loop:!1,volume:0};M.archetypes.healEnd={path:"sounds/gui_click.ogg",loop:!1,volume:0};M.archetypes.speechExclaim={path:"sounds/wildling-squeak.ogg",loop:!1,volume:1};M.archetypes.speechWelcomeBack={path:"sounds/wildling-squeak.ogg",loop:!1,volume:1};M.archetypes.buildingPickup={path:"sounds/building-pickup.ogg",loop:!1,volume:0.5};M.archetypes.buildingReady={path:"sounds/place-building.ogg",loop:!1,volume:0.5};M.archetypes.buildingPlace={path:"sounds/heavy_building.ogg",loop:!1,
volume:0.5};M.archetypes.buildingCancel={path:"sounds/bubble_negative.ogg",loop:!1,volume:0.4};M.archetypes.pickupWood={path:"sounds/pop.ogg",loop:!1,volume:0.7};M.archetypes.pickupStone={path:"sounds/pop.ogg",loop:!1,volume:0.7};M.archetypes.pickupSoftCurrency={path:"sounds/amber-pickup.ogg",loop:!1,volume:0.9};M.archetypes.depositWoodStart={random:!0,sounds:[{path:"sounds/bubble_negative.ogg",loop:!1,volume:0.3,delayedLoad:!0},{path:"sounds/bubble_positive.ogg",loop:!1,volume:0.3,delayedLoad:!0}]};
M.archetypes.depositStoneStart={random:!0,sounds:[{path:"sounds/bubble_negative.ogg",loop:!1,volume:0.3,delayedLoad:!0},{path:"sounds/bubble_positive.ogg",loop:!1,volume:0.3,delayedLoad:!0}]};M.archetypes.depositWoodEnd={random:!0,sounds:[{path:"sounds/chop_1.ogg",loop:!1,volume:0.5,delayedLoad:!0},{path:"sounds/chop_3.ogg",loop:!1,volume:0.5,delayedLoad:!0},{path:"sounds/chop_4.ogg",loop:!1,volume:0.5,delayedLoad:!0},{path:"sounds/chop_5.ogg",loop:!1,volume:0.5,delayedLoad:!0},{path:"sounds/chop_6.ogg",
loop:!1,volume:0.5,delayedLoad:!0}]};M.archetypes.depositStoneEnd={random:!0,sounds:[{path:"sounds/chip_1.ogg",loop:!1,volume:0.5,delayedLoad:!0},{path:"sounds/chip_2.ogg",loop:!1,volume:0.5,delayedLoad:!0},{path:"sounds/chip_3.ogg",loop:!1,volume:0.5,delayedLoad:!0}]};M.archetypes.scorePulse={path:"sounds/wave-approaching.ogg",loop:!1,volume:0.8,delayedLoad:!0};M.archetypes.bubbleNegative={random:!0,sounds:[{path:"sounds/pop.ogg",loop:!1,volume:0.5}]};M.archetypes.bubblePositive={path:"sounds/pop.ogg",
loop:!1,volume:0.5};M.archetypes.chop={random:!0,sounds:[{path:"sounds/chop_1.ogg",loop:!1,volume:0.9,delayedLoad:!0},{path:"sounds/chop_2.ogg",loop:!1,volume:0.9,delayedLoad:!0},{path:"sounds/chop_3.ogg",loop:!1,volume:0.9,delayedLoad:!0},{path:"sounds/chop_4.ogg",loop:!1,volume:0.9,delayedLoad:!0},{path:"sounds/chop_5.ogg",loop:!1,volume:0.9,delayedLoad:!0},{path:"sounds/chop_6.ogg",loop:!1,volume:0.9,delayedLoad:!0}]};M.archetypes.mine={random:!0,sounds:[{path:"sounds/chip_1.ogg",loop:!1,volume:0.9,
delayedLoad:!0},{path:"sounds/chip_2.ogg",loop:!1,volume:0.9,delayedLoad:!0},{path:"sounds/chip_3.ogg",loop:!1,volume:0.9,delayedLoad:!0}]};M.archetypes.combatWaveApproaching={path:"sounds/wave-approaching.ogg",loop:!1,volume:0.8,delayedLoad:!0};M.archetypes.pistolcock={path:"sounds/arrowcock.ogg",loop:!1,volume:0.75,delayedLoad:!0};M.archetypes.pistolreload={path:"sounds/arrowreload.ogg",loop:!1,volume:0,delayedLoad:!0};M.archetypes.pistoldryfire={path:"sounds/arrowdryfire.ogg",loop:!1,volume:0.01,
delayedLoad:!0};M.archetypes.pistolshot={random:!0,sounds:[{path:"sounds/pistolshot1.ogg",loop:!1,volume:0.8,delayedLoad:!0},{path:"sounds/pistolshot2.ogg",loop:!1,volume:0.8,delayedLoad:!0},{path:"sounds/pistolshot3.ogg",loop:!1,volume:0.8,delayedLoad:!0},{path:"sounds/pistolshot4.ogg",loop:!1,volume:0.8,delayedLoad:!0}]};M.archetypes.arrowshot={random:!0,sounds:[{path:"sounds/arrowshot1.ogg",loop:!1,volume:0.75},{path:"sounds/arrowshot2.ogg",loop:!1,volume:0.75},{path:"sounds/arrowshot3.ogg",loop:!1,
volume:0.75},{path:"sounds/arrowshot4.ogg",loop:!1,volume:0.75}]};M.archetypes.punch={random:!0,sounds:[{path:"sounds/Punch_01.ogg",loop:!1,volume:0.75,delayedLoad:!0},{path:"sounds/Punch_02.ogg",loop:!1,volume:0.75,delayedLoad:!0},{path:"sounds/Punch_03.ogg",loop:!1,volume:0.75,delayedLoad:!0},{path:"sounds/Punch_04.ogg",loop:!1,volume:0.75,delayedLoad:!0},{path:"sounds/Punch_05.ogg",loop:!1,volume:0.75,delayedLoad:!0},{path:"sounds/Punch_06.ogg",loop:!1,volume:0.75,delayedLoad:!0},{path:"sounds/Punch_07.ogg",
loop:!1,volume:0.75,delayedLoad:!0},{path:"sounds/Punch_08.ogg",loop:!1,volume:0.75,delayedLoad:!0},{path:"sounds/Punch_09.ogg",loop:!1,volume:0.75,delayedLoad:!0},{path:"sounds/Punch_10.ogg",loop:!1,volume:0.75,delayedLoad:!0},{path:"sounds/Punch_11.ogg",loop:!1,volume:0.75,delayedLoad:!0}]};M.archetypes.stomp={path:"sounds/SpecialMoveForcePush_01.ogg",loop:!1,volume:0.75,delayedLoad:!0};M.archetypes.chargeImpact={path:"sounds/LargeHit-01.ogg",loop:!1,volume:0.55,delayedLoad:!0};M.archetypes.explosion=
{path:"sounds/explosion.ogg",loop:!1,volume:0.85,delayedLoad:!0};M.archetypes.explosionBig={path:"sounds/explosion_big.ogg",loop:!1,volume:0.7,delayedLoad:!0};M.archetypes.explosionBarrel={path:"sounds/explosion_barrel.ogg",loop:!1,volume:0.8,delayedLoad:!0};M.archetypes.explosionMine={path:"sounds/explosion_mine.ogg",loop:!1,volume:0.8,delayedLoad:!0};M.archetypes.horn={path:"sounds/horn.ogg",loop:!1,volume:0.8,delayedLoad:!0};M.archetypes.mortar={random:!0,sounds:[{path:"sounds/mortar_1.ogg",loop:!1,
volume:0.7,delayedLoad:!0},{path:"sounds/mortar_2.ogg",loop:!1,volume:0.7,delayedLoad:!0}]};M.archetypes.thud={path:"sounds/thud.ogg",loop:!1,volume:0.125};M.archetypes.ouch={random:!0,sounds:[{path:"sounds/hurt_01.ogg",loop:!1,volume:0.75,delayedLoad:!0},{path:"sounds/hurt_02.ogg",loop:!1,volume:0.75,delayedLoad:!0},{path:"sounds/hurt_03.ogg",loop:!1,volume:0.75,delayedLoad:!0},{path:"sounds/hurt_04.ogg",loop:!1,volume:0.75,delayedLoad:!0}]};M.archetypes.battleEffort={random:!0,sounds:[{path:"sounds/effort_1.ogg",
loop:!1,volume:0.25,delayedLoad:!0},{path:"sounds/effort_2.ogg",loop:!1,volume:0.25,delayedLoad:!0},{path:"sounds/effort_3.ogg",loop:!1,volume:0.25,delayedLoad:!0}]};M.archetypes.roar={random:!0,sounds:[{path:"sounds/roar_wildling_1.ogg",loop:!1,volume:0.5,delayedLoad:!0},{path:"sounds/roar_wildling_2.ogg",loop:!1,volume:0.5,delayedLoad:!0},{path:"sounds/roar_wildling_noscream.ogg",loop:!1,volume:0.5,delayedLoad:!0},{path:"sounds/roar_wildling_2.ogg",loop:!1,volume:0.5,delayedLoad:!0},{path:"sounds/roar_wildling_noscream.ogg",
loop:!1,volume:0.5,delayedLoad:!0}]};M.archetypes.mini_wildling_roar={path:"sounds/mini_wildling_roar.ogg",loop:!1,volume:0.5,delayedLoad:!0};M.archetypes.dartFly={path:"sounds/dart_fly.ogg",loop:!1,volume:0.5,delayedLoad:!0};M.archetypes.dartHit={random:!0,sounds:[{path:"sounds/grassimpact1.ogg",loop:!1,volume:1,delayedLoad:!0},{path:"sounds/grassimpact2.ogg",loop:!1,volume:1,delayedLoad:!0},{path:"sounds/grassimpact3.ogg",loop:!1,volume:1,delayedLoad:!0}]};M.archetypes.spit={path:"sounds/spit.ogg",
loop:!1,volume:0.7,delayedLoad:!0};M.archetypes.dartHitFlesh={random:!0,sounds:[{path:"sounds/body_impact_1.ogg",loop:!1,volume:0.7,delayedLoad:!0},{path:"sounds/body_impact_2.ogg",loop:!1,volume:0.7,delayedLoad:!0},{path:"sounds/body_impact_3.ogg",loop:!1,volume:0.7,delayedLoad:!0}]};M.archetypes.dartHitFleshCharged={path:"sounds/dart_hit_flesh_charged.ogg",loop:!1,volume:0.9,delayedLoad:!0};M.archetypes.collectBig={random:!0,sounds:[{path:"sounds/pipe_1.ogg",loop:!1,volume:0.3,delayedLoad:!0},{path:"sounds/pipe_2.ogg",
loop:!1,volume:0.3,delayedLoad:!0},{path:"sounds/pipe_3.ogg",loop:!1,volume:0.3,delayedLoad:!0},{path:"sounds/pipe_4.ogg",loop:!1,volume:0.3,delayedLoad:!0}]};M.archetypes.spawnHero={path:"sounds/spawn.ogg",loop:!1,volume:1.3,delayedLoad:!0};M.archetypes.appear={path:"sounds/appear.ogg",loop:!1,volume:0.5,delayedLoad:!0};M.archetypes.wilhelm={path:"sounds/wilhelm_scream.ogg",loop:!1,volume:0.75,delayedLoad:!0};M.archetypes.openDoor={path:"sounds/door_open.ogg",loop:!1,volume:0.125,delayedLoad:!0};
M.archetypes.barrel={random:!0,sounds:[{path:"sounds/col_impactwoodbarrel2.ogg",loop:!1,volume:0.75,delayedLoad:!0},{path:"sounds/col_impactwoodbarrel5.ogg",loop:!1,volume:0.75,delayedLoad:!0},{path:"sounds/col_impactwoodbarrel6.ogg",loop:!1,volume:0.75,delayedLoad:!0}]};M.archetypes["switch"]={path:"sounds/switch.ogg",loop:!1,volume:0.75,delayedLoad:!0};M.archetypes.stoneDoor={path:"sounds/stone_door.ogg",loop:!1,volume:0.75,delayedLoad:!0};I.archetypes.explosion={texturePath:"textures/loop.dds",
lifetime:0.4,startScale:0.5,endScale:2.5,startColour:[1,1,0,0.5],endColour:[1,223/255,111/255,0]};I.archetypes.explosionBig={texturePath:"textures/loop.dds",lifetime:1.3,startScale:1,endScale:5,startColour:[1,1,0,0.5],endColour:[1,223/255,111/255,0]};I.archetypes.stomp={texturePath:"textures/dot.dds",lifetime:1,startScale:2,endScale:6,startColour:[0.5,0.5,0.5,1],endColour:[0.5,0.5,0.5,0]};I.archetypes.smallScaffold={texturePath:"textures/loop_fat.dds",lifetime:1.5,startScale:0.1,endScale:1.2,startColour:[1,
1,1,0.7],endColour:[1,1,1,0]};I.archetypes.scaffold={texturePath:"textures/loop_fat.dds",lifetime:1.8,startScale:1,endScale:4.5,startColour:[0.7,0.7,0.7,0.7],endColour:[1,1,1,0]};I.archetypes.hitScaffold={texturePath:"textures/loop.dds",lifetime:0.75,startScale:0.5,endScale:1.2,startColour:[0.7,0.7,0.7,0.7],endColour:[0.7,0.7,0.7,0]};I.archetypes.levelUp={texturePath:"textures/orb.dds",lifetime:2.2,startScale:0.25,endScale:10,startColour:[1,1,1,1],endColour:[1,1,1,0]};I.archetypes.pistolshoteffect=
{texturePath:"textures/loop.dds",lifetime:0.25,startScale:0.2,endScale:0.3,startColour:[1,223/255,111/255,1],endColour:[1,223/255,111/255,0]};I.archetypes.chargeUp={texturePath:"textures/charge_ready.dds",lifetime:0.4,startScale:0,endScale:4.5,startColour:k.fullyChargedShot,endColour:[k.fullyChargedShot[0],k.fullyChargedShot[1],k.fullyChargedShot[2],0]};I.archetypes.charge={texturePath:"textures/loop.dds",lifetime:0.75,startScale:1,endScale:2,startColour:[0.7,0.7,0.7,0.8],endColour:[0.7,0.7,0.7,0]};
I.archetypes.meleeHit={texturePath:"textures/loop.dds",lifetime:0.75,startScale:0.5,endScale:1,startColour:[0.7,0.7,0.7,0.6],endColour:[0.7,0.7,0.7,0]};I.archetypes.thumper={texturePath:"textures/loop.dds",lifetime:0.4,startScale:0.5,endScale:2.5,startColour:[1,1,0,0.5],endColour:[1,223/255,111/255,0]};I.archetypes.shot={texturePath:"textures/dot.dds",lifetime:0.5,startScale:0.5,endScale:1.5,startColour:[0.5,0.5,0.5,1],endColour:[0.5,0.5,0.5,0]};var Ic={explosion:{strength:1,duration:0.25},placeBuilding:{strength:0.5,
duration:0.25},score:{strength:0.6,duration:0.125}};Z.archetypes.explosion={visualEffectArchetype:"explosion",soundEffectArchetype:"explosion",screenShakeArchetype:"explosion"};Z.archetypes.placeBuilding={visualEffectArchetype:"scaffold",soundEffectArchetype:"buildingPlace",screenShakeArchetype:"placeBuilding"};Z.archetypes.taskLocation={visualEffectArchetype:"arrowPulse"};Z.archetypes.criticalTaskLocation={visualEffectArchetype:"criticalArrowPulse"};Z.archetypes.placeSmallBuilding={visualEffectArchetype:"smallScaffold",
soundEffectArchetype:"buildingPlace",screenShakeArchetype:"placeBuilding"};Z.archetypes.shot={visualEffectArchetype:"shot"};Z.archetypes.hitScaffold={visualEffectArchetype:"hitScaffold"};i.borderWidth=6;i.bigButtonScaleX=0.75;i.bigButtonScaleY=0.65;i.halfButtonScaleX=0.375;i.halfButtonScaleY=0.5525;i.cornerIconScaleX=0.7;i.cornerIconScaleY=0.7;i.smallerButtonScaleX=0.3375;i.smallerButtonScaleY=0.5525;i.dialogBoxScaleX=0.93;i.dialogBoxScaleY=0.93;i.dialogCutoutScaleX=0.8;i.dialogCutoutScaleY=0.8;i.radialIcon=
0.7;i.speechIcon=0.5;i.radialvariableX=0.2;i.clockScale=1.2;i.warCompassScale=1;i.lumberCostScale=1.3;i.stoneCostScale=1.3;i.amberCostScale=1.3;i.timeCostScale=1.3;i.nfScale=1.2;i.inGameGuiScale=1;i.radialFontStyle="bold";i.radialFontCase=!0;i.menuBtnFontStyle="bold";i.shopBtnFontStyle="bold";i.warCompassFontStyle="styled";i.warCompassFontCase=!0;i.warCompassMinorFontSize=19;i.warCompassMajorFontSize=29;i.radialFont=16;i.menuButtonFont=32;i.halfButtonFont=28;i.shareButtonFont=32;i.shopButtonFont=
32;i.barValueFont=16;i.radialMotion=0.4;i.speechMotion=3;i.progressMotion=2;i.floatMotion=6;i.radialMotionSec=0;i.alertMotion=0.8;i.buttonCornerOffsetX=-163;i.buttonCornerOffsetY=-22.5;i.buttonShareOffsetX=-66;i.costResOffsetX=-59;i.costTimeOffsetX=70;i.costSingleOffsetY=29;i.costDoubleOffsetY=36;i.costsMasterOffsetX=26;i.archetypes.cursor={instructions:[{command:"offsetCentre",x:23,y:23},{command:"renderSVG",svgPath:"gui/icon_cursor.svg",scaleX:0.9,scaleY:0.9,colorString:k.strings.darkBack},{command:"offsetCentre",
x:-3,y:-3},{command:"renderSVG",svgPath:"gui/icon_cursor.svg",scaleX:0.9,scaleY:0.9,colorString:k.strings.cursor}]};i.archetypes.crosshair={instructions:[{command:"renderSVG",svgPath:"gui/icon_cursor_crosshair.svg",scaleX:1.4,scaleY:1.4,colorString:k.strings.crosshair}]};i.archetypes.crosshairNo={instructions:[{command:"renderSVG",svgPath:"gui/icon_cursor_crosshair_no.svg",scaleX:1.4,scaleY:1.4,colorString:k.strings.crosshairNo}]};i.archetypes.tutorialBuild={instructions:[{command:"setRenderLocation",
x:0,y:0,locationName:"centre"},{command:"renderSprite",spritePath:"textures/tut_gatherandbuild.png",scale:1}]};i.archetypes.tutorialFight={instructions:[{command:"setRenderLocation",x:0,y:0,locationName:"centre"},{command:"renderSprite",spritePath:"textures/tut_defendandfight.png",scale:1}]};i.archetypes.tutorialButtonOk={instructions:[{command:"renderSVG",svgPath:"gui/shape_dialogue_button.svg",scaleX:0.9,scaleY:0.8,colorString:k.strings.outline},{command:"renderText",pointSize:24,color:k.normal,
font:"styled",upperCase:!0}]};i.archetypes.registerOK={instructions:[{command:"renderSVG",svgPath:"gui/shape_dialogue_button.svg",scaleX:0.9,scaleY:0.8,colorString:k.strings.outline},{command:"renderText",pointSize:24,color:k.normal,font:"styled",upperCase:!0}]};i.archetypes.gameMessageSingle={instructions:[{command:"applyTextScale",textBoxWidth:500,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_newsflash_top.svg",scaleX:0.9,scaleY:1,colorString:k.strings.normal},{command:"unApplyTextScale",
text:"text1",textBoxWidth:500},{command:"renderText",text:"text1",pointSize:i.menuButtonFont,font:"styled",upperCase:!0,color:k.outline},{command:"offsetCentre",y:70}]};i.archetypes.gameMessage={instructions:[{command:"renderSVG",svgPath:"gui/shape_newsflash_top.svg",scaleX:1,scaleY:1,colorString:k.strings.war},{command:"renderText",text:"text1",pointSize:i.menuButtonFont,font:"styled",upperCase:!0},{command:"offsetCentre",y:70},{command:"renderSVG",svgPath:"gui/shape_newsflash_bottom.svg",scaleX:1,
scaleY:1,colorString:k.strings.darkWar},{command:"renderText",text:"text2",pointSize:i.menuButtonFont,font:"styled",upperCase:!0}]};i.archetypes.newsflashRankUp={beginSFX:{name:"sfx_gui_badgeachieved",offsetX:0,offsetY:40},instructions:[{command:"offsetCentre",y:40},{command:"renderWidget",name:"burstWidget"},{command:"offsetCentre",y:-40},{command:"renderSVG",svgPath:"gui/shape_newsflash_top.svg",scaleX:0.5,scaleY:1,colorString:k.strings.heroxp},{command:"renderText",text:"text1",pointSize:i.menuButtonFont,
font:"styled",upperCase:!0},{command:"offsetCentre",y:70},{command:"renderSVG",svgPath:"gui/shape_newsflash_bottom.svg",scaleX:0.5,scaleY:1,colorString:k.strings.darkHeroxp},{command:"renderText",text:"text2",pointSize:i.menuButtonFont,font:"styled",upperCase:!0}]};i.archetypes.newsflashBadgeComplete={beginSFX:{name:"sfx_gui_badgeachieved",offsetX:0,offsetY:40},instructions:[{command:"offsetCentre",y:40},{command:"renderWidget",name:"burstWidget"},{command:"offsetCentre",y:-40},{command:"applyTextScale",
textBoxWidth:500,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_newsflash_top.svg",scaleX:0.9,scaleY:1,colorString:k.strings.normal},{command:"unApplyTextScale",text:"text1",textBoxWidth:500},{command:"renderText",text:"text1",pointSize:i.menuButtonFont,font:"styled",upperCase:!0,color:k.outline},{command:"offsetCentre",y:70},{command:"renderSVG",svgPath:"gui/shape_newsflash_bottom.svg",scaleX:0.6,scaleY:1,colorString:k.strings.orange},{command:"renderText",text:"ACHIEVED!",pointSize:i.menuButtonFont,
color:k.outline,font:"styled",upperCase:!0}]};i.archetypes.newsflashThankyou={beginSFX:{name:"sfx_gui_badgeachieved",offsetX:0,offsetY:0},instructions:[{command:"offsetCentre",y:40},{command:"applySpinRotate",angle:0.2},{command:"renderSprite",spritePath:"textures/burst_faint.dds",scale:1.2},{command:"applySpinRotate",angle:-0.2},{command:"applySpinRotate",angle:0.1},{command:"renderSprite",spritePath:"textures/burst_faint.dds",scale:0.8},{command:"applySpinRotate",angle:-0.1},{command:"offsetCentre",
y:-40},{command:"renderSVG",svgPath:"gui/shape_newsflash_top.svg",scaleX:0.8,scaleY:1,colorString:k.strings.amber},{command:"renderText",text:"text1",pointSize:i.menuButtonFont,font:"styled",upperCase:!0}]};i.archetypes.newsflashUpgradeComplete={beginSFX:{name:"sfx_gui_buildingcomplete",offsetX:0,offsetY:40},instructions:[{command:"applyTextScale",textBoxWidth:500,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_newsflash_top.svg",scaleX:0.9,scaleY:1,colorString:k.strings.normal},{command:"unApplyTextScale",
text:"text1",textBoxWidth:500},{command:"renderText",text:"text1",pointSize:i.menuButtonFont,font:"styled",upperCase:!0,color:k.outline},{command:"offsetCentre",y:70},{command:"renderSVG",svgPath:"gui/shape_newsflash_bottom.svg",scaleX:0.6,scaleY:1,colorString:k.strings.darkNormal},{command:"renderText",text:"text2",pointSize:i.menuButtonFont,font:"styled",upperCase:!0}]};i.archetypes.newsflashBuildingComplete={beginSFX:{name:"sfx_gui_buildingcomplete",offsetX:0,offsetY:40},instructions:[{command:"applyTextScale",
textBoxWidth:500,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_newsflash_top.svg",scaleX:0.9,scaleY:1,colorString:k.strings.normal},{command:"unApplyTextScale",text:"text1",textBoxWidth:500},{command:"renderText",text:"text1",pointSize:i.menuButtonFont,font:"styled",upperCase:!0,color:k.outline},{command:"offsetCentre",y:70},{command:"renderSVG",svgPath:"gui/shape_newsflash_bottom.svg",scaleX:0.8,scaleY:1,colorString:k.strings.darkNormal},{command:"renderText",text:"text2",pointSize:i.menuButtonFont,
font:"styled",upperCase:!0}]};i.archetypes.newsflashBattleStarted={beginSFX:{name:"sfx_gui_wavestarted",offsetX:0,offsetY:40},instructions:[{command:"renderSVG",svgPath:"gui/shape_newsflash_top.svg",scaleX:0.9,scaleY:1,colorString:k.strings.war},{command:"renderText",text:"text1",pointSize:i.menuButtonFont,font:"styled",upperCase:!0},{command:"offsetCentre",y:70},{command:"renderSVG",svgPath:"gui/shape_newsflash_bottom.svg",scaleX:0.6,scaleY:1,colorString:k.strings.darkWar},{command:"renderText",
text:"text2",pointSize:i.menuButtonFont,color:k.outline,font:"styled",upperCase:!0}]};i.archetypes.newsflashBattleEnded={beginSFX:{name:"sfx_gui_wavestarted",offsetX:0,offsetY:40},instructions:[{command:"renderSVG",svgPath:"gui/shape_newsflash_top.svg",scaleX:0.6,scaleY:1,colorString:k.strings.war},{command:"renderText",text:"text1",pointSize:i.menuButtonFont,font:"styled",upperCase:!0},{command:"offsetCentre",y:70},{command:"renderSVG",svgPath:"gui/shape_newsflash_bottom.svg",scaleX:0.6,scaleY:1,
colorString:k.strings.darkWar},{command:"renderText",text:"text2",pointSize:i.menuButtonFont,color:k.outline,font:"styled",upperCase:!0}]};i.archetypes.newsflashBattleCountdown={instructions:[{command:"renderSVG",svgPath:"gui/shape_newsflash_top.svg",scaleX:0.75,font:"styled",upperCase:!0,colorString:k.strings.warning},{command:"renderText",text:"text1",pointSize:i.menuButtonFont,font:"styled",upperCase:!0},{command:"offsetCentre",y:70},{command:"renderSVG",svgPath:"gui/shape_newsflash_bottom.svg",
scaleX:0.3,scaleY:1,colorString:k.strings.darkWarning},{command:"renderText",text:"text2",pointSize:i.menuButtonFont,color:k.outline,font:"styled",upperCase:!0}]};i.archetypes.newsflashLumberFull={beginSFX:{name:"sfx_gui_lumberfull",offsetX:0,offsetY:40},instructions:[{command:"renderSVG",svgPath:"gui/shape_newsflash_top.svg",scaleX:0.6,scaleY:1,colorString:k.strings.lumber},{command:"renderText",text:"text1",pointSize:i.menuButtonFont,font:"styled",upperCase:!0},{command:"offsetCentre",y:70},{command:"renderSVG",
svgPath:"gui/shape_newsflash_bottom.svg",scaleX:0.6,scaleY:1,colorString:k.strings.darkLumber},{command:"renderText",text:"text2",pointSize:i.menuButtonFont,font:"styled",upperCase:!0}]};i.archetypes.newsflashStoneFull={beginSFX:{name:"sfx_gui_stonefull",offsetX:0,offsetY:40},instructions:[{command:"renderSVG",svgPath:"gui/shape_newsflash_top.svg",scaleX:0.6,scaleY:1,colorString:k.strings.stone},{command:"renderText",text:"text1",pointSize:i.menuButtonFont,font:"styled",upperCase:!0},{command:"offsetCentre",
y:70},{command:"renderSVG",svgPath:"gui/shape_newsflash_bottom.svg",scaleX:0.4,scaleY:1,colorString:k.strings.darkStone},{command:"renderText",text:"text2",pointSize:i.menuButtonFont,font:"styled",upperCase:!0}]};i.archetypes.newsflashResearchComplete={beginSFX:{name:"sfx_gui_researchcomplete",offsetX:0,offsetY:40},instructions:[{command:"applyTextScale",textBoxWidth:500,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_newsflash_top.svg",scaleX:0.9,scaleY:1,colorString:k.strings.orange},{command:"unApplyTextScale",
text:"text1",textBoxWidth:500},{command:"renderText",text:"text1",pointSize:i.menuButtonFont,font:"styled",upperCase:!0,color:k.outline},{command:"offsetCentre",y:70},{command:"renderSVG",svgPath:"gui/shape_newsflash_bottom.svg",scaleX:0.7,scaleY:1,colorString:k.strings.darkOrange},{command:"renderText",text:"text2",pointSize:i.menuButtonFont,font:"styled",upperCase:!0}]};i.archetypes.newsflashHeroUpgrade={beginSFX:{name:"sfx_gui_badgeachieved",offsetX:0,offsetY:40},instructions:[{command:"offsetCentre",
y:40},{command:"renderWidget",name:"burstWidget"},{command:"offsetCentre",y:-40},{command:"applyTextScale",textBoxWidth:500,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_newsflash_top.svg",scaleX:0.9,scaleY:1,colorString:k.strings.heroxp},{command:"unApplyTextScale",text:"text1",textBoxWidth:500},{command:"renderText",text:"text1",pointSize:i.menuButtonFont,font:"styled",upperCase:!0,color:k.outline},{command:"offsetCentre",y:70},{command:"applyTextScale",textBoxWidth:500,text:"text2"},{command:"renderSVG",
svgPath:"gui/shape_newsflash_top.svg",scaleX:0.9,scaleY:1,colorString:k.strings.darkHeroxp},{command:"unApplyTextScale",text:"text2",textBoxWidth:500},{command:"renderText",text:"text2",pointSize:i.menuButtonFont,font:"styled",upperCase:!0,color:k.outline}]};i.archetypes.button={instructions:[{command:"renderSVG",svgPath:"gui/shape_button_menu.svg",scaleX:i.bigButtonScaleX,scaleY:i.bigButtonScaleY,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_button_menu.svg",
scaleX:i.bigButtonScaleX,scaleY:i.bigButtonScaleY,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_button_menu_lowlight.svg",scaleX:i.bigButtonScaleX,scaleY:i.bigButtonScaleY,colorString:k.strings.darkNormal},{command:"renderText",pointSize:i.menuButtonFont,font:i.menuBtnFontStyle,upperCase:i.radialFontCase}]};i.archetypes.buttonWide={instructions:[{command:"renderSVG",svgPath:"gui/shape_button_menu.svg",scaleX:1.2*i.bigButtonScaleX,scaleY:i.bigButtonScaleY,colorString:k.strings.outline,
border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_button_menu.svg",scaleX:1.2*i.bigButtonScaleX,scaleY:i.bigButtonScaleY,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_button_menu_lowlight.svg",scaleX:1.2*i.bigButtonScaleX,scaleY:i.bigButtonScaleY,colorString:k.strings.darkNormal},{command:"renderText",pointSize:i.menuButtonFont,font:i.menuBtnFontStyle,upperCase:i.radialFontCase}]};i.archetypes.buttonHalf={instructions:[{command:"renderSVG",svgPath:"gui/shape_button_menu.svg",
scaleX:i.halfButtonScaleX,scaleY:i.halfButtonScaleY,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_button_menu.svg",scaleX:i.halfButtonScaleX,scaleY:i.halfButtonScaleY,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_button_menu_lowlight.svg",scaleX:i.halfButtonScaleX,scaleY:i.halfButtonScaleY,colorString:k.strings.darkNormal},{command:"renderText",pointSize:i.halfButtonFont,font:i.menuBtnFontStyle,upperCase:i.radialFontCase}]};i.archetypes.buttonStart=
{instructions:[{command:"renderSVG",svgPath:"gui/shape_button_menu.svg",scaleX:i.bigButtonScaleX,scaleY:i.bigButtonScaleY,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_button_menu.svg",scaleX:i.bigButtonScaleX,scaleY:i.bigButtonScaleY,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_button_menu_lowlight.svg",scaleX:i.bigButtonScaleX,scaleY:i.bigButtonScaleY,colorString:k.strings.darkNormal},{command:"renderText",pointSize:i.menuButtonFont,
text:"PLAY",font:i.menuBtnFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:i.buttonCornerOffsetX,y:i.buttonCornerOffsetY},{command:"renderSVG",svgPath:"gui/icon_corner_bg.svg",scaleX:0.6,scaleY:0.6,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/icon_corner_play.svg",scaleX:i.cornerIconScaleX,scaleY:i.cornerIconScaleY,colorString:k.strings.outline}]};i.archetypes.buttonShop={instructions:[{command:"renderSVG",svgPath:"gui/shape_button_menu.svg",scaleX:i.bigButtonScaleX,
scaleY:i.bigButtonScaleY,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_button_menu.svg",scaleX:i.bigButtonScaleX,scaleY:i.bigButtonScaleY,colorString:k.strings.amber},{command:"renderSVG",svgPath:"gui/shape_button_menu_lowlight.svg",scaleX:i.bigButtonScaleX,scaleY:i.bigButtonScaleY,colorString:k.strings.darkAmber},{command:"renderText",pointSize:i.menuButtonFont,text:"SHOP",font:i.menuBtnFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:i.buttonCornerOffsetX,
y:i.buttonCornerOffsetY},{command:"renderSVG",svgPath:"gui/icon_corner_bg.svg",scaleX:0.6,scaleY:0.6,colorString:k.strings.amber},{command:"renderSVG",svgPath:"gui/icon_corner_shop.svg",scaleX:i.cornerIconScaleX,scaleY:i.cornerIconScaleY,colorString:k.strings.outline}]};i.archetypes.buttonWonderstruck={instructions:[{command:"renderSVG",svgPath:"gui/shape_button_menu.svg",scaleX:i.bigButtonScaleX,scaleY:i.bigButtonScaleY,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_button_menu.svg",
scaleX:i.bigButtonScaleX,scaleY:i.bigButtonScaleY,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_button_menu_lowlight.svg",scaleX:i.bigButtonScaleX,scaleY:i.bigButtonScaleY,colorString:k.strings.darkNormal},{command:"renderText",pointSize:i.menuButtonFont,text:"DEV BLOG",font:i.menuBtnFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:i.buttonCornerOffsetX,y:i.buttonCornerOffsetY},{command:"renderSVG",svgPath:"gui/icon_corner_bg.svg",scaleX:0.6,scaleY:0.6,colorString:k.strings.normal},
{command:"renderSVG",svgPath:"gui/icon_corner_wonderstruck.svg",scaleX:i.cornerIconScaleX,scaleY:i.cornerIconScaleY,colorString:k.strings.outline}]};i.archetypes.buttonShareTwitter={instructions:[{command:"renderSVG",svgPath:"gui/shape_button_menu.svg",scaleX:i.smallerButtonScaleX,scaleY:i.smallerButtonScaleY,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_button_menu.svg",scaleX:i.smallerButtonScaleX,scaleY:i.smallerButtonScaleY,colorString:k.strings.twitter},
{command:"renderSVG",svgPath:"gui/shape_button_menu_lowlight.svg",scaleX:i.smallerButtonScaleX,scaleY:i.smallerButtonScaleY,colorString:k.strings.darkTwitter},{command:"offsetCentre",x:10},{command:"renderText",pointSize:i.shareButtonFont,text:"SHARE",font:i.menuBtnFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:i.buttonShareOffsetX},{command:"renderSVG",svgPath:"gui/icon_twitter.svg",scaleX:i.cornerIconScaleX,scaleY:i.cornerIconScaleY,colorString:k.strings.outline}]};i.archetypes.buttonShareFacebook=
{instructions:[{command:"renderSVG",svgPath:"gui/shape_button_menu.svg",scaleX:i.smallerButtonScaleX,scaleY:i.smallerButtonScaleY,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_button_menu.svg",scaleX:i.smallerButtonScaleX,scaleY:i.smallerButtonScaleY,colorString:k.strings.facebook},{command:"renderSVG",svgPath:"gui/shape_button_menu_lowlight.svg",scaleX:i.smallerButtonScaleX,scaleY:i.smallerButtonScaleY,colorString:k.strings.darkFacebook},{command:"offsetCentre",
x:10},{command:"renderText",pointSize:i.shareButtonFont,text:"SHARE",font:i.menuBtnFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:i.buttonShareOffsetX},{command:"renderSVG",svgPath:"gui/icon_facebook.svg",scaleX:i.cornerIconScaleX,scaleY:i.cornerIconScaleY,colorString:k.strings.outline}]};i.archetypes.buttonShareReward={instructions:[{command:"offsetCentre",x:95,y:35},{command:"applyPulseScale",frequency:2,amplitudeDiff:0.1},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",
scaleX:0.65*3,scaleY:1,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.65*3,scaleY:1,colorString:k.strings.amber},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.buttonShareTwitterReward={instructions:[{command:"renderWidget",name:"buttonShareTwitter"},{command:"renderWidget",name:"buttonShareReward"}]};i.archetypes.buttonShareFacebookReward=
{instructions:[{command:"renderWidget",name:"buttonShareFacebook"},{command:"renderWidget",name:"buttonShareReward"}]};i.archetypes.shopAmberChunk={buttonSize:[300,220],instructions:[{command:"renderSVG",svgPath:"gui/shop_item_bg.svg",scale:1,colorString:k.strings.outline,border:i.borderWidth},{command:"offsetCentre",x:-0,y:-60},{command:"renderSprite",spritePath:"textures/amber1.dds",scale:0.6},{command:"offsetCentre",x:-0,y:60},{command:"offsetCentre",x:-0,y:10},{command:"renderSVG",svgPath:"gui/shop_amber_bg.svg",
scale:1,colorString:k.strings.amber},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase},{command:"offsetCentre",x:-0,y:-10},{command:"offsetCentre",x:-0,y:67},{command:"renderSVG",svgPath:"gui/shop_info_bg.svg",scale:1,colorString:k.strings.darkNormal},{command:"renderText",pointSize:30,text:"text2",font:"bold",upperCase:i.radialFontCase},{command:"offsetCentre",x:-0,y:-67}]};i.archetypes.shopAmberChest={buttonSize:[300,220],instructions:[{command:"renderSVG",
svgPath:"gui/shop_item_bg.svg",scale:1,colorString:k.strings.outline,border:i.borderWidth},{command:"offsetCentre",x:-0,y:-60},{command:"renderSprite",spritePath:"textures/amber2.dds",scale:1},{command:"offsetCentre",x:-0,y:60},{command:"offsetCentre",x:-0,y:10},{command:"renderSVG",svgPath:"gui/shop_amber_bg.svg",scale:1,colorString:k.strings.amber},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase},{command:"offsetCentre",x:-0,y:-10},{command:"offsetCentre",
x:-0,y:67},{command:"renderSVG",svgPath:"gui/shop_info_bg.svg",scale:1,colorString:k.strings.darkNormal},{command:"renderText",pointSize:30,text:"text2",font:"bold",upperCase:i.radialFontCase},{command:"offsetCentre",x:-0,y:-67}]};i.archetypes.shopAmberHoard={buttonSize:[300,220],instructions:[{command:"renderSVG",svgPath:"gui/shop_item_bg.svg",scale:1,colorString:k.strings.outline,border:i.borderWidth},{command:"applySpinRotate",angle:0.1},{command:"renderSprite",spritePath:"textures/burst_faint.dds",
scale:1.05},{command:"applySpinRotate",angle:-0.1},{command:"applySpinRotate",angle:0.05},{command:"renderSprite",spritePath:"textures/burst_faint.dds",scale:0.875},{command:"applySpinRotate",angle:-0.05},{command:"offsetCentre",x:-0,y:-60},{command:"renderSprite",spritePath:"textures/amber3.dds",scale:1},{command:"offsetCentre",x:-0,y:60},{command:"offsetCentre",x:-0,y:10},{command:"renderSVG",svgPath:"gui/shop_amber_bg.svg",scale:1,colorString:k.strings.amber},{command:"renderText",pointSize:24,
text:"text1",font:"bold",upperCase:i.radialFontCase},{command:"offsetCentre",x:-0,y:-10},{command:"offsetCentre",x:-0,y:67},{command:"renderSVG",svgPath:"gui/shop_info_bg.svg",scale:1,colorString:k.strings.darkNormal},{command:"renderText",pointSize:30,text:"text2",font:"bold",upperCase:i.radialFontCase},{command:"offsetCentre",x:-0,y:-67},{command:"offsetCentre",x:100,y:-108},{command:"applyPulseScale",frequency:1.4,amplitudeDiff:0.05},{command:"renderSVG",svgPath:"gui/shape_shop_item_cost_bg.svg",
scale:1,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_shop_item_cost_bg.svg",scale:1,colorString:k.strings.shopGreen},{command:"renderText",pointSize:18,text:"BEST VALUE!",font:i.shopBtnFontStyle,upperCase:i.radialFontCase}]};i.archetypes.shopItemAmberwell={buttonSize:[300,220],instructions:[{command:"renderSVG",svgPath:"gui/shop_item_bg.svg",scale:1,colorString:k.strings.outline,border:i.borderWidth},{command:"offsetCentre",x:-0,y:-60},{command:"renderSprite",
spritePath:"textures/amber_well.dds",scale:1},{command:"offsetCentre",x:-0,y:60},{command:"offsetCentre",x:-0,y:10},{command:"renderSVG",svgPath:"gui/shop_amber_bg.svg",scale:1,colorString:k.strings.amber},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase},{command:"offsetCentre",x:-0,y:-10},{command:"offsetCentre",x:-0,y:67},{command:"renderSVG",svgPath:"gui/shop_info_bg.svg",scale:1,colorString:k.strings.darkNormal},{command:"renderText",pointSize:30,text:"text2",
font:"bold",upperCase:i.radialFontCase},{command:"offsetCentre",x:-0,y:-67},{command:"offsetCentre",x:100,y:-108},{command:"applyPulseScale",frequency:1.4,amplitudeDiff:0.05},{command:"renderSVG",svgPath:"gui/shape_shop_item_cost_bg.svg",scaleX:1.2,scaleY:1,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_shop_item_cost_bg.svg",scaleX:1.2,scaleY:1,colorString:k.strings.normal},{command:"renderText",pointSize:18,text:"One Per Player",font:i.shopBtnFontStyle,
upperCase:i.radialFontCase}]};i.archetypes.shopItemAmbercrown={buttonSize:[300,220],instructions:[{command:"renderSVG",svgPath:"gui/shop_item_bg.svg",scale:1,colorString:k.strings.outline,border:i.borderWidth},{command:"offsetCentre",x:-0,y:-60},{command:"renderSprite",spritePath:"textures/amber_crown.dds",scale:1},{command:"offsetCentre",x:-0,y:60},{command:"offsetCentre",x:-0,y:10},{command:"renderSVG",svgPath:"gui/shop_amber_bg.svg",scale:1,colorString:k.strings.amber},{command:"renderText",pointSize:24,
text:"text1",font:"bold",upperCase:i.radialFontCase},{command:"offsetCentre",x:-0,y:-10},{command:"offsetCentre",x:-0,y:67},{command:"renderSVG",svgPath:"gui/shop_info_bg.svg",scale:1,colorString:k.strings.darkNormal},{command:"renderText",pointSize:30,text:"text2",font:"bold",upperCase:i.radialFontCase},{command:"offsetCentre",x:-0,y:-67},{command:"offsetCentre",x:100,y:-108},{command:"applyPulseScale",frequency:1.4,amplitudeDiff:0.05},{command:"renderSVG",svgPath:"gui/shape_shop_item_cost_bg.svg",
scaleX:1.2,scaleY:1,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_shop_item_cost_bg.svg",scaleX:1.2,scaleY:1,colorString:k.strings.normal},{command:"renderText",pointSize:18,text:"One Per Player",font:i.shopBtnFontStyle,upperCase:i.radialFontCase}]};i.archetypes.shopLumber={buttonSize:[300,220],instructions:[{command:"renderSVG",svgPath:"gui/shop_item_bg.svg",scale:1,colorString:k.strings.outline,border:i.borderWidth},{command:"offsetCentre",x:-0,y:-60},
{command:"renderSprite",spritePath:"textures/shop_tree.dds",scale:0.3},{command:"offsetCentre",x:-0,y:60},{command:"offsetCentre",x:-0,y:10},{command:"renderSVG",svgPath:"gui/shop_amber_bg.svg",scale:1,colorString:k.strings.lumber},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase},{command:"offsetCentre",x:-0,y:-10},{command:"offsetCentre",x:-0,y:67},{command:"renderSVG",svgPath:"gui/shop_info_bg.svg",scale:1,colorString:k.strings.darkNormal},{command:"renderText",
pointSize:30,text:"text2",font:"bold",upperCase:i.radialFontCase},{command:"offsetCentre",x:-0,y:-67}]};i.archetypes.shopStone={buttonSize:[300,220],instructions:[{command:"renderSVG",svgPath:"gui/shop_item_bg.svg",scale:1,colorString:k.strings.outline,border:i.borderWidth},{command:"offsetCentre",x:-0,y:-60},{command:"renderSprite",spritePath:"textures/shop_stone.dds",scale:0.3},{command:"offsetCentre",x:-0,y:60},{command:"offsetCentre",x:-0,y:10},{command:"renderSVG",svgPath:"gui/shop_amber_bg.svg",
scale:1,colorString:k.strings.stone},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase},{command:"offsetCentre",x:-0,y:-10},{command:"offsetCentre",x:-0,y:67},{command:"renderSVG",svgPath:"gui/shop_info_bg.svg",scale:1,colorString:k.strings.darkNormal},{command:"renderText",pointSize:30,text:"text2",font:"bold",upperCase:i.radialFontCase},{command:"offsetCentre",x:-0,y:-67}]};i.archetypes.shopTabAmberDown={buttonSize:[275,95],instructions:[{command:"renderSVG",
svgPath:"gui/shape_shop_tab_inactive.svg",scaleX:1.045,scaleY:1,colorString:k.strings.outline},{command:"renderText",pointSize:32,text:"text1",font:i.shopBtnFontStyle,upperCase:i.radialFontCase,color:k.darkGreen}]};i.archetypes.shopTabCraftDown={buttonSize:[275,95],instructions:[{command:"renderSVG",svgPath:"gui/shape_shop_tab_inactive.svg",scaleX:1.045,scaleY:1,colorString:k.strings.outline},{command:"renderText",pointSize:32,text:"text1",font:i.shopBtnFontStyle,upperCase:i.radialFontCase,color:k.darkGreen}]};
i.archetypes.shopTabAmberUp={buttonSize:[275,120],instructions:[{command:"renderSVG",svgPath:"gui/shape_shop_tab_active.svg",scale:1,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_shop_tab_active.svg",scale:1,colorString:k.strings.normal},{command:"renderText",pointSize:40,text:"text1",font:i.shopBtnFontStyle,upperCase:i.radialFontCase,color:k.outline}]};i.archetypes.shopTabCraftUp={buttonSize:[275,120],instructions:[{command:"renderSVG",svgPath:"gui/shape_shop_tab_active.svg",
scale:1,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_shop_tab_active.svg",scale:1,colorString:k.strings.normal},{command:"renderText",pointSize:40,text:"text1",font:i.shopBtnFontStyle,upperCase:i.radialFontCase,color:k.outline}]};i.archetypes.shopTabDecor={buttonSize:[275,120],instructions:[{command:"renderSVG",svgPath:"gui/shape_button_menu.svg",scale:1,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_button_menu.svg",
scale:1,colorString:k.strings.stone},{command:"renderSVG",svgPath:"gui/shape_button_menu_lowlight.svg",scale:1,colorString:k.strings.darkStone},{command:"renderText",pointSize:i.shopButtonFont,text:"text1",font:i.shopBtnFontStyle,upperCase:i.radialFontCase}]};i.archetypes.shopClose={buttonSize:[75,75],instructions:[{command:"renderSVG",svgPath:"gui/shape_square.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_square.svg",scale:0.8,colorString:k.strings.closeRed},
{command:"renderSVG",svgPath:"gui/shape_square_lowlight.svg",scale:0.8,colorString:k.strings.closeRedDark},{command:"renderSVG",svgPath:"gui/icon_cross.svg",scale:0.8,colorString:k.strings.outline}]};i.newsBoxScaleX=0.75;i.newsBoxScaleY=0.65;i.archetypes.newsBox={instructions:[{command:"renderSVG",svgPath:"gui/shape_rectangle_newspanel.svg",scaleX:i.newsBoxScaleX,scaleY:i.newsBoxScaleY,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_rectangle_newspanel.svg",
scaleX:i.newsBoxScaleX,scaleY:i.newsBoxScaleY,colorString:k.strings.murkyGreen},{command:"offsetCentre",x:-168,y:12},{command:"renderText",pointSize:24,align:0,boxWidth:340,boxHeight:200,font:"regular"}]};i.creditsScaleX=0.75;i.creditsScaleY=0.65;i.archetypes.credits={instructions:[{command:"renderSVG",svgPath:"gui/shape_rectangle_newspanel.svg",scaleX:2*i.newsBoxScaleX,scaleY:1.2*i.creditsScaleY,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_rectangle_newspanel.svg",
scaleX:2*i.newsBoxScaleX,scaleY:1.2*i.creditsScaleY,colorString:k.strings.murkyGreen},{command:"offsetCentre",x:-0,y:12},{command:"renderText",pointSize:28,align:1,boxWidth:680,boxHeight:200,font:"regular"}]};i.archetypes.bgPattern={instructions:[{command:"applySpinRotate",angle:0.05},{command:"renderSVG",svgPath:"gui/shapes_menu_bg_1.svg",scaleX:1,scaleY:1,colorString:k.strings.patternW},{command:"applySpinRotate",angle:0.05},{command:"renderSVG",svgPath:"gui/shapes_menu_bg_2.svg",scaleX:1,scaleY:1,
colorString:k.strings.patternB}]};i.archetypes.dialogBox={layer:2,instructions:[{command:"offsetCentre",x:0,y:-64},{command:"offsetCentre",x:0,y:15},{command:"renderSprite",spritePath:"textures/tut-shadow.dds",scale:4},{command:"offsetCentre",x:0,y:-15},{command:"renderSVG",svgPath:"gui/shape_dialogue.svg",scaleX:i.dialogBoxScaleX,scaleY:i.dialogBoxScaleY,colorString:k.strings.normal},{command:"offsetCentre",x:-40,y:-0},{command:"renderSVG",svgPath:"gui/shape_dialogue_wildling.svg",scaleX:i.dialogCutoutScaleX,
scaleY:i.dialogCutoutScaleY,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_dialogue_wildling_face.svg",scaleX:i.dialogCutoutScaleX,scaleY:i.dialogCutoutScaleY,colorString:k.strings.outline},{command:"offsetCentre",x:40,y:55},{command:"renderText",pointSize:30,font:"regular",text:"text",boxWidth:760,boxHeight:125}]};i.archetypes.dialogButtonOk={layer:2,instructions:[{command:"renderSVG",svgPath:"gui/shape_dialogue_button.svg",scaleX:0.9,scaleY:0.8,colorString:k.strings.outline},
{command:"renderText",pointSize:24,color:k.normal,font:"styled",upperCase:!0}]};i.archetypes.dialogButton={layer:2,instructions:[{command:"renderSVG",svgPath:"gui/shape_dialogue_button.svg",scaleX:0.9,scaleY:0.8,colorString:k.strings.outline},{command:"renderText",pointSize:24,color:k.normal,font:"styled",upperCase:!0}]};i.archetypes.polycraftLogo={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"renderSprite",spritePath:"textures/polycraft_logo.dds",scale:1.4}]};i.archetypes.shopLogo=
{instructions:[{command:"renderSVG",svgPath:"gui/logo_shop.svg",scale:0.8,colorString:k.strings.outline}]};i.archetypes.radialFrame={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"renderSprite",spritePath:"textures/shdw_radial.dds",scale:1},{command:"renderSVG",svgPath:"gui/shape_heptagon_large.svg",scale:1.1,colorString:k.strings.outlineVFaint},{command:"renderSVG",svgPath:"gui/shape_heptagon_outline_large.svg",scale:1.1,colorString:k.strings.outlineFaint}]};i.archetypes.pentagon=
{instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal}]};i.archetypes.addLumber={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},
{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"renderSVG",svgPath:"gui/icon_tree.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",
x:0,y:50},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1.2-i.radialvariableX,scaleY:1,colorString:k.strings.outline},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.darkGreen,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.addLumberInvalid={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},
{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.invalid},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkInvalid},{command:"applyRandomRotate",factor:-1},{command:"renderSVG",svgPath:"gui/icon_tree.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:50},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1.2-i.radialvariableX,scaleY:1,colorString:k.strings.outline},
{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.invalid,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:24,y:-65},{command:"renderSVG",svgPath:"gui/shape_invalid_bg.svg",scale:1,colorString:k.strings.outline},{command:"renderSVG",svgPath:"gui/shape_invalid.svg",scale:1,colorString:k.strings.orange},{command:"offsetCentre",x:-20,y:65}]};i.archetypes.addStone={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",
svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"renderSVG",svgPath:"gui/icon_stone.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:50},{command:"renderSVG",
svgPath:"gui/shape_rectangle_radial.svg",scaleX:1.2-i.radialvariableX,scaleY:1,colorString:k.strings.outline},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.darkGreen,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.addStoneInvalid={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",
scale:0.8,colorString:k.strings.invalid},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkInvalid},{command:"applyRandomRotate",factor:-1},{command:"renderSVG",svgPath:"gui/icon_stone.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:50},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1.2-i.radialvariableX,scaleY:1,colorString:k.strings.outline},{command:"renderText",pointSize:i.radialFont,
text:"text1",color:k.invalid,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:20,y:-65},{command:"renderSVG",svgPath:"gui/shape_invalid_bg.svg",scale:1,colorString:k.strings.outline},{command:"renderSVG",svgPath:"gui/shape_invalid.svg",scale:1,colorString:k.strings.orange},{command:"offsetCentre",x:-20,y:65}]};i.archetypes.addAmber={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applySpinRotate",angle:0.1},{command:"renderSprite",spritePath:"textures/burst_faint.dds",
scale:0.3},{command:"applySpinRotate",angle:-0.1},{command:"applySpinRotate",angle:0.05},{command:"renderSprite",spritePath:"textures/burst_faint.dds",scale:0.25},{command:"applySpinRotate",angle:-0.05},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.amber},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",
scale:0.8,colorString:k.strings.darkAmber},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_clock_face.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"applySpinRotate",angle:6},{command:"renderSVG",svgPath:"gui/icon_clock_mins.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"applySpinRotate",angle:-6},{command:"applySpinRotate",angle:0.5},{command:"renderSVG",
svgPath:"gui/icon_clock_hrs.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"applySpinRotate",angle:-0.5},{command:"offsetCentre",x:0,y:50},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1.25-i.radialvariableX,scaleY:1,colorString:k.strings.outline},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.amber,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.addAmberShop={instructions:[{command:"applyWobble",amount:i.radialMotion},
{command:"applySpinRotate",angle:0.1},{command:"renderSprite",spritePath:"textures/burst_faint.dds",scale:0.3},{command:"applySpinRotate",angle:-0.1},{command:"applySpinRotate",angle:0.05},{command:"renderSprite",spritePath:"textures/burst_faint.dds",scale:0.25},{command:"applySpinRotate",angle:-0.05},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",
scale:0.8,colorString:k.strings.amber},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkAmber},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_amber.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:50},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1-i.radialvariableX,scaleY:1,colorString:k.strings.outline},
{command:"renderText",pointSize:i.radialFont,text:"GO TO \n AMBER SHOP",color:k.amber,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.build={instructions:[{command:"renderWidget",name:"buildTop"},{command:"offsetCentre",x:-28,y:35},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.lumber},{command:"renderText",
pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:46,y:0},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.stone},{command:"renderText",pointSize:i.radialFont,text:"text3",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase}]};
i.archetypes.buildAmber={instructions:[{command:"renderWidget",name:"buildTop"},{command:"offsetCentre",x:0,y:35},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.amber},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.buildInvalidTop=
{instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.invalid},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkInvalid},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",
svgPath:"gui/icon_hammer.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:50},{command:"applyTextScale",textBoxWidth:120,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:1,colorString:k.strings.outline},{command:"unApplyTextScale",text:"text1",textBoxWidth:120},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.invalid,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",
x:30,y:-75},{command:"renderSVG",svgPath:"gui/shape_invalid_bg.svg",scale:1,colorString:k.strings.outline},{command:"renderSVG",svgPath:"gui/shape_invalid.svg",scale:1,colorString:k.strings.orange},{command:"offsetCentre",x:-30,y:75}]};i.archetypes.buildInvalid={instructions:[{command:"renderWidget",name:"buildInvalidTop"},{command:"offsetCentre",x:-28,y:35},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",
svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.lumber},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:46,y:0},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.stone},{command:"renderText",
pointSize:i.radialFont,text:"text3",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.buildInvalidAmber={instructions:[{command:"renderWidget",name:"buildInvalidTop"},{command:"offsetCentre",x:0,y:35},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.amber},{command:"renderText",pointSize:i.radialFont,
text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.cancelUpgrade={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},
{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_cross.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:42},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1.2-i.radialvariableX,scaleY:0.7,colorString:k.strings.outline},{command:"renderText",pointSize:i.radialFont,color:k.darkGreen,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.cancelUpgradeInvalid=
{instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.invalid},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkInvalid},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",
svgPath:"gui/icon_cross.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:50},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1.3-i.radialvariableX,scaleY:0.7,colorString:k.strings.outline},{command:"renderText",pointSize:i.radialFont,color:k.invalid,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.close={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",
svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_cross.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},
{command:"offsetCentre",x:0,y:50},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1.3-i.radialvariableX,scaleY:1,colorString:k.strings.outline},{command:"renderText",pointSize:i.radialFont,text:"Close",font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.dispense={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},
{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.darkGreen,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:30},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.darkGreen,font:i.radialFontStyle,
upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:42},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1.2-i.radialvariableX,scaleY:1,colorString:k.strings.outline},{command:"renderText",pointSize:i.radialFont,text:"text",color:k.darkGreen,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.dispenseInvalid={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,
colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.invalid},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.invalid,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:30},{command:"renderText",pointSize:i.radialFont,text:"text2",
color:k.invalid,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.gather={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",
factor:-1},{command:"renderText",pointSize:i.radialFont,text:"Gather",font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.lumber={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",
scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"renderText",pointSize:i.radialFont,text:"Lumber",font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.mana={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},
{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"renderText",pointSize:i.radialFont,text:"Mana",font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.move={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",
svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_move.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:42},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:0.7-i.radialvariableX,
scaleY:0.7,colorString:k.strings.outline},{command:"renderText",pointSize:i.radialFont,text:"text",color:k.darkGreen,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.repair={instructions:[{command:"applyScale",scale:1.25},{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},
{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_spanner.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:42},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:0.8-i.radialvariableX,scaleY:0.7,colorString:k.strings.outline},{command:"renderText",
pointSize:i.radialFont,text:"text1",color:k.darkGreen,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:-24,y:26},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.lumber},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},
{command:"offsetCentre",x:46,y:0},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.stone},{command:"renderText",pointSize:i.radialFont,text:"text3",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.repairInvalid={instructions:[{command:"applyScale",scale:1.25},{command:"applyWobble",
amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.invalid},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkInvalid},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_spanner.svg",
scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:42},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:0.8-i.radialvariableX,scaleY:0.7,colorString:k.strings.outline},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.invalid,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:30,y:-75},{command:"renderSVG",svgPath:"gui/shape_invalid_bg.svg",scale:1,colorString:k.strings.outline},{command:"renderSVG",
svgPath:"gui/shape_invalid.svg",scale:1,colorString:k.strings.orange},{command:"offsetCentre",x:-30,y:75},{command:"offsetCentre",x:-26,y:35},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.lumber},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},
{command:"offsetCentre",x:46,y:0},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.stone},{command:"renderText",pointSize:i.radialFont,text:"text3",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.rebuild={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},
{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"renderText",pointSize:i.radialFont,text:"Rebuild",font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.saw={instructions:[{command:"applyWobble",
amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"renderText",pointSize:i.radialFont,text:"Saw",font:i.radialFontStyle,upperCase:i.radialFontCase}]};
i.archetypes.sell={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"renderText",pointSize:i.radialFont,
text:"Sell",font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.speedup={layer:3,instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applySpinRotate",angle:0.1},{command:"renderSprite",spritePath:"textures/burst_faint.dds",scale:0.3},{command:"applySpinRotate",angle:-0.1},{command:"applySpinRotate",angle:0.05},{command:"renderSprite",spritePath:"textures/burst_faint.dds",scale:0.25},{command:"applySpinRotate",angle:-0.05},{command:"applyRandomRotate"},{command:"renderSVG",
svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.amber},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkAmber},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_clock_face.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},
{command:"applySpinRotate",angle:6},{command:"renderSVG",svgPath:"gui/icon_clock_mins.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"applySpinRotate",angle:-6},{command:"applySpinRotate",angle:0.5},{command:"renderSVG",svgPath:"gui/icon_clock_hrs.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"applySpinRotate",angle:-0.5},{command:"offsetCentre",x:0,y:42},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:0.8-
i.radialvariableX,scaleY:0.7,colorString:k.strings.outline},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.amber,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:30},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.9,scaleY:0.9,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.9,scaleY:0.9,colorString:k.strings.amber},{command:"renderText",pointSize:i.radialFont,
text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.upgrade={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},
{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_upgrade.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:40},{command:"applyTextScale",textBoxWidth:130,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:1,colorString:k.strings.outline},{command:"unApplyTextScale",text:"text1",textBoxWidth:120},{command:"renderText",pointSize:i.radialFont,
text:"text1",color:k.darkGreen,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:-26,y:28},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.lumber},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",
x:46,y:0},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.stone},{command:"renderText",pointSize:i.radialFont,text:"text3",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.upgradeInvalid={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},
{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.invalid},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkInvalid},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_upgrade.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},
{command:"offsetCentre",x:0,y:50},{command:"applyTextScale",textBoxWidth:130,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:1,colorString:k.strings.outline},{command:"unApplyTextScale",text:"text1",textBoxWidth:120},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.invalid,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:30,y:-75},{command:"renderSVG",svgPath:"gui/shape_invalid_bg.svg",scale:1,colorString:k.strings.outline},
{command:"renderSVG",svgPath:"gui/shape_invalid.svg",scale:1,colorString:k.strings.orange},{command:"offsetCentre",x:-30,y:75},{command:"offsetCentre",x:-26,y:35},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.lumber},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,
upperCase:i.radialFontCase},{command:"offsetCentre",x:46,y:0},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:0.8,scaleY:0.9,colorString:k.strings.stone},{command:"renderText",pointSize:i.radialFont,text:"text3",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.alertRepair={layer:-1,instructions:[{command:"applyWobble",
amount:2*i.alertMotion},{command:"offsetCentre",x:0,y:5},{command:"renderSVG",svgPath:"gui/shape_speech.svg",scale:1,colorString:k.strings.alert},{command:"offsetCentre",x:0,y:-9},{command:"renderSVG",svgPath:"gui/icon_spanner.svg",scale:i.speechIcon,colorString:k.strings.outline}]};i.archetypes.speechExclaim={instructions:[{command:"applyWobble",amount:i.speechMotion},{command:"offsetCentre",x:0,y:5},{command:"renderSVG",svgPath:"gui/shape_speech.svg",scale:1,colorString:k.strings.outline},{command:"offsetCentre",
x:0,y:-9},{command:"renderSVG",svgPath:"gui/icon_exclaim.svg",scale:i.speechIcon,colorString:k.strings.normal}]};i.archetypes.speechStopFollowing={instructions:[{command:"applyWobble",amount:i.speechlMotion},{command:"offsetCentre",x:0,y:5},{command:"renderSVG",svgPath:"gui/shape_speech.svg",scale:1,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:-9},{command:"renderSVG",svgPath:"gui/icon_dots.svg",scale:i.speechIcon,colorString:k.strings.normal}]};i.archetypes.speechWakeUp={instructions:[{command:"applyWobble",
amount:i.speechlMotion},{command:"offsetCentre",x:0,y:5},{command:"renderSVG",svgPath:"gui/shape_speech.svg",scale:1,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:-9},{command:"renderSVG",svgPath:"gui/icon_dots.svg",scale:i.speechIcon,colorString:k.strings.normal}]};i.archetypes.speechBuilding={instructions:[{command:"applyWobble",amount:i.speechlMotion},{command:"offsetCentre",x:0,y:5},{command:"renderSVG",svgPath:"gui/shape_speech.svg",scale:1,colorString:k.strings.outline},{command:"offsetCentre",
x:0,y:-9},{command:"renderSVG",svgPath:"gui/icon_hammer.svg",scale:i.speechIcon,colorString:k.strings.normal}]};i.archetypes.speechWarBuilding={instructions:[{command:"applyWobble",amount:i.speechlMotion},{command:"offsetCentre",x:0,y:5},{command:"renderSVG",svgPath:"gui/shape_speech.svg",scale:1,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:-9},{command:"renderSVG",svgPath:"gui/icon_hammer.svg",scale:i.speechIcon,colorString:k.strings.normal}]};i.archetypes.speechScaffoldHit={instructions:[{command:"applyWobble",
amount:i.speechlMotion},{command:"offsetCentre",x:0,y:5},{command:"renderSVG",svgPath:"gui/shape_speech.svg",scale:1,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:-9},{command:"renderSVG",svgPath:"gui/icon_minus_time.svg",scale:i.speechIcon,colorString:k.strings.normal}]};i.archetypes.speechLumber={instructions:[{command:"applyWobble",amount:i.speechMotion},{command:"offsetCentre",x:0,y:5},{command:"renderSVG",svgPath:"gui/shape_speech.svg",scale:1,colorString:k.strings.outline},{command:"offsetCentre",
x:0,y:-9},{command:"renderSVG",svgPath:"gui/icon_tree.svg",scale:i.speechIcon,colorString:k.strings.normal}]};i.archetypes.speechStone={instructions:[{command:"offsetCentre",x:0,y:5},{command:"renderSVG",svgPath:"gui/shape_speech.svg",scale:1,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:-9},{command:"renderSVG",svgPath:"gui/icon_stone.svg",scale:i.speechIcon,colorString:k.strings.normal}]};i.archetypes.dayClock={instructions:[{command:"offsetCentre",x:-46,y:44},{command:"offsetCentre",
x:35,y:-35},{command:"renderSVG",svgPath:"gui/clock_frame_top.svg",scale:i.clockScale,colorString:k.strings.clockday},{command:"renderSVG",svgPath:"gui/clock_frame_bottom.svg",scale:i.clockScale,colorString:k.strings.clocknight},{command:"renderSVG",svgPath:"gui/clock_grad_day.svg",scale:i.clockScale,colorString:k.strings.clockdaydark},{command:"renderSVG",svgPath:"gui/clock_grad_night.svg",scale:i.clockScale,colorString:k.strings.clocknightlight},{command:"renderSVG",svgPath:"gui/clock_frame_center_line.svg",
scale:i.clockScale,colorString:k.strings.outline},{command:"renderSVG",svgPath:"gui/clock_frame.svg",scale:i.clockScale,colorString:k.strings.outline},{command:"applyRotate",angle:Math.PI},{command:"applyCompleteRotate",angle:2*Math.PI},{command:"renderSVG",svgPath:"gui/clock_hand_wonk.svg",scale:i.clockScale,colorString:k.strings.clockhand},{command:"renderSVG",svgPath:"gui/clock_frame_center.svg",scale:i.clockScale,colorString:k.strings.outline}]};i.archetypes.respawnButtonAmber={instructions:[{command:"applyPulseScale",
frequency:1.8,amplitudeDiff:0.05},{command:"renderSVG",svgPath:"gui/shape_button_big_1.svg",scaleX:i.bigButtonScaleX,scaleY:i.bigButtonScaleY,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_button_big_1.svg",scaleX:i.bigButtonScaleX,scaleY:i.bigButtonScaleY,colorString:k.strings.normal},{command:"renderText",pointSize:i.menuButtonFont,text:"text1",font:i.menuBtnFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:45},{command:"renderSVG",
svgPath:"gui/shape_resource_float.svg",scaleX:1,scaleY:1.2,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:1,scaleY:1.2,colorString:k.strings.amber},{command:"renderText",pointSize:18,text:"text2",font:i.menuBtnFontStyle,color:k.outline}]};i.archetypes.respawnButtonLumber={instructions:[{command:"applyPulseScale",frequency:1.8,amplitudeDiff:0.05},{command:"renderSVG",svgPath:"gui/shape_button_big_1.svg",scaleX:i.bigButtonScaleX,
scaleY:i.bigButtonScaleY,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_button_big_1.svg",scaleX:i.bigButtonScaleX,scaleY:i.bigButtonScaleY,colorString:k.strings.normal},{command:"renderText",pointSize:i.menuButtonFont,text:"text1",font:i.menuBtnFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:45},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:1,scaleY:1.2,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",
svgPath:"gui/shape_resource_float.svg",scaleX:1,scaleY:1.2,colorString:k.strings.lumber},{command:"renderText",pointSize:18,text:"text2",font:i.menuBtnFontStyle,color:k.outline}]};i.archetypes.war_compass_prepare={instructions:[{command:"setRenderLocation",x:75,y:-75,locationName:"bottomLeft"},{command:"renderSprite",spritePath:"textures/shdw_wave_counter.dds",scale:1},{command:"renderSVG",svgPath:"gui/shape_war_sq.svg",scale:i.warCompassScale,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_war_sq_lowlight.svg",
scale:i.warCompassScale,colorString:k.strings.darkNormal},{command:"renderSVG",svgPath:"gui/shape_war_square_frame.svg",scale:i.warCompassScale,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:-11},{command:"renderText",pointSize:i.warCompassMinorFontSize,text:"SETUP",font:i.warCompassFontStyle,upperCase:i.warCompassFontCase},{command:"offsetCentre",x:1,y:22},{command:"renderText",pointSize:i.warCompassMajorFontSize,text:"text",font:i.warCompassFontStyle,upperCase:i.warCompassFontCase}]};
i.archetypes.war_compass_invasion={instructions:[{command:"setRenderLocation",x:75,y:-75,locationName:"bottomLeft"},{command:"renderSprite",spritePath:"textures/shdw_wave_counter.dds",scale:1},{command:"renderSVG",svgPath:"gui/shape_war_sq.svg",scale:i.warCompassScale,colorString:k.strings.war},{command:"renderSVG",svgPath:"gui/shape_war_sq_lowlight.svg",scale:i.warCompassScale,colorString:k.strings.darkWar},{command:"renderSVG",svgPath:"gui/shape_war_square_frame.svg",scale:i.warCompassScale,colorString:k.strings.outline},
{command:"offsetCentre",x:0,y:-11},{command:"renderText",pointSize:i.warCompassMinorFontSize,text:"WAVE",font:i.warCompassFontStyle,upperCase:i.warCompassFontCase},{command:"offsetCentre",x:1,y:22},{command:"renderText",pointSize:i.warCompassMajorFontSize,text:"text",font:i.warCompassFontStyle,upperCase:i.warCompassFontCase},{command:"offsetCentre",x:0,y:-11}]};i.archetypes.resourceLumber={layer:-4,instructions:[{command:"applyWobble",amount:i.floatMotion},{command:"offsetCentre",x:0,y:15},{command:"applyTextScale",
textBoxWidth:32,text:"text"},{command:"renderSprite",spritePath:"textures/score_shadow.dds",scale:1.6},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scale:1,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scale:1,colorString:k.strings.lumber},{command:"unApplyTextScale",textBoxWidth:32,text:"text"},{command:"renderText",pointSize:20,font:"bold"}]};i.archetypes.resourceStone={layer:-3,instructions:[{command:"applyWobble",
amount:i.floatMotion},{command:"offsetCentre",x:0,y:20},{command:"applyTextScale",textBoxWidth:30,text:"text"},{command:"renderSprite",spritePath:"textures/score_shadow.dds",scale:1.6},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scale:1,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scale:1,colorString:k.strings.stone},{command:"unApplyTextScale",textBoxWidth:30,text:"text"},{command:"renderText",pointSize:20,font:"bold"}]};
i.archetypes.resourceAmber={layer:-1,instructions:[{command:"applyWobble",amount:i.floatMotion},{command:"offsetCentre",x:0,y:25},{command:"applyTextScale",textBoxWidth:30,text:"text"},{command:"renderSprite",spritePath:"textures/score_shadow.dds",scale:1.6},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scale:1,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scale:1,colorString:k.strings.amber},{command:"unApplyTextScale",
textBoxWidth:30,text:"text"},{command:"renderText",pointSize:20,font:"bold"}]};i.archetypes.resourceXp={layer:-2,instructions:[{command:"applyWobble",amount:i.floatMotion},{command:"offsetCentre",x:0,y:10},{command:"applyTextScale",textBoxWidth:30,text:"text"},{command:"renderSprite",spritePath:"textures/score_shadow.dds",scale:1.6},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scale:1,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",
scale:1,colorString:k.strings.xp},{command:"unApplyTextScale",textBoxWidth:30,text:"text"},{command:"renderText",pointSize:20,font:"bold"}]};i.archetypes.example={instructions:[{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.darkBack},{command:"offsetCentre",x:-3,y:-3}]};i.archetypes.healthBar={instructions:[{command:"renderSVG",svgPath:"gui/shape_square.svg",
colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_square.svg",colorString:k.strings.darkBack},{command:"renderBarSVG",svgPath:"gui/shape_square.svg",colorString:k.strings.amber,align:0}]};i.archetypes.hqHealthBar={instructions:[{command:"setRenderLocation",x:-124*i.inGameGuiScale,y:-52*i.inGameGuiScale,locationName:"bottomRight"},{command:"applyScale",scale:i.inGameGuiScale},{command:"offsetCentre",x:0,y:-225},{command:"offsetCentre",x:0,y:10},{command:"renderSVG",
svgPath:"gui/shape_bar_sep.svg",colorString:k.strings.blackvFaint},{command:"offsetCentre",x:0,y:-1},{command:"renderSVG",svgPath:"gui/shape_bar_sep.svg",colorString:k.strings.whiteFaint},{command:"offsetCentre",x:0,y:-45},{command:"renderSprite",spritePath:"textures/shdw_bar.dds",scale:1},{command:"renderSVG",svgPath:"gui/bar_r_bg.svg",colorString:k.strings.outline},{command:"offsetCentre",x:72,y:0},{command:"renderSVG",svgPath:"gui/bar_r_square.svg",colorString:k.strings.aggro},{command:"renderSVG",
svgPath:"gui/bar_r_square_lowlight.svg",colorString:k.strings.darkAggro},{command:"renderSVG",svgPath:"gui/icon_bar_hq.svg",colorString:k.strings.outline},{command:"offsetCentre",x:-72,y:0},{command:"offsetCentre",x:-22,y:0},{command:"renderSVG",svgPath:"gui/bar_r_100pc.svg",colorString:k.strings.lightAggro,scale:1},{command:"renderBarSVG",svgPath:"gui/bar_r_100pc.svg",colorString:k.strings.aggro,align:0},{command:"offsetCentre",x:-0,y:6},{command:"renderBarSVG",svgPath:"gui/bar_r_100pc_lowlight.svg",
colorString:k.strings.darkAggro,align:0},{command:"offsetCentre",x:-0,y:-6},{command:"offsetCentre",x:-61,y:0},{command:"renderText",font:"bold",text:"HQ HEALTH",align:0,pointSize:16}]};i.archetypes.aggroBar={instructions:[{command:"renderSVG",svgPath:"gui/bar_frame_invasion.svg",colorString:k.strings.outline},{command:"offsetCentre",x:-2,y:16},{command:"renderBarSVG",svgPath:"gui/bar_fill_rectangle.svg",colorString:k.strings.aggro,align:0}]};i.archetypes.lumberBar={instructions:[{command:"setRenderLocation",
x:-124*i.inGameGuiScale,y:-52*i.inGameGuiScale,locationName:"bottomRight"},{command:"applyScale",scale:i.inGameGuiScale},{command:"renderSprite",spritePath:"textures/shdw_bar.dds",scale:1},{command:"renderSVG",svgPath:"gui/bar_r_bg.svg",colorString:k.strings.outline},{command:"offsetCentre",x:72,y:0},{command:"renderSVG",svgPath:"gui/bar_r_square.svg",colorString:k.strings.lumber},{command:"renderSVG",svgPath:"gui/bar_r_square_lowlight.svg",colorString:k.strings.darkLumber},{command:"renderSVG",svgPath:"gui/bar_r_lumber.svg",
colorString:k.strings.outline},{command:"offsetCentre",x:-72,y:0},{command:"offsetCentre",x:-22,y:0},{command:"renderSVG",svgPath:"gui/bar_r_100pc.svg",colorString:k.strings.lightLumber,scale:1},{command:"renderBarSVG",svgPath:"gui/bar_r_100pc.svg",colorString:k.strings.lumber,align:0},{command:"offsetCentre",x:-0,y:6},{command:"renderBarSVG",svgPath:"gui/bar_r_100pc_lowlight.svg",colorString:k.strings.darkLumber,align:0},{command:"offsetCentre",x:-0,y:-6},{command:"offsetCentre",x:-61,y:0},{command:"renderText",
text:"text1",font:"bold",align:0,pointSize:16},{command:"offsetCentre",x:178,y:38},{command:"renderText",text:"text2",font:"bold",color:k.maxValTextShad,align:2,upperCase:!0,pointSize:16},{command:"offsetCentre",x:0,y:-1},{command:"renderText",text:"text2",font:"bold",color:k.maxValText,align:2,upperCase:!0,pointSize:16}]};i.archetypes.stoneBar={instructions:[{command:"setRenderLocation",x:-124*i.inGameGuiScale,y:-52*i.inGameGuiScale,locationName:"bottomRight"},{command:"applyScale",scale:i.inGameGuiScale},
{command:"offsetCentre",x:0,y:-75},{command:"renderSprite",spritePath:"textures/shdw_bar.dds",scale:1},{command:"renderSVG",svgPath:"gui/bar_r_bg.svg",colorString:k.strings.outline},{command:"offsetCentre",x:72,y:0},{command:"renderSVG",svgPath:"gui/bar_r_square.svg",colorString:k.strings.stone},{command:"renderSVG",svgPath:"gui/bar_r_square_lowlight.svg",colorString:k.strings.darkStone},{command:"renderSVG",svgPath:"gui/bar_r_stone.svg",colorString:k.strings.outline},{command:"offsetCentre",x:-72,
y:0},{command:"offsetCentre",x:-22,y:0},{command:"renderSVG",svgPath:"gui/bar_r_100pc.svg",colorString:k.strings.lightStone,scale:1},{command:"renderBarSVG",svgPath:"gui/bar_r_100pc.svg",colorString:k.strings.stone,align:0},{command:"offsetCentre",x:-0,y:6},{command:"renderBarSVG",svgPath:"gui/bar_r_100pc_lowlight.svg",colorString:k.strings.darkStone,align:0},{command:"offsetCentre",x:-0,y:-6},{command:"offsetCentre",x:-61,y:0},{command:"renderText",font:"bold",text:"text1",align:0,pointSize:16},
{command:"offsetCentre",x:178,y:38},{command:"renderText",text:"text2",font:"bold",color:k.maxValTextShad,align:2,upperCase:!0,pointSize:16},{command:"offsetCentre",x:0,y:-1},{command:"renderText",text:"text2",font:"bold",color:k.maxValText,align:2,upperCase:!0,pointSize:16}]};i.archetypes.shopAmberTopup={buttonSize:[205,55],instructions:[]};i.archetypes.resourceAmberTotal={instructions:[{command:"setRenderLocation",x:-124*i.inGameGuiScale,y:-52*i.inGameGuiScale,locationName:"bottomRight"},{command:"applyScale",
scale:i.inGameGuiScale},{command:"offsetCentre",x:0,y:-150},{command:"offsetCentre",x:0,y:30},{command:"renderSVG",svgPath:"gui/shape_bar_sep.svg",colorString:k.strings.blackvFaint},{command:"offsetCentre",x:0,y:-1},{command:"renderSVG",svgPath:"gui/shape_bar_sep.svg",colorString:k.strings.whiteFaint},{command:"offsetCentre",x:0,y:-45},{command:"renderSprite",spritePath:"textures/shdw_bar.dds",scale:1},{command:"renderSVG",svgPath:"gui/bar_r_bg.svg",colorString:k.strings.outline},{command:"offsetCentre",
x:72,y:0},{command:"renderSVG",svgPath:"gui/bar_r_square.svg",colorString:k.strings.amber},{command:"renderSVG",svgPath:"gui/bar_r_square_lowlight.svg",colorString:k.strings.darkAmber},{command:"renderSVG",svgPath:"gui/bar_r_amber.svg",colorString:k.strings.outline},{command:"offsetCentre",x:-72,y:0},{command:"offsetCentre",x:-10,y:0},{command:"renderSVG",svgPath:"gui/bar_r_100pc.svg",scaleX:0.8,colorString:k.strings.amber,scale:1},{command:"offsetCentre",x:-0,y:6},{command:"renderSVG",svgPath:"gui/bar_r_100pc_lowlight.svg",
scaleX:0.8,colorString:k.strings.darkAmber,scale:1},{command:"offsetCentre",x:-0,y:-6},{command:"offsetCentre",x:10,y:0},{command:"offsetCentre",x:-80,y:0},{command:"renderSVG",svgPath:"gui/icon_plus_mini.svg",scale:0.9,colorString:k.strings.amber},{command:"offsetCentre",x:80,y:0},{command:"offsetCentre",x:-56,y:0},{command:"renderText",font:"bold",align:0,pointSize:16}]};i.archetypes.buildingProgressBar={layer:-1,beginSFX:{name:"sfx_gui_build",offsetX:0,offsetY:20},instructions:[{command:"applyWobble",
amount:i.progressMotion},{command:"renderSprite",spritePath:"textures/shdw_menu_button.dds",scaleX:1.4,scaleY:1.8},{command:"offsetCentre",x:-0,y:-20},{command:"renderSVG",svgPath:"gui/bar_frame_building.svg",colorString:k.strings.outline,scale:0.65},{command:"offsetCentre",x:-1,y:18.2},{command:"renderSVG",svgPath:"gui/bar_fill_rectangle.svg",colorString:k.strings.lightNormal,scale:0.65},{command:"renderBarSVG",svgPath:"gui/bar_fill_rectangle.svg",colorString:k.strings.normal,align:0,scale:0.65},
{command:"renderBarSVG",svgPath:"gui/bar_fill_rectangle_lowlight.svg",colorString:k.strings.darkNormal,align:0,scale:0.65},{command:"offsetCentre",x:1.5,y:48*0.65},{command:"renderText",pointSize:18,align:1,font:"bold",text:"Building...",color:k.textShadow},{command:"offsetCentre",x:-0,y:-1},{command:"renderText",pointSize:18,align:1,font:"bold",text:"Building..."},{command:"offsetCentre",x:-0,y:17},{command:"renderText",pointSize:18,align:1,font:"bold",color:k.textShadow},{command:"offsetCentre",
x:-0,y:-1},{command:"renderText",pointSize:18,align:1,font:"bold"}]};i.archetypes.buildingProgressBar={layer:-1,beginSFX:{name:"sfx_gui_build",offsetX:0,offsetY:20},instructions:[{command:"applyWobble",amount:i.progressMotion},{command:"renderSprite",spritePath:"textures/shdw_menu_button.dds",scaleX:1.4,scaleY:1.8},{command:"offsetCentre",x:-0,y:-20},{command:"renderSVG",svgPath:"gui/bar_frame_building.svg",colorString:k.strings.outline,scale:0.65},{command:"offsetCentre",x:-1,y:18.2},{command:"renderSVG",
svgPath:"gui/bar_fill_rectangle.svg",colorString:k.strings.lightNormal,scale:0.65},{command:"renderBarSVG",svgPath:"gui/bar_fill_rectangle.svg",colorString:k.strings.normal,align:0,scale:0.65},{command:"renderBarSVG",svgPath:"gui/bar_fill_rectangle_lowlight.svg",colorString:k.strings.darkNormal,align:0,scale:0.65},{command:"offsetCentre",x:1.5,y:48*0.65},{command:"renderText",pointSize:18,align:1,font:"bold",text:"Building...",color:k.textShadow},{command:"offsetCentre",x:-0,y:-1},{command:"renderText",
pointSize:18,align:1,font:"bold",text:"Building..."},{command:"offsetCentre",x:-0,y:17},{command:"renderText",pointSize:18,align:1,font:"bold",color:k.textShadow},{command:"offsetCentre",x:-0,y:-1},{command:"renderText",pointSize:18,align:1,font:"bold"}]};i.archetypes.upgradeProgressBar={layer:-1,beginSFX:{name:"sfx_gui_upgrade",offsetX:0,offsetY:20},instructions:[{command:"applyWobble",amount:i.progressMotion},{command:"renderSprite",spritePath:"textures/shdw_menu_button.dds",scaleX:1.4,scaleY:1.8},
{command:"offsetCentre",x:-0,y:-20},{command:"renderSVG",svgPath:"gui/bar_frame_upgrading.svg",colorString:k.strings.outline,scale:0.65},{command:"offsetCentre",x:-1,y:18.2},{command:"renderSVG",svgPath:"gui/bar_fill_rectangle.svg",colorString:k.strings.lightNormal,scale:0.65},{command:"renderBarSVG",svgPath:"gui/bar_fill_rectangle.svg",colorString:k.strings.normal,align:0,scale:0.65},{command:"renderBarSVG",svgPath:"gui/bar_fill_rectangle_lowlight.svg",colorString:k.strings.darkNormal,align:0,scale:0.65},
{command:"offsetCentre",x:1.5,y:48*0.65},{command:"renderText",pointSize:18,align:1,font:"bold",text:"Upgrading...",color:k.textShadow},{command:"offsetCentre",x:-0,y:-1},{command:"renderText",pointSize:18,align:1,font:"bold",text:"Upgrading..."},{command:"offsetCentre",x:-0,y:17},{command:"renderText",pointSize:18,align:1,font:"bold",color:k.textShadow},{command:"offsetCentre",x:-0,y:-1},{command:"renderText",pointSize:18,align:1,font:"bold"}]};i.archetypes.unlockProgressBar={beginSFX:{name:"sfx_gui_research",
offsetX:0,offsetY:20},instructions:[{command:"applyWobble",amount:i.progressMotion},{command:"renderSprite",spritePath:"textures/shdw_menu_button.dds",scaleX:1.4,scaleY:1.8},{command:"offsetCentre",x:-0,y:-20},{command:"renderSVG",svgPath:"gui/bar_frame_research.svg",colorString:k.strings.outline,scale:0.65},{command:"offsetCentre",x:-1,y:18.2},{command:"renderSVG",svgPath:"gui/bar_fill_rectangle.svg",colorString:k.strings.lightOrange,scale:0.65},{command:"renderBarSVG",svgPath:"gui/bar_fill_rectangle.svg",
colorString:k.strings.orange,align:0,scale:0.65},{command:"renderBarSVG",svgPath:"gui/bar_fill_rectangle_lowlight.svg",colorString:k.strings.darkProgOrangeBar,align:0,scale:0.65},{command:"offsetCentre",x:1.5,y:48*0.65},{command:"renderText",pointSize:18,align:1,font:"bold",text:"Researching...",color:k.textShadow},{command:"offsetCentre",x:-0,y:-1},{command:"renderText",pointSize:18,align:1,font:"bold",text:"Researching..."},{command:"offsetCentre",x:-0,y:17},{command:"renderText",pointSize:18,align:1,
font:"bold",color:k.textShadow},{command:"offsetCentre",x:-0,y:-1},{command:"renderText",pointSize:18,align:1,font:"bold"}]};i.archetypes.amberWellProgressBar={beginSFX:{name:"sfx_gui_research",offsetX:0,offsetY:20},instructions:[{command:"applyWobble",amount:i.progressMotion},{command:"renderSprite",spritePath:"textures/shdw_menu_button.dds",scaleX:1.4,scaleY:1.8},{command:"offsetCentre",x:-0,y:-20},{command:"renderSVG",svgPath:"gui/bar_frame_amberwell.svg",colorString:k.strings.outline,scale:0.65},
{command:"offsetCentre",x:-1,y:13},{command:"renderSVG",svgPath:"gui/bar_fill_rectangle.svg",colorString:k.strings.lightAmber,scale:0.65},{command:"renderBarSVG",svgPath:"gui/bar_fill_rectangle.svg",colorString:k.strings.amber,align:0,scale:0.65},{command:"renderBarSVG",svgPath:"gui/bar_fill_rectangle_lowlight.svg",colorString:k.strings.darkAmber,align:0,scale:0.65},{command:"offsetCentre",x:1.5,y:48*0.65},{command:"renderText",pointSize:18,align:1,font:"bold",text:"Refilling...",color:k.textShadow},
{command:"offsetCentre",x:-0,y:-1},{command:"renderText",pointSize:18,align:1,font:"bold",text:"Refilling..."},{command:"offsetCentre",x:-0,y:17},{command:"renderText",pointSize:18,align:1,font:"bold",color:k.textShadow},{command:"offsetCentre",x:-0,y:-1},{command:"renderText",pointSize:18,align:1,font:"bold"}]};i.archetypes.amberChestProgressBar={beginSFX:{name:"sfx_gui_research",offsetX:0,offsetY:20},instructions:[{command:"applyWobble",amount:i.progressMotion},{command:"renderSprite",spritePath:"textures/shdw_menu_button.dds",
scaleX:1.4,scaleY:1.8},{command:"offsetCentre",x:-0,y:-20},{command:"renderSVG",svgPath:"gui/bar_frame_amberchest.svg",colorString:k.strings.outline,scale:0.65},{command:"offsetCentre",x:-1,y:-2.6},{command:"renderSVG",svgPath:"gui/bar_fill_rectangle.svg",colorString:k.strings.lightAmber,scale:0.65},{command:"renderBarSVG",svgPath:"gui/bar_fill_rectangle.svg",colorString:k.strings.amber,align:0,scale:0.65},{command:"renderBarSVG",svgPath:"gui/bar_fill_rectangle_lowlight.svg",colorString:k.strings.darkAmber,
align:0,scale:0.65},{command:"offsetCentre",x:1.5,y:48*0.65},{command:"renderText",pointSize:18,align:1,font:"bold",text:"Refilling...",color:k.textShadow},{command:"offsetCentre",x:-0,y:-1},{command:"renderText",pointSize:18,align:1,font:"bold",text:"Refilling..."},{command:"offsetCentre",x:-0,y:17},{command:"renderText",pointSize:18,align:1,font:"bold",color:k.textShadow},{command:"offsetCentre",x:-0,y:-1},{command:"renderText",pointSize:18,align:1,font:"bold"}]};i.archetypes.buildingCompleteBar=
{layer:-1,beginSFX:{name:"sfx_gui_build",offsetX:0,offsetY:20},instructions:[{command:"applyWobble",amount:i.progressMotion},{command:"renderSprite",spritePath:"textures/shdw_menu_button.dds",scaleX:1.4,scaleY:1.8},{command:"offsetCentre",x:-0,y:-20},{command:"renderSVG",svgPath:"gui/bar_frame_building.svg",colorString:k.strings.outline,scale:0.65},{command:"offsetCentre",x:-1,y:18.2},{command:"renderSVG",svgPath:"gui/bar_fill_rectangle.svg",colorString:k.strings.normal,align:0,scale:0.65},{command:"renderSVG",
svgPath:"gui/bar_fill_rectangle_lowlight.svg",colorString:k.strings.darkNormal,align:0,scale:0.65},{command:"offsetCentre",x:1.5,y:48*0.65},{command:"renderText",pointSize:18,align:1,font:"bold",text:"Building Complete!",color:k.textShadow},{command:"offsetCentre",x:-0,y:-1},{command:"renderText",pointSize:18,align:1,font:"bold",text:"Building Complete!"}]};i.archetypes.upgradeCompleteBar={layer:-1,beginSFX:{name:"sfx_gui_upgrade",offsetX:0,offsetY:20},instructions:[{command:"applyWobble",amount:i.progressMotion},
{command:"renderSprite",spritePath:"textures/shdw_menu_button.dds",scaleX:1.4,scaleY:1.8},{command:"offsetCentre",x:-0,y:-20},{command:"renderSVG",svgPath:"gui/bar_frame_upgrading.svg",colorString:k.strings.outline,scale:0.65},{command:"offsetCentre",x:-1,y:18.2},{command:"renderSVG",svgPath:"gui/bar_fill_rectangle.svg",colorString:k.strings.normal,align:0,scale:0.65},{command:"renderSVG",svgPath:"gui/bar_fill_rectangle_lowlight.svg",colorString:k.strings.darkNormal,align:0,scale:0.65},{command:"offsetCentre",
x:1.5,y:48*0.65},{command:"renderText",pointSize:18,align:1,font:"bold",text:"Upgrade Complete!",color:k.textShadow},{command:"offsetCentre",x:-0,y:-1},{command:"renderText",pointSize:18,align:1,font:"bold",text:"Upgrade Complete!"}]};i.archetypes.fullscreen={instructions:[{command:"renderSprite",spritePath:"textures/task_shadow.dds",scale:0.98},{command:"renderSVG",svgPath:"gui/shape_small_square.svg",scale:1,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_small_square_lowlight.svg",
scale:1,colorString:k.strings.darkNormal},{command:"offsetCentre",x:-12,y:-12},{command:"renderSVG",svgPath:"gui/icon_fullscreen_small.svg",scale:1.2,colorString:k.strings.outline}]};i.archetypes.minimize={instructions:[{command:"renderSprite",spritePath:"textures/task_shadow.dds",scale:0.98},{command:"renderSVG",svgPath:"gui/shape_small_square.svg",scale:1,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_small_square_lowlight.svg",scale:1,colorString:k.strings.darkNormal},{command:"offsetCentre",
x:-10,y:-11},{command:"renderSVG",svgPath:"gui/icon_minimize_small.svg",scale:1.2,colorString:k.strings.outline}]};i.archetypes.pause={instructions:[{command:"renderSprite",spritePath:"textures/task_shadow.dds",scale:0.98},{command:"renderSVG",svgPath:"gui/shape_small_square.svg",scale:1,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_small_square_lowlight.svg",scale:1,colorString:k.strings.darkNormal},{command:"offsetCentre",x:-16,y:-15},{command:"renderSVG",svgPath:"gui/icon_pause_small.svg",
scale:1.2,colorString:k.strings.outline}]};i.archetypes.shop={layer:1,instructions:[{command:"applyScale",scale:i.inGameGuiScale},{command:"renderSprite",spritePath:"textures/shdw_menu_button.dds",scale:1.1},{command:"renderSVG",svgPath:"gui/shape_button.svg",colorString:k.strings.amber},{command:"renderSVG",svgPath:"gui/shape_button_lowlight.svg",colorString:k.strings.darkAmber},{command:"renderText",pointSize:26,text:"SHOP",font:"styled"}]};i.archetypes.craft={layer:1,instructions:[{command:"applyScale",
scale:i.inGameGuiScale},{command:"renderSprite",spritePath:"textures/shdw_menu_button.dds",scale:1.1},{command:"renderSVG",svgPath:"gui/shape_button.svg",colorString:k.strings.amber},{command:"renderSVG",svgPath:"gui/shape_button_lowlight.svg",colorString:k.strings.darkAmber},{command:"renderText",pointSize:26,text:"CRAFT",font:"styled"}]};i.archetypes.menu={layer:1,instructions:[{command:"applyScale",scale:i.inGameGuiScale},{command:"renderSprite",spritePath:"textures/shdw_menu_button.dds",scale:1},
{command:"renderSVG",svgPath:"gui/shape_button.svg",colorString:k.strings.brightNormal},{command:"renderSVG",svgPath:"gui/shape_button_lowlight.svg",colorString:k.strings.darkNormal},{command:"renderText",pointSize:26,text:"MENU",font:"styled"}]};i.archetypes.register={layer:1,buttonSize:[550,55],instructions:[{command:"renderSprite",spritePath:"textures/shdw_menu_button.dds",scaleX:5,scaleY:1},{command:"renderSVG",svgPath:"gui/shape_button.svg",colorString:k.strings.brightNormal,scaleX:5,scaleY:1},
{command:"renderSVG",svgPath:"gui/shape_button_lowlight.svg",colorString:k.strings.darkNormal,scaleX:5,scaleY:1},{command:"renderText",pointSize:26,text:"REGISTER TO SAVE PROGRESS",font:"styled"}]};i.archetypes.registerInstruction={layer:1,buttonSize:[550,55],instructions:[{command:"renderSprite",spritePath:"textures/shdw_menu_button.dds",scaleX:5,scaleY:3},{command:"renderSVG",svgPath:"gui/shape_button.svg",colorString:k.strings.brightNormal,scaleX:5,scaleY:4},{command:"renderSVG",svgPath:"gui/shape_button_lowlight.svg",
colorString:k.strings.darkNormal,scaleX:5,scaleY:4},{command:"renderText",pointSize:26,text:"TO SAVE YOUR PROGRESS, \n CLICK THE RED STOP BUTTON \n (IN THE BOTTOM LEFT CORNER) \n AND FOLLOW THE INSTRUCTIONS.",font:"styled"}]};i.archetypes.registerConfirmation={layer:1,buttonSize:[550,55],instructions:[{command:"renderSprite",spritePath:"textures/shdw_menu_button.dds",scaleX:5,scaleY:3},{command:"renderSVG",svgPath:"gui/shape_button.svg",colorString:k.strings.brightNormal,scaleX:5,scaleY:4},{command:"renderSVG",
svgPath:"gui/shape_button_lowlight.svg",colorString:k.strings.darkNormal,scaleX:5,scaleY:4},{command:"renderText",pointSize:26,text:"TO SAVE YOUR PROGRESS, \n PRESS THE BUTTON.",font:"styled"}]};i.archetypes.registerOK={instructions:[{command:"renderSVG",svgPath:"gui/shape_dialogue_button.svg",scaleX:0.9,scaleY:0.8,colorString:k.strings.outline},{command:"renderText",pointSize:24,color:k.normal,font:"styled",upperCase:!0}]};i.archetypes.fight={layer:1,instructions:[{command:"applyScale",scale:i.inGameGuiScale},
{command:"renderSprite",spritePath:"textures/shdw_menu_button.dds",scale:1},{command:"renderSVG",svgPath:"gui/shape_button.svg",colorString:k.strings.war},{command:"renderSVG",svgPath:"gui/shape_button_lowlight.svg",colorString:k.strings.darkWar},{command:"renderText",pointSize:26,text:"FIGHT",font:"styled"}]};i.archetypes.fightN={layer:1,instructions:[{command:"renderSprite",spritePath:"textures/shdw_menu_button.dds",scale:1},{command:"renderSVG",svgPath:"gui/shape_button.svg",colorString:k.strings.war},
{command:"renderSVG",svgPath:"gui/shape_button_lowlight.svg",colorString:k.strings.darkWar},{command:"renderText",pointSize:24,text:"FIGHT N",font:"styled"}]};i.archetypes.fightE={layer:1,instructions:[{command:"renderSprite",spritePath:"textures/shdw_menu_button.dds",scale:1},{command:"renderSVG",svgPath:"gui/shape_button.svg",colorString:k.strings.war},{command:"renderSVG",svgPath:"gui/shape_button_lowlight.svg",colorString:k.strings.darkWar},{command:"renderText",pointSize:26,text:"FIGHT E",font:"styled"}]};
i.archetypes.fightW={layer:1,instructions:[{command:"renderSprite",spritePath:"textures/shdw_menu_button.dds",scale:1},{command:"renderSVG",svgPath:"gui/shape_button.svg",colorString:k.strings.war},{command:"renderSVG",svgPath:"gui/shape_button_lowlight.svg",colorString:k.strings.darkWar},{command:"renderText",pointSize:26,text:"FIGHT W",font:"styled"}]};i.archetypes.skipPrepare={layer:1,instructions:[{command:"applyScale",scale:i.inGameGuiScale},{command:"applyPulseScale",frequency:1,amplitudeDiff:0.025},
{command:"renderSprite",spritePath:"textures/shdw_menu_button.dds",scale:1},{command:"renderSVG",svgPath:"gui/shape_button.svg",colorString:k.strings.war},{command:"renderSVG",svgPath:"gui/shape_button_lowlight.svg",colorString:k.strings.darkWar},{command:"renderText",pointSize:26,text:"SKIP",font:"styled"}]};i.archetypes.rank={layer:1,instructions:[{command:"applyScale",scale:i.inGameGuiScale},{command:"setRenderLocation",x:-124*i.inGameGuiScale,y:53*i.inGameGuiScale,locationName:"topRight"},{command:"renderSprite",
spritePath:"textures/shdw_bar.dds",scale:1},{command:"renderSVG",svgPath:"gui/bar_r_bg.svg",colorString:k.strings.outline},{command:"offsetCentre",x:72,y:0},{command:"renderSVG",svgPath:"gui/bar_r_square.svg",colorString:k.strings.heroxp},{command:"renderSVG",svgPath:"gui/bar_r_square_lowlight.svg",colorString:k.strings.darkHeroxp},{command:"offsetCentre",x:-72,y:0},{command:"offsetCentre",x:72,y:0},{command:"renderText",font:"styled",text:"text1",align:1,pointSize:16},{command:"offsetCentre",x:-72,
y:0},{command:"offsetCentre",x:-22,y:0},{command:"renderSVG",svgPath:"gui/bar_r_100pc.svg",colorString:k.strings.lightHeroxp,scale:1},{command:"renderSVG",svgPath:"gui/bar_r_100pc.svg",colorString:k.strings.heroxp,alignX:0,scaleX:"scale1"},{command:"offsetCentre",x:-0,y:6},{command:"renderSVG",svgPath:"gui/bar_r_100pc_lowlight.svg",colorString:k.strings.darkHeroxp,alignX:0,scaleX:"scale1"},{command:"offsetCentre",x:-0,y:-6},{command:"offsetCentre",x:-61,y:0},{command:"renderText",font:"bold",text:"text2",
align:0,pointSize:16}]};i.archetypes.heroUpgradeNote={instructions:[{command:"setRenderLocation",x:-124*i.inGameGuiScale,y:60*i.inGameGuiScale,locationName:"topRight"},{command:"offsetCentre",x:0,y:80},{command:"offsetCentre",x:0,y:-17},{command:"renderText",font:"bold",text:"text1",align:1,pointSize:16},{command:"offsetCentre",x:0,y:17},{command:"offsetCentre",x:0,y:18},{command:"renderText",font:"bold",text:"text2",color:k.heroxp,align:1,pointSize:16},{command:"offsetCentre",x:0,y:-18},{command:"renderSprite",
spritePath:"textures/score_shadow.dds",scaleX:4,scaleY:3.5},{command:"renderSVG",svgPath:"gui/shape_upgrade_box.svg",colorString:k.strings.heroxp},{command:"renderSVG",svgPath:"gui/shape_upgrade_box_lowlight.svg",colorString:k.strings.outline},{command:"renderSVG",svgPath:"gui/shape_upgrade_frame.svg",colorString:k.strings.outline},{command:"offsetCentre",x:0,y:-80}]};i.archetypes.rankUpgrade={layer:1,instructions:[{command:"applyScale",scale:i.inGameGuiScale},{command:"setRenderLocation",x:-124*
i.inGameGuiScale,y:60*i.inGameGuiScale,locationName:"topRight"},{command:"renderSprite",spritePath:"textures/shdw_bar.dds",scale:1},{command:"renderSVG",svgPath:"gui/bar_r_bg.svg",colorString:k.strings.outline},{command:"offsetCentre",x:72,y:0},{command:"renderSVG",svgPath:"gui/bar_r_square.svg",colorString:k.strings.heroxp},{command:"renderSVG",svgPath:"gui/bar_r_square_lowlight.svg",colorString:k.strings.darkHeroxp},{command:"offsetCentre",x:-72,y:0},{command:"offsetCentre",x:72,y:0},{command:"renderText",
font:"styled",text:"text1",align:1,pointSize:16},{command:"offsetCentre",x:-72,y:0},{command:"offsetCentre",x:-22,y:0},{command:"renderSVG",svgPath:"gui/bar_r_100pc.svg",colorString:k.strings.lightHeroxp,scale:1},{command:"renderSVG",svgPath:"gui/bar_r_100pc.svg",colorString:k.strings.heroxp,alignX:0,scaleX:"scale1"},{command:"offsetCentre",x:-0,y:6},{command:"renderSVG",svgPath:"gui/bar_r_100pc_lowlight.svg",colorString:k.strings.darkHeroxp,alignX:0,scaleX:"scale1"},{command:"offsetCentre",x:-0,
y:-6},{command:"offsetCentre",x:-61,y:0},{command:"renderText",font:"bold",text:"text2",align:0,pointSize:16}]};i.archetypes.bannerlingIcon={instructions:[{command:"renderSprite",scale:0.5,spritePath:"textures/enemy_bannerling.dds"},{command:"offsetCentre",x:0,y:40},{command:"renderText",pointSize:24,text:"text",font:"styled"}]};i.archetypes.basicMeleeIcon={instructions:[{command:"renderSprite",scale:0.5,spritePath:"textures/enemy_basic_melee.dds"},{command:"offsetCentre",x:0,y:40},{command:"renderText",
pointSize:24,text:"text",font:"styled"}]};i.archetypes.berserkerIcon={instructions:[{command:"renderSprite",scale:0.5,spritePath:"textures/enemy_berserker.dds"},{command:"offsetCentre",x:0,y:40},{command:"renderText",pointSize:24,text:"text",font:"styled"}]};i.archetypes.bombThrowerIcon={instructions:[{command:"renderSprite",scale:0.5,spritePath:"textures/enemy_bomb_thrower.dds"},{command:"offsetCentre",x:0,y:40},{command:"renderText",pointSize:24,text:"text",font:"styled"}]};i.archetypes.chargerBossIcon=
{instructions:[{command:"renderSprite",scale:0.5,spritePath:"textures/enemy_boss.dds"},{command:"offsetCentre",x:0,y:40},{command:"renderText",pointSize:24,text:"text",font:"styled"}]};i.archetypes.chargerIcon={instructions:[{command:"renderSprite",scale:0.5,spritePath:"textures/enemy_charger.dds"},{command:"offsetCentre",x:0,y:40},{command:"renderText",pointSize:24,text:"text",font:"styled"}]};i.archetypes.miniChargerIcon={instructions:[{command:"renderSprite",spritePath:"textures/enemy_minicharger.dds"},
{command:"offsetCentre",x:40,y:0},{command:"renderText",pointSize:24,text:"text",font:"styled"}]};i.archetypes.commandoIcon={instructions:[{command:"renderSprite",scale:0.5,spritePath:"textures/enemy_commando.dds"},{command:"offsetCentre",x:0,y:40},{command:"renderText",pointSize:24,text:"text",font:"styled"}]};i.archetypes.deathIcon={instructions:[{command:"renderSprite",scale:0.5,spritePath:"textures/enemy_death.dds"},{command:"offsetCentre",x:0,y:40},{command:"renderText",pointSize:24,text:"text",
font:"styled"}]};i.archetypes.rangedIcon={instructions:[{command:"renderSprite",scale:0.5,spritePath:"textures/enemy_ranged.dds"},{command:"offsetCentre",x:0,y:40},{command:"renderText",pointSize:24,text:"text",font:"styled"}]};i.archetypes.thiefIcon={instructions:[{command:"renderSprite",scale:0.5,spritePath:"textures/enemy_thief.dds"},{command:"offsetCentre",x:0,y:40},{command:"renderText",pointSize:24,text:"text",font:"styled"}]};i.archetypes.treasureDropperIcon={instructions:[{command:"renderSprite",
scale:0.5,spritePath:"textures/enemy_treasure_dropper.dds"},{command:"offsetCentre",x:0,y:40},{command:"renderText",pointSize:24,text:"text",font:"styled"}]};i.archetypes.basicmelee_quantity={instructions:[{command:"renderSVG",svgPath:"gui/enemy_bg.svg",colorString:k.strings.enemyRed,scale:1},{command:"renderSVG",svgPath:"gui/enemy_melee.svg",colorString:k.strings.outline,scale:1},{command:"offsetCentre",x:0,y:40},{command:"renderText",pointSize:24,text:"text",font:"styled"}]};i.archetypes.ranged_quantity=
{instructions:[{command:"renderSVG",svgPath:"gui/enemy_bg.svg",colorString:k.strings.enemyRed,scale:1},{command:"renderSVG",svgPath:"gui/enemy_ranged.svg",colorString:k.strings.outline,scale:1},{command:"offsetCentre",x:0,y:40},{command:"renderText",pointSize:24,text:"text",font:"styled"}]};i.archetypes.berserker_quantity={instructions:[{command:"renderSVG",svgPath:"gui/enemy_bg.svg",colorString:k.strings.enemyRed,scale:1},{command:"renderSVG",svgPath:"gui/enemy_breacher.svg",colorString:k.strings.outline,
scale:1},{command:"offsetCentre",x:0,y:40},{command:"renderText",pointSize:24,text:"text",font:"styled"}]};i.archetypes.bombthrower_quantity={instructions:[{command:"renderSVG",svgPath:"gui/enemy_bg.svg",colorString:k.strings.enemyRed,scale:1},{command:"renderSVG",svgPath:"gui/enemy_bomb.svg",colorString:k.strings.outline,scale:1},{command:"offsetCentre",x:0,y:40},{command:"renderText",pointSize:24,text:"text",font:"styled"}]};i.archetypes.charger_quantity={instructions:[{command:"renderSVG",svgPath:"gui/enemy_bg.svg",
colorString:k.strings.enemyRed,scale:1},{command:"renderSVG",svgPath:"gui/enemy_charger.svg",colorString:k.strings.outline,scale:1},{command:"offsetCentre",x:0,y:40},{command:"renderText",pointSize:24,text:"text",font:"styled"}]};i.archetypes.charger_boss_quantity={instructions:[{command:"renderSVG",svgPath:"gui/enemy_bg.svg",colorString:k.strings.enemyRed,scale:1},{command:"renderSVG",svgPath:"gui/enemy_charger.svg",colorString:k.strings.outline,scale:1},{command:"offsetCentre",x:0,y:40},{command:"renderText",
pointSize:24,text:"text",font:"styled"}]};i.archetypes.treasuredropper_quantity={instructions:[{command:"renderSVG",svgPath:"gui/enemy_bg.svg",colorString:k.strings.enemyYellow,scale:1},{command:"renderSVG",svgPath:"gui/enemy_treasure.svg",colorString:k.strings.outline,scale:1},{command:"offsetCentre",x:0,y:40},{command:"renderText",pointSize:24,text:"text",font:"styled"}]};i.archetypes.death_quantity={instructions:[{command:"renderSVG",svgPath:"gui/enemy_bg.svg",colorString:k.strings.enemyBlack,
scale:1},{command:"renderSVG",svgPath:"gui/enemy_death.svg",colorString:k.strings.outline,scale:1},{command:"offsetCentre",x:0,y:40},{command:"renderText",pointSize:24,text:"text",font:"styled"}]};i.archetypes.commando_quantity={instructions:[{command:"renderSVG",svgPath:"gui/enemy_bg.svg",colorString:k.strings.enemyBlack,scale:1},{command:"renderSVG",svgPath:"gui/enemy_death.svg",colorString:k.strings.outline,scale:1},{command:"offsetCentre",x:0,y:40},{command:"renderText",pointSize:24,text:"text",
font:"styled"}]};i.archetypes.scoreEventFixedPosition={instructions:[{command:"setRenderLocation",x:0,y:-100,locationName:"bottom"},{command:"applyWobble",amount:2},{command:"renderSVG",svgPath:"gui/shape_points_popup.svg",colorString:k.strings.orange,scaleX:1.1,scaleY:1.2},{command:"renderText",pointSize:16,text:"text",font:"styled",colorString:k.strings.outline}]};i.archetypes.warScoreStarStatusAchieved={instructions:[{command:"offsetCentre",x:-250,y:0},{command:"renderText",pointSize:24,align:0,
text:"text",font:"bold"},{command:"offsetCentre",x:500,y:0},{command:"renderSVG",svgPath:"gui/icon_tick.svg",colorString:k.strings.green}]};i.archetypes.warScoreStarStatusUnachieved={instructions:[{command:"offsetCentre",x:-250,y:0},{command:"renderText",pointSize:24,align:0,text:"text",font:"bold"},{command:"offsetCentre",x:500,y:0},{command:"renderSVG",svgPath:"gui/icon_cross.svg",colorString:k.strings.red}]};i.archetypes.warScoreResourceBonus={instructions:[{command:"offsetCentre",x:-250,y:0},
{command:"renderText",pointSize:48,align:0,text:"text1",font:"bold"},{command:"offsetCentre",x:500,y:0},{command:"renderText",pointSize:48,align:2,text:"text2",font:"bold"}]};i.archetypes.warScoreXpBonus={instructions:[{command:"offsetCentre",x:-250,y:0},{command:"renderText",pointSize:48,align:0,text:"text1",font:"bold"},{command:"offsetCentre",x:500,y:0},{command:"renderText",pointSize:48,align:2,text:"text2",font:"bold"}]};i.archetypes.modalMessageFrame={instructions:[{command:"setRenderLocation",
x:0,y:-55,locationName:"centre"},{command:"applyWobble",amount:0.3},{command:"renderSprite",spritePath:"textures/modal_shadow.png",scale:1},{command:"renderSVG",svgPath:"gui/msg_bg.svg",colorString:k.strings.normal,scaleX:0.8,scaleY:0.8},{command:"offsetCentre",x:0,y:-126*0.8},{command:"renderSVG",svgPath:"gui/msg_bg_top.svg",colorString:k.strings.darkNormal,scaleX:0.8,scaleY:0.8},{command:"offsetCentre",x:0,y:126*0.8},{command:"offsetCentre",x:0,y:78*0.8},{command:"renderSVG",svgPath:"gui/msg_bg_bottom.svg",
colorString:k.strings.darkNormal,scaleX:0.8,scaleY:0.8},{command:"offsetCentre",x:0,y:-78*0.8},{command:"offsetCentre",x:0,y:-41.6},{command:"renderText",pointSize:32,text:"text1",font:"bold"},{command:"offsetCentre",x:0,y:4}]};i.archetypes.modalMessageBuy={instructions:[{command:"setRenderLocation",x:0,y:0,locationName:"centre"},{command:"applyWobble",amount:0.15},{command:"renderSVG",svgPath:"gui/msg_button.svg",scaleX:0.8,scaleY:0.8,colorString:k.strings.amber},{command:"renderSVG",svgPath:"gui/msg_button_lowlight.svg",
scaleX:0.8,scaleY:0.8,colorString:k.strings.darkAmber},{command:"renderText",pointSize:32,text:"BUILD USING AMBER",font:i.shopBtnFontStyle,upperCase:i.radialFontCase}]};i.archetypes.modalMessageBuyAmber={instructions:[{command:"setRenderLocation",x:0,y:0,locationName:"centre"},{command:"applyWobble",amount:0.15},{command:"renderSVG",svgPath:"gui/msg_button.svg",scaleX:0.8,scaleY:0.8,colorString:k.strings.amber},{command:"renderSVG",svgPath:"gui/msg_button_lowlight.svg",scaleX:0.8,scaleY:0.8,colorString:k.strings.darkAmber},
{command:"renderText",pointSize:32,text:"GO TO SHOP",font:i.shopBtnFontStyle,upperCase:i.radialFontCase}]};i.archetypes.costLumber={instructions:[{command:"offsetCentre",x:i.costsMasterOffsetX,y:0},{command:"offsetCentre",x:i.costResOffsetX,y:0},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:i.lumberCostScale,scaleY:0.9,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:i.lumberCostScale,scaleY:0.9,colorString:k.strings.lumber},
{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.costStone={instructions:[{command:"offsetCentre",x:i.costsMasterOffsetX,y:0},{command:"offsetCentre",x:i.costResOffsetX,y:0},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:i.stoneCostScale,scaleY:0.9,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:i.stoneCostScale,scaleY:0.9,
colorString:k.strings.stone},{command:"renderText",pointSize:i.radialFont,text:"text3",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.costAmber={instructions:[{command:"offsetCentre",x:i.costsMasterOffsetX,y:0},{command:"offsetCentre",x:i.costResOffsetX,y:0},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:i.amberCostScale,scaleY:0.9,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",
scaleX:i.amberCostScale,scaleY:0.9,colorString:k.strings.amber},{command:"renderText",pointSize:i.radialFont,text:"text4",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.costTime={instructions:[{command:"offsetCentre",x:i.costTimeOffsetX,y:0},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:i.timeCostScale,scaleY:0.9,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:i.timeCostScale,
scaleY:0.9,colorString:k.strings.darkGreen},{command:"offsetCentre",x:1,y:0},{command:"renderText",pointSize:i.radialFont,text:"text5",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:-1,y:0}]};i.archetypes.radShad={instructions:[{command:"renderSprite",spritePath:"textures/shdw_circular.dds",scale:1.25}]};i.archetypes.buildTop={instructions:[{command:"renderWidget",name:"radShad"},{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},
{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_hammer.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},
{command:"offsetCentre",x:0,y:50},{command:"applyTextScale",textBoxWidth:120,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:1,colorString:k.strings.outline},{command:"unApplyTextScale",text:"text1",textBoxWidth:120},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.darkGreen,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:i.costDoubleOffsetY}]};i.archetypes.buildLumber={instructions:[{command:"renderWidget",
name:"buildTop"},{command:"renderWidget",name:"costLumber"},{command:"renderWidget",name:"costTime"}]};i.archetypes.buildStone={instructions:[{command:"renderWidget",name:"buildTop"},{command:"renderWidget",name:"costStone"},{command:"renderWidget",name:"costTime"}]};i.archetypes.buildAmber={instructions:[{command:"renderWidget",name:"buildTop"},{command:"renderWidget",name:"costAmber"},{command:"renderWidget",name:"costTime"}]};i.archetypes.buildInvalidTop={instructions:[{command:"renderWidget",
name:"radShad"},{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.invalid},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkInvalid},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",
svgPath:"gui/icon_hammer.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:50},{command:"applyTextScale",textBoxWidth:120,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:1,colorString:k.strings.outline},{command:"unApplyTextScale",text:"text1",textBoxWidth:120},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.invalid,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",
x:30,y:-75},{command:"renderSVG",svgPath:"gui/shape_invalid_bg.svg",scale:1,colorString:k.strings.outline},{command:"renderSVG",svgPath:"gui/shape_invalid.svg",scale:1,colorString:k.strings.orange},{command:"offsetCentre",x:-30,y:75},{command:"offsetCentre",x:0,y:i.costDoubleOffsetY}]};i.archetypes.buildInvalidLumber={instructions:[{command:"renderWidget",name:"buildInvalidTop"},{command:"renderWidget",name:"costLumber"},{command:"renderWidget",name:"costTime"}]};i.archetypes.buildInvalidStone={instructions:[{command:"renderWidget",
name:"buildInvalidTop"},{command:"renderWidget",name:"costStone"},{command:"renderWidget",name:"costTime"}]};i.archetypes.buildInvalidAmber={instructions:[{command:"renderWidget",name:"buildInvalidTop"},{command:"renderWidget",name:"costAmber"},{command:"renderWidget",name:"costTime"}]};i.archetypes.buildInvalidTopCantAfford={instructions:[{command:"renderWidget",name:"radShad"},{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",
scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_hammer.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,
y:50},{command:"applyTextScale",textBoxWidth:120,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:1,colorString:k.strings.outline},{command:"unApplyTextScale",text:"text1",textBoxWidth:120},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.darkGreen,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:30,y:-75},{command:"renderSVG",svgPath:"gui/shape_invalid_bg.svg",scale:1,colorString:k.strings.outline},{command:"renderSVG",
svgPath:"gui/shape_invalid_fore.svg",scale:1,colorString:k.strings.amber},{command:"renderSVG",svgPath:"gui/icon_plus.svg",scale:0.38,colorString:k.strings.outline},{command:"offsetCentre",x:-30,y:75},{command:"offsetCentre",x:0,y:i.costDoubleOffsetY}]};i.archetypes.buildInvalidLumberCantAfford={instructions:[{command:"renderWidget",name:"buildInvalidTopCantAfford"},{command:"renderWidget",name:"costLumber"},{command:"renderWidget",name:"costTime"}]};i.archetypes.buildInvalidStoneCantAfford={instructions:[{command:"renderWidget",
name:"buildInvalidTopCantAfford"},{command:"renderWidget",name:"costStone"},{command:"renderWidget",name:"costTime"}]};i.archetypes.buildInvalidAmberCantAfford={instructions:[{command:"renderWidget",name:"buildInvalidTopCantAfford"},{command:"renderWidget",name:"costAmber"},{command:"renderWidget",name:"costTime"}]};i.archetypes.upgradeTop={instructions:[{command:"renderWidget",name:"radShad"},{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",
scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_upgrade.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,
y:40},{command:"applyTextScale",textBoxWidth:120,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:0.7,colorString:k.strings.outline},{command:"unApplyTextScale",text:"text1",textBoxWidth:120},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.darkGreen,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:i.costSingleOffsetY}]};i.archetypes.upgradeLumber={instructions:[{command:"renderWidget",name:"upgradeTop"},{command:"renderWidget",
name:"costLumber"},{command:"renderWidget",name:"costTime"}]};i.archetypes.upgradeStone={instructions:[{command:"renderWidget",name:"upgradeTop"},{command:"renderWidget",name:"costStone"},{command:"renderWidget",name:"costTime"}]};i.archetypes.upgradeInvalidTop={instructions:[{command:"renderWidget",name:"radShad"},{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},
{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.invalid},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkInvalid},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_upgrade.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:50},{command:"applyTextScale",textBoxWidth:120,text:"text1"},
{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:1,colorString:k.strings.outline},{command:"unApplyTextScale",text:"text1",textBoxWidth:120},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.invalid,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:30,y:-75},{command:"renderSVG",svgPath:"gui/shape_invalid_bg.svg",scale:1,colorString:k.strings.outline},{command:"renderSVG",svgPath:"gui/shape_invalid.svg",scale:1,colorString:k.strings.orange},
{command:"offsetCentre",x:-30,y:75},{command:"offsetCentre",x:0,y:i.costDoubleOffsetY}]};i.archetypes.upgradeInvalidLumber={instructions:[{command:"renderWidget",name:"upgradeInvalidTop"},{command:"renderWidget",name:"costLumber"},{command:"renderWidget",name:"costTime"}]};i.archetypes.upgradeInvalidStone={instructions:[{command:"renderWidget",name:"upgradeInvalidTop"},{command:"renderWidget",name:"costStone"},{command:"renderWidget",name:"costTime"}]};i.archetypes.upgradeInvalidAmber={instructions:[{command:"renderWidget",
name:"upgradeInvalidTop"},{command:"renderWidget",name:"costAmber"},{command:"renderWidget",name:"costTime"}]};i.archetypes.upgradeInvalidTopCantAfford={instructions:[{command:"renderWidget",name:"radShad"},{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",
svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_upgrade.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:50},{command:"applyTextScale",textBoxWidth:120,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:1,colorString:k.strings.outline},{command:"unApplyTextScale",
text:"text1",textBoxWidth:120},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.darkGreen,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:30,y:-75},{command:"renderSVG",svgPath:"gui/shape_invalid_bg.svg",scale:1,colorString:k.strings.outline},{command:"renderSVG",svgPath:"gui/shape_invalid_fore.svg",scale:1,colorString:k.strings.amber},{command:"renderSVG",svgPath:"gui/icon_plus.svg",scale:0.38,colorString:k.strings.outline},{command:"offsetCentre",x:-30,
y:75},{command:"offsetCentre",x:0,y:i.costDoubleOffsetY}]};i.archetypes.upgradeInvalidLumberCantAfford={instructions:[{command:"renderWidget",name:"upgradeInvalidTopCantAfford"},{command:"renderWidget",name:"costLumber"},{command:"renderWidget",name:"costTime"}]};i.archetypes.upgradeInvalidStoneCantAfford={instructions:[{command:"renderWidget",name:"upgradeInvalidTopCantAfford"},{command:"renderWidget",name:"costStone"},{command:"renderWidget",name:"costTime"}]};i.archetypes.upgradeInvalidAmberCantAfford=
{instructions:[{command:"renderWidget",name:"upgradeInvalidTopCantAfford"},{command:"renderWidget",name:"costAmber"},{command:"renderWidget",name:"costTime"}]};i.archetypes.upgradeBatchTop={instructions:[{command:"renderWidget",name:"radShad"},{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},
{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_upgrade_batch.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:40},{command:"applyTextScale",textBoxWidth:120,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:1,colorString:k.strings.outline},
{command:"unApplyTextScale",text:"text1",textBoxWidth:120},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.darkGreen,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:i.costDoubleOffsetY}]};i.archetypes.upgradeBatchLumber={instructions:[{command:"renderWidget",name:"upgradeBatchTop"},{command:"renderWidget",name:"costLumber"},{command:"renderWidget",name:"costTime"}]};i.archetypes.upgradeBatchStone={instructions:[{command:"renderWidget",name:"upgradeBatchTop"},
{command:"renderWidget",name:"costStone"},{command:"renderWidget",name:"costTime"}]};i.archetypes.upgradeBatchInvalidTop={instructions:[{command:"renderWidget",name:"radShad"},{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.invalid},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",
scale:0.8,colorString:k.strings.darkInvalid},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_upgrade_batch.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:50},{command:"applyTextScale",textBoxWidth:120,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:1,colorString:k.strings.outline},{command:"unApplyTextScale",text:"text1",
textBoxWidth:120},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.invalid,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:30,y:-75},{command:"renderSVG",svgPath:"gui/shape_invalid_bg.svg",scale:1,colorString:k.strings.outline},{command:"renderSVG",svgPath:"gui/shape_invalid.svg",scale:1,colorString:k.strings.orange},{command:"offsetCentre",x:-30,y:75},{command:"offsetCentre",x:0,y:i.costDoubleOffsetY}]};i.archetypes.upgradeBatchInvalidLumber={instructions:[{command:"renderWidget",
name:"upgradeBatchInvalidTop"},{command:"renderWidget",name:"costLumber"},{command:"renderWidget",name:"costTime"}]};i.archetypes.upgradeBatchInvalidStone={instructions:[{command:"renderWidget",name:"upgradeBatchInvalidTop"},{command:"renderWidget",name:"costStone"},{command:"renderWidget",name:"costTime"}]};i.archetypes.upgradeBatchInvalidAmber={instructions:[{command:"renderWidget",name:"upgradeBatchInvalidTop"},{command:"renderWidget",name:"costAmber"},{command:"renderWidget",name:"costTime"}]};
i.archetypes.upgradeBatchInvalidTopCantAfford={instructions:[{command:"renderWidget",name:"radShad"},{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",
factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_upgrade_batch.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:50},{command:"applyTextScale",textBoxWidth:120,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:1,colorString:k.strings.outline},{command:"unApplyTextScale",text:"text1",textBoxWidth:120},{command:"renderText",pointSize:i.radialFont,text:"text1",
color:k.darkGreen,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:30,y:-75},{command:"renderSVG",svgPath:"gui/shape_invalid_bg.svg",scale:1,colorString:k.strings.outline},{command:"renderSVG",svgPath:"gui/shape_invalid_fore.svg",scale:1,colorString:k.strings.amber},{command:"renderSVG",svgPath:"gui/icon_plus.svg",scale:0.38,colorString:k.strings.outline},{command:"offsetCentre",x:-30,y:75},{command:"offsetCentre",x:0,y:i.costDoubleOffsetY}]};i.archetypes.upgradeBatchInvalidLumberCantAfford=
{instructions:[{command:"renderWidget",name:"upgradeBatchInvalidTopCantAfford"},{command:"renderWidget",name:"costLumber"},{command:"renderWidget",name:"costTime"}]};i.archetypes.upgradeBatchInvalidStoneCantAfford={instructions:[{command:"renderWidget",name:"upgradeBatchInvalidTopCantAfford"},{command:"renderWidget",name:"costStone"},{command:"renderWidget",name:"costTime"}]};i.archetypes.upgradeBatchInvalidAmberCantAfford={instructions:[{command:"renderWidget",name:"upgradeBatchInvalidTopCantAfford"},
{command:"renderWidget",name:"costAmber"},{command:"renderWidget",name:"costTime"}]};i.archetypes.repairTop={instructions:[{command:"renderWidget",name:"radShad"},{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",
scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_spanner.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:50},{command:"applyTextScale",textBoxWidth:120,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:1,colorString:k.strings.outline},{command:"unApplyTextScale",text:"text1",textBoxWidth:120},
{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.darkGreen,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:i.costDoubleOffsetY}]};i.archetypes.repairLumber={instructions:[{command:"renderWidget",name:"repairTop"},{command:"offsetCentre",x:31,y:0},{command:"renderWidget",name:"costLumber"}]};i.archetypes.repairStone={instructions:[{command:"renderWidget",name:"repairTop"},{command:"offsetCentre",x:31,y:0},{command:"renderWidget",name:"costStone"}]};
i.archetypes.repairLumberAndStone={instructions:[{command:"renderWidget",name:"repairTop"},{command:"offsetCentre",x:0,y:0},{command:"renderWidget",name:"costLumber"},{command:"offsetCentre",x:104,y:0},{command:"renderWidget",name:"costStone"}]};i.archetypes.repairInvalidTop={instructions:[{command:"renderWidget",name:"radShad"},{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,
border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_spanner.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:50},{command:"applyTextScale",textBoxWidth:120,
text:"text1"},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:1,colorString:k.strings.outline},{command:"unApplyTextScale",text:"text1",textBoxWidth:120},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.darkGreen,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:30,y:-75},{command:"renderSVG",svgPath:"gui/shape_invalid_bg.svg",scale:1,colorString:k.strings.outline},{command:"renderSVG",svgPath:"gui/shape_invalid_fore.svg",scale:1,
colorString:k.strings.amber},{command:"renderSVG",svgPath:"gui/icon_plus.svg",scale:0.38,colorString:k.strings.outline},{command:"offsetCentre",x:-30,y:75},{command:"offsetCentre",x:0,y:i.costDoubleOffsetY}]};i.archetypes.repairInvalidLumber={instructions:[{command:"renderWidget",name:"repairInvalidTop"},{command:"offsetCentre",x:31,y:0},{command:"renderWidget",name:"costLumber"}]};i.archetypes.repairInvalidStone={instructions:[{command:"renderWidget",name:"repairInvalidTop"},{command:"offsetCentre",
x:31,y:0},{command:"renderWidget",name:"costStone"}]};i.archetypes.repairWithAmberLumberAndStone={instructions:[{command:"renderWidget",name:"repairInvalidTop"},{command:"renderWidget",name:"costLumber"},{command:"offsetCentre",x:105,y:0},{command:"renderWidget",name:"costStone"}]};i.archetypes.repairInvalidLumberAndStone={instructions:[{command:"renderWidget",name:"radShad"},{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",
scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.invalid},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkInvalid},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_spanner.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",
x:0,y:50},{command:"applyTextScale",textBoxWidth:120,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:1,colorString:k.strings.outline},{command:"unApplyTextScale",text:"text1",textBoxWidth:120},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.invalid,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:i.costDoubleOffsetY}]};i.archetypes.unlockTop={instructions:[{command:"renderWidget",name:"radShad"},{command:"applyWobble",
amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_research.svg",
scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:50},{command:"applyTextScale",textBoxWidth:120,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:1,colorString:k.strings.outline},{command:"unApplyTextScale",text:"text1",textBoxWidth:120},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.darkGreen,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:i.costDoubleOffsetY}]};
i.archetypes.unlockLumber={instructions:[{command:"renderWidget",name:"unlockTop"},{command:"renderWidget",name:"costLumber"},{command:"renderWidget",name:"costTime"}]};i.archetypes.unlockStone={instructions:[{command:"renderWidget",name:"unlockTop"},{command:"renderWidget",name:"costStone"},{command:"renderWidget",name:"costTime"}]};i.archetypes.unlockInvalidTop={instructions:[{command:"renderWidget",name:"radShad"},{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",
svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.invalid},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkInvalid},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_research.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},
{command:"offsetCentre",x:0,y:50},{command:"applyTextScale",textBoxWidth:120,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:1,colorString:k.strings.outline},{command:"unApplyTextScale",text:"text1",textBoxWidth:120},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.invalid,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:30,y:-75},{command:"renderSVG",svgPath:"gui/shape_invalid_bg.svg",scale:1,colorString:k.strings.outline},
{command:"renderSVG",svgPath:"gui/shape_invalid.svg",scale:1,colorString:k.strings.orange},{command:"offsetCentre",x:-30,y:75},{command:"offsetCentre",x:0,y:i.costDoubleOffsetY}]};i.archetypes.unlockInvalidLumber={instructions:[{command:"renderWidget",name:"unlockInvalidTop"},{command:"renderWidget",name:"costLumber"},{command:"renderWidget",name:"costTime"}]};i.archetypes.unlockInvalidStone={instructions:[{command:"renderWidget",name:"unlockInvalidTop"},{command:"renderWidget",name:"costStone"},
{command:"renderWidget",name:"costTime"}]};i.archetypes.unlockComplete={instructions:[{command:"renderWidget",name:"unlockInvalidTop"}]};i.archetypes.unlockInvalidTopCantAfford={instructions:[{command:"renderWidget",name:"radShad"},{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.normal},
{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkNormal},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_research.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"offsetCentre",x:0,y:50},{command:"applyTextScale",textBoxWidth:120,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:1,colorString:k.strings.outline},
{command:"unApplyTextScale",text:"text1",textBoxWidth:120},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.darkGreen,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:30,y:-75},{command:"renderSVG",svgPath:"gui/shape_invalid_bg.svg",scale:1,colorString:k.strings.outline},{command:"renderSVG",svgPath:"gui/shape_invalid_fore.svg",scale:1,colorString:k.strings.amber},{command:"renderSVG",svgPath:"gui/icon_plus.svg",scale:0.38,colorString:k.strings.outline},
{command:"offsetCentre",x:-30,y:75},{command:"offsetCentre",x:0,y:i.costDoubleOffsetY}]};i.archetypes.unlockInvalidLumberCantAfford={instructions:[{command:"renderWidget",name:"unlockInvalidTopCantAfford"},{command:"renderWidget",name:"costLumber"},{command:"renderWidget",name:"costTime"}]};i.archetypes.unlockInvalidStoneCantAfford={instructions:[{command:"renderWidget",name:"unlockInvalidTopCantAfford"},{command:"renderWidget",name:"costStone"},{command:"renderWidget",name:"costTime"}]};i.archetypes.unlockInvalidAmberCantAfford=
{instructions:[{command:"renderWidget",name:"unlockInvalidTopCantAfford"},{command:"renderWidget",name:"costAmber"},{command:"renderWidget",name:"costTime"}]};i.archetypes.heroUpgradeValid={instructions:[{command:"renderWidget",name:"radShad"},{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"applySpinRotate",angle:0.1},{command:"renderSprite",spritePath:"textures/burst_faint.dds",scale:0.35},{command:"applySpinRotate",angle:-0.1},{command:"applySpinRotate",angle:0.05},
{command:"renderSprite",spritePath:"textures/burst_faint.dds",scale:0.3},{command:"applySpinRotate",angle:-0.05},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.heroxp},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkHeroxp},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},
{command:"renderSVG",svgPath:"gui/icon_totem_bg.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"renderSVG",svgPathVar:"svg1",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.heroxp},{command:"offsetCentre",x:0,y:50},{command:"applyTextScale",textBoxWidth:120,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:1,colorString:k.strings.outline},{command:"unApplyTextScale",text:"text1",textBoxWidth:120},{command:"renderText",
pointSize:i.radialFont,text:"text1",color:k.darkGreen,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.heroUpgradeInvalid={instructions:[{command:"renderWidget",name:"radShad"},{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.invalidHeroxp},{command:"renderSVG",
svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.invalidDarkHeroxp},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_totem_bg.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"renderSVG",svgPathVar:"svg1",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.invalidHeroxp},{command:"offsetCentre",x:0,y:50},{command:"applyTextScale",textBoxWidth:120,text:"text1"},
{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:1,colorString:k.strings.outline},{command:"unApplyTextScale",text:"text1",textBoxWidth:120},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.invalid,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:30,y:-75},{command:"renderSVG",svgPath:"gui/shape_invalid_bg.svg",scale:1,colorString:k.strings.outline},{command:"renderSVG",svgPath:"gui/shape_invalid.svg",scale:1,colorString:k.strings.orange}]};
i.archetypes.heroUpgradeUsingAmber={instructions:[{command:"renderWidget",name:"radShad"},{command:"applyWobble",amount:i.radialMotion},{command:"applyRandomRotate"},{command:"applySpinRotate",angle:0.1},{command:"renderSprite",spritePath:"textures/burst_faint.dds",scale:0.35},{command:"applySpinRotate",angle:-0.1},{command:"applySpinRotate",angle:0.05},{command:"renderSprite",spritePath:"textures/burst_faint.dds",scale:0.3},{command:"applySpinRotate",angle:-0.05},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",
scale:0.8,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",svgPath:"gui/shape_pentagon.svg",scale:0.8,colorString:k.strings.heroxp},{command:"renderSVG",svgPath:"gui/shape_pentagon_lowlight.svg",scale:0.8,colorString:k.strings.darkHeroxp},{command:"applyRandomRotate",factor:-1},{command:"applyWobble",amount:i.radialMotionSec},{command:"renderSVG",svgPath:"gui/icon_totem_bg.svg",scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.outline},{command:"renderSVG",svgPathVar:"svg1",
scaleX:i.radialIcon,scaleY:i.radialIcon,colorString:k.strings.heroxp},{command:"offsetCentre",x:0,y:50},{command:"applyTextScale",textBoxWidth:120,text:"text1"},{command:"renderSVG",svgPath:"gui/shape_rectangle_radial.svg",scaleX:1,scaleY:1,colorString:k.strings.outline},{command:"unApplyTextScale",text:"text1",textBoxWidth:120},{command:"renderText",pointSize:i.radialFont,text:"text1",color:k.darkGreen,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:30,y:-75},{command:"renderSVG",
svgPath:"gui/shape_invalid_bg.svg",scale:1,colorString:k.strings.outline},{command:"renderSVG",svgPath:"gui/shape_invalid_fore.svg",scale:1,colorString:k.strings.amber},{command:"renderSVG",svgPath:"gui/icon_plus.svg",scale:0.38,colorString:k.strings.outline},{command:"offsetCentre",x:-30,y:75},{command:"offsetCentre",x:0,y:i.costDoubleOffsetY},{command:"renderSVG",svgPath:"gui/shape_resource_float.svg",scaleX:i.amberCostScale,scaleY:0.9,colorString:k.strings.outline,border:i.borderWidth},{command:"renderSVG",
svgPath:"gui/shape_resource_float.svg",scaleX:i.amberCostScale,scaleY:0.9,colorString:k.strings.amber},{command:"renderText",pointSize:i.radialFont,text:"text4",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase}]};i.archetypes.tipHq={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:1.2,scaleY:1,colorString:k.strings.tipYellow},
{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.7,scaleY:1,colorString:k.strings.tipDarkYellow},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,
scaleY:1,colorString:k.strings.tipDarkYellow},{command:"offsetCentre",x:0,y:-46}]};i.archetypes.tipWorkshop={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:1.2,scaleY:1,colorString:k.strings.tipPurple},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",
x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.7,scaleY:1,colorString:k.strings.tipDarkPurple},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkPurple},{command:"offsetCentre",x:0,y:-20}]};i.archetypes.tipBuildlingHut={instructions:[{command:"applyWobble",
amount:i.radialMotion},{command:"offsetCentre",x:0,y:-85},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:1.2,scaleY:1,colorString:k.strings.tipPurple},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:20},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipPurple},{command:"offsetCentre",
x:0,y:-20}]};i.archetypes.tipBuildling={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-85},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.9,scaleY:1,colorString:k.strings.tipPurple},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:20},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",
scaleX:1,scaleY:1,colorString:k.strings.tipPurple},{command:"offsetCentre",x:0,y:-20}]};i.archetypes.tipMarketplace={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-85},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:1.2,scaleY:1,colorString:k.strings.amber},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",
x:0,y:20},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.amber},{command:"offsetCentre",x:0,y:-20}]};i.archetypes.tipStoneTower={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:1.1,scaleY:1,colorString:k.strings.tipPurple},{command:"renderText",pointSize:16,text:"text1",color:k.outline,
font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.7,scaleY:1,colorString:k.strings.tipDarkPurple},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkPurple},{command:"offsetCentre",
x:0,y:-46}]};i.archetypes.tipStoneWall={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:1.1,scaleY:1,colorString:k.strings.tipPurple},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",
scaleX:0.7,scaleY:1,colorString:k.strings.tipDarkPurple},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkPurple},{command:"offsetCentre",x:0,y:-46}]};i.archetypes.tipLumbermill={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",
x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:1,scaleY:1,colorString:k.strings.tipGreen},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.7,scaleY:1,colorString:k.strings.tipDarkGreen},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,
font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkGreen},{command:"offsetCentre",x:0,y:-46}]};i.archetypes.tipLumberStorage={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",
scaleX:1.3,scaleY:1,colorString:k.strings.tipGreen},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.7,scaleY:1,colorString:k.strings.tipDarkGreen},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",
svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkGreen},{command:"offsetCentre",x:0,y:-46}]};i.archetypes.tipLumberlingHut={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:1.3,scaleY:1,colorString:k.strings.tipGreen},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,
upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.7,scaleY:1,colorString:k.strings.tipDarkGreen},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkGreen},{command:"offsetCentre",x:0,y:-46}]};i.archetypes.tipLumberling=
{instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:1,scaleY:1,colorString:k.strings.tipGreen},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.7,scaleY:1,colorString:k.strings.tipDarkGreen},
{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkGreen},{command:"offsetCentre",x:0,y:-46}]};i.archetypes.tipStonemill={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",
scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.9,scaleY:1,colorString:k.strings.tipBlue},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.7,scaleY:1,colorString:k.strings.tipDarkBlue},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",
x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkBlue},{command:"offsetCentre",x:0,y:-46}]};i.archetypes.tipStonelingHut={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:1.3,scaleY:1,colorString:k.strings.tipBlue},{command:"renderText",pointSize:16,
text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.7,scaleY:1,colorString:k.strings.tipDarkBlue},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkBlue},
{command:"offsetCentre",x:0,y:-46}]};i.archetypes.tipStoneling={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.95,scaleY:1,colorString:k.strings.tipBlue},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",
scaleX:0.7,scaleY:1,colorString:k.strings.tipDarkBlue},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkBlue},{command:"offsetCentre",x:0,y:-46}]};i.archetypes.tipStoneStorage={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",
x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:1.3,scaleY:1,colorString:k.strings.tipBlue},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.7,scaleY:1,colorString:k.strings.tipDarkBlue},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,
font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkBlue},{command:"offsetCentre",x:0,y:-46}]};i.archetypes.tipDefenceFactory={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",
scaleX:1.4,scaleY:1,colorString:k.strings.tipOrange},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.7,scaleY:1,colorString:k.strings.tipDarkOrange},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",
svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkOrange},{command:"offsetCentre",x:0,y:-46}]};i.archetypes.tipDefendlingHut={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:1.3,scaleY:1,colorString:k.strings.tipOrange},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,
upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.7,scaleY:1,colorString:k.strings.tipDarkOrange},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkOrange},{command:"offsetCentre",x:0,y:-46}]};
i.archetypes.tipDefendling={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:1,scaleY:1,colorString:k.strings.tipOrange},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.7,scaleY:1,
colorString:k.strings.tipDarkOrange},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkOrange},{command:"offsetCentre",x:0,y:-46}]};i.archetypes.tipOutpost={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",
spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.9,scaleY:1,colorString:k.strings.tipOrange},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.7,scaleY:1,colorString:k.strings.tipDarkOrange},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},
{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkOrange},{command:"offsetCentre",x:0,y:-46}]};i.archetypes.tipLibrary={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:1,scaleY:1,colorString:k.strings.tipOrange},{command:"renderText",
pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.7,scaleY:1,colorString:k.strings.tipDarkOrange},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkOrange},
{command:"offsetCentre",x:0,y:-46}]};i.archetypes.tipTotem={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.9,scaleY:1,colorString:k.strings.tipPurple},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"applyTextScale",
boxWidth:100,boxHeight:30,text:"text2"},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkPurple},{command:"unApplyTextScale",text:"text2"},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkPurple},{command:"offsetCentre",
x:0,y:-46}]};i.archetypes.tipGatling={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.8,scaleY:1,colorString:k.strings.tipOrange},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.7,
scaleY:1,colorString:k.strings.tipDarkOrange},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkOrange},{command:"offsetCentre",x:0,y:-46}]};i.archetypes.tipMortarling={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},
{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:1.1,scaleY:1,colorString:k.strings.tipOrange},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.7,scaleY:1,colorString:k.strings.tipDarkOrange},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,
upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkOrange},{command:"offsetCentre",x:0,y:-46}]};i.archetypes.tipStunling={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.9,scaleY:1,colorString:k.strings.tipOrange},
{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.7,scaleY:1,colorString:k.strings.tipDarkOrange},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,
scaleY:1,colorString:k.strings.tipDarkOrange},{command:"offsetCentre",x:0,y:-46}]};i.archetypes.tipWoodenBarricade={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:1.6,scaleY:1,colorString:k.strings.tipOrange},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",
x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.7,scaleY:1,colorString:k.strings.tipDarkOrange},{command:"renderText",pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkOrange},{command:"offsetCentre",x:0,y:-46}]};i.archetypes.tipWoodenGate={instructions:[{command:"applyWobble",
amount:i.radialMotion},{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:1.2,scaleY:1,colorString:k.strings.tipOrange},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:26},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.7,scaleY:1,colorString:k.strings.tipDarkOrange},{command:"renderText",
pointSize:i.radialFont,text:"text2",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-26},{command:"offsetCentre",x:0,y:46},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipDarkOrange},{command:"offsetCentre",x:0,y:-46}]};i.archetypes.tipIconTraps={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-85},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},
{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.65,scaleY:1,colorString:k.strings.tipOrange},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:20},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipOrange},{command:"offsetCentre",x:0,y:-20}]};i.archetypes.tipIconBarricades={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",
x:0,y:-85},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:1,scaleY:1,colorString:k.strings.tipOrange},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:20},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipOrange},{command:"offsetCentre",x:0,y:-20}]};i.archetypes.tipIconTowers={instructions:[{command:"applyWobble",
amount:i.radialMotion},{command:"offsetCentre",x:0,y:-85},{command:"renderSprite",spritePath:"textures/tip_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/tip_box.svg",scaleX:0.8,scaleY:1,colorString:k.strings.tipOrange},{command:"renderText",pointSize:16,text:"text1",color:k.outline,font:i.radialFontStyle,upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:20},{command:"renderSVG",svgPath:"gui/tip_arrow.svg",scaleX:1,scaleY:1,colorString:k.strings.tipOrange},{command:"offsetCentre",
x:0,y:-20}]};i.archetypes.offScreenTreasure={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"offsetCentre",x:0,y:-0},{command:"renderSprite",spritePath:"textures/offscreen_enemy_treasure.dds",scale:1}]};i.archetypes.offScreenBuildingDamaged={instructions:[{command:"applyWobble",amount:i.radialMotion},{command:"renderSprite",spritePath:"textures/speech_shadow.dds",scale:0.5},{command:"renderSVG",svgPath:"gui/shape_warning.svg",scaleX:0.7,scaleY:0.7,colorString:k.strings.war},
{command:"renderSVG",svgPath:"gui/icon_building_warning.svg",scaleX:0.7,scaleY:0.7,colorString:k.strings.outline}]};i.archetypes.welcomeLumber={layer:0,instructions:[{command:"applyWobble",amount:i.speechMotion},{command:"offsetCentre",x:0,y:-60},{command:"offsetCentre",x:-6,y:0},{command:"renderSprite",spritePath:"textures/speech_shadow.dds",scale:0.6},{command:"offsetCentre",x:4,y:0},{command:"offsetCentre",x:0,y:5},{command:"renderSVG",svgPath:"gui/shape_speech.svg",scale:0.8,colorString:k.strings.lumber},
{command:"offsetCentre",x:0,y:-7},{command:"renderSVG",svgPath:"gui/icon_exclaim.svg",scale:0.4,colorString:k.strings.outline}]};i.archetypes.welcomeStone={layer:0,instructions:[{command:"applyWobble",amount:i.speechMotion},{command:"offsetCentre",x:0,y:-60},{command:"offsetCentre",x:-6,y:0},{command:"renderSprite",spritePath:"textures/speech_shadow.dds",scale:0.6},{command:"offsetCentre",x:4,y:0},{command:"offsetCentre",x:0,y:5},{command:"renderSVG",svgPath:"gui/shape_speech.svg",scale:0.8,colorString:k.strings.stone},
{command:"offsetCentre",x:0,y:-7},{command:"renderSVG",svgPath:"gui/icon_exclaim.svg",scale:0.4,colorString:k.strings.outline}]};i.archetypes.welcomeAmber={layer:0,instructions:[{command:"applyWobble",amount:i.speechMotion},{command:"offsetCentre",x:0,y:-100},{command:"applySpinRotate",angle:0.15},{command:"renderSprite",spritePath:"textures/burst_faint.dds",scale:0.22},{command:"applySpinRotate",angle:-0.15},{command:"applySpinRotate",angle:0.07},{command:"renderSprite",spritePath:"textures/burst_faint.dds",
scale:0.18},{command:"applySpinRotate",angle:-0.07},{command:"offsetCentre",x:-6,y:0},{command:"renderSprite",spritePath:"textures/speech_shadow.dds",scale:0.6},{command:"offsetCentre",x:4,y:0},{command:"offsetCentre",x:0,y:5},{command:"renderSVG",svgPath:"gui/shape_speech.svg",scale:0.8,colorString:k.strings.amber},{command:"offsetCentre",x:0,y:-7},{command:"renderSVG",svgPath:"gui/icon_exclaim.svg",scale:0.4,colorString:k.strings.outline}]};i.archetypes.welcomeBuilding={layer:0,instructions:[{command:"applyWobble",
amount:i.speechMotion},{command:"offsetCentre",x:0,y:-60},{command:"offsetCentre",x:-6,y:0},{command:"renderSprite",spritePath:"textures/speech_shadow.dds",scale:0.6},{command:"offsetCentre",x:4,y:0},{command:"offsetCentre",x:0,y:5},{command:"renderSVG",svgPath:"gui/shape_speech.svg",scale:0.8,colorString:k.strings.purple},{command:"offsetCentre",x:0,y:-7},{command:"renderSVG",svgPath:"gui/icon_exclaim.svg",scale:0.4,colorString:k.strings.outline}]};i.archetypes.welcomeDefences={layer:0,instructions:[{command:"applyWobble",
amount:i.speechMotion},{command:"offsetCentre",x:0,y:-60},{command:"offsetCentre",x:-6,y:0},{command:"renderSprite",spritePath:"textures/speech_shadow.dds",scale:0.6},{command:"offsetCentre",x:4,y:0},{command:"offsetCentre",x:0,y:5},{command:"renderSVG",svgPath:"gui/shape_speech.svg",scale:0.8,colorString:k.strings.orange},{command:"offsetCentre",x:0,y:-7},{command:"renderSVG",svgPath:"gui/icon_exclaim.svg",scale:0.4,colorString:k.strings.outline}]};i.archetypes.burstWidget={instructions:[{command:"applySpinRotate",
angle:0.2},{command:"renderSprite",spritePath:"textures/burst_faint.dds",scale:1.2},{command:"applySpinRotate",angle:-0.2},{command:"applySpinRotate",angle:0.1},{command:"renderSprite",spritePath:"textures/burst_faint.dds",scale:0.8},{command:"applySpinRotate",angle:-0.1}]};i.archetypes.burstWidgetSmall={instructions:[{command:"applySpinRotate",angle:0.2},{command:"renderSprite",spritePath:"textures/burst_faint.dds",scale:0.35},{command:"applySpinRotate",angle:-0.2},{command:"applySpinRotate",angle:0.1},
{command:"renderSprite",spritePath:"textures/burst_faint.dds",scale:0.2},{command:"applySpinRotate",angle:-0.1}]};i.archetypes.editorCursor={instructions:[{command:"renderSVG",svgPath:"gui/shape_badge_filled.svg",scale:0.1,colorString:k.strings.outline}]};i.archetypes.editorPositionModeIcon={instructions:[{command:"setRenderLocation",x:40,y:40,locationName:"topLeft"},{command:"renderSprite",spritePath:"textures/translation.dds",scale:0.4}]};i.archetypes.editorRotationModeIcon={instructions:[{command:"setRenderLocation",
x:40,y:40,locationName:"topLeft"},{command:"renderSprite",spritePath:"textures/rotate.dds",scale:0.4}]};i.archetypes.editorScaleModeIcon={instructions:[{command:"setRenderLocation",x:40,y:40,locationName:"topLeft"},{command:"renderSprite",spritePath:"textures/scale.dds",scale:0.4}]};i.modalScale=1;i.archetypes.infoPanelTopBackgroundArea={instructions:[{command:"renderSVG",svgPath:"gui/modal_header.svg",colorString:k.strings.modalMedium,scaleX:i.modalScale,scaleY:0.85},{command:"offsetCentre",x:0,
y:-90},{command:"renderSVG",svgPath:"gui/modal_top_bar.svg",colorString:k.strings.modalDark,scale:i.modalScale},{command:"offsetCentre",x:0,y:90},{command:"offsetCentre",x:0,y:-38},{command:"renderText",pointSize:32,text:"text1",font:"styled",upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:38},{command:"offsetCentre",x:0,y:5},{command:"renderSVG",svgPath:"gui/modal_sep.svg",scaleY:1.1,colorString:k.strings.modalDark,scale:i.modalScale},{command:"renderSVG",svgPath:"gui/modal_sep_textbox.svg",
colorString:k.strings.modalDark,scaleX:1.85*i.modalScale,scaleY:1.2},{command:"renderText",pointSize:22,text:"text2",font:"bold",upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-5},{command:"offsetCentre",x:0,y:42},{command:"renderText",pointSize:22,text:"text3",font:"bold",upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-42}]};i.archetypes.infoPanelMiddleBackgroundArea={instructions:[{command:"renderSVG",svgPath:"gui/modal_body.svg",colorString:k.strings.modalLight,scale:i.modalScale}]};
i.archetypes.infoPanelBottomBackgroundArea={instructions:[{command:"renderSVG",svgPath:"gui/modal_footer.svg",colorString:k.strings.modalDark,scale:i.modalScale}]};i.archetypes.infoPanelCloseButton={instructions:[{command:"renderSVG",svgPath:"gui/info_close_red_bg.svg",colorString:"rgba(227,24,25,1.0)",scaleX:1.4,scaleY:1.4},{command:"renderSVG",svgPath:"gui/info_close.svg",colorString:"rgba(255,255,255,1.0)",scaleX:1.4,scaleY:1.4}]};i.archetypes.infoPanelUpgradeButton={instructions:[{command:"applyPulseScale",
frequency:1,amplitudeDiff:0.02},{command:"renderSVG",svgPath:"gui/modal_button.svg",colorString:k.strings.normalButtonLight,scaleX:1,scaleY:1},{command:"offsetCentre",x:0,y:22},{command:"renderSVG",svgPath:"gui/modal_button.svg",colorString:k.strings.normalButtonDark,scaleX:1,scaleY:0.5},{command:"offsetCentre",x:0,y:-22},{command:"renderText",pointSize:32,text:"text1",font:"styled",upperCase:i.radialFontCase,color:k.outline}]};i.archetypes.infoPanelPrimaryResourceProgressBar={instructions:[{command:"offsetCentre",
x:31,y:0},{command:"renderSVG",svgPath:"gui/info_enemy_bg.svg",colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"offsetCentre",x:-31,y:0},{command:"offsetCentre",x:-40,y:0},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:40,y:0},{command:"offsetCentre",x:-85,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:"rgba(0,160,25,1.0)",scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/icon_minus_lumber.svg",
colorString:"rgba(255,255,255,1.0)",scaleX:1,scaleY:1},{command:"offsetCentre",x:85,y:0}]};i.archetypes.infoPanelSecondaryResourceProgressBar={instructions:[{command:"offsetCentre",x:-8,y:0},{command:"offsetCentre",x:31,y:0},{command:"renderSVG",svgPath:"gui/info_enemy_bg.svg",colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"offsetCentre",x:-31,y:0},{command:"offsetCentre",x:-40,y:0},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",
x:40,y:0},{command:"offsetCentre",x:-85,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:"rgba(100,155,200,1.0)",scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/icon_minus_stone.svg",colorString:"rgba(255,255,255,1.0)",scaleX:1,scaleY:1},{command:"offsetCentre",x:85,y:0}]};i.archetypes.resourceSep={instructions:[{command:"renderSVG",svgPath:"gui/modal_sep.svg",scaleX:0.96,scaleY:1.1,colorString:k.strings.modalMedium,scale:i.modalScale}]};i.archetypes.infoPanelBuildDurationBar=
{instructions:[{command:"offsetCentre",x:9,y:0},{command:"renderSVG",svgPath:"gui/info_bar_bg.svg",colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"offsetCentre",x:-11,y:0},{command:"offsetCentre",x:-170,y:0},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:170,y:0},{command:"offsetCentre",x:-220,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.modalDark,scaleX:1,scaleY:1},{command:"renderSVG",
svgPath:"gui/info_icon_time.svg",colorString:"rgba(255,255,255,1.0)",scaleX:1,scaleY:1},{command:"offsetCentre",x:220,y:0}]};i.archetypes.infoPanelHealthBoostBar={instructions:[{command:"offsetCentre",x:11,y:0},{command:"renderSVG",svgPath:"gui/info_bar_bg.svg",colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:k.strings.modalDark,scaleX:1,scaleY:1},{command:"offsetCentre",x:-11,y:0},{command:"offsetCentre",x:26,y:0},{command:"renderSVG",
svgPath:"gui/info_bar_scale.svg",colorString:"rgba(144,242,101,1.0)",scaleX:"scale2",scaleY:1,alignX:0},{command:"offsetCentre",x:0,y:8},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:"rgba(105,237,66,1.0)",scaleX:"scale2",scaleY:0.5,alignX:0},{command:"offsetCentre",x:0,y:-8},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:"rgba(75,210,51,1.0)",scaleX:"scale1",scaleY:1,alignX:0},{command:"offsetCentre",x:0,y:8},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",
colorString:"rgba(20,179,0,1.0)",scaleX:"scale1",scaleY:0.5,alignX:0},{command:"offsetCentre",x:0,y:-8},{command:"offsetCentre",x:-26,y:0},{command:"offsetCentre",x:-170,y:0},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:170,y:0},{command:"offsetCentre",x:230,y:0},{command:"renderText",pointSize:24,text:"text2",font:"bold",upperCase:i.radialFontCase,align:2},{command:"offsetCentre",x:-230,y:0},{command:"offsetCentre",x:-220,
y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.modalDark,scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/info_icon_health.svg",colorString:"rgba(255,255,255,1.0)",scaleX:1,scaleY:1},{command:"offsetCentre",x:220,y:0}]};i.archetypes.infoPanelPrimaryResourceStorageBoostBar={instructions:[{command:"offsetCentre",x:11,y:0},{command:"renderSVG",svgPath:"gui/info_bar_bg.svg",colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",
colorString:k.strings.modalDark,scaleX:1,scaleY:1},{command:"offsetCentre",x:-11,y:0},{command:"offsetCentre",x:26,y:0},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:"rgba(144,242,101,1.0)",scaleX:"scale2",scaleY:1,alignX:0},{command:"offsetCentre",x:0,y:8},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:"rgba(105,237,66,1.0)",scaleX:"scale2",scaleY:0.5,alignX:0},{command:"offsetCentre",x:0,y:-8},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:"rgba(75,210,51,1.0)",
scaleX:"scale1",scaleY:1,alignX:0},{command:"offsetCentre",x:0,y:8},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:"rgba(20,179,0,1.0)",scaleX:"scale1",scaleY:0.5,alignX:0},{command:"offsetCentre",x:0,y:-8},{command:"offsetCentre",x:-26,y:0},{command:"offsetCentre",x:-170,y:0},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:170,y:0},{command:"offsetCentre",x:230,y:0},{command:"renderText",pointSize:24,text:"text2",
font:"bold",upperCase:i.radialFontCase,align:2},{command:"offsetCentre",x:-230,y:0},{command:"offsetCentre",x:-220,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.modalDark,scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/icon_storage.svg",colorString:"rgba(255,255,255,1.0)",scaleX:1,scaleY:1},{command:"offsetCentre",x:220,y:0}]};i.archetypes.infoPanelWildlingPrimaryResourceCollectionBoostBar={instructions:[{command:"offsetCentre",x:11,y:0},{command:"renderSVG",svgPath:"gui/info_bar_bg.svg",
colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:k.strings.modalDark,scaleX:1,scaleY:1},{command:"offsetCentre",x:-11,y:0},{command:"offsetCentre",x:26,y:0},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:"rgba(144,242,101,1.0)",scaleX:"scale2",scaleY:1,alignX:0},{command:"offsetCentre",x:0,y:8},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:"rgba(105,237,66,1.0)",scaleX:"scale2",scaleY:0.5,
alignX:0},{command:"offsetCentre",x:0,y:-8},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:"rgba(75,210,51,1.0)",scaleX:"scale1",scaleY:1,alignX:0},{command:"offsetCentre",x:0,y:8},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:"rgba(20,179,0,1.0)",scaleX:"scale1",scaleY:0.5,alignX:0},{command:"offsetCentre",x:0,y:-8},{command:"offsetCentre",x:-26,y:0},{command:"offsetCentre",x:-170,y:0},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase,
align:0},{command:"offsetCentre",x:170,y:0},{command:"offsetCentre",x:230,y:0},{command:"renderText",pointSize:24,text:"text2",font:"bold",upperCase:i.radialFontCase,align:2},{command:"offsetCentre",x:-230,y:0},{command:"offsetCentre",x:-220,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.modalDark,scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/info_icon_lumber_generation.svg",colorString:"rgba(255,255,255,1.0)",scaleX:1,scaleY:1},{command:"offsetCentre",x:220,
y:0}]};i.archetypes.infoPanelWildlingSecondaryResourceCollectionBoostBar={instructions:[{command:"offsetCentre",x:11,y:0},{command:"renderSVG",svgPath:"gui/info_bar_bg.svg",colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:k.strings.modalDark,scaleX:1,scaleY:1},{command:"offsetCentre",x:-11,y:0},{command:"offsetCentre",x:26,y:0},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:"rgba(144,242,101,1.0)",scaleX:"scale2",
scaleY:1,alignX:0},{command:"offsetCentre",x:0,y:8},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:"rgba(105,237,66,1.0)",scaleX:"scale2",scaleY:0.5,alignX:0},{command:"offsetCentre",x:0,y:-8},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:"rgba(75,210,51,1.0)",scaleX:"scale1",scaleY:1,alignX:0},{command:"offsetCentre",x:0,y:8},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:"rgba(20,179,0,1.0)",scaleX:"scale1",scaleY:0.5,alignX:0},{command:"offsetCentre",
x:0,y:-8},{command:"offsetCentre",x:-26,y:0},{command:"offsetCentre",x:-170,y:0},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:170,y:0},{command:"offsetCentre",x:230,y:0},{command:"renderText",pointSize:24,text:"text2",font:"bold",upperCase:i.radialFontCase,align:2},{command:"offsetCentre",x:-230,y:0},{command:"offsetCentre",x:-220,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.modalDark,scaleX:1,
scaleY:1},{command:"renderSVG",svgPath:"gui/info_icon_stone_generation.svg",colorString:"rgba(255,255,255,1.0)",scaleX:1,scaleY:1},{command:"offsetCentre",x:220,y:0}]};i.archetypes.infoPanelSecondaryResourceStorageBoostBar={instructions:[{command:"offsetCentre",x:11,y:0},{command:"renderSVG",svgPath:"gui/info_bar_bg.svg",colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:k.strings.modalDark,scaleX:1,scaleY:1},{command:"offsetCentre",
x:-11,y:0},{command:"offsetCentre",x:26,y:0},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:"rgba(144,242,101,1.0)",scaleX:"scale2",scaleY:1,alignX:0},{command:"offsetCentre",x:0,y:8},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:"rgba(105,237,66,1.0)",scaleX:"scale2",scaleY:0.5,alignX:0},{command:"offsetCentre",x:0,y:-8},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:"rgba(75,210,51,1.0)",scaleX:"scale1",scaleY:1,alignX:0},{command:"offsetCentre",
x:0,y:8},{command:"renderSVG",svgPath:"gui/info_bar_scale.svg",colorString:"rgba(20,179,0,1.0)",scaleX:"scale1",scaleY:0.5,alignX:0},{command:"offsetCentre",x:0,y:-8},{command:"offsetCentre",x:-26,y:0},{command:"offsetCentre",x:-170,y:0},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:170,y:0},{command:"offsetCentre",x:230,y:0},{command:"renderText",pointSize:24,text:"text2",font:"bold",upperCase:i.radialFontCase,align:2},{command:"offsetCentre",
x:-230,y:0},{command:"offsetCentre",x:-220,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.modalDark,scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/icon_storage.svg",colorString:"rgba(255,255,255,1.0)",scaleX:1,scaleY:1},{command:"offsetCentre",x:220,y:0}]};i.archetypes.infoPanelNewBuildOptions={instructions:[{command:"renderSVG",svgPath:"gui/info_options_bg.svg",colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"renderText",pointSize:24,text:"text2",
font:"bold",align:1,boxWidth:440,boxHeight:80}]};i.archetypes.infoPanelMaxRewardTitleBar={instructions:[{command:"renderSVG",svgPath:"gui/modal_sep.svg",scaleY:1.1,colorString:k.strings.modalDark,scale:i.modalScale},{command:"renderSVG",svgPath:"gui/modal_sep_textbox.svg",colorString:k.strings.modalDark,scaleX:1.3*i.modalScale,scaleY:1.2},{command:"renderText",pointSize:22,text:"text1",font:"bold",upperCase:i.radialFontCase}]};i.archetypes.infoPanelNumberOfBattlesBar={instructions:[{command:"offsetCentre",
x:11,y:0},{command:"renderSVG",svgPath:"gui/info_bar_bg.svg",colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"offsetCentre",x:-11,y:0},{command:"offsetCentre",x:-170,y:0},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:170,y:0},{command:"offsetCentre",x:-220,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.modalDark,scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/icon_waves.svg",
colorString:"rgba(255,255,255,1.0)",scaleX:1,scaleY:1},{command:"offsetCentre",x:220,y:0}]};i.archetypes.infoPanelPrimaryResourceRewardTextBarSmall={instructions:[{command:"offsetCentre",x:8,y:0},{command:"renderSVG",svgPath:"gui/info_mini_bg.svg",colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"offsetCentre",x:-0,y:0},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:0,y:0},{command:"offsetCentre",x:-50,y:0},{command:"renderSVG",
svgPath:"gui/info_square.svg",colorString:"rgba(0,160,25,1.0)",scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/icon_plus_lumber.svg",colorString:"rgba(255,255,255,1.0)",scaleX:1,scaleY:1},{command:"offsetCentre",x:50,y:0}]};i.archetypes.infoPanelSecondaryResourceTextBarSmall={instructions:[{command:"offsetCentre",x:4,y:0},{command:"renderSVG",svgPath:"gui/info_mini_bg.svg",colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"offsetCentre",x:-0,y:0},{command:"renderText",pointSize:24,
text:"text1",font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:0,y:0},{command:"offsetCentre",x:-50,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:"rgba(100,155,200,1.0)",scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/icon_plus_stone.svg",colorString:"rgba(255,255,255,1.0)",scaleX:1,scaleY:1},{command:"offsetCentre",x:50,y:0}]};i.archetypes.infoPanelXpTextBarSmall={instructions:[{command:"offsetCentre",x:-0,y:0},{command:"renderSVG",svgPath:"gui/info_mini_bg.svg",
colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"offsetCentre",x:-0,y:0},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:0,y:0},{command:"offsetCentre",x:-50,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:"rgba(145,51,185,1.0)",scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/icon_plus_xp.svg",colorString:"rgba(255,255,255,1.0)",scaleX:1,scaleY:1},{command:"offsetCentre",x:50,y:0}]};i.archetypes.infoPanelEnemyQuantity=
{instructions:[{command:"offsetCentre",x:31,y:0},{command:"renderSVG",svgPath:"gui/info_enemy_bg.svg",colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"offsetCentre",x:-31,y:0},{command:"offsetCentre",x:-40,y:0},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:40,y:0},{command:"offsetCentre",x:-85,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.modalDark,scaleX:1,scaleY:1},{command:"renderSprite",
scale:0.35,spritePathVar:"sprite1"},{command:"offsetCentre",x:85,y:0}]};i.archetypes.infoPanelTopBackgroundAreaCampaignEnd={instructions:[{command:"renderSVG",svgPath:"gui/modal_header.svg",colorString:k.strings.modalMedium,scaleX:1,scaleY:0.85},{command:"offsetCentre",x:0,y:-90},{command:"renderSVG",svgPath:"gui/modal_top_bar.svg",colorString:k.strings.modalDark,scaleX:i.modalScale},{command:"offsetCentre",x:0,y:95},{command:"offsetCentre",x:0,y:-22},{command:"renderText",pointSize:32,text:"text1",
font:"styled",upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:22},{command:"offsetCentre",x:0,y:30},{command:"renderText",pointSize:22,text:"text2",font:"bold",upperCase:i.radialFontCase},{command:"offsetCentre",x:0,y:-30}]};i.archetypes.infoPanelStarCountBarBackground={instructions:[{command:"renderSVG",svgPath:"gui/info_breakbox.svg",colorString:k.strings.modalMedium,scaleX:1,scaleY:0.9}]};i.archetypes.infoPanelAchievedStar={instructions:[{command:"applyPulseScale",frequency:0.75,amplitudeDiff:0.1},
{command:"applyWobble",amount:1},{command:"renderSVG",svgPath:"gui/info_star.svg",colorString:k.strings.star,scale:1.3},{command:"renderSVG",svgPath:"gui/info_star_lowlight.svg",colorString:k.strings.starDark,scale:1.3}]};i.archetypes.infoPanelUnachievedStar={instructions:[{command:"renderSVG",svgPath:"gui/info_star.svg",colorString:k.strings.modalDark,scale:1}]};i.archetypes.infoPanelHqHealthFactorStarSuccess={instructions:[{command:"offsetCentre",x:9,y:0},{command:"renderSVG",svgPath:"gui/info_bar_bg.svg",
colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"offsetCentre",x:-11,y:0},{command:"offsetCentre",x:-170,y:0},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:170,y:0},{command:"offsetCentre",x:-220,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.modalDark,scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/icon_hq.svg",colorString:"rgba(255,255,255,1.0)",scaleX:1,scaleY:1},{command:"offsetCentre",
x:220,y:0},{command:"offsetCentre",x:222,y:0},{command:"offsetCentre",x:-65,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.successDark,scaleX:1.1,scaleY:0.9},{command:"renderText",pointSize:24,text:"text2",font:"bold",upperCase:i.radialFontCase,align:1},{command:"offsetCentre",x:65,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.success,scale:1.1},{command:"renderSVG",svgPath:"gui/icon_tick.svg",colorString:k.strings.outline,scale:0.6},
{command:"offsetCentre",x:-220,y:0}]};i.archetypes.infoPanelHqHealthFactorStarFail={instructions:[{command:"offsetCentre",x:9,y:0},{command:"renderSVG",svgPath:"gui/info_bar_bg.svg",colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"offsetCentre",x:-11,y:0},{command:"offsetCentre",x:-170,y:0},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:170,y:0},{command:"offsetCentre",x:-220,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",
colorString:k.strings.modalDark,scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/icon_hq.svg",colorString:"rgba(255,255,255,1.0)",scaleX:1,scaleY:1},{command:"offsetCentre",x:220,y:0},{command:"offsetCentre",x:222,y:0},{command:"offsetCentre",x:-65,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.failDark,scaleX:1.1,scaleY:0.9},{command:"renderText",pointSize:24,text:"text2",font:"bold",upperCase:i.radialFontCase,align:1},{command:"offsetCentre",x:65,y:0},{command:"renderSVG",
svgPath:"gui/info_square.svg",colorString:k.strings.fail,scale:1.1},{command:"renderSVG",svgPath:"gui/icon_cross.svg",colorString:k.strings.outline,scale:0.6},{command:"offsetCentre",x:-220,y:0}]};i.archetypes.infoPanelFewerThanNHeroDeathsStarSuccess={instructions:[{command:"offsetCentre",x:9,y:0},{command:"renderSVG",svgPath:"gui/info_bar_bg.svg",colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"offsetCentre",x:-11,y:0},{command:"offsetCentre",x:-170,y:0},{command:"renderText",pointSize:24,
text:"text1",font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:170,y:0},{command:"offsetCentre",x:-220,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.modalDark,scaleX:1.1,scaleY:1.1},{command:"renderSVG",svgPath:"gui/icon_heart.svg",colorString:"rgba(255,255,255,1.0)",scale:0.55},{command:"offsetCentre",x:220,y:0},{command:"offsetCentre",x:222,y:0},{command:"offsetCentre",x:-65,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.successDark,
scaleX:1.1,scaleY:0.9},{command:"renderText",pointSize:24,text:"text2",font:"bold",upperCase:i.radialFontCase,align:1},{command:"offsetCentre",x:65,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.success,scale:1.1},{command:"renderSVG",svgPath:"gui/icon_tick.svg",colorString:k.strings.outline,scale:0.6},{command:"offsetCentre",x:-220,y:0}]};i.archetypes.infoPanelFewerThanNHeroDeathsStarFail={instructions:[{command:"offsetCentre",x:9,y:0},{command:"renderSVG",svgPath:"gui/info_bar_bg.svg",
colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"offsetCentre",x:-11,y:0},{command:"offsetCentre",x:-170,y:0},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:170,y:0},{command:"offsetCentre",x:-220,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.modalDark,scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/icon_heart.svg",colorString:"rgba(255,255,255,1.0)",scale:0.55},{command:"offsetCentre",
x:220,y:0},{command:"offsetCentre",x:222,y:0},{command:"offsetCentre",x:-65,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.failDark,scaleX:1.1,scaleY:0.9},{command:"renderText",pointSize:24,text:"text2",font:"bold",upperCase:i.radialFontCase,align:1},{command:"offsetCentre",x:65,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.fail,scale:1.1},{command:"renderSVG",svgPath:"gui/icon_cross.svg",colorString:k.strings.outline,scale:0.6},{command:"offsetCentre",
x:-220,y:0}]};i.archetypes.infoPanelKillNEnemiesStarSuccess={instructions:[{command:"offsetCentre",x:9,y:0},{command:"renderSVG",svgPath:"gui/info_bar_bg.svg",colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"offsetCentre",x:-11,y:0},{command:"offsetCentre",x:-170,y:0},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:170,y:0},{command:"offsetCentre",x:-220,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",
colorString:k.strings.modalDark,scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/icon_wildling.svg",colorString:"rgba(255,255,255,1.0)",scale:0.5},{command:"offsetCentre",x:220,y:0},{command:"offsetCentre",x:222,y:0},{command:"offsetCentre",x:-65,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.successDark,scaleX:1.1,scaleY:0.9},{command:"renderText",pointSize:24,text:"text2",font:"bold",upperCase:i.radialFontCase,align:1},{command:"offsetCentre",x:65,y:0},{command:"renderSVG",
svgPath:"gui/info_square.svg",colorString:k.strings.success,scale:1.1},{command:"renderSVG",svgPath:"gui/icon_tick.svg",colorString:k.strings.outline,scale:0.6},{command:"offsetCentre",x:-220,y:0}]};i.archetypes.infoPanelKillNEnemiesStarFail={instructions:[{command:"offsetCentre",x:9,y:0},{command:"renderSVG",svgPath:"gui/info_bar_bg.svg",colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"offsetCentre",x:-11,y:0},{command:"offsetCentre",x:-170,y:0},{command:"renderText",pointSize:24,text:"text1",
font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:170,y:0},{command:"offsetCentre",x:-220,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.modalDark,scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/icon_wildling.svg",colorString:"rgba(255,255,255,1.0)",scale:0.5},{command:"offsetCentre",x:220,y:0},{command:"offsetCentre",x:222,y:0},{command:"offsetCentre",x:-65,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.failDark,
scaleX:1.1,scaleY:0.9},{command:"renderText",pointSize:24,text:"text2",font:"bold",upperCase:i.radialFontCase,align:1},{command:"offsetCentre",x:65,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.fail,scale:1.1},{command:"renderSVG",svgPath:"gui/icon_cross.svg",colorString:k.strings.outline,scale:0.6},{command:"offsetCentre",x:-220,y:0}]};i.archetypes.infoPanelKillNEnemiesWithHeroStarSuccess={instructions:[{command:"offsetCentre",x:9,y:0},{command:"renderSVG",svgPath:"gui/info_bar_bg.svg",
colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"offsetCentre",x:-11,y:0},{command:"offsetCentre",x:-170,y:0},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:170,y:0},{command:"offsetCentre",x:-220,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.modalDark,scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/icon_wildling.svg",colorString:"rgba(255,255,255,1.0)",scale:0.5},{command:"offsetCentre",
x:220,y:0},{command:"offsetCentre",x:222,y:0},{command:"offsetCentre",x:-65,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.successDark,scaleX:1.1,scaleY:0.9},{command:"renderText",pointSize:24,text:"text2",font:"bold",upperCase:i.radialFontCase,align:1},{command:"offsetCentre",x:65,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.success,scale:1.1},{command:"renderSVG",svgPath:"gui/icon_tick.svg",colorString:k.strings.outline,scale:0.6},
{command:"offsetCentre",x:-220,y:0}]};i.archetypes.infoPanelKillNEnemiesWithHeroStarFail={instructions:[{command:"offsetCentre",x:9,y:0},{command:"renderSVG",svgPath:"gui/info_bar_bg.svg",colorString:k.strings.modalMedium,scaleX:1,scaleY:1},{command:"offsetCentre",x:-11,y:0},{command:"offsetCentre",x:-170,y:0},{command:"renderText",pointSize:24,text:"text1",font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:170,y:0},{command:"offsetCentre",x:-220,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",
colorString:k.strings.modalDark,scaleX:1,scaleY:1},{command:"renderSVG",svgPath:"gui/icon_wildling.svg",colorString:"rgba(255,255,255,1.0)",scale:0.5},{command:"offsetCentre",x:220,y:0},{command:"offsetCentre",x:222,y:0},{command:"offsetCentre",x:-65,y:0},{command:"renderSVG",svgPath:"gui/info_square.svg",colorString:k.strings.failDark,scaleX:1.1,scaleY:0.9},{command:"renderText",pointSize:24,text:"text2",font:"bold",upperCase:i.radialFontCase,align:1},{command:"offsetCentre",x:65,y:0},{command:"renderSVG",
svgPath:"gui/info_square.svg",colorString:k.strings.fail,scale:1.1},{command:"renderSVG",svgPath:"gui/icon_cross.svg",colorString:k.strings.outline,scale:0.6},{command:"offsetCentre",x:-220,y:0}]};i.archetypes.infoPanelFlagBasic={instructions:[{command:"offsetCentre",x:0,y:-15},{command:"renderSprite",spritePath:"textures/flag_mob.dds",scale:0.9}]};i.archetypes.infoPanelFlagMob={instructions:[{command:"offsetCentre",x:0,y:-15},{command:"renderSprite",spritePath:"textures/flag_mob.dds",scale:0.9}]};
i.archetypes.infoPanelFlagBombthrower={instructions:[{command:"offsetCentre",x:0,y:-15},{command:"renderSprite",spritePath:"textures/flag_bombthrower.dds",scale:0.9}]};i.archetypes.infoPanelFlagCharger={instructions:[{command:"offsetCentre",x:0,y:-15},{command:"renderSprite",spritePath:"textures/flag_charger.dds",scale:0.9}]};i.archetypes.infoPanelFlagRanged={instructions:[{command:"offsetCentre",x:0,y:-15},{command:"renderSprite",spritePath:"textures/flag_ranged.dds",scale:0.9}]};i.archetypes.infoPanelFlagCommando=
{instructions:[{command:"offsetCentre",x:0,y:-15},{command:"renderSprite",spritePath:"textures/flag_commando.dds",scale:0.9}]};i.archetypes.infoPanelFlagDeath={instructions:[{command:"offsetCentre",x:0,y:-15},{command:"renderSprite",spritePath:"textures/flag_death.dds",scale:0.9}]};i.archetypes.infoPanelFlagThief={instructions:[{command:"offsetCentre",x:0,y:-15},{command:"renderSprite",spritePath:"textures/flag_thief.dds",scale:0.9}]};i.archetypes.infoPanelFlagTreasure={instructions:[{command:"offsetCentre",
x:0,y:-15},{command:"renderSprite",spritePath:"textures/flag_treasure.dds",scale:0.9}]};i.archetypes.infoPanelFlagBoss={instructions:[{command:"offsetCentre",x:0,y:-15},{command:"renderSprite",spritePath:"textures/flag_boss.dds",scale:0.9}]};i.archetypes.infoPanelTaskDescription={instructions:[{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePathVar:"sprite1",scale:1},{command:"offsetCentre",x:0,y:200},{command:"renderText",pointSize:30,text:"text1",font:i.shopBtnFontStyle,upperCase:i.radialFontCase,
boxWidth:400,boxHeight:400}]};i.archetypes.infoPanelTaskComplete={instructions:[{command:"offsetCentre",x:0,y:-100},{command:"renderSprite",spritePathVar:"sprite1",scale:1},{command:"offsetCentre",x:0,y:200},{command:"renderText",pointSize:30,text:"text1",font:i.shopBtnFontStyle,upperCase:i.radialFontCase,boxWidth:400,boxHeight:400}]};sa.starGuiArchetypeMap={hqHealthFactor:["infoPanelHqHealthFactorStarSuccess","infoPanelHqHealthFactorStarFail"],fewerThanNHeroDeaths:["infoPanelFewerThanNHeroDeathsStarSuccess",
"infoPanelFewerThanNHeroDeathsStarFail"],killNEnemies:["infoPanelKillNEnemiesStarSuccess","infoPanelKillNEnemiesStarFail"],killNEnemiesWithHero:["infoPanelKillNEnemiesWithHeroStarSuccess","infoPanelKillNEnemiesWithHeroStarFail"]};sa.componentDescMap={topBackgroundArea:{name:"topBackgroundArea",guiArchetype:"infoPanelTopBackgroundArea",v2Size:[575,164],type:"graphic",text1Id:"titleText",text2Id:"subTitleText",text3Id:"descriptionText"},topBackgroundAreaCampaignEnd:{name:"topBackgroundAreaCampaignEnd",
guiArchetype:"infoPanelTopBackgroundAreaCampaignEnd",v2Size:[575,164],type:"graphic",text1Id:"titleText",text2Id:"descriptionText"},middleBackgroundArea:{name:"middleBackgroundArea",guiArchetype:"infoPanelMiddleBackgroundArea",v2Size:[575,590],type:"graphic"},bottomBackgroundArea:{name:"bottomBackgroundArea",guiArchetype:"infoPanelBottomBackgroundArea",v2Size:[575,132],type:"graphic"},closeButton:{name:"closeButton",guiArchetype:"infoPanelCloseButton",v2Size:[80,80],v2Offset:[278,-90],type:"button"},
upgradeButton:{name:"upgradeButton",guiArchetype:"infoPanelUpgradeButton",v2Size:[575,80],type:"button",textId:"buttonText"},flag:{name:"flag",v2Size:[50,50],v2Offset:[0,-95],type:"flag"},dualResourceProgressBars:{name:"dualResourceProgressBars",v2Size:[100,76],numberOfComponentsPerRow:2,componentList:["primaryResourceProgressBar","secondaryResourceProgressBar"]},primaryResourceProgressBar:{name:"primaryResourceProgressBar",type:"progressBar",alignment:"left",v2Size:[200,40],guiArchetype:"infoPanelPrimaryResourceProgressBar",
textId:"lumberText",progressBarTotalQuantityId:"primaryResourceCost",progressBarCurrentQuantityId:"primaryResourceAvailable"},secondaryResourceProgressBar:{name:"secondaryResourceProgressBar",type:"progressBar",alignment:"right",v2Size:[200,40],guiArchetype:"infoPanelSecondaryResourceProgressBar",textId:"stoneText",progressBarTotalQuantityId:"secondaryResourceCost",progressBarCurrentQuantityId:"secondaryResourceAvailable"},resourceSep:{name:"resourceSep",type:"graphic",v2Size:[200,30],guiArchetype:"resourceSep"},
buildDurationBar:{name:"buildDurationBar",guiArchetype:"infoPanelBuildDurationBar",v2Size:[100,76],type:"textBar",textId:"buildDurationText"},healthBoostBar:{name:"healthBoostBar",guiArchetype:"infoPanelHealthBoostBar",v2Size:[100,76],type:"statBoostBar",textId:"healthText",preUpgradeStatId:"maxHealthPreUpgrade",postUpgradeStatId:"maxHealthPostUpgrade",maxPossibleStatId:"maxHealthPossible"},lumberStorageBoostBar:{name:"lumberStorageBoostBar",guiArchetype:"infoPanelPrimaryResourceStorageBoostBar",
v2Size:[100,76],type:"statBoostBar",textId:"lumberStorageText",preUpgradeStatId:"maxPrimaryResourceStoragePreUpgrade",postUpgradeStatId:"maxPrimaryResourceStoragePostUpgrade",maxPossibleStatId:"maxPrimaryResourceStoragePossible"},stoneStorageBoostBar:{name:"stoneStorageBoostBar",guiArchetype:"infoPanelSecondaryResourceStorageBoostBar",v2Size:[100,76],type:"statBoostBar",textId:"stoneStorageText",preUpgradeStatId:"maxSecondaryResourceStoragePreUpgrade",postUpgradeStatId:"maxSecondaryResourceStoragePostUpgrade",
maxPossibleStatId:"maxSecondaryResourceStoragePossible"},wildlingPrimaryResourceCollectionBoostBar:{name:"wildlingPrimaryResourceCollectionRateBoostBar",guiArchetype:"infoPanelWildlingPrimaryResourceCollectionBoostBar",v2Size:[100,76],type:"statBoostBar",textId:"wildlingPrimaryResourceCollectionText",preUpgradeStatId:"wildlingResourceCollectionRatePreUpgrade",postUpgradeStatId:"wildlingResourceCollectionRatePostUpgrade",maxPossibleStatId:"wildlingResourceCollectionRateMaxPossible"},wildlingSecondaryResourceCollectionBoostBar:{name:"wildlingSecondaryResourceCollectionRateBoostBar",
guiArchetype:"infoPanelWildlingSecondaryResourceCollectionBoostBar",v2Size:[100,76],type:"statBoostBar",textId:"wildlingSecondaryResourceCollectionText",preUpgradeStatId:"wildlingResourceCollectionRatePreUpgrade",postUpgradeStatId:"wildlingResourceCollectionRatePostUpgrade",maxPossibleStatId:"wildlingResourceCollectionRateMaxPossible"},newBuildOptionsBox:{guiArchetype:"infoPanelNewBuildOptions",v2Size:[100,120],type:"textBox",text1Id:"newBuildOptionsTitleText",text2Id:"newBuildOptionsText"},numberOfBattlesBar:{name:"numberOfBattlesBar",
guiArchetype:"infoPanelNumberOfBattlesBar",v2Size:[100,76],type:"textBar",textId:"numberOfBattlesText"},maxRewardTitleBar:{name:"maxRewardTitleBar",guiArchetype:"infoPanelMaxRewardTitleBar",v2Size:[100,44],type:"textBar",textId:"maxRewardsTitleBarText"},maxRewardBars:{name:"maxRewardBars",v2Size:[100,76],numberOfComponentsPerRow:3,componentList:["maxPrimaryResourceRewardBar","maxSecondaryResourceRewardBar","maxXpRewardBar"]},maxPrimaryResourceRewardBar:{name:"maxPrimaryResourceRewardBar",type:"textBar",
v2Size:[200,40],guiArchetype:"infoPanelPrimaryResourceRewardTextBarSmall",textId:"maxPrimaryResourceRewardText"},maxSecondaryResourceRewardBar:{name:"maxSecondaryResourceRewardBar",type:"textBar",v2Size:[200,40],guiArchetype:"infoPanelSecondaryResourceTextBarSmall",textId:"maxSecondaryResourceRewardText"},maxXpRewardBar:{name:"maxXpRewardBar",type:"textBar",v2Size:[133,40],guiArchetype:"infoPanelXpTextBarSmall",textId:"maxXpRewardText"},enemyQuantities:{name:"enemyQuantities",v2Size:[100,76],numberOfComponentsPerRow:2,
listElementComponent:"infoPanelEnemyQuantity",dataListId:"enemyArchetypeSpritePathList"},infoPanelEnemyQuantity:{name:"infoPanelEnemyQuantity",type:"textBar",v2Size:[133,40],guiArchetype:"infoPanelEnemyQuantity",spritePathListId:"enemyArchetypeSpritePathList",textListId:"enemyNameList"},rewardTitleBar:{name:"rewardTitleBar",guiArchetype:"infoPanelMaxRewardTitleBar",v2Size:[100,44],type:"textBar",textId:"rewardsTitleBarText"},rewardBars:{name:"rewardBars",v2Size:[100,76],numberOfComponentsPerRow:3,
componentList:["primaryResourceRewardBar","secondaryResourceRewardBar","xpRewardBar"]},primaryResourceRewardBar:{name:"primaryResourceRewardBar",type:"textBar",v2Size:[200,40],guiArchetype:"infoPanelPrimaryResourceRewardTextBarSmall",textId:"primaryResourceRewardText"},secondaryResourceRewardBar:{name:"secondaryResourceRewardBar",type:"textBar",v2Size:[200,40],guiArchetype:"infoPanelSecondaryResourceTextBarSmall",textId:"secondaryResourceRewardText"},xpRewardBar:{name:"xpRewardBar",type:"textBar",
v2Size:[133,40],guiArchetype:"infoPanelXpTextBarSmall",textId:"xpRewardText"},starAchievedBars:{name:"starAchievedBars",v2Size:[100,76],numberOfComponentsPerRow:1,listElementComponent:"starAchievedBar",dataListId:"starStatusList"},starAchievedBar:{name:"starAchievedBar",type:"starBar",v2Size:[133,40],starStatusListId:"starStatusList"},starCountBar:{name:"starCountBar",type:"starCountBar",v2Size:[100,105],horizontalStarSeparation:76,backgroundGuiArchetype:"infoPanelStarCountBarBackground",achievedStarGuiArchetype:"infoPanelAchievedStar",
unachievedStarGuiArchetype:"infoPanelUnachievedStar"},taskDescriptionBox:{name:"taskDescriptionGraphic",guiArchetype:"infoPanelTaskDescription",v2Size:[400,400],type:"graphic",text1Id:"taskDescriptionText",spritePathId:"descriptionSpritePath"},taskCompleteBox:{name:"taskCompleteGraphic",guiArchetype:"infoPanelTaskComplete",v2Size:[400,400],type:"graphic",text1Id:"taskCompletionText",spritePathId:"completeSpritePath"}};L.badgeArchetypes["dummy-badge-key"]={titleTextId:"BADGE_DUMMY",amberReward:2,xpReward:100};
L.badgeArchetypes["early-adopter"]={titleTextId:"BADGE_EARLY_ADOPTER",amberReward:2,xpReward:100};L.badgeArchetypes["win-a-campaign"]={titleTextId:"BADGE_WIN_A_CAMPAIGN",amberReward:2,xpReward:100};L.badgeArchetypes["walls-built-10"]={titleTextId:"BADGE_10_WALLS_BUILT",amberReward:2,xpReward:100};L.badgeArchetypes["walls-built-100"]={titleTextId:"BADGE_100_WALLS_BUILT",amberReward:2,xpReward:100};L.badgeArchetypes["10-trees-chopped"]={titleTextId:"BADGE_10_TREES_CHOPPED",amberReward:2,xpReward:100};
L.badgeArchetypes["100-trees-chopped"]={titleTextId:"BADGE_100_TREES_CHOPPED",amberReward:2,xpReward:100};L.badgeArchetypes["1000-trees-chopped"]={titleTextId:"BADGE_1000_TREES_CHOPPED",amberReward:2,xpReward:100};L.badgeArchetypes["10000-trees-chopped"]={titleTextId:"BADGE_10000_TREES_CHOPPED",amberReward:2,xpReward:100};L.badgeArchetypes["10-rocks-destroyed"]={titleTextId:"BADGE_10_STONES_MINED",amberReward:2,xpReward:100};L.badgeArchetypes["100-rocks-destroyed"]={titleTextId:"BADGE_100_STONES_MINED",
amberReward:2,xpReward:100};L.badgeArchetypes["1000-rocks-destroyed"]={titleTextId:"BADGE_1000_STONES_MINED",amberReward:2,xpReward:100};L.badgeArchetypes["10000-rocks-destroyed"]={titleTextId:"BADGE_10000_STONES_MINED",amberReward:2,xpReward:100};L.badgeArchetypes["10-enemies-killed"]={titleTextId:"BADGE_10_ENEMIES_KILLED",amberReward:2,xpReward:100};L.badgeArchetypes["100-enemies-killed"]={titleTextId:"BADGE_100_ENEMIES_KILLED",amberReward:2,xpReward:100};L.badgeArchetypes["1000-enemies-killed"]=
{titleTextId:"BADGE_1000_ENEMIES_KILLED",amberReward:2,xpReward:100};L.badgeArchetypes["10000-enemies-killed"]={titleTextId:"BADGE_10000_ENEMIES_KILLED",amberReward:2,xpReward:100};L.criticalTaskList=["wakeUp pickupWeapon shootCrate defeatWildlings goToVillage buildHq".split(" "),["chopATree","buildLumbermill"],["mineAStone","buildStonemill"],["mineStoneAndLumber","buildLumberlingHut"],["buildStonelingHut"],["buildDefenceFactory"],["buildDefendlingHut"],["goToCaves","buildOutpost","speedUpOutpost"],
["moveBuilding"],["buildBarricade"],["buildGate"],["buildGatling"],["speedUpGatling"],["startCampaign"],["winCampaign"],["levelUpHeroAtShrine"],["buildMarketplace"],["buildAmberChest"],["openAmberChest"],["buildLumberStorage"],["buildStoneStorage"],["buildWalls"],["buildStoneGate"],["buildTower"],["buildDecoration"],["buildTrap"],["startCampaign2"],["bargeAttack"],["buildHQLevel2"],["goToTotemAgility"],["buildStoneStorageLevel2"],["goToTotemTechnology"],["buildLumberStorageLevel2"],["goToTotemPower"],
["buildStonemillLevel2"],["goToTotemProtection"],["buildSecondStonelingHut"],["buildLumbermillLevel2"],["buildSecondLumberlingHut"],["buildDefenceFactoryLevel2"],["buildDefendlingHutLevel2"],["buildOutpostLevel2"],["buildHQLevel3"],["buildSecondLumberStorage"],["buildLibrary"],["buildStoneStorageLevel3"],["buildLumberStorageLevel3"],["buildDefenceFactoryLevel3"],["buildSecondDefendlingHut"],["buildDefendlingHutLevel3"],["buildOutpostLevel3"],["buildSecondOutpost"],["buildSecondStoneStorage"],["buildHQLevel4"],
["buildHQLevel5"],["buildHQLevel6"],["buildHQLevel7"],["buildHQLevel8"],["buildHQLevel9"],["buildHQLevel10"],["wakeUpWildling"]];L.archetypes.wakeUp={summaryTextId:"TASK_WAKEUP_SUMMARY",titleTextId:"TASK_WAKEUP_TITLE",descriptionTextId:"TASK_WAKEUP_EXPLAIN",completeTextId:"TASK_WAKEUP_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_wakeup.svg",alwaysActive:!1,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"hero"}},conditionList:[{name:"onEvent",params:{eventName:"wakeUpTaskComplete"},
count:1}],visibleScript:"wakeUpTutorialScript",taskUnopenedArchetype:"taskInactiveLoud",noTaskDescriptionCloseScript:!0};L.archetypes.pickupWeapon={titleTextId:"TASK_PICKUPWEAPON_SUMMARY",descriptionTextId:"TASK_PICKUPWEAPON_EXPLAIN",completeTextId:"TASK_PICKUPWEAPON_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_fight.svg",alwaysActive:!1,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"tutorialgun"}},conditionList:[{name:"onEvent",params:{eventName:"getWeaponTaskComplete"},
count:1}],visibleScript:"getWeaponTutorialScript"};L.archetypes.shootCrate={titleTextId:"TASK_SHOOTCRATE_SUMMARY",descriptionTextId:"TASK_SHOOTCRATE_EXPLAIN",completeTextId:"TASK_SHOOTCRATE_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_fight.svg",alwaysActive:!1,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"tutorialcrate"}},conditionList:[{name:"onEvent",params:{eventName:"ShootCrateTaskComplete"},count:1}],visibleScript:"shootCrateTutorialScript"};
L.archetypes.defeatWildlings={titleTextId:"TASK_DEFEATWILDLINGS_SUMMARY",descriptionTextId:"TASK_DEFEATWILDLINGS_EXPLAIN",completeTextId:"TASK_DEFEATWILDLINGS_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_fight.svg",alwaysActive:!1,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"tutorialEnemy3"}},conditionList:[{name:"onEvent",params:{eventName:"DefeatWildlingsScriptTaskComplete"},count:1}],visibleScript:"defeatWildlingsScript"};L.archetypes.goToVillage=
{titleTextId:"TASK_GOTOVILLAGE_SUMMARY",descriptionTextId:"TASK_GOTOVILLAGE_EXPLAIN",completeTextId:"TASK_GOTOVILLAGE_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_goto.svg",alwaysActive:!1,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"workshop"}},conditionList:[{name:"onEvent",params:{eventName:"GoToVillageTaskComplete"},count:1}],visibleScript:"goToVillageScript"};L.archetypes.buildHq={titleTextId:"TASK_BUILDHQ_SUMMARY",descriptionTextId:"TASK_BUILDHQ_EXPLAIN",
completeTextId:"TASK_BUILDHQ_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_hq.svg",alwaysActive:!1,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"hqworkshop",carryFamilyName:"suggestHq"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"HQ",count:1}}],startupScript:"buildHqStartupScript",visibleScript:"buildHqVisibleScript"};L.archetypes.chopATree={titleTextId:"TASK_CHOPATREE_SUMMARY",descriptionTextId:"TASK_CHOPATREE_EXPLAIN",completeTextId:"TASK_CHOPATREE_COMPLETE",
amberReward:1,xpReward:20,iconPath:"gui/task_icon_chop.svg",alwaysActive:!1,isCritical:!0,conditionList:[{name:"chopTree",count:1}],locationFinder:{name:"nearestResourceDispenser",params:{familyName:"tree"}}};L.archetypes.mineAStone={titleTextId:"TASK_MINEASTONE_SUMMARY",descriptionTextId:"TASK_MINEASTONE_EXPLAIN",completeTextId:"TASK_MINEASTONE_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_mine.svg",alwaysActive:!1,isCritical:!0,conditionList:[{name:"mineStone",count:1}],locationFinder:{name:"nearestResourceDispenser",
params:{familyName:"rock"}}};L.archetypes.mineStoneAndLumber={titleTextId:"TASK_MINESTONEANDLUMBER_SUMMARY",descriptionTextId:"TASK_MINESTONEANDLUMBER_EXPLAIN",completeTextId:"TASK_MINESTONEANDLUMBER_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_chopmine.svg",alwaysActive:!1,isCritical:!0,conditionList:[{name:"mineStone",count:1},{name:"chopTree",count:1}],locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"resourceArea"}}};L.archetypes.buildLumbermill={titleTextId:"TASK_BUILDLUMBERMILL_SUMMARY",
descriptionTextId:"TASK_BUILDLUMBERMILL_EXPLAIN",completeTextId:"TASK_BUILDLUMBERMILL_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"lumbermillworkshop"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Lumbermill",count:1}}],startupScript:"buildLumbermillStartupScript",visibleScript:"buildLumbermillVisibleScript"};L.archetypes.buildStonemill={titleTextId:"TASK_BUILDSTONEMILL_SUMMARY",
descriptionTextId:"TASK_BUILDSTONEMILL_EXPLAIN",completeTextId:"TASK_BUILDSTONEMILL_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"stonemillworkshop"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Stonemill",count:1}}],startupScript:"buildStonemillStartupScript",visibleScript:"buildStonemillVisibleScript"};L.archetypes.buildLumberlingHut={titleTextId:"TASK_BUILDLUMBERLINGHUT_SUMMARY",
descriptionTextId:"TASK_BUILDLUMBERLINGHUT_EXPLAIN",completeTextId:"TASK_BUILDLUMBERLINGHUT_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"lumberlinghutworkshop"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Lumberling Hut",count:1}}],startupScript:"buildLumberlingHutStartupScript",visibleScript:"buildLumberlingHutVisibleScript"};L.archetypes.buildStonelingHut={titleTextId:"TASK_BUILDSTONELINGHUT_SUMMARY",
descriptionTextId:"TASK_BUILDSTONELINGHUT_EXPLAIN",completeTextId:"TASK_BUILDSTONELINGHUT_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"stonelinghutworkshop"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Stoneling Hut",count:1}}],startupScript:"buildStonelingHutStartupScript",visibleScript:"buildStonelingHutVisibleScript"};L.archetypes.buildDefenceFactory={titleTextId:"TASK_BUILDDEFENCEFACTORY_SUMMARY",
descriptionTextId:"TASK_BUILDDEFENCEFACTORY_EXPLAIN",completeTextId:"TASK_BUILDDEFENCEFACTORY_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"defencefactoryworkshop"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Defence Factory",count:1}}],startupScript:"buildDefenceFactoryStartupScript",visibleScript:"buildDefenceFactoryVisibleScript"};L.archetypes.buildDefendlingHut=
{titleTextId:"TASK_BUILDDEFENDLINGHUT_SUMMARY",descriptionTextId:"TASK_BUILDDEFENDLINGHUT_EXPLAIN",completeTextId:"TASK_BUILDDEFENDLINGHUT_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"defendlinghutworkshop"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Defendling Hut",count:1}}],startupScript:"buildDefendlingHutStartupScript",visibleScript:"buildDefendlingHutVisibleScript"};
L.archetypes.buildAmberChest={titleTextId:"TASK_BUILDAMBERCHEST_SUMMARY",descriptionTextId:"TASK_BUILDAMBERCHEST_EXPLAIN",completeTextId:"TASK_BUILDAMBERCHEST_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"amberchestworkshop"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Treasure Chest",count:1}}],startupScript:"buildAmberChestStartupScript",visibleScript:"buildAmberChestVisibleScript"};
L.archetypes.openAmberChest={titleTextId:"TASK_OPENAMBERCHEST_SUMMARY",descriptionTextId:"TASK_OPENAMBERCHEST_EXPLAIN",completeTextId:"TASK_OPENAMBERCHEST_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_amber.svg",alwaysActive:!1,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"amberchest"}},conditionList:[{name:"entitiesDispensed",params:{dispenserfamilyName:"amberchest"},count:1}]};L.archetypes.speedUp={titleTextId:"TASK_SPEEDUP_SUMMARY",descriptionTextId:"TASK_SPEEDUP_EXPLAIN",
completeTextId:"TASK_SPEEDUP_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_time.svg",alwaysActive:!1,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"hq"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"HQ",count:1,noScaffolds:!0}}]};L.archetypes.goToCaves={titleTextId:"TASK_GOTOCAVES_SUMMARY",descriptionTextId:"TASK_GOTOCAVES_EXPLAIN",completeTextId:"TASK_GOTOCAVES_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_goto.svg",alwaysActive:!1,
isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"mapbannerling"}},conditionList:[{name:"onEvent",params:{eventName:"GoToCavesTaskComplete"},count:1}],startupScript:"goToCavesStartupScript",visibleScript:"goToCavesVisibleScript"};L.archetypes.buildOutpost={titleTextId:"TASK_BUILDOUTPOST_SUMMARY",descriptionTextId:"TASK_BUILDOUTPOST_EXPLAIN",completeTextId:"TASK_BUILDOUTPOST_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,
locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"outpostworkshop",carryFamilyName:"suggestOutpost"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Outpost",count:1}}],startupScript:"buildOutpostStartupScript",visibleScript:"buildOutpostVisibleScript",completionScript:"buildOutpostCompleteScript"};L.archetypes.moveBuilding={titleTextId:"TASK_MOVEBUILDING_SUMMARY",descriptionTextId:"TASK_MOVEBUILDING_EXPLAIN",completeTextId:"TASK_MOVEBUILDING_COMPLETE",amberReward:1,xpReward:20,
iconPath:"gui/task_icon_move.svg",alwaysActive:!1,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"outpost",carryFamilyName:"suggestOutpost"}},conditionList:[{name:"buildingMoved",params:{},count:1}]};L.archetypes.speedUpOutpost={titleTextId:"TASK_SPEEDUP_OUTPOST_SUMMARY",descriptionTextId:"TASK_SPEEDUP_OUTPOST_EXPLAIN",completeTextId:"TASK_SPEEDUP_OUTPOST_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_time.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",
params:{familyName:"outpost"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Outpost",count:1,noScaffolds:!0}}]};L.archetypes.buildBarricade={titleTextId:"TASK_BUILDBARRICADE_SUMMARY",descriptionTextId:"TASK_BUILDBARRICADE_EXPLAIN",completeTextId:"TASK_BUILDBARRICADE_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"barricadeworkshop"}},conditionList:[{name:"buildingBuilt",
params:{buildingType:"Barricade",count:1}}],startupScript:"buildBarricadeStartupScript",visibleScript:"buildBarricadeVisibleScript",completionScript:"buildBarricadeCompleteScript"};L.archetypes.buildGate={titleTextId:"TASK_BUILDGATE_SUMMARY",descriptionTextId:"TASK_BUILDGATE_EXPLAIN",completeTextId:"TASK_BUILDGATE_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"barricadeworkshop"}},
conditionList:[{name:"buildingBuilt",params:{buildingType:"Barricade Gate",count:1}}],startupScript:"buildWoodenGateStartupScript",visibleScript:"buildWoodenGateVisibleScript",completionScript:"buildGateCompleteScript"};L.archetypes.buildGatling={titleTextId:"TASK_BUILDGATLING_SUMMARY",descriptionTextId:"TASK_BUILDGATLING_EXPLAIN",completeTextId:"TASK_BUILDGATLING_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",
params:{preCarryFamilyName:"turretworkshop"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Turret",count:1}}],startupScript:"buildGatlingStartupScript",visibleScript:"buildGatlingVisibleScript"};L.archetypes.speedUpGatling={titleTextId:"TASK_SPEEDUP_GATLING_SUMMARY",descriptionTextId:"TASK_SPEEDUP_GATLING_EXPLAIN",completeTextId:"TASK_SPEEDUP_GATLING_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_time.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",
params:{familyName:"Turret"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Turret",count:1,noScaffolds:!0}}]};L.archetypes.startCampaign={titleTextId:"TASK_STARTCAMPAIGN_SUMMARY",descriptionTextId:"TASK_STARTCAMPAIGN_EXPLAIN",completeTextId:"TASK_STARTCAMPAIGN_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_fight.svg",alwaysActive:!1,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"mapbannerling"}},conditionList:[{name:"onEvent",params:{eventName:"StartCampaignTaskComplete"},
count:1}],startupScript:"disableCampaignsScript",visibleScript:"startCampaignScript"};L.archetypes.winCampaign={titleTextId:"TASK_WINCAMPAIGN_SUMMARY",descriptionTextId:"TASK_WINCAMPAIGN_EXPLAIN",completeTextId:"TASK_WINCAMPAIGN_COMPLETE",amberReward:1,xpReward:300,iconPath:"gui/task_icon_fight.svg",alwaysActive:!1,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"outpost"}},conditionList:[{name:"onEvent",params:{eventName:"WinCampaignTaskComplete"},count:1}],startupScript:"firstCampaignBigUnlockStartupScript",
visibleScript:"winCampaignScript",completionScript:"enableBuildingMovement"};L.archetypes.buildLumberStorage={titleTextId:"TASK_BUILDLUMBERSTORAGE_SUMMARY",descriptionTextId:"TASK_BUILDLUMBERSTORAGE_EXPLAIN",completeTextId:"TASK_BUILDLUMBERSTORAGE_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"lumberstorageworkshop"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Lumber Storage",
count:1}}]};L.archetypes.buildStoneStorage={titleTextId:"TASK_BUILDSTONESTORAGE_SUMMARY",descriptionTextId:"TASK_BUILDSTONESTORAGE_EXPLAIN",completeTextId:"TASK_BUILDSTONESTORAGE_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"stonestorageworkshop"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Stone Storage",count:1}}]};L.archetypes.buildWalls={titleTextId:"TASK_BUILDWALLS_SUMMARY",
descriptionTextId:"TASK_BUILDWALLS_EXPLAIN",completeTextId:"TASK_BUILDWALLS_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"wallworkshop"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Wall",count:1}}],startupScript:"buildStoneWallStartupScript",visibleScript:"buildStoneWallVisibleScript"};L.archetypes.buildStoneGate={titleTextId:"TASK_BUILDSTONEGATE_SUMMARY",descriptionTextId:"TASK_BUILDSTONEGATE_EXPLAIN",
completeTextId:"TASK_BUILDSTONEGATE_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"gateworkshop"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Gate",count:1}}],startupScript:"buildStoneGateStartupScript",visibleScript:"buildStoneGateVisibleScript"};L.archetypes.buildTower={titleTextId:"TASK_BUILDTOWER_SUMMARY",descriptionTextId:"TASK_BUILDTOWER_EXPLAIN",completeTextId:"TASK_BUILDTOWER_COMPLETE",
amberReward:1,xpReward:100,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"towerworkshop"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Tower",count:1}}],startupScript:"buildStoneTowerStartupScript",visibleScript:"buildStoneTowerVisibleScript"};L.archetypes.buildTrap={titleTextId:"TASK_BUILDTRAP_SUMMARY",descriptionTextId:"TASK_BUILDTRAP_EXPLAIN",completeTextId:"TASK_BUILDTRAP_COMPLETE",amberReward:1,
xpReward:20,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"trapworkshop"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Trap",count:1}}],startupScript:"buildTrapStartupScript",visibleScript:"buildTrapVisibleScript"};L.archetypes.startCampaign2={titleTextId:"TASK_STARTCAMPAIGN2_SUMMARY",descriptionTextId:"TASK_STARTCAMPAIGN2_EXPLAIN",completeTextId:"TASK_STARTCAMPAIGN2_COMPLETE",amberReward:1,xpReward:20,
iconPath:"gui/task_icon_fight.svg",alwaysActive:!1,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"mapbannerling"}},conditionList:[{name:"onEvent",params:{eventName:"StartCampaign2TaskComplete"},count:1}],visibleScript:"startCampaign2Script"};L.archetypes.goToTotemAgility={titleTextId:"TASK_GOTOTOTEMAGILITY_SUMMARY",descriptionTextId:"TASK_GOTOTOTEMAGILITY_EXPLAIN",completeTextId:"TASK_GOTOTOTEMAGILITY_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_goto.svg",
alwaysActive:!1,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"totemAgility"}},conditionList:[{name:"onEvent",params:{eventName:"GoToTotemAgilityTaskComplete"},count:1}],visibleScript:"goToTotemAgilityScript"};L.archetypes.goToTotemPower={titleTextId:"TASK_GOTOTOTEMPOWER_SUMMARY",descriptionTextId:"TASK_GOTOTOTEMPOWER_EXPLAIN",completeTextId:"TASK_GOTOTOTEMPOWER_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_goto.svg",alwaysActive:!1,isCritical:!0,
locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"totemPower"}},conditionList:[{name:"onEvent",params:{eventName:"GoToTotemPowerTaskComplete"},count:1}],visibleScript:"goToTotemPowerScript"};L.archetypes.goToTotemProtection={titleTextId:"TASK_GOTOTOTEMPROTECTION_SUMMARY",descriptionTextId:"TASK_GOTOTOTEMPROTECTION_EXPLAIN",completeTextId:"TASK_GOTOTOTEMPROTECTION_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_goto.svg",alwaysActive:!1,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",
params:{familyName:"totemProtection"}},conditionList:[{name:"onEvent",params:{eventName:"GoToTotemProtectionTaskComplete"},count:1}],visibleScript:"goToTotemProtectionScript"};L.archetypes.goToTotemTechnology={titleTextId:"TASK_GOTOTOTEMTECHNOLOGY_SUMMARY",descriptionTextId:"TASK_GOTOTOTEMTECHNOLOGY_EXPLAIN",completeTextId:"TASK_GOTOTOTEMTECHNOLOGY_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_goto.svg",alwaysActive:!1,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",
params:{familyName:"totemTechnology"}},conditionList:[{name:"onEvent",params:{eventName:"GoToTotemTechnologyTaskComplete"},count:1}],visibleScript:"goToTotemTechnologyScript"};L.archetypes.bargeAttack={titleTextId:"TASK_CHARGEATTACK_SUMMARY",descriptionTextId:"TASK_CHARGEATTACK_EXPLAIN",completeTextId:"TASK_CHARGEATTACK_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_fight.svg",alwaysActive:!1,isCritical:!0,conditionList:[{name:"onEvent",params:{eventName:"ChargeAttack"},count:3}]};L.archetypes.buildHQLevel2=
{titleTextId:"TASK_BUILDHQLEVEL2_SUMMARY",descriptionTextId:"TASK_BUILDHQLEVEL2_EXPLAIN",completeTextId:"TASK_BUILDHQLEVEL2_COMPLETE",amberReward:1,xpReward:200,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"hq"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"HQ",level:2,count:1}}]};L.archetypes.buildStoneStorageLevel2={titleTextId:"TASK_BUILDSTONESTORAGELEVEL2_SUMMARY",descriptionTextId:"TASK_BUILDSTONESTORAGELEVEL2_EXPLAIN",
completeTextId:"TASK_BUILDSTONESTORAGELEVEL2_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_upgrade.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"stonestorage"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Stone Storage",level:2,count:1}}]};L.archetypes.buildLumberStorageLevel2={titleTextId:"TASK_BUILDLUMBERSTORAGELEVEL2_SUMMARY",descriptionTextId:"TASK_BUILDLUMBERSTORAGELEVEL2_EXPLAIN",completeTextId:"TASK_BUILDLUMBERSTORAGELEVEL2_COMPLETE",
amberReward:1,xpReward:100,iconPath:"gui/task_icon_upgrade.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"lumberstorage"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Lumber Storage",level:2,count:1}}]};L.archetypes.wakeUpWildling={titleTextId:"TASK_WAKEUPWILDLING_SUMMARY",descriptionTextId:"TASK_WAKEUPWILDLING_EXPLAIN",completeTextId:"TASK_WAKEUPWILDLING_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_exclaim.svg",
alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestSleepingWildling",params:{}},conditionList:[{name:"onEvent",params:{eventName:"WildlingWokenUp"},count:1}]};L.archetypes.buildStonemillLevel2={titleTextId:"TASK_BUILDSTONEMILLLEVEL2_SUMMARY",descriptionTextId:"TASK_BUILDSTONEMILLLEVEL2_EXPLAIN",completeTextId:"TASK_BUILDSTONEMILLLEVEL2_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_upgrade.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"stonemill"}},
conditionList:[{name:"buildingBuilt",params:{buildingType:"Stonemill",level:2,count:1}}]};L.archetypes.buildSecondStonelingHut={titleTextId:"TASK_BUILDSECONDSTONELINGHUT_SUMMARY",descriptionTextId:"TASK_BUILDSECONDSTONELINGHUT_EXPLAIN",completeTextId:"TASK_BUILDSECONDSTONELINGHUT_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"stonelinghutworkshop"}},conditionList:[{name:"buildingBuilt",
params:{buildingType:"Stoneling Hut",count:2}}]};L.archetypes.buildLumbermillLevel2={titleTextId:"TASK_BUILDLUMBERMILLLEVEL2_SUMMARY",descriptionTextId:"TASK_BUILDLUMBERMILLLEVEL2_EXPLAIN",completeTextId:"TASK_BUILDLUMBERMILLLEVEL2_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_upgrade.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"lumbermill"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Lumbermill",level:2,count:1}}]};
L.archetypes.buildSecondLumberlingHut={titleTextId:"TASK_BUILDSECONDLUMBERLINGHUT_SUMMARY",descriptionTextId:"TASK_BUILDSECONDLUMBERLINGHUT_EXPLAIN",completeTextId:"TASK_BUILDSECONDLUMBERLINGHUT_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"lumberlinghutworkshop"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Lumberling Hut",count:2}}]};L.archetypes.buildSecondDefendlingHut=
{titleTextId:"TASK_BUILDSECONDDEFENDLINGHUT_SUMMARY",descriptionTextId:"TASK_BUILDSECONDDEFENDLINGHUT_EXPLAIN",completeTextId:"TASK_BUILDSECONDDEFENDLINGHUT_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"defendlinghutworkshop"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Defendling Hut",count:2}}]};L.archetypes.buildLibrary={titleTextId:"TASK_BUILDLIBRARY_SUMMARY",
descriptionTextId:"TASK_BUILDLIBRARY_EXPLAIN",completeTextId:"TASK_BUILDLIBRARY_COMPLETE",amberReward:1,xpReward:400,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"libraryworkshop"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Library",count:1}}]};L.archetypes.buildSecondOutpost={titleTextId:"TASK_BUILDSECONDOUTPOST_SUMMARY",descriptionTextId:"TASK_BUILDSECONDOUTPOST_EXPLAIN",completeTextId:"TASK_BUILDSECONDOUTPOST_COMPLETE",
amberReward:1,xpReward:200,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"outpostworkshop"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Outpost",count:2}}]};L.archetypes.levelUpHeroAtShrine={titleTextId:"TASK_LEVELUPHEROATSHRINE_SUMMARY",descriptionTextId:"TASK_LEVELUPHEROATSHRINE_EXPLAIN",completeTextId:"TASK_LEVELUPHEROATSHRINE_COMPLETE",amberReward:1,xpReward:200,iconPath:"gui/task_icon_upgrade.svg",
alwaysActive:!1,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"totemPower"}},conditionList:[{name:"onEvent",params:{eventName:"HeroUpgraded"},count:1}]};L.archetypes.buildMarketplace={titleTextId:"TASK_BUILDMARKETPLACE_SUMMARY",descriptionTextId:"TASK_BUILDMARKETPLACE_EXPLAIN",completeTextId:"TASK_BUILDMARKETPLACE_COMPLETE",amberReward:1,xpReward:200,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"marketplaceworkshop"}},
conditionList:[{name:"buildingBuilt",params:{buildingType:"Marketplace",count:1}}],startupScript:"buildMarketplaceStartupScript",visibleScript:"buildMarketplaceVisibleScript",completionScript:"buildMarketplaceCompleteScript"};L.archetypes.buildDecoration={titleTextId:"TASK_BUILDDECORATION_SUMMARY",descriptionTextId:"TASK_BUILDDECORATION_EXPLAIN",completeTextId:"TASK_BUILDDECORATION_COMPLETE",amberReward:1,xpReward:200,iconPath:"gui/task_icon_build.svg",alwaysActive:!1,isCritical:!0,locationFinder:{name:"buildLocation",
params:{preCarryFamilyName:"lightmarketplace"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Light",count:1}}]};L.archetypes.buildDefenceFactoryLevel2={titleTextId:"TASK_BUILDDEFENCEFACTORYLEVEL2_SUMMARY",descriptionTextId:"TASK_BUILDDEFENCEFACTORYLEVEL2_EXPLAIN",completeTextId:"TASK_BUILDDEFENCEFACTORYLEVEL2_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_upgrade.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"Defence Factory"}},
conditionList:[{name:"buildingBuilt",params:{buildingType:"Defence Factory",level:2,count:1}}]};L.archetypes.buildDefendlingHutLevel2={titleTextId:"TASK_BUILDDEFENDLINGHUTLEVEL2_SUMMARY",descriptionTextId:"TASK_BUILDDEFENDLINGHUTLEVEL2_EXPLAIN",completeTextId:"TASK_BUILDDEFENDLINGHUTLEVEL2_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_upgrade.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"Defendling Hut"}},conditionList:[{name:"buildingBuilt",
params:{buildingType:"Defendling Hut",level:2,count:1}}]};L.archetypes.buildOutpostLevel2={titleTextId:"TASK_BUILDOUTPOSTLEVEL2_SUMMARY",descriptionTextId:"TASK_BUILDOUTPOSTLEVEL2_EXPLAIN",completeTextId:"TASK_BUILDOUTPOSTLEVEL2_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_upgrade.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"outpost"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Outpost",level:2,count:1}}]};
L.archetypes.buildHQLevel3={titleTextId:"TASK_BUILDHQLEVEL3_SUMMARY",descriptionTextId:"TASK_BUILDHQLEVEL3_EXPLAIN",completeTextId:"TASK_BUILDHQLEVEL3_COMPLETE",amberReward:1,xpReward:300,iconPath:"gui/task_icon_upgrade.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"hq"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"HQ",level:3,count:1}}]};L.archetypes.buildStoneStorageLevel3={titleTextId:"TASK_BUILDSTONESTORAGELEVEL3_SUMMARY",
descriptionTextId:"TASK_BUILDSTONESTORAGELEVEL3_EXPLAIN",completeTextId:"TASK_BUILDSTONESTORAGELEVEL3_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_upgrade.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"stonestorage"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Stone Storage",level:3,count:1}}]};L.archetypes.buildLumberStorageLevel3={titleTextId:"TASK_BUILDLUMBERSTORAGELEVEL3_SUMMARY",descriptionTextId:"TASK_BUILDLUMBERSTORAGELEVEL3_EXPLAIN",
completeTextId:"TASK_BUILDLUMBERSTORAGELEVEL3_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_upgrade.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"lumberstorage"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Lumber Storage",level:3,count:1}}]};L.archetypes.buildDefenceFactoryLevel3={titleTextId:"TASK_BUILDDEFENCEFACTORYLEVEL3_SUMMARY",descriptionTextId:"TASK_BUILDDEFENCEFACTORYLEVEL3_EXPLAIN",completeTextId:"TASK_BUILDDEFENCEFACTORYLEVEL3_COMPLETE",
amberReward:1,xpReward:100,iconPath:"gui/task_icon_upgrade.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"Defence Factory"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Defence Factory",level:3,count:1}}]};L.archetypes.buildDefendlingHutLevel3={titleTextId:"TASK_BUILDDEFENDLINGHUTLEVEL3_SUMMARY",descriptionTextId:"TASK_BUILDDEFENDLINGHUTLEVEL3_EXPLAIN",completeTextId:"TASK_BUILDDEFENDLINGHUTLEVEL3_COMPLETE",amberReward:1,xpReward:100,
iconPath:"gui/task_icon_upgrade.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"Defendling Hut"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Defendling Hut",level:3,count:1}}]};L.archetypes.buildOutpostLevel3={titleTextId:"TASK_BUILDOUTPOSTLEVEL3_SUMMARY",descriptionTextId:"TASK_BUILDOUTPOSTLEVEL3_EXPLAIN",completeTextId:"TASK_BUILDOUTPOSTLEVEL3_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_upgrade.svg",alwaysActive:!0,
isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"outpost"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Outpost",level:3,count:1}}]};L.archetypes.buildSecondStoneStorage={titleTextId:"TASK_BUILDSECONDSTONESTORAGE_SUMMARY",descriptionTextId:"TASK_BUILDSECONDSTONESTORAGE_EXPLAIN",completeTextId:"TASK_BUILDSECONDSTONESTORAGE_COMPLETE",amberReward:1,xpReward:200,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",
params:{preCarryFamilyName:"stonestorageworkshop"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Stone Storage",count:2}}]};L.archetypes.buildSecondLumberStorage={titleTextId:"TASK_BUILDSECONDLUMBERSTORAGE_SUMMARY",descriptionTextId:"TASK_BUILDSECONDLUMBERSTORAGE_EXPLAIN",completeTextId:"TASK_BUILDSECONDLUMBERSTORAGE_COMPLETE",amberReward:1,xpReward:200,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"lumberstorageworkshop"}},
conditionList:[{name:"buildingBuilt",params:{buildingType:"Lumber Storage",count:2}}]};L.archetypes.buildHQLevel4={titleTextId:"TASK_BUILDHQLEVEL4_SUMMARY",descriptionTextId:"TASK_BUILDHQLEVEL4_EXPLAIN",completeTextId:"TASK_BUILDHQLEVEL4_COMPLETE",amberReward:1,xpReward:400,iconPath:"gui/task_icon_upgrade.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"hq"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"HQ",level:4,count:1}}]};L.archetypes.buildHQLevel5=
{titleTextId:"TASK_BUILDHQLEVEL5_SUMMARY",descriptionTextId:"TASK_BUILDHQLEVEL5_EXPLAIN",completeTextId:"TASK_BUILDHQLEVEL5_COMPLETE",amberReward:1,xpReward:500,iconPath:"gui/task_icon_upgrade.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"hq"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"HQ",level:5,count:1}}]};L.archetypes.buildHQLevel6={titleTextId:"TASK_BUILDHQLEVEL6_SUMMARY",descriptionTextId:"TASK_BUILDHQLEVEL6_EXPLAIN",
completeTextId:"TASK_BUILDHQLEVEL6_COMPLETE",amberReward:1,xpReward:600,iconPath:"gui/task_icon_upgrade.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"hq"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"HQ",level:6,count:1}}]};L.archetypes.buildHQLevel7={titleTextId:"TASK_BUILDHQLEVEL7_SUMMARY",descriptionTextId:"TASK_BUILDHQLEVEL7_EXPLAIN",completeTextId:"TASK_BUILDHQLEVEL7_COMPLETE",amberReward:1,xpReward:700,iconPath:"gui/task_icon_upgrade.svg",
alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"hq"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"HQ",level:7,count:1}}]};L.archetypes.buildHQLevel8={titleTextId:"TASK_BUILDHQLEVEL8_SUMMARY",descriptionTextId:"TASK_BUILDHQLEVEL8_EXPLAIN",completeTextId:"TASK_BUILDHQLEVEL8_COMPLETE",amberReward:1,xpReward:800,iconPath:"gui/task_icon_upgrade.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"hq"}},
conditionList:[{name:"buildingBuilt",params:{buildingType:"HQ",level:8,count:1}}]};L.archetypes.buildHQLevel9={titleTextId:"TASK_BUILDHQLEVEL9_SUMMARY",descriptionTextId:"TASK_BUILDHQLEVEL9_EXPLAIN",completeTextId:"TASK_BUILDHQLEVEL9_COMPLETE",amberReward:1,xpReward:900,iconPath:"gui/task_icon_upgrade.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"hq"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"HQ",level:9,count:1}}]};L.archetypes.buildHQLevel10=
{titleTextId:"TASK_BUILDHQLEVEL10_SUMMARY",descriptionTextId:"TASK_BUILDHQLEVEL10_EXPLAIN",completeTextId:"TASK_BUILDHQLEVEL10_COMPLETE",amberReward:1,xpReward:1E3,iconPath:"gui/task_icon_upgrade.svg",alwaysActive:!0,isCritical:!0,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"hq"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"HQ",level:10,count:1}}]};L.fillerTaskList=[["shootMushroom"],["chopTree1"],["rotateCamera"],["shootXPPlant"],["mineStone1"],["chopTree2"],
["pauseGame"],["mineStone2"],["shootMushroom3"],["buildFlag"],["shootXPPlant3"],["chopTree3"],["buildLight"],["mineStone3"],["killThumplings5"],["buildFlowerbed"],["killDartlings5"],["buildFountain"],["killBoomlings5"],["buildStatue"],["killShuntlings3"],["killBreachlings2"],["killChiefling"],["killAmberling"]];L.archetypes.chopTree1={titleTextId:"TASK_CHOPTREE1_SUMMARY",descriptionTextId:"TASK_CHOPTREE_EXPLAIN",completeTextId:"TASK_CHOPTREE1_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_chop.svg",
alwaysActive:!1,isCritical:!1,conditionList:[{name:"chopTree",count:1}],locationFinder:{name:"nearestResourceDispenser",params:{familyName:"tree"}}};L.archetypes.chopTree2={titleTextId:"TASK_CHOPTREE5_SUMMARY",descriptionTextId:"TASK_CHOPTREE_EXPLAIN",completeTextId:"TASK_CHOPTREE_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_chop.svg",alwaysActive:!1,isCritical:!1,conditionList:[{name:"chopTree",count:5}],locationFinder:{name:"nearestResourceDispenser",params:{familyName:"tree"}}};
L.archetypes.chopTree3={titleTextId:"TASK_CHOPTREE10_SUMMARY",descriptionTextId:"TASK_CHOPTREE_EXPLAIN",completeTextId:"TASK_CHOPTREE_COMPLETE",amberReward:1,xpReward:200,iconPath:"gui/task_icon_chop.svg",alwaysActive:!1,isCritical:!1,conditionList:[{name:"chopTree",count:10}],locationFinder:{name:"nearestResourceDispenser",params:{familyName:"tree"}}};L.archetypes.mineStone1={titleTextId:"TASK_MINESTONE1_SUMMARY",descriptionTextId:"TASK_MINESTONE_EXPLAIN",completeTextId:"TASK_MINESTONE1_COMPLETE",
amberReward:1,xpReward:20,iconPath:"gui/task_icon_mine.svg",alwaysActive:!1,isCritical:!1,conditionList:[{name:"mineStone",count:1}],locationFinder:{name:"nearestResourceDispenser",params:{familyName:"rock"}}};L.archetypes.mineStone2={titleTextId:"TASK_MINESTONE5_SUMMARY",descriptionTextId:"TASK_MINESTONE_EXPLAIN",completeTextId:"TASK_MINESTONE_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_mine.svg",alwaysActive:!1,isCritical:!1,conditionList:[{name:"mineStone",count:5}],locationFinder:{name:"nearestResourceDispenser",
params:{familyName:"rock"}}};L.archetypes.mineStone3={titleTextId:"TASK_MINESTONE10_SUMMARY",descriptionTextId:"TASK_MINESTONE_EXPLAIN",completeTextId:"TASK_MINESTONE_COMPLETE",amberReward:1,xpReward:200,iconPath:"gui/task_icon_mine.svg",alwaysActive:!1,isCritical:!1,conditionList:[{name:"mineStone",count:10}],locationFinder:{name:"nearestResourceDispenser",params:{familyName:"rock"}}};L.archetypes.goFullScreen={titleTextId:"TASK_GOFULLSCREEN_SUMMARY",descriptionTextId:"TASK_GOFULLSCREEN_EXPLAIN",
completeTextId:"TASK_GOFULLSCREEN_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_fullscreen.svg",alwaysActive:!1,isCritical:!1,conditionList:[{name:"onEvent",params:{eventName:"GoFullScreen"},count:1}]};L.archetypes.killThumplings5={titleTextId:"TASK_KILLTHUMPLINGS5_SUMMARY",descriptionTextId:"TASK_KILLTHUMPLINGS5_EXPLAIN",completeTextId:"TASK_KILLTHUMPLINGS5_COMPLETE",amberReward:1,xpReward:200,iconPath:"gui/task_icon_fight.svg",alwaysActive:!1,isCritical:!1,locationFinder:{name:"nearestEntityOfFamilyName",
params:{familyName:"mapbannerling"}},conditionList:[{name:"enemyKilledByHero",params:{familyName:"basicmelee"},count:5}]};L.archetypes.killBreachlings2={titleTextId:"TASK_KILLBREACHLINGS2_SUMMARY",descriptionTextId:"TASK_KILLBREACHLINGS2_EXPLAIN",completeTextId:"TASK_KILLBREACHLINGS2_COMPLETE",amberReward:1,xpReward:200,iconPath:"gui/task_icon_fight.svg",alwaysActive:!1,isCritical:!1,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"mapbannerling"}},conditionList:[{name:"enemyKilledByHero",
params:{familyName:"berserker"},count:2}]};L.archetypes.killBoomlings5={titleTextId:"TASK_KILLBOOMLINGS5_SUMMARY",descriptionTextId:"TASK_KILLBOOMLINGS5_EXPLAIN",completeTextId:"TASK_KILLBOOMLINGS5_COMPLETE",amberReward:1,xpReward:200,iconPath:"gui/task_icon_fight.svg",alwaysActive:!1,isCritical:!1,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"mapbannerling"}},conditionList:[{name:"enemyKilledByHero",params:{familyName:"bombthrower"},count:5}]};L.archetypes.killChiefling={titleTextId:"TASK_KILLCHIEFLINGS_SUMMARY",
descriptionTextId:"TASK_KILLCHIEFLINGS_EXPLAIN",completeTextId:"TASK_KILLCHIEFLINGS_COMPLETE",amberReward:1,xpReward:200,iconPath:"gui/task_icon_fight.svg",alwaysActive:!1,isCritical:!1,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"mapbannerling"}},conditionList:[{name:"enemyKilledByHero",params:{familyName:"charger_boss"},count:1}]};L.archetypes.killShuntlings3={titleTextId:"TASK_KILLSTUNTLINGS3_SUMMARY",descriptionTextId:"TASK_KILLSTUNTLINGS3_EXPLAIN",completeTextId:"TASK_KILLSTUNTLINGS3_COMPLETE",
amberReward:1,xpReward:200,iconPath:"gui/task_icon_fight.svg",alwaysActive:!1,isCritical:!1,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"mapbannerling"}},conditionList:[{name:"enemyKilledByHero",params:{familyName:"mini_charger"},count:3}]};L.archetypes.killDartlings5={titleTextId:"TASK_KILLDARTLINGS5_SUMMARY",descriptionTextId:"TASK_KILLDARTLINGS5_EXPLAIN",completeTextId:"TASK_KILLDARTLINGS5_COMPLETE",amberReward:1,xpReward:200,iconPath:"gui/task_icon_fight.svg",alwaysActive:!1,
isCritical:!1,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"mapbannerling"}},conditionList:[{name:"enemyKilledByHero",params:{familyName:"ranged"},count:5}]};L.archetypes.killAmberling={titleTextId:"TASK_KILLAMBERLING_SUMMARY",descriptionTextId:"TASK_KILLAMBERLING_EXPLAIN",completeTextId:"TASK_KILLAMBERLING_COMPLETE",amberReward:1,xpReward:200,iconPath:"gui/task_icon_fight.svg",alwaysActive:!1,isCritical:!1,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"mapbannerling"}},
conditionList:[{name:"enemyKilledByHero",params:{familyName:"treasuredropper"},count:1}]};L.archetypes.pauseGame={titleTextId:"TASK_PAUSEGAME_SUMMARY",descriptionTextId:"TASK_PAUSEGAME_EXPLAIN",completeTextId:"TASK_PAUSEGAME_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_exclaim.svg",alwaysActive:!1,isCritical:!1,conditionList:[{name:"onEvent",params:{eventName:"PauseGame"},count:1}]};L.archetypes.rotateCamera={titleTextId:"TASK_ROTATECAMERA_SUMMARY",descriptionTextId:"TASK_ROTATECAMERA_EXPLAIN",
completeTextId:"TASK_ROTATECAMERA_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_exclaim.svg",alwaysActive:!1,isCritical:!1,conditionList:[{name:"onEvent",params:{eventName:"RotateCamera"},count:1}]};L.archetypes.shootMushroom={titleTextId:"TASK_SHOOTMUSHROOM_SUMMARY",descriptionTextId:"TASK_SHOOTMUSHROOM_EXPLAIN",completeTextId:"TASK_SHOOTMUSHROOM_COMPLETE",amberReward:1,xpReward:20,iconPath:"gui/task_icon_fight.svg",alwaysActive:!1,isCritical:!1,locationFinder:{name:"nearestEntityOfFamilyName",
params:{familyName:"mushroom"}},conditionList:[{name:"enemyKilledByHero",params:{familyName:"mushroom"},count:1}]};L.archetypes.buildFlag={titleTextId:"TASK_BUILDFLAG_SUMMARY",descriptionTextId:"TASK_BUILDFLAG_EXPLAIN",completeTextId:"TASK_BUILDFLAG_COMPLETE",amberReward:1,xpReward:200,iconPath:"gui/task_icon_build.svg",alwaysActive:!1,isCritical:!1,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"flagmarketplace"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Flag",
count:1}}]};L.archetypes.shootXPPlant={titleTextId:"TASK_SHOOTXPPLANT_SUMMARY",descriptionTextId:"TASK_SHOOTXPPLANT_EXPLAIN",completeTextId:"TASK_SHOOTXPPLANT_COMPLETE",amberReward:1,xpReward:100,iconPath:"gui/task_icon_fight.svg",alwaysActive:!1,isCritical:!1,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"xpplant"}},conditionList:[{name:"enemyKilledByHero",params:{familyName:"xpplant"},count:1}]};L.archetypes.buildFountain={titleTextId:"TASK_BUILDFOUNTAIN_SUMMARY",descriptionTextId:"TASK_BUILDFOUNTAIN_EXPLAIN",
completeTextId:"TASK_BUILDFOUNTAIN_COMPLETE",amberReward:1,xpReward:400,iconPath:"gui/task_icon_build.svg",alwaysActive:!1,isCritical:!1,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"monumentmarketplace"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Fountain",count:1}}]};L.archetypes.shootMushroom3={titleTextId:"TASK_SHOOTMUSHROOM3_SUMMARY",descriptionTextId:"TASK_SHOOTMUSHROOM3_EXPLAIN",completeTextId:"TASK_SHOOTMUSHROOM3_COMPLETE",amberReward:1,xpReward:200,iconPath:"gui/task_icon_fight.svg",
alwaysActive:!1,isCritical:!1,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"mushroom"}},conditionList:[{name:"enemyKilledByHero",params:{familyName:"mushroom"},count:3}]};L.archetypes.buildLight={titleTextId:"TASK_BUILDLIGHT_SUMMARY",descriptionTextId:"TASK_BUILDLIGHT_EXPLAIN",completeTextId:"TASK_BUILDLIGHT_COMPLETE",amberReward:1,xpReward:200,iconPath:"gui/task_icon_build.svg",alwaysActive:!1,isCritical:!1,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"lightmarketplace"}},
conditionList:[{name:"buildingBuilt",params:{buildingType:"Light",count:1}}]};L.archetypes.shootXPPlant3={titleTextId:"TASK_SHOOTXPPLANT3_SUMMARY",descriptionTextId:"TASK_SHOOTXPPLANT3_EXPLAIN",completeTextId:"TASK_SHOOTXPPLANT3_COMPLETE",amberReward:1,xpReward:200,iconPath:"gui/task_icon_fight.svg",alwaysActive:!1,isCritical:!1,locationFinder:{name:"nearestEntityOfFamilyName",params:{familyName:"xpplant"}},conditionList:[{name:"enemyKilledByHero",params:{familyName:"xpplant"},count:3}]};L.archetypes.buildFlowerbed=
{titleTextId:"TASK_BUILDFLOWERBED_SUMMARY",descriptionTextId:"TASK_BUILDFLOWERBED_EXPLAIN",completeTextId:"TASK_BUILDFLOWERBED_COMPLETE",amberReward:1,xpReward:200,iconPath:"gui/task_icon_build.svg",alwaysActive:!1,isCritical:!1,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"naturemarketplace"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Flowerbed",count:1}}]};L.archetypes.buildStatue={titleTextId:"TASK_BUILDSTATUE_SUMMARY",descriptionTextId:"TASK_BUILDSTATUE_EXPLAIN",
completeTextId:"TASK_BUILDSTATUE_COMPLETE",amberReward:1,xpReward:2500,iconPath:"gui/task_icon_build.svg",alwaysActive:!0,isCritical:!1,locationFinder:{name:"buildLocation",params:{preCarryFamilyName:"monumentmarketplace"}},conditionList:[{name:"buildingBuilt",params:{buildingType:"Statue",count:1}}]};e.archetypes.a_tlm_tasklocationmarker={shouldLevelSave:!1,shouldPlayerSave:!1,familyName:"tasklocationmarker",ECMesh:{scale:3,offsetY:0.75,path:"environment/models/arrow_blue.dae"},ECMeshAnimation:{v3RotationSpeed:[0,
0.5,0],v3Offset:[0,0.3,0],v3OffsetFrequency:[0,0.75,0]}};e.archetypes.a_tle_tasklocationeffect={shouldLevelSave:!1,shouldPlayerSave:!1,familyName:"tasklocationeffect",ECEffectSpawner:{incidentalEffect:"taskLocation",incidentalMinTime:3,incidentalMaxTime:3},ECWorldGui:{offScreenGuiArchetype:"activeTaskOffScreenGui",visibleAlways:!0,visibleOnActivated:!0}};e.archetypes.a_tlm_criticaltasklocationmarker={shouldLevelSave:!1,shouldPlayerSave:!1,familyName:"tasklocationmarker",ECMesh:{scale:3,offsetY:0.75,
path:"environment/models/arrow_amber.dae"},ECMeshAnimation:{v3RotationSpeed:[0,0.5,0],v3Offset:[0,0.3,0],v3OffsetFrequency:[0,0.75,0]}};e.archetypes.a_tle_criticaltasklocationeffect={shouldLevelSave:!1,shouldPlayerSave:!1,familyName:"tasklocationeffect",ECEffectSpawner:{incidentalEffect:"criticalTaskLocation",incidentalMinTime:3,incidentalMaxTime:3},ECWorldGui:{offScreenGuiArchetype:"activeTaskOffScreenGuiCritical",visibleAlways:!0,visibleOnActivated:!0}};i.archetypes.taskBoxWidget={layer:2,instructions:[{command:"renderSprite",
spritePath:"textures/duty_shadow.dds",scale:4},{command:"renderSVG",svgPath:"gui/tasks_bg.svg",scale:1,colorString:k.strings.modalDark},{command:"offsetCentre",x:0,y:-125},{command:"renderSVG",svgPath:"gui/tasks_header.svg",scale:1,colorString:k.strings.modalMedium},{command:"renderText",pointSize:26,text:"text1",font:"styled",upperCase:i.radialFontCase,align:1,boxWidth:270,boxHeight:400},{command:"offsetCentre",x:0,y:122},{command:"renderSVG",svgPath:"gui/tasks_body.svg",scale:1,colorString:k.strings.modalMedium},
{command:"renderText",pointSize:24,text:"text2",font:"regular",align:1,boxWidth:270,boxHeight:400},{command:"offsetCentre",x:0,y:75},{command:"offsetCentre",x:0,y:36},{command:"offsetCentre",x:-75,y:0},{command:"renderSVG",svgPath:"gui/task_reward_bg.svg",scale:1,colorString:k.strings.modalMedium},{command:"offsetCentre",x:-4,y:0},{command:"renderText",pointSize:16,text:"text3",font:"bold",upperCase:i.radialFontCase,align:0,boxWidth:270,boxHeight:400},{command:"offsetCentre",x:4,y:0},{command:"offsetCentre",
x:-42,y:0},{command:"renderSVG",svgPath:"gui/task_reward_square.svg",scale:1,colorString:k.strings.amber},{command:"renderSVG",svgPath:"gui/icon_amber.svg",colorString:k.strings.outline,scale:0.5},{command:"offsetCentre",x:42,y:0},{command:"offsetCentre",x:150,y:0},{command:"renderSVG",svgPath:"gui/task_reward_bg.svg",scale:1,colorString:k.strings.modalMedium},{command:"offsetCentre",x:-4,y:0},{command:"renderText",pointSize:16,text:"text4",font:"bold",upperCase:i.radialFontCase,align:0,boxWidth:270,
boxHeight:400},{command:"offsetCentre",x:4,y:0},{command:"offsetCentre",x:-43,y:0},{command:"renderSVG",svgPath:"gui/task_reward_square.svg",scale:1,colorString:k.strings.purple},{command:"renderSVG",svgPath:"gui/icon_plus_xp.svg",colorString:k.strings.outline,scale:0.9},{command:"offsetCentre",x:43,y:0},{command:"offsetCentre",x:-76,y:40},{command:"renderSVG",svgPath:"gui/task_sep.svg",scale:1,colorString:k.strings.modalVDark}]};i.archetypes.taskComplete={beginSFX:{name:"sfx_gui_task_panel_complete",
offsetX:0,offsetY:0},layer:2,instructions:[{command:"renderWidget",name:"taskBoxWidget"},{command:"offsetCentre",x:0,y:-346},{command:"renderSVG",svgPath:"gui/task_icon_bg.svg",scale:1,colorString:k.strings.greenButtonLight},{command:"renderSVG",svgPath:"gui/task_icon_bg_lowlight.svg",scale:1,colorString:k.strings.greenButtonDark},{command:"renderSVG",svgPath:"gui/icon_tick.svg",colorString:k.strings.outline,scale:0.5},{command:"offsetCentre",x:0,y:346}]};i.archetypes.taskDescription={layer:2,instructions:[{command:"renderWidget",
name:"taskBoxWidget"},{command:"offsetCentre",x:0,y:-346},{command:"renderSVG",svgPath:"gui/task_icon_bg.svg",scale:1,colorString:k.strings.normalButtonLight},{command:"renderSVG",svgPath:"gui/task_icon_bg_lowlight.svg",scale:1,colorString:k.strings.normalButtonDark},{command:"renderSVG",svgPathVar:"svg1",colorString:k.strings.outline,scale:1.25},{command:"offsetCentre",x:0,y:346}]};i.archetypes.taskIncompleteWidget={instructions:[{command:"offsetCentre",x:38,y:-14},{command:"offsetCentre",x:0,y:1},
{command:"renderText",pointSize:20,text:"text1",font:"bold",upperCase:i.radialFontCase,color:k.black,align:0},{command:"offsetCentre",x:0,y:-1},{command:"renderText",pointSize:20,text:"text1",font:"bold",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:-38,y:14},{command:"offsetCentre",x:55,y:10},{command:"renderSVG",svgPath:"gui/shape_task_reward.svg",scale:1,colorString:k.strings.amber},{command:"renderText",pointSize:16,text:"text2",font:"bold",upperCase:i.radialFontCase,color:k.outline,
align:1},{command:"offsetCentre",x:-38,y:-10}]};i.archetypes.taskInactiveWidget={instructions:[{command:"offsetCentre",x:-120,y:0},{command:"renderSprite",spritePath:"textures/task_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/task_corner_bg.svg",colorString:k.strings.normal,scaleX:1},{command:"renderSVG",svgPath:"gui/task_corner_bg_lowlight.svg",colorString:k.strings.darkNormal,scaleX:1},{command:"offsetCentre",x:1,y:0},{command:"renderSVG",svgPathVar:"svg1",colorString:k.strings.outline,
scaleX:1},{command:"offsetCentre",x:-1,y:0},{command:"renderSVG",svgPath:"gui/task_corner_frame.svg",colorString:k.strings.outline,scaleX:1},{command:"renderWidget",name:"taskIncompleteWidget"}]};i.archetypes.taskCriticalInactiveWidget={instructions:[{command:"offsetCentre",x:-120,y:0},{command:"renderSprite",spritePath:"textures/task_shadow.dds",scale:1},{command:"renderSVG",svgPath:"gui/task_corner_bg.svg",colorString:k.strings.amber,scaleX:1},{command:"renderSVG",svgPath:"gui/task_corner_bg_lowlight.svg",
colorString:k.strings.darkAmber,scaleX:1},{command:"offsetCentre",x:1,y:0},{command:"renderSVG",svgPathVar:"svg1",colorString:k.strings.outline,scaleX:1},{command:"offsetCentre",x:-1,y:0},{command:"renderSVG",svgPath:"gui/task_corner_frame.svg",colorString:k.strings.outline,scaleX:1},{command:"renderWidget",name:"taskIncompleteWidget"}]};i.archetypes.taskInactive={buttonSize:[300,74],beginSFX:{name:"sfx_gui_taskstarted",offsetX:0,offsetY:0},instructions:[{command:"renderWidget",name:"taskInactiveWidget"}]};
i.archetypes.taskPulsing={buttonSize:[300,74],beginSFX:{name:"sfx_gui_taskstarted",offsetX:0,offsetY:0},instructions:[{command:"applyPulseScale",frequency:2,amplitudeDiff:0.04},{command:"applyWobble",amount:0.5},{command:"renderWidget",name:"taskInactiveWidget"}]};i.archetypes.taskInactiveCritical={buttonSize:[300,74],beginSFX:{name:"sfx_gui_taskstarted",offsetX:0,offsetY:0},instructions:[{command:"renderWidget",name:"taskCriticalInactiveWidget"}]};i.archetypes.taskPulsingCritical={buttonSize:[300,
74],beginSFX:{name:"sfx_gui_taskstarted",offsetX:0,offsetY:0},instructions:[{command:"applyPulseScale",frequency:2,amplitudeDiff:0.05},{command:"applyWobble",amount:1},{command:"renderWidget",name:"taskCriticalInactiveWidget"}]};i.archetypes.taskInactiveLoud={instructions:[{command:"applyPulseScale",frequency:0.7,amplitudeDiff:0.1},{command:"applyWobble",amount:4},{command:"offsetCentre",x:180,y:-210},{command:"renderSprite",spritePath:"textures/arrow_vector_point_amber.dds",scale:1.1},{command:"offsetCentre",
x:-180,y:210},{command:"applyWobble",amount:-4}]};i.archetypes.badgeTaskComplete={instructions:[{command:"renderWidget",name:"burstWidgetSmall"},{command:"offsetCentre",x:-120,y:0},{command:"renderSVG",svgPath:"gui/shape_badge_filled.svg",scale:1,colorString:k.strings.amber},{command:"renderSVG",svgPath:"gui/shape_badge_progress_lowlight.svg",scale:1,colorString:k.strings.darkAmber},{command:"renderSVG",svgPath:"gui/shape_badge_bg.svg",scale:1,colorString:k.strings.outline},{command:"renderSVG",svgPath:"gui/shape_task_tick.svg",
scale:1,colorString:k.strings.outline},{command:"offsetCentre",x:38,y:-14},{command:"offsetCentre",x:0,y:1},{command:"renderText",pointSize:16,text:"text1",font:"styled",upperCase:i.radialFontCase,color:k.black,align:0},{command:"offsetCentre",x:0,y:-1},{command:"renderText",pointSize:16,text:"text1",font:"styled",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:-38,y:14},{command:"offsetCentre",x:38,y:10},{command:"offsetCentre",x:0,y:1},{command:"renderText",pointSize:16,text:"ACHIEVED!",
font:"styled",upperCase:i.radialFontCase,color:k.black,align:0},{command:"offsetCentre",x:0,y:-1},{command:"renderText",pointSize:16,text:"ACHIEVED!",font:"styled",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:-38,y:-10}]};i.archetypes.badgeTaskIncomplete={beginSFX:{name:"sfx_gui_badgestarted",offsetX:0,offsetY:0},instructions:[{command:"offsetCentre",x:-120,y:0},{command:"renderSVG",svgPath:"gui/shape_badge_filled.svg",scale:1,colorString:k.strings.outline},{command:"renderSVG",svgPath:"gui/shape_badge_filled.svg",
scale:1,colorString:k.strings.lightAmber},{command:"renderSVG",svgPath:"gui/shape_badge_progress.svg",colorString:k.strings.amber,alignX:0,scaleX:"scale1"},{command:"renderSVG",svgPath:"gui/shape_badge_progress_lowlight.svg",colorString:k.strings.darkAmber,alignX:0,scaleX:"scale1"},{command:"renderSVG",svgPath:"gui/shape_badge_bg.svg",scale:1,colorString:k.strings.outline},{command:"offsetCentre",x:38,y:-14},{command:"offsetCentre",x:0,y:1},{command:"renderText",pointSize:16,text:"text1",font:"styled",
upperCase:i.radialFontCase,color:k.black,align:0},{command:"offsetCentre",x:0,y:-1},{command:"renderText",pointSize:16,text:"text1",font:"styled",upperCase:i.radialFontCase,align:0},{command:"offsetCentre",x:-38,y:14},{command:"offsetCentre",x:55,y:10},{command:"renderSVG",svgPath:"gui/shape_task_reward.svg",scale:1,colorString:k.strings.amber},{command:"renderText",pointSize:16,text:"text2",font:"styled",upperCase:i.radialFontCase,color:k.outline,align:1},{command:"offsetCentre",x:-38,y:-10}]};i.archetypes.taskAcceptRewardButton=
{layer:3,buttonSize:[300,70],instructions:[{command:"applyPulseScale",frequency:1.8,amplitudeDiff:0.05},{command:"applyWobble",amount:2},{command:"renderSVG",svgPath:"gui/task_button.svg",colorString:k.strings.greenButtonLight,scaleX:2.12},{command:"offsetCentre",x:0,y:12},{command:"renderSVG",svgPath:"gui/task_button_lowlight.svg",colorString:k.strings.greenButtonDark,scaleX:2.12},{command:"offsetCentre",x:0,y:-12},{command:"renderText",pointSize:24,text:"text1",font:"styled",upperCase:i.radialFontCase,
color:k.outline,align:1}]};i.archetypes.taskDescriptionCloseButton={layer:3,buttonSize:[300,70],instructions:[{command:"applyPulseScale",frequency:1.8,amplitudeDiff:0.05},{command:"applyWobble",amount:2},{command:"renderSVG",svgPath:"gui/task_button.svg",colorString:k.strings.normalButtonLight,scaleX:2.12},{command:"offsetCentre",x:0,y:12},{command:"renderSVG",svgPath:"gui/task_button_lowlight.svg",colorString:k.strings.normalButtonDark,scaleX:2.12},{command:"offsetCentre",x:0,y:-12},{command:"renderText",
pointSize:24,text:"text1",font:"styled",upperCase:i.radialFontCase,color:k.outline,align:1}]};i.archetypes.activeTaskOffScreenGui={beginSFX:{name:"sfx_gui_newfillerquestarrow",offsetX:0,offsetY:0},layer:10,instructions:[{command:"applyRotateFromCentre",factor:1},{command:"applyPulseScale",frequency:1,amplitudeDiff:0.2},{command:"renderSprite",spritePath:"textures/arrow_vector_point_up_blue.dds",scale:1},{command:"applyRotateFromCentre",factor:-1}]};i.archetypes.activeTaskOffScreenGuiCritical={beginSFX:{name:"sfx_gui_newquestarrow",
offsetX:0,offsetY:0},layer:10,instructions:[{command:"applyRotateFromCentre",factor:1},{command:"applyPulseScale",frequency:1,amplitudeDiff:0.2},{command:"renderSprite",spritePath:"textures/arrow_vector_point_up_amber.dds",scale:1}]};i.archetypes.sleeping={layer:1,instructions:[{command:"offsetCentre",x:10,y:-85},{command:"applyWobble",amount:6},{command:"renderSVG",svgPath:"gui/icon_sleep.svg",colorString:k.strings.blackFaint,scale:1.4},{command:"offsetCentre",x:0,y:-3},{command:"applyWobble",amount:2},
{command:"renderSVG",svgPath:"gui/icon_sleep.svg",colorString:k.strings.outline,scale:1.4}]};i.archetypes.taskNewsflash={beginSFX:{name:"sfx_gui_newquest",offsetX:0,offsetY:40},instructions:[{command:"applyPulseScale",frequency:1,amplitudeDiff:0.01},{command:"offsetCentre",y:20},{command:"applyTextScale",textBoxWidth:500,text:"text1"},{command:"offsetCentre",y:5},{command:"renderSprite",spritePath:"textures/newsflash_top_shadow.dds",scale:3.8},{command:"offsetCentre",y:-5},{command:"renderSVG",svgPath:"gui/shape_newsflash_top.svg",
scaleX:1.05,scaleY:1,colorString:k.strings.amber},{command:"unApplyTextScale",text:"text1",textBoxWidth:500},{command:"renderText",text:"text1",pointSize:i.menuButtonFont,font:"styled",upperCase:!0,color:k.outline},{command:"offsetCentre",y:70},{command:"applyTextScale",textBoxWidth:500,text:"text2"},{command:"offsetCentre",y:5},{command:"renderSprite",spritePath:"textures/newsflash_top_shadow.dds",scale:3.6},{command:"offsetCentre",y:-5},{command:"renderSVG",svgPath:"gui/shape_newsflash_top.svg",
scaleX:0.95,scaleY:1,colorString:k.strings.darkAmber},{command:"unApplyTextScale",text:"text2",textBoxWidth:500},{command:"renderText",text:"text2",pointSize:i.menuButtonFont,font:"styled",upperCase:!0,color:k.outline},{command:"offsetCentre",y:-115},{command:"offsetCentre",x:-115},{command:"renderSVG",svgPath:"gui/shape_compassback.svg",scaleX:0.55,scaleY:0.55,colorString:k.strings.outline},{command:"renderSVG",svgPath:"gui/shape_compassbody.svg",scaleX:0.55,scaleY:0.55,colorString:k.strings.amber},
{command:"applySpinRotate",angle:2},{command:"renderSVG",svgPath:"gui/shape_compasshand.svg",scaleX:0.55,scaleY:0.55,colorString:k.strings.darkAmber},{command:"applySpinRotate",angle:-2}]};i.archetypes.preloadSVG={instructions:[{command:"renderSVG",svgPath:"gui/task_icon_amber.svg"},{command:"renderSVG",svgPath:"gui/task_icon_build.svg"},{command:"renderSVG",svgPath:"gui/task_icon_chop.svg"},{command:"renderSVG",svgPath:"gui/task_icon_exclaim.svg"},{command:"renderSVG",svgPath:"gui/task_icon_fight.svg"},
{command:"renderSVG",svgPath:"gui/task_icon_fullscreen.svg"},{command:"renderSVG",svgPath:"gui/task_icon_goto.svg"},{command:"renderSVG",svgPath:"gui/task_icon_hq.svg"},{command:"renderSVG",svgPath:"gui/task_icon_mine.svg"},{command:"renderSVG",svgPath:"gui/task_icon_repair.svg"},{command:"renderSVG",svgPath:"gui/task_icon_research.svg"},{command:"renderSVG",svgPath:"gui/task_icon_time.svg"},{command:"renderSVG",svgPath:"gui/task_icon_upgrade.svg"}]};Z.archetypes.dfx_dth_e_generic={visualEffectArchetypeList:["vfx_dth_e_generic1v",
"vfx_dth_e_generic2h","vfx_dth_e_generic2v","vfx_dth_e_generic3v"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_inc_death={visualEffectArchetypeList:["vfx_inc_death"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_mushroom1_puff={visualEffectArchetypeList:["vfx_mushroom_puff_1_1v","vfx_mushroom_puff_1_2h","vfx_mushroom_puff_1_2v","vfx_mushroom_puff_1_3v"],soundEffectArchetype:"aud_scenery_mushroom",screenShakeArchetype:void 0};Z.archetypes.sfx_mushroom2_puff=
{visualEffectArchetypeList:["vfx_mushroom_puff_2_1v","vfx_mushroom_puff_2_2h","vfx_mushroom_puff_2_2v","vfx_mushroom_puff_2_3v"],soundEffectArchetype:"aud_scenery_mushroom",screenShakeArchetype:void 0};Z.archetypes.sfx_mushroom3_puff={visualEffectArchetypeList:["vfx_mushroom_puff_3_1v","vfx_mushroom_puff_3_2h","vfx_mushroom_puff_3_2v","vfx_mushroom_puff_3_3v"],soundEffectArchetype:"aud_scenery_mushroom",screenShakeArchetype:void 0};Z.archetypes.sfx_mushroom_hit={visualEffectArchetypeList:["vfx_mushroom_hit1",
"vfx_mushroom_hit2","vfx_mushroom_hit3"],soundEffectArchetype:"aud_hit_mushroom",screenShakeArchetype:void 0};Z.archetypes.heroMeleeHit={visualEffectArchetypeList:["vfx_hero_melee_thump1h","vfx_hero_melee_thump1v"],soundEffectArchetype:"punch",screenShakeArchetype:"explosion"};Z.archetypes.sfx_hero_level_up={visualEffectArchetypeList:["vfx_hero_rankup1","vfx_hero_rankup2","vfx_hero_rankup3","vfx_hero_rankup4"],soundEffectArchetype:"aud_celebrate",screenShakeArchetype:void 0};Z.archetypes.sfx_healing=
{visualEffectArchetypeList:["vfx_healing1","vfx_healing2","vfx_healing3","vfx_healing4"],soundEffectArchetype:"aud_healing",screenShakeArchetype:void 0};Z.archetypes.sfx_hit_e_berserker={visualEffectArchetypeList:["vfx_hit_e_generic1","vfx_hit_e_generic2","vfx_hit_bullet"],soundEffectArchetype:"aud_hit_e_berserker",screenShakeArchetype:void 0};Z.archetypes.sfx_amb_e_berserker={visualEffectArchetype:void 0,soundEffectArchetype:"aud_amb_e_berserker",screenShakeArchetype:void 0};Z.archetypes.sfx_hit_e_basicmelee=
{visualEffectArchetypeList:["vfx_hit_e_generic1","vfx_hit_e_generic2","vfx_hit_bullet"],soundEffectArchetype:"aud_hit_generic",screenShakeArchetype:void 0};Z.archetypes.sfx_hit_e_ranged={visualEffectArchetypeList:["vfx_hit_e_generic1","vfx_hit_e_generic2","vfx_hit_bullet"],soundEffectArchetype:"aud_hit_generic",screenShakeArchetype:void 0};Z.archetypes.sfx_hit_e_commando={visualEffectArchetypeList:["vfx_hit_e_generic1","vfx_hit_e_generic2","vfx_hit_bullet"],soundEffectArchetype:"aud_hit_generic",
screenShakeArchetype:void 0};Z.archetypes.sfx_hit_e_charger={visualEffectArchetypeList:["vfx_hit_e_generic1","vfx_hit_e_generic2","vfx_hit_bullet"],soundEffectArchetype:"aud_hit_generic",screenShakeArchetype:void 0};Z.archetypes.sfx_hit_e_bombthrower={visualEffectArchetypeList:["vfx_hit_e_generic1","vfx_hit_e_generic2","vfx_hit_bullet"],soundEffectArchetype:"aud_hit_generic",screenShakeArchetype:void 0};Z.archetypes.sfx_amb_e_death={visualEffectArchetype:void 0,soundEffectArchetype:"aud_amb_e_death",
screenShakeArchetype:void 0};Z.archetypes.sfx_dth_e_death={visualEffectArchetypeList:["vfx_dth_death1","vfx_dth_death2","vfx_dth_death3","vfx_dth_death4","vfx_dth_death5"],soundEffectArchetype:"aud_dth_e_death",screenShakeArchetype:void 0};Z.archetypes.sfx_hit_e_treasure={visualEffectArchetype:"vfx_hit_e_treasure",soundEffectArchetype:"aud_hit_e_treasure",screenShakeArchetype:void 0};Z.archetypes.sfx_crt_e_bannerling={visualEffectArchetype:void 0,soundEffectArchetype:"aud_crt_e_bannerling",screenShakeArchetype:"shk_horn"};
Z.archetypes.sfx_amb_dynamite={visualEffectArchetype:void 0,soundEffectArchetype:"aud_dynamite",screenShakeArchetype:void 0};Z.archetypes.sfx_crt_mortar={visualEffectArchetype:"vfx_crt_mortar",soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_crt_bullet={visualEffectArchetype:"vfx_crt_bullet",soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_amb_bullet={visualEffectArchetype:["vfx_amb_bullet"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};
Z.archetypes.sfx_amb_spit={visualEffectArchetype:["vfx_amb_spit"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_fire_shotgun={visualEffectArchetype:["vfx_fire_shotgunH1","vfx_fire_shotgunV1"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_construction={soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_dst_fire={visualEffectArchetypeList:"vfx_dst_fire1 vfx_dst_fire2 vfx_dst_fire3 vfx_dst_fire4 vfx_dst_fire5 vfx_dst_fire6".split(" "),
soundEffectArchetype:"aud_dst_fire",screenShakeArchetype:void 0};Z.archetypes.sfx_dst_fire_small={visualEffectArchetypeList:"vfx_dst_fire_small1 vfx_dst_fire_small2 vfx_dst_fire_small3 vfx_dst_fire_small4 vfx_dst_fire_small5 vfx_dst_fire_small6".split(" "),soundEffectArchetype:"aud_dst_fire",screenShakeArchetype:void 0};Z.archetypes.sfx_dth_building={visualEffectArchetypeList:["vfx_dth_building1","vfx_dth_building2","vfx_dth_building3","vfx_dth_building4"],soundEffectArchetype:"aud_dth_building",
screenShakeArchetype:"shk_dth_building"};Z.archetypes.sfx_dth_small_building={visualEffectArchetypeList:["vfx_dth_small_building1","vfx_dth_small_building2","vfx_dth_small_building3","vfx_dth_small_building4"],soundEffectArchetype:"aud_dth_building",screenShakeArchetype:"shk_dth_building"};Z.archetypes.sfx_crt_building={visualEffectArchetypeList:["vfx_crt_building1","vfx_crt_building2"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_buildoption={visualEffectArchetypeList:["vfx_buildoption_1v",
"vfx_buildoption_2h","vfx_buildoption_2v","vfx_buildoption_3v"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_amb_amber={soundEffectArchetype:"aud_amb_amber"};Z.archetypes.sfx_dst_r_amber={visualEffectArchetypeList:["vfx_dst_r_amber"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_dst_r_lumber={visualEffectArchetypeList:["vfx_dst_r_lumber"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_dst_r_stone={visualEffectArchetypeList:["vfx_dst_r_generic",
"vfx_dst_r_stone"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_amb_xp={soundEffectArchetype:"aud_amb_xp"};Z.archetypes.sfx_dst_r_xp={visualEffectArchetypeList:["vfx_dst_r_xp"],soundEffectArchetype:"aud_dst_xp",screenShakeArchetype:void 0};Z.archetypes.sfx_amb_scenery_waterfall={visualEffectArchetype:void 0,soundEffectArchetype:"aud_amb_scenery_waterfall",screenShakeArchetype:void 0};Z.archetypes.sfx_amb_fire={visualEffectArchetype:void 0,soundEffectArchetype:"aud_amb_fire",
screenShakeArchetype:void 0};Z.archetypes.sfx_explosion={visualEffectArchetypeList:"vfx_exp_0h vfx_exp_1h vfx_exp_1v vfx_exp_2h vfx_exp_2v vfx_exp_3h vfx_exp_3v".split(" "),soundEffectArchetype:"aud_explosion",screenShakeArchetype:"shk_explosion"};Z.archetypes.sfx_explosion_dc={visualEffectArchetypeList:"vfx_exp_0h vfx_exp_1h vfx_exp_1v vfx_exp_2h vfx_exp_2v vfx_exp_3h vfx_exp_3v vfx_exp_decal".split(" "),soundEffectArchetype:"aud_explosion",screenShakeArchetype:"shk_explosion"};Z.archetypes.sfx_explosionBerserker=
{visualEffectArchetypeList:"vfx_expBig_0h vfx_expBig_1h vfx_expBig_1v vfx_expBig_2h vfx_expBig_2v vfx_expBig_3h vfx_expBig_3v vfx_exp_decalBig".split(" "),soundEffectArchetype:"aud_explosionBerserker",screenShakeArchetype:"shk_explosionBig"};Z.archetypes.sfx_explosionBarrel={visualEffectArchetypeList:"vfx_expBig_0h vfx_expBig_1h vfx_expBig_1v vfx_expBig_2h vfx_expBig_2v vfx_expBig_3h vfx_expBig_3v vfx_exp_decalBig".split(" "),soundEffectArchetype:"aud_explosionBarrel",screenShakeArchetype:"shk_explosionBig"};
Z.archetypes.sfx_explosionMine={visualEffectArchetypeList:"vfx_exp_0h vfx_exp_1h vfx_exp_1v vfx_exp_2h vfx_exp_2v vfx_exp_3h vfx_exp_3v vfx_exp_decal".split(" "),soundEffectArchetype:"aud_explosionMine",screenShakeArchetype:"shk_explosion"};Z.archetypes.sfx_bannerling_alert_mob={visualEffectArchetypeList:["vfx_bannerling_alert_mob"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_bannerling_alert_bombthrower={visualEffectArchetypeList:["vfx_bannerling_alert_bombthrower"],
soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_bannerling_alert_boss={visualEffectArchetypeList:["vfx_bannerling_alert_boss"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_bannerling_alert_charger={visualEffectArchetypeList:["vfx_bannerling_alert_charger"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_bannerling_alert_commando={visualEffectArchetypeList:["vfx_bannerling_alert_commando"],soundEffectArchetype:void 0,
screenShakeArchetype:void 0};Z.archetypes.sfx_bannerling_alert_death={visualEffectArchetypeList:["vfx_bannerling_alert_death"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_bannerling_alert_ranged={visualEffectArchetypeList:["vfx_bannerling_alert_ranged"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_bannerling_alert_thief={visualEffectArchetypeList:["vfx_bannerling_alert_thief"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_bannerling_alert_treasuredropper=
{visualEffectArchetypeList:["vfx_bannerling_alert_treasuredropper"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_dth_crate={visualEffectArchetypeList:["vfx_dth_crate1","vfx_dth_crate2","vfx_dth_crate3"]};Z.archetypes.sfx_dth_e_arrow={visualEffectArchetypeList:["vfx_dth_e_arrow1v","vfx_dth_e_arrow2h","vfx_dth_e_arrow2v","vfx_dth_e_arrow3v"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_upgrade_batch={visualEffectArchetypeList:"vfx_upgrade_batch1 vfx_upgrade_batch2v vfx_upgrade_batch3h vfx_upgrade_batch3v vfx_upgrade_batch4v vfx_upgrade_batch5".split(" "),
soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_amb_s_cave={visualEffectArchetype:void 0,soundEffectArchetype:"aud_amb_s_cave",screenShakeArchetype:void 0};Z.archetypes.sfx_amb_s_runningwater={visualEffectArchetype:void 0,soundEffectArchetype:"aud_amb_s_runningwater",screenShakeArchetype:void 0};Z.archetypes.sfx_amb_s_waves={visualEffectArchetype:void 0,soundEffectArchetype:"aud_amb_s_waves",screenShakeArchetype:void 0};Z.archetypes.sfx_amb_s_firefly={visualEffectArchetype:void 0,
soundEffectArchetype:"aud_amb_s_firefly",screenShakeArchetype:void 0};Z.archetypes.sfx_gui_build={visualEffectArchetypeList:["vfx_gui_build"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_gui_upgrade={visualEffectArchetypeList:["vfx_gui_upgrade"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_gui_research={visualEffectArchetypeList:["vfx_gui_research"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_gui_rankup={visualEffectArchetypeList:["vfx_gui_rankup4"],
soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_gui_lumberfull={visualEffectArchetypeList:["vfx_gui_lumberfull1","vfx_gui_lumberfull2","vfx_gui_lumberfull3"],soundEffectArchetype:"aud_res_full",screenShakeArchetype:void 0};Z.archetypes.sfx_gui_stonefull={visualEffectArchetypeList:["vfx_gui_stonefull1","vfx_gui_stonefull2","vfx_gui_stonefull3"],soundEffectArchetype:"aud_res_full",screenShakeArchetype:void 0};Z.archetypes.sfx_gui_buildingcomplete={visualEffectArchetypeList:["vfx_gui_buildingcomplete4"],
soundEffectArchetype:"aud_celebrate_build",screenShakeArchetype:void 0};Z.archetypes.sfx_gui_newquest={visualEffectArchetypeList:["vfx_gui_newquest"],soundEffectArchetype:"aud_newquest",screenShakeArchetype:void 0};Z.archetypes.sfx_gui_newfillerquest={visualEffectArchetypeList:["vfx_gui_buildingcomplete4"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_gui_newquestarrow={visualEffectArchetypeList:["vfx_gui_newquestarrow"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};
Z.archetypes.sfx_gui_newfillerquestarrow={visualEffectArchetypeList:["vfx_gui_newfillerquestarrow"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_gui_researchcomplete={visualEffectArchetypeList:["vfx_gui_researchcomplete4"],soundEffectArchetype:"aud_celebrate_build",screenShakeArchetype:void 0};Z.archetypes.sfx_gui_wavestarted={visualEffectArchetypeList:["vfx_gui_wavestarted"],soundEffectArchetype:"aud_res_full",screenShakeArchetype:void 0};Z.archetypes.sfx_gui_badgeachieved=
{visualEffectArchetypeList:["vfx_gui_badgeachieved1","vfx_gui_badgeachieved2"],soundEffectArchetype:"aud_badge_complete",screenShakeArchetype:void 0};Z.archetypes.sfx_gui_taskstarted={visualEffectArchetypeList:["vfx_gui_taskstarted"],soundEffectArchetype:"aud_alert",screenShakeArchetype:void 0};Z.archetypes.sfx_gui_taskcomplete={visualEffectArchetypeList:["vfx_gui_taskcomplete"],soundEffectArchetype:"aud_task_complete",screenShakeArchetype:void 0};Z.archetypes.sfx_gui_badgestarted={visualEffectArchetypeList:["vfx_gui_badgestarted"],
soundEffectArchetype:"aud_alert",screenShakeArchetype:void 0};Z.archetypes.sfx_gui_badgecomplete={visualEffectArchetypeList:["vfx_gui_badgecomplete"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_gui_radial_open={visualEffectArchetypeList:["vfx_gui_radial_open"],soundEffectArchetype:void 0,screenShakeArchetype:void 0};Z.archetypes.sfx_gui_task_panel_complete={visualEffectArchetypeList:["vfx_gui_task_panel_complete"],soundEffectArchetype:"aud_task_complete",screenShakeArchetype:void 0};
M.archetypes.aud_test={path:"sounds/zombie_walk.ogg",loop:!1,volume:1,delayedLoad:!0};M.archetypes.aud_music_theme={path:"sounds/music_main_theme.ogg",loop:!0,camera:!0,volume:0.85,delayedLoad:!0,preview:"aud_music_theme_preview"};M.archetypes.aud_music_theme_preview={path:"sounds/music_main_theme_preview.ogg",loop:!0,camera:!0,volume:0.85,delayedLoad:!1};M.archetypes.aud_music_day={path:"sounds/music_day_theme.ogg",loop:!0,camera:!0,volume:0.9,delayedLoad:!0,preview:"aud_music_day_preview"};M.archetypes.aud_music_day_preview=
{path:"sounds/music_day_theme_preview.ogg",loop:!0,camera:!0,volume:0.9,delayedLoad:!1};M.archetypes.aud_music_night={path:"sounds/music_night_theme.ogg",loop:!0,camera:!0,volume:0.9,delayedLoad:!0,preview:"aud_music_night_preview"};M.archetypes.aud_music_night_preview={path:"sounds/music_night_theme_preview.ogg",loop:!0,camera:!0,volume:0.9,delayedLoad:!1};M.archetypes.aud_music_battle={path:"sounds/music_battle_theme_normal.ogg",loop:!0,camera:!0,volume:0.9,delayedLoad:!0,preview:"aud_music_battle_preview"};
M.archetypes.aud_music_battle_preview={path:"sounds/music_battle_theme_normal_preview.ogg",loop:!0,camera:!0,volume:0.9,delayedLoad:!1};M.archetypes.aud_music_battle_boss={path:"sounds/music_battle_theme_boss.ogg",loop:!0,camera:!0,volume:0.9,delayedLoad:!0,preview:"aud_music_battle_boss_preview"};M.archetypes.aud_music_battle_boss_preview={path:"sounds/music_battle_theme_boss_preview.ogg",loop:!0,camera:!0,volume:0.9,delayedLoad:!1};M.archetypes.aud_amber_spend={path:"sounds/amber-pickup.ogg",loop:!1,
camera:!0,volume:0.9,delayedLoad:!0};M.archetypes.aud_sting_prepare_battle={path:"sounds/fail_2.ogg",loop:!1,camera:!0,volume:0.9,delayedLoad:!0};M.archetypes.aud_sting_success_battle={path:"sounds/success_battle.ogg",loop:!1,camera:!0,volume:1.1,delayedLoad:!0};M.archetypes.aud_sting_success_1={path:"sounds/success_1.ogg",loop:!1,camera:!0,volume:0.9,delayedLoad:!0};M.archetypes.aud_sting_success_2={path:"sounds/success_2.ogg",loop:!1,camera:!0,volume:0.9,delayedLoad:!0};M.archetypes.aud_sting_success_3=
{path:"sounds/success_3.ogg",loop:!1,camera:!0,volume:0.9,delayedLoad:!0};M.archetypes.aud_sting_success_4={path:"sounds/success_4.ogg",loop:!1,camera:!0,volume:0.9,delayedLoad:!0};M.archetypes.aud_sting_success_5={path:"sounds/success_5.ogg",loop:!1,camera:!0,volume:0.9,delayedLoad:!0};M.archetypes.aud_sting_fail_battle={path:"sounds/fail_battle.ogg",loop:!1,camera:!0,volume:0.9,delayedLoad:!0};M.archetypes.aud_sting_fail_1={path:"sounds/fail_1.ogg",loop:!1,camera:!0,volume:0.9,delayedLoad:!0};M.archetypes.aud_sting_fail_2=
{path:"sounds/fail_2.ogg",loop:!1,camera:!0,volume:0.9,delayedLoad:!0};M.archetypes.aud_sting_fail_3={path:"sounds/fail_3.ogg",loop:!1,camera:!0,volume:0.9,delayedLoad:!0};M.archetypes.aud_sting_fail_4={path:"sounds/fail_4.ogg",loop:!1,camera:!0,volume:0.9,delayedLoad:!0};M.archetypes.aud_sting_fail_5={path:"sounds/fail_5.ogg",loop:!1,camera:!0,volume:0.9,delayedLoad:!0};M.archetypes.aud_hero_rankup={path:"sounds/rank_up_alt.ogg",loop:!1,volume:1.9,delayedLoad:!0};M.archetypes.aud_healing={random:!0,
sounds:[{path:"sounds/healing_1.ogg",loop:!1,volume:0.7,delayedLoad:!0},{path:"sounds/healing_2.ogg",loop:!1,volume:0.7,delayedLoad:!0},{path:"sounds/healing_3.ogg",loop:!1,volume:0.7,delayedLoad:!0},{path:"sounds/healing_4.ogg",loop:!1,volume:0.7,delayedLoad:!0}]};M.archetypes.aud_crt_e_bannerling={path:"sounds/bannerling_horn.ogg",loop:!1,volume:1,delayedLoad:!0};M.archetypes.aud_attack_death={path:"sounds/death_slice.ogg",loop:!1,volume:1,delayedLoad:!0};M.archetypes.aud_hit_generic={random:!0,
sounds:[{path:"sounds/body_impact_1.ogg",loop:!1,volume:1,delayedLoad:!0},{path:"sounds/body_impact_2.ogg",loop:!1,volume:1,delayedLoad:!0},{path:"sounds/body_impact_3.ogg",loop:!1,volume:1,delayedLoad:!0}]};M.archetypes.aud_hit_e_berserker={random:!0,sounds:[{path:"sounds/hit_metal_1.ogg",loop:!1,volume:0.7,delayedLoad:!0},{path:"sounds/hit_metal_2.ogg",loop:!1,volume:0.7,delayedLoad:!0},{path:"sounds/hit_metal_3.ogg",loop:!1,volume:0.7,delayedLoad:!0}]};M.archetypes.aud_amb_e_berserker={path:"sounds/fuse_loop.ogg",
loop:!0,volume:1.5,delayedLoad:!0};M.archetypes.aud_amb_e_death={path:"sounds/death_ambient.ogg",loop:!0,volume:0.7,delayedLoad:!0};M.archetypes.aud_dth_e_death={path:"sounds/death_scream.ogg",loop:!1,volume:0.6,delayedLoad:!0};M.archetypes.aud_hit_e_treasure={random:!0,sounds:[{path:"sounds/treasure_chimes_1.ogg",loop:!1,volume:0.8},{path:"sounds/treasure_chimes_2.ogg",loop:!1,volume:0.8},{path:"sounds/treasure_chimes_3.ogg",loop:!1,volume:0.8},{path:"sounds/treasure_chimes_4.ogg",loop:!1,volume:0.8}]};
M.archetypes.aud_amb_amber={random:!0,sounds:[{path:"sounds/treasure_chimes_1.ogg",loop:!1,volume:0.1},{path:"sounds/treasure_chimes_2.ogg",loop:!1,volume:0.1},{path:"sounds/treasure_chimes_3.ogg",loop:!1,volume:0.1},{path:"sounds/treasure_chimes_4.ogg",loop:!1,volume:0.1}]};M.archetypes.aud_amb_xp={random:!0,sounds:[{path:"sounds/xp_chime_1.ogg",loop:!1,volume:0.2},{path:"sounds/xp_chime_2.ogg",loop:!1,volume:0.2},{path:"sounds/xp_chime_3.ogg",loop:!1,volume:0.2},{path:"sounds/xp_chime_4.ogg",loop:!1,
volume:0.2},{path:"sounds/xp_chime_5.ogg",loop:!1,volume:0.2}]};M.archetypes.aud_dst_xp={random:!0,sounds:[{path:"sounds/xp_collect_1.ogg",loop:!1,volume:0.6},{path:"sounds/xp_collect_2.ogg",loop:!1,volume:0.6},{path:"sounds/xp_collect_3.ogg",loop:!1,volume:0.6},{path:"sounds/xp_collect_4.ogg",loop:!1,volume:0.6}]};M.archetypes.aud_dynamite={path:"sounds/fuse_short.ogg",loop:!1,volume:1,delayedLoad:!0};M.archetypes.aud_dth_building={path:"sounds/explosion_building.ogg",loop:!1,volume:1.3,delayedLoad:!0};
M.archetypes.aud_dth_building={path:"sounds/explosion_building.ogg",loop:!1,volume:1.3,delayedLoad:!0};M.archetypes.aud_scenery_mushroom={path:"sounds/mushroom.ogg",loop:!1,volume:0.9};M.archetypes.aud_hit_mushroom={path:"sounds/mushroom_impact.ogg",loop:!1,volume:1.1};M.archetypes.aud_amb_fire={path:"sounds/fire_loop.ogg",loop:!0,volume:1.3};M.archetypes.aud_dst_fire={path:"sounds/fire_out.ogg",loop:!1,volume:0.7};M.archetypes.aud_explosion={path:"sounds/explosion.ogg",loop:!1,volume:0.8,delayedLoad:!0};
M.archetypes.aud_explosionBerserker={path:"sounds/explosion_big.ogg",loop:!1,volume:0.8,delayedLoad:!0};M.archetypes.aud_explosionBarrel={path:"sounds/explosion_barrel.ogg",loop:!1,volume:0.8,delayedLoad:!0};M.archetypes.aud_explosionMine={path:"sounds/explosion_mine.ogg",loop:!1,volume:0.8,delayedLoad:!0};M.archetypes.aud_shotguncock={path:"sounds/shotgun_cock.ogg",loop:!1,volume:0.3};M.archetypes.aud_shotgunreload={path:"sounds/shotgun_reload.ogg",loop:!1,volume:0};M.archetypes.aud_shotgundryfire=
{path:"sounds/shotgun_dryfire.ogg",loop:!1,volume:0.01};M.archetypes.aud_shotgunshot={random:!0,sounds:[{path:"sounds/shotgun_fire_1.ogg",loop:!1,volume:0.5},{path:"sounds/shotgun_fire_2.ogg",loop:!1,volume:0.5},{path:"sounds/shotgun_fire_3.ogg",loop:!1,volume:0.5}]};M.archetypes.aud_celebrate={path:"sounds/celebrate.ogg",loop:!1,volume:0.9,camera:!0};M.archetypes.aud_celebrate_build={path:"sounds/celebrate_build.ogg",loop:!1,volume:0.9,camera:!0};M.archetypes.aud_crate_destroy={path:"sounds/crate_destroy.ogg",
loop:!1,volume:0.7,camera:!0,delayedLoad:!1};M.archetypes.aud_amb_s_cave={path:"sounds/cave_loop.ogg",loop:!0,volume:0.2,camera:!1,delayedLoad:!0};M.archetypes.aud_amb_s_runningwater={path:"sounds/runningwater_loop.ogg",loop:!0,volume:0.8,camera:!1,delayedLoad:!0};M.archetypes.aud_amb_s_waves={path:"sounds/waves_loop.ogg",loop:!0,volume:0.7,camera:!1,delayedLoad:!0};M.archetypes.aud_amb_s_firefly={random:!0,delayedLoad:!0,sounds:[{path:"sounds/firefly_1.ogg",loop:!1,volume:0.7},{path:"sounds/firefly_2.ogg",
loop:!1,volume:1.2}]};M.archetypes.aud_res_full={path:"sounds/resource_full.ogg",loop:!1,volume:0.9,camera:!0,delayedLoad:!0};M.archetypes.aud_alert={path:"sounds/alert.ogg",loop:!1,volume:0.9,camera:!0};M.archetypes.aud_task_complete={path:"sounds/task_complete.ogg",loop:!1,volume:0.8,camera:!0};M.archetypes.aud_newquest={path:"sounds/newquest.ogg",loop:!1,volume:1,camera:!0};M.archetypes.aud_badge_complete={path:"sounds/badge_achieved_2.ogg",loop:!1,volume:1,camera:!0,delayedLoad:!0};e.archetypes.sfx_hero_heal=
{shouldPlayerSave:!1,ECEffectSpawner:{onCreateEffect:void 0,onDeathEffect:void 0,incidentalEffect:"sfx_healing",incidentalMinTime:0.5,incidentalMaxTime:0.5}};Ic.shk_test={strength:1,duration:1};Ic.shk_dth_building={strength:0.5,duration:1};Ic.shk_explosion={strength:0.7,duration:0.6};Ic.shk_explosionBig={strength:1.2,duration:0.9};Ic.shk_hero_rankup_in={strength:2.5,duration:4.5};Ic.shk_explosion={strength:0.7,duration:0.3};Ic.shk_horn={strength:0.1,duration:2};I.archetypes.vfx_test={texturePath:"textures/dot.dds",
keyFrames:[{life:0,scale:5,colour:[1,1,1,1]},{life:1,scale:5,colour:[1,1,1,0]}],alignment:"camera",follow:!1,delay:0,v3Velocity:void 0,facingSpeed:void 0,randomAddedScale:0};I.archetypes.vfx_hero_rankup1={texturePath:"textures/loop.dds",lifetime:2,startScale:1/1.5,endScale:2/1.5,startColour:kb,endColour:Oa,randomRotate:!0,facingSpeed:1,follow:!0};I.archetypes.vfx_hero_rankup2={texturePath:"textures/loop.dds",lifetime:2,startScale:1/1.5,endScale:2,startColour:Jc,endColour:Si,randomRotate:!0,facingSpeed:0.5,
follow:!0};I.archetypes.vfx_hero_rankup3={texturePath:"textures/upgrade_shards.dds",lifetime:1.8,startScale:1/1.5,endScale:2/1.5,startColour:Jc,endColour:Si,alignment:"camera",follow:!0};I.archetypes.vfx_hero_rankup4={texturePath:"textures/upgrade_shards.dds",lifetime:1.8,startScale:2/1.5,endScale:3.5/1.5,startColour:kb,endColour:Oa,randomRotate:!0,alignment:"camera",follow:!0};I.archetypes.vfx_hero_melee_thump1h={texturePath:"textures/loop.dds",lifetime:0.25,startScale:0.5,endScale:0.7,startColour:Od,
endColour:We,alignment:"direction",randomRotate:!0,facingSpeed:0.5,follow:!1};I.archetypes.vfx_hero_melee_thump1v={texturePath:"textures/loop.dds",lifetime:0.25,startScale:0.7,endScale:0.9,startColour:Od,endColour:We,alignment:"direction",randomRotate:!0,facingSpeed:0.9,follow:!1};I.archetypes.vfx_dth_e_generic1h={texturePath:"textures/loop_detail.dds",lifetime:0.8,startScale:0.2,endScale:0.4,startColour:kb,endColour:Oa,alignment:"camera",randomRotate:!0,follow:!0};I.archetypes.vfx_dth_e_generic1v=
{texturePath:"textures/loop_detail.dds",lifetime:1,startScale:0.4,endScale:1,startColour:kb,endColour:Oa,alignment:"camera",randomRotate:!0,follow:!0};I.archetypes.vfx_dth_e_generic2h={texturePath:"textures/loop_filled.dds",lifetime:0.2,startScale:1,endScale:1.6,startColour:kb,endColour:Oa,randomRotate:!0,follow:!0};I.archetypes.vfx_dth_e_generic2v={texturePath:"textures/loop_filled.dds",lifetime:0.2,startScale:1,endScale:1.6,startColour:kb,endColour:Oa,alignment:"vertical",randomRotate:!0,follow:!0};
I.archetypes.vfx_dth_e_generic3v={texturePath:"textures/loop_detail.dds",lifetime:0.3,startScale:0.4,endScale:1.6,startColour:kb,endColour:Oa,alignment:"camera",randomRotate:!0,follow:!0};I.archetypes.vfx_hit_e_generic1={texturePath:"textures/impact-unfilled.dds",lifetime:0.2,startScale:0.2,endScale:0.6,startColour:Od,endColour:We,alignment:"camera",follow:!0};I.archetypes.vfx_hit_e_generic2={texturePath:"textures/impact.dds",lifetime:0.2,startScale:0.2,endScale:0.3,startColour:Od,endColour:[1,156/
255,0,0],alignment:"camera",follow:!0};I.archetypes.vfx_bannerling_alert={texturePath:"textures/loop.dds",lifetime:3,startScale:0.1,endScale:3.5,startColour:Od,endColour:We,alignment:"camera"};I.archetypes.vfx_dth_death1={texturePath:"textures/loop.dds",lifetime:1,startScale:0.5,endScale:1.5,startColour:[159/255,31/255,170/255,0.7],endColour:[159/255,31/255,170/255,0],randomRotate:!0,facingSpeed:0.8};I.archetypes.vfx_dth_death2={texturePath:"textures/loop_fat.dds",lifetime:2,startScale:0.8,endScale:1,
startColour:[0.7,0.7,0.7,0.6],endColour:[1,1,1,0],randomRotate:!0,facingSpeed:0.6};I.archetypes.vfx_dth_death3={texturePath:"textures/loop_shards.dds",lifetime:0.8,startScale:2,endScale:3,startColour:[159/255,31/255,170/255,0.8],endColour:[159/255,31/255,170/255,0],alignment:"camera"};I.archetypes.vfx_dth_death4={texturePath:"textures/loop_shards.dds",lifetime:0.8,startScale:1.2,endScale:2.2,startColour:jd,endColour:kd,alignment:"camera"};I.archetypes.vfx_dth_death5={texturePath:"textures/loop.dds",
lifetime:0.4,startScale:0.5,endScale:3,startColour:jd,endColour:kd,follow:!0};I.archetypes.vfx_inc_death={texturePath:"textures/loop_filled.dds",lifetime:2,startScale:0.5,endScale:0.4,startColour:[10/255,10/255,10/255,0.3],endColour:[10/255,10/255,10/255,0],alignment:"horizontal",facingSpeed:0.5,randomAddedScale:0.5};I.archetypes.vfx_hit_e_treasure={texturePath:"textures/loop.dds",lifetime:0.4,startScale:0.5,endScale:3,startColour:[1,198/255,0,0.8],endColour:[1,223/255,111/255,0],follow:!0};I.archetypes.vfx_crt_mortar=
{texturePath:"textures/loop.dds",lifetime:0.4,startScale:0.5,endScale:3,startColour:[1,198/255,0,0.4],endColour:[1,223/255,111/255,0],randomRotate:!0};I.archetypes.vfx_crt_bullet={texturePath:"textures/loop_detail.dds",lifetime:0.3,startScale:0,endScale:0.4,startColour:[30/255,30/255,30/255,1],endColour:[30/255,30/255,30/255,0],randomRotate:!0,follow:!0,alignment:"direction",facingSpeed:15};I.archetypes.vfx_fire_shotgunH1={texturePath:"textures/loop_filled.dds",lifetime:0.6,startScale:0.4,endScale:0.9,
startColour:[1,1,1,0.7],endColour:[1,1,1,0],randomRotate:!0,follow:!0,alignment:"horizontal"};I.archetypes.vfx_fire_shotgunV1={texturePath:"textures/loop_filled.dds",lifetime:0.6,startScale:0.4,endScale:0.6,startColour:[1,1,1,0.7],endColour:[1,1,1,0],randomRotate:!0,follow:!0,alignment:"vertical"};I.archetypes.vfx_amb_bullet={texturePath:"textures/loop_filled.dds",lifetime:0.2,startScale:0,endScale:0.2,startColour:[1,1,1,0.7],endColour:[1,1,1,0],randomRotate:!0,alignment:"direction",facingSpeed:0.1,
randomAddedScale:0.2};I.archetypes.vfx_amb_spit={texturePath:"textures/loop_filled.dds",lifetime:0.4,startScale:0,endScale:0.1,startColour:[246/255,141/255,11/255,0.7],endColour:[1,1,1,0],randomRotate:!0,alignment:"direction",facingSpeed:0.1,randomAddedScale:0.2};I.archetypes.vfx_hit_bullet={texturePath:"textures/loop_detail.dds",lifetime:0.4,startScale:0.1,endScale:0.9,startColour:[212/255,12/255,21/255,0.8],endColour:[212/255,12/255,21/255,0],randomRotate:!0,follow:!0,alignment:"camera"};I.archetypes.vfx_dst_r_generic=
{texturePath:"textures/chip_detail.dds",lifetime:0.3,startScale:0.4,endScale:0.5,startColour:[1,1,1,0.3],endColour:[1,1,1,0],randomRotate:!0,alignment:"camera",randomAddedScale:0.4};I.archetypes.vfx_dst_r_amber={texturePath:"textures/loop_shards.dds",lifetime:0.6,startScale:0.35,endScale:0.4,startColour:[500/255,248/255,46/255,0.9],endColour:[500/255,248/255,46/255,0.1],randomRotate:!0,alignment:"camera",randomAddedScale:0.4};I.archetypes.vfx_dst_r_lumber={texturePath:"textures/leaves_detail.dds",
lifetime:0.6,startScale:0.35,endScale:0.4,startColour:[99/255,222/255,118/255,0.8],endColour:[99/255,222/255,118/255,0.1],randomRotate:!0,alignment:"camera",randomAddedScale:0.4};I.archetypes.vfx_dst_r_stone={texturePath:"textures/chip_detail.dds",lifetime:0.6,startScale:0.35,endScale:0.4,startColour:[200/255,310/255,400/255,0.8],endColour:[200/255,310/255,400/255,0.1],randomRotate:!0,alignment:"camera",randomAddedScale:0.4};I.archetypes.vfx_dst_r_xp={texturePath:"textures/loop_shards.dds",lifetime:0.6,
startScale:0.35,endScale:0.4,startColour:[250.5/255,70.5/255,262.5/255,0.9],endColour:[250.5/255,70.5/255,262.5/255,0.1],randomRotate:!0,alignment:"camera",randomAddedScale:0.4};I.archetypes.vfx_crt_building1={texturePath:"textures/loop.dds",lifetime:1.8,startScale:1,endScale:4.5,startColour:[0.7,0.7,0.7,0.7],endColour:[1,1,1,0],randomRotate:!0,facingSpeed:1};I.archetypes.vfx_crt_building2={texturePath:"textures/loop_fat.dds",lifetime:1.8,startScale:1,endScale:6,startColour:[0.7,0.7,0.7,0.3],endColour:[1,
1,1,0],randomRotate:!0,facingSpeed:0.5};I.archetypes.vfx_dth_building1={texturePath:"textures/loop.dds",lifetime:6,startScale:2,endScale:3,startColour:[0.7,0.7,0.7,0.7],endColour:[1,1,1,0],randomRotate:!0,facingSpeed:0.8};I.archetypes.vfx_dth_building2={texturePath:"textures/loop_fat.dds",lifetime:4,startScale:3,endScale:4,startColour:[0.7,0.7,0.7,0.3],endColour:[1,1,1,0],randomRotate:!0,facingSpeed:0.6};I.archetypes.vfx_dth_building3={texturePath:"textures/decal_real.dds",lifetime:40,startScale:6,
endScale:6,startColour:Ri,endColour:Xe,randomRotate:!0};I.archetypes.vfx_dth_building4={texturePath:"textures/loop_planks.dds",lifetime:2.8,startScale:2,endScale:2.8,startColour:[120/255,79/155,57/255,1],endColour:[120/255,79/155,57/255,0.1],alignment:"camera"};I.archetypes.vfx_dth_small_building1={texturePath:"textures/loop.dds",lifetime:6,startScale:0.5,endScale:1.5,startColour:[0.7,0.7,0.7,0.7],endColour:[1,1,1,0],randomRotate:!0,facingSpeed:0.8};I.archetypes.vfx_dth_small_building2={texturePath:"textures/loop_fat.dds",
lifetime:4,startScale:1,endScale:2,startColour:[0.7,0.7,0.7,0.3],endColour:[1,1,1,0],randomRotate:!0,facingSpeed:0.6};I.archetypes.vfx_dth_small_building3={texturePath:"textures/decal_real.dds",lifetime:40,startScale:1.5,endScale:1.5,startColour:Ri,endColour:Xe,randomRotate:!0};I.archetypes.vfx_dth_small_building4={texturePath:"textures/loop_planks.dds",lifetime:2.8,startScale:0.8,endScale:1.2,startColour:[147/255,108/155,79/255,1],endColour:[147/255,108/155,79/255,0.1],alignment:"camera"};I.archetypes.vfx_dst_fire1=
{texturePath:"textures/loop.dds",lifetime:1.2,startScale:1,endScale:2,startColour:[77/255,158/255,229/255,0.7],endColour:[77/255,158/255,229/255,0],randomRotate:!0,facingSpeed:2};I.archetypes.vfx_dst_fire2={texturePath:"textures/loop_fat.dds",lifetime:1.2,startScale:1,endScale:3,startColour:[161/255,201/255,235/255,0.7],endColour:[161/255,201/255,235/255,0],randomRotate:!0,facingSpeed:1.5};I.archetypes.vfx_dst_fire3={texturePath:"textures/loop_filled.dds",lifetime:3,startScale:1,endScale:4,startColour:[77/
255,158/255,229/255,0.7],endColour:[161/255,201/255,235/255,0],randomRotate:!0};I.archetypes.vfx_dst_fire4={texturePath:"textures/loop_filled.dds",lifetime:3,startScale:0.5,endScale:3.2,startColour:[77/255,158/255,229/255,0.7],endColour:[161/255,201/255,235/255,0],randomRotate:!0};I.archetypes.vfx_dst_fire5={texturePath:"textures/loop_detail.dds",lifetime:1,startScale:1,endScale:2,startColour:[161/255,201/255,235/255,0.7],endColour:[161/255,201/255,235/255,0],randomRotate:!0,alignment:"camera"};I.archetypes.vfx_dst_fire6=
{texturePath:"textures/loop_detail.dds",lifetime:1,startScale:2,endScale:3.5,startColour:[77/255,158/255,229/255,0.7],endColour:[161/255,201/255,235/255,0],randomRotate:!0,alignment:"camera"};I.archetypes.vfx_dst_fire_small1={texturePath:"textures/loop.dds",lifetime:1.2,startScale:0.5,endScale:1,startColour:[77/255,158/255,229/255,0.7],endColour:[77/255,158/255,229/255,0],randomRotate:!0,facingSpeed:2};I.archetypes.vfx_dst_fire_small2={texturePath:"textures/loop_fat.dds",lifetime:1.2,startScale:0.5,
endScale:1.5,startColour:[161/255,201/255,235/255,0.7],endColour:[161/255,201/255,235/255,0],randomRotate:!0,facingSpeed:1.5};I.archetypes.vfx_dst_fire_small3={texturePath:"textures/loop_filled.dds",lifetime:3,startScale:0.5,endScale:2,startColour:[77/255,158/255,229/255,0.7],endColour:[161/255,201/255,235/255,0],randomRotate:!0};I.archetypes.vfx_dst_fire_small4={texturePath:"textures/loop_filled.dds",lifetime:3,startScale:0.25,endScale:1.6,startColour:[77/255,158/255,229/255,0.7],endColour:[161/
255,201/255,235/255,0],randomRotate:!0};I.archetypes.vfx_dst_fire_small5={texturePath:"textures/loop_detail.dds",lifetime:1,startScale:0.5,endScale:1,startColour:[161/255,201/255,235/255,0.7],endColour:[161/255,201/255,235/255,0],randomRotate:!0,alignment:"camera"};I.archetypes.vfx_dst_fire_small6={texturePath:"textures/loop_detail.dds",lifetime:1,startScale:1,endScale:1.75,startColour:[77/255,158/255,229/255,0.7],endColour:[161/255,201/255,235/255,0],randomRotate:!0,alignment:"camera"};I.archetypes.vfx_healing1=
{texturePath:"textures/loop.dds",lifetime:1.2,startScale:0.4,endScale:0.8,startColour:[161/255,201/255,235/255,0.7],endColour:[161/255,201/255,235/255,0],randomRotate:!0,facingSpeed:1,follow:!0};I.archetypes.vfx_healing2={texturePath:"textures/loop.dds",lifetime:1.2,startScale:0.4,endScale:1.2,startColour:[62/255,222/255,34/255,0.7],endColour:[62/255,222/255,34/255,0],randomRotate:!0,facingSpeed:0.5,follow:!0};I.archetypes.vfx_healing3={texturePath:"textures/health_shards.dds",lifetime:1,startScale:0.4,
endScale:0.8,startColour:[161/255,201/255,235/255,0.7],endColour:[161/255,201/255,235/255,0],randomRotate:!0,alignment:"camera",follow:!0};I.archetypes.vfx_healing4={texturePath:"textures/health_shards.dds",lifetime:1,startScale:0.8,endScale:1.4,startColour:[62/255,222/255,34/255,0.7],endColour:[62/255,222/255,34/255,0],randomRotate:!0,alignment:"camera",follow:!0};I.archetypes.vfx_buildoption_1h={texturePath:"textures/loop_detail.dds",lifetime:0.8,startScale:0.2,endScale:0.4,startColour:Jc,endColour:Pd,
alignment:"camera",randomRotate:!0,follow:!0};I.archetypes.vfx_buildoption_1v={texturePath:"textures/loop_detail.dds",lifetime:1,startScale:0.4,endScale:1,startColour:Jc,endColour:Pd,alignment:"camera",randomRotate:!0,follow:!0};I.archetypes.vfx_buildoption_2h={texturePath:"textures/loop_filled.dds",lifetime:0.2,startScale:1,endScale:1.6,startColour:Jc,endColour:Pd,randomRotate:!0,follow:!0};I.archetypes.vfx_buildoption_2v={texturePath:"textures/loop_filled.dds",lifetime:0.2,startScale:1,endScale:1.6,
startColour:Jc,endColour:Pd,alignment:"vertical",randomRotate:!0,follow:!0};I.archetypes.vfx_buildoption_3v={texturePath:"textures/loop_detail.dds",lifetime:0.3,startScale:0.4,endScale:1.6,startColour:Jc,endColour:Pd,alignment:"camera",randomRotate:!0,follow:!0};I.archetypes.vfx_exp_0h={texturePath:"textures/loop_fat.dds",lifetime:2.2,startScale:2,endScale:3,startColour:jd,endColour:kd,randomRotate:!0,facingSpeed:0.7,randomAddedScale:0.2};I.archetypes.vfx_exp_0v={texturePath:"textures/loop_fat.dds",
lifetime:2,startScale:2,endScale:3,startColour:jd,endColour:kd,randomRotate:!0,alignment:"vertical",randomAddedScale:0.2};I.archetypes.vfx_exp_1h={texturePath:"textures/loop.dds",lifetime:0.4,startScale:0.5,endScale:2.5,startColour:Qe,endColour:Re,randomRotate:!0,delay:0,randomAddedScale:0.2};I.archetypes.vfx_exp_1v={texturePath:"textures/loop.dds",lifetime:0.4,startScale:0.5,endScale:2.5,startColour:Qe,endColour:Re,alignment:"vertical",randomRotate:!0,delay:0,randomAddedScale:0.2};I.archetypes.vfx_exp_2h=
{texturePath:"textures/loop.dds",lifetime:0.4,startScale:0.5,endScale:2,startColour:Se,endColour:Te,randomRotate:!0,delay:0,randomAddedScale:0.2};I.archetypes.vfx_exp_2v={texturePath:"textures/loop.dds",lifetime:0.4,startScale:0.5,endScale:2,startColour:Se,endColour:Te,alignment:"vertical",randomRotate:!0,delay:0,randomAddedScale:0.2};I.archetypes.vfx_exp_3h={texturePath:"textures/loop.dds",lifetime:0.4,startScale:0.5,endScale:1,startColour:Ue,endColour:Ve,randomRotate:!0,randomAddedScale:0.2};I.archetypes.vfx_exp_3v=
{texturePath:"textures/loop.dds",lifetime:0.4,startScale:0.5,endScale:1,startColour:Ue,endColour:Ve,alignment:"vertical",randomRotate:!0,randomAddedScale:0.2};I.archetypes.vfx_expBig_0h={texturePath:"textures/loop_fat.dds",lifetime:2.6,startScale:2,endScale:4,startColour:jd,endColour:kd,randomRotate:!0,facingSpeed:0.7,randomAddedScale:0.2};I.archetypes.vfx_expBig_0v={texturePath:"textures/loop_fat.dds",lifetime:2.6,startScale:2,endScale:4,startColour:jd,endColour:kd,randomRotate:!0,alignment:"vertical",
randomAddedScale:0.2};I.archetypes.vfx_expBig_1h={texturePath:"textures/loop.dds",lifetime:0.4,startScale:0.5,endScale:4.5,startColour:Qe,endColour:Re,randomRotate:!0,delay:0,randomAddedScale:0.2};I.archetypes.vfx_expBig_1v={texturePath:"textures/loop.dds",lifetime:0.4,startScale:0.5,endScale:4.5,startColour:Qe,endColour:Re,alignment:"vertical",randomRotate:!0,delay:0,randomAddedScale:0.2};I.archetypes.vfx_expBig_2h={texturePath:"textures/loop.dds",lifetime:0.4,startScale:0.5,endScale:4,startColour:Se,
endColour:Te,randomRotate:!0,delay:0,randomAddedScale:0.2};I.archetypes.vfx_expBig_2v={texturePath:"textures/loop.dds",lifetime:0.4,startScale:0.5,endScale:4,startColour:Se,endColour:Te,alignment:"vertical",randomRotate:!0,delay:0,randomAddedScale:0.2};I.archetypes.vfx_expBig_3h={texturePath:"textures/loop.dds",lifetime:0.4,startScale:0.5,endScale:3.5,startColour:Ue,endColour:Ve,randomRotate:!0,randomAddedScale:0.2};I.archetypes.vfx_expBig_3v={texturePath:"textures/loop.dds",lifetime:0.4,startScale:0.5,
endScale:3.5,startColour:Ue,endColour:Ve,alignment:"vertical",randomRotate:!0,randomAddedScale:0.2};I.archetypes.vfx_exp_decal={texturePath:"textures/decal_real.dds",lifetime:15,startScale:1.9,endScale:1.9,startColour:Qi,endColour:Xe,randomRotate:!0,randomAddedScale:0.5};I.archetypes.vfx_exp_decalBig={texturePath:"textures/decal_real.dds",lifetime:15,startScale:4.2,endScale:4.2,startColour:Qi,endColour:Xe,randomRotate:!0,randomAddedScale:0.5};I.archetypes.vfx_mushroom_puff_1_1v={texturePath:"textures/loop_detail.dds",
lifetime:2,startScale:0.4,endScale:1,startColour:Ye,endColour:Ze,alignment:"camera",randomRotate:!0,follow:!0,randomAddedScale:0.5};I.archetypes.vfx_mushroom_puff_1_2h={texturePath:"textures/loop_filled.dds",lifetime:0.4,startScale:1,endScale:1.6,startColour:Ye,endColour:Ze,randomRotate:!0,follow:!0,randomAddedScale:0.5};I.archetypes.vfx_mushroom_puff_1_2v={texturePath:"textures/loop_filled.dds",lifetime:0.4,startScale:1,endScale:1.6,startColour:Ye,endColour:Ze,alignment:"vertical",randomRotate:!0,
follow:!0,randomAddedScale:0.5};I.archetypes.vfx_mushroom_puff_1_3v={texturePath:"textures/loop_detail.dds",lifetime:0.6,startScale:0.4,endScale:1.6,startColour:kb,endColour:Oa,alignment:"camera",randomRotate:!0,follow:!0,randomAddedScale:0.5};I.archetypes.vfx_mushroom_puff_2_1v={texturePath:"textures/loop_detail.dds",lifetime:2,startScale:0.4,endScale:1,startColour:$e,endColour:af,alignment:"camera",randomRotate:!0,follow:!0,randomAddedScale:0.5};I.archetypes.vfx_mushroom_puff_2_2h={texturePath:"textures/loop_filled.dds",
lifetime:0.4,startScale:1,endScale:1.6,startColour:$e,endColour:af,randomRotate:!0,follow:!0,randomAddedScale:0.5};I.archetypes.vfx_mushroom_puff_2_2v={texturePath:"textures/loop_filled.dds",lifetime:0.4,startScale:1,endScale:1.6,startColour:$e,endColour:af,alignment:"vertical",randomRotate:!0,follow:!0,randomAddedScale:0.5};I.archetypes.vfx_mushroom_puff_2_3v={texturePath:"textures/loop_detail.dds",lifetime:0.6,startScale:0.4,endScale:1.6,startColour:kb,endColour:Oa,alignment:"camera",randomRotate:!0,
follow:!0,randomAddedScale:0.5};I.archetypes.vfx_mushroom_puff_3_1v={texturePath:"textures/loop_detail.dds",lifetime:2,startScale:0.4,endScale:1,startColour:ld,endColour:md,alignment:"camera",randomRotate:!0,follow:!0,randomAddedScale:0.5};I.archetypes.vfx_mushroom_puff_3_2h={texturePath:"textures/loop_filled.dds",lifetime:0.4,startScale:1,endScale:1.6,startColour:ld,endColour:md,randomRotate:!0,follow:!0,randomAddedScale:0.5};I.archetypes.vfx_mushroom_puff_3_2v={texturePath:"textures/loop_filled.dds",
lifetime:0.4,startScale:1,endScale:1.6,startColour:ld,endColour:md,alignment:"vertical",randomRotate:!0,follow:!0,randomAddedScale:0.5};I.archetypes.vfx_mushroom_puff_3_3v={texturePath:"textures/loop_detail.dds",lifetime:0.6,startScale:0.4,endScale:1.6,startColour:kb,endColour:Oa,alignment:"camera",randomRotate:!0,follow:!0,randomAddedScale:0.5};I.archetypes.vfx_mushroom_hit1={texturePath:"textures/loop_detail.dds",lifetime:0.7,startScale:0.4*1.6,endScale:1.6,startColour:Ye,endColour:Ze,alignment:"camera",
randomRotate:!0,follow:!0,randomAddedScale:0.5};I.archetypes.vfx_mushroom_hit2={texturePath:"textures/loop_detail.dds",lifetime:0.7,startScale:0.4*1.6,endScale:1.6,startColour:$e,endColour:af,alignment:"camera",randomRotate:!0,follow:!0,randomAddedScale:0.5};I.archetypes.vfx_mushroom_hit3={texturePath:"textures/loop_detail.dds",lifetime:0.7,startScale:0.4*1.6,endScale:1.6,startColour:ld,endColour:md,alignment:"camera",randomRotate:!0,follow:!0,randomAddedScale:0.5};I.archetypes.vfx_bannerling_alert_mob=
{texturePath:"textures/loop.dds",lifetime:3,startScale:1,endScale:2.5,startColour:[109/255,202/255,225/255,0.7],endColour:[109/255,202/255,225/255,0],alignment:"horizontal",facingSpeed:1};I.archetypes.vfx_bannerling_alert_bombthrower={texturePath:"textures/loop.dds",lifetime:3,startScale:1,endScale:2.5,startColour:[241/255,45/255,0,0.7],endColour:[241/255,45/255,0,0],alignment:"horizontal",facingSpeed:1};I.archetypes.vfx_bannerling_alert_boss={texturePath:"textures/loop.dds",lifetime:3,startScale:1,
endScale:2.5,startColour:[183/255,38/255,127/255,0.7],endColour:[183/255,38/255,127/255,0],alignment:"horizontal",facingSpeed:1};I.archetypes.vfx_bannerling_alert_charger={texturePath:"textures/loop.dds",lifetime:3,startScale:1,endScale:2.5,startColour:[84/255,148/255,76/255,0.7],endColour:[84/255,148/255,76/255,0],alignment:"horizontal",facingSpeed:1};I.archetypes.vfx_bannerling_alert_commando={texturePath:"textures/loop.dds",lifetime:3,startScale:1,endScale:2.5,startColour:[90/255,65/255,151/255,
0.7],endColour:[90/255,65/255,151/255,0],alignment:"horizontal",facingSpeed:1};I.archetypes.vfx_bannerling_alert_death={texturePath:"textures/loop.dds",lifetime:3,startScale:1,endScale:2.5,startColour:[112/255,57/255,136/255,0.7],endColour:[112/255,57/255,136/255,0],alignment:"horizontal",facingSpeed:1};I.archetypes.vfx_bannerling_alert_ranged={texturePath:"textures/loop.dds",lifetime:3,startScale:1,endScale:2.5,startColour:[185/255,84/255,182/255,0.7],endColour:[185/255,84/255,182/255,0],alignment:"horizontal",
facingSpeed:1};I.archetypes.vfx_bannerling_alert_thief={texturePath:"textures/loop.dds",lifetime:3,startScale:1,endScale:2.5,startColour:[79/255,0.4,190/255,0.7],endColour:[79/255,0.4,190/255,0],alignment:"horizontal",facingSpeed:1};I.archetypes.vfx_bannerling_alert_treasuredropper={texturePath:"textures/loop.dds",lifetime:3,startScale:1,endScale:2.5,startColour:[225/255,234/255,58/255,0.7],endColour:[225/255,234/255,58/255,0],alignment:"horizontal",facingSpeed:1};I.archetypes.vfx_dth_crate1={texturePath:"textures/loop.dds",
lifetime:2.5,startScale:1,endScale:1.5,startColour:[0.7,0.7,0.7,0.7],endColour:[1,1,1,0],randomRotate:!0,facingSpeed:0.8};I.archetypes.vfx_dth_crate2={texturePath:"textures/loop_fat.dds",lifetime:2,startScale:1.5,endScale:2,startColour:[0.7,0.7,0.7,0.3],endColour:[1,1,1,0],randomRotate:!0,facingSpeed:0.6};I.archetypes.vfx_dth_crate3={texturePath:"textures/loop_planks.dds",lifetime:2.5,startScale:1.5,endScale:2,startColour:[120/255,79/155,57/255,1],endColour:[120/255,79/155,57/255,0.1],alignment:"camera"};
I.archetypes.arrowPulse={texturePath:"textures/loop.dds",lifetime:2,startScale:0.25,endScale:2,startColour:nd,endColour:od,facingSpeed:0.25};I.archetypes.criticalArrowPulse={texturePath:"textures/loop.dds",lifetime:2,startScale:0.25,endScale:2,startColour:$j,endColour:ak,facingSpeed:0.25};I.archetypes.vfx_dth_e_arrow1h={texturePath:"textures/loop_detail.dds",lifetime:0.8*1.5,startScale:0.2*1.5,endScale:0.4*1.5,startColour:nd,endColour:od,alignment:"camera",randomRotate:!0,follow:!0};I.archetypes.vfx_dth_e_arrow1v=
{texturePath:"textures/loop_detail.dds",lifetime:1.5,startScale:0.4*1.5,endScale:1.5,startColour:nd,endColour:od,alignment:"camera",randomRotate:!0,follow:!0};I.archetypes.vfx_dth_e_arrow2h={texturePath:"textures/loop_filled.dds",lifetime:0.2*1.5,startScale:1.5,endScale:1.6*1.5,startColour:nd,endColour:od,randomRotate:!0,follow:!0};I.archetypes.vfx_dth_e_arrow2v={texturePath:"textures/loop_filled.dds",lifetime:0.2*1.5,startScale:1.5,endScale:1.6*1.5,startColour:nd,endColour:od,alignment:"vertical",
randomRotate:!0,follow:!0};I.archetypes.vfx_dth_e_arrow3v={texturePath:"textures/loop_detail.dds",lifetime:0.3*1.5,startScale:0.4*1.5,endScale:1.6*1.5,startColour:nd,endColour:od,alignment:"camera",randomRotate:!0,follow:!0};I.archetypes.vfx_upgrade_batch1={texturePath:"textures/loop.dds",lifetime:2,startScale:1,endScale:4,startColour:[216/255,67/255,203/255,0.4],endColour:[1,1,1,0],facingSpeed:1};I.archetypes.vfx_upgrade_batch2v={texturePath:"textures/loop_detail.dds",lifetime:1,startScale:0.4,endScale:1,
startColour:kb,endColour:Oa,alignment:"camera",randomRotate:!0,follow:!0};I.archetypes.vfx_upgrade_batch3h={texturePath:"textures/loop_filled.dds",lifetime:0.2,startScale:1,endScale:1.6,startColour:kb,endColour:Oa,randomRotate:!0,follow:!0};I.archetypes.vfx_upgrade_batch3v={texturePath:"textures/loop_filled.dds",lifetime:0.2,startScale:1,endScale:1.6,startColour:kb,endColour:Oa,alignment:"vertical",randomRotate:!0,follow:!0};I.archetypes.vfx_upgrade_batch4v={texturePath:"textures/loop_detail.dds",
lifetime:0.3,startScale:0.4,endScale:1.6,startColour:kb,endColour:Oa,alignment:"camera",randomRotate:!0,follow:!0};I.archetypes.vfx_upgrade_batch5={texturePath:"textures/loop_filled.dds",lifetime:2,startScale:1,endScale:5,startColour:[216/255,67/255,203/255,0.5],endColour:[1,1,1,0]};I.archetypes.vfx_gui_build={texturePath:"textures/loop_detail.dds",lifetime:0.6,startScale:0.08,endScale:0.12,startColour:kb,endColour:Oa,alignment:"camera",randomRotate:!0};I.archetypes.vfx_gui_upgrade={texturePath:"textures/loop_detail.dds",
lifetime:0.6,startScale:0.08,endScale:0.12,startColour:kb,endColour:Oa,alignment:"camera",randomRotate:!0};I.archetypes.vfx_gui_research={texturePath:"textures/loop_detail.dds",lifetime:0.6,startScale:0.08,endScale:0.12,startColour:kb,endColour:Oa,alignment:"camera",randomRotate:!0};I.archetypes.vfx_gui_lumberfull1={texturePath:"textures/loop_detail.dds",lifetime:1.5,startScale:0.14,endScale:5*0.07,startColour:[38/255,199/255,69/255,0.4],endColour:[38/255,199/255,69/255,0],alignment:"camera",randomRotate:!0};
I.archetypes.vfx_gui_lumberfull2={texturePath:"textures/loop_detail.dds",lifetime:1.5,startScale:0.14,endScale:5*0.07,startColour:[38/255,199/255,69/255,0.4],endColour:[38/255,199/255,69/255,0],alignment:"camera",delay:0.5,randomRotate:!0};I.archetypes.vfx_gui_lumberfull3={texturePath:"textures/loop_detail.dds",lifetime:1.5,startScale:0.14,endScale:5*0.07,startColour:[38/255,199/255,69/255,0.4],endColour:[38/255,199/255,69/255,0],alignment:"camera",delay:1,randomRotate:!0};I.archetypes.vfx_gui_stonefull1=
{texturePath:"textures/loop_detail.dds",lifetime:1.5,startScale:0.14,endScale:5*0.07,startColour:[91/255,169/255,232/255,0.7],endColour:[91/255,169/255,232/255,0],alignment:"camera",randomRotate:!0};I.archetypes.vfx_gui_stonefull2={texturePath:"textures/loop_detail.dds",lifetime:1.5,startScale:0.14,endScale:5*0.07,startColour:[91/255,169/255,232/255,0.7],endColour:[91/255,169/255,232/255,0],alignment:"camera",delay:0.5,randomRotate:!0};I.archetypes.vfx_gui_stonefull3={texturePath:"textures/loop_detail.dds",
lifetime:1.5,startScale:0.14,endScale:5*0.07,startColour:[91/255,169/255,232/255,0.7],endColour:[91/255,169/255,232/255,0],alignment:"camera",delay:1,randomRotate:!0};I.archetypes.vfx_gui_rankup1={texturePath:"textures/loop_detail.dds",lifetime:1.5,startScale:0.14,endScale:5*0.07,startColour:[185/255,64/255,237/255,0.7],endColour:[185/255,64/255,237/255,0],alignment:"camera",randomRotate:!0};I.archetypes.vfx_gui_rankup2={texturePath:"textures/loop_detail.dds",lifetime:1.5,startScale:0.14,endScale:5*
0.07,startColour:[185/255,64/255,237/255,0.7],endColour:[185/255,64/255,237/255,0],alignment:"camera",delay:0.5,randomRotate:!0};I.archetypes.vfx_gui_rankup3={texturePath:"textures/loop_detail.dds",lifetime:1.5,startScale:0.14,endScale:5*0.07,startColour:[185/255,64/255,237/255,0.7],endColour:[185/255,64/255,237/255,0],alignment:"camera",delay:1,randomRotate:!0};I.archetypes.vfx_gui_rankup4={texturePath:"textures/loop.dds",lifetime:4,startScale:0.14,endScale:100*0.07,startColour:[185/255,64/255,237/
255,0.7],endColour:[185/255,64/255,237/255,0],alignment:"camera",randomRotate:!0};I.archetypes.vfx_gui_buildingcomplete1={texturePath:"textures/loop_detail.dds",lifetime:1.5,startScale:0.14,endScale:5*0.07,startColour:[0,162/255,167/255,0.7],endColour:[0,162/255,167/255,0],alignment:"camera",randomRotate:!0};I.archetypes.vfx_gui_buildingcomplete2={texturePath:"textures/loop_detail.dds",lifetime:1.5,startScale:0.14,endScale:5*0.07,startColour:[0,162/255,167/255,0.7],endColour:[0,162/255,167/255,0],
alignment:"camera",delay:0.5,randomRotate:!0};I.archetypes.vfx_gui_buildingcomplete3={texturePath:"textures/loop_detail.dds",lifetime:1.5,startScale:0.14,endScale:5*0.07,startColour:[0,162/255,167/255,0.7],endColour:[0,162/255,167/255,0],alignment:"camera",delay:1,randomRotate:!0};I.archetypes.vfx_gui_buildingcomplete4={texturePath:"textures/loop.dds",lifetime:4,startScale:0.14,endScale:100*0.07,startColour:[0,162/255,167/255,0.7],endColour:[0,162/255,167/255,0],alignment:"camera",randomRotate:!0};
I.archetypes.vfx_gui_newquest={texturePath:"textures/loop.dds",lifetime:4,startScale:0.14,endScale:100*0.07,startColour:[250/255,124/255,23/255,0.5],endColour:[250/255,124/255,23/255,0],alignment:"camera",randomRotate:!0};I.archetypes.vfx_gui_newquestarrow={texturePath:"textures/loop.dds",lifetime:1,startScale:0,endScale:0.65,startColour:[250/255,124/255,23/255,1],endColour:[250/255,124/255,23/255,0],alignment:"camera",randomRotate:!0};I.archetypes.vfx_gui_newfillerquestarrow={texturePath:"textures/loop.dds",
lifetime:1,startScale:0,endScale:0.65,startColour:[0,162/255,167/255,1],endColour:[0,162/255,167/255,0],alignment:"camera",randomRotate:!0};I.archetypes.vfx_gui_researchcomplete1={texturePath:"textures/loop_detail.dds",lifetime:1.5,startScale:0.14,endScale:5*0.07,startColour:[250/255,69/255,23/255,0.7],endColour:[250/255,69/255,23/255,0],alignment:"camera",randomRotate:!0};I.archetypes.vfx_gui_researchcomplete2={texturePath:"textures/loop_detail.dds",lifetime:1.5,startScale:0.14,endScale:5*0.07,startColour:[250/
255,69/255,23/255,0.7],endColour:[250/255,69/255,23/255,0],alignment:"camera",delay:0.5,randomRotate:!0};I.archetypes.vfx_gui_researchcomplete3={texturePath:"textures/loop_detail.dds",lifetime:1.5,startScale:0.14,endScale:5*0.07,startColour:[250/255,69/255,23/255,0.7],endColour:[250/255,69/255,23/255,0],alignment:"camera",delay:1,randomRotate:!0};I.archetypes.vfx_gui_researchcomplete4={texturePath:"textures/loop.dds",lifetime:4,startScale:0.14,endScale:100*0.07,startColour:[250/255,69/255,23/255,
0.7],endColour:[250/255,69/255,23/255,0],alignment:"camera",randomRotate:!0};I.archetypes.vfx_gui_wavestarted={texturePath:"textures/loop.dds",lifetime:4,startScale:0.14,endScale:100*0.07,startColour:[227/255,24/255,25/255,0.7],endColour:[227/255,24/255,25/255,0],alignment:"camera",randomRotate:!0};I.archetypes.vfx_gui_badgeachieved1={texturePath:"textures/loop.dds",lifetime:4,startScale:0.14,endScale:100*0.07,startColour:[0,179/255,185/255,0.7],endColour:[0,179/255,185/255,0],alignment:"camera",
randomRotate:!0};I.archetypes.vfx_gui_badgeachieved2={texturePath:"textures/loop.dds",lifetime:4,startScale:0.14,endScale:100*0.07,startColour:[250/255,69/255,23/255,0.7],endColour:[250/255,69/255,23/255,0],alignment:"camera",delay:0.1,randomRotate:!0};I.archetypes.vfx_gui_taskstarted={texturePath:"textures/loop.dds",lifetime:0.8,startScale:0.1*0.07,endScale:6*0.07,startColour:[1,1,1,0.7],endColour:[1,1,1,0],alignment:"camera",randomRotate:!0};I.archetypes.vfx_gui_taskcomplete={texturePath:"textures/loop.dds",
lifetime:0.8,startScale:0.14,endScale:6*0.07,startColour:[0,179/255,185/255,0.7],endColour:[0,179/255,185/255,0],alignment:"camera",randomRotate:!0};I.archetypes.vfx_gui_badgestarted={texturePath:"textures/loop.dds",lifetime:0.8,startScale:0.1*0.07,endScale:6*0.07,startColour:[1,1,1,0.7],endColour:[1,1,1,0],alignment:"camera",randomRotate:!0};I.archetypes.vfx_gui_badgecomplete={texturePath:"textures/loop.dds",lifetime:0.8,startScale:0.14,endScale:6*0.07,startColour:[1,1,1,0.7],endColour:[1,1,1,0],
alignment:"camera",randomRotate:!0};I.archetypes.vfx_gui_radial_open={texturePath:"textures/loop.dds",lifetime:0.5,startScale:0.2,endScale:0.28,startColour:[1,1,1,0.3],endColour:Oa,alignment:"camera"};I.archetypes.vfx_wb_click1={texturePath:"textures/loop_detail.dds",lifetime:2,startScale:0.48,endScale:1.2,startColour:ld,endColour:md,alignment:"camera",randomRotate:!0,follow:!0};I.archetypes.vfx_wb_click2={texturePath:"textures/loop_filled.dds",lifetime:0.4,startScale:1.2,endScale:1.92,startColour:ld,
endColour:md,randomRotate:!0,follow:!0};I.archetypes.vfx_gui_task_panel_complete={texturePath:"textures/loop.dds",lifetime:3,startScale:0.14,endScale:100*0.07,startColour:[72/255,205/255,46/255,0.5],endColour:[72/255,205/255,46/255,0],alignment:"camera",randomRotate:!0};P.prototype={construct:function(a){a.state={}},update:function(){return!0},terminate:function(){},serialize:function(a){a.state=this.state},deserialize:function(a){this.state=a.state}};var Ba=function(a){return function(){var b=a.name+
"Command",c=this[b]=function(){var c=new P;c.name=b;c.update=a.updateFunction;a.terminateFunction&&(c.terminate=a.terminateFunction);a.initialisationFunction&&(c.initialisation=a.initialisationFunction);return c};this[a.name]=function(b){var e=c();e.construct(e);e.scope=b;a.initialState&&(e.state=Object.create(a.initialState));if(a.argumentNames){var g;for(g=0;g<a.argumentNames.length;g+=1)e.state[a.argumentNames[g]]=arguments[1+g]}var h;a.outputName&&(h=e.state[a.outputName]=b.script.addLocal());
e.initialisation&&e.initialisation();b.script.add(e);return h}}};Ba({name:"BeginBattle",argumentNames:["battleArchetypeName","locationID","battleLevel"],updateFunction:function(){var a=this.scope,b=a.script,c=a.globals.gameManager.getEntityFactory(),d=this.state.battleArchetypeName,a=this.state.battleLevel,e=b.getLocal(this.state.locationID),b=[e],c=c.createInactiveEntityInstance(d,d,e),d=c.getEC("ECAttackWavesManager");d.setSpawnLocationList(b);d.setLevel(a);c.activate();return!0}})();Yf.prototype=
new P;Yf.prototype.update=function(){var a=0<this.scope.globals.gameManager.buildingManager.getBuildingCount(this.state.buildingType);this.scope.script.setLocal(this.state.existsFlag,a);return!0};Yf.create=function(a,b){var c=new Yf;P.prototype.construct(c);c.name="CheckBuildingExistsCommand";c.scope=a;c.state.buildingType=b;c.state.existsFlag=a.script.addLocal();return c};Ba({name:"CreateEntity",argumentNames:["entityData"],outputName:"entityID",updateFunction:function(){var a=this.scope.globals.gameManager,
b=this.scope.script,c=a.getEntityFactory(),d=null,e,g,h,i;e=this.state.entityData.name;g=this.state.entityData.archeType;h=this.state.entityData.factionSide;var j=this.state.entityData.v3Scale,d=b.getLocal(this.state.entityData.locationID),d=c.createInactiveEntityInstance(e,g,d);j&&d.setV3Scale(j);d.activate();if(d&&(c=d.getEC("ECFaction")))"hero"===h?i=a.getFactionManager().getHeroFactionName():"enemy"===h&&(i=a.getFactionManager().getEnemyFactionName()),c.setFaction(i);b.setLocal(this.state.entityID,
d.getName());return!0}})();Ba({name:"DefaultCamera",updateFunction:function(){this.scope.globals.gameManager.getGameCamera().setModeViewScene(this.scope.globals.gameManager.getHero());return!0}})();Ba({name:"DestroyEntitiesByFamilyName",argumentNames:["familyName"],updateFunction:function(){for(var a=this.scope.globals.gameManager.getGameEntitiesByFamilyName(this.state.familyName),b=a.length,c=0;c<b;c+=1)a[c].setToBeDestroyed();return!0}})();Ba({name:"DestroyEntity",argumentNames:["entityName"],updateFunction:function(){var a=
this.scope.script.getLocal(this.state.entityName);this.scope.globals.gameManager.getGameEntityByName(a).setToBeDestroyed();return!0}})();Zf.prototype=new P;Zf.prototype.update=function(){this.scope.globals.gameManager.disableAttacks();return!0};Zf.create=function(a){var b=new Zf;P.prototype.construct(b);b.scope=a;b.name="DisableAttacksCommand";return b};$f.prototype=new P;$f.prototype.update=function(){this.scope.globals.gameManager.disableCampaignRegion(this.state.campaignRegionName);return!0};$f.create=
function(a,b){var c=new $f;P.prototype.construct(c);c.scope=a;c.name="DisableCampaignRegionCommand";c.state.campaignRegionName=b;return c};ud.prototype=new P;ud.prototype.update=function(){this.scope.globals.gameManager.guiManager.removeVignette(this.state.transitionDuration);return!0};ud.create=function(a,b){var c=new ud;P.prototype.construct(c);c.name="DisableVignetteCommand";c.scope=a;c.state.transitionDuration=b;return c};ag.prototype=new P;ag.prototype.update=function(){this.scope.globals.gameManager.enableAttacks();
return!0};ag.create=function(a){var b=new ag;P.prototype.construct(b);b.scope=a;b.name="EnableAttacksCommand";return b};bg.prototype=new P;bg.prototype.update=function(){this.scope.globals.gameManager.enableCampaignRegion(this.state.campaignRegionName);return!0};bg.create=function(a,b){var c=new bg;P.prototype.construct(c);c.scope=a;c.name="EnableCampaignRegionCommand";c.state.campaignRegionName=b;return c};vd.prototype=new P;vd.prototype.update=function(){this.scope.globals.gameManager.guiManager.addVignette(this.state.transitionDuration);
return!0};vd.create=function(a,b){var c=new vd;P.prototype.construct(c);c.name="EnableVignetteCommand";c.scope=a;c.state.transitionDuration=b;return c};cg.prototype=new P;cg.prototype.update=function(){var a=scope.globals.gameManager.getHero().getEC("ECPlayerData");return!a.getLoading()?(a=a.getNumberOfGamesPlayed())&&0<a.count?(this.scope.script.terminate(),!1):!0:!1};cg.create=function(a){var b=new cg;P.prototype.construct(b);b.name="GameFirstStartCommand";b.scope=a;return b};dg.prototype=new P;
dg.prototype.update=function(){var a=this.scope.globals.gameManager.getHero().getEC("ECPlayerBuilder");this.scope.script.setLocal(this.state.resultID,a.getBuildingResourceCost(this.state.buildingName));return!0};dg.create=function(a,b){var c=new dg;P.prototype.construct(c);c.name="GetBuildingResourceCostCommand";c.scope=a;c.state.buildingName=b;c.state.resultID=a.script.addLocal();return c};eg.prototype=new P;eg.prototype.update=function(){var a=this.scope.globals.gameManager.getHero().getEC("ECResourceCarrier");
this.scope.script.setLocal(this.state.resultID,a.getResource(this.state.resourceType));return!0};eg.create=function(a,b){var c=new eg;P.prototype.construct(c);c.name="GetCarriedResourceQuantityCommand";c.scope=a;c.state.resourceType=b;c.state.resultID=a.script.addLocal();return c};be.prototype=new P;be.prototype.update=function(){var a=this.scope.data[this.state.dataPropertyName],b=this.scope.script;if(!a)return b.terminate(),!1;b.setLocal(this.state.resultID,a.getName());return!0};be.create=function(a,
b){var c=new be;P.prototype.construct(c);c.scope=a;c.name="GetEntityIdFromScriptDataCommand";c.state.dataPropertyName=b;c.state.resultID=a.script.addLocal();return c};var zj=function(a,b,c){b=be.create(a,b,c);a.script.add(b);return b.state.resultID};ce.prototype=new P;ce.prototype.update=function(){var a=this.scope.globals.gameManager,b=this.scope.script,c=null,c=b.getLocal(this.state.entityID),c=a.getGameEntityByName(c);if(!c)return b.terminate(),!1;b.setLocal(this.state.resultID,c.getv3Location());
return!0};ce.create=function(a,b){var c=new ce;P.prototype.construct(c);c.scope=a;c.name="GetEntityLocationCommand";c.state.entityID=b;c.state.resultID=a.script.addLocal();return c};var bf=function(a,b){var c=ce.create(a,b);a.script.add(c);return c.state.resultID};Ba({name:"GetEntityUpgradeResourceCost",argumentNames:["entityID","resourceType"],outputName:"id",updateFunction:function(){var a=this.scope.globals.gameManager,b=this.scope.script,c=null,c=b.getLocal(this.state.entityID),c=a.getGameEntityByName(c);
if(!c)return b.terminate(),!1;a=c.getEC("ECUpgradable");if(!a)return b.terminate(),!1;b=this.state.resourceType===E.LUMBER?a.getResourceCost():a.getSecondaryResourceCost();this.scope.script.setLocal(this.state.id,b);return!0}})();Ba({name:"GetHero",outputName:"id",updateFunction:function(){var a=this.scope.globals.gameManager.getHero().getName();this.scope.script.setLocal(this.state.id,a);return!0}})();de.prototype=new P;de.prototype.update=function(){var a=this.scope.script,b=this.scope.globals.gameManager.getEntitiesWithEC("ECLocationMarker"),
c=[],d=null,e=null,g,h=this.state.locationName,i=this.state.locationType;for(g=b.length-1;0<=g;g-=1){var e=b[g],d=e.getEC("ECLocationMarker"),j=h&&d.getLocationName()===h,d=i&&d.getType()===i;j&&(void 0===i||d)&&c.push(e)}if(0>=c.length)return a.terminate(),!1;a.setLocal(this.state.resultID,c[0].getName());return!0};de.create=function(a,b,c){var d=new de;P.prototype.construct(d);d.scope=a;d.name="GetLocationMarkerCommand";d.state.locationName=b;d.state.locationType=c;d.state.resultID=a.script.addLocal();
return d};fg.prototype=new P;fg.prototype.update=function(){var a=this.scope.globals.gameManager,b=this.scope.script,c=null,c=b.getLocal(this.state.locationID),c=a.getNearestGameEntityByArcheType(this.state.archeType,c);if(!c)return b.terminate(),!1;b.setLocal(this.state.resultID,c.getName());return!0};fg.create=function(a,b,c){var d=new fg;P.prototype.construct(d);d.scope=a;d.name="GetNearestEntityByArcheTypeCommand";d.state.locationID=c;d.state.archeType=b;d.state.resultID=a.script.addLocal();return d};
ee.prototype=new P;ee.prototype.update=function(){var a=this.scope.globals.gameManager,b=this.scope.script,c=b.getLocal(this.state.locationID),a=a.getNearestGameEntityByFamilyName(this.state.familyName,c);if(!a)return b.terminate(),!1;b.setLocal(this.state.resultID,a.getName());return!0};ee.create=function(a,b,c){var d=new ee;P.prototype.construct(d);d.scope=a;d.name="GetNearestEntityByFamilyNameCommand";d.state.locationID=c;d.state.familyName=b||a.data.familyName;d.state.resultID=a.script.addLocal();
return d};var Aj=function(a,b,c){b=ee.create(a,b,c);a.script.add(b);return b.state.resultID};gg.prototype=new P;gg.prototype.update=function(){var a=this.scope.globals.gameManager.getHero().getEC("ECPlayerData");return!a.getLoading()?(this.scope.script.setLocal(this.state.resultID,a.getNumberOfGamesPlayed().count),!0):!1};gg.create=function(a){var b=new gg;P.prototype.construct(b);b.name="GetNumberOfGamesPlayedCommand";b.scope=a;b.state.resultID=a.script.addLocal();return b};fe.prototype=new P;fe.prototype.update=
function(){var a=this.scope.globals.mathDevice,b=this.scope.script,c=this.scope.globals.gameManager.getEntitiesWithEC("ECLocationMarker"),d=[],e=null,g=null,h,i=this.state.locationName;for(h=c.length-1;0<=h;h-=1)g=c[h],e=g.getEC("ECLocationMarker"),e.getLocationName()===i&&d.push(g);if(0>=d.length)return b.terminate(),!1;h=a.randomIntInRange(0,d.length-1);b.setLocal(this.state.resultID,d[h].getv3Location());return!0};fe.create=function(a,b){var c=new fe;P.prototype.construct(c);c.scope=a;c.name="GetRandomLocationMarkerCommand";
c.state.locationName=b;c.state.resultID=a.script.addLocal();return c};var cf=function(a,b){var c=fe.create(a,b);a.script.add(c);return c.state.resultID};hg.prototype=new P;hg.prototype.update=function(){var a=this.scope.script,b=this.scope.globals.mathDevice,c=this.scope.globals.gameManager.getEntitiesWithEC("ECAttackManager"),d=[],e=null,e=null,g,h=this.state.typeName;for(g=c.length-1;0<=g;g-=1)e=c[g],e=e.getEC("ECAttackManager"),e.getType()===h&&d.push(e);if(0>=d.length)return a.terminate(),!1;
g=b.randomIntInRange(0,d.length-1);a.setLocal(this.state.resultID,d[g].getRandomV3SpawnLocation());return!0};hg.create=function(a,b){var c=new hg;P.prototype.construct(c);c.scope=a;c.name="GetRandomSpawnLocationCommand";c.state.typeName=b;c.state.resultID=a.script.addLocal();return c};ig.prototype=new P;ig.prototype.update=function(){var a=this.scope.globals.gameManager.getHero().getEC("ECPlayerData");return!a.getLoading()?(a=a.getScriptFlags(),this.scope.script.setLocal(this.state.resultID,a[this.state.flagName]),
!0):!1};ig.create=function(a,b){var c=new ig;P.prototype.construct(c);c.name="GetScriptFlagCommand";c.scope=a;c.state.flagName=b;c.state.resultID=a.script.addLocal();return c};jg.prototype=new P;jg.prototype.update=function(){var a=this.scope.script,b=this.scope.globals.gameManager.getEntitiesWithEC("ECAttackSpawner"),c=[],d=null,e=null,g,h=this.state.locationName;for(g=b.length-1;0<=g;g-=1)e=b[g],d=e.getEC("ECAttackSpawner"),d.type===h&&c.push(e);if(0>=c.length)return a.terminate(),!1;a.setLocal(this.state.resultID,
c[0].getv3Location());return!0};jg.create=function(a,b){var c=new jg;P.prototype.construct(c);c.scope=a;c.name="GetSpawnLocationCommand";c.state.locationName=b;c.state.resultID=a.script.addLocal();return c};ge.prototype=new P;ge.prototype.update=function(){var a=this.scope.globals.mathDevice,b=this.scope.script,c=this.scope.script.getLocal(this.state.entityId),d=this.scope.globals.gameManager.getGameEntityByName(c),c=a.v3Copy(d.getv3Location());if(d=d.getEC("ECMesh")){var d=d.node.calculateHierarchyWorldExtents(),
e=a.v3BuildZero(),g=a.v3BuildZero();a.aabbGetCenterAndHalf(d,e,g);a.v3Build(0,g[1],0,c);a.v3Add(e,c,c)}b.setLocal(this.state.resultID,c);return!0};ge.create=function(a,b){var c=new ge;P.prototype.construct(c);c.scope=a;c.name="GetSpawnLocationForTaskLocationMarkerCommand";c.state.entityId=b;c.state.resultID=a.script.addLocal();return c};var jk=function(a,b){var c=ge.create(a,b);a.script.add(c);return c.state.resultID};kg.prototype=new P;kg.prototype.update=function(){var a;a=this.scope.globals.gameManager.getHero().getEC("ECPlayerData");
var b=this.scope.script;a=a.getResourceCap(this.state.resourceType);b.setLocal(this.state.resultID,a);return!0};kg.create=function(a,b){var c=new kg;P.prototype.construct(c);c.name="GetStoredResourceLimitCommand";c.scope=a;c.state.resourceType=b;c.state.resultID=a.script.addLocal();return c};Ba({name:"GetUsername",outputName:"id",updateFunction:function(){var a=this.scope.globals.userProfile.username.slice(0),a=a.charAt(0).toUpperCase()+a.slice(1);this.scope.globals.gameManager.getGuest()&&(a="Traveller");
this.scope.script.setLocal(this.state.id,a);return!0}})();lg.prototype=new P;lg.prototype.update=function(){var a=this.scope.script,b=this.scope.globals.gameManager.getHero().getEC("ECPlayerBuilder");if(!b)return a.terminate(),!1;b.placeInHand(this.state.buildingName,1,!1,!1,void 0,!0);return!0};lg.create=function(a,b){var c=new lg;P.prototype.construct(c);c.name="GiveHeroBuildingCommand";c.scope=a;c.state.buildingName=b;return c};mg.prototype=new P;mg.prototype.update=function(){var a=this.scope.script,
b=this.scope.globals.gameManager.getHero().getEC("ECResourceCarrier");if(!b)return a.terminate(),!1;b.adjustResource(this.state.resourceType,this.state.quantity);return!0};mg.create=function(a,b,c){var d=new mg;P.prototype.construct(d);d.name="GiveHeroResourceCommand";d.scope=a;d.state.resourceType=b;d.state.quantity=c;return d};he.prototype=new P;he.prototype.update=function(){this.scope.globals.gameManager.getHero().getEC("ECPlayerData").adjustSoftCurrency(this.state.quantity);return!0};he.create=
function(a,b){var c=new he;P.prototype.construct(c);c.name="GiveHeroSoftCurrencyCommand";c.scope=a;c.state.quantity=b;return c};var Bj=function(a,b){var c=he.create(a,b);a.script.add(c)};ng.prototype=new P;ng.prototype.update=function(){var a=this.scope.script,b=this.scope.globals.gameManager.getHero(),c=b.getEC("ECInventory"),b=b.getEC("ECPlayerData");if(!c||!b)return a.terminate(),!1;c.equipWeapon(this.state.weaponName);return!0};ng.create=function(a,b){var c=new ng;P.prototype.construct(c);c.name=
"GiveHeroWeaponCommand";c.scope=a;c.state.weaponName=b;return c};ie.prototype=new P;ie.prototype.update=function(){var a=this.scope.script,b=this.scope.globals.gameManager.getHero().getEC("ECPlayerData");if(!b)return a.terminate(),!1;b.adjustResource(this.state.resourceType,this.state.quantity,!0);return!0};ie.create=function(a,b,c){var d=new ie;P.prototype.construct(d);d.name="GiveResourceCommand";d.scope=a;d.state.resourceType=b;d.state.quantity=c;return d};var Cj=function(a,b,c){b=ie.create(a,
b,c);a.script.add(b)};wd.prototype=new P;wd.prototype.update=function(){var a=!0,b=this.scope.globals.mathDevice,c=this.scope.script.getLocal(this.state.id),c=this.scope.globals.gameManager.getGameEntityByName(c),d=this.scope.globals.gameManager.getGameCamera();d.setModePanToEntity(c);this.state.waitForCompletion&&(this.state.v3Diff=b.v3Sub(c.getv3Location(),d.getCurrentV3Focus()),a=0.01>=b.v3LengthSq(this.state.v3Diff)?!0:!1);return a};wd.prototype.terminate=function(){this.scope.globals.gameManager.getGameCamera().setModeViewScene(this.scope.globals.gameManager.getHero())};
wd.create=function(a,b,c){var d=new wd;P.prototype.construct(d);d.name="PanCameraCommand";d.scope=a;d.state.id=b;d.state.waitForCompletion=c;d.state.v3Diff=a.globals.mathDevice.v3BuildZero();return d};var Dj=function(a,b,c){b=wd.create(a,b,c);a.script.add(b)};Ba({name:"PauseGame",updateFunction:function(){this.scope.globals.gameManager.getGameClock().pause();return!0},terminateFunction:function(){this.scope.globals.gameManager.getGameClock().resume()}})();Ba({name:"PlaySound",argumentNames:["soundName",
"loop"],updateFunction:function(){this.scope.globals.gameManager.gameSoundManager.play(this.state.soundName);return!0}})();og.prototype=new P;og.prototype.update=function(){Oc.prototype.removeText(this.scope,this.state.textID);return!0};og.create=function(a,b){var c=new og;P.prototype.construct(c);c.scope=a;c.name="RemoveTextCommand";c.state.textID=b;return c};Ba({name:"ResumeGame",updateFunction:function(){this.scope.globals.gameManager.getGameClock().resume();return!0}})();Ba({name:"SendEvent",
argumentNames:["eventName"],updateFunction:function(){var a=this.state.eventName;this.scope.globals.gameManager.getEventManager().notify(a);return!0}})();Ba({name:"SetBuildingTypeEnabled",argumentNames:["buildingType","enabled"],updateFunction:function(){Oi[this.state.buildingType]=!this.state.enabled;this.scope.globals.gameManager.getBuildingManager().triggerBuildingChangedEvent();return!0}})();pg.prototype=new P;pg.prototype.update=function(){var a=this.scope.globals.gameManager,b=this.scope.script,
c=b.getLocal(this.state.entityID),a=a.getGameEntityByName(c),c=b.getLocal(this.state.destinationID);if(!a||!c)return b.terminate(),!1;a.getEC("ECAgent")||a.setv3Location(c);return!0};pg.create=function(a,b,c){var d=new pg;P.prototype.construct(d);d.scope=a;d.name="SetEntityDestinationCommand";d.state.entityID=b;d.state.destinationID=c;return d};Ba({name:"SetEntityMovementEnabled",argumentNames:["entityId","isMovementEnabled"],updateFunction:function(){var a=this.scope.script.getLocal(this.state.entityId),
a=this.scope.globals.gameManager.getGameEntityByName(a),b=this.state.isMovementEnabled;a.getEC("ECLocomotion").setActive(b);return!0}})();Ba({name:"SetEntitySleeping",argumentNames:["entityId","shouldSleep"],updateFunction:function(){var a=this.scope.script.getLocal(this.state.entityId),a=this.scope.globals.gameManager.getGameEntityByName(a),b=this.state.shouldSleep;a.getEC("ECSleeping").setSleeping(b);return!0}})();je.prototype=new P;je.prototype.update=function(){var a=this.scope.globals.gameManager,
b=this.scope.script,c,d;c=b.getLocal(this.state.entityID);c=a.getGameEntityByName(c);d=b.getLocal(this.state.targetEntityID);a=a.getGameEntityByName(d);if(!c||!a)return b.terminate(),!1;c=c.getEC("ECAgent");if(!c)return b.terminate(),!1;c.setTargetEntity(a);return!0};je.create=function(a,b,c){var d=new je;P.prototype.construct(d);d.scope=a;d.name="SetEntityTargetCommand";d.state.entityID=b;d.state.targetEntityID=c;return d};var df=function(a,b,c){b=je.create(a,b,c);a.script.add(b)};Ba({name:"SetGameplayFeatureFlag",
argumentNames:["flagName","flagValue"],updateFunction:function(){Ob[this.state.flagName]=this.state.flagValue;return!0}})();qg.prototype=new P;qg.prototype.update=function(){var a=this.scope.globals.gameManager.getHero().getEC("ECPlayerData");return!a.getLoading()?(a.setScriptFlag(this.state.flagName,this.state.value),!0):!1};qg.create=function(a,b,c){var d=new qg;P.prototype.construct(d);d.name="SetScriptFlagCommand";d.scope=a;d.state.flagName=b;d.state.value=c;return d};rg.prototype=new P;rg.prototype.update=
function(){var a=this.scope.globals.gameManager.getHero().getEC("ECPlayerData");if(a.getLoading())return!1;this.scope.script.getLocal(this.state.conditionID)&&a.setScriptFlag(this.state.flagName,this.state.value);return!0};rg.create=function(a,b,c,d){var e=new rg;P.prototype.construct(e);e.name="SetScriptFlagIfTrueCommand";e.scope=a;e.state.flagName=c;e.state.value=d;e.state.conditionID=b;return e};sg.prototype=new P;sg.prototype.update=function(){var a=this.scope.globals.gameManager.getHero().getEC("ECPlayerData");
if(a.getLoading())return!1;this.scope.script.getLocal(this.state.conditionID)||a.setScriptFlag(this.state.flagName,this.state.value);return!0};sg.create=function(a,b,c,d){var e=new sg;P.prototype.construct(e);e.name="SetScriptFlagIfFalseCommand";e.scope=a;e.state.flagName=c;e.state.value=d;e.state.condition=b;return e};tg.prototype=new P;tg.prototype.update=function(){var a=this.scope.globals.gameManager.getTaskManager(),b=this.scope.script.getLocal(this.state.taskId);a.completeTaskById(b);return!0};
tg.create=function(a,b){var c=new tg;P.prototype.construct(c);c.name="SetTaskCompleteCommand";c.scope=a;c.state.taskId=b;return c};ug.prototype=new P;ug.prototype.update=function(){var a=this.scope.globals.gameManager,b=this.scope.script;if(void 0===this.state.dialogID)return b.terminate(),!1;b=b.getLocal(this.state.dialogID);a.guiManager.removeControl(b);return!0};ug.create=function(a,b){var c=new ug;P.prototype.construct(c);c.scope=a;c.name="RemoveDialog";c.state.dialogID=b;return c};Ba({name:"SetTimeOfDay",
argumentNames:["gameTimeInHours"],updateFunction:function(){this.scope.globals.gameManager.setGameDayTime(this.state.gameTimeInHours,!1);return!0}})();vg.prototype=new P;vg.prototype.update=function(){var a=this.scope.globals.gameManager,b=this.scope.script,c=this.scope.globals.guiRenderer,d=this.scope.script.getLocal(this.state.textID),c=c.getv2RenderLocation(0,-150,"bottom"),e=this.state.params,g=this.state.dialogID;if(0<e.length&&!this.state.formated){var h,i=[];for(h=0;h<e.length;h+=1)i[h]=b.getLocal(e[h]);
d=hf.prototype.format.apply(null,Array.prototype.concat.call(d,i));b.setLocal(this.state.textID,d);this.state.formated=!0}this.state.firstTime||(b=this.scope.globals.metricsManager,b.sendGameMetric("showDialog_"+g),this.state.firstTime=!0);return!this.state.showOkButton?(a.guiManager.addDialog(d,d,c,this.state.showOkButton),!0):a.getIMGui().doDialog(d,d,c,this.state.showOkButton)?!0:!1};vg.create=function(a,b,c,d){var e=new vg;P.prototype.construct(e);e.scope=a;e.name="ShowDialogCommand";e.state.textID=
a.script.addLocal(c);e.state.showOkButton=d;e.state.dialogID=b;var g=Array.prototype.slice.call(arguments);g.shift();g.shift();g.shift();g.shift();e.state.params=g;return e};wg.prototype=new P;wg.prototype.update=function(){var a=this.scope.globals,b=a.gameManager,c=this.scope.script,a=a.guiRenderer.getv2RenderLocation(0,-150,"bottom"),d=this.state.data.params;if(0<d.length&&!this.state.formated){var e,g=[];for(e=0;e<d.length;e+=1)g[e]=c.getLocal(d[e]);for(e=0;e<this.state.data.textArray.length;e+=
1)this.state.data.textArray[e]=hf.prototype.format.apply(null,Array.prototype.concat.call(this.state.data.textArray[e],g));this.state.formated=!0}d=this.state.dialogID;this.state.prevPage!==this.state.data.currentPage&&(c=this.scope.globals.metricsManager,d="showDialog_"+d+"_page_"+this.state.data.currentPage,c.sendGameMetric(d),this.state.prevPage=this.state.data.currentPage);return b.getIMGui().doPagedDialog(this.state.data.textArray[0],this.state.data,a)?!0:!1};wg.create=function(a,b,c,d){var e=
new wg;P.prototype.construct(e);e.scope=a;e.name="ShowPagedDialogCommand";var g=Array.prototype.slice.call(arguments);g.shift();g.shift();g.shift();g.shift();e.state.dialogID=b;e.state.prevPage=-1;e.state.data={textArray:c,currentPage:0,finalButtonText:d,params:g};return e};Oc.prototype=new P;Oc.prototype.update=function(){var a=this.scope.script.getLocal(this.state.textID);this.scope.globals.gameManager.getGuiManager().addGameMessage(a,a,void 0,Infinity,"gameMessageSingle");return!0};Oc.prototype.terminate=
function(){this.removeText(this.scope,this.state.textID)};Oc.prototype.removeText=function(a,b){var c=a.script.getLocal(b);a.globals.gameManager.getGuiManager().removeGameMessage(c)};Oc.create=function(a,b){var c=new Oc;P.prototype.construct(c);c.scope=a;c.name="ShowTextCommand";c.state.textID=a.script.addLocal(b);return c};Ba({name:"StartEntityLifetimeCountdown",argumentNames:["entityId"],updateFunction:function(){var a=this.scope.script.getLocal(this.state.entityId);this.scope.globals.gameManager.getGameEntityByName(a).getEC("ECLifetime").startCountdown();
return!0}})();Ba({name:"StopSound",argumentNames:["soundName","fadeTime"],updateFunction:function(){this.scope.globals.gameManager.gameSoundManager.stop(this.state.soundName,void 0,this.state.fadeTime);return!0}})();Ba({name:"TestEqualOrGreaterThan",argumentNames:["variableID","testValue"],updateFunction:function(){var a=this.scope.script;if(a.getLocal(this.state.variableID)>=this.state.testValue)return!0;a.terminate();return!1}})();Ba({name:"TestEqualOrLessThan",argumentNames:["variableID","testValue"],
updateFunction:function(){var a=this.scope.script;if(a.getLocal(this.state.variableID)<=this.state.testValue)return!0;a.terminate();return!1}})();Ba({name:"TestEqualTo",argumentNames:["variableID","testValue"],updateFunction:function(){var a=this.scope.script;if(a.getLocal(this.state.variableID)===this.state.testValue)return!0;a.terminate();return!1}})();Ba({name:"TestGreaterThan",argumentNames:["variableID","testValue"],updateFunction:function(){var a=this.scope.script;if(a.getLocal(this.state.variableID)>
this.state.testValue)return!0;a.terminate();return!1}})();Ba({name:"TestLessThan",argumentNames:["variableID","testValue"],updateFunction:function(){var a=this.scope.script;if(a.getLocal(this.state.variableID)<this.state.testValue)return!0;a.terminate();return!1}})();Ba({name:"TestNotEqualTo",argumentNames:["variableID","testValue"],updateFunction:function(){var a=this.scope.script;if(a.getLocal(this.state.variableID)!==this.state.testValue)return!0;a.terminate();return!1}})();Ba({name:"UnequipHeroWeapon",
argumentNames:[],updateFunction:function(){this.scope.globals.gameManager.getHero().getEC("ECInventory").unequipWeapon();return!0}})();xg.prototype=new P;xg.prototype.update=function(){this.scope.globals.gameManager.setScriptLocked(!1);return!0};xg.create=function(a){var b=new xg;P.prototype.construct(b);b.name="UnlockScriptsCommand";b.scope=a;b.state.existsFlag=a.script.addLocal();return b};yg.prototype=new P;yg.prototype.update=function(){var a=this.scope.globals.gameManager;return!a.isScriptLocked()?
(a.setScriptLocked(!0),!0):!1};yg.create=function(a){var b=new yg;P.prototype.construct(b);b.name="WaitForAndLockScriptsCommand";b.scope=a;b.state.existsFlag=a.script.addLocal();return b};Ba({name:"Wait",initialState:{currentTime:0},argumentNames:["duration","useGameTime"],updateFunction:function(){this.state.currentTime=this.state.useGameTime?this.state.currentTime+this.scope.globals.gameManager.gameClock.getTimeStep():this.state.currentTime+this.scope.globals.appTimeStep;return this.state.currentTime>=
this.state.duration}})();zg.prototype=new P;zg.prototype.update=function(){var a=this.scope.globals.gameManager,b=this.scope.script;if(void 0===this.state.dialogID)return b.terminate(),!1;b=b.getLocal(this.state.dialogID);a.guiManager.showDialogOkButton(b);return a.guiManager.getUserInteraction(b)?(a.guiManager.removeControl(b),!0):!1};zg.create=function(a,b){var c=new zg;P.prototype.construct(c);c.scope=a;c.name="WaitDialog";c.state.dialogID=b;return c};ke.prototype=new P;ke.prototype.update=function(){if(!this.callback)if(0<
this.scope.globals.gameManager.buildingManager.getBuildingCount(this.state.buildingType))this.state.triggered=!0;else{var a=this;this.callback=function(b){b.building.getBuildingType()===a.state.buildingType&&(a.state.triggered=!0,a.scope.globals.gameManager.eventManager.unsubscribe("BuildingAdded",a.callback))};this.scope.globals.gameManager.eventManager.subscribe("BuildingAdded",this.callback)}return this.state.triggered};ke.prototype.terminate=function(){this.callback&&this.scope.globals.gameManager.eventManager.unsubscribe("BuildingAdded",
this.callback)};ke.create=function(a,b){var c=new ke;P.prototype.construct(c);c.name="WaitBuildingAddedCommand";c.scope=a;c.state.buildingType=b;c.state.triggered=!1;return c};le.prototype=new P;le.prototype.update=function(){if(!this.callback&&(0<this.scope.globals.gameManager.buildingManager.getBuildingCount(this.state.buildingType)&&!this.scope.globals.gameManager.buildingManager.getBuildingByType(this.state.buildingType).entity.getEC("ECScaffold")&&(this.state.triggered=!0),!this.state.triggered)){var a=
this;this.callback=function(b){"completed"===b.reason&&b.building.getEC("ECBuilding").getBuildingType()===a.state.buildingType&&(a.state.triggered=!0,a.scope.globals.gameManager.eventManager.unsubscribe("BuildingEvent",a.callback))};this.scope.globals.gameManager.eventManager.subscribe("BuildingEvent",this.callback)}return this.state.triggered};le.prototype.terminate=function(){this.callback&&this.scope.globals.gameManager.eventManager.unsubscribe("BuildingEvent",this.callback)};le.create=function(a,
b){var c=new le;P.prototype.construct(c);c.name="WaitBuildingCompletedCommand";c.scope=a;c.state.buildingType=b;c.state.triggered=!1;return c};me.prototype=new P;me.prototype.update=function(){if(!this.callback&&(0<this.scope.globals.gameManager.buildingManager.getBuildingCount(this.state.buildingType)&&this.scope.globals.gameManager.buildingManager.getBuildingByType(this.state.buildingType).getLevel()===this.state.testValueID&&(this.state.triggered=!0),!this.state.triggered)){var a=this;this.callback=
function(b){var c=b.building.getEC("ECBuilding");"levelup"===b.reason&&(c.getBuildingType()===a.state.buildingType&&c.getLevel()===a.state.testValueID)&&(a.state.triggered=!0,a.scope.globals.gameManager.eventManager.unsubscribe("BuildingEvent",a.callback))};this.scope.globals.gameManager.eventManager.subscribe("BuildingEvent",this.callback)}return this.state.triggered};me.prototype.terminate=function(){this.callback&&this.scope.globals.gameManager.eventManager.unsubscribe("BuildingEvent",this.callback)};
me.create=function(a,b,c){var d=new me;P.prototype.construct(d);d.name="WaitUntilBuildingLevelEqualToCommand";d.scope=a;d.state.buildingType=b;d.state.testValueID=c;d.state.triggered=!1;return d};Pc.prototype=new P;Pc.prototype.update=function(){if(!this.callback){var a=this;this.callback=function(){a.state.triggered=!0;a.scope.globals.gameManager.eventManager.unsubscribe("CampaignStarted",a.callback)};this.scope.globals.gameManager.eventManager.subscribe("CampaignStarted",this.callback)}return this.state.triggered};
Pc.prototype.terminate=function(){this.callback&&this.scope.globals.gameManager.eventManager.unsubscribe("CampaignStarted",this.callback)};Pc.create=function(a){var b=new Pc;P.prototype.construct(b);b.name="WaitUntilCampaignBeginsCommand";b.scope=a;b.state.triggered=!1;return b};xd.prototype=new P;xd.prototype.update=function(){if(!this.callback){var a=this;this.callback=function(){a.state.triggered=!0;a.scope.globals.gameManager.eventManager.unsubscribe("CampaignScoreScreenExited",a.callback)};this.scope.globals.gameManager.eventManager.subscribe("CampaignScoreScreenExited",
this.callback)}return this.state.triggered};xd.prototype.terminate=function(){this.callback&&this.scope.globals.gameManager.eventManager.unsubscribe("CampaignScoreScreenExited",this.callback)};xd.create=function(a){var b=new xd;P.prototype.construct(b);b.name="WaitUntilCampaignEndsCommand";b.scope=a;b.state.triggered=!1;return b};Ag.prototype=new P;Ag.prototype.update=function(){var a;a=this.scope.globals.gameManager.getHero().getEC("ECResourceCarrier");var b=this.scope.script;a=a.getResource(this.state.resourceType);
return void 0!==a&&a>b.getLocal(this.state.testValueID)?!0:!1};Ag.create=function(a,b,c){var d=new Ag;P.prototype.construct(d);d.name="WaitUntilCarriedResourceGreaterThanCommand";d.scope=a;d.state.resourceType=b;d.state.testValueID=c;return d};Bg.prototype=new P;Bg.prototype.update=function(){var a;a=this.scope.globals.gameManager.getHero().getEC("ECResourceCarrier");var b=this.scope.script;a=a.getResource(this.state.resourceType);return void 0!==a&&a<b.getLocal(this.state.testValueID)?!0:!1};Bg.create=
function(a,b,c){var d=new Bg;P.prototype.construct(d);d.name="WaitUntilCarriedResourceLessThanCommand";d.scope=a;d.state.resourceType=b;d.state.testValueID=c;return d};Ba({name:"WaitUntilDistanceBetweenHeroAndFamilyNameLessThan",argumentNames:["familyName","distance"],updateFunction:function(){var a=this.state.familyName,b=this.state.distance,b=b*b,c=this.scope.globals,d=c.gameManager,c=c.mathDevice,e=d.getHero();return e&&(e=e.getv3Location(),a=d.getNearestGameEntityByFamilyName(a,e))?(a=a.getv3Location(),
c.v3DistanceSq(e,a)<b):!1}})();Ba({name:"WaitUntilDistanceFromEntityGreaterThan",argumentNames:["entityID","distance","targetEntityID"],updateFunction:function(){var a=this.scope.globals.gameManager,b=this.scope.script,c=this.scope.globals.mathDevice,d=null,e=null,g;g=b.getLocal(this.state.entityID);d=a.getGameEntityByName(g);if(!d)return LocalConsole.error(b.getTemplateName()+" (line "+b.activeCommandIndex+") : "+this.name+" : could not find entity "+g),b.terminate(),!1;g=b.getLocal(this.state.targetEntityID);
e=a.getGameEntityByName(g);if(!e)return LocalConsole.error(b.getTemplateName()+" (line "+b.activeCommandIndex+") : "+this.name+" : could not find entity "+g),b.terminate(),!1;a=d.getv3Location();e=e.getv3Location();void 0===this.state.destination&&(this.state.v3Diff=c.v3BuildZero());this.state.v3Diff=c.v3Sub(e,a,this.state.v3Diff);return c.v3Length(this.state.v3Diff)>this.state.distance?!0:!1}})();Ba({name:"WaitUntilDistanceFromEntityLessThan",argumentNames:["entityID","targetEntityID","distance"],
updateFunction:function(){var a=this.scope.globals.gameManager,b=this.scope.script,c=this.scope.globals.mathDevice,d=b.getLocal(this.state.entityID),d=a.getGameEntityByName(d),b=b.getLocal(this.state.targetEntityID),a=a.getGameEntityByName(b),d=d.getv3Location(),a=a.getv3Location(),a=c.v3Sub(a,d),c=c.v3LengthSq(a),a=this.state.distance;return c<a*a}})();Ba({name:"WaitUntilDistanceLessThan",argumentNames:["locationAId","locationBId","separationDistance"],updateFunction:function(){var a=this.scope.script,
b=this.scope.globals.mathDevice,c=a.getLocal(this.state.locationAId),a=a.getLocal(this.state.locationBId),c=b.v3Sub(c,a),b=b.v3LengthSq(c),c=this.state.separationDistance;return b<c*c}})();Ba({name:"WaitUntilEntityDestroyed",argumentNames:["entityId"],updateFunction:function(){var a=this.scope.globals.gameManager,b=this.scope.script.getLocal(this.state.entityId);return a.getGameEntityByName(b).toBeDestroyed}})();ne.prototype=new P;ne.prototype.update=function(){var a=this.scope.globals.gameManager,
b=this.scope.script,c=null,c=null,c=b.getLocal(this.state.entityID),c=a.getGameEntityByName(c);if(!c)return!0;c=c.getEC("ECHealth");return!c?(b.terminate(),!1):c.getHealth()<=b.getLocal(this.state.testValueID)?!0:!1};ne.create=function(a,b,c){var d=new ne;P.prototype.construct(d);d.name="WaitUntilEntityHealthLessThanEqualToCommand";d.scope=a;d.state.entityID=b;d.state.testValueID=c;return d};var ef=function(a,b,c){b=ne.create(a,b,c);a.script.add(b)};yd.prototype=new P;yd.prototype.update=function(){this.callback||
(this.callback=function(){this.state.triggered=!0;this.scope.globals.gameManager.eventManager.unsubscribe(this.state.eventName,this.callback)}.bind(this),this.scope.globals.gameManager.eventManager.subscribe(this.state.eventName,this.callback));return this.state.triggered};yd.prototype.terminate=function(){this.callback&&this.scope.globals.gameManager.eventManager.unsubscribe(this.state.eventName,this.callback)};yd.create=function(a,b){var c=new yd;P.prototype.construct(c);c.name="WaitUntilEventCommand";
c.scope=a;c.state.eventName=b;c.state.triggered=!1;return c};jc.prototype=new P;jc.prototype.update=function(){this.state.callbackAdded||(this.state.callbackAdded=!0,this.addECInteractable());this.state.hasInteracted&&this.removeECInteractable();return this.state.hasInteracted};jc.prototype.onInteract=function(){this.state.hasInteracted=!0};jc.prototype.addECInteractable=function(){var a=this.scope.globals,b=a.gameManager.getHero(),c=F.createFromName("ECInteractable",a);b.addECToCustomEntity(c);a=
F.createFromName("ECSelectable",a);a.setRadiusFactor(3);b.addECToCustomEntity(a);b.getEC("ECInteractable").setOnInteractCallback(this.onInteract.bind(this))};jc.prototype.removeECInteractable=function(){var a=this.scope.globals.gameManager.getHero();a.removeECFromCustomEntity("ECInteractable");a.removeECFromCustomEntity("ECSelectable")};jc.prototype.terminate=function(){this.removeECInteractable()};jc.create=function(a){var b=new jc;P.prototype.construct(b);b.name="WaitUntilHeroInteractCommand";b.scope=
a;b.state.hasInteracted=!1;b.state.callbackAdded=!1;return b};oe.prototype=new P;oe.prototype.update=function(){if(!this.callback){var a=this;this.callback=function(){a.state.triggered=!0;a.scope.globals.gameManager.eventManager.unsubscribe("InvasionEnded",a.callback)};this.scope.globals.gameManager.eventManager.subscribe("InvasionEnded",this.callback)}return this.state.triggered};oe.prototype.terminate=function(){this.callback&&this.scope.globals.gameManager.eventManager.unsubscribe("InvasionEnded",
this.callback)};oe.create=function(a){var b=new oe;P.prototype.construct(b);b.name="WaitUntilInvasionEndsCommand";b.scope=a;b.state.triggered=!1;return b};pe.prototype=new P;pe.prototype.update=function(){if(!this.callback){var a=this;this.callback=function(){a.state.triggered=!0;a.scope.globals.gameManager.eventManager.unsubscribe("InvasionStarted",a.callback)};this.scope.globals.gameManager.eventManager.subscribe("InvasionStarted",this.callback)}return this.state.triggered};pe.prototype.terminate=
function(){this.callback&&this.scope.globals.gameManager.eventManager.unsubscribe("InvasionStarted",this.callback)};pe.create=function(a){var b=new pe;P.prototype.construct(b);b.name="WaitUntilInvasionStartsCommand";b.scope=a;b.state.triggered=!1;return b};qe.prototype=new P;qe.prototype.update=function(){if(!this.callback&&!this.state.triggered){var a=this;this.callback=function(b){a.state.resourceType===b.type&&(a.state.triggered=!0,a.scope.globals.gameManager.eventManager.unsubscribe("ResourceDeposited",
a.callback))};this.scope.globals.gameManager.eventManager.subscribe("ResourceDeposited",this.callback)}return this.state.triggered};qe.prototype.terminate=function(){this.callback&&this.scope.globals.gameManager.eventManager.unsubscribe("ResourceDeposited",this.callback)};qe.create=function(a,b){var c=new qe;P.prototype.construct(c);c.name="WaitUntilResourceDepositedCommand";c.scope=a;c.state.resourceType=b;c.state.triggered=!1;return c};Cg.prototype=new P;Cg.prototype.update=function(){var a=this.scope.globals.gameManager.getHero().getEC("ECPlayerData"),
b=a.getResourceCap(this.state.resourceType);return a.getResource(this.state.resourceType)>=b};Cg.create=function(a,b){var c=new Cg;P.prototype.construct(c);c.name="WaitUntilResourceCapHitCommand";c.scope=a;c.state.resourceType=b;return c};Dg.prototype=new P;Dg.prototype.update=function(){var a;a=this.scope.globals.gameManager.getHero().getEC("ECPlayerData");var b=this.scope.script;a=a.getResource(this.state.resourceType);return void 0!==a&&a>=b.getLocal(this.state.testValueID)?!0:!1};Dg.create=function(a,
b,c){var d=new Dg;P.prototype.construct(d);d.name="WaitUntilResourceGreaterThanEqualToCommand";d.scope=a;d.state.resourceType=b;d.state.testValueID=c;return d};Eg.prototype=new P;Eg.prototype.update=function(){var a;a=this.scope.globals.gameManager.getHero().getEC("ECPlayerData");var b=this.scope.script;a=a.getResource(this.state.resourceType);return void 0!==a&&a<=b.getLocal(this.state.testValueID)?!0:!1};Eg.create=function(a,b,c){var d=new Eg;P.prototype.construct(d);d.name="WaitUntilResourceLessThanEqualToCommand";
d.scope=a;d.state.resourceType=b;d.state.testValueID=c;return d};Fg.prototype=new P;Fg.prototype.update=function(){var a=this.scope.globals.gameManager.getHero().getEC("ECPlayerData");return!a.getLoading()&&a.getScriptFlags()[this.state.flagName]===this.state.testValue?!0:!1};Fg.create=function(a,b,c){var d=new Fg;P.prototype.construct(d);d.name="WaitUntilScriptFlagEqualToCommand";d.scope=a;d.state.flagName=b;d.state.testValue=c;return d};Gg.prototype=new P;Gg.prototype.update=function(){var a=this.scope.globals.gameManager.getHero().getEC("ECPlayerData");
return!a.getLoading()&&a.getScriptFlags()[this.state.flagName]>this.state.testValue?!0:!1};Gg.create=function(a,b,c){var d=new Gg;P.prototype.construct(d);d.name="WaitUntilScriptFlagGreaterThanCommand";d.scope=a;d.state.flagName=b;d.state.testValue=c;return d};Hg.prototype=new P;Hg.prototype.update=function(){var a=this.scope.globals.gameManager.getHero().getEC("ECPlayerData");return!a.getLoading()&&a.getScriptFlags()[this.state.flagName]<this.state.testValue?!0:!1};Hg.create=function(a,b,c){var d=
new Hg;P.prototype.construct(d);d.name="WaitUntilScriptFlagLessThanCommand";d.scope=a;d.state.flagName=b;d.state.testValue=c;return d};re.prototype=new P;re.prototype.update=function(){if(!this.callback){var a=this;this.callback=function(){a.state.triggered=!0;a.scope.globals.gameManager.eventManager.unsubscribe("SkirmishEnded",a.callback)};this.scope.globals.gameManager.eventManager.subscribe("SkirmishEnded",this.callback)}return this.state.triggered};re.prototype.terminate=function(){this.callback&&
this.scope.globals.gameManager.eventManager.unsubscribe("SkirmishEnded",this.callback)};re.create=function(a){var b=new re;P.prototype.construct(b);b.name="WaitUntilSkirmishEndsCommand";b.scope=a;b.state.triggered=!1;return b};se.prototype=new P;se.prototype.update=function(){if(!this.callback){var a=this;this.callback=function(){a.state.triggered=!0;a.scope.globals.gameManager.eventManager.unsubscribe("SkirmishStarted",a.callback)};this.scope.globals.gameManager.eventManager.subscribe("SkirmishStarted",
this.callback)}return this.state.triggered};se.prototype.terminate=function(){this.callback&&this.scope.globals.gameManager.eventManager.unsubscribe("SkirmishStarted",this.callback)};se.create=function(a){var b=new se;P.prototype.construct(b);b.name="WaitUntilSkirmishStartsCommand";b.scope=a;b.state.triggered=!1;return b};Ba({name:"ZoomCamera",argumentNames:["zoomDist"],outputName:"resultID",initialisationFunction:function(){0>this.state.zoomDist&&(LocalConsole.error(this.scope.script.getTemplateName()+
" (line "+this.scope.script.activeCommandIndex+") : "+this.name+" : specified negative zoom distance "+this.state.zoomDist),this.state.zoomDist=-this.state.zoomDist)},updateFunction:function(){var a=this.scope.globals.mathDevice;void 0===this.scope.script.getLocal(this.state.resultID)&&this.scope.script.setLocal(this.state.resultID,this.scope.globals.gameManager.gameCamera.panOffset);var b=this.scope.globals.gameManager.gameCamera.getCurrentV3Position(),c=this.scope.globals.gameManager.gameCamera.getCurrentV3Focus(),
b=a.v3Sub(b,c),b=a.v3Normalize(b,b);this.scope.globals.gameManager.gameCamera.panOffset=a.v3ScalarMul(b,this.state.zoomDist,this.scope.globals.gameManager.gameCamera.panOffset);return!0}})();Ba({name:"ProfilingBuildLevel",updateFunction:function(){var a=this.scope.globals.mathDevice,b=this.scope.globals.gameManager,c=b.getEntityFactory(),d=a.v3Copy(b.getHeroRespawnPosition()),e=b.getHero().getEC("ECPlayerBuilder"),g=b.getFactionManager().getHeroFactionName();d[0]+=5;d[2]+=5;var a=a.v3BuildZero(),
h=d[0]-10,i=d[2]-10,j,k;b.clearUserData();d[1]=0;j=e.getv3BuildLocation(d);c.createActiveEntityInstance("a_b_hq_level_5","a_b_hq_level_5",j);a[0]=h;a[1]=0;a[2]=i;for(h=0;20>h;h+=1)10!==h&&(j=e.getv3BuildLocation(a),c.createActiveEntityInstance("bottom_"+h,"a_d_wall_level_5",j)),a[0]+=1;a[2]+=20;for(h=0;20>h;h+=1)10!==h&&(j=e.getv3BuildLocation(a),c.createActiveEntityInstance("top_"+h,"a_d_wall_level_5",j)),a[0]-=1;a[0]+=20;a[2]-=1;for(h=0;20>h;h+=1)10!==h&&(j=e.getv3BuildLocation(a),c.createActiveEntityInstance("Right_"+
h,"a_d_wall_level_5",j)),a[2]-=1;a[0]-=20;a[2]+=2;for(h=0;20>h;h+=1)10!==h&&(j=e.getv3BuildLocation(a),c.createActiveEntityInstance("left_"+h,"a_d_wall_level_5",j)),a[2]+=1;a[0]=d[0]-7.5;a[2]=d[2]-7.5;j=e.getv3BuildLocation(a);k=c.createActiveEntityInstance("tower_0","a_d_tower_level_5",j);(k=k.getEC("ECFaction"))&&k.setFaction(g);a[0]=d[0]+7.5;j=e.getv3BuildLocation(a);k=c.createActiveEntityInstance("tower_1","a_d_tower_level_5",j);(k=k.getEC("ECFaction"))&&k.setFaction(g);a[0]=d[0]-7.5;a[2]=d[2]+
7.5;j=e.getv3BuildLocation(a);k=c.createActiveEntityInstance("tower_2","a_d_tower_level_5",j);(k=k.getEC("ECFaction"))&&k.setFaction(g);a[0]=d[0]+7.5;j=e.getv3BuildLocation(a);k=c.createActiveEntityInstance("tower_3","a_d_tower_level_5",j);(k=k.getEC("ECFaction"))&&k.setFaction(g);a[0]=d[0];a[2]=d[2]+5;j=e.getv3BuildLocation(a);k=c.createActiveEntityInstance("warehouse","a_b_lumberstorage_level_5",j);(k=k.getEC("ECFaction"))&&k.setFaction(g);a[0]=d[0]+5;a[2]=d[2];j=e.getv3BuildLocation(a);k=c.createActiveEntityInstance("lumbermill",
"a_b_lumbermill_level_5",j);(k=k.getEC("ECFaction"))&&k.setFaction(g);a[0]=d[0]-5;a[2]=d[2];j=e.getv3BuildLocation(a);k=c.createActiveEntityInstance("workshop","a_b_workshop_level_5",j);(k=k.getEC("ECFaction"))&&k.setFaction(g);var l=i=j=0,m=["a_e_inv_stomper_05","a_e_inv_ranged_05","a_e_inv_berserker_05","a_e_inv_bombthrower_05","a_e_inv_brawler_05"],q=[4,6,4,6,20],p=[5,2,2,2,2],s=[10,0,0,0,0];k=0;g=b.getFactionManager().getEnemyFactionName();a[1]=d[1];for(h=0;h<m.length;h+=1){j=q[h];i=Math.ceil(q[h]/
5);l=p[h];b=s[h];k=h%4;2>k?(a[0]=d[0]+(0===h%2?-(20+b):20+b),a[2]=d[2]):2<=k&&(a[0]=d[0],a[2]=d[2]+(2===h?-(20+b):20+b));for(a=e.getv3BuildLocation(a);0<j&&0<i;){if(k=c.createActiveEntityInstance(m[h]+j,m[h],a))(k=k.getEC("ECFaction"))&&k.setFaction(g);j-=1;a[0]+=l;0===j%5&&(a[0]-=5*l,a[2]+=l,i-=1)}}return!0}})();Ba({name:"ProfilingEndProfile",updateFunction:function(){var a=this.scope.globals.profilingData;a.performanceProfiling&&(a.performanceProfiling=!1,console.profileEnd(a.performanceProfileName));
return!0}})();Ig.prototype=new P;Ig.prototype.update=function(){var a=this.scope.globals.graphicsDevice,b=this.scope.globals.gameManager,c=this.scope.globals.settings.shadows,d=(1E3/b.minMsPerFrameInGame).toFixed(2),e=(1E3/b.maxMsPerFrameInGame).toFixed(2),b=(1E3*b.numberOfFramesInGame/b.cumulativeMsPerFrameInGame).toFixed(2),a="Resolution - "+a.width+" x "+a.height,a=a+("\nShadows "+(c?"On":"Off"))+("\nFPS - AVG : "+b),a=a+(", MIN : "+e+", MAX : "+d);this.scope.script.setLocal(this.state.summaryID,
a);return!0};Ig.create=function(a){var b=new Ig;P.prototype.construct(b);b.scope=a;b.name="ProfilingGetSummaryCommand";b.state.summaryID=a.script.addLocal("");return b};Ba({name:"ProfilingStartProfile",updateFunction:function(){var a=this.scope.globals.profilingData;a.performanceProfiling||(a.performanceProfiling=!0,a.performanceProfilingCount+=1,a.performanceProfileName="PolyCraft Profile "+a.performanceProfilingCount,console.profile(a.performanceProfileName));return!0}})();Jg.prototype={add:function(a){this.scriptTemplates[a.name]=
a},run:function(a,b){var c=te.create(this.scriptTemplates[a],this.globals,b);this.scriptInstances.push(c);return c},terminate:function(a){a.terminate()},reset:function(){for(;this.scriptInstances.length;)this.scriptInstances.pop()},update:function(){for(var a=0;a<this.scriptInstances.length;)this.scriptInstances[a].update()?this.scriptInstances.splice(a,1):a+=1},serialize:function(){var a={version:1,scriptInstances:[]},b;for(b=0;b<this.scriptInstances.length;b+=1)if(this.scriptTemplates[this.scriptInstances[b].getTemplateName()].persistent){var c=
{};a.scriptInstances.push(c);this.scriptInstances[b].serialize(c)}return a},deserialize:function(a){this.reset();var b;for(b=0;b<a.scriptInstances.length;b+=1){var c=te.create(null,this.globals);c.deserialize(a.scriptInstances[b]);this.scriptInstances.push(c)}}};Jg.create=function(a){var b=new Jg;b.globals=a;b.scriptTemplates={};b.scriptInstances=[];return b};te.prototype={add:function(a){this.activeCommandIndex=0;this.commands.push(a)},addLocal:function(a){this.scope.locals.push(a);return this.scope.locals.length-
1},getLocal:function(a){return this.scope.locals[a]},setLocal:function(a,b){this.scope.locals[a]=b},update:function(){if(-1===this.activeCommandIndex)return!0;for(;this.activeCommandIndex<this.commands.length&&this.commands[this.activeCommandIndex].update();)this.activeCommandIndex<this.commands.length&&(this.activeCommandIndex+=1);return this.commands.length===this.activeCommandIndex},terminate:function(){var a;for(a=0;a<this.activeCommandIndex;a+=1)this.commands[a].terminate();this.activeCommandIndex=
this.commands.length},serialize:function(a){a.data=this.scope.data;a.locals=this.scope.locals;a.templateName=this.templateName;a.activeCommandIndex=this.activeCommandIndex;a.commands=[];var b;for(b=0;b<this.commands.length;b+=1){var c={type:this.commands[b].name,data:{}};a.commands[b]=c;this.commands[b].serialize(c.data)}},deserialize:function(a){this.scope.data=a.data;this.scope.locals=a.locals;this.templateName=a.templateName;this.activeCommandIndex=a.activeCommandIndex;this.commands=[];var b;for(b=
0;b<a.commands.length;b+=1){var c=a.commands[b],d=new window[c.type];P.prototype.construct(d);d.scope=this.scope;d.deserialize(c.data);this.commands[b]=d}},getActiveCommandIndex:function(){return this.activeCommandIndex},getTemplateName:function(){return this.templateName}};te.create=function(a,b,c){var d=new te;d.scope={data:c,globals:b,locals:[],language:b.currentLanguage,script:d};d.templateName=a.name;d.commands=[];d.activeCommandIndex=-1;a&&a.run(d.scope);return d};var ja={scriptMap:{}};Kg.prototype=
{initialise:function(){this.globals.profiling&&this.scriptManager.add({name:"ProfilingScript",run:ProfilingScript,persistent:!1})},addScript:function(a,b){this.scripts.push({scriptTemplate:a,runOnStartUp:b})},onGameStart:function(){var a;for(a=0;a<this.scripts.length;a+=1)this.scriptManager.add(this.scripts[a].scriptTemplate);for(a=0;a<this.scripts.length;a+=1)this.scripts[a].runOnStartUp&&this.scriptManager.run(this.scripts[a].scriptTemplate.name)},runScript:function(a,b,c,d){a={name:a,run:b,persisent:c};
b=this.scriptManager;b.add(a);b.run(a.name,d)},reset:function(){this.loaded=!1;this.scriptManager.reset()},update:function(){this.scriptManager.update()},serialize:function(){return{version:1,scriptManager:this.scriptManager.serialize()}},deserialize:function(a){this.loaded=!0;this.scriptManager.deserialize(a.scriptManager);return!0}};Kg.create=function(a){var b=new Kg;b.globals=a;b.scriptManager=Jg.create(a);b.loaded=!1;b.scripts=[];a.gameManager.eventManager.subscribe("GameStarted",function(){b.onGameStart()});
return b};ja.scriptMap.TaskCreateArrowScript=function(a){var b=zj(a,"targetEntity"),c=bf(a,b),b=jk(a,b);CreateEntity(a,{name:"TaskLocationArrow",archeType:"a_tlm_tasklocationmarker",locationID:b});CreateEntity(a,{name:"TaskLocationEffect",archeType:"a_tle_tasklocationeffect",locationID:c})};ja.scriptMap.TaskCreateCriticalArrowScript=function(a){var b=zj(a,"targetEntity"),c=bf(a,b),b=jk(a,b);CreateEntity(a,{name:"TaskLocationArrow",archeType:"a_tlm_criticaltasklocationmarker",locationID:b});CreateEntity(a,
{name:"TaskLocationEffect",archeType:"a_tle_criticaltasklocationeffect",locationID:c})};ja.scriptMap.TaskDestroyArrowScript=function(a){DestroyEntitiesByFamilyName(a,"tasklocationmarker");DestroyEntitiesByFamilyName(a,"tasklocationeffect")};ja.scriptMap.TaskStartArrowLifetimeCountdown=function(a){var b=GetHero(a),b=bf(a,b),c=Aj(a,"tasklocationmarker",b);StartEntityLifetimeCountdown(a,c);b=Aj(a,"tasklocationeffect",b);StartEntityLifetimeCountdown(a,b)};ja.scriptMap.TaskOpenDescriptionScript=function(a){var b=
zj(a,"targetEntity");Dj(a,b);b=vd.create(a,0.5);a.script.add(b)};ja.scriptMap.TaskCloseDescriptionScript=function(a){var b=GetHero(a),c=ud.create(a,1.5);a.script.add(c);Dj(a,b);DefaultCamera(a)};ja.scriptMap.enableCampaignsScript=function(a){SetGameplayFeatureFlag(a,"campaignsEnabled",!0)};ja.scriptMap.disableCampaignsScript=function(a){SetGameplayFeatureFlag(a,"campaignsEnabled",!1)};ja.scriptMap.wakeUpTutorialScript=function(a){var b=GetHero(a);SetTimeOfDay(a,21);UnequipHeroWeapon(a);SetEntityMovementEnabled(a,
b,!1);SetEntitySleeping(a,b,!0);Dj(a,b);ZoomCamera(a,12);var c=vd.create(a,0.5);a.script.add(c);c=yd.create(a,"taskDescriptionOpened");a.script.add(c);c=jc.create(a,b);a.script.add(c);SetEntitySleeping(a,b,!1);c=ud.create(a,1.5);a.script.add(c);DefaultCamera(a);SetEntityMovementEnabled(a,b,!0);SendEvent(a,"wakeUpTaskComplete")};ja.scriptMap.getWeaponTutorialScript=function(a){var b=de.create(a,"tutorialGun",void 0);a.script.add(b);b=bf(a,b.state.resultID);b=CreateEntity(a,{name:"TutorialGun",archeType:"e_s_floating_gun",
locationID:b,v3Scale:[3,3,3]});UnequipHeroWeapon(a);WaitUntilEntityDestroyed(a,b);SendEvent(a,"getWeaponTaskComplete")};ja.scriptMap.shootCrateTutorialScript=function(a){var b=GetHero(a),b=bf(a,b),b=Aj(a,"tutorialcrate",b);WaitUntilEntityDestroyed(a,b);SendEvent(a,"ShootCrateTaskComplete")};ja.scriptMap.defeatWildlingsScript=function(a){var b=GetHero(a);WaitUntilDistanceBetweenHeroAndFamilyNameLessThan(a,"triggerBridge",2);var c=cf(a,"tutorialEnemy1"),d=cf(a,"tutorialEnemy2"),e=cf(a,"tutorialEnemy3"),
g=cf(a,"tutorialEnemy4"),h=cf(a,"tutorialEnemy5"),c=CreateEntity(a,{name:"TutorialBandit",archeType:"a_e_dday_melee",factionSide:"enemy",locationID:c});df(a,c,b);d=CreateEntity(a,{name:"TutorialBandit",archeType:"a_e_dday_melee",factionSide:"enemy",locationID:d});df(a,d,b);e=CreateEntity(a,{name:"TutorialBandit",archeType:"a_e_dday_ranged",factionSide:"enemy",locationID:e});df(a,e,b);g=CreateEntity(a,{name:"TutorialBandit",archeType:"a_e_dday_ranged",factionSide:"enemy",locationID:g});df(a,g,b);h=
CreateEntity(a,{name:"TutorialBandit",archeType:"a_e_dday_ranged",factionSide:"enemy",locationID:h});df(a,h,b);b=a.script.addLocal(0);ef(a,c,b);ef(a,d,b);ef(a,e,b);ef(a,g,b);ef(a,h,b);SendEvent(a,"DefeatWildlingsScriptTaskComplete")};ja.scriptMap.goToVillageScript=function(a){WaitUntilDistanceBetweenHeroAndFamilyNameLessThan(a,"workshop",12);DestroyEntitiesByFamilyName(a,"barricade_tutorial");DestroyEntitiesByFamilyName(a,"barricadegate_tutorial");DestroyEntitiesByFamilyName(a,"turret_tutorial");
SendEvent(a,"GoToVillageTaskComplete")};ja.scriptMap.buildHqCompleteScript=function(a){Bj(a,75)};ja.scriptMap.goToCavesStartupScript=function(a){SetGameplayFeatureFlag(a,"buildingMovementEnabled",!1)};ja.scriptMap.goToCavesVisibleScript=function(a){WaitUntilDistanceBetweenHeroAndFamilyNameLessThan(a,"mapbannerling",15);SetGameplayFeatureFlag(a,"buildingMovementEnabled",!0);SendEvent(a,"GoToCavesTaskComplete")};ja.scriptMap.buildOutpostCompleteScript=function(a){Cj(a,E.LUMBER,250);Bj(a,80)};ja.scriptMap.buildBarricadeCompleteScript=
function(a){Cj(a,E.LUMBER,200)};ja.scriptMap.buildGateCompleteScript=function(a){Cj(a,E.LUMBER,400)};ja.scriptMap.startCampaignScript=function(a){SetGameplayFeatureFlag(a,"campaignsEnabled",!0);var b=Pc.create(a);a.script.add(b);SendEvent(a,"StartCampaignTaskComplete")};ja.scriptMap.startCampaign2Script=function(a){var b=Pc.create(a);a.script.add(b);SendEvent(a,"StartCampaign2TaskComplete")};ja.scriptMap.winCampaignScript=function(a){var b=xd.create(a);a.script.add(b);SendEvent(a,"WinCampaignTaskComplete")};
ja.scriptMap.buildMarketplaceCompleteScript=function(a){Bj(a,10)};ja.scriptMap.goToTotemAgilityScript=function(a){WaitUntilDistanceBetweenHeroAndFamilyNameLessThan(a,"totemAgility",12);SendEvent(a,"GoToTotemAgilityTaskComplete")};ja.scriptMap.goToTotemPowerScript=function(a){WaitUntilDistanceBetweenHeroAndFamilyNameLessThan(a,"totemPower",12);SendEvent(a,"GoToTotemPowerTaskComplete")};ja.scriptMap.goToTotemTechnologyScript=function(a){WaitUntilDistanceBetweenHeroAndFamilyNameLessThan(a,"totemTechnology",
12);SendEvent(a,"GoToTotemTechnologyTaskComplete")};ja.scriptMap.goToTotemProtectionScript=function(a){WaitUntilDistanceBetweenHeroAndFamilyNameLessThan(a,"totemProtection",12);SendEvent(a,"GoToTotemProtectionTaskComplete")};ja.scriptMap.buildHqStartupScript=function(a){SetBuildingTypeEnabled(a,"HQ",!1)};ja.scriptMap.buildHqVisibleScript=function(a){SetBuildingTypeEnabled(a,"HQ",!0)};ja.scriptMap.buildLumbermillStartupScript=function(a){SetBuildingTypeEnabled(a,"Lumbermill",!1)};ja.scriptMap.buildLumbermillVisibleScript=
function(a){SetBuildingTypeEnabled(a,"Lumbermill",!0)};ja.scriptMap.buildStonemillStartupScript=function(a){SetBuildingTypeEnabled(a,"Stonemill",!1)};ja.scriptMap.buildStonemillVisibleScript=function(a){SetBuildingTypeEnabled(a,"Stonemill",!0)};ja.scriptMap.buildLumberlingHutStartupScript=function(a){SetBuildingTypeEnabled(a,"Lumberling Hut",!1)};ja.scriptMap.buildLumberlingHutVisibleScript=function(a){SetBuildingTypeEnabled(a,"Lumberling Hut",!0)};ja.scriptMap.buildStonelingHutStartupScript=function(a){SetBuildingTypeEnabled(a,
"Stoneling Hut",!1)};ja.scriptMap.buildStonelingHutVisibleScript=function(a){SetBuildingTypeEnabled(a,"Stoneling Hut",!0)};ja.scriptMap.buildDefenceFactoryStartupScript=function(a){SetBuildingTypeEnabled(a,"Defence Factory",!1)};ja.scriptMap.buildDefenceFactoryVisibleScript=function(a){SetBuildingTypeEnabled(a,"Defence Factory",!0)};ja.scriptMap.buildDefendlingHutStartupScript=function(a){SetBuildingTypeEnabled(a,"Defendling Hut",!1)};ja.scriptMap.buildDefendlingHutVisibleScript=function(a){SetBuildingTypeEnabled(a,
"Defendling Hut",!0)};ja.scriptMap.buildAmberChestStartupScript=function(a){SetBuildingTypeEnabled(a,"Treasure Chest",!1)};ja.scriptMap.buildAmberChestVisibleScript=function(a){SetBuildingTypeEnabled(a,"Treasure Chest",!0)};ja.scriptMap.buildLumberStorageStartupScript=function(a){SetBuildingTypeEnabled(a,"Lumber Storage",!1)};ja.scriptMap.buildLumberStorageVisibleScript=function(a){SetBuildingTypeEnabled(a,"Lumber Storage",!0)};ja.scriptMap.buildStoneStorageStartupScript=function(a){SetBuildingTypeEnabled(a,
"Stone Storage",!1)};ja.scriptMap.buildStoneStorageVisibleScript=function(a){SetBuildingTypeEnabled(a,"Stone Storage",!0)};ja.scriptMap.buildOutpostStartupScript=function(a){SetBuildingTypeEnabled(a,"Outpost",!1)};ja.scriptMap.buildOutpostVisibleScript=function(a){SetBuildingTypeEnabled(a,"Outpost",!0)};ja.scriptMap.buildBarricadeStartupScript=function(a){SetBuildingTypeEnabled(a,"Barricade",!1)};ja.scriptMap.buildBarricadeVisibleScript=function(a){SetBuildingTypeEnabled(a,"Barricade",!0)};ja.scriptMap.buildWoodenGateStartupScript=
function(a){SetBuildingTypeEnabled(a,"Barricade Gate",!1)};ja.scriptMap.buildWoodenGateVisibleScript=function(a){SetBuildingTypeEnabled(a,"Barricade Gate",!0)};ja.scriptMap.buildGatlingStartupScript=function(a){SetBuildingTypeEnabled(a,"Turret",!1)};ja.scriptMap.buildGatlingVisibleScript=function(a){SetBuildingTypeEnabled(a,"Turret",!0)};ja.scriptMap.buildMarketplaceStartupScript=function(a){SetBuildingTypeEnabled(a,"Marketplace",!1)};ja.scriptMap.buildMarketplaceVisibleScript=function(a){SetBuildingTypeEnabled(a,
"Marketplace",!0)};ja.scriptMap.buildStoneWallStartupScript=function(a){SetBuildingTypeEnabled(a,"Wall",!1)};ja.scriptMap.buildStoneWallVisibleScript=function(a){SetBuildingTypeEnabled(a,"Wall",!0)};ja.scriptMap.buildStoneGateStartupScript=function(a){SetBuildingTypeEnabled(a,"Gate",!1)};ja.scriptMap.buildStoneGateVisibleScript=function(a){SetBuildingTypeEnabled(a,"Gate",!0)};ja.scriptMap.buildStoneTowerStartupScript=function(a){SetBuildingTypeEnabled(a,"Tower",!1)};ja.scriptMap.buildStoneTowerVisibleScript=
function(a){SetBuildingTypeEnabled(a,"Tower",!0)};ja.scriptMap.buildTrapStartupScript=function(a){SetBuildingTypeEnabled(a,"Trap",!1)};ja.scriptMap.buildTrapVisibleScript=function(a){SetBuildingTypeEnabled(a,"Trap",!0)};ja.scriptMap.firstCampaignBigUnlockStartupScript=function(a){SetBuildingTypeEnabled(a,"Lumber Storage",!1);SetBuildingTypeEnabled(a,"Stone Storage",!1);SetBuildingTypeEnabled(a,"Buildling Hut",!1);SetBuildingTypeEnabled(a,"Library",!1);SetGameplayFeatureFlag(a,"buildingUpgradesEnabled",
!1);SetGameplayFeatureFlag(a,"repairingEnabled",!1);SetGameplayFeatureFlag(a,"wildlingHeroFollowingEnabled",!1)};ja.scriptMap.enableBuildingMovement=function(a){SetBuildingTypeEnabled(a,"Lumber Storage",!0);SetBuildingTypeEnabled(a,"Stone Storage",!0);SetBuildingTypeEnabled(a,"Buildling Hut",!0);SetBuildingTypeEnabled(a,"Library",!0);SetGameplayFeatureFlag(a,"buildingUpgradesEnabled",!0);SetGameplayFeatureFlag(a,"repairingEnabled",!0);SetGameplayFeatureFlag(a,"wildlingHeroFollowingEnabled",!0)};var uk=
{CAMPAIGN_COUNTDOWN_NEWSFLASH_TITLE:"Wildlings Incoming!",CAMPAIGN_BATTLE_BEGIN_NEWFLASH:"Wildlings are attacking!",CAMPAIGN_BATTLE_END_NEWFLASH:"Wave survived!",CAMPAIGN_BATTLE_COUNT_NEWSFLASH:"Wave",GAME_HUD_AMBER:"AMBER",GAME_HUD_AMBER_TO:"AMBER TO",GAME_HUD_AND:"AND",GAME_HUD_BUILD:"BUILD",GAME_HUD_BUILT:"BUILT",GAME_HUD_CANCEL_BUILDING:"CANCEL BUILDING",GAME_HUD_CANCEL_UPGRADE:"CANCEL UPGRADE",GAME_HUD_CANT_BUILD:"BUILD ANOTHER BUILDLING HUT \n FOR EXTRA CONSTRUCTIONS",GAME_HUD_CANT_UPGRADE:"BUILD ANOTHER BUILDLING HUT \n FOR EXTRA CONSTRUCTIONS",
GAME_HUD_CAN_NOT:"CANNOT",GAME_HUD_CONVERT:"CONVERT",GAME_HUD_COOL_DOWN:"COOLDOWN",GAME_HUD_DISPENSE:"DISPENSE",GAME_HUD_FINISH_BUILDING:"FINISH BUILDING",GAME_HUD_LUMBER:"LUMBER",GAME_HUD_MAXIMUM:"MAXIMUM \n",GAME_HUD_MOVE:"MOVE",GAME_HUD_PLURAL_S:"S",GAME_HUD_REPAIR:"REPAIR BUILDING",GAME_HUD_REPAIR_ALL_WORKSHOP:"REPAIR ALL BASE\nBUILDINGS AND WALLS",GAME_HUD_REPAIR_ALL_OUTPOST:"REPAIR THIS OUTPOST\n AND ITS DEFENCES",GAME_HUD_REPAIR_NOTHING_TO_DO_WORKSHOP:"NOTHING TO REPAIR\nBUILDINGS AT FULL HEALTH",
GAME_HUD_REPAIR_NOTHING_TO_DO_OUTPOST:"NOTHING TO REPAIR\nDEFENCES AT FULL HEALTH",GAME_HUD_REQUIRED:"REQUIRED",GAME_HUD_SELL_FOR:"SELL FOR",GAME_HUD_SPEED_UP:"SPEED UP",GAME_HUD_STONE:"STONE",GAME_HUD_TO_BUILD_MORE:"TO BUILD MORE",GAME_HUD_TO_LEVEL:"TO LEVEL",GAME_HUD_UNAVAILABLE:"UNAVAILABLE",GAME_HUD_UPGRADE:"UPGRADE",GAME_HUD_UPGRADE_TO:"UPGRADE TO",GAME_HUD_BATCH_UPGRADE:"BATCH UPGRADE ",GAME_HUD_TO:"\nWALLS TO",GUI_BUTTON_BUY_1200_AMBER:"CHEST OF AMBER\n +1200 AMBER",GUI_BUTTON_BUY_2500_AMBER:"CRATES OF AMBER\n +2500 AMBER",
GUI_BUTTON_BUY_250_AMBER:"SHARD OF AMBER\n +250 AMBER",GUI_BUTTON_BUY_250_LUMBER:"CRAFT 2500 LUMBER\n ( COSTS 10 AMBER )",GUI_BUTTON_BUY_250_STONE:"CRAFT 2500 STONE\n ( COSTS 10 AMBER )",GUI_BUTTON_BUY_500_AMBER:"NUGGET OF AMBER\n +500 AMBER",GUI_BUTTON_BUY_6500_AMBER:"AMBER CORNUCOPIA\n +6500 AMBER",GUI_BUTTON_BUY_AMBER:"GET MORE AMBER \n AND SPEED UP",GUI_BUTTON_BUY_HUT:"BUY HUT ( 100 AMBER )",GUI_BUTTON_BUY_HUT_LIMIT:"CAN\u2019T BUILD ANY MORE HUTS",GUI_BUTTON_DISABLE_SHADOWS:"DISABLE SHADOWS",
GUI_BUTTON_ENABLE_SHADOWS:"ENABLE SHADOWS",GUI_BUTTON_DISABLE_SOUNDS:"DISABLE SOUND",GUI_BUTTON_ENABLE_SOUNDS:"ENABLE SOUND",GUI_BUTTON_DISABLE_MUSIC:"DISABLE MUSIC",GUI_BUTTON_ENABLE_MUSIC:"ENABLE MUSIC",GUI_BUTTON_GIVE_FEEDBACK:"GIVE US FEEDBACK",GUI_BUTTON_GO_TO_CREDITS:"CREDITS",GUI_BUTTON_GO_TO_SHOP:"GO TO SHOP",GUI_BUTTON_PLAY:"PLAY",GUI_BUTTON_PREPARE_FOR_WAR_CONTINUE:"LET'S DO IT!",GUI_BUTTON_PREPARE_FOR_WAR_FIGHT:"FIGHT!",GUI_BUTTON_PREPARE_FOR_WAR_POSTPONE_FIGHT:"NOT YET!",GUI_BUTTON_RESUME:"RESUME",
GUI_BUTTON_BUY_AMBER_WELL:"AMBER WELL\n GIVES 100 AMBER / DAY",GUI_LABEL_AMBER:"Amber",GUI_LABEL_HEALTH:"Health",GUI_LABEL_HQ_HEALTH:"HQ Health",GUI_LABEL_INVASION:"Invasion",GUI_LABEL_LEVEL:"LVL",GUI_LABEL_LIVES:"lives",GUI_LABEL_LUMBER:"Lumber",GUI_TITLE_GIVE_POLYCRAFT_FEEDBACK:"Give Feedback at bit.ly/polycraftfeedback",GUI_TITLE_INVASION_SCORE:"Invasion Score",GUI_TITLE_PAUSED:"Paused",GUI_TITLE_PRE_ALPHA_POLYCRAFT:"Polycraft Alpha",GUI_TITLE_SHOP:"SHOP",GUI_TITLE_VERSION:"Version",GUI_TITLE_WAR_SCORE:"War Score",
GUI_TITLE_WAR_SCORE_DEFEAT:"You Have Been Defeated",GUI_TITLE_WAR_SCORE_VICTORY:"Victory!",INFO_PANEL_START_CAMPAIGN_BUTTON:"Start Battle",INFO_PANEL_END_CAMPAIGN_BUTTON:"Back to the Island",INFO_PANEL_CAMPAIGN_END_VICTORY:"Victory!",INFO_PANEL_CAMPAIGN_END_VICTORY_DESCRIPTION:"You defeated",INFO_PANEL_CAMPAIGN_END_DEFEAT:"Crushing Defeat!",INFO_PANEL_CAMPAIGN_END_DEFEAT_DESCRIPTION:"You were defeated by",INFO_PANEL_CAMPAIGN_DUMMY_NAME:"BOISTEROUS MOB",INFO_PANEL_CAMPAIGN_DUMMY_DESC:"One wave of boisterous invaders",
INFO_PANEL_CAMPAIGN_LEVEL:"Campaign Level",INFO_PANEL_UPGRADE_BUTTON:"UPGRADE TO LEVEL",INFO_PANEL_TASK_COMPLETE_BUTTON:"Sweet",INFO_PANEL_TASK_DESCRIPTION_BUTTON:"Got it!",INFO_PANEL_TO_LEVEL:"UPGRADE TO LEVEL",INFO_PANEL_HEALTH:"HEALTH",INFO_PANEL_LUMBER:"LUMBER",INFO_PANEL_LUMBER_STORAGE:"Lumber Storage",INFO_PANEL_LUMBER_COLLECTION_RATE:"Lumber Collection Rate",INFO_PANEL_STONE:"STONE",INFO_PANEL_STONE_STORAGE:"Stone Storage",INFO_PANEL_STONE_COLLECTION_RATE:"Stone Collection Rate",INFO_PANEL_HOURS:"HOURS",
INFO_PANEL_MINUTES:"MINUTES",INFO_PANEL_SECONDS:"SECONDS",INFO_PANEL_TO_BUILD:"to build",INFO_PANEL_BATTLE:"attack wave",INFO_PANEL_BATTLES:"attack waves",INFO_PANEL_MAX_REWARD_TITLE:"Max Reward",INFO_PANEL_REWARD_TITLE:"Reward",INFO_PANEL_NEW_BUILD_OPTIONS:"New build options: ",ENEMY_DISPLAY_NAME_BANNERLING:"Bannerling",ENEMY_DISPLAY_NAME_BASIC_MELEE:"Thumplings",ENEMY_DISPLAY_NAME_BERSERKER:"Breachlings",ENEMY_DISPLAY_NAME_BOMB_THROWER:"Boomlings",ENEMY_DISPLAY_NAME_CHARGER_BOSS:"Chiefling",ENEMY_DISPLAY_NAME_CHARGER:"Chargelings",
ENEMY_DISPLAY_NAME_MINI_CHARGER:"Shuntlings",ENEMY_DISPLAY_NAME_COMMANDO:"Sneaklings",ENEMY_DISPLAY_NAME_DEATH:"Reaperlings",ENEMY_DISPLAY_NAME_RANGED:"Dartlings",ENEMY_DISPLAY_NAME_THIEF:"Thieflings",ENEMY_DISPLAY_NAME_TREASURE_DROPPER:"Amberlings",INFO_PANEL_HOUR:"HOUR",INFO_PANEL_MINUTE:"MINUTE",INFO_PANEL_SECOND:"SECOND",INFO_PANEL_HQ_BUILDING_DESCRIPTION:"Unlocks upgrades and options on other structures",INFO_PANEL_HQ_UPGRADE_TITLE:"UPGRADE HQ",INFO_PANEL_LIBRARY_BUILDING_DESCRIPTION:"Research improvements to Traps, Towers and Barricades",
INFO_PANEL_LIBRARY_UPGRADE_TITLE:"UPGRADE LIBRARY",INFO_PANEL_LUMBERMILL_BUILDING_DESCRIPTION:"Builds Lumberling Huts, drop off Lumber here",INFO_PANEL_LUMBERMILL_UPGRADE_TITLE:"UPGRADE LUMBERMILL",INFO_PANEL_WILDLINGHOUSE_LUMBER_BUILDING_DESCRIPTION:"Gathers Lumber, upgrade to increase effectiveness",INFO_PANEL_WILDLINGHOUSE_LUMBER_UPGRADE_TITLE:"EDUCATE LUMBERLING",INFO_PANEL_LUMBER_STORAGE_BUILDING_DESCRIPTION:"Stores Lumber, loses Lumber when attacked by Wildlings",INFO_PANEL_LUMBER_STORAGE_UPGRADE_TITLE:"UPGRADE LUMBER STORAGE",
INFO_PANEL_STONEMILL_BUILDING_DESCRIPTION:"Builds Stoneling Huts, drop off Stone here",INFO_PANEL_STONEMILL_UPGRADE_TITLE:"UPGRADE STONEMILL",INFO_PANEL_WILDLINGHOUSE_STONE_BUILDING_DESCRIPTION:"Gathers Stone, upgrade to increase effectiveness",INFO_PANEL_WILDLINGHOUSE_STONE_UPGRADE_TITLE:"EDUCATE STONELING",INFO_PANEL_STONE_STORAGE_BUILDING_DESCRIPTION:"Stores Stone, loses Stone when attacked by Wildlings",INFO_PANEL_STONE_STORAGE_UPGRADE_TITLE:"UPGRADE STONE STORAGE",INFO_PANEL_WAR_FACTORY_BUILDING_DESCRIPTION:"Builds Defendling Huts, required to build Outposts",
INFO_PANEL_WAR_FACTORY_UPGRADE_TITLE:"UPGRADE DEFENCE FACTORY",INFO_PANEL_WILDLINGHOUSE_WAR_BUILDING_DESCRIPTION:"Builds defences, educate to increase speed",INFO_PANEL_WILDLINGHOUSE_WAR_UPGRADE_TITLE:"EDUCATE DEFENDLING",INFO_PANEL_OUTPOST_BUILDING_DESCRIPTION:"Builds defences, unlocks options when upgraded",INFO_PANEL_OUTPOST_UPGRADE_TITLE:"UPGRADE OUTPOST",INFO_PANEL_WORKSHOP_BUILDING_DESCRIPTION:"Builds permanent structures, builds Buildling Huts",INFO_PANEL_WORKSHOP_UPGRADE_TITLE:"UPGRADE WORKSHOP",
INFO_PANEL_WALL_BUILDING_DESCRIPTION:"Protects your base, upgrade to increase strength",INFO_PANEL_WALL_UPGRADE_TITLE:"UPGRADE STONE WALL",INFO_PANEL_GATE_BUILDING_DESCRIPTION:"Protects your base, allows entry to friendly units",INFO_PANEL_GATE_UPGRADE_TITLE:"UPGRADE STONE GATE",INFO_PANEL_DEFAULT_BUILDING_DESCRIPTION:"Does something",INFO_PANEL_DEFAULT_UPGRADE_TITLE:"UPGRADE",INFO_PANEL_TOWER_BUILDING_DESCRIPTION:"Last resort base defence, attacks invading Wildlings",INFO_PANEL_TOWER_UPGRADE_TITLE:"UPGRADE STONE TOWER",
LANGUAGE:"English",TXT_PLAYER_RESPAWN_IN:"Respawn in",TXT_TUTORIAL_AMBER:"AMBER!",TXT_TUTORIAL_CONSTRUCTION_WANTAMBER:"Construction on your new Defence Factory is going to take a while, but you can speed it up using the rare resource AMBER. Go to your Defence Factory and select \u2018Speed Up\u2019.",TXT_TUTORIAL_CAMPAIGN_INTRO:"Looks like our village is being challenged to a fight by an army of Feral Wildlings! When this happens, Bannerlings will appear in front of the Tunnels around the island.",
TXT_TUTORIAL_CAMPAIGN_START:"Click on their Bannerling to start a fight now! This fight\u2019s going to be easy! If we win, we'll be rewarded with lots of resources and XP.",TXT_TUTORIAL_CAMPAIGN_END:"Great job! You've successfully beaten the Feral Wildlings and survived your first fight! You can start new fights by clicking on the different Bannerlings around the map.",TXT_TUTORIAL_CAMPAIGN_NEXT:"There are three positions on the map where you can start a challenge: north, east and west. Take them all on to collect the most rewards and resources.",
TXT_TUTORIAL_OUTPOST_DESC:"You can defend fights using Outposts like this! Outposts allow you to set up defensive towers, barricades and traps to hold off attackers. We've already set up some defences, so let's go and fight!",TXT_TUTORIAL_FIGHT_PHEW:"Phew! To protect against more of these troublesome Wildlings we should build an Outpost (from the Workshop) outside of our base and create a barricade of defences. The click \u2018FIGHT\u2019 to start some trouble!",TXT_TUTORIAL_FIGHT_TROUBLE:"Looks like our new village has attracted some unwanted attention from a Feral Wildling. Take it down with your mighty blunderbus so it doesn\u2019t ruin our hard work.",
TXT_TUTORIAL_FIGHT_UPTOYOU:"It's up to you now, %1. Expand and protect your base with walls and towers, grow your village with huts, gather more resources, explore the island and most importantly, defend against the Feral Wildlings!",TXT_TUTORIAL_FIGHT_WILDING_APPROACHING:"Feral Wildling Approaching!",TXT_TUTORIAL_GOT_IT:"GOT IT!",TXT_TUTORIAL_HQ_LEVEL_FIVE_1:"Your HQ is now Level 5! You now have more build options and your HQ has more health.",TXT_TUTORIAL_HQ_LEVEL_FOUR_1:"Your HQ is now Level 4! You now have more build options and your HQ has more health.",
TXT_TUTORIAL_HQ_LEVEL_THREE_1:"Your HQ is now Level 3! You now have more build options and your HQ has more health.",TXT_TUTORIAL_HQ_LEVEL_TWO_1:"Your HQ is now Level 2! You now have more build options and your HQ has more health.",TXT_TUTORIAL_INTRO_HQ_BUILD:"You're about to enter build mode! In build mode, if the building foundations are GREY you'll move to that location. When foundations are GREEN you'll build. Try placing your HQ now.",TXT_TUTORIAL_INTRO_HQ_NEXT:"Great job, %1! I couldn't have chosen a better place myself. When you want to interact with a building on our island, get close and click on it.",
TXT_TUTORIAL_INVASION_1:"Hear those drums? You provoked the Ferals and they're coming to invade you! Get ready to defend your base from a wave of enemies.",TXT_TUTORIAL_INVASION_2:"Phew, %1! That was close, but you survived the invasion! Provoke the Ferals again to face another invasion. They'll become stronger as you upgrade your base, so be prepared.",TXT_TUTORIAL_LETSBUILD:"LET\u2019S BUILD",TXT_TUTORIAL_LETSCOLLECT:"LET\u2019S CHOP",TXT_TUTORIAL_LETSFIGHT:"LET\u2019S FIGHT",TXT_TUTORIAL_LETSGO:"LET\u2019S GO!",
TXT_TUTORIAL_NEW_LUMBERMILL_1:"You can drop off the Lumber you gather at the Lumbermill as well as the HQ. Your Lumberlings will automatically gather Lumber resource over time. The more of them you have, the faster it will generate.",TXT_TUTORIAL_NEW_LUMBERMILL_2:"Even when you're away from your game, your Lumberlings will continue to generate resource. If your storage becomes full at any point, any extra Lumber generated will go to waste.",TXT_TUTORIAL_NEW_LUMBER_STORAGE_1:"You built Lumber Storage! Lumber Storage increases the maximum amount of Lumber you can store, allowing you to build defensive structures and research new defences. Be careful though, if it gets attacked you'll lose Lumber!",
TXT_TUTORIAL_NEW_STONE_STORAGE_1:"You built Stone Storage! Stone Storage increases the maximum amount of Stone you can store, allowing you to build more expensive buildings and upgrades. Be careful though, if it gets attacked you'll lose Stone!",TXT_TUTORIAL_NEW_TOWER_1:"You built a Tower! Towers will automatically defend you and your base and can be upgraded to inflict more damage.",TXT_TUTORIAL_NEXT:"NEXT",TXT_TUTORIAL_OKAY:"OKAY!",TXT_TUTORIAL_RESOURCE_CHOP:"While that\u2019s building, let\u2019s chop some trees! Bash them repeatedly until they're reduced to a measly stump, pick up the pieces and drop them back off at your HQ.",
TXT_TUTORIAL_RESOURCE_CONFIRM:"Excellent chopping action, %1! Now we need to be able to protect ourselves, let\u2019s build a Defence Factory! Click the crossed swords icon on your Workshop",TXT_TUTORIAL_RESOURCE_FULL_1:"Your Lumber storage is full! Any Lumber you collect from this point will go to waste. You can build more Lumber Storage structures or upgrade existing ones to increase your maximum capacity.",TXT_TUTORIAL_SKIRMISH_1:"Uh oh, you provoked that cave of short-tempered Ferals and now they want to skirmish! They'll keep attacking your base until you destroy their cave. Provoke more caves before you destroy this one and you'll be in serious trouble. Go get 'em!",
TXT_TUTORIAL_SKIRMISH_2:"Nice work, %1! You survived the skirmish! By provoking the Ferals you've also increased the Invasion meter. Push it too far and be prepare to be invaded!",TXT_TUTORIAL_UHOH:"UH OH...",TXT_TUTORIAL_UPGRADE_1:"You've gathered enough Stone to upgrade your Headquarters. To move up to the next level and unlock more building options, click on your Headquarters and select 'Upgrade'.",TXT_TUTORIAL_UPGRADE_2:"All of your buildings can be upgraded! Towers do more damage, Storage holds more resource, Workshops have more build options. Hurrah!",
TXT_TUTORIAL_WELCOME_FIRST:"Wake up, %1!\n Snap out of that daze! What are you doing sleeping on the beach, have you forgotten how to move?",TXT_TUTORIAL_WELCOME_BTN_URGH:"Huh?",TXT_TUTORIAL_WELCOME_CONTROL:"You can move around by clicking anywhere, or you can click and hold to keep running. And don't forget to click on enemies to target them with your Shotgun!",TXT_TUTORIAL_WELCOME_BTN_RIGHT:"Right!",TXT_TUTORIAL_WELCOME_NOW:"Now might be a good time to test that shotgun out...\n We're under attack!",
TXT_TUTORIAL_WELCOME_BTN_ATTACK:"Attack?",TXT_TUTORIAL_WELCOME_THANKS:"Phew, that was close, thanks for saving us from those Feral Wildlings! I found you washed up on the beach. \nLooks like you\u2019re stranded here.",TXT_TUTORIAL_WELCOME_BTN_UHOH:"Uh oh...",TXT_TUTORIAL_WELCOME_WEWILLHELP:" Don't worry though, you can live with us! You can go full-screen with [F], rotate with the arrow keys and pause with [P]. You don't remember anything, do you?",TXT_TUTORIAL_WELCOME_NEXT:"If you want to survive on this island, you\u2019ll need to build a new home and defend it from the Feral Wildlings. Let\u2019s start by building you somewhere to live.",
TXT_TUTORIAL_WILDLING_ABILITY:"While you do that, we\u2019ll keep busy chopping Lumber, mining Stone and constructing your buildings or upgrades.",TXT_TUTORIAL_WILDLING_BUY_HUTS:" With a Workshop you can build lots of things, including Buildling Huts. The Lumbermill allows Lumberling Huts and the Stonemill allows Stoneling Huts. More Huts means more Wildling friends!",TXT_TUTORIAL_WILDLING_SLEEP:"There\u2019s one thing you should know about us Wildlings: we like to sleep. When you\u2019re away from the village we\u2019ll collect resources for a while and then fall asleep.",
TXT_TUTORIAL_WILDLING_WAKEUP:"You\u2019ll need to come back and wake us up if you want to keep production flowing while you\u2019re away. Upgrade our Huts to make us work longer hours.",TXT_TUTORIAL_NEW_OUTPOST:"You built your first Outpost! Outposts allow you to set up defensive towers, barricades and traps outside of your village to hold off attackers. Outposts work well between hills and near Wildling Tunnels, but try experimenting with different locations.",TASK_DUMMY:"Test task description",
TASK_DUMMY_COMPLETE:"You did X, Y, and Z. Well done you! Splendid.",TASK_DUMMY_DESCRIPTION:"You must do X, Y, and Z to complete this task. Go go go!",TASK_COMPLETE:"Quest Complete!",TASK_ACCEPT_REWARD_BUTTON:"Collect Reward",TASK_DESCRIPTION_CLOSE_BUTTON:"Got it!",TASK_AMBER:"amb",TASK_XP:"xp",TASK_NEWSFLASH_TITLE:"New quest",TASK_BUILD_BARRICADE:"Build a barricade",TASK_BUILD_GATLING:"Build a Gatling Tower",TASK_BUILD_LUMBER_STORAGE:"Build a Lumber Storage",TASK_BUILD_OUTPOST:"Build an Outpost",
TASK_BUILD_STONE_STORAGE:"Build a Stone Storage",TASK_BUILD_WALL:"Build a wall",TASK_USE_SHOTGUN:"Defeat the attackers",TASK_GO_FULLSCREEN:"Go full-screen with [F]",TASK_PLACE_HQ:"Place your HQ",TASK_COLLECT_LUMBER:"Chop a tree and drop off the Lumber",TASK_PLACE_DEFENCE_FACTORY:"Build a Defence Factory (crossed swords icon)",TASK_USE_AMBER:"Speed up Defence Factory construction using Amber",TASK_START_CAMPAIGN:"Click the Bannerling near the Tunnels to start a fight",TASK_DEFEAT_INVADERS:"Defeat the invading Wildlings",
TASK_WAKEUP_SUMMARY:"Open your Quest Log!",TASK_WAKEUP_TITLE:"Time to wake up!",TASK_WAKEUP_EXPLAIN:"Click your hero to wake up! These Quests in the corner can help if you get stuck. Click on them to open the Quest Log for a hint.",TASK_WAKEUP_COMPLETE:"You\u2019re stranded on a mysterious island. Looks like your ship isn\u2019t going anywhere soon. Find your weapon and explore...",TASK_PICKUPWEAPON_SUMMARY:"Find a weapon",TASK_PICKUPWEAPON_EXPLAIN:"Looks like you\u2019ve crashed, what bad luck. Better find something to arm yourself with pronto...",
TASK_PICKUPWEAPON_COMPLETE:"What a fine Blunderbuss! Click on bad things to make them go away. Start with the crates on that bridge...",TASK_SHOOTCRATE_SUMMARY:"Clear the bridge",TASK_SHOOTCRATE_EXPLAIN:"Click on bad things to make them go away using your Blunderbuss. Start with the crates on that bridge...",TASK_SHOOTCRATE_COMPLETE:"That\u2019s the bridge clear, but there looks like more trouble ahead. Get ready for some more target practice...",TASK_DEFEATWILDLINGS_SUMMARY:"Defeat the Wildlings",
TASK_DEFEATWILDLINGS_EXPLAIN:"Those nasty creatures are attacking that village, better help out...",TASK_DEFEATWILDLINGS_COMPLETE:"That\u2019s them dealt with. Better find somewhere to keep safe if you\u2019re going to survive on this island...",TASK_GOTOVILLAGE_SUMMARY:"Find somewhere to live",TASK_GOTOVILLAGE_EXPLAIN:"Find somewhere to live. This village looks friendly enough...",TASK_GOTOVILLAGE_COMPLETE:"You\u2019ve been adopted by a small village of friendly Wildlings! You can live here and grow the village if you promise to protect them.",
TASK_BUILDHQ_SUMMARY:"Build a Headquarters",TASK_BUILDHQ_EXPLAIN:"Build a Headquarters by clicking this icon and placing the building on the ground anywhere that is not marked red.",TASK_BUILDHQ_COMPLETE:"Great spot! Your new Wildling friend, a Buildling, is going to build the new Headquarters for you. Next thing we need is Lumber...",TASK_CHOPATREE_SUMMARY:"Chop down a Tree",TASK_CHOPATREE_EXPLAIN:"We need some Lumber so we can build a Lumbermill. Chop down a whole tree, click it until it\u2019s gone!",
TASK_CHOPATREE_COMPLETE:"Great chopping action! Now deposit the pieces back at your HQ and build a Lumbermill.",TASK_MINEASTONE_SUMMARY:"Mine a Stone",TASK_MINEASTONE_EXPLAIN:"We need some Stone so we can build a Stonemill. Mine down a whole Stone, click it until it\u2019s gone!",TASK_MINEASTONE_COMPLETE:"Perfect pickaxing! Now deposit the pieces back at your HQ and build a Stonemill.",TASK_MINESTONEANDLUMBER_SUMMARY:"Chop a Tree and Mine a Stone",TASK_MINESTONEANDLUMBER_EXPLAIN:"You can gather and carry Lumber and Stone at the same time! Chop down a tree and mine a whole Stone then take resources back to the village.",
TASK_MINESTONEANDLUMBER_COMPLETE:"Now that\u2019s multi-tasking! Your carry capacity for Stone and Lumber is independent, maximise efficiency by gathering them together.",TASK_BUILDLUMBERMILL_SUMMARY:"Build a Lumbermill",TASK_BUILDLUMBERMILL_EXPLAIN:"Build a Lumbermill by clicking this icon and placing the building on the ground anywhere that is not marked red.",TASK_BUILDLUMBERMILL_COMPLETE:"You can drop off chopped Lumber here. The Lumbermill also allows you to build Storage and recruit Lumberlings that collect Lumber.",
TASK_BUILDSTONEMILL_SUMMARY:"Build a Stonemill",TASK_BUILDSTONEMILL_EXPLAIN:"Build a Stonemill by clicking this icon and placing the building on the ground anywhere that is not marked red.",TASK_BUILDSTONEMILL_COMPLETE:"You can drop off mined Stone here. The Stonemill also allows you to build Storage and recruit Stonelings that collect Stone.",TASK_BUILDSTONELINGHUT_SUMMARY:"Build a Stoneling Hut",TASK_BUILDSTONELINGHUT_EXPLAIN:"Build a Stoneling Hut by clicking this icon and placing the building on the ground anywhere that is not marked red.",
TASK_BUILDSTONELINGHUT_COMPLETE:"You\u2019ve recruited a Stoneling! Stonelings will automatically gather Stone and bring it back to your base.",TASK_BUILDLUMBERLINGHUT_SUMMARY:"Build a Lumberling Hut",TASK_BUILDLUMBERLINGHUT_EXPLAIN:"Build a Lumberling Hut by clicking this icon and placing the building on the ground anywhere that is not marked red.",TASK_BUILDLUMBERLINGHUT_COMPLETE:"You\u2019ve recruited a Lumberling! Lumberlings will automatically gather Lumber and bring it back to your base.",TASK_BUILDDEFENCEFACTORY_SUMMARY:"Build a Defence Factory",
TASK_BUILDDEFENCEFACTORY_EXPLAIN:"Build a Defence Factory by clicking this icon and placing the building on the ground anywhere that is not marked red.",TASK_BUILDDEFENCEFACTORY_COMPLETE:"You can build Outposts from the Defence Factory. It also allows you to recruit Defendlings that build defences.",TASK_BUILDDEFENDLINGHUT_SUMMARY:"Build a Defendling Hut",TASK_BUILDDEFENDLINGHUT_EXPLAIN:"Build a Defendling Hut by clicking this icon and placing the building on the ground anywhere that is not marked red.",
TASK_BUILDDEFENDLINGHUT_COMPLETE:"You\u2019ve recruited a Defendling! Defendlings will build defences placed from Outposts.",TASK_BUILDAMBERCHEST_SUMMARY:"Build an Amber Chest",TASK_BUILDAMBERCHEST_EXPLAIN:"Build an Amber Chest by clicking this icon and placing the building on the ground anywhere that is not marked red.",TASK_BUILDAMBERCHEST_COMPLETE:"The Amber Chest gives you an Amber bonus every 23 hours! Return 2 days in a row for a 100% bonus, and 3 days for a 200% bonus!",TASK_SPEEDUP_SUMMARY:"Speed up HQ with Amber",
TASK_SPEEDUP_EXPLAIN:"You can finish building now using the rare resource AMBER! Click on the HQ and select \u2019Speed Up\u2019",TASK_SPEEDUP_COMPLETE:"The HQ is the backbone of your base. Upgrading it allows you to build new things. Now let\u2019s build an Outpost to defend from!",TASK_BUILDOUTPOST_SUMMARY:"Build an Outpost",TASK_BUILDOUTPOST_EXPLAIN:"Click here to build an Outpost. Place it near the Tunnels to the north, that\u2019s where Feral Wildlings approach from.",TASK_BUILDOUTPOST_COMPLETE:"That\u2019s going to take a while. Let\u2019s speed it up using Amber so we can build some defences.",
TASK_MOVEBUILDING_SUMMARY:"Move Your Outpost",TASK_MOVEBUILDING_EXPLAIN:"You can move buildings by clicking on them and selecting \u2019Move\u2019. Try this out by moving your Outpost.",TASK_MOVEBUILDING_COMPLETE:"All of your buildings can be moved. Be careful though, moving an Outpost away from its defences will cause them to stop working.",TASK_GOTOCAVES_SUMMARY:"Find the Tunnels",TASK_GOTOCAVES_EXPLAIN:"There are some mysterious Wildling Tunnels on the island, find them to discover their purpose...",
TASK_GOTOCAVES_COMPLETE:"You can challenge the Wildlings to a fight from these Tunnels to win resources. Let\u2019s build an Outpost here and start a fight!",TASK_GOTOTOTEMAGILITY_SUMMARY:"Go to the Totem of Agility",TASK_GOTOTOTEMAGILITY_EXPLAIN:"Go to the Totem of Agility and discover the abilities it can grant you...",TASK_GOTOTOTEMAGILITY_COMPLETE:"The Totem of Agility can grant the Hero Speed and Carry Speed Upgrades.",TASK_GOTOTOTEMPOWER_SUMMARY:"Go to the Totem of Power",TASK_GOTOTOTEMPOWER_EXPLAIN:"Go to the Totem of Power and discover the abilities it can grant you...",
TASK_GOTOTOTEMPOWER_COMPLETE:"The Totem of Power can grant the Hero Damage and Reload Speed Upgrades.",TASK_GOTOTOTEMPROTECTION_SUMMARY:"Go to the Totem of Protection",TASK_GOTOTOTEMPROTECTION_EXPLAIN:"Go to the Totem of Protection and discover the abilities it can grant you...",TASK_GOTOTOTEMPROTECTION_COMPLETE:"The Totem of Protection can grant the Hero Health and Damage Resistance Upgrades.",TASK_GOTOTOTEMTECHNOLOGY_SUMMARY:"Go to the Totem of Technology",TASK_GOTOTOTEMTECHNOLOGY_EXPLAIN:"Go to the Totem of Technology and discover the abilities it can grant you...",
TASK_GOTOTOTEMTECHNOLOGY_COMPLETE:"The Totem of Technology can grant the Hero Chop Damage and Carry Capacity Upgrades.",TASK_SPEEDUP_OUTPOST_SUMMARY:"Speed up Outpost with Amber",TASK_SPEEDUP_OUTPOST_EXPLAIN:"You can finish building now using the rare resource AMBER! Click on the Outpost and select \u2019Speed Up\u2019",TASK_SPEEDUP_OUTPOST_COMPLETE:"That\u2019s the Outpost built, but it\u2019s going to be defenceless without some Barricades or some Towers. You can build them here, how handy...",
TASK_BUILDBARRICADE_SUMMARY:"Build a row of Barricades",TASK_BUILDBARRICADE_EXPLAIN:"Click here and select Barricades. Build them in a row to keep the Feral Wildlings at bay.",TASK_BUILDBARRICADE_COMPLETE:"Great! That should hold off the Feral Wildlings for a bit, but you won\u2019t be able to get through your Barricades without a Wooden Gate.",TASK_BUILDGATE_SUMMARY:"Build a Wooden Gate",TASK_BUILDGATE_EXPLAIN:"Click here and select Wooden Gate. Gates keep Feral Wildlings at bay, but open for you and your Wildling friends.",
TASK_BUILDGATE_COMPLETE:"Great! That should hold off the Feral Wildlings and make it a bit easier for you to get around. Now let\u2019s build some Gatling Towers.",TASK_BUILDGATLING_SUMMARY:"Build some Gatling Towers",TASK_BUILDGATLING_EXPLAIN:"Build some Gatling Towers by clicking here to defend your new Outpost. You\u2019re not going to be able to take the Feral Wildlings alone.",TASK_BUILDGATLING_COMPLETE:"That\u2019s going to take a while. Let\u2019s speed it up using Amber like we did with the Outpost so we\u2019re not defenceless!",
TASK_SPEEDUP_GATLING_SUMMARY:"Speed up Gatling with Amber",TASK_SPEEDUP_GATLING_EXPLAIN:"You can finish the Gatling using Amber again. Click on the Gatling and select \u2019Speed Up\u2019",TASK_SPEEDUP_GATLING_COMPLETE:"That should help! Build a few more defences, or jump right in and challenge the Feral Wildlings by speaking to the Bannerling.",TASK_STARTCAMPAIGN_SUMMARY:"Challenge the Ferals!",TASK_STARTCAMPAIGN_EXPLAIN:"Challenge the Feral Wildlings by speaking to this Bannerling. We\u2019re ready for a fight!",
TASK_STARTCAMPAIGN_COMPLETE:"Here they come! Defend your Outpost and collect the resources. Resources can be dropped off at an Outpost during a battle.",TASK_WINCAMPAIGN_SUMMARY:"Defend your Outpost",TASK_WINCAMPAIGN_EXPLAIN:"The Feral Wildlings accepted your challenge and are attacking from the Tunnels. Defend your Outpost!",TASK_WINCAMPAIGN_COMPLETE:"The battle is over! Battles are a great source of income, improve your Outpost and fight the different Wildling Tribes to get rich!",TASK_BUILDLUMBERSTORAGE_SUMMARY:"Build a Lumber Storage",
TASK_BUILDLUMBERSTORAGE_EXPLAIN:"If you want to build more stuff, you\u2019ll need to be able to store more Lumber. Click here to build your first Lumber Storage.",TASK_BUILDLUMBERSTORAGE_COMPLETE:"Now you have a Lumber Storage you\u2019ll be able to gather more Lumber and build new structures.",TASK_BUILDSTONESTORAGE_SUMMARY:"Build a Stone Storage",TASK_BUILDSTONESTORAGE_EXPLAIN:"If you want to build more stuff, you\u2019ll need to be able to store more Stone. Click here to build your first Stone Storage.",
TASK_BUILDSTONESTORAGE_COMPLETE:"Now you have a Stone Storage you\u2019ll be able to gather more Stone and build new structures.",TASK_BUILDWALLS_SUMMARY:"Build some Stone Walls",TASK_BUILDWALLS_EXPLAIN:"If your Outpost fails during a fight, you\u2019ll need some defences to keep the Wildlings away from your HQ. Build some Stone Walls",TASK_BUILDWALLS_COMPLETE:"Stone Walls can be trashed by attackers. After a fight you can repair Walls individually, or use \u2019Repair All\u2019 at the Workshop.",
TASK_BUILDSTONEGATE_SUMMARY:"Build a Stone Gate",TASK_BUILDSTONEGATE_EXPLAIN:"Stone Gates can be placed alongside Stone Walls to keep out attackers, but let you and your friendly Wildlings in or out.",TASK_BUILDSTONEGATE_COMPLETE:"Stone Gates can be trashed by attackers. After a fight you can repair Walls individually, or use \u2019Repair All\u2019 at the Workshop.",TASK_BUILDSTONEMILLLEVEL2_SUMMARY:"Upgrade the Stonemill",TASK_BUILDSTONEMILLLEVEL2_EXPLAIN:"Upgrade the Stonemill to Level 2. This will allow you to build more Stoneling Huts.",
TASK_BUILDSTONEMILLLEVEL2_COMPLETE:"Upgrading! When the Stonemill has finished upgrading you will be able to build more Stoneling Huts.",TASK_BUILDSECONDSTONELINGHUT_SUMMARY:"Recruit another Stoneling",TASK_BUILDSECONDSTONELINGHUT_EXPLAIN:"You have a Stoneling, but you need even more Stone. Build another Stoneling Hut to increase your Stone generation rate.",TASK_BUILDSECONDSTONELINGHUT_COMPLETE:"You can recruit up to 6 Stonelings by building more Huts and you can increase their effectiveness by upgrading the Huts.",
TASK_BUILDLUMBERMILLLEVEL2_SUMMARY:"Upgrade the Lumbermill",TASK_BUILDLUMBERMILLLEVEL2_EXPLAIN:"Upgrade the Lumbermill to Level 2. This will allow you to build more Lumberling Huts.",TASK_BUILDLUMBERMILLLEVEL2_COMPLETE:"Upgrading! When the Lumbermill has finished upgrading you will be able to build more Lumberling Huts.",TASK_BUILDSECONDLUMBERLINGHUT_SUMMARY:"Recruit another Lumberling",TASK_BUILDSECONDLUMBERLINGHUT_EXPLAIN:"You have a Lumberling, but you need even more Lumber. Build another Lumberling Hut to increase your Lumber generation rate.",
TASK_BUILDSECONDLUMBERLINGHUT_COMPLETE:"You can recruit up to 6 Lumberlings by building more Huts and you can increase their effectiveness by upgrading the Huts.",TASK_BUILDSECONDDEFENDLINGHUT_SUMMARY:"Recruit another Defendling",TASK_BUILDSECONDDEFENDLINGHUT_EXPLAIN:"You have a Defendling, but with another you could build defences from the Outpost even faster. Build another Defendling Hut.",TASK_BUILDSECONDDEFENDLINGHUT_COMPLETE:"You can recruit up to 4 Defendlings by building more Huts and you can increase their effectiveness by upgrading the Huts.",
TASK_BUILDTRAP_SUMMARY:"Build a Decoy Trap",TASK_BUILDTRAP_EXPLAIN:"You can make your Outposts even more effective by building Traps! Build a Decoy at the Outpost to distract attacking Wildlings.",TASK_BUILDTRAP_COMPLETE:"The Decoy Trap will distract attacking Wildlings until it has run out of health. Upgrade the Outpost to unlock more types of Traps.",TASK_STARTCAMPAIGN2_SUMMARY:"Challenge the Ferals Again!",TASK_STARTCAMPAIGN2_EXPLAIN:"Challenge the Feral Wildlings to another fight by speaking to this Bannerling. We\u2019ve Stone Defences and a Trap this time!",
TASK_STARTCAMPAIGN2_COMPLETE:"Another one bites the dust! Don\u2019t forget resources can only be dropped off at an Outpost during battles, after that drop them in your Mills.",TASK_CHARGEATTACK_SUMMARY:"Charge attack 3 Ferals!",TASK_CHARGEATTACK_EXPLAIN:"Try running into 3 Ferals during a battle to stun them with a Charge Attack! You can even do this while shooting!",TASK_CHARGEATTACK_COMPLETE:"Great work charging into those Ferals. Remember to charge and use your shotgun simultaneously to be extra-effective during a battle!",
TASK_BUILDTOWER_SUMMARY:"Fortify with a Stone Tower",TASK_BUILDTOWER_EXPLAIN:"If Wildlings break through the Outpost you\u2019ll need something to take them down with. Fortify your base with a Stone Tower.",TASK_BUILDTOWER_COMPLETE:"You can build up to 10 Stone Towers in total by upgrading the HQ. Stone Towers can also be upgraded to inflict more damage.",TASK_BUILDHQLEVEL2_SUMMARY:"Upgrade your HQ",TASK_BUILDHQLEVEL2_EXPLAIN:"The HQ is the hub of your base. Upgrade your HQ to unlock new build options and give your Hero a stat boost.",
TASK_BUILDHQLEVEL2_COMPLETE:"HQ upgrading! You can upgrade other buildings in your village to unlock build options, increase stats, defence, damage, storage and more.",TASK_BUILDSTONESTORAGELEVEL2_SUMMARY:"Upgrade the Stone Storage",TASK_BUILDSTONESTORAGELEVEL2_EXPLAIN:"Upgrade the Stone Storage to Level 2. This will increase your Stone Storage capacity.",TASK_BUILDSTONESTORAGELEVEL2_COMPLETE:"Upgrading! When the Stone Storage has finished upgrading you will have increased Stone Storage capacity.",
TASK_BUILDLUMBERSTORAGELEVEL2_SUMMARY:"Upgrade the Lumber Storage",TASK_BUILDLUMBERSTORAGELEVEL2_EXPLAIN:"Upgrade the Lumber Storage to Level 2. This will increase your Lumber Storage capacity.",TASK_BUILDLUMBERSTORAGELEVEL2_COMPLETE:"Upgrading! When the Lumber Storage has finished upgrading you will have increased Lumber Storage capacity.",TASK_BUILDMARKETPLACE_SUMMARY:"Build a Marketplace",TASK_BUILDMARKETPLACE_EXPLAIN:"Click here to build a Decoration Marketplace so you can build lights, crystals, statues, tiles and plant trees or stones!",
TASK_BUILDMARKETPLACE_COMPLETE:"When that\u2019s finished we\u2019ll be able to make our village look even better!",TASK_BUILDDECORATION_SUMMARY:"Build a Light Decoration",TASK_BUILDDECORATION_EXPLAIN:"Click here to build a Light Decoration. You can place it anywhere on the map, wherever you think looks nice!",TASK_BUILDDECORATION_COMPLETE:"There\u2019s lots of different kinds of decorations for you to customise your village with, including the super rare Sageling Statue!",TASK_BUILDFLAG_SUMMARY:"Place a flag",
TASK_BUILDFLAG_EXPLAIN:"Place a flag from the Decoration Marketplace. You can place it anywhere on the map, wherever you think looks nice!",TASK_BUILDFLAG_COMPLETE:"Who said this island isn\u2019t patriotic? Select your flag to change its colour, or keep it how it is.",TASK_BUILDFOUNTAIN_SUMMARY:"Build a Fountain",TASK_BUILDFOUNTAIN_EXPLAIN:"Build a Fountain from the Decoration Marketplace. You can place it anywhere on the map, wherever you think looks nice!",TASK_BUILDFOUNTAIN_COMPLETE:"How dignified. Suddenly this island just got a lot classier...",
TASK_BUILDLIGHT_SUMMARY:"Place a Light",TASK_BUILDLIGHT_EXPLAIN:"Place a Light from the Decoration Marketplace. You can place it anywhere on the map, wherever you think looks nice!",TASK_BUILDLIGHT_COMPLETE:"Select your light to change its colour, or keep it how it is.",TASK_BUILDFLOWERBED_SUMMARY:"Build a Flower Bed",TASK_BUILDFLOWERBED_EXPLAIN:"Build a Flower Bed from the Decoration Marketplace. You can place it anywhere on the map, wherever you think looks nice!",TASK_BUILDFLOWERBED_COMPLETE:"Green fingers! Suddenly this island just got a lot classier...",
TASK_BUILDSTATUE_SUMMARY:"Appease the Wildling Gods!",TASK_BUILDSTATUE_EXPLAIN:"The Wildling Gods desire a Statue! Build the Sageling Statue from the Decoration Marketplace to receive a huge XP bonus!",TASK_BUILDSTATUE_COMPLETE:"The Wildling Gods are appeased, that certainly is... vain. Well, they have their statue, and you have your XP. Hooray!",TASK_REPAIRBROKENBUILDING_SUMMARY:"Repair a broken building",TASK_REPAIRBROKENBUILDING_EXPLAIN:"Some of your buildings were damaged. Fix them individually or use \u2019Repair All\u2019 at the Workshop or Outpost",
TASK_REPAIRBROKENBUILDING_COMPLETE:"All fixed! Don\u2019t forget you can save time by using \u2019Repair All\u2019 at the Workshop or Outpost.",TASK_BUILDLIBRARY_SUMMARY:"Build a Library",TASK_BUILDLIBRARY_EXPLAIN:"You can increase the effectiveness of your defences by researching new technologies. Build a Library and get researching!",TASK_BUILDLIBRARY_COMPLETE:"In the Library you can research new technologies using Lumber. Now might be a good time to start gathering Lumber.",TASK_BUILDSECONDOUTPOST_SUMMARY:"Build another Outpost",
TASK_BUILDSECONDOUTPOST_EXPLAIN:"Double your defence capability with a second Outpost. Click here to build a second Outpost",TASK_BUILDSECONDOUTPOST_COMPLETE:"Each Outpost has its own build area. Concentrate your defences in one place, or spread out to cover more area.",TASK_LEVELUPHEROATSHRINE_SUMMARY:"Power up Hero at a Totem",TASK_LEVELUPHEROATSHRINE_EXPLAIN:"In each corner of the map is a Totem that can be used to upgrade a different hero ability. Go to a Totem after levelling up.",TASK_LEVELUPHEROATSHRINE_COMPLETE:"Hero ability unlocked! Every time you level up you can unlock a new ability at a Totem, or you can boost early using Amber.",
TASK_BUYAMBERINSHOP_SUMMARY:"Get free Amber from Shop",TASK_BUYAMBERINSHOP_EXPLAIN:"You can buy more Amber from the Shop. Open the shop and select the free Amber purchase.",TASK_BUYAMBERINSHOP_COMPLETE:"Easy! Amber can be used to speed up buildings, upgrades, research, buy decorations or boost your Hero ability at a Totem.",TASK_BUILDDEFENCEFACTORYLEVEL2_SUMMARY:"Upgrade the Defence Factory",TASK_BUILDDEFENCEFACTORYLEVEL2_EXPLAIN:"Upgrade the Defence Factory to Level 2. This will give you new upgrade options.",
TASK_BUILDDEFENCEFACTORYLEVEL2_COMPLETE:"Upgrading! When the Defence Factory has finished upgrading you will have new upgrade options.",TASK_BUILDDEFENDLINGHUTLEVEL2_SUMMARY:"Upgrade Defendling Hut",TASK_BUILDDEFENDLINGHUTLEVEL2_EXPLAIN:"Upgrade a Defendling Hut to Level 2. This allows Defendlings to build defences faster.",TASK_BUILDDEFENDLINGHUTLEVEL2_COMPLETE:"Upgrading! When the Hut has finished upgrading your Defendling will build defences faster.",TASK_BUILDOUTPOSTLEVEL2_SUMMARY:"Upgrade the Outpost",
TASK_BUILDOUTPOSTLEVEL2_EXPLAIN:"Upgrade the Outpost to Level 2. This will give you new build options and allow you to upgrade your HQ.",TASK_BUILDOUTPOSTLEVEL2_COMPLETE:"Upgrading! When the Outpost has finished upgrading you will have new build options and you\u2019ll be able to upgrade your HQ.",TASK_BUILDHQLEVEL3_SUMMARY:"Upgrade your HQ to level 3",TASK_BUILDHQLEVEL3_EXPLAIN:"The HQ is the hub of your base. Upgrade your HQ to unlock new build options and give your Hero a stat boost.",TASK_BUILDHQLEVEL3_COMPLETE:"HQ upgrading! When construction is complete it will unlock new build options, upgrade levels and give the Hero a stat boost.",
TASK_BUILDSTONESTORAGELEVEL3_SUMMARY:"Upgrade the Stone Storage",TASK_BUILDSTONESTORAGELEVEL3_EXPLAIN:"Upgrade the Stone Storage to Level 3. This will increase your Stone Storage capacity.",TASK_BUILDSTONESTORAGELEVEL3_COMPLETE:"Upgrading! When the Stone Storage has finished upgrading you will have increased Stone Storage capacity.",TASK_BUILDLUMBERSTORAGELEVEL3_SUMMARY:"Upgrade the Lumber Storage",TASK_BUILDLUMBERSTORAGELEVEL3_EXPLAIN:"Upgrade the Lumber Storage to Level 3. This will increase your Lumber Storage capacity.",
TASK_BUILDLUMBERSTORAGELEVEL3_COMPLETE:"Upgrading! When the Lumber Storage has finished upgrading you will have increased Lumber Storage capacity.",TASK_BUILDDEFENCEFACTORYLEVEL3_SUMMARY:"Upgrade the Defence Factory",TASK_BUILDDEFENCEFACTORYLEVEL3_EXPLAIN:"Upgrade the Defence Factory to Level 3. This will give you new upgrade options.",TASK_BUILDDEFENCEFACTORYLEVEL3_COMPLETE:"Upgrading! When the Defence Factory has finished upgrading you will have new upgrade options.",TASK_BUILDDEFENDLINGHUTLEVEL3_SUMMARY:"Upgrade Defendling Hut",
TASK_BUILDDEFENDLINGHUTLEVEL3_EXPLAIN:"Upgrade a Defendling Hut to Level 3. This allows Defendlings to build defences faster.",TASK_BUILDDEFENDLINGHUTLEVEL3_COMPLETE:"Upgrading! When the Hut has finished upgrading your Defendling will build defences faster.",TASK_BUILDOUTPOSTLEVEL3_SUMMARY:"Upgrade the Outpost",TASK_BUILDOUTPOSTLEVEL3_EXPLAIN:"Upgrade the Outpost to Level 3. This will give you new build options and allow you to upgrade your HQ.",TASK_BUILDOUTPOSTLEVEL3_COMPLETE:"Upgrading! When the Outpost has finished upgrading you will have new build options and you\u2019ll be able to upgrade your HQ.",
TASK_BUILDSECONDLUMBERSTORAGE_SUMMARY:"Build another Lumber Storage",TASK_BUILDSECONDLUMBERSTORAGE_EXPLAIN:"If you want to build more stuff, you\u2019ll need to be able to store more Lumber. Click here to build another Lumber Storage.",TASK_BUILDSECONDLUMBERSTORAGE_COMPLETE:"Now you have another Lumber Storage you\u2019ll be able to gather more Lumber and build new structures.",TASK_BUILDSECONDSTONESTORAGE_SUMMARY:"Build another Stone Storage",TASK_BUILDSECONDSTONESTORAGE_EXPLAIN:"If you want to build more stuff, you\u2019ll need to be able to store more Stone. Click here to build another Stone Storage.",
TASK_BUILDSECONDSTONESTORAGE_COMPLETE:"Now you have another Stone Storage you\u2019ll be able to gather more Stone and build new structures.",TASK_BUILDHQLEVEL4_SUMMARY:"Upgrade your HQ to level 4",TASK_BUILDHQLEVEL4_EXPLAIN:"The HQ is the hub of your base. Upgrade your HQ to unlock new build options and give your Hero a stat boost.",TASK_BUILDHQLEVEL4_COMPLETE:"HQ upgrading! When construction is complete it will unlock new build options, upgrade levels and give the Hero a stat boost.",TASK_BUILDHQLEVEL5_SUMMARY:"Upgrade your HQ to level 5",
TASK_BUILDHQLEVEL5_EXPLAIN:"The HQ is the hub of your base. Upgrade your HQ to unlock new build options and give your Hero a stat boost.",TASK_BUILDHQLEVEL5_COMPLETE:"HQ upgrading! When construction is complete it will unlock new build options, upgrade levels and give the Hero a stat boost.",TASK_BUILDHQLEVEL6_SUMMARY:"Upgrade your HQ to level 6",TASK_BUILDHQLEVEL6_EXPLAIN:"The HQ is the hub of your base. Upgrade your HQ to unlock new build options and give your Hero a stat boost.",TASK_BUILDHQLEVEL6_COMPLETE:"HQ upgrading! When construction is complete it will unlock new build options, upgrade levels and give the Hero a stat boost.",
TASK_BUILDHQLEVEL7_SUMMARY:"Upgrade your HQ to level 7",TASK_BUILDHQLEVEL7_EXPLAIN:"The HQ is the hub of your base. Upgrade your HQ to unlock new build options and give your Hero a stat boost.",TASK_BUILDHQLEVEL7_COMPLETE:"HQ upgrading! When construction is complete it will unlock new build options, upgrade levels and give the Hero a stat boost.",TASK_BUILDHQLEVEL8_SUMMARY:"Upgrade your HQ to level 8",TASK_BUILDHQLEVEL8_EXPLAIN:"The HQ is the hub of your base. Upgrade your HQ to unlock new build options and give your Hero a stat boost.",
TASK_BUILDHQLEVEL8_COMPLETE:"HQ upgrading! When construction is complete it will unlock new build options, upgrade levels and give the Hero a stat boost.",TASK_BUILDHQLEVEL9_SUMMARY:"Upgrade your HQ to level 9",TASK_BUILDHQLEVEL9_EXPLAIN:"The HQ is the hub of your base. Upgrade your HQ to unlock new build options and give your Hero a stat boost.",TASK_BUILDHQLEVEL9_COMPLETE:"HQ upgrading! When construction is complete it will unlock new build options, upgrade levels and give the Hero a stat boost.",
TASK_BUILDHQLEVEL10_SUMMARY:"Upgrade your HQ to level 10",TASK_BUILDHQLEVEL10_EXPLAIN:"The HQ is the hub of your base. Upgrade your HQ to unlock new build options and give your Hero a stat boost.",TASK_BUILDHQLEVEL10_COMPLETE:"HQ upgrading! When construction is complete it will unlock new build options, upgrade levels and give the Hero a stat boost.",TASK_CHOPTREE1_SUMMARY:"Chop down a tree",TASK_CHOPTREE5_SUMMARY:"Chop down 5 trees",TASK_CHOPTREE10_SUMMARY:"Chop down 10 trees",TASK_CHOPTREE_EXPLAIN:"We need Lumber to build, upgrade and research things for the village. Find some Lumber and get chopping for a reward!",
TASK_CHOPTREE1_COMPLETE:"Great chopping action! Now pick up the pieces of Lumber and drop them off at your HQ or Lumbermill.",TASK_CHOPTREE_COMPLETE:"Great chopping action! Now we have more Lumber to build, upgrade and research with.",TASK_MINESTONE1_SUMMARY:"Mine a Stone",TASK_MINESTONE5_SUMMARY:"Mine 5 Stones",TASK_MINESTONE10_SUMMARY:"Mine 10 Stones",TASK_MINESTONE_EXPLAIN:"We need Stone to build and upgrade things for the village. Find a Stone and get mining for a reward!",TASK_MINESTONE1_COMPLETE:"Perfect pickaxing! Now pick up the pieces of Stone and drop them off at your HQ or Stonemill.",
TASK_MINESTONE_COMPLETE:"Perfect pickaxing! Now we have more Stone to build and upgrade with.",TASK_STARTBOSSCAMPAIGN_SUMMARY:"Challenge the King",TASK_STARTBOSSCAMPAIGN_EXPLAIN:"See that fancy banner? It belongs to a King Wildling and it\u2019s boss mob. Get prepared and take them on!",TASK_STARTBOSSCAMPAIGN_COMPLETE:"Pretty tough, huh? There\u2019s 5 Wildling Kings to challenge, find them and defeat them all!",TASK_BEGINRESEARCH_SUMMARY:"Research a new technology",TASK_BEGINRESEARCH_EXPLAIN:"You can research new defence technologies in your Library using Lumber. Go to your Library and select something to research.",
TASK_BEGINRESEARCH_COMPLETE:"Researching! Technologies can be researched more than once to increase effectiveness. Upgrade the Library for new options.",TASK_GOFULLSCREEN_SUMMARY:"Go Fullscreen!",TASK_GOFULLSCREEN_EXPLAIN:"You can get a better view of the island by going fullscreen. Press the \u2019F\u2019 key to do it now.",TASK_GOFULLSCREEN_COMPLETE:"Much better! You can exit fullscreen at any time by pressing the \u2019ESC\u2019 key",TASK_KILLTHUMPLINGS5_SUMMARY:"Defeat 5 Thumplings",TASK_KILLTHUMPLINGS5_EXPLAIN:"Defeat 5 Thumplings with the Hero (towers don\u2019t count!) for a reward.",
TASK_KILLTHUMPLINGS5_COMPLETE:"You defeated 5 Thumplings!",TASK_KILLBREACHLINGS2_SUMMARY:"Defeat 2 Breachlings",TASK_KILLBREACHLINGS2_EXPLAIN:"Defeat 2 explosive Breachlings with the Hero (towers don\u2019t count!) for a reward.",TASK_KILLBREACHLINGS2_COMPLETE:"You defeated 2 Breachlings!",TASK_KILLBOOMLINGS5_SUMMARY:"Defeat 5 Boomlings",TASK_KILLBOOMLINGS5_EXPLAIN:"Defeat 5 explosive Boomlings with the Hero (towers don\u2019t count!) for a reward.",TASK_KILLBOOMLINGS5_COMPLETE:"You defeated 5 Boomlings!",
TASK_KILLCHIEFLINGS_SUMMARY:"Defeat a Chiefling",TASK_KILLCHIEFLINGS_EXPLAIN:"Defeat a mighty Chiefling with the Hero (towers don\u2019t count!) for a reward.",TASK_KILLCHIEFLINGS_COMPLETE:"You defeated a Chiefling!",TASK_KILLSTUNTLINGS3_SUMMARY:"Defeat 3 Shuntlings",TASK_KILLSTUNTLINGS3_EXPLAIN:"Defeat 3 Shuntlings with the Hero (towers don\u2019t count!) for a reward.",TASK_KILLSTUNTLINGS3_COMPLETE:"You defeated 3 Shuntlings!",TASK_KILLDARTLINGS5_SUMMARY:"Defeat 5 Dartlings",TASK_KILLDARTLINGS5_EXPLAIN:"Defeat 5 Dartlings with the Hero (towers don\u2019t count!) for a reward.",
TASK_KILLDARTLINGS5_COMPLETE:"You defeated 5 Dartlings!",TASK_KILLAMBERLING_SUMMARY:"Defeat an Amberling",TASK_KILLAMBERLING_EXPLAIN:"Defeat an elusive Amberling with the Hero (towers don\u2019t count!) for a reward.",TASK_KILLAMBERLING_COMPLETE:"You defeated an Amberling!",TASK_EVADEREAPERLING_SUMMARY:"Evade a Reaperling",TASK_EVADEREAPERLING_EXPLAIN:"Successfully evade a deadly Reaperling during a fight for a reward.",TASK_EVADEREAPERLING_COMPLETE:"You successfully evaded a Reaperling!",TASK_WAKEUPWILDLING_SUMMARY:"Wake up your Wildlings",
TASK_WAKEUPWILDLING_EXPLAIN:"When you\u2019re away Wildlings will continue to work for you. Click on them to wake them up and see what they got up to.",TASK_WAKEUPWILDLING_COMPLETE:"You woke a sleeping Wildling! It\u2019ll now work again until it falls asleep. Upgrade Huts to increase their work hours.",TASK_CLEARALLTREES_SUMMARY:"Chop all trees on the island",TASK_CLEARALLTREES_EXPLAIN:"Clear the island of trees for a reward!",TASK_CLEARALLTREES_COMPLETE:"That should give the Wildlings a bit of a break. You\u2019d make a great Lumberjack!",
TASK_CLEARALLSTONE_SUMMARY:"Mine all Stone on the island",TASK_CLEARALLSTONE_EXPLAIN:"Clear the island of stones for a reward!",TASK_CLEARALLSTONE_COMPLETE:"That should give the Wildlings a bit of a break. You\u2019d make a great miner!",TASK_CLEARALLMUSHROOMS_SUMMARY:"Clear island of mushrooms",TASK_CLEARALLMUSHROOMS_EXPLAIN:"Clear the island of mushrooms for a reward!",TASK_CLEARALLMUSHROOMS_COMPLETE:"That\u2019s all the mushrooms gone!",TASK_FINDSOMEAMBER_SUMMARY:"Find some Amber",TASK_FINDSOMEAMBER_EXPLAIN:"Find some Amber! Mushrooms are the best place to look, but you might get some from trees, stones or Feral Wildlings",
TASK_FINDSOMEAMBER_COMPLETE:"Amber! Let\u2019s go spend it! Speed something up? Buy a decoration? Boost your Hero ability at a Totem?",TASK_OPENAMBERWELL_SUMMARY:"Drain the Amber Well",TASK_OPENAMBERWELL_EXPLAIN:"If your Amber Well is full, click on it to collect precious Amber!",TASK_OPENAMBERWELL_COMPLETE:"Amber! Let\u2019s go spend it! Speed something up? Buy a decoration? Boost your Hero ability at a Totem?",TASK_PAUSEGAME_SUMMARY:"Pause the game",TASK_PAUSEGAME_EXPLAIN:"Press the \u2019P\u2019 key or click the pause button (in the top-left) to pause the game.",
TASK_PAUSEGAME_COMPLETE:"You can enter the Shop, change graphical settings, and share Polycraft with your friends in the pause menu.",TASK_ROTATECAMERA_SUMMARY:"Rotate the camera",TASK_ROTATECAMERA_EXPLAIN:"You can rotate the camera by pressing the left and right arrow keys.",TASK_ROTATECAMERA_COMPLETE:"That\u2019s a much better view. Don\u2019t forget you can also go fullscreen by pressing \u2019F\u2019.",TASK_SHOOTMUSHROOM_SUMMARY:"Shoot a mushroom",TASK_SHOOTMUSHROOM_EXPLAIN:"Over time mushrooms will grow all over the island. Often they contain precious Amber, go get some!",
TASK_SHOOTMUSHROOM_COMPLETE:"There\u2019s a 50/50 chance you\u2019ll find Amber in mushrooms, so seek them out!",TASK_SHOOTMUSHROOM3_SUMMARY:"Shoot 3 mushrooms",TASK_SHOOTMUSHROOM3_EXPLAIN:"Over time mushrooms will grow all over the island. Often they contain precious Amber, go get some!",TASK_SHOOTMUSHROOM3_COMPLETE:"There\u2019s a 50/50 chance you\u2019ll find Amber in mushrooms, so seek them out!",TASK_SHOOTXPPLANT_SUMMARY:"Shoot a Shard Plant",TASK_SHOOTXPPLANT_EXPLAIN:"Over time Shard Plants will grow all over the island. Often they contain XP Shards, go get some!",
TASK_SHOOTXPPLANT_COMPLETE:"There\u2019s a 50/50 chance you\u2019ll find XP Shards in Shard Plants, so seek them out!",TASK_SHOOTXPPLANT3_SUMMARY:"Shoot 3 Shard Plants",TASK_SHOOTXPPLANT3_EXPLAIN:"Over time Shard Plants will grow all over the island. Often they contain XP Shards, go get some!",TASK_SHOOTXPPLANT3_COMPLETE:"There\u2019s a 50/50 chance you\u2019ll find XP Shards in Shard Plants, so seek them out!",TASK_UPGRADEBUILDING_SUMMARY:"Upgrade something!",TASK_UPGRADEBUILDING_EXPLAIN:"It\u2019s about time one of your buildings got an upgrade! Upgrade any building for a reward.",
TASK_UPGRADEBUILDING_COMPLETE:"Almost everything in your base can be upgraded to become more effective and get a visual improvement.",TASK_BUILDBUILDING_SUMMARY:"Build something!",TASK_BUILDBUILDING_EXPLAIN:"It\u2019s about time your base got something shiny and new! Build any new building for a reward.",TASK_BUILDBUILDING_COMPLETE:"Much better.",TASK_OPENAMBERCHEST_SUMMARY:"Open Your Amber Chest!",TASK_OPENAMBERCHEST_EXPLAIN:"If your Amber Chest is full, click on it to collect precious Amber!",TASK_OPENAMBERCHEST_COMPLETE:"If you check your chest every day it will accumulate more each time, up to the maximum of 15 Amber per day.",
BADGE_DUMMY:"Test badge name",BADGE_EARLY_ADOPTER:"Early Adopter",BADGE_WIN_A_CAMPAIGN:"Win a Campaign",BADGE_10_TREES_CHOPPED:"I'm a Lumberjack",BADGE_100_TREES_CHOPPED:"And I'm Okay",BADGE_1000_TREES_CHOPPED:"I Sleep All Night, And I Work All Day",BADGE_10000_TREES_CHOPPED:"Lumber Master",BADGE_10_STONES_MINED:"Chip On My Shoulder",BADGE_100_STONES_MINED:"Chip Off The Old Block",BADGE_1000_STONES_MINED:"I Rock",BADGE_10000_STONES_MINED:"Mason Master",BADGE_10_ENEMIES_KILLED:"Not So Friendly",BADGE_100_ENEMIES_KILLED:"Off the Christmas List",
BADGE_1000_ENEMIES_KILLED:"Smelt the Friendship Bracelet",BADGE_10000_ENEMIES_KILLED:"Blaster Master",BADGE_10_WALLS_BUILT:"Hadrian",BADGE_100_WALLS_BUILT:"Troy",BADGE_LEVEL_5_HERO:"Heroic",BADGE_LEVEL_15_HERO:"Legendary",BADGE_LEVEL_30_HERO:"I Rock",BADGE_LEVEL_45_HERO:"Mason Master",CAMPAIGN_NAME_MOBA:"MOB A",CAMPAIGN_DESCRIPTION_MOBA:"Assorted mob A",CAMPAIGN_NAME_MOBB:"MOB B",CAMPAIGN_DESCRIPTION_MOBB:"Assorted mob B",CAMPAIGN_NAME_MOBC:"MOB C",CAMPAIGN_DESCRIPTION_MOBC:"Assorted mob C",CAMPAIGN_NAME_PETES_BOMBERS:"Pete\u2019s Bombers",
CAMPAIGN_DESCRIPTION_PETES_BOMBERS:"Assorted mob, love to blow stuff up",CAMPAIGN_NAME_PETES_PYROS:"PETE\u2019S PYROS",CAMPAIGN_DESCRIPTION_PETES_PYROS:"Pete\u2019s Pyros",CAMPAIGN_NAME_TUTORIAL_1:"Inexperienced Mob",CAMPAIGN_DESCRIPTION_TUTORIAL_1:"An Inexperienced mob of nonthreatening Wildlings",CAMPAIGN_NAME_TUTORIAL_2:"Trainee Mob",CAMPAIGN_DESCRIPTION_TUTORIAL_2:"A Trainee mob of nonthreatening Wildlings",CAMPAIGN_NAME_TUTORIAL_3:"Unpracticed Mob",CAMPAIGN_DESCRIPTION_TUTORIAL_3:"An unpracticed mob of nonthreatening Wildlings",
CAMPAIGN_NAME_TUTORIAL_4:"Inept Mob",CAMPAIGN_DESCRIPTION_TUTORIAL_4:"An inept mob of nonthreatening Wildlings",CAMPAIGN_NAME_TUTORIAL_5:"Beginner Mob",CAMPAIGN_DESCRIPTION_TUTORIAL_5:"A beginner mob of nonthreatening Wildlings",CAMPAIGN_NAME_EASY_1:"Simple Mob",CAMPAIGN_DESCRIPTION_EASY_1:"A simple Mob of varied Wildlings!",CAMPAIGN_NAME_EASY_2:"Confused Mob",CAMPAIGN_DESCRIPTION_EASY_2:"A Confused Mob of varied Wildlings!",CAMPAIGN_NAME_EASY_3:"Clumsy Mob",CAMPAIGN_DESCRIPTION_EASY_3:"A Clumsy Mob of varied Wildlings!",
CAMPAIGN_NAME_EASY_4:"Awkward Mob",CAMPAIGN_DESCRIPTION_EASY_4:"An Awkward Mob of varied Wildlings!",CAMPAIGN_NAME_EASY_5:"Bungling Mob",CAMPAIGN_DESCRIPTION_EASY_5:"A Bungling Mob of varied Wildlings!",CAMPAIGN_NAME_MEDIUM_1:"Tetchy Mob",CAMPAIGN_DESCRIPTION_MEDIUM_1:"A Tetchy Mob of varied Wildlings!",CAMPAIGN_NAME_MEDIUM_2:"Foaming Mob",CAMPAIGN_DESCRIPTION_MEDIUM_2:"A Foaming Mob of varied Wildlings!",CAMPAIGN_NAME_MEDIUM_3:"Exasperated Mob",CAMPAIGN_DESCRIPTION_MEDIUM_3:"An Exasperated Mob of varied Wildlings!",
CAMPAIGN_NAME_MOBA_1:"Boisterous Mob",CAMPAIGN_DESCRIPTION_MOBA_1:"A Boisterous Mob of varied Wildlings!",CAMPAIGN_NAME_MOBA_2:"Rowdy Mob",CAMPAIGN_DESCRIPTION_MOBA_2:"A Rowdy Mob of varied Wildlings!",CAMPAIGN_NAME_MOBA_3:"Unruly Mob",CAMPAIGN_DESCRIPTION_MOBA_3:"An Unruly Mob of varied Wildlings!",CAMPAIGN_NAME_MOBA_4:"Furious Mob",CAMPAIGN_DESCRIPTION_MOBA_4:"A Furious Mob of varied Wildlings!",CAMPAIGN_NAME_MOBA_5:"Chaotic Mob",CAMPAIGN_DESCRIPTION_MOBA_5:"A Chaotic Mob of varied Wildlings!",
CAMPAIGN_NAME_MOBA_6:"Anarchic Mob",CAMPAIGN_DESCRIPTION_MOBA_6:"A Anarchic Mob of varied Wildlings!",CAMPAIGN_NAME_MOBA_7:"Wayward Mob",CAMPAIGN_DESCRIPTION_MOBA_7:"A Wayward Mob of varied Wildlings!",CAMPAIGN_NAME_MOBA_8:"Defiant Mob",CAMPAIGN_DESCRIPTION_MOBA_8:"A Defiant Mob of varied Wildlings!",CAMPAIGN_NAME_MOBA_9:"Wild Mob",CAMPAIGN_DESCRIPTION_MOBA_9:"A Wild Mob of varied Wildlings!",CAMPAIGN_NAME_MOBA_10:"Angry Mob",CAMPAIGN_DESCRIPTION_MOBA_10:"An Angry Mob of varied Wildlings!",CAMPAIGN_NAME_MOBA_11:"Tumultuous Mob",
CAMPAIGN_DESCRIPTION_MOBA_11:"A Tumultuous Mob of varied Wildlings!",CAMPAIGN_NAME_MOBB_1:"Disorderly Mob",CAMPAIGN_DESCRIPTION_MOBB_1:"A Disorderly Mob of varied Wildlings!",CAMPAIGN_NAME_MOBB_2:"Riotous Mob",CAMPAIGN_DESCRIPTION_MOBB_2:"A Riotous Mob of varied Wildlings!",CAMPAIGN_NAME_MOBB_3:"Lively Mob",CAMPAIGN_DESCRIPTION_MOBB_3:"A Lively Mob of varied Wildlings!",CAMPAIGN_NAME_MOBB_4:"Loud Mob",CAMPAIGN_DESCRIPTION_MOBB_4:"A Loud Mob of varied Wildlings!",CAMPAIGN_NAME_MOBB_5:"Romping Mob",
CAMPAIGN_DESCRIPTION_MOBB_5:"A Romping Mob of varied Wildlings!",CAMPAIGN_NAME_MOBB_6:"Obstreperous Mob",CAMPAIGN_DESCRIPTION_MOBB_6:"An Obstreperous Mob of varied Wildlings!",CAMPAIGN_NAME_MOBB_7:"Irrepressible Mob",CAMPAIGN_DESCRIPTION_MOBB_7:"An Irrepressible Mob of varied Wildlings!",CAMPAIGN_NAME_MOBB_8:"Uncontrollable Mob",CAMPAIGN_DESCRIPTION_MOBB_8:"An Uncontrollable Mob of varied Wildlings!",CAMPAIGN_NAME_MOBB_9:"Undisciplined Mob",CAMPAIGN_DESCRIPTION_MOBB_9:"An Undisciplined Mob of varied Wildlings!",
CAMPAIGN_NAME_MOBB_10:"Rocking Mob",CAMPAIGN_DESCRIPTION_MOBB_10:"A Rocking Mob of varied Wildlings!",CAMPAIGN_NAME_MOBB_11:"Insubordinate Mob",CAMPAIGN_DESCRIPTION_MOBB_11:"An Insubordinate Mob of varied Wildlings!",CAMPAIGN_NAME_MOBC_1:"Raging Mob",CAMPAIGN_DESCRIPTION_MOBC_1:"A Raging Mob of varied Wildlings!",CAMPAIGN_NAME_MOBC_2:"Incensed Mob",CAMPAIGN_DESCRIPTION_MOBC_2:"A Incensed Mob of varied Wildlings!",CAMPAIGN_NAME_MOBC_3:"Fuming Mob",CAMPAIGN_DESCRIPTION_MOBC_3:"A Fuming Mob of varied Wildlings!",
CAMPAIGN_NAME_MOBC_4:"Fiery Mob",CAMPAIGN_DESCRIPTION_MOBC_4:"A Fiery Mob of varied Wildlings!",CAMPAIGN_NAME_MOBC_5:"Treacherous Mob",CAMPAIGN_DESCRIPTION_MOBC_5:"A Treacherous Mob of varied Wildlings!",CAMPAIGN_NAME_MOBC_6:"Perilous Mob",CAMPAIGN_DESCRIPTION_MOBC_6:"A Perilous Mob of varied Wildlings!",CAMPAIGN_NAME_MOBC_7:"Renegade Mob",CAMPAIGN_DESCRIPTION_MOBC_7:"A Renegade Mob of varied Wildlings!",CAMPAIGN_NAME_MOBC_8:"Hazardous Mob",CAMPAIGN_DESCRIPTION_MOBC_8:"A Hazardous Mob of varied Wildlings!",
CAMPAIGN_NAME_MOBC_9:"Daredevil Mob",CAMPAIGN_DESCRIPTION_MOBC_9:"A Daredevil Mob of varied Wildlings!",CAMPAIGN_NAME_MOBC_10:"Savage Mob",CAMPAIGN_DESCRIPTION_MOBC_10:"A Savage Mob of varied Wildlings!",CAMPAIGN_NAME_MOBC_11:"Catastrophic Mob",CAMPAIGN_DESCRIPTION_MOBC_11:"A Catastrophic Mob of varied Wildlings!",CAMPAIGN_NAME_BOMBTHROWER_1:"The Berserk Boomlings",CAMPAIGN_DESCRIPTION_BOMBTHROWER_1:"A volatile mob of explosive Wildlings!",CAMPAIGN_NAME_BOMBTHROWER_2:"The Bickering Boomlings",CAMPAIGN_DESCRIPTION_BOMBTHROWER_2:"A volatile mob of explosive Wildlings!",
CAMPAIGN_NAME_BOMBTHROWER_3:"The Belligerent Boomlings",CAMPAIGN_DESCRIPTION_BOMBTHROWER_3:"A volatile mob of explosive Wildlings!",CAMPAIGN_NAME_BOMBTHROWER_4:"The Brash Boomlings",CAMPAIGN_DESCRIPTION_BOMBTHROWER_4:"A volatile mob of explosive Wildlings!",CAMPAIGN_NAME_BOMBTHROWER_5:"The Bitter Boomlings",CAMPAIGN_DESCRIPTION_BOMBTHROWER_5:"A volatile mob of explosive Wildlings!",CAMPAIGN_NAME_BOSS_1:"King Wadaling\u2019s Boss Mob",CAMPAIGN_DESCRIPTION_BOSS_1:"Face King Wadaling and his toughest Wildlings!",
CAMPAIGN_NAME_BOSS_2:"King Longling\u2019s Boss Mob",CAMPAIGN_DESCRIPTION_BOSS_2:"Face King Longling and his toughest Wildlings!",CAMPAIGN_NAME_BOSS_3:"King Wyleling\u2019s Boss Mob",CAMPAIGN_DESCRIPTION_BOSS_3:"Face King Wyleling and his toughest Wildlings!",CAMPAIGN_NAME_BOSS_4:"King Langling\u2019s Boss Mob",CAMPAIGN_DESCRIPTION_BOSS_4:"Face King Langling and his toughest Wildlings!",CAMPAIGN_NAME_BOSS_5:"King Furnling\u2019s Boss Mob",CAMPAIGN_DESCRIPTION_BOSS_5:"Face King Furnling and his toughest Wildlings!",
CAMPAIGN_NAME_RANGED_1:"The Raucous Rangers",CAMPAIGN_DESCRIPTION_RANGED_1:"A mob of ranged Wildlings!",CAMPAIGN_NAME_RANGED_2:"The Rebellious Rangers",CAMPAIGN_DESCRIPTION_RANGED_2:"A mob of ranged Wildlings!",CAMPAIGN_NAME_RANGED_3:"The Revolting Rangers",CAMPAIGN_DESCRIPTION_RANGED_3:"A mob of ranged Wildlings!",CAMPAIGN_NAME_RANGED_4:"The Roaring Rangers",CAMPAIGN_DESCRIPTION_RANGED_4:"A mob of ranged Wildlings!",CAMPAIGN_NAME_RANGED_5:"The Rare Rangers",CAMPAIGN_DESCRIPTION_RANGED_5:"A mob of ranged Wildlings!",
CAMPAIGN_NAME_THIEF_1:"The Thundering Thieves",CAMPAIGN_DESCRIPTION_THIEF_1:"A sneaky mob of thieving Wildlings!",CAMPAIGN_NAME_THIEF_2:"The Tenacious Thieves",CAMPAIGN_DESCRIPTION_THIEF_2:"A sneaky mob of thieving Wildlings!",CAMPAIGN_NAME_THIEF_3:"The Thoughtless Thieves",CAMPAIGN_DESCRIPTION_THIEF_3:"A sneaky mob of thieving Wildlings!",CAMPAIGN_NAME_THIEF_4:"The Threatening Thieves",CAMPAIGN_DESCRIPTION_THIEF_4:"A sneaky mob of thieving Wildlings!",CAMPAIGN_NAME_CHARGER_1:"The Carnivorous Chargers",
CAMPAIGN_DESCRIPTION_CHARGER_1:"A fast mob of charging Wildlings!",CAMPAIGN_NAME_CHARGER_2:"The Careless Chargers",CAMPAIGN_DESCRIPTION_CHARGER_2:"A fast mob of charging Wildlings!",CAMPAIGN_NAME_CHARGER_3:"The Cut-throat Chargers",CAMPAIGN_DESCRIPTION_CHARGER_3:"A fast mob of charging Wildlings!",CAMPAIGN_NAME_CHARGER_4:"The Cruel Chargers",CAMPAIGN_DESCRIPTION_CHARGER_4:"A fast mob of charging Wildlings!",CAMPAIGN_NAME_TREASURE_1:"The Ancient Amberlings",CAMPAIGN_DESCRIPTION_TREASURE_1:"A special mob of Amber loving Wildlings!",
CAMPAIGN_NAME_TREASURE_2:"The Awkward Amberlings",CAMPAIGN_DESCRIPTION_TREASURE_2:"A special mob of Amber loving Wildlings!",CAMPAIGN_NAME_TREASURE_3:"The Annoying Amberlings",CAMPAIGN_DESCRIPTION_TREASURE_3:"A special mob of Amber loving Wildlings!",CAMPAIGN_NAME_TREASURE_4:"The Anomalous Amberlings",CAMPAIGN_DESCRIPTION_TREASURE_4:"A special mob of Amber loving Wildlings!",CAMPAIGN_NAME_COMMANDO_1:"The Brutal Bandits",CAMPAIGN_DESCRIPTION_COMMANDO_1:"A sneaky mob of base destroying Wildlings!",
CAMPAIGN_NAME_COMMANDO_2:"The Brisk Bandits",CAMPAIGN_DESCRIPTION_COMMANDO_2:"A sneaky mob of base destroying Wildlings!",CAMPAIGN_NAME_COMMANDO_3:"The Burly Bandits",CAMPAIGN_DESCRIPTION_COMMANDO_3:"A sneaky mob of base destroying Wildlings!",CAMPAIGN_NAME_COMMANDO_4:"The Bold Bandits",CAMPAIGN_DESCRIPTION_COMMANDO_4:"A sneaky mob of base destroying Wildlings!",CAMPAIGN_NAME_DEATH_1:"The Deathly Doomlings",CAMPAIGN_DESCRIPTION_DEATH_1:"A grim mob of fearsome Wildlings!",CAMPAIGN_NAME_DEATH_2:"The Devilish Doomlings",
CAMPAIGN_DESCRIPTION_DEATH_2:"A grim mob of fearsome Wildlings!",CAMPAIGN_NAME_DEATH_3:"The Deranged Doomlings",CAMPAIGN_DESCRIPTION_DEATH_3:"A grim mob of fearsome Wildlings!",CAMPAIGN_NAME_DEATH_4:"The Dark Doomlings",CAMPAIGN_DESCRIPTION_DEATH_4:"A grim mob of fearsome Wildlings!",CAMPAIGN_NAME_DEATH_5:"The Destitute Doomlings",CAMPAIGN_DESCRIPTION_DEATH_5:"A grim mob of fearsome Wildlings!",NOTIFICAITON_NOT_PLAYED_FOR_A_WHILE:"You've not visited your island for a while. Your Wildlings miss you",
NOTIFICAITON_NOT_PLAYED_FOR_A_LONG_TIME:"You've not visited your island for a long time. There's mushrooms everywhere and your Wildlings miss you",NOTIFICAITON_BUILDING_COMPLETE:"Your Buildlings have finished their constructions",NOTIFICAITON_BUILDING_UPGRADES_COMPLETE:"Your Buildlings have finished their upgrades",NOTIFICAITON_BUILDING_AND_UPGRADES_COMPLETE:"Your Buildlings have finished their constructions and upgrades",NOTIFICAITON_RESEARCH_COMPLETE:"Your Library has finished researching",NOTIFICAITON_DEFENCES_COMPLETE:"Your Defendlings have finished their construction of defences",
NOTIFICAITON_RESOURCES_FULL:"Your resource storages are nearly full. Come back or your Wildlings won't have anywhere to store their resources"};TurbulenzEngine.onload=function(){var a=mf.create();TurbulenzEngine.onunload=function(){a.shutdown()};a.init()};window.TurbulenzEngine=TurbulenzEngine})();
